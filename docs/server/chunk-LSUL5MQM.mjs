import './polyfills.server.mjs';
import{a as ZS,b as YS,c as KS,f as iE,j as rE,m as nE}from"./chunk-NGF4FVLR.mjs";import{$ as _r,$a as Jl,A as FS,Aa as x1,Ba as Nh,C as Ly,Ca as OS,Da as NS,Db as Lp,Ea as Ny,Eb as Rp,Fa as BS,Ga as Wn,Ha as zS,I as Ry,Ia as By,J as m1,Ja as Pp,K as Oy,Ka as kd,Kb as ws,La as jS,Lb as Fd,M as Kl,Ma as ea,Mb as Pd,Na as Al,Nb as WS,O as Gm,Ob as jy,P as Pf,Q as fa,Qa as _n,R as Un,Ra as Mc,Rb as is,Sa as Bs,T as Hn,Ta as Za,Ua as vg,V as Tn,Va as jn,W as Qn,Wa as Qi,Wb as qS,Xa as ji,Xb as $S,Ya as an,Z as wa,Za as Md,_ as Gn,_a as Dd,_b as XS,a as h1,aa as PS,ab as v1,bb as qm,c as _g,cb as bs,db as Do,dc as JS,e as SS,ea as su,eb as Ql,ec as QS,f as Mo,fa as g1,fb as pa,fc as Vy,g as d1,ga as _1,gb as zs,gc as eE,h as ES,ha as al,hb as Dc,hc as tE,i as AS,ia as xg,ib as Ta,j as Fp,ja as Wm,jb as Sa,kb as VS,l as f1,la as Ln,lb as US,mb as zy,n as Hm,na as lu,nb as Gr,o as CS,ob as Zu,pb as Bh,q as IS,qb as Ea,ra as LS,rb as Aa,s as kS,sa as Id,sb as HS,t as MS,ta as RS,u as p1,v as DS,wb as GS,y as Py,ya as Er,za as Ci}from"./chunk-XNFITG2R.mjs";import{a as qD}from"./chunk-GN3HINFO.mjs";import{a as In,b as Yl,c as GD,d as yS,e as bS,f as wS,g as WD,h as Fy,i as TS}from"./chunk-E44LSF4W.mjs";var AA=wS((Tb,Sb)=>{"use strict";(function(a,n){typeof Tb=="object"&&typeof Sb<"u"?Sb.exports=n():typeof define=="function"&&define.amd?define(n):(a=typeof globalThis<"u"?globalThis:a||self,a.mapboxgl=n())})(Tb,function(){"use strict";var a,n,l;function c(i,x){if(!a)a=x;else if(!n)n=x;else{var T="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+a+")(sharedChunk); ("+n+")(sharedChunk); self.onerror = null;",A={};a(A),l=x(A),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(l.workerUrl=window.URL.createObjectURL(new Blob([T],{type:"text/javascript"})))}}c(["exports"],function(i){var x="3.5.1";let T,A={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(T==null){let t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{T=process.env.API_URL_REGEX!=null?new RegExp(process.env.API_URL_REGEX):t}catch{T=t}}return T},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!A.API_URL)return null;try{let t=new URL(A.API_URL);return t.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":t.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function M(t){return A.API_URL_REGEX.test(t)}function F(t){return t.indexOf("mapbox:")===0}function W(t){return A.API_CDN_URL_REGEX.test(t)}function V(t){return A.API_SPRITE_REGEX.test(t)}function R(t){return A.API_STYLE_REGEX.test(t)&&!V(t)}let te={create:"create",load:"load",fullLoad:"fullLoad"},H={mark(t){performance.mark(t)},measure(t,e,r){performance.measure(t,e,r)}};function J(t){let e=t.name.split("?")[0];return W(e)&&e.includes("mapbox-gl.js")?"javascript":W(e)&&e.includes("mapbox-gl.css")?"css":function(r){return A.API_FONTS_REGEX.test(r)}(e)?"fontRange":V(e)?"sprite":R(e)?"style":function(r){return A.API_TILEJSON_REGEX.test(r)}(e)?"tilejson":"other"}function K(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ne={},de={};Object.defineProperty(de,"__esModule",{value:!0}),de.setMatrixArrayType=function(t){de.ARRAY_TYPE=Fe=t},de.toRadian=function(t){return t*Te},de.equals=function(t,e){return Math.abs(t-e)<=De*Math.max(1,Math.abs(t),Math.abs(e))},de.RANDOM=de.ARRAY_TYPE=de.EPSILON=void 0;var De=1e-6;de.EPSILON=De;var Fe=typeof Float32Array<"u"?Float32Array:Array;de.ARRAY_TYPE=Fe;var et=Math.random;de.RANDOM=et;var Te=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var ge={};function Ve(t){return Ve=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ve(t)}Object.defineProperty(ge,"__esModule",{value:!0}),ge.create=function(){var t=new Ae.ARRAY_TYPE(4);return Ae.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},ge.clone=function(t){var e=new Ae.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},ge.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},ge.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},ge.fromValues=function(t,e,r,s){var u=new Ae.ARRAY_TYPE(4);return u[0]=t,u[1]=e,u[2]=r,u[3]=s,u},ge.set=function(t,e,r,s,u){return t[0]=e,t[1]=r,t[2]=s,t[3]=u,t},ge.transpose=function(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},ge.invert=function(t,e){var r=e[0],s=e[1],u=e[2],d=e[3],p=r*d-u*s;return p?(t[0]=d*(p=1/p),t[1]=-s*p,t[2]=-u*p,t[3]=r*p,t):null},ge.adjoint=function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},ge.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},ge.multiply=xe,ge.rotate=function(t,e,r){var s=e[0],u=e[1],d=e[2],p=e[3],_=Math.sin(r),v=Math.cos(r);return t[0]=s*v+d*_,t[1]=u*v+p*_,t[2]=s*-_+d*v,t[3]=u*-_+p*v,t},ge.scale=function(t,e,r){var s=e[1],u=e[2],d=e[3],p=r[0],_=r[1];return t[0]=e[0]*p,t[1]=s*p,t[2]=u*_,t[3]=d*_,t},ge.fromRotation=function(t,e){var r=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=r,t[2]=-r,t[3]=s,t},ge.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},ge.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},ge.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},ge.LDU=function(t,e,r,s){return t[2]=s[2]/s[0],r[0]=s[0],r[1]=s[1],r[3]=s[3]-t[2]*r[1],[t,e,r]},ge.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},ge.subtract=Qe,ge.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},ge.equals=function(t,e){var r=t[0],s=t[1],u=t[2],d=t[3],p=e[0],_=e[1],v=e[2],w=e[3];return Math.abs(r-p)<=Ae.EPSILON*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(s-_)<=Ae.EPSILON*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(u-v)<=Ae.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(d-w)<=Ae.EPSILON*Math.max(1,Math.abs(d),Math.abs(w))},ge.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},ge.multiplyScalarAndAdd=function(t,e,r,s){return t[0]=e[0]+r[0]*s,t[1]=e[1]+r[1]*s,t[2]=e[2]+r[2]*s,t[3]=e[3]+r[3]*s,t},ge.sub=ge.mul=void 0;var Ae=function(t,e){if(t&&t.__esModule)return t;if(t===null||Ve(t)!=="object"&&typeof t!="function")return{default:t};var r=_e(void 0);if(r&&r.has(t))return r.get(t);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in t)if(d!=="default"&&Object.prototype.hasOwnProperty.call(t,d)){var p=u?Object.getOwnPropertyDescriptor(t,d):null;p&&(p.get||p.set)?Object.defineProperty(s,d,p):s[d]=t[d]}return s.default=t,r&&r.set(t,s),s}(de);function _e(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(_e=function(s){return s?r:e})(t)}function xe(t,e,r){var s=e[0],u=e[1],d=e[2],p=e[3],_=r[0],v=r[1],w=r[2],E=r[3];return t[0]=s*_+d*v,t[1]=u*_+p*v,t[2]=s*w+d*E,t[3]=u*w+p*E,t}function Qe(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}ge.mul=xe,ge.sub=Qe;var Ce={};function Ye(t){return Ye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ye(t)}Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.create=function(){var t=new ut.ARRAY_TYPE(6);return ut.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t},Ce.clone=function(t){var e=new ut.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},Ce.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},Ce.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},Ce.fromValues=function(t,e,r,s,u,d){var p=new ut.ARRAY_TYPE(6);return p[0]=t,p[1]=e,p[2]=r,p[3]=s,p[4]=u,p[5]=d,p},Ce.set=function(t,e,r,s,u,d,p){return t[0]=e,t[1]=r,t[2]=s,t[3]=u,t[4]=d,t[5]=p,t},Ce.invert=function(t,e){var r=e[0],s=e[1],u=e[2],d=e[3],p=e[4],_=e[5],v=r*d-s*u;return v?(t[0]=d*(v=1/v),t[1]=-s*v,t[2]=-u*v,t[3]=r*v,t[4]=(u*_-d*p)*v,t[5]=(s*p-r*_)*v,t):null},Ce.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},Ce.multiply=pt,Ce.rotate=function(t,e,r){var s=e[0],u=e[1],d=e[2],p=e[3],_=e[4],v=e[5],w=Math.sin(r),E=Math.cos(r);return t[0]=s*E+d*w,t[1]=u*E+p*w,t[2]=s*-w+d*E,t[3]=u*-w+p*E,t[4]=_,t[5]=v,t},Ce.scale=function(t,e,r){var s=e[1],u=e[2],d=e[3],p=e[4],_=e[5],v=r[0],w=r[1];return t[0]=e[0]*v,t[1]=s*v,t[2]=u*w,t[3]=d*w,t[4]=p,t[5]=_,t},Ce.translate=function(t,e,r){var s=e[0],u=e[1],d=e[2],p=e[3],_=e[4],v=e[5],w=r[0],E=r[1];return t[0]=s,t[1]=u,t[2]=d,t[3]=p,t[4]=s*w+d*E+_,t[5]=u*w+p*E+v,t},Ce.fromRotation=function(t,e){var r=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=r,t[2]=-r,t[3]=s,t[4]=0,t[5]=0,t},Ce.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},Ce.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},Ce.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},Ce.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)},Ce.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t},Ce.subtract=Tt,Ce.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t},Ce.multiplyScalarAndAdd=function(t,e,r,s){return t[0]=e[0]+r[0]*s,t[1]=e[1]+r[1]*s,t[2]=e[2]+r[2]*s,t[3]=e[3]+r[3]*s,t[4]=e[4]+r[4]*s,t[5]=e[5]+r[5]*s,t},Ce.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},Ce.equals=function(t,e){var r=t[0],s=t[1],u=t[2],d=t[3],p=t[4],_=t[5],v=e[0],w=e[1],E=e[2],k=e[3],D=e[4],N=e[5];return Math.abs(r-v)<=ut.EPSILON*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(s-w)<=ut.EPSILON*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(u-E)<=ut.EPSILON*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(d-k)<=ut.EPSILON*Math.max(1,Math.abs(d),Math.abs(k))&&Math.abs(p-D)<=ut.EPSILON*Math.max(1,Math.abs(p),Math.abs(D))&&Math.abs(_-N)<=ut.EPSILON*Math.max(1,Math.abs(_),Math.abs(N))},Ce.sub=Ce.mul=void 0;var ut=function(t,e){if(t&&t.__esModule)return t;if(t===null||Ye(t)!=="object"&&typeof t!="function")return{default:t};var r=st(void 0);if(r&&r.has(t))return r.get(t);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in t)if(d!=="default"&&Object.prototype.hasOwnProperty.call(t,d)){var p=u?Object.getOwnPropertyDescriptor(t,d):null;p&&(p.get||p.set)?Object.defineProperty(s,d,p):s[d]=t[d]}return s.default=t,r&&r.set(t,s),s}(de);function st(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(st=function(s){return s?r:e})(t)}function pt(t,e,r){var s=e[0],u=e[1],d=e[2],p=e[3],_=e[4],v=e[5],w=r[0],E=r[1],k=r[2],D=r[3],N=r[4],B=r[5];return t[0]=s*w+d*E,t[1]=u*w+p*E,t[2]=s*k+d*D,t[3]=u*k+p*D,t[4]=s*N+d*B+_,t[5]=u*N+p*B+v,t}function Tt(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}Ce.mul=pt,Ce.sub=Tt;var ht={};function Wt(t){return Wt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wt(t)}Object.defineProperty(ht,"__esModule",{value:!0}),ht.create=function(){var t=new ie.ARRAY_TYPE(9);return ie.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},ht.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},ht.clone=function(t){var e=new ie.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},ht.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},ht.fromValues=function(t,e,r,s,u,d,p,_,v){var w=new ie.ARRAY_TYPE(9);return w[0]=t,w[1]=e,w[2]=r,w[3]=s,w[4]=u,w[5]=d,w[6]=p,w[7]=_,w[8]=v,w},ht.set=function(t,e,r,s,u,d,p,_,v,w){return t[0]=e,t[1]=r,t[2]=s,t[3]=u,t[4]=d,t[5]=p,t[6]=_,t[7]=v,t[8]=w,t},ht.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},ht.transpose=function(t,e){if(t===e){var r=e[1],s=e[2],u=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=s,t[7]=u}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},ht.invert=function(t,e){var r=e[0],s=e[1],u=e[2],d=e[3],p=e[4],_=e[5],v=e[6],w=e[7],E=e[8],k=E*p-_*w,D=-E*d+_*v,N=w*d-p*v,B=r*k+s*D+u*N;return B?(t[0]=k*(B=1/B),t[1]=(-E*s+u*w)*B,t[2]=(_*s-u*p)*B,t[3]=D*B,t[4]=(E*r-u*v)*B,t[5]=(-_*r+u*d)*B,t[6]=N*B,t[7]=(-w*r+s*v)*B,t[8]=(p*r-s*d)*B,t):null},ht.adjoint=function(t,e){var r=e[0],s=e[1],u=e[2],d=e[3],p=e[4],_=e[5],v=e[6],w=e[7],E=e[8];return t[0]=p*E-_*w,t[1]=u*w-s*E,t[2]=s*_-u*p,t[3]=_*v-d*E,t[4]=r*E-u*v,t[5]=u*d-r*_,t[6]=d*w-p*v,t[7]=s*v-r*w,t[8]=r*p-s*d,t},ht.determinant=function(t){var e=t[3],r=t[4],s=t[5],u=t[6],d=t[7],p=t[8];return t[0]*(p*r-s*d)+t[1]*(-p*e+s*u)+t[2]*(d*e-r*u)},ht.multiply=pe,ht.translate=function(t,e,r){var s=e[0],u=e[1],d=e[2],p=e[3],_=e[4],v=e[5],w=e[6],E=e[7],k=e[8],D=r[0],N=r[1];return t[0]=s,t[1]=u,t[2]=d,t[3]=p,t[4]=_,t[5]=v,t[6]=D*s+N*p+w,t[7]=D*u+N*_+E,t[8]=D*d+N*v+k,t},ht.rotate=function(t,e,r){var s=e[0],u=e[1],d=e[2],p=e[3],_=e[4],v=e[5],w=e[6],E=e[7],k=e[8],D=Math.sin(r),N=Math.cos(r);return t[0]=N*s+D*p,t[1]=N*u+D*_,t[2]=N*d+D*v,t[3]=N*p-D*s,t[4]=N*_-D*u,t[5]=N*v-D*d,t[6]=w,t[7]=E,t[8]=k,t},ht.scale=function(t,e,r){var s=r[0],u=r[1];return t[0]=s*e[0],t[1]=s*e[1],t[2]=s*e[2],t[3]=u*e[3],t[4]=u*e[4],t[5]=u*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},ht.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},ht.fromRotation=function(t,e){var r=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=r,t[2]=0,t[3]=-r,t[4]=s,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},ht.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},ht.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},ht.fromQuat=function(t,e){var r=e[0],s=e[1],u=e[2],d=e[3],p=r+r,_=s+s,v=u+u,w=r*p,E=s*p,k=s*_,D=u*p,N=u*_,B=u*v,q=d*p,Z=d*_,oe=d*v;return t[0]=1-k-B,t[3]=E-oe,t[6]=D+Z,t[1]=E+oe,t[4]=1-w-B,t[7]=N-q,t[2]=D-Z,t[5]=N+q,t[8]=1-w-k,t},ht.normalFromMat4=function(t,e){var r=e[0],s=e[1],u=e[2],d=e[3],p=e[4],_=e[5],v=e[6],w=e[7],E=e[8],k=e[9],D=e[10],N=e[11],B=e[12],q=e[13],Z=e[14],oe=e[15],ve=r*_-s*p,be=r*v-u*p,we=r*w-d*p,$e=s*v-u*_,Ge=s*w-d*_,it=u*w-d*v,ot=E*q-k*B,_t=E*Z-D*B,Mt=E*oe-N*B,At=k*Z-D*q,zt=k*oe-N*q,Jt=D*oe-N*Z,Ot=ve*Jt-be*zt+we*At+$e*Mt-Ge*_t+it*ot;return Ot?(t[0]=(_*Jt-v*zt+w*At)*(Ot=1/Ot),t[1]=(v*Mt-p*Jt-w*_t)*Ot,t[2]=(p*zt-_*Mt+w*ot)*Ot,t[3]=(u*zt-s*Jt-d*At)*Ot,t[4]=(r*Jt-u*Mt+d*_t)*Ot,t[5]=(s*Mt-r*zt-d*ot)*Ot,t[6]=(q*it-Z*Ge+oe*$e)*Ot,t[7]=(Z*we-B*it-oe*be)*Ot,t[8]=(B*Ge-q*we+oe*ve)*Ot,t):null},ht.projection=function(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},ht.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},ht.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},ht.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t},ht.subtract=Ie,ht.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t},ht.multiplyScalarAndAdd=function(t,e,r,s){return t[0]=e[0]+r[0]*s,t[1]=e[1]+r[1]*s,t[2]=e[2]+r[2]*s,t[3]=e[3]+r[3]*s,t[4]=e[4]+r[4]*s,t[5]=e[5]+r[5]*s,t[6]=e[6]+r[6]*s,t[7]=e[7]+r[7]*s,t[8]=e[8]+r[8]*s,t},ht.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},ht.equals=function(t,e){var r=t[0],s=t[1],u=t[2],d=t[3],p=t[4],_=t[5],v=t[6],w=t[7],E=t[8],k=e[0],D=e[1],N=e[2],B=e[3],q=e[4],Z=e[5],oe=e[6],ve=e[7],be=e[8];return Math.abs(r-k)<=ie.EPSILON*Math.max(1,Math.abs(r),Math.abs(k))&&Math.abs(s-D)<=ie.EPSILON*Math.max(1,Math.abs(s),Math.abs(D))&&Math.abs(u-N)<=ie.EPSILON*Math.max(1,Math.abs(u),Math.abs(N))&&Math.abs(d-B)<=ie.EPSILON*Math.max(1,Math.abs(d),Math.abs(B))&&Math.abs(p-q)<=ie.EPSILON*Math.max(1,Math.abs(p),Math.abs(q))&&Math.abs(_-Z)<=ie.EPSILON*Math.max(1,Math.abs(_),Math.abs(Z))&&Math.abs(v-oe)<=ie.EPSILON*Math.max(1,Math.abs(v),Math.abs(oe))&&Math.abs(w-ve)<=ie.EPSILON*Math.max(1,Math.abs(w),Math.abs(ve))&&Math.abs(E-be)<=ie.EPSILON*Math.max(1,Math.abs(E),Math.abs(be))},ht.sub=ht.mul=void 0;var ie=function(t,e){if(t&&t.__esModule)return t;if(t===null||Wt(t)!=="object"&&typeof t!="function")return{default:t};var r=ye(void 0);if(r&&r.has(t))return r.get(t);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in t)if(d!=="default"&&Object.prototype.hasOwnProperty.call(t,d)){var p=u?Object.getOwnPropertyDescriptor(t,d):null;p&&(p.get||p.set)?Object.defineProperty(s,d,p):s[d]=t[d]}return s.default=t,r&&r.set(t,s),s}(de);function ye(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(ye=function(s){return s?r:e})(t)}function pe(t,e,r){var s=e[0],u=e[1],d=e[2],p=e[3],_=e[4],v=e[5],w=e[6],E=e[7],k=e[8],D=r[0],N=r[1],B=r[2],q=r[3],Z=r[4],oe=r[5],ve=r[6],be=r[7],we=r[8];return t[0]=D*s+N*p+B*w,t[1]=D*u+N*_+B*E,t[2]=D*d+N*v+B*k,t[3]=q*s+Z*p+oe*w,t[4]=q*u+Z*_+oe*E,t[5]=q*d+Z*v+oe*k,t[6]=ve*s+be*p+we*w,t[7]=ve*u+be*_+we*E,t[8]=ve*d+be*v+we*k,t}function Ie(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}ht.mul=pe,ht.sub=Ie;var Ue={};function gt(t){return gt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gt(t)}Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.create=function(){var t=new mt.ARRAY_TYPE(16);return mt.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},Ue.clone=function(t){var e=new mt.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},Ue.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},Ue.fromValues=function(t,e,r,s,u,d,p,_,v,w,E,k,D,N,B,q){var Z=new mt.ARRAY_TYPE(16);return Z[0]=t,Z[1]=e,Z[2]=r,Z[3]=s,Z[4]=u,Z[5]=d,Z[6]=p,Z[7]=_,Z[8]=v,Z[9]=w,Z[10]=E,Z[11]=k,Z[12]=D,Z[13]=N,Z[14]=B,Z[15]=q,Z},Ue.set=function(t,e,r,s,u,d,p,_,v,w,E,k,D,N,B,q,Z){return t[0]=e,t[1]=r,t[2]=s,t[3]=u,t[4]=d,t[5]=p,t[6]=_,t[7]=v,t[8]=w,t[9]=E,t[10]=k,t[11]=D,t[12]=N,t[13]=B,t[14]=q,t[15]=Z,t},Ue.identity=Lt,Ue.transpose=function(t,e){if(t===e){var r=e[1],s=e[2],u=e[3],d=e[6],p=e[7],_=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=s,t[9]=d,t[11]=e[14],t[12]=u,t[13]=p,t[14]=_}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},Ue.invert=function(t,e){var r=e[0],s=e[1],u=e[2],d=e[3],p=e[4],_=e[5],v=e[6],w=e[7],E=e[8],k=e[9],D=e[10],N=e[11],B=e[12],q=e[13],Z=e[14],oe=e[15],ve=r*_-s*p,be=r*v-u*p,we=r*w-d*p,$e=s*v-u*_,Ge=s*w-d*_,it=u*w-d*v,ot=E*q-k*B,_t=E*Z-D*B,Mt=E*oe-N*B,At=k*Z-D*q,zt=k*oe-N*q,Jt=D*oe-N*Z,Ot=ve*Jt-be*zt+we*At+$e*Mt-Ge*_t+it*ot;return Ot?(t[0]=(_*Jt-v*zt+w*At)*(Ot=1/Ot),t[1]=(u*zt-s*Jt-d*At)*Ot,t[2]=(q*it-Z*Ge+oe*$e)*Ot,t[3]=(D*Ge-k*it-N*$e)*Ot,t[4]=(v*Mt-p*Jt-w*_t)*Ot,t[5]=(r*Jt-u*Mt+d*_t)*Ot,t[6]=(Z*we-B*it-oe*be)*Ot,t[7]=(E*it-D*we+N*be)*Ot,t[8]=(p*zt-_*Mt+w*ot)*Ot,t[9]=(s*Mt-r*zt-d*ot)*Ot,t[10]=(B*Ge-q*we+oe*ve)*Ot,t[11]=(k*we-E*Ge-N*ve)*Ot,t[12]=(_*_t-p*At-v*ot)*Ot,t[13]=(r*At-s*_t+u*ot)*Ot,t[14]=(q*be-B*$e-Z*ve)*Ot,t[15]=(E*$e-k*be+D*ve)*Ot,t):null},Ue.adjoint=function(t,e){var r=e[0],s=e[1],u=e[2],d=e[3],p=e[4],_=e[5],v=e[6],w=e[7],E=e[8],k=e[9],D=e[10],N=e[11],B=e[12],q=e[13],Z=e[14],oe=e[15];return t[0]=_*(D*oe-N*Z)-k*(v*oe-w*Z)+q*(v*N-w*D),t[1]=-(s*(D*oe-N*Z)-k*(u*oe-d*Z)+q*(u*N-d*D)),t[2]=s*(v*oe-w*Z)-_*(u*oe-d*Z)+q*(u*w-d*v),t[3]=-(s*(v*N-w*D)-_*(u*N-d*D)+k*(u*w-d*v)),t[4]=-(p*(D*oe-N*Z)-E*(v*oe-w*Z)+B*(v*N-w*D)),t[5]=r*(D*oe-N*Z)-E*(u*oe-d*Z)+B*(u*N-d*D),t[6]=-(r*(v*oe-w*Z)-p*(u*oe-d*Z)+B*(u*w-d*v)),t[7]=r*(v*N-w*D)-p*(u*N-d*D)+E*(u*w-d*v),t[8]=p*(k*oe-N*q)-E*(_*oe-w*q)+B*(_*N-w*k),t[9]=-(r*(k*oe-N*q)-E*(s*oe-d*q)+B*(s*N-d*k)),t[10]=r*(_*oe-w*q)-p*(s*oe-d*q)+B*(s*w-d*_),t[11]=-(r*(_*N-w*k)-p*(s*N-d*k)+E*(s*w-d*_)),t[12]=-(p*(k*Z-D*q)-E*(_*Z-v*q)+B*(_*D-v*k)),t[13]=r*(k*Z-D*q)-E*(s*Z-u*q)+B*(s*D-u*k),t[14]=-(r*(_*Z-v*q)-p*(s*Z-u*q)+B*(s*v-u*_)),t[15]=r*(_*D-v*k)-p*(s*D-u*k)+E*(s*v-u*_),t},Ue.determinant=function(t){var e=t[0],r=t[1],s=t[2],u=t[3],d=t[4],p=t[5],_=t[6],v=t[7],w=t[8],E=t[9],k=t[10],D=t[11],N=t[12],B=t[13],q=t[14],Z=t[15];return(e*p-r*d)*(k*Z-D*q)-(e*_-s*d)*(E*Z-D*B)+(e*v-u*d)*(E*q-k*B)+(r*_-s*p)*(w*Z-D*N)-(r*v-u*p)*(w*q-k*N)+(s*v-u*_)*(w*B-E*N)},Ue.multiply=fi,Ue.translate=function(t,e,r){var s,u,d,p,_,v,w,E,k,D,N,B,q=r[0],Z=r[1],oe=r[2];return e===t?(t[12]=e[0]*q+e[4]*Z+e[8]*oe+e[12],t[13]=e[1]*q+e[5]*Z+e[9]*oe+e[13],t[14]=e[2]*q+e[6]*Z+e[10]*oe+e[14],t[15]=e[3]*q+e[7]*Z+e[11]*oe+e[15]):(u=e[1],d=e[2],p=e[3],_=e[4],v=e[5],w=e[6],E=e[7],k=e[8],D=e[9],N=e[10],B=e[11],t[0]=s=e[0],t[1]=u,t[2]=d,t[3]=p,t[4]=_,t[5]=v,t[6]=w,t[7]=E,t[8]=k,t[9]=D,t[10]=N,t[11]=B,t[12]=s*q+_*Z+k*oe+e[12],t[13]=u*q+v*Z+D*oe+e[13],t[14]=d*q+w*Z+N*oe+e[14],t[15]=p*q+E*Z+B*oe+e[15]),t},Ue.scale=function(t,e,r){var s=r[0],u=r[1],d=r[2];return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t[4]=e[4]*u,t[5]=e[5]*u,t[6]=e[6]*u,t[7]=e[7]*u,t[8]=e[8]*d,t[9]=e[9]*d,t[10]=e[10]*d,t[11]=e[11]*d,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},Ue.rotate=function(t,e,r,s){var u,d,p,_,v,w,E,k,D,N,B,q,Z,oe,ve,be,we,$e,Ge,it,ot,_t,Mt,At,zt=s[0],Jt=s[1],Ot=s[2],Xt=Math.hypot(zt,Jt,Ot);return Xt<mt.EPSILON?null:(zt*=Xt=1/Xt,Jt*=Xt,Ot*=Xt,u=Math.sin(r),d=Math.cos(r),v=e[1],w=e[2],E=e[3],D=e[5],N=e[6],B=e[7],Z=e[9],oe=e[10],ve=e[11],be=zt*zt*(p=1-d)+d,Ge=zt*Jt*p-Ot*u,it=Jt*Jt*p+d,ot=Ot*Jt*p+zt*u,_t=zt*Ot*p+Jt*u,Mt=Jt*Ot*p-zt*u,At=Ot*Ot*p+d,t[0]=(_=e[0])*be+(k=e[4])*(we=Jt*zt*p+Ot*u)+(q=e[8])*($e=Ot*zt*p-Jt*u),t[1]=v*be+D*we+Z*$e,t[2]=w*be+N*we+oe*$e,t[3]=E*be+B*we+ve*$e,t[4]=_*Ge+k*it+q*ot,t[5]=v*Ge+D*it+Z*ot,t[6]=w*Ge+N*it+oe*ot,t[7]=E*Ge+B*it+ve*ot,t[8]=_*_t+k*Mt+q*At,t[9]=v*_t+D*Mt+Z*At,t[10]=w*_t+N*Mt+oe*At,t[11]=E*_t+B*Mt+ve*At,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},Ue.rotateX=function(t,e,r){var s=Math.sin(r),u=Math.cos(r),d=e[4],p=e[5],_=e[6],v=e[7],w=e[8],E=e[9],k=e[10],D=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=d*u+w*s,t[5]=p*u+E*s,t[6]=_*u+k*s,t[7]=v*u+D*s,t[8]=w*u-d*s,t[9]=E*u-p*s,t[10]=k*u-_*s,t[11]=D*u-v*s,t},Ue.rotateY=function(t,e,r){var s=Math.sin(r),u=Math.cos(r),d=e[0],p=e[1],_=e[2],v=e[3],w=e[8],E=e[9],k=e[10],D=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=d*u-w*s,t[1]=p*u-E*s,t[2]=_*u-k*s,t[3]=v*u-D*s,t[8]=d*s+w*u,t[9]=p*s+E*u,t[10]=_*s+k*u,t[11]=v*s+D*u,t},Ue.rotateZ=function(t,e,r){var s=Math.sin(r),u=Math.cos(r),d=e[0],p=e[1],_=e[2],v=e[3],w=e[4],E=e[5],k=e[6],D=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=d*u+w*s,t[1]=p*u+E*s,t[2]=_*u+k*s,t[3]=v*u+D*s,t[4]=w*u-d*s,t[5]=E*u-p*s,t[6]=k*u-_*s,t[7]=D*u-v*s,t},Ue.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},Ue.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Ue.fromRotation=function(t,e,r){var s,u,d,p=r[0],_=r[1],v=r[2],w=Math.hypot(p,_,v);return w<mt.EPSILON?null:(p*=w=1/w,_*=w,v*=w,s=Math.sin(e),u=Math.cos(e),t[0]=p*p*(d=1-u)+u,t[1]=_*p*d+v*s,t[2]=v*p*d-_*s,t[3]=0,t[4]=p*_*d-v*s,t[5]=_*_*d+u,t[6]=v*_*d+p*s,t[7]=0,t[8]=p*v*d+_*s,t[9]=_*v*d-p*s,t[10]=v*v*d+u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},Ue.fromXRotation=function(t,e){var r=Math.sin(e),s=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Ue.fromYRotation=function(t,e){var r=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Ue.fromZRotation=function(t,e){var r=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Ue.fromRotationTranslation=yi,Ue.fromQuat2=function(t,e){var r=new mt.ARRAY_TYPE(3),s=-e[0],u=-e[1],d=-e[2],p=e[3],_=e[4],v=e[5],w=e[6],E=e[7],k=s*s+u*u+d*d+p*p;return k>0?(r[0]=2*(_*p+E*s+v*d-w*u)/k,r[1]=2*(v*p+E*u+w*s-_*d)/k,r[2]=2*(w*p+E*d+_*u-v*s)/k):(r[0]=2*(_*p+E*s+v*d-w*u),r[1]=2*(v*p+E*u+w*s-_*d),r[2]=2*(w*p+E*d+_*u-v*s)),yi(t,e,r),t},Ue.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},Ue.getScaling=Fi,Ue.getRotation=function(t,e){var r=new mt.ARRAY_TYPE(3);Fi(r,e);var s=1/r[0],u=1/r[1],d=1/r[2],p=e[0]*s,_=e[1]*u,v=e[2]*d,w=e[4]*s,E=e[5]*u,k=e[6]*d,D=e[8]*s,N=e[9]*u,B=e[10]*d,q=p+E+B,Z=0;return q>0?(Z=2*Math.sqrt(q+1),t[3]=.25*Z,t[0]=(k-N)/Z,t[1]=(D-v)/Z,t[2]=(_-w)/Z):p>E&&p>B?(Z=2*Math.sqrt(1+p-E-B),t[3]=(k-N)/Z,t[0]=.25*Z,t[1]=(_+w)/Z,t[2]=(D+v)/Z):E>B?(Z=2*Math.sqrt(1+E-p-B),t[3]=(D-v)/Z,t[0]=(_+w)/Z,t[1]=.25*Z,t[2]=(k+N)/Z):(Z=2*Math.sqrt(1+B-p-E),t[3]=(_-w)/Z,t[0]=(D+v)/Z,t[1]=(k+N)/Z,t[2]=.25*Z),t},Ue.fromRotationTranslationScale=function(t,e,r,s){var u=e[0],d=e[1],p=e[2],_=e[3],v=u+u,w=d+d,E=p+p,k=u*v,D=u*w,N=u*E,B=d*w,q=d*E,Z=p*E,oe=_*v,ve=_*w,be=_*E,we=s[0],$e=s[1],Ge=s[2];return t[0]=(1-(B+Z))*we,t[1]=(D+be)*we,t[2]=(N-ve)*we,t[3]=0,t[4]=(D-be)*$e,t[5]=(1-(k+Z))*$e,t[6]=(q+oe)*$e,t[7]=0,t[8]=(N+ve)*Ge,t[9]=(q-oe)*Ge,t[10]=(1-(k+B))*Ge,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},Ue.fromRotationTranslationScaleOrigin=function(t,e,r,s,u){var d=e[0],p=e[1],_=e[2],v=e[3],w=d+d,E=p+p,k=_+_,D=d*w,N=d*E,B=d*k,q=p*E,Z=p*k,oe=_*k,ve=v*w,be=v*E,we=v*k,$e=s[0],Ge=s[1],it=s[2],ot=u[0],_t=u[1],Mt=u[2],At=(1-(q+oe))*$e,zt=(N+we)*$e,Jt=(B-be)*$e,Ot=(N-we)*Ge,Xt=(1-(D+oe))*Ge,Dt=(Z+ve)*Ge,Zt=(B+be)*it,ri=(Z-ve)*it,Kt=(1-(D+q))*it;return t[0]=At,t[1]=zt,t[2]=Jt,t[3]=0,t[4]=Ot,t[5]=Xt,t[6]=Dt,t[7]=0,t[8]=Zt,t[9]=ri,t[10]=Kt,t[11]=0,t[12]=r[0]+ot-(At*ot+Ot*_t+Zt*Mt),t[13]=r[1]+_t-(zt*ot+Xt*_t+ri*Mt),t[14]=r[2]+Mt-(Jt*ot+Dt*_t+Kt*Mt),t[15]=1,t},Ue.fromQuat=function(t,e){var r=e[0],s=e[1],u=e[2],d=e[3],p=r+r,_=s+s,v=u+u,w=r*p,E=s*p,k=s*_,D=u*p,N=u*_,B=u*v,q=d*p,Z=d*_,oe=d*v;return t[0]=1-k-B,t[1]=E+oe,t[2]=D-Z,t[3]=0,t[4]=E-oe,t[5]=1-w-B,t[6]=N+q,t[7]=0,t[8]=D+Z,t[9]=N-q,t[10]=1-w-k,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Ue.frustum=function(t,e,r,s,u,d,p){var _=1/(r-e),v=1/(u-s),w=1/(d-p);return t[0]=2*d*_,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*d*v,t[6]=0,t[7]=0,t[8]=(r+e)*_,t[9]=(u+s)*v,t[10]=(p+d)*w,t[11]=-1,t[12]=0,t[13]=0,t[14]=p*d*2*w,t[15]=0,t},Ue.perspectiveNO=Pi,Ue.perspectiveZO=function(t,e,r,s,u){var d,p=1/Math.tan(e/2);return t[0]=p/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=p,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,u!=null&&u!==1/0?(t[10]=u*(d=1/(s-u)),t[14]=u*s*d):(t[10]=-1,t[14]=-s),t},Ue.perspectiveFromFieldOfView=function(t,e,r,s){var u=Math.tan(e.upDegrees*Math.PI/180),d=Math.tan(e.downDegrees*Math.PI/180),p=Math.tan(e.leftDegrees*Math.PI/180),_=Math.tan(e.rightDegrees*Math.PI/180),v=2/(p+_),w=2/(u+d);return t[0]=v,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=w,t[6]=0,t[7]=0,t[8]=-(p-_)*v*.5,t[9]=(u-d)*w*.5,t[10]=s/(r-s),t[11]=-1,t[12]=0,t[13]=0,t[14]=s*r/(r-s),t[15]=0,t},Ue.orthoNO=$t,Ue.orthoZO=function(t,e,r,s,u,d,p){var _=1/(e-r),v=1/(s-u),w=1/(d-p);return t[0]=-2*_,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*v,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=w,t[11]=0,t[12]=(e+r)*_,t[13]=(u+s)*v,t[14]=d*w,t[15]=1,t},Ue.lookAt=function(t,e,r,s){var u,d,p,_,v,w,E,k,D,N,B=e[0],q=e[1],Z=e[2],oe=s[0],ve=s[1],be=s[2],we=r[0],$e=r[1],Ge=r[2];return Math.abs(B-we)<mt.EPSILON&&Math.abs(q-$e)<mt.EPSILON&&Math.abs(Z-Ge)<mt.EPSILON?Lt(t):(E=B-we,k=q-$e,D=Z-Ge,u=ve*(D*=N=1/Math.hypot(E,k,D))-be*(k*=N),d=be*(E*=N)-oe*D,p=oe*k-ve*E,(N=Math.hypot(u,d,p))?(u*=N=1/N,d*=N,p*=N):(u=0,d=0,p=0),_=k*p-D*d,v=D*u-E*p,w=E*d-k*u,(N=Math.hypot(_,v,w))?(_*=N=1/N,v*=N,w*=N):(_=0,v=0,w=0),t[0]=u,t[1]=_,t[2]=E,t[3]=0,t[4]=d,t[5]=v,t[6]=k,t[7]=0,t[8]=p,t[9]=w,t[10]=D,t[11]=0,t[12]=-(u*B+d*q+p*Z),t[13]=-(_*B+v*q+w*Z),t[14]=-(E*B+k*q+D*Z),t[15]=1,t)},Ue.targetTo=function(t,e,r,s){var u=e[0],d=e[1],p=e[2],_=s[0],v=s[1],w=s[2],E=u-r[0],k=d-r[1],D=p-r[2],N=E*E+k*k+D*D;N>0&&(E*=N=1/Math.sqrt(N),k*=N,D*=N);var B=v*D-w*k,q=w*E-_*D,Z=_*k-v*E;return(N=B*B+q*q+Z*Z)>0&&(B*=N=1/Math.sqrt(N),q*=N,Z*=N),t[0]=B,t[1]=q,t[2]=Z,t[3]=0,t[4]=k*Z-D*q,t[5]=D*B-E*Z,t[6]=E*q-k*B,t[7]=0,t[8]=E,t[9]=k,t[10]=D,t[11]=0,t[12]=u,t[13]=d,t[14]=p,t[15]=1,t},Ue.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},Ue.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},Ue.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t},Ue.subtract=lt,Ue.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t},Ue.multiplyScalarAndAdd=function(t,e,r,s){return t[0]=e[0]+r[0]*s,t[1]=e[1]+r[1]*s,t[2]=e[2]+r[2]*s,t[3]=e[3]+r[3]*s,t[4]=e[4]+r[4]*s,t[5]=e[5]+r[5]*s,t[6]=e[6]+r[6]*s,t[7]=e[7]+r[7]*s,t[8]=e[8]+r[8]*s,t[9]=e[9]+r[9]*s,t[10]=e[10]+r[10]*s,t[11]=e[11]+r[11]*s,t[12]=e[12]+r[12]*s,t[13]=e[13]+r[13]*s,t[14]=e[14]+r[14]*s,t[15]=e[15]+r[15]*s,t},Ue.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},Ue.equals=function(t,e){var r=t[0],s=t[1],u=t[2],d=t[3],p=t[4],_=t[5],v=t[6],w=t[7],E=t[8],k=t[9],D=t[10],N=t[11],B=t[12],q=t[13],Z=t[14],oe=t[15],ve=e[0],be=e[1],we=e[2],$e=e[3],Ge=e[4],it=e[5],ot=e[6],_t=e[7],Mt=e[8],At=e[9],zt=e[10],Jt=e[11],Ot=e[12],Xt=e[13],Dt=e[14],Zt=e[15];return Math.abs(r-ve)<=mt.EPSILON*Math.max(1,Math.abs(r),Math.abs(ve))&&Math.abs(s-be)<=mt.EPSILON*Math.max(1,Math.abs(s),Math.abs(be))&&Math.abs(u-we)<=mt.EPSILON*Math.max(1,Math.abs(u),Math.abs(we))&&Math.abs(d-$e)<=mt.EPSILON*Math.max(1,Math.abs(d),Math.abs($e))&&Math.abs(p-Ge)<=mt.EPSILON*Math.max(1,Math.abs(p),Math.abs(Ge))&&Math.abs(_-it)<=mt.EPSILON*Math.max(1,Math.abs(_),Math.abs(it))&&Math.abs(v-ot)<=mt.EPSILON*Math.max(1,Math.abs(v),Math.abs(ot))&&Math.abs(w-_t)<=mt.EPSILON*Math.max(1,Math.abs(w),Math.abs(_t))&&Math.abs(E-Mt)<=mt.EPSILON*Math.max(1,Math.abs(E),Math.abs(Mt))&&Math.abs(k-At)<=mt.EPSILON*Math.max(1,Math.abs(k),Math.abs(At))&&Math.abs(D-zt)<=mt.EPSILON*Math.max(1,Math.abs(D),Math.abs(zt))&&Math.abs(N-Jt)<=mt.EPSILON*Math.max(1,Math.abs(N),Math.abs(Jt))&&Math.abs(B-Ot)<=mt.EPSILON*Math.max(1,Math.abs(B),Math.abs(Ot))&&Math.abs(q-Xt)<=mt.EPSILON*Math.max(1,Math.abs(q),Math.abs(Xt))&&Math.abs(Z-Dt)<=mt.EPSILON*Math.max(1,Math.abs(Z),Math.abs(Dt))&&Math.abs(oe-Zt)<=mt.EPSILON*Math.max(1,Math.abs(oe),Math.abs(Zt))},Ue.sub=Ue.mul=Ue.ortho=Ue.perspective=void 0;var mt=function(t,e){if(t&&t.__esModule)return t;if(t===null||gt(t)!=="object"&&typeof t!="function")return{default:t};var r=wt(void 0);if(r&&r.has(t))return r.get(t);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in t)if(d!=="default"&&Object.prototype.hasOwnProperty.call(t,d)){var p=u?Object.getOwnPropertyDescriptor(t,d):null;p&&(p.get||p.set)?Object.defineProperty(s,d,p):s[d]=t[d]}return s.default=t,r&&r.set(t,s),s}(de);function wt(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(wt=function(s){return s?r:e})(t)}function Lt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function fi(t,e,r){var s=e[0],u=e[1],d=e[2],p=e[3],_=e[4],v=e[5],w=e[6],E=e[7],k=e[8],D=e[9],N=e[10],B=e[11],q=e[12],Z=e[13],oe=e[14],ve=e[15],be=r[0],we=r[1],$e=r[2],Ge=r[3];return t[0]=be*s+we*_+$e*k+Ge*q,t[1]=be*u+we*v+$e*D+Ge*Z,t[2]=be*d+we*w+$e*N+Ge*oe,t[3]=be*p+we*E+$e*B+Ge*ve,t[4]=(be=r[4])*s+(we=r[5])*_+($e=r[6])*k+(Ge=r[7])*q,t[5]=be*u+we*v+$e*D+Ge*Z,t[6]=be*d+we*w+$e*N+Ge*oe,t[7]=be*p+we*E+$e*B+Ge*ve,t[8]=(be=r[8])*s+(we=r[9])*_+($e=r[10])*k+(Ge=r[11])*q,t[9]=be*u+we*v+$e*D+Ge*Z,t[10]=be*d+we*w+$e*N+Ge*oe,t[11]=be*p+we*E+$e*B+Ge*ve,t[12]=(be=r[12])*s+(we=r[13])*_+($e=r[14])*k+(Ge=r[15])*q,t[13]=be*u+we*v+$e*D+Ge*Z,t[14]=be*d+we*w+$e*N+Ge*oe,t[15]=be*p+we*E+$e*B+Ge*ve,t}function yi(t,e,r){var s=e[0],u=e[1],d=e[2],p=e[3],_=s+s,v=u+u,w=d+d,E=s*_,k=s*v,D=s*w,N=u*v,B=u*w,q=d*w,Z=p*_,oe=p*v,ve=p*w;return t[0]=1-(N+q),t[1]=k+ve,t[2]=D-oe,t[3]=0,t[4]=k-ve,t[5]=1-(E+q),t[6]=B+Z,t[7]=0,t[8]=D+oe,t[9]=B-Z,t[10]=1-(E+N),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Fi(t,e){var r=e[4],s=e[5],u=e[6],d=e[8],p=e[9],_=e[10];return t[0]=Math.hypot(e[0],e[1],e[2]),t[1]=Math.hypot(r,s,u),t[2]=Math.hypot(d,p,_),t}function Pi(t,e,r,s,u){var d,p=1/Math.tan(e/2);return t[0]=p/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=p,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,u!=null&&u!==1/0?(t[10]=(u+s)*(d=1/(s-u)),t[14]=2*u*s*d):(t[10]=-1,t[14]=-2*s),t}function $t(t,e,r,s,u,d,p){var _=1/(e-r),v=1/(s-u),w=1/(d-p);return t[0]=-2*_,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*v,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*w,t[11]=0,t[12]=(e+r)*_,t[13]=(u+s)*v,t[14]=(p+d)*w,t[15]=1,t}function lt(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}Ue.perspective=Pi,Ue.ortho=$t,Ue.mul=fi,Ue.sub=lt;var Bt={},ni={};function bi(t){return bi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bi(t)}Object.defineProperty(ni,"__esModule",{value:!0}),ni.create=Bi,ni.clone=function(t){var e=new ki.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},ni.length=tr,ni.fromValues=function(t,e,r){var s=new ki.ARRAY_TYPE(3);return s[0]=t,s[1]=e,s[2]=r,s},ni.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},ni.set=function(t,e,r,s){return t[0]=e,t[1]=r,t[2]=s,t},ni.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},ni.subtract=ar,ni.multiply=vr,ni.divide=kr,ni.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},ni.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},ni.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},ni.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},ni.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},ni.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},ni.scaleAndAdd=function(t,e,r,s){return t[0]=e[0]+r[0]*s,t[1]=e[1]+r[1]*s,t[2]=e[2]+r[2]*s,t},ni.distance=qr,ni.squaredDistance=Kr,ni.squaredLength=xr,ni.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},ni.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},ni.normalize=function(t,e){var r=e[0],s=e[1],u=e[2],d=r*r+s*s+u*u;return d>0&&(d=1/Math.sqrt(d)),t[0]=e[0]*d,t[1]=e[1]*d,t[2]=e[2]*d,t},ni.dot=Or,ni.cross=function(t,e,r){var s=e[0],u=e[1],d=e[2],p=r[0],_=r[1],v=r[2];return t[0]=u*v-d*_,t[1]=d*p-s*v,t[2]=s*_-u*p,t},ni.lerp=function(t,e,r,s){var u=e[0],d=e[1],p=e[2];return t[0]=u+s*(r[0]-u),t[1]=d+s*(r[1]-d),t[2]=p+s*(r[2]-p),t},ni.hermite=function(t,e,r,s,u,d){var p=d*d,_=p*(2*d-3)+1,v=p*(d-2)+d,w=p*(d-1),E=p*(3-2*d);return t[0]=e[0]*_+r[0]*v+s[0]*w+u[0]*E,t[1]=e[1]*_+r[1]*v+s[1]*w+u[1]*E,t[2]=e[2]*_+r[2]*v+s[2]*w+u[2]*E,t},ni.bezier=function(t,e,r,s,u,d){var p=1-d,_=p*p,v=d*d,w=_*p,E=3*d*_,k=3*v*p,D=v*d;return t[0]=e[0]*w+r[0]*E+s[0]*k+u[0]*D,t[1]=e[1]*w+r[1]*E+s[1]*k+u[1]*D,t[2]=e[2]*w+r[2]*E+s[2]*k+u[2]*D,t},ni.random=function(t,e){e=e||1;var r=2*ki.RANDOM()*Math.PI,s=2*ki.RANDOM()-1,u=Math.sqrt(1-s*s)*e;return t[0]=Math.cos(r)*u,t[1]=Math.sin(r)*u,t[2]=s*e,t},ni.transformMat4=function(t,e,r){var s=e[0],u=e[1],d=e[2],p=r[3]*s+r[7]*u+r[11]*d+r[15];return t[0]=(r[0]*s+r[4]*u+r[8]*d+r[12])/(p=p||1),t[1]=(r[1]*s+r[5]*u+r[9]*d+r[13])/p,t[2]=(r[2]*s+r[6]*u+r[10]*d+r[14])/p,t},ni.transformMat3=function(t,e,r){var s=e[0],u=e[1],d=e[2];return t[0]=s*r[0]+u*r[3]+d*r[6],t[1]=s*r[1]+u*r[4]+d*r[7],t[2]=s*r[2]+u*r[5]+d*r[8],t},ni.transformQuat=function(t,e,r){var s=r[0],u=r[1],d=r[2],p=e[0],_=e[1],v=e[2],w=u*v-d*_,E=d*p-s*v,k=s*_-u*p,D=u*k-d*E,N=d*w-s*k,B=s*E-u*w,q=2*r[3];return E*=q,k*=q,N*=2,B*=2,t[0]=p+(w*=q)+(D*=2),t[1]=_+E+N,t[2]=v+k+B,t},ni.rotateX=function(t,e,r,s){var u=[],d=[];return u[0]=e[0]-r[0],u[1]=e[1]-r[1],u[2]=e[2]-r[2],d[0]=u[0],d[1]=u[1]*Math.cos(s)-u[2]*Math.sin(s),d[2]=u[1]*Math.sin(s)+u[2]*Math.cos(s),t[0]=d[0]+r[0],t[1]=d[1]+r[1],t[2]=d[2]+r[2],t},ni.rotateY=function(t,e,r,s){var u=[],d=[];return u[0]=e[0]-r[0],u[1]=e[1]-r[1],u[2]=e[2]-r[2],d[0]=u[2]*Math.sin(s)+u[0]*Math.cos(s),d[1]=u[1],d[2]=u[2]*Math.cos(s)-u[0]*Math.sin(s),t[0]=d[0]+r[0],t[1]=d[1]+r[1],t[2]=d[2]+r[2],t},ni.rotateZ=function(t,e,r,s){var u=[],d=[];return u[0]=e[0]-r[0],u[1]=e[1]-r[1],u[2]=e[2]-r[2],d[0]=u[0]*Math.cos(s)-u[1]*Math.sin(s),d[1]=u[0]*Math.sin(s)+u[1]*Math.cos(s),d[2]=u[2],t[0]=d[0]+r[0],t[1]=d[1]+r[1],t[2]=d[2]+r[2],t},ni.angle=function(t,e){var r=t[0],s=t[1],u=t[2],d=e[0],p=e[1],_=e[2],v=Math.sqrt(r*r+s*s+u*u)*Math.sqrt(d*d+p*p+_*_),w=v&&Or(t,e)/v;return Math.acos(Math.min(Math.max(w,-1),1))},ni.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t},ni.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},ni.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},ni.equals=function(t,e){var r=t[0],s=t[1],u=t[2],d=e[0],p=e[1],_=e[2];return Math.abs(r-d)<=ki.EPSILON*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(s-p)<=ki.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(u-_)<=ki.EPSILON*Math.max(1,Math.abs(u),Math.abs(_))},ni.forEach=ni.sqrLen=ni.len=ni.sqrDist=ni.dist=ni.div=ni.mul=ni.sub=void 0;var ki=function(t,e){if(t&&t.__esModule)return t;if(t===null||bi(t)!=="object"&&typeof t!="function")return{default:t};var r=Ni(void 0);if(r&&r.has(t))return r.get(t);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in t)if(d!=="default"&&Object.prototype.hasOwnProperty.call(t,d)){var p=u?Object.getOwnPropertyDescriptor(t,d):null;p&&(p.get||p.set)?Object.defineProperty(s,d,p):s[d]=t[d]}return s.default=t,r&&r.set(t,s),s}(de);function Ni(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(Ni=function(s){return s?r:e})(t)}function Bi(){var t=new ki.ARRAY_TYPE(3);return ki.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function tr(t){return Math.hypot(t[0],t[1],t[2])}function ar(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function vr(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function kr(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function qr(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])}function Kr(t,e){var r=e[0]-t[0],s=e[1]-t[1],u=e[2]-t[2];return r*r+s*s+u*u}function xr(t){var e=t[0],r=t[1],s=t[2];return e*e+r*r+s*s}function Or(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}ni.sub=ar,ni.mul=vr,ni.div=kr,ni.dist=qr,ni.sqrDist=Kr,ni.len=tr,ni.sqrLen=xr;var Ri,La=(Ri=Bi(),function(t,e,r,s,u,d){var p,_;for(e||(e=3),r||(r=0),_=s?Math.min(s*e+r,t.length):t.length,p=r;p<_;p+=e)Ri[0]=t[p],Ri[1]=t[p+1],Ri[2]=t[p+2],u(Ri,Ri,d),t[p]=Ri[0],t[p+1]=Ri[1],t[p+2]=Ri[2];return t});ni.forEach=La;var Di={};function go(t){return go=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},go(t)}Object.defineProperty(Di,"__esModule",{value:!0}),Di.create=_o,Di.clone=function(t){var e=new fr.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},Di.fromValues=function(t,e,r,s){var u=new fr.ARRAY_TYPE(4);return u[0]=t,u[1]=e,u[2]=r,u[3]=s,u},Di.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},Di.set=function(t,e,r,s,u){return t[0]=e,t[1]=r,t[2]=s,t[3]=u,t},Di.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},Di.subtract=$r,Di.multiply=so,Di.divide=Rn,Di.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},Di.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},Di.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},Di.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},Di.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},Di.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},Di.scaleAndAdd=function(t,e,r,s){return t[0]=e[0]+r[0]*s,t[1]=e[1]+r[1]*s,t[2]=e[2]+r[2]*s,t[3]=e[3]+r[3]*s,t},Di.distance=Ja,Di.squaredDistance=xo,Di.length=vn,Di.squaredLength=Ar,Di.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},Di.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},Di.normalize=function(t,e){var r=e[0],s=e[1],u=e[2],d=e[3],p=r*r+s*s+u*u+d*d;return p>0&&(p=1/Math.sqrt(p)),t[0]=r*p,t[1]=s*p,t[2]=u*p,t[3]=d*p,t},Di.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},Di.cross=function(t,e,r,s){var u=r[0]*s[1]-r[1]*s[0],d=r[0]*s[2]-r[2]*s[0],p=r[0]*s[3]-r[3]*s[0],_=r[1]*s[2]-r[2]*s[1],v=r[1]*s[3]-r[3]*s[1],w=r[2]*s[3]-r[3]*s[2],E=e[0],k=e[1],D=e[2],N=e[3];return t[0]=k*w-D*v+N*_,t[1]=-E*w+D*p-N*d,t[2]=E*v-k*p+N*u,t[3]=-E*_+k*d-D*u,t},Di.lerp=function(t,e,r,s){var u=e[0],d=e[1],p=e[2],_=e[3];return t[0]=u+s*(r[0]-u),t[1]=d+s*(r[1]-d),t[2]=p+s*(r[2]-p),t[3]=_+s*(r[3]-_),t},Di.random=function(t,e){var r,s,u,d,p,_;e=e||1;do p=(r=2*fr.RANDOM()-1)*r+(s=2*fr.RANDOM()-1)*s;while(p>=1);do _=(u=2*fr.RANDOM()-1)*u+(d=2*fr.RANDOM()-1)*d;while(_>=1);var v=Math.sqrt((1-p)/_);return t[0]=e*r,t[1]=e*s,t[2]=e*u*v,t[3]=e*d*v,t},Di.transformMat4=function(t,e,r){var s=e[0],u=e[1],d=e[2],p=e[3];return t[0]=r[0]*s+r[4]*u+r[8]*d+r[12]*p,t[1]=r[1]*s+r[5]*u+r[9]*d+r[13]*p,t[2]=r[2]*s+r[6]*u+r[10]*d+r[14]*p,t[3]=r[3]*s+r[7]*u+r[11]*d+r[15]*p,t},Di.transformQuat=function(t,e,r){var s=e[0],u=e[1],d=e[2],p=r[0],_=r[1],v=r[2],w=r[3],E=w*s+_*d-v*u,k=w*u+v*s-p*d,D=w*d+p*u-_*s,N=-p*s-_*u-v*d;return t[0]=E*w+N*-p+k*-v-D*-_,t[1]=k*w+N*-_+D*-p-E*-v,t[2]=D*w+N*-v+E*-_-k*-p,t[3]=e[3],t},Di.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},Di.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},Di.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},Di.equals=function(t,e){var r=t[0],s=t[1],u=t[2],d=t[3],p=e[0],_=e[1],v=e[2],w=e[3];return Math.abs(r-p)<=fr.EPSILON*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(s-_)<=fr.EPSILON*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(u-v)<=fr.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(d-w)<=fr.EPSILON*Math.max(1,Math.abs(d),Math.abs(w))},Di.forEach=Di.sqrLen=Di.len=Di.sqrDist=Di.dist=Di.div=Di.mul=Di.sub=void 0;var fr=function(t,e){if(t&&t.__esModule)return t;if(t===null||go(t)!=="object"&&typeof t!="function")return{default:t};var r=Sn(void 0);if(r&&r.has(t))return r.get(t);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in t)if(d!=="default"&&Object.prototype.hasOwnProperty.call(t,d)){var p=u?Object.getOwnPropertyDescriptor(t,d):null;p&&(p.get||p.set)?Object.defineProperty(s,d,p):s[d]=t[d]}return s.default=t,r&&r.set(t,s),s}(de);function Sn(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(Sn=function(s){return s?r:e})(t)}function _o(){var t=new fr.ARRAY_TYPE(4);return fr.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function $r(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function so(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function Rn(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function Ja(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2],e[3]-t[3])}function xo(t,e){var r=e[0]-t[0],s=e[1]-t[1],u=e[2]-t[2],d=e[3]-t[3];return r*r+s*s+u*u+d*d}function vn(t){return Math.hypot(t[0],t[1],t[2],t[3])}function Ar(t){var e=t[0],r=t[1],s=t[2],u=t[3];return e*e+r*r+s*s+u*u}Di.sub=$r,Di.mul=so,Di.div=Rn,Di.dist=Ja,Di.sqrDist=xo,Di.len=vn,Di.sqrLen=Ar;var dn=function(){var t=_o();return function(e,r,s,u,d,p){var _,v;for(r||(r=4),s||(s=0),v=u?Math.min(u*r+s,e.length):e.length,_=s;_<v;_+=r)t[0]=e[_],t[1]=e[_+1],t[2]=e[_+2],t[3]=e[_+3],d(t,t,p),e[_]=t[0],e[_+1]=t[1],e[_+2]=t[2],e[_+3]=t[3];return e}}();function as(t){return as=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},as(t)}Di.forEach=dn,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.create=Va,Bt.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},Bt.setAxisAngle=ca,Bt.getAxisAngle=function(t,e){var r=2*Math.acos(e[3]),s=Math.sin(r/2);return s>kn.EPSILON?(t[0]=e[0]/s,t[1]=e[1]/s,t[2]=e[2]/s):(t[0]=1,t[1]=0,t[2]=0),r},Bt.getAngle=function(t,e){var r=le(t,e);return Math.acos(2*r*r-1)},Bt.multiply=$n,Bt.rotateX=function(t,e,r){r*=.5;var s=e[0],u=e[1],d=e[2],p=e[3],_=Math.sin(r),v=Math.cos(r);return t[0]=s*v+p*_,t[1]=u*v+d*_,t[2]=d*v-u*_,t[3]=p*v-s*_,t},Bt.rotateY=function(t,e,r){r*=.5;var s=e[0],u=e[1],d=e[2],p=e[3],_=Math.sin(r),v=Math.cos(r);return t[0]=s*v-d*_,t[1]=u*v+p*_,t[2]=d*v+s*_,t[3]=p*v-u*_,t},Bt.rotateZ=function(t,e,r){r*=.5;var s=e[0],u=e[1],d=e[2],p=e[3],_=Math.sin(r),v=Math.cos(r);return t[0]=s*v+u*_,t[1]=u*v-s*_,t[2]=d*v+p*_,t[3]=p*v-d*_,t},Bt.calculateW=function(t,e){var r=e[0],s=e[1],u=e[2];return t[0]=r,t[1]=s,t[2]=u,t[3]=Math.sqrt(Math.abs(1-r*r-s*s-u*u)),t},Bt.exp=ee,Bt.ln=z,Bt.pow=function(t,e,r){return z(t,e),se(t,t,r),ee(t,t),t},Bt.slerp=G,Bt.random=function(t){var e=kn.RANDOM(),r=kn.RANDOM(),s=kn.RANDOM(),u=Math.sqrt(1-e),d=Math.sqrt(e);return t[0]=u*Math.sin(2*Math.PI*r),t[1]=u*Math.cos(2*Math.PI*r),t[2]=d*Math.sin(2*Math.PI*s),t[3]=d*Math.cos(2*Math.PI*s),t},Bt.invert=function(t,e){var r=e[0],s=e[1],u=e[2],d=e[3],p=r*r+s*s+u*u+d*d,_=p?1/p:0;return t[0]=-r*_,t[1]=-s*_,t[2]=-u*_,t[3]=d*_,t},Bt.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},Bt.fromMat3=Q,Bt.fromEuler=function(t,e,r,s){var u=.5*Math.PI/180;e*=u,r*=u,s*=u;var d=Math.sin(e),p=Math.cos(e),_=Math.sin(r),v=Math.cos(r),w=Math.sin(s),E=Math.cos(s);return t[0]=d*v*E-p*_*w,t[1]=p*_*E+d*v*w,t[2]=p*v*w-d*_*E,t[3]=p*v*E+d*_*w,t},Bt.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},Bt.setAxes=Bt.sqlerp=Bt.rotationTo=Bt.equals=Bt.exactEquals=Bt.normalize=Bt.sqrLen=Bt.squaredLength=Bt.len=Bt.length=Bt.lerp=Bt.dot=Bt.scale=Bt.mul=Bt.add=Bt.set=Bt.copy=Bt.fromValues=Bt.clone=void 0;var kn=Qa(de),lo=Qa(ht),ka=Qa(ni),Ki=Qa(Di);function Ro(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(Ro=function(s){return s?r:e})(t)}function Qa(t,e){if(t&&t.__esModule)return t;if(t===null||as(t)!=="object"&&typeof t!="function")return{default:t};var r=Ro(e);if(r&&r.has(t))return r.get(t);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in t)if(d!=="default"&&Object.prototype.hasOwnProperty.call(t,d)){var p=u?Object.getOwnPropertyDescriptor(t,d):null;p&&(p.get||p.set)?Object.defineProperty(s,d,p):s[d]=t[d]}return s.default=t,r&&r.set(t,s),s}function Va(){var t=new kn.ARRAY_TYPE(4);return kn.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function ca(t,e,r){r*=.5;var s=Math.sin(r);return t[0]=s*e[0],t[1]=s*e[1],t[2]=s*e[2],t[3]=Math.cos(r),t}function $n(t,e,r){var s=e[0],u=e[1],d=e[2],p=e[3],_=r[0],v=r[1],w=r[2],E=r[3];return t[0]=s*E+p*_+u*w-d*v,t[1]=u*E+p*v+d*_-s*w,t[2]=d*E+p*w+s*v-u*_,t[3]=p*E-s*_-u*v-d*w,t}function ee(t,e){var r=e[0],s=e[1],u=e[2],d=e[3],p=Math.sqrt(r*r+s*s+u*u),_=Math.exp(d),v=p>0?_*Math.sin(p)/p:0;return t[0]=r*v,t[1]=s*v,t[2]=u*v,t[3]=_*Math.cos(p),t}function z(t,e){var r=e[0],s=e[1],u=e[2],d=e[3],p=Math.sqrt(r*r+s*s+u*u),_=p>0?Math.atan2(p,d)/p:0;return t[0]=r*_,t[1]=s*_,t[2]=u*_,t[3]=.5*Math.log(r*r+s*s+u*u+d*d),t}function G(t,e,r,s){var u,d,p,_,v,w=e[0],E=e[1],k=e[2],D=e[3],N=r[0],B=r[1],q=r[2],Z=r[3];return(d=w*N+E*B+k*q+D*Z)<0&&(d=-d,N=-N,B=-B,q=-q,Z=-Z),1-d>kn.EPSILON?(u=Math.acos(d),p=Math.sin(u),_=Math.sin((1-s)*u)/p,v=Math.sin(s*u)/p):(_=1-s,v=s),t[0]=_*w+v*N,t[1]=_*E+v*B,t[2]=_*k+v*q,t[3]=_*D+v*Z,t}function Q(t,e){var r,s=e[0]+e[4]+e[8];if(s>0)r=Math.sqrt(s+1),t[3]=.5*r,t[0]=(e[5]-e[7])*(r=.5/r),t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var u=0;e[4]>e[0]&&(u=1),e[8]>e[3*u+u]&&(u=2);var d=(u+1)%3,p=(u+2)%3;r=Math.sqrt(e[3*u+u]-e[3*d+d]-e[3*p+p]+1),t[u]=.5*r,t[3]=(e[3*d+p]-e[3*p+d])*(r=.5/r),t[d]=(e[3*d+u]+e[3*u+d])*r,t[p]=(e[3*p+u]+e[3*u+p])*r}return t}Bt.clone=Ki.clone,Bt.fromValues=Ki.fromValues,Bt.copy=Ki.copy,Bt.set=Ki.set,Bt.add=Ki.add,Bt.mul=$n;var se=Ki.scale;Bt.scale=se;var le=Ki.dot;Bt.dot=le,Bt.lerp=Ki.lerp;var Me=Ki.length;Bt.length=Me,Bt.len=Me;var Ze=Ki.squaredLength;Bt.squaredLength=Ze,Bt.sqrLen=Ze;var ke=Ki.normalize;Bt.normalize=ke,Bt.exactEquals=Ki.exactEquals,Bt.equals=Ki.equals;var We,nt,dt,Pt=(We=ka.create(),nt=ka.fromValues(1,0,0),dt=ka.fromValues(0,1,0),function(t,e,r){var s=ka.dot(e,r);return s<-.999999?(ka.cross(We,nt,e),ka.len(We)<1e-6&&ka.cross(We,dt,e),ka.normalize(We,We),ca(t,We,Math.PI),t):s>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(ka.cross(We,e,r),t[0]=We[0],t[1]=We[1],t[2]=We[2],t[3]=1+s,ke(t,t))});Bt.rotationTo=Pt;var ti,Qt,oi=(ti=Va(),Qt=Va(),function(t,e,r,s,u,d){return G(ti,e,u,d),G(Qt,r,s,d),G(t,ti,Qt,2*d*(1-d)),t});Bt.sqlerp=oi;var Ei,Wi=(Ei=lo.create(),function(t,e,r,s){return Ei[0]=r[0],Ei[3]=r[1],Ei[6]=r[2],Ei[1]=s[0],Ei[4]=s[1],Ei[7]=s[2],Ei[2]=-e[0],Ei[5]=-e[1],Ei[8]=-e[2],ke(t,Q(t,Ei))});Bt.setAxes=Wi;var wi={};function wr(t){return wr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wr(t)}Object.defineProperty(wi,"__esModule",{value:!0}),wi.create=function(){var t=new dr.ARRAY_TYPE(8);return dr.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t},wi.clone=function(t){var e=new dr.ARRAY_TYPE(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e},wi.fromValues=function(t,e,r,s,u,d,p,_){var v=new dr.ARRAY_TYPE(8);return v[0]=t,v[1]=e,v[2]=r,v[3]=s,v[4]=u,v[5]=d,v[6]=p,v[7]=_,v},wi.fromRotationTranslationValues=function(t,e,r,s,u,d,p){var _=new dr.ARRAY_TYPE(8);_[0]=t,_[1]=e,_[2]=r,_[3]=s;var v=.5*u,w=.5*d,E=.5*p;return _[4]=v*s+w*r-E*e,_[5]=w*s+E*t-v*r,_[6]=E*s+v*e-w*t,_[7]=-v*t-w*e-E*r,_},wi.fromRotationTranslation=On,wi.fromTranslation=function(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t},wi.fromRotation=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},wi.fromMat4=function(t,e){var r=yr.create();xn.getRotation(r,e);var s=new dr.ARRAY_TYPE(3);return xn.getTranslation(s,e),On(t,r,s),t},wi.copy=sn,wi.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},wi.set=function(t,e,r,s,u,d,p,_,v){return t[0]=e,t[1]=r,t[2]=s,t[3]=u,t[4]=d,t[5]=p,t[6]=_,t[7]=v,t},wi.getDual=function(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t},wi.setDual=function(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t},wi.getTranslation=function(t,e){var r=e[4],s=e[5],u=e[6],d=e[7],p=-e[0],_=-e[1],v=-e[2],w=e[3];return t[0]=2*(r*w+d*p+s*v-u*_),t[1]=2*(s*w+d*_+u*p-r*v),t[2]=2*(u*w+d*v+r*_-s*p),t},wi.translate=function(t,e,r){var s=e[0],u=e[1],d=e[2],p=e[3],_=.5*r[0],v=.5*r[1],w=.5*r[2],E=e[4],k=e[5],D=e[6],N=e[7];return t[0]=s,t[1]=u,t[2]=d,t[3]=p,t[4]=p*_+u*w-d*v+E,t[5]=p*v+d*_-s*w+k,t[6]=p*w+s*v-u*_+D,t[7]=-s*_-u*v-d*w+N,t},wi.rotateX=function(t,e,r){var s=-e[0],u=-e[1],d=-e[2],p=e[3],_=e[4],v=e[5],w=e[6],E=e[7],k=_*p+E*s+v*d-w*u,D=v*p+E*u+w*s-_*d,N=w*p+E*d+_*u-v*s,B=E*p-_*s-v*u-w*d;return yr.rotateX(t,e,r),t[4]=k*(p=t[3])+B*(s=t[0])+D*(d=t[2])-N*(u=t[1]),t[5]=D*p+B*u+N*s-k*d,t[6]=N*p+B*d+k*u-D*s,t[7]=B*p-k*s-D*u-N*d,t},wi.rotateY=function(t,e,r){var s=-e[0],u=-e[1],d=-e[2],p=e[3],_=e[4],v=e[5],w=e[6],E=e[7],k=_*p+E*s+v*d-w*u,D=v*p+E*u+w*s-_*d,N=w*p+E*d+_*u-v*s,B=E*p-_*s-v*u-w*d;return yr.rotateY(t,e,r),t[4]=k*(p=t[3])+B*(s=t[0])+D*(d=t[2])-N*(u=t[1]),t[5]=D*p+B*u+N*s-k*d,t[6]=N*p+B*d+k*u-D*s,t[7]=B*p-k*s-D*u-N*d,t},wi.rotateZ=function(t,e,r){var s=-e[0],u=-e[1],d=-e[2],p=e[3],_=e[4],v=e[5],w=e[6],E=e[7],k=_*p+E*s+v*d-w*u,D=v*p+E*u+w*s-_*d,N=w*p+E*d+_*u-v*s,B=E*p-_*s-v*u-w*d;return yr.rotateZ(t,e,r),t[4]=k*(p=t[3])+B*(s=t[0])+D*(d=t[2])-N*(u=t[1]),t[5]=D*p+B*u+N*s-k*d,t[6]=N*p+B*d+k*u-D*s,t[7]=B*p-k*s-D*u-N*d,t},wi.rotateByQuatAppend=function(t,e,r){var s=r[0],u=r[1],d=r[2],p=r[3],_=e[0],v=e[1],w=e[2],E=e[3];return t[0]=_*p+E*s+v*d-w*u,t[1]=v*p+E*u+w*s-_*d,t[2]=w*p+E*d+_*u-v*s,t[3]=E*p-_*s-v*u-w*d,t[4]=(_=e[4])*p+(E=e[7])*s+(v=e[5])*d-(w=e[6])*u,t[5]=v*p+E*u+w*s-_*d,t[6]=w*p+E*d+_*u-v*s,t[7]=E*p-_*s-v*u-w*d,t},wi.rotateByQuatPrepend=function(t,e,r){var s=e[0],u=e[1],d=e[2],p=e[3],_=r[0],v=r[1],w=r[2],E=r[3];return t[0]=s*E+p*_+u*w-d*v,t[1]=u*E+p*v+d*_-s*w,t[2]=d*E+p*w+s*v-u*_,t[3]=p*E-s*_-u*v-d*w,t[4]=s*(E=r[7])+p*(_=r[4])+u*(w=r[6])-d*(v=r[5]),t[5]=u*E+p*v+d*_-s*w,t[6]=d*E+p*w+s*v-u*_,t[7]=p*E-s*_-u*v-d*w,t},wi.rotateAroundAxis=function(t,e,r,s){if(Math.abs(s)<dr.EPSILON)return sn(t,e);var u=Math.hypot(r[0],r[1],r[2]);s*=.5;var d=Math.sin(s),p=d*r[0]/u,_=d*r[1]/u,v=d*r[2]/u,w=Math.cos(s),E=e[0],k=e[1],D=e[2],N=e[3];t[0]=E*w+N*p+k*v-D*_,t[1]=k*w+N*_+D*p-E*v,t[2]=D*w+N*v+E*_-k*p,t[3]=N*w-E*p-k*_-D*v;var B=e[4],q=e[5],Z=e[6],oe=e[7];return t[4]=B*w+oe*p+q*v-Z*_,t[5]=q*w+oe*_+Z*p-B*v,t[6]=Z*w+oe*v+B*_-q*p,t[7]=oe*w-B*p-q*_-Z*v,t},wi.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t},wi.multiply=Fl,wi.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t},wi.lerp=function(t,e,r,s){var u=1-s;return oh(e,r)<0&&(s=-s),t[0]=e[0]*u+r[0]*s,t[1]=e[1]*u+r[1]*s,t[2]=e[2]*u+r[2]*s,t[3]=e[3]*u+r[3]*s,t[4]=e[4]*u+r[4]*s,t[5]=e[5]*u+r[5]*s,t[6]=e[6]*u+r[6]*s,t[7]=e[7]*u+r[7]*s,t},wi.invert=function(t,e){var r=nc(e);return t[0]=-e[0]/r,t[1]=-e[1]/r,t[2]=-e[2]/r,t[3]=e[3]/r,t[4]=-e[4]/r,t[5]=-e[5]/r,t[6]=-e[6]/r,t[7]=e[7]/r,t},wi.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t},wi.normalize=function(t,e){var r=nc(e);if(r>0){r=Math.sqrt(r);var s=e[0]/r,u=e[1]/r,d=e[2]/r,p=e[3]/r,_=e[4],v=e[5],w=e[6],E=e[7],k=s*_+u*v+d*w+p*E;t[0]=s,t[1]=u,t[2]=d,t[3]=p,t[4]=(_-s*k)/r,t[5]=(v-u*k)/r,t[6]=(w-d*k)/r,t[7]=(E-p*k)/r}return t},wi.str=function(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"},wi.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]},wi.equals=function(t,e){var r=t[0],s=t[1],u=t[2],d=t[3],p=t[4],_=t[5],v=t[6],w=t[7],E=e[0],k=e[1],D=e[2],N=e[3],B=e[4],q=e[5],Z=e[6],oe=e[7];return Math.abs(r-E)<=dr.EPSILON*Math.max(1,Math.abs(r),Math.abs(E))&&Math.abs(s-k)<=dr.EPSILON*Math.max(1,Math.abs(s),Math.abs(k))&&Math.abs(u-D)<=dr.EPSILON*Math.max(1,Math.abs(u),Math.abs(D))&&Math.abs(d-N)<=dr.EPSILON*Math.max(1,Math.abs(d),Math.abs(N))&&Math.abs(p-B)<=dr.EPSILON*Math.max(1,Math.abs(p),Math.abs(B))&&Math.abs(_-q)<=dr.EPSILON*Math.max(1,Math.abs(_),Math.abs(q))&&Math.abs(v-Z)<=dr.EPSILON*Math.max(1,Math.abs(v),Math.abs(Z))&&Math.abs(w-oe)<=dr.EPSILON*Math.max(1,Math.abs(w),Math.abs(oe))},wi.sqrLen=wi.squaredLength=wi.len=wi.length=wi.dot=wi.mul=wi.setReal=wi.getReal=void 0;var dr=En(de),yr=En(Bt),xn=En(Ue);function en(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(en=function(s){return s?r:e})(t)}function En(t,e){if(t&&t.__esModule)return t;if(t===null||wr(t)!=="object"&&typeof t!="function")return{default:t};var r=en(e);if(r&&r.has(t))return r.get(t);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in t)if(d!=="default"&&Object.prototype.hasOwnProperty.call(t,d)){var p=u?Object.getOwnPropertyDescriptor(t,d):null;p&&(p.get||p.set)?Object.defineProperty(s,d,p):s[d]=t[d]}return s.default=t,r&&r.set(t,s),s}function On(t,e,r){var s=.5*r[0],u=.5*r[1],d=.5*r[2],p=e[0],_=e[1],v=e[2],w=e[3];return t[0]=p,t[1]=_,t[2]=v,t[3]=w,t[4]=s*w+u*v-d*_,t[5]=u*w+d*p-s*v,t[6]=d*w+s*_-u*p,t[7]=-s*p-u*_-d*v,t}function sn(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Fl(t,e,r){var s=e[0],u=e[1],d=e[2],p=e[3],_=r[4],v=r[5],w=r[6],E=r[7],k=e[4],D=e[5],N=e[6],B=e[7],q=r[0],Z=r[1],oe=r[2],ve=r[3];return t[0]=s*ve+p*q+u*oe-d*Z,t[1]=u*ve+p*Z+d*q-s*oe,t[2]=d*ve+p*oe+s*Z-u*q,t[3]=p*ve-s*q-u*Z-d*oe,t[4]=s*E+p*_+u*w-d*v+k*ve+B*q+D*oe-N*Z,t[5]=u*E+p*v+d*_-s*w+D*ve+B*Z+N*q-k*oe,t[6]=d*E+p*w+s*v-u*_+N*ve+B*oe+k*Z-D*q,t[7]=p*E-s*_-u*v-d*w+B*ve-k*q-D*Z-N*oe,t}wi.getReal=yr.copy,wi.setReal=yr.copy,wi.mul=Fl;var oh=yr.dot;wi.dot=oh;var Zh=yr.length;wi.length=Zh,wi.len=Zh;var nc=yr.squaredLength;wi.squaredLength=nc,wi.sqrLen=nc;var sr={};function Cs(t){return Cs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cs(t)}Object.defineProperty(sr,"__esModule",{value:!0}),sr.create=fu,sr.clone=function(t){var e=new Is.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},sr.fromValues=function(t,e){var r=new Is.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r},sr.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},sr.set=function(t,e,r){return t[0]=e,t[1]=r,t},sr.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},sr.subtract=sh,sr.multiply=Yh,sr.divide=lh,sr.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},sr.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},sr.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},sr.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},sr.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},sr.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},sr.scaleAndAdd=function(t,e,r,s){return t[0]=e[0]+r[0]*s,t[1]=e[1]+r[1]*s,t},sr.distance=Kh,sr.squaredDistance=ch,sr.length=Jh,sr.squaredLength=pu,sr.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},sr.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},sr.normalize=function(t,e){var r=e[0],s=e[1],u=r*r+s*s;return u>0&&(u=1/Math.sqrt(u)),t[0]=e[0]*u,t[1]=e[1]*u,t},sr.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},sr.cross=function(t,e,r){var s=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=s,t},sr.lerp=function(t,e,r,s){var u=e[0],d=e[1];return t[0]=u+s*(r[0]-u),t[1]=d+s*(r[1]-d),t},sr.random=function(t,e){e=e||1;var r=2*Is.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},sr.transformMat2=function(t,e,r){var s=e[0],u=e[1];return t[0]=r[0]*s+r[2]*u,t[1]=r[1]*s+r[3]*u,t},sr.transformMat2d=function(t,e,r){var s=e[0],u=e[1];return t[0]=r[0]*s+r[2]*u+r[4],t[1]=r[1]*s+r[3]*u+r[5],t},sr.transformMat3=function(t,e,r){var s=e[0],u=e[1];return t[0]=r[0]*s+r[3]*u+r[6],t[1]=r[1]*s+r[4]*u+r[7],t},sr.transformMat4=function(t,e,r){var s=e[0],u=e[1];return t[0]=r[0]*s+r[4]*u+r[12],t[1]=r[1]*s+r[5]*u+r[13],t},sr.rotate=function(t,e,r,s){var u=e[0]-r[0],d=e[1]-r[1],p=Math.sin(s),_=Math.cos(s);return t[0]=u*_-d*p+r[0],t[1]=u*p+d*_+r[1],t},sr.angle=function(t,e){var r=t[0],s=t[1],u=e[0],d=e[1],p=Math.sqrt(r*r+s*s)*Math.sqrt(u*u+d*d);return Math.acos(Math.min(Math.max(p&&(r*u+s*d)/p,-1),1))},sr.zero=function(t){return t[0]=0,t[1]=0,t},sr.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},sr.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},sr.equals=function(t,e){var r=t[0],s=t[1],u=e[0],d=e[1];return Math.abs(r-u)<=Is.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(s-d)<=Is.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))},sr.forEach=sr.sqrLen=sr.sqrDist=sr.dist=sr.div=sr.mul=sr.sub=sr.len=void 0;var Is=function(t,e){if(t&&t.__esModule)return t;if(t===null||Cs(t)!=="object"&&typeof t!="function")return{default:t};var r=Oo(void 0);if(r&&r.has(t))return r.get(t);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in t)if(d!=="default"&&Object.prototype.hasOwnProperty.call(t,d)){var p=u?Object.getOwnPropertyDescriptor(t,d):null;p&&(p.get||p.set)?Object.defineProperty(s,d,p):s[d]=t[d]}return s.default=t,r&&r.set(t,s),s}(de);function Oo(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(Oo=function(s){return s?r:e})(t)}function fu(){var t=new Is.ARRAY_TYPE(2);return Is.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function sh(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function Yh(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function lh(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function Kh(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1])}function ch(t,e){var r=e[0]-t[0],s=e[1]-t[1];return r*r+s*s}function Jh(t){return Math.hypot(t[0],t[1])}function pu(t){var e=t[0],r=t[1];return e*e+r*r}sr.len=Jh,sr.sub=sh,sr.mul=Yh,sr.div=lh,sr.dist=Kh,sr.sqrDist=ch,sr.sqrLen=pu;var Wd=function(){var t=fu();return function(e,r,s,u,d,p){var _,v;for(r||(r=2),s||(s=0),v=u?Math.min(u*r+s,e.length):e.length,_=s;_<v;_+=r)t[0]=e[_],t[1]=e[_+1],d(t,t,p),e[_]=t[0],e[_+1]=t[1];return e}}();function Oc(t){return Oc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oc(t)}sr.forEach=Wd,Object.defineProperty(ne,"__esModule",{value:!0}),i.aA=ne.vec4=i._=ne.vec3=ne.vec2=ne.quat2=i.av=ne.quat=i.ad=ne.mat4=i.bC=ne.mat3=ne.mat2d=i.aC=ne.mat2=ne.glMatrix=void 0;var uh=co(de);ne.glMatrix=uh;var qs=co(ge);i.aC=ne.mat2=qs;var mu=co(Ce);ne.mat2d=mu;var gu=co(ht);i.bC=ne.mat3=gu;var Qh=co(Ue);i.ad=ne.mat4=Qh;var Ua=co(Bt);i.av=ne.quat=Ua;var Cr=co(wi);ne.quat2=Cr;var qd=co(sr);ne.vec2=qd;var Nr=co(ni);i._=ne.vec3=Nr;var Qf=co(Di);function ed(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(ed=function(s){return s?r:e})(t)}function co(t,e){if(t&&t.__esModule)return t;if(t===null||Oc(t)!=="object"&&typeof t!="function")return{default:t};var r=ed(e);if(r&&r.has(t))return r.get(t);var s={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in t)if(d!=="default"&&Object.prototype.hasOwnProperty.call(t,d)){var p=u?Object.getOwnPropertyDescriptor(t,d):null;p&&(p.get||p.set)?Object.defineProperty(s,d,p):s[d]=t[d]}return s.default=t,r&&r.set(t,s),s}i.aA=ne.vec4=Qf;var hh=Nc;function Nc(t,e,r,s){this.cx=3*t,this.bx=3*(r-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(s-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=r,this.p2y=s}Nc.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(e===void 0&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var r=t,s=0;s<8;s++){var u=this.sampleCurveX(r)-t;if(Math.abs(u)<e)return r;var d=this.sampleCurveDerivativeX(r);if(Math.abs(d)<1e-6)break;r-=u/d}var p=0,_=1;for(r=t,s=0;s<20&&(u=this.sampleCurveX(r),!(Math.abs(u-t)<e));s++)t>u?p=r:_=r,r=.5*(_-p)+p;return r},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var Pl=K(hh),Bc=ac;function ac(t,e){this.x=t,this.y=e}ac.prototype={clone:function(){return new ac(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),s=r*this.x+e*this.y;return this.x=e*this.x-r*this.y,this.y=s,this},_rotateAround:function(t,e){var r=Math.cos(t),s=Math.sin(t),u=e.y+s*(this.x-e.x)+r*(this.y-e.y);return this.x=e.x+r*(this.x-e.x)-s*(this.y-e.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ac.convert=function(t){return t instanceof ac?t:Array.isArray(t)?new ac(t[0],t[1]):t};var hi=K(Bc);let $d=Math.PI/180,oc=180/Math.PI;function Tr(t){return t*$d}function va(t){return t*oc}let Xd=[[0,0],[1,0],[1,1],[0,1]];function sc(t){if(t<=0)return 0;if(t>=1)return 1;let e=t*t,r=e*t;return 4*(t<.5?r:3*(t-e)+r-.75)}function lc(t,e,r,s){let u=new Pl(t,e,r,s);return function(d){return u.solve(d)}}let dl=lc(.25,.1,.25,1);function lr(t,e,r){return Math.min(r,Math.max(e,t))}function Ll(t,e,r){return(r=lr((r-t)/(e-t),0,1))*r*(3-2*r)}function Rl(t,e,r){let s=r-e,u=((t-e)%s+s)%s+e;return u===e?r:u}function cc(t,e,r){if(!t.length)return r(null,[]);let s=t.length,u=new Array(t.length),d=null;t.forEach((p,_)=>{e(p,(v,w)=>{v&&(d=v),u[_]=w,--s==0&&r(d,u)})})}function eo(t){let e=[];for(let r in t)e.push(t[r]);return e}function ya(t,...e){for(let r of e)for(let s in r)t[s]=r[s];return t}let ep=1;function fl(){return ep++}function os(){return function t(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function _u(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function uc(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function dh(t,e){t.forEach(r=>{e[r]&&(e[r]=e[r].bind(e))})}function Ol(t,e){return t.indexOf(e,t.length-e.length)!==-1}function zc(t,e,r){let s={};for(let u in t)s[u]=e.call(this,t[u],u,t);return s}function pl(t,e,r){let s={};for(let u in t)e.call(this,t[u],u,t)&&(s[u]=t[u]);return s}function ss(t){return Array.isArray(t)?t.map(ss):typeof t=="object"&&t?zc(t,ss):t}let fh={};function Nn(t){fh[t]||(typeof console<"u"&&console.warn(t),fh[t]=!0)}function ls(t,e,r){return(r.y-t.y)*(e.x-t.x)>(e.y-t.y)*(r.x-t.x)}function to(t){let e=0;for(let r,s,u=0,d=t.length,p=d-1;u<d;p=u++)r=t[u],s=t[p],e+=(s.x-r.x)*(r.y+s.y);return e}function $s([t,e,r]){let s=Tr(e+90),u=Tr(r);return{x:t*Math.cos(s)*Math.sin(u),y:t*Math.sin(s)*Math.sin(u),z:t*Math.cos(u),azimuthal:e,polar:r}}function io(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function jc(t){let e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,s,u,d)=>{let p=u||d;return e[s]=!p||p.toLowerCase(),""}),e["max-age"]){let r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e}let hc,Vc,ks,dc,U,Ee,ct=null;function vt(t){try{let e=self[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Rt(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}function si(t,e,r,s){for(;e<r;){let u=e+r>>1;t[u]<s?e=u+1:r=u}return e}function Mi(t,e,r,s){for(;e<r;){let u=e+r>>1;t[u]<=s?e=u+1:r=u}return e}function Zi(t){return t>0?1/(1.001-t):1+t}function cr(t){return t>0?1-1/(1.001-t):-t}function Mr(){return hc==null&&(hc=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),hc}let ur={now:()=>dc!==void 0?dc:performance.now(),setNow(t){dc=t},restoreNow(){dc=void 0},frame(t){let e=requestAnimationFrame(t);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(t,e=0){let{width:r,height:s}=t;U||(U=document.createElement("canvas"));let u=U.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return(r>U.width||s>U.height)&&(U.width=r,U.height=s),u.clearRect(-e,-e,r+2*e,s+2*e),u.drawImage(t,0,0,r,s),u.getImageData(-e,-e,r+2*e,s+2*e)},resolveURL:t=>(Vc||(Vc=document.createElement("a")),Vc.href=t,Vc.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(ks==null&&(ks=window.matchMedia("(prefers-reduced-motion: reduce)")),ks.matches)},hasCanvasFingerprintNoise(){if(Ee!==void 0)return Ee;if(!Mr())return Ee=!1,!1;let t=new OffscreenCanvas(85,1),e=t.getContext("2d",{willReadFrequently:!0}),r=0;for(let u=0;u<t.width;++u)e.fillStyle=`rgba(${r++},${r++},${r++}, 255)`,e.fillRect(u,0,1,1);let s=e.getImageData(0,0,t.width,t.height);r=0;for(let u=0;u<s.data.length;++u)if(u%4!=3&&r++!==s.data[u])return Ee=!0,!0;return Ee=!1,!1}};function ln(t,e){let r=t.indexOf("?");if(r<0)return`${t}?${new URLSearchParams(e).toString()}`;let s=new URLSearchParams(t.slice(r));for(let u in e)s.set(u,e[u]);return`${t.slice(0,r)}?${s.toString()}`}function ua(t,e={persistentParams:[]}){let r=t.indexOf("?");if(r<0)return t;let s=new URLSearchParams,u=new URLSearchParams(t.slice(r));for(let p of e.persistentParams){let _=u.get(p);_&&s.set(p,_)}let d=s.toString();return`${t.slice(0,r)}${d.length>0?`?${d}`:""}`}let Ma="mapbox-tiles",Ra=500,vo=50,ra,cs;function us(){try{return caches}catch{}}function Ms(){let t=us();t&&!ra&&(ra=t.open(Ma))}let xu=1/0,Uc={supported:!1,testSupport:function(t){!vu&&ml&&(yu?Zo(t):Nl=t)}},Nl,ml,vu=!1,yu=!1,Hc=typeof self<"u"?self:{};function Zo(t){let e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,ml),t.isContextLost())return;Uc.supported=!0}catch{}t.deleteTexture(e),vu=!0}Hc.document&&(ml=Hc.document.createElement("img"),ml.onload=function(){Nl&&Zo(Nl),Nl=null,yu=!0},ml.onerror=function(){vu=!0,Nl=null},ml.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");let fc={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(fc);class Gc extends Error{constructor(e,r,s){r===401&&M(s)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=r,this.url=s}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}let pc=io()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,mc=function(t,e){if(!(/^file:/.test(r=t.url)||/^file:/.test(pc())&&!/^\w+:/.test(r))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(s,u){let d=new AbortController,p=new Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:pc(),referrerPolicy:s.referrerPolicy,signal:d.signal}),_=!1,v=!1,w=(E=p.url).indexOf("sku=")>0&&M(E);var E;s.type==="json"&&p.headers.set("Accept","application/json");let k=(N,B,q)=>{if(v)return;if(N&&N.message!=="SecurityError"&&Nn(N.toString()),B&&q)return D(B);let Z=Date.now();fetch(p).then(oe=>{if(oe.ok){let ve=w?oe.clone():null;return D(oe,ve,Z)}return u(new Gc(oe.statusText,oe.status,s.url))}).catch(oe=>{oe.name!=="AbortError"&&u(new Error(`${oe.message} ${s.url}`))})},D=(N,B,q)=>{(s.type==="arrayBuffer"?N.arrayBuffer():s.type==="json"?N.json():N.text()).then(Z=>{v||(B&&q&&function(oe,ve,be){if(Ms(),!ra)return;let we=jc(ve.headers.get("Cache-Control")||"");if(we["no-store"])return;let $e={status:ve.status,statusText:ve.statusText,headers:new Headers};ve.headers.forEach((ot,_t)=>$e.headers.set(_t,ot)),we["max-age"]&&$e.headers.set("Expires",new Date(be+1e3*we["max-age"]).toUTCString());let Ge=$e.headers.get("Expires");if(!Ge||new Date(Ge).getTime()-be<42e4)return;let it=ua(oe.url,{persistentParams:["language","worldview"]});if(ve.status===206){let ot=oe.headers.get("Range");if(!ot)return;$e.status=200,it=ln(it,{range:ot})}(function(ot,_t){if(cs===void 0)try{new Response(new ReadableStream),cs=!0}catch{cs=!1}cs?_t(ot.body):ot.blob().then(_t)})(ve,ot=>{let _t=new Response((Mt=ve.status)!==200&&Mt!==404&&[101,103,204,205,304].includes(Mt)?null:ot,$e);var Mt;Ms(),ra&&ra.then(At=>At.put(it,_t)).catch(At=>Nn(At.message))})}(p,B,q),_=!0,u(null,Z,N.headers.get("Cache-Control"),N.headers.get("Expires")))}).catch(Z=>{v||u(new Error(Z.message))})};return w?function(N,B){if(Ms(),!ra)return B(null);ra.then(q=>{let Z=ua(N.url,{persistentParams:["language","worldview"]}),oe=N.headers.get("Range");oe&&(Z=ln(Z,{range:oe})),q.match(Z).then(ve=>{let be=function(we){if(!we)return!1;let $e=new Date(we.headers.get("Expires")||0),Ge=jc(we.headers.get("Cache-Control")||"");return $e>Date.now()&&!Ge["no-cache"]}(ve);q.delete(Z),be&&q.put(Z,ve.clone()),B(null,ve,be)}).catch(B)}).catch(B)}(p,k):k(null,null),{cancel:()=>{v=!0,_||d.abort()}}}(t,e);if(io()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var r;return function(s,u){let d=new XMLHttpRequest;d.open(s.method||"GET",s.url,!0),s.type==="arrayBuffer"&&(d.responseType="arraybuffer");for(let p in s.headers)d.setRequestHeader(p,s.headers[p]);return s.type==="json"&&(d.responseType="text",d.setRequestHeader("Accept","application/json")),d.withCredentials=s.credentials==="include",d.onerror=()=>{u(new Error(d.statusText))},d.onload=()=>{if((d.status>=200&&d.status<300||d.status===0)&&d.response!==null){let p=d.response;if(s.type==="json")try{p=JSON.parse(d.response)}catch(_){return u(_)}u(null,p,d.getResponseHeader("Cache-Control"),d.getResponseHeader("Expires"))}else u(new Gc(d.statusText,d.status,s.url))},d.send(s.body),{cancel:()=>d.abort()}}(t,e)},ro=function(t,e){return mc(ya(t,{type:"arrayBuffer"}),e)};function Zd(t){let e=document.createElement("a");return e.href=t,e.protocol===location.protocol&&e.host===location.host}let bu="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",Wc,Yo;Wc=[],Yo=0;let Xs=function(t,e){if(Uc.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),Yo>=A.MAX_PARALLEL_IMAGE_REQUESTS){let d={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return Wc.push(d),d}Yo++;let r=!1,s=()=>{if(!r)for(r=!0,Yo--;Wc.length&&Yo<A.MAX_PARALLEL_IMAGE_REQUESTS;){let d=Wc.shift(),{requestParameters:p,callback:_,cancelled:v}=d;v||(d.cancel=Xs(p,_).cancel)}},u=ro(t,(d,p,_,v)=>{s(),d?e(d):p&&(self.createImageBitmap?function(w,E){let k=new Blob([new Uint8Array(w)],{type:"image/png"});createImageBitmap(k).then(D=>{E(null,D)}).catch(D=>{E(new Error(`Could not load image because of ${D.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(p,(w,E)=>e(w,E,_,v)):function(w,E){let k=new Image;k.onload=()=>{E(null,k),URL.revokeObjectURL(k.src),k.onload=null,requestAnimationFrame(()=>{k.src=bu})},k.onerror=()=>E(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let D=new Blob([new Uint8Array(w)],{type:"image/png"});k.src=w.byteLength?URL.createObjectURL(D):bu}(p,(w,E)=>e(w,E,_,v)))});return{cancel:()=>{u.cancel(),s()}}},td="01",id="NO_ACCESS_TOKEN",qc=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Oa(t){let e=t.match(qc);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function No(t){let e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}let gl="mapbox.eventData";function _l(t){if(!t)return null;let e=t.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(atob(e[1]).split("").map(r=>"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Ds{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){let r=_l(A.ACCESS_TOKEN),s="";return s=r&&r.u?btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,(u,d)=>String.fromCharCode(+("0x"+d)))):A.ACCESS_TOKEN||"",e?`${gl}.${e}:${s}`:`${gl}:${s}`}fetchEventData(){let e=vt("localStorage"),r=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{let u=localStorage.getItem(r);u&&(this.eventData=JSON.parse(u));let d=localStorage.getItem(s);d&&(this.anonId=d)}catch{Nn("Unable to read from LocalStorage")}}saveEventData(){let e=vt("localStorage"),r=this.getStorageKey(),s=this.getStorageKey("uuid"),u=this.anonId;if(e&&u)try{localStorage.setItem(s,u),Object.keys(this.eventData).length>=1&&localStorage.setItem(r,JSON.stringify(this.eventData))}catch{Nn("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,r,s,u){if(!A.EVENTS_URL)return;let d=Oa(A.EVENTS_URL);d.params.push(`access_token=${u||A.ACCESS_TOKEN||""}`);let p={event:this.type,created:new Date(e).toISOString()},_=r?ya(p,r):p,v={url:No(d),headers:{"Content-Type":"text/plain"},body:JSON.stringify([_])};this.pendingRequest=function(w,E){return mc(ya(w,{method:"POST"}),E)}(v,w=>{this.pendingRequest=null,s(w),this.saveEventData(),this.processRequests(u)})}queueRequest(e,r){this.queue.push(e),this.processRequests(r)}}let wu=new class extends Ds{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){A.EVENTS_URL&&A.ACCESS_TOKEN&&Array.isArray(t)&&t.some(r=>F(r)||M(r))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();let e=_l(A.ACCESS_TOKEN),r=e?e.u:A.ACCESS_TOKEN,s=r!==this.eventData.tokenU;uc(this.anonId)||(this.anonId=os(),s=!0);let u=this.queue.shift();if(this.eventData.lastSuccess){let d=new Date(this.eventData.lastSuccess),p=new Date(u),_=(u-this.eventData.lastSuccess)/864e5;s=s||_>=1||_<-1||d.getDate()!==p.getDate()}else s=!0;s?this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:x,skuId:td,"enabled.telemetry":!1,userId:this.anonId},d=>{d||(this.eventData.lastSuccess=u,this.eventData.tokenU=r)},t):this.processRequests()}},Fs=wu.postTurnstileEvent.bind(wu),Bl=new class extends Ds{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,r,s){this.skuToken=e,this.errorCb=s,A.EVENTS_URL&&(r||A.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},r):this.errorCb(new Error(id)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;let{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),uc(this.anonId)||(this.anonId=os()),this.postEvent(r,{sdkIdentifier:"mapbox-gl-js",sdkVersion:x,skuId:td,skuToken:this.skuToken,userId:this.anonId},s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},t))}remove(){this.errorCb=null}},ph=Bl.postMapLoadEvent.bind(Bl),gc=new class extends Ds{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(t){let e=this.mapInstanceIdMap.get(t);return e||(e=os(),this.mapInstanceIdMap.set(t,e)),e}getEventId(t){let e=this.eventIdPerMapInstanceMap.get(t)||0;return this.eventIdPerMapInstanceMap.set(t,e+1),e}postStyleLoadEvent(t,e){let{map:r,style:s,importedStyles:u}=e;if(!A.EVENTS_URL||!t&&!A.ACCESS_TOKEN)return;let d=this.getMapInstanceId(r),p={mapInstanceId:d,eventId:this.getEventId(d),style:s};u.length&&(p.importedStyles=u),this.queueRequest({timestamp:Date.now(),payload:p},t)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;let{timestamp:e,payload:r}=this.queue.shift();this.postEvent(e,r,()=>{},t)}},xl=gc.postStyleLoadEvent.bind(gc),Zs=new class extends Ds{constructor(){super("gljs.performance")}postPerformanceEvent(t,e){A.EVENTS_URL&&(t||A.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},t)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;let{timestamp:e,performanceData:r}=this.queue.shift(),s=function(u){let d=performance.getEntriesByType("resource"),p=performance.getEntriesByType("mark"),_=function(N){let B={};if(N){for(let q in N)if(q!=="other")for(let Z of N[q]){let oe=`${q}ResolveRangeMin`,ve=`${q}ResolveRangeMax`,be=`${q}RequestCount`,we=`${q}RequestCachedCount`;B[oe]=Math.min(B[oe]||1/0,Z.startTime),B[ve]=Math.max(B[ve]||-1/0,Z.responseEnd);let $e=Ge=>{B[Ge]===void 0&&(B[Ge]=0),++B[Ge]};Z.transferSize!==void 0&&Z.transferSize===0&&$e(we),$e(be)}}return B}(function(N,B){let q={};if(N)for(let Z of N){let oe=B(Z);q[oe]===void 0&&(q[oe]=[]),q[oe].push(Z)}return q}(d,J)),v=window.devicePixelRatio,w=navigator.connection||navigator.mozConnection||navigator.webkitConnection,E=w?w.effectiveType:void 0,k={counters:[],metadata:[],attributes:[]},D=(N,B,q)=>{q!=null&&N.push({name:B,value:q.toString()})};for(let N in _)D(k.counters,N,_[N]);if(u.interactionRange[0]!==1/0&&u.interactionRange[1]!==-1/0&&(D(k.counters,"interactionRangeMin",u.interactionRange[0]),D(k.counters,"interactionRangeMax",u.interactionRange[1])),p)for(let N of Object.keys(te)){let B=te[N],q=p.find(Z=>Z.name===B);q&&D(k.counters,B,q.startTime)}return D(k.counters,"visibilityHidden",u.visibilityHidden),D(k.attributes,"style",function(N){if(N)for(let B of N){let q=B.name.split("?")[0];if(R(q)){let Z=q.split("/").slice(-2);if(Z.length===2)return`mapbox://styles/${Z[0]}/${Z[1]}`}}}(d)),D(k.attributes,"terrainEnabled",u.terrainEnabled?"true":"false"),D(k.attributes,"fogEnabled",u.fogEnabled?"true":"false"),D(k.attributes,"projection",u.projection),D(k.attributes,"zoom",u.zoom),D(k.metadata,"devicePixelRatio",v),D(k.metadata,"connectionEffectiveType",E),D(k.metadata,"navigatorUserAgent",navigator.userAgent),D(k.metadata,"screenWidth",window.screen.width),D(k.metadata,"screenHeight",window.screen.height),D(k.metadata,"windowWidth",window.innerWidth),D(k.metadata,"windowHeight",window.innerHeight),D(k.metadata,"mapWidth",u.width/v),D(k.metadata,"mapHeight",u.height/v),D(k.metadata,"webglRenderer",u.renderer),D(k.metadata,"webglVendor",u.vendor),D(k.metadata,"sdkVersion",x),D(k.metadata,"sdkIdentifier","mapbox-gl-js"),k}(r);for(let u of s.metadata);for(let u of s.counters);for(let u of s.attributes);this.postEvent(e,s,()=>{},t)}},Tu=Zs.postPerformanceEvent.bind(Zs),vl=new class extends Ds{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,r,s){if(!A.API_URL||!A.SESSION_PATH)return;let u=Oa(A.API_URL+A.SESSION_PATH);u.params.push(`sku=${e||""}`),u.params.push(`access_token=${s||A.ACCESS_TOKEN||""}`);let d={url:No(u),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(p,_){return mc(ya(p,{method:"GET"}),_)}(d,p=>{this.pendingRequest=null,r(p),this.saveEventData(),this.processRequests(s)})}getSessionAPI(t,e,r,s){this.skuToken=e,this.errorCb=s,A.SESSION_PATH&&A.API_URL&&(r||A.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},r):this.errorCb(new Error(id)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;let{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||this.getSession(r,this.skuToken,s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},t)}remove(){this.errorCb=null}},zl=vl.getSessionAPI.bind(vl),Ys=new Set;var yl={exports:{}},Ps={exports:function(t,e){var r,s,u,d,p,_,v,w;for(s=t.length-(r=3&t.length),u=e,p=3432918353,_=461845907,w=0;w<s;)v=255&t.charCodeAt(w)|(255&t.charCodeAt(++w))<<8|(255&t.charCodeAt(++w))<<16|(255&t.charCodeAt(++w))<<24,++w,u=27492+(65535&(d=5*(65535&(u=(u^=v=(65535&(v=(v=(65535&v)*p+(((v>>>16)*p&65535)<<16)&4294967295)<<15|v>>>17))*_+(((v>>>16)*_&65535)<<16)&4294967295)<<13|u>>>19))+((5*(u>>>16)&65535)<<16)&4294967295))+((58964+(d>>>16)&65535)<<16);switch(v=0,r){case 3:v^=(255&t.charCodeAt(w+2))<<16;case 2:v^=(255&t.charCodeAt(w+1))<<8;case 1:u^=v=(65535&(v=(v=(65535&(v^=255&t.charCodeAt(w)))*p+(((v>>>16)*p&65535)<<16)&4294967295)<<15|v>>>17))*_+(((v>>>16)*_&65535)<<16)&4294967295}return u^=t.length,u=2246822507*(65535&(u^=u>>>16))+((2246822507*(u>>>16)&65535)<<16)&4294967295,u=3266489909*(65535&(u^=u>>>13))+((3266489909*(u>>>16)&65535)<<16)&4294967295,(u^=u>>>16)>>>0}},_c={exports:function(t,e){for(var r,s=t.length,u=e^s,d=0;s>=4;)r=1540483477*(65535&(r=255&t.charCodeAt(d)|(255&t.charCodeAt(++d))<<8|(255&t.charCodeAt(++d))<<16|(255&t.charCodeAt(++d))<<24))+((1540483477*(r>>>16)&65535)<<16),u=1540483477*(65535&u)+((1540483477*(u>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),s-=4,++d;switch(s){case 3:u^=(255&t.charCodeAt(d+2))<<16;case 2:u^=(255&t.charCodeAt(d+1))<<8;case 1:u=1540483477*(65535&(u^=255&t.charCodeAt(d)))+((1540483477*(u>>>16)&65535)<<16)}return u=1540483477*(65535&(u^=u>>>13))+((1540483477*(u>>>16)&65535)<<16),(u^=u>>>15)>>>0}},Xn=Ps.exports,Vn=_c.exports;yl.exports=Xn,yl.exports.murmur3=Xn,yl.exports.murmur2=Vn;var na=K(yl.exports);function Ha(t,e,r){r[t]&&r[t].indexOf(e)!==-1||(r[t]=r[t]||[],r[t].push(e))}function hs(t,e,r){if(r&&r[t]){let s=r[t].indexOf(e);s!==-1&&r[t].splice(s,1)}}class Na{constructor(e,r={}){ya(this,r),this.type=e}}class xc extends Na{constructor(e,r={}){super("error",ya({error:e},r))}}class jl{on(e,r){return this._listeners=this._listeners||{},Ha(e,r,this._listeners),this}off(e,r){return hs(e,r,this._listeners),hs(e,r,this._oneTimeListeners),this}once(e,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},Ha(e,r,this._oneTimeListeners),this):new Promise(s=>this.once(e,s))}fire(e,r){typeof e=="string"&&(e=new Na(e,r||{}));let s=e.type;if(this.listens(s)){e.target=this;let u=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(let _ of u)_.call(this,e);let d=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(let _ of d)hs(s,_,this._oneTimeListeners),_.call(this,e);let p=this._eventedParent;p&&(ya(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),p.fire(e))}else e instanceof xc&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}}i.F=void 0;var tp={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function rd(t){return(t=Math.round(t))<0?0:t>255?255:t}function Yd(t){return rd(t[t.length-1]==="%"?parseFloat(t)/100*255:parseInt(t))}function mh(t){return(e=t[t.length-1]==="%"?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function gh(t,e,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?t+(e-t)*r*6:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}try{i.F={}.parseCSSColor=function(t){var e,r=t.replace(/ /g,"").toLowerCase();if(r in tp)return tp[r].slice();if(r[0]==="#")return r.length===4?(e=parseInt(r.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:r.length===7&&(e=parseInt(r.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var s=r.indexOf("("),u=r.indexOf(")");if(s!==-1&&u+1===r.length){var d=r.substr(0,s),p=r.substr(s+1,u-(s+1)).split(","),_=1;switch(d){case"rgba":if(p.length!==4)return null;_=mh(p.pop());case"rgb":return p.length!==3?null:[Yd(p[0]),Yd(p[1]),Yd(p[2]),_];case"hsla":if(p.length!==4)return null;_=mh(p.pop());case"hsl":if(p.length!==3)return null;var v=(parseFloat(p[0])%360+360)%360/360,w=mh(p[1]),E=mh(p[2]),k=E<=.5?E*(w+1):E+w-E*w,D=2*E-k;return[rd(255*gh(D,k,v+1/3)),rd(255*gh(D,k,v)),rd(255*gh(D,k,v-1/3)),_];default:return null}}return null}}catch{}class jr{constructor(e,r,s,u=1){this.r=e,this.g=r,this.b=s,this.a=u}static parse(e){if(!e)return;if(e instanceof jr)return e;if(typeof e!="string")return;let r=i.F(e);return r?new jr(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3]):void 0}toString(){let[e,r,s,u]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(e)},${Math.round(r)},${Math.round(s)},${u})`}toRenderColor(e){let{r,g:s,b:u,a:d}=this;return new ip(e,r,s,u,d)}}class ip{constructor(e,r,s,u,d){if(e){let p=e.image.height,_=p*p;r=d===0?0:r/d*(p-1),s=d===0?0:s/d*(p-1),u=d===0?0:u/d*(p-1);let v=Math.floor(r),w=Math.floor(s),E=Math.floor(u),k=Math.ceil(r),D=Math.ceil(s),N=Math.ceil(u),B=r-v,q=s-w,Z=u-E,oe=e.image.data,ve=4*(v+w*_+E*p),be=4*(v+w*_+N*p),we=4*(v+D*_+E*p),$e=4*(v+D*_+N*p),Ge=4*(k+w*_+E*p),it=4*(k+w*_+N*p),ot=4*(k+D*_+E*p),_t=4*(k+D*_+N*p);if(ve<0||_t>=oe.length)throw new Error("out of range");this.r=$i($i($i(oe[ve],oe[be],Z),$i(oe[we],oe[$e],Z),q),$i($i(oe[Ge],oe[it],Z),$i(oe[ot],oe[_t],Z),q),B)/255*d,this.g=$i($i($i(oe[ve+1],oe[be+1],Z),$i(oe[we+1],oe[$e+1],Z),q),$i($i(oe[Ge+1],oe[it+1],Z),$i(oe[ot+1],oe[_t+1],Z),q),B)/255*d,this.b=$i($i($i(oe[ve+2],oe[be+2],Z),$i(oe[we+2],oe[$e+2],Z),q),$i($i(oe[Ge+2],oe[it+2],Z),$i(oe[ot+2],oe[_t+2],Z),q),B)/255*d,this.a=d}else this.r=r,this.g=s,this.b=u,this.a=d}toArray(){let{r:e,g:r,b:s,a:u}=this;return u===0?[0,0,0,0]:[255*e/u,255*r/u,255*s/u,u]}toArray01(){let{r:e,g:r,b:s,a:u}=this;return u===0?[0,0,0,0]:[e/u,r/u,s/u,u]}toArray01Scaled(e){let{r,g:s,b:u,a:d}=this;return d===0?[0,0,0]:[r/d*e,s/d*e,u/d*e]}toArray01PremultipliedAlpha(){let{r:e,g:r,b:s,a:u}=this;return[e,r,s,u]}toArray01Linear(){let{r:e,g:r,b:s,a:u}=this;return u===0?[0,0,0,0]:[Math.pow(e/u,2.2),Math.pow(r/u,2.2),Math.pow(s/u,2.2),u]}}function $i(t,e,r){return t*(1-r)+e*r}function ds(t,e,r){return t.map((s,u)=>$i(s,e[u],r))}jr.black=new jr(0,0,0,1),jr.white=new jr(1,1,1,1),jr.transparent=new jr(0,0,0,0),jr.red=new jr(1,0,0,1),jr.blue=new jr(0,0,1,1);var Ko=Object.freeze({__proto__:null,array:ds,color:function(t,e,r){return new jr($i(t.r,e.r,r),$i(t.g,e.g,r),$i(t.b,e.b,r),$i(t.a,e.a,r))},number:$i});function _h(t,...e){for(let r of e)for(let s in r)t[s]=r[s];return t}class Ls extends Error{constructor(e,r){super(r),this.message=r,this.key=e}}class Kd{constructor(e,r=[]){this.parent=e,this.bindings={};for(let[s,u]of r)this.bindings[s]=u}concat(e){return new Kd(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}let vc={kind:"null"},Ti={kind:"number"},Br={kind:"string"},Vr={kind:"boolean"},Ao={kind:"color"},$c={kind:"object"},Fr={kind:"value"},Rs={kind:"collator"},xh={kind:"formatted"},Vl={kind:"resolvedImage"};function Jo(t,e){return{kind:"array",itemType:t,N:e}}function ba(t){if(t.kind==="array"){let e=ba(t.itemType);return typeof t.N=="number"?`array<${e}, ${t.N}>`:t.itemType.kind==="value"?"array":`array<${e}>`}return t.kind}let I0=[vc,Ti,Br,Vr,Ao,xh,$c,Jo(Fr),Vl];function nd(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!nd(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(let r of I0)if(!nd(r,e))return null}}return`Expected ${ba(t)} but found ${ba(e)} instead.`}function rp(t,e){return e.some(r=>r.kind===t.kind)}function vh(t,e){return e.some(r=>r==="null"?t===null:r==="array"?Array.isArray(t):r==="object"?t&&!Array.isArray(t)&&typeof t=="object":r===typeof t)}class Su{constructor(e,r,s){this.sensitivity=e?r?"variant":"case":r?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class yc{constructor(e,r,s,u,d){this.text=e.normalize?e.normalize():e,this.image=r,this.scale=s,this.fontStack=u,this.textColor=d}}class Ga{constructor(e){this.sections=e}static fromString(e){return new Ga([new yc(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.namePrimary.length!==0)}static factory(e){return e instanceof Ga?e:Ga.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){let e=["format"];for(let r of this.sections){if(r.image){e.push(["image",r.image.namePrimary]);continue}e.push(r.text);let s={};r.fontStack&&(s["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(s["font-scale"]=r.scale),r.textColor&&(s["text-color"]=["rgba"].concat(r.textColor.toRenderColor(null).toArray())),e.push(s)}return e}}class Qo{constructor(e){this.namePrimary=e.namePrimary,e.nameSecondary&&(this.nameSecondary=e.nameSecondary),this.available=e.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(e,r){return e?new Qo({namePrimary:e,nameSecondary:r,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function sm(t,e,r,s){return typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255?s===void 0||typeof s=="number"&&s>=0&&s<=1?null:`Invalid rgba value [${[t,e,r,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof s=="number"?[t,e,r,s]:[t,e,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Bo(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof jr||t instanceof Su||t instanceof Ga||t instanceof Qo)return!0;if(Array.isArray(t)){for(let e of t)if(!Bo(e))return!1;return!0}if(typeof t=="object"){for(let e in t)if(!Bo(t[e]))return!1;return!0}return!1}function Ba(t){if(t===null)return vc;if(typeof t=="string")return Br;if(typeof t=="boolean")return Vr;if(typeof t=="number")return Ti;if(t instanceof jr)return Ao;if(t instanceof Su)return Rs;if(t instanceof Ga)return xh;if(t instanceof Qo)return Vl;if(Array.isArray(t)){let e=t.length,r;for(let s of t){let u=Ba(s);if(r){if(r===u)continue;r=Fr;break}r=u}return Jo(r||Fr,e)}return $c}function Ks(t){let e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof jr||t instanceof Ga||t instanceof Qo?t.toString():JSON.stringify(t)}class bc{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(e.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Bo(e[1]))return r.error("invalid value");let s=e[1],u=Ba(s),d=r.expectedType;return u.kind!=="array"||u.N!==0||!d||d.kind!=="array"||typeof d.N=="number"&&d.N!==0||(u=d),new bc(u,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof jr?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof Ga?this.value.serialize():this.value}}class no{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}let Ul={string:Br,number:Ti,boolean:Vr,object:$c};class Wa{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let s,u=1,d=e[0];if(d==="array"){let _,v;if(e.length>2){let w=e[1];if(typeof w!="string"||!(w in Ul)||w==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);_=Ul[w],u++}else _=Fr;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);v=e[2],u++}s=Jo(_,v)}else s=Ul[d];let p=[];for(;u<e.length;u++){let _=r.parse(e[u],u,Fr);if(!_)return null;p.push(_)}return new Wa(s,p)}evaluate(e){for(let r=0;r<this.args.length;r++){let s=this.args[r].evaluate(e);if(!nd(this.type,Ba(s)))return s;if(r===this.args.length-1)throw new no(`Expected value to be of type ${ba(this.type)}, but found ${ba(Ba(s))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){let e=this.type,r=[e.kind];if(e.kind==="array"){let s=e.itemType;if(s.kind==="string"||s.kind==="number"||s.kind==="boolean"){r.push(s.kind);let u=e.N;(typeof u=="number"||this.args.length>1)&&r.push(u)}}return r.concat(this.args.map(s=>s.serialize()))}}class Os{constructor(e){this.type=xh,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let s=e[1];if(!Array.isArray(s)&&typeof s=="object")return r.error("First argument must be an image or text section.");let u=[],d=!1;for(let p=1;p<=e.length-1;++p){let _=e[p];if(d&&typeof _=="object"&&!Array.isArray(_)){d=!1;let v=null;if(_["font-scale"]&&(v=r.parse(_["font-scale"],1,Ti),!v))return null;let w=null;if(_["text-font"]&&(w=r.parse(_["text-font"],1,Jo(Br)),!w))return null;let E=null;if(_["text-color"]&&(E=r.parse(_["text-color"],1,Ao),!E))return null;let k=u[u.length-1];k.scale=v,k.font=w,k.textColor=E}else{let v=r.parse(e[p],1,Fr);if(!v)return null;let w=v.type.kind;if(w!=="string"&&w!=="value"&&w!=="null"&&w!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");d=!0,u.push({content:v,scale:null,font:null,textColor:null})}}return new Os(u)}evaluate(e){return new Ga(this.sections.map(r=>{let s=r.content.evaluate(e);return Ba(s)===Vl?new yc("",s,null,null,null):new yc(Ks(s),null,r.scale?r.scale.evaluate(e):null,r.font?r.font.evaluate(e).join(","):null,r.textColor?r.textColor.evaluate(e):null)}))}eachChild(e){for(let r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}outputDefined(){return!1}serialize(){let e=["format"];for(let r of this.sections){e.push(r.content.serialize());let s={};r.scale&&(s["font-scale"]=r.scale.serialize()),r.font&&(s["text-font"]=r.font.serialize()),r.textColor&&(s["text-color"]=r.textColor.serialize()),e.push(s)}return e}}class ad{constructor(e,r){this.type=Vl,this.inputPrimary=e,this.inputSecondary=r}static parse(e,r){if(e.length<2)return r.error("Expected two or more arguments.");let s=r.parse(e[1],1,Br);if(!s)return r.error("No image name provided.");if(e.length===2)return new ad(s);let u=r.parse(e[2],1,Br);return u?new ad(s,u):r.error("Secondary image variant is not a string.")}evaluate(e){let r=Qo.fromString(this.inputPrimary.evaluate(e),this.inputSecondary?this.inputSecondary.evaluate(e):void 0);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(r.namePrimary)>-1,r.nameSecondary&&r.available&&e.availableImages&&(r.available=e.availableImages.indexOf(r.nameSecondary)>-1)),r}eachChild(e){e(this.inputPrimary),this.inputSecondary&&e(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function Xc(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}let Zc={"to-boolean":Vr,"to-color":Ao,"to-number":Ti,"to-string":Br};class za{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let s=e[0],u=[],d=vc;if(s==="to-array"){if(!Array.isArray(e[1]))return null;let p=e[1].length;if(r.expectedType){if(r.expectedType.kind!=="array")return r.error(`Expected ${r.expectedType.kind} but found array.`);d=Jo(r.expectedType.itemType,p)}else{if(!(p>0&&Bo(e[1][0])))return null;d=Jo(Ba(e[1][0]),p)}for(let _=0;_<p;_++){let v=e[1][_],w;if(Xc(v)==="array")w=r.parse(v,void 0,d.itemType);else{let E=Xc(v);if(E!==d.itemType.kind)return r.error(`Expected ${d.itemType.kind} but found ${E}.`);w=r.registry.literal.parse(["literal",v===void 0?null:v],r)}if(!w)return null;u.push(w)}}else{if((s==="to-boolean"||s==="to-string")&&e.length!==2)return r.error("Expected one argument.");d=Zc[s];for(let p=1;p<e.length;p++){let _=r.parse(e[p],p,Fr);if(!_)return null;u.push(_)}}return new za(d,u)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let r,s;for(let u of this.args){if(r=u.evaluate(e),s=null,r instanceof jr)return r;if(typeof r=="string"){let d=e.parseColor(r);if(d)return d}else if(Array.isArray(r)&&(s=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:sm(r[0],r[1],r[2],r[3]),!s))return new jr(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new no(s||`Could not parse color from value '${typeof r=="string"?r:String(JSON.stringify(r))}'`)}if(this.type.kind==="number"){let r=null;for(let s of this.args){if(r=s.evaluate(e),r===null)return 0;let u=Number(r);if(!isNaN(u))return u}throw new no(`Could not convert ${JSON.stringify(r)} to number.`)}return this.type.kind==="formatted"?Ga.fromString(Ks(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Qo.fromString(Ks(this.args[0].evaluate(e))):this.type.kind==="array"?this.args.map(r=>r.evaluate(e)):Ks(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Os([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new ad(this.args[0]).serialize();let e=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(r=>{e.push(r.serialize())}),e}}let lm=["Unknown","Point","LineString","Polygon"];class cm{constructor(e,r){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=e,this.options=r}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?lm[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(e){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){let e=this.featureDistanceData.center,r=this.featureDistanceData.scale,{x:s,y:u}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(s*r-e[0])+this.featureDistanceData.bearing[1]*(u*r-e[1])}return 0}parseColor(e){let r=this._parseColorCache[e];return r||(r=this._parseColorCache[e]=jr.parse(e)),r}getConfig(e){return this.options?this.options.get(e):null}}class Co{constructor(e,r,s,u,d){this.name=e,this.type=r,this._evaluate=s,this.args=u,this._overloadIndex=d}evaluate(e){if(!this._evaluate){let r=Co.definitions[this.name];this._evaluate=Array.isArray(r)?r[2]:r.overloads[this._overloadIndex][1]}return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,r){let s=e[0],u=Co.definitions[s];if(!u)return r.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);let d=Array.isArray(u)?u[0]:u.type,p=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,_=[],v=null,w=-1;for(let[E,k]of p){if(Array.isArray(E)&&E.length!==e.length-1)continue;_.push(E),w++,v=new lp(r.registry,r.path,null,r.scope,void 0,r._scope,r.options);let D=[],N=!1;for(let B=1;B<e.length;B++){let q=e[B],Z=Array.isArray(E)?E[B-1]:E.type,oe=v.parse(q,1+D.length,Z);if(!oe){N=!0;break}D.push(oe)}if(!N)if(Array.isArray(E)&&E.length!==D.length)v.error(`Expected ${E.length} arguments, but found ${D.length} instead.`);else{for(let B=0;B<D.length;B++){let q=Array.isArray(E)?E[B]:E.type,Z=D[B];v.concat(B+1).checkSubtype(q,Z.type)}if(v.errors.length===0)return new Co(s,d,k,D,w)}}if(_.length===1)r.errors.push(...v.errors);else{let E=(_.length?_:p.map(([D])=>D)).map(Jd).join(" | "),k=[];for(let D=1;D<e.length;D++){let N=r.parse(e[D],1+k.length);if(!N)return null;k.push(ba(N.type))}r.error(`Expected arguments of type ${E}, but found (${k.join(", ")}) instead.`)}return null}static register(e,r){Co.definitions=r;for(let s in r)e[s]=Co}}function Jd(t){return Array.isArray(t)?`(${t.map(ba).join(", ")})`:`(${ba(t.type)}...)`}class wc{constructor(e,r,s){this.type=Rs,this.locale=s,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(e.length!==2)return r.error("Expected one argument.");let s=e[1];if(typeof s!="object"||Array.isArray(s))return r.error("Collator options argument must be an object.");let u=r.parse(s["case-sensitive"]!==void 0&&s["case-sensitive"],1,Vr);if(!u)return null;let d=r.parse(s["diacritic-sensitive"]!==void 0&&s["diacritic-sensitive"],1,Vr);if(!d)return null;let p=null;return s.locale&&(p=r.parse(s.locale,1,Br),!p)?null:new wc(u,d,p)}evaluate(e){return new Su(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){let e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}var Qd={exports:{}};Qd.exports=function(){function t(s,u,d,p,_){for(;p>d;){if(p-d>600){var v=p-d+1,w=u-d+1,E=Math.log(v),k=.5*Math.exp(2*E/3),D=.5*Math.sqrt(E*k*(v-k)/v)*(w-v/2<0?-1:1);t(s,u,Math.max(d,Math.floor(u-w*k/v+D)),Math.min(p,Math.floor(u+(v-w)*k/v+D)),_)}var N=s[u],B=d,q=p;for(e(s,d,u),_(s[p],N)>0&&e(s,d,p);B<q;){for(e(s,B,q),B++,q--;_(s[B],N)<0;)B++;for(;_(s[q],N)>0;)q--}_(s[d],N)===0?e(s,d,q):e(s,++q,p),q<=u&&(d=q+1),u<=q&&(p=q-1)}}function e(s,u,d){var p=s[u];s[u]=s[d],s[d]=p}function r(s,u){return s<u?-1:s>u?1:0}return function(s,u,d,p,_){t(s,u,d||0,p||s.length-1,_||r)}}();var k0=K(Qd.exports);function ef(t){let e=0;for(let r,s,u=0,d=t.length,p=d-1;u<d;p=u++)r=t[u],s=t[p],e+=(s.x-r.x)*(r.y+s.y);return e}function Yc(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Hl(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function np(t,e,r){let s=t[0]-e[0],u=t[1]-e[1],d=t[0]-r[0],p=t[1]-r[1];return s*p-d*u==0&&s*d<=0&&u*p<=0}function Eu(t,e,r=!1){let s=!1;for(let _=0,v=e.length;_<v;_++){let w=e[_];for(let E=0,k=w.length,D=k-1;E<k;D=E++){let N=w[D],B=w[E];if(np(t,N,B))return r;(d=N)[1]>(u=t)[1]!=(p=B)[1]>u[1]&&u[0]<(p[0]-d[0])*(u[1]-d[1])/(p[1]-d[1])+d[0]&&(s=!s)}}var u,d,p;return s}function ap(t,e,r,s){let u=s[0]-r[0],d=s[1]-r[1],p=(t[0]-r[0])*d-u*(t[1]-r[1]),_=(e[0]-r[0])*d-u*(e[1]-r[1]);return p>0&&_<0||p<0&&_>0}function Rr(t,e,r,s){return(u=[s[0]-r[0],s[1]-r[1]])[0]*(d=[e[0]-t[0],e[1]-t[1]])[1]-u[1]*d[0]!=0&&!(!ap(t,e,r,s)||!ap(r,s,t,e));var u,d}let Tc=8192;function um(t,e){let r=(180+t[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,u=Math.pow(2,e.z);return[Math.round(r*u*Tc),Math.round(s*u*Tc)]}function M0(t,e){for(let r=0;r<e.length;r++)if(Eu(t,e[r]))return!0;return!1}function D0(t,e,r){for(let s of r)for(let u=0,d=s.length,p=d-1;u<d;p=u++)if(Rr(t,e,s[p],s[u]))return!0;return!1}function od(t,e){for(let r=0;r<t.length;++r)if(!Eu(t[r],e))return!1;for(let r=0;r<t.length-1;++r)if(D0(t[r],t[r+1],e))return!1;return!0}function tf(t,e){for(let r=0;r<e.length;r++)if(od(t,e[r]))return!0;return!1}function Au(t,e,r){let s=[];for(let u=0;u<t.length;u++){let d=[];for(let p=0;p<t[u].length;p++){let _=um(t[u][p],r);Yc(e,_),d.push(_)}s.push(d)}return s}function sd(t,e,r){let s=[];for(let u=0;u<t.length;u++){let d=Au(t[u],e,r);s.push(d)}return s}function op(t,e,r,s){if(t[0]<r[0]||t[0]>r[2]){let u=.5*s,d=t[0]-r[0]>u?-s:r[0]-t[0]>u?s:0;d===0&&(d=t[0]-r[2]>u?-s:r[2]-t[0]>u?s:0),t[0]+=d}Yc(e,t)}function bl(t,e,r,s){let u=Math.pow(2,s.z)*Tc,d=[s.x*Tc,s.y*Tc],p=[];if(!t)return p;for(let _ of t)for(let v of _){let w=[v.x+d[0],v.y+d[1]];op(w,e,r,u),p.push(w)}return p}function sp(t,e,r,s){let u=Math.pow(2,s.z)*Tc,d=[s.x*Tc,s.y*Tc],p=[];if(!t)return p;for(let v of t){let w=[];for(let E of v){let k=[E.x+d[0],E.y+d[1]];Yc(e,k),w.push(k)}p.push(w)}if(e[2]-e[0]<=u/2){(_=e)[0]=_[1]=1/0,_[2]=_[3]=-1/0;for(let v of p)for(let w of v)op(w,e,r,u)}var _;return p}class I{constructor(e,r){this.type=Vr,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Bo(e[1])){let s=e[1];if(s.type==="FeatureCollection")for(let u=0;u<s.features.length;++u){let d=s.features[u].geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new I(s,s.features[u].geometry)}else if(s.type==="Feature"){let u=s.geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new I(s,s.geometry)}else if(s.type==="Polygon"||s.type==="MultiPolygon")return new I(s,s)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(r,s){let u=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],p=r.canonicalID();if(!p)return!1;if(s.type==="Polygon"){let _=Au(s.coordinates,d,p),v=bl(r.geometry(),u,d,p);if(!Hl(u,d))return!1;for(let w of v)if(!Eu(w,_))return!1}if(s.type==="MultiPolygon"){let _=sd(s.coordinates,d,p),v=bl(r.geometry(),u,d,p);if(!Hl(u,d))return!1;for(let w of v)if(!M0(w,_))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(r,s){let u=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],p=r.canonicalID();if(!p)return!1;if(s.type==="Polygon"){let _=Au(s.coordinates,d,p),v=sp(r.geometry(),u,d,p);if(!Hl(u,d))return!1;for(let w of v)if(!od(w,_))return!1}if(s.type==="MultiPolygon"){let _=sd(s.coordinates,d,p),v=sp(r.geometry(),u,d,p);if(!Hl(u,d))return!1;for(let w of v)if(!tf(w,_))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}let L={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Y=1/298.257223563,ce=Y*(2-Y),Se=Math.PI/180;class Re{static fromTile(e,r,s){let u=Math.PI*(1-2*(e+.5)/Math.pow(2,r)),d=Math.atan(.5*(Math.exp(u)-Math.exp(-u)))/Se;return new Re(d,s)}static get units(){return L}constructor(e,r){if(e===void 0)throw new Error("No latitude given.");if(r&&!L[r])throw new Error(`Unknown unit ${r}. Use one of: ${Object.keys(L).join(", ")}`);let s=6378.137*Se*(r?L[r]:1),u=Math.cos(e*Se),d=1/(1-ce*(1-u*u)),p=Math.sqrt(d);this.kx=s*p*u,this.ky=s*p*d*(1-ce)}distance(e,r){let s=Xe(e[0]-r[0])*this.kx,u=(e[1]-r[1])*this.ky;return Math.sqrt(s*s+u*u)}bearing(e,r){let s=Xe(r[0]-e[0])*this.kx;return Math.atan2(s,(r[1]-e[1])*this.ky)/Se}destination(e,r,s){let u=s*Se;return this.offset(e,Math.sin(u)*r,Math.cos(u)*r)}offset(e,r,s){return[e[0]+r/this.kx,e[1]+s/this.ky]}lineDistance(e){let r=0;for(let s=0;s<e.length-1;s++)r+=this.distance(e[s],e[s+1]);return r}area(e){let r=0;for(let s=0;s<e.length;s++){let u=e[s];for(let d=0,p=u.length,_=p-1;d<p;_=d++)r+=Xe(u[d][0]-u[_][0])*(u[d][1]+u[_][1])*(s?-1:1)}return Math.abs(r)/2*this.kx*this.ky}along(e,r){let s=0;if(r<=0)return e[0];for(let u=0;u<e.length-1;u++){let d=e[u],p=e[u+1],_=this.distance(d,p);if(s+=_,s>r)return He(d,p,(r-(s-_))/_)}return e[e.length-1]}pointToSegmentDistance(e,r,s){let[u,d]=r,p=Xe(s[0]-u)*this.kx,_=(s[1]-d)*this.ky;if(p!==0||_!==0){let v=(Xe(e[0]-u)*this.kx*p+(e[1]-d)*this.ky*_)/(p*p+_*_);v>1?(u=s[0],d=s[1]):v>0&&(u+=p/this.kx*v,d+=_/this.ky*v)}return p=Xe(e[0]-u)*this.kx,_=(e[1]-d)*this.ky,Math.sqrt(p*p+_*_)}pointOnLine(e,r){let s=1/0,u=e[0][0],d=e[0][1],p=0,_=0;for(let v=0;v<e.length-1;v++){let w=e[v][0],E=e[v][1],k=Xe(e[v+1][0]-w)*this.kx,D=(e[v+1][1]-E)*this.ky,N=0;k===0&&D===0||(N=(Xe(r[0]-w)*this.kx*k+(r[1]-E)*this.ky*D)/(k*k+D*D),N>1?(w=e[v+1][0],E=e[v+1][1]):N>0&&(w+=k/this.kx*N,E+=D/this.ky*N)),k=Xe(r[0]-w)*this.kx,D=(r[1]-E)*this.ky;let B=k*k+D*D;B<s&&(s=B,u=w,d=E,p=v,_=N)}return{point:[u,d],index:p,t:Math.max(0,Math.min(1,_))}}lineSlice(e,r,s){let u=this.pointOnLine(s,e),d=this.pointOnLine(s,r);if(u.index>d.index||u.index===d.index&&u.t>d.t){let w=u;u=d,d=w}let p=[u.point],_=u.index+1,v=d.index;!ze(s[_],p[0])&&_<=v&&p.push(s[_]);for(let w=_+1;w<=v;w++)p.push(s[w]);return ze(s[v],d.point)||p.push(d.point),p}lineSliceAlong(e,r,s){let u=0,d=[];for(let p=0;p<s.length-1;p++){let _=s[p],v=s[p+1],w=this.distance(_,v);if(u+=w,u>e&&d.length===0&&d.push(He(_,v,(e-(u-w))/w)),u>=r)return d.push(He(_,v,(r-(u-w))/w)),d;u>e&&d.push(v)}return d}bufferPoint(e,r){let s=r/this.ky,u=r/this.kx;return[e[0]-u,e[1]-s,e[0]+u,e[1]+s]}bufferBBox(e,r){let s=r/this.ky,u=r/this.kx;return[e[0]-u,e[1]-s,e[2]+u,e[3]+s]}insideBBox(e,r){return Xe(e[0]-r[0])>=0&&Xe(e[0]-r[2])<=0&&e[1]>=r[1]&&e[1]<=r[3]}}function ze(t,e){return t[0]===e[0]&&t[1]===e[1]}function He(t,e,r){let s=Xe(e[0]-t[0]);return[t[0]+s*r,t[1]+(e[1]-t[1])*r]}function Xe(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}var tt={exports:{}};(function(t,e){t.exports=function(){var r=function(u,d){if(u===void 0&&(u=[]),d===void 0&&(d=s),this.data=u,this.length=this.data.length,this.compare=d,this.length>0)for(var p=(this.length>>1)-1;p>=0;p--)this._down(p)};function s(u,d){return u<d?-1:u>d?1:0}return r.prototype.push=function(u){this.data.push(u),this.length++,this._up(this.length-1)},r.prototype.pop=function(){if(this.length!==0){var u=this.data[0],d=this.data.pop();return this.length--,this.length>0&&(this.data[0]=d,this._down(0)),u}},r.prototype.peek=function(){return this.data[0]},r.prototype._up=function(u){for(var d=this.data,p=this.compare,_=d[u];u>0;){var v=u-1>>1,w=d[v];if(p(_,w)>=0)break;d[u]=w,u=v}d[u]=_},r.prototype._down=function(u){for(var d=this.data,p=this.compare,_=this.length>>1,v=d[u];u<_;){var w=1+(u<<1),E=d[w],k=w+1;if(k<this.length&&p(d[k],E)<0&&(w=k,E=d[k]),p(E,v)>=0)break;d[u]=E,u=w}d[u]=v},r}()})(tt);var St=K(tt.exports),rt=8192;function Vt(t,e){return e.dist-t.dist}let Ft=100,xi=50;function ii(t){let e=[1/0,1/0,-1/0,-1/0];if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Et(t){return t[1]-t[0]+1}function It(t,e){let r=t[1]>=t[0]&&t[1]<e;return r||console.warn("Distance Expression: Index is out of range"),r}function ui(t,e){if(t[0]>t[1])return[null,null];let r=Et(t);if(e){if(r===2)return[t,null];let s=Math.floor(r/2);return[[t[0],t[0]+s],[t[0]+s,t[1]]]}{if(r===1)return[t,null];let s=Math.floor(r/2)-1;return[[t[0],t[0]+s],[t[0]+s+1,t[1]]]}}function vi(t,e){let r=[1/0,1/0,-1/0,-1/0];if(!It(e,t.length))return r;for(let s=e[0];s<=e[1];++s)Yc(r,t[s]);return r}function gi(t){let e=[1/0,1/0,-1/0,-1/0];for(let r=0;r<t.length;++r)for(let s=0;s<t[r].length;++s)Yc(e,t[r][s]);return e}function qi(t,e,r){if(ii(t)||ii(e))return NaN;let s=0,u=0;return t[2]<e[0]&&(s=e[0]-t[2]),t[0]>e[2]&&(s=t[0]-e[2]),t[1]>e[3]&&(u=t[1]-e[3]),t[3]<e[1]&&(u=e[1]-t[3]),r.distance([0,0],[s,u])}function Hi(t){return 360*t-180}function Sr(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Gi(t,e){let r=Math.pow(2,e.z),s=(t.y/rt+e.y)/r;return[Hi((t.x/rt+e.x)/r),Sr(s)]}function An(t,e){let r=[];for(let s=0;s<t.length;++s)r.push(Gi(t[s],e));return r}function Mn(t,e,r){let s=r.pointOnLine(e,t).point;return r.distance(t,s)}function Jr(t,e,r,s,u){let d=r.slice(s[0],s[1]+1),p=1/0;for(let _=e[0];_<=e[1];++_)if((p=Math.min(p,Mn(t[_],d,u)))===0)return 0;return p}function on(t,e,r,s,u){let d=Math.min(u.pointToSegmentDistance(t,r,s),u.pointToSegmentDistance(e,r,s)),p=Math.min(u.pointToSegmentDistance(r,t,e),u.pointToSegmentDistance(s,t,e));return Math.min(d,p)}function Zn(t,e,r,s,u){if(!It(e,t.length)||!It(s,r.length))return NaN;let d=1/0;for(let p=e[0];p<e[1];++p)for(let _=s[0];_<s[1];++_){if(Rr(t[p],t[p+1],r[_],r[_+1]))return 0;d=Math.min(d,on(t[p],t[p+1],r[_],r[_+1],u))}return d}function Bn(t,e,r,s,u){if(!It(e,t.length)||!It(s,r.length))return NaN;let d=1/0;for(let p=e[0];p<=e[1];++p)for(let _=s[0];_<=s[1];++_)if((d=Math.min(d,u.distance(t[p],r[_])))===0)return d;return d}function Wr(t,e,r){if(Eu(t,e,!0))return 0;let s=1/0;for(let u of e){let d=u.length;if(d<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(u[0]!==u[d-1]&&(s=Math.min(s,r.pointToSegmentDistance(t,u[d-1],u[0])))===0||(s=Math.min(s,Mn(t,u,r)))===0)return s}return s}function Dn(t,e,r,s){if(!It(e,t.length))return NaN;for(let d=e[0];d<=e[1];++d)if(Eu(t[d],r,!0))return 0;let u=1/0;for(let d=e[0];d<e[1];++d)for(let p of r)for(let _=0,v=p.length,w=v-1;_<v;w=_++){if(Rr(t[d],t[d+1],p[w],p[_]))return 0;u=Math.min(u,on(t[d],t[d+1],p[w],p[_],s))}return u}function zo(t,e){for(let r of t)for(let s=0;s<=r.length-1;++s)if(Eu(r[s],e,!0))return!0;return!1}function ao(t,e,r,s=1/0){let u=gi(t),d=gi(e);if(s!==1/0&&qi(u,d,r)>=s)return s;if(Hl(u,d)){if(zo(t,e))return 0}else if(zo(e,t))return 0;let p=s;for(let _ of t)for(let v=0,w=_.length,E=w-1;v<w;E=v++)for(let k of e)for(let D=0,N=k.length,B=N-1;D<N;B=D++){if(Rr(_[E],_[v],k[B],k[D]))return 0;p=Math.min(p,on(_[E],_[v],k[B],k[D],r))}return p}function yo(t,e,r,s,u,d,p){if(d===null||p===null)return;let _=qi(vi(s,d),vi(u,p),r);_<e&&t.push({dist:_,range1:d,range2:p})}function yn(t,e,r,s,u=1/0){let d=Math.min(s.distance(t[0],r[0][0]),u);if(d===0)return d;let p=new St([{dist:0,range1:[0,t.length-1],range2:[0,0]}],Vt),_=e?xi:Ft,v=gi(r);for(;p.length;){let w=p.pop();if(w.dist>=d)continue;let E=w.range1;if(Et(E)<=_){if(!It(E,t.length))return NaN;if(e){let k=Dn(t,E,r,s);if((d=Math.min(d,k))===0)return d}else for(let k=E[0];k<=E[1];++k){let D=Wr(t[k],r,s);if((d=Math.min(d,D))===0)return d}}else{let k=ui(E,e);if(k[0]!==null){let D=qi(vi(t,k[0]),v,s);D<d&&p.push({dist:D,range1:k[0],range2:[0,0]})}if(k[1]!==null){let D=qi(vi(t,k[1]),v,s);D<d&&p.push({dist:D,range1:k[1],range2:[0,0]})}}}return d}function fs(t,e,r,s,u,d=1/0){let p=Math.min(d,u.distance(t[0],r[0]));if(p===0)return p;let _=new St([{dist:0,range1:[0,t.length-1],range2:[0,r.length-1]}],Vt),v=e?xi:Ft,w=s?xi:Ft;for(;_.length;){let E=_.pop();if(E.dist>=p)continue;let k=E.range1,D=E.range2;if(Et(k)<=v&&Et(D)<=w){if(!It(k,t.length)||!It(D,r.length))return NaN;if(e&&s?p=Math.min(p,Zn(t,k,r,D,u)):e||s?e&&!s?p=Math.min(p,Jr(r,D,t,k,u)):!e&&s&&(p=Math.min(p,Jr(t,k,r,D,u))):p=Math.min(p,Bn(t,k,r,D,u)),p===0)return p}else{let N=ui(k,e),B=ui(D,s);yo(_,p,u,t,r,N[0],B[0]),yo(_,p,u,t,r,N[0],B[1]),yo(_,p,u,t,r,N[1],B[0]),yo(_,p,u,t,r,N[1],B[1])}}return p}function es(t,e,r,s,u=1/0){let d=u,p=vi(t,[0,t.length-1]);for(let _ of r)if(!(d!==1/0&&qi(p,vi(_,[0,_.length-1]),s)>=d)&&(d=Math.min(d,fs(t,e,_,!0,s,d)),d===0))return d;return d}function qa(t,e,r,s,u=1/0){let d=u,p=vi(t,[0,t.length-1]);for(let _ of r){if(d!==1/0&&qi(p,gi(_),s)>=d)continue;let v=yn(t,e,_,s,d);if(isNaN(v))return v;if((d=Math.min(d,v))===0)return d}return d}function uo(t){return t==="Point"||t==="MultiPoint"||t==="LineString"||t==="MultiLineString"||t==="Polygon"||t==="MultiPolygon"}class $a{constructor(e,r){this.type=Ti,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error(`'distance' expression requires either one argument, but found ' ${e.length-1} instead.`);if(Bo(e[1])){let s=e[1];if(s.type==="FeatureCollection"){for(let u=0;u<s.features.length;++u)if(uo(s.features[u].geometry.type))return new $a(s,s.features[u].geometry)}else if(s.type==="Feature"){if(uo(s.geometry.type))return new $a(s,s.geometry)}else if(uo(s.type))return new $a(s,s)}return r.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(e){let r=e.geometry(),s=e.canonicalID();if(r!=null&&s!=null){if(e.geometryType()==="Point")return function(u,d,p){let _=[];for(let w of u)for(let E of w)_.push(Gi(E,d));let v=new Re(_[0][1],"meters");return p.type==="Point"||p.type==="MultiPoint"||p.type==="LineString"?fs(_,!1,p.type==="Point"?[p.coordinates]:p.coordinates,p.type==="LineString",v):p.type==="MultiLineString"?es(_,!1,p.coordinates,v):p.type==="Polygon"||p.type==="MultiPolygon"?qa(_,!1,p.type==="Polygon"?[p.coordinates]:p.coordinates,v):null}(r,s,this.geometries);if(e.geometryType()==="LineString")return function(u,d,p){let _=[];for(let w of u){let E=[];for(let k of w)E.push(Gi(k,d));_.push(E)}let v=new Re(_[0][0][1],"meters");if(p.type==="Point"||p.type==="MultiPoint"||p.type==="LineString")return es(p.type==="Point"?[p.coordinates]:p.coordinates,p.type==="LineString",_,v);if(p.type==="MultiLineString"){let w=1/0;for(let E=0;E<p.coordinates.length;E++){let k=es(p.coordinates[E],!0,_,v,w);if(isNaN(k))return k;if((w=Math.min(w,k))===0)return w}return w}if(p.type==="Polygon"||p.type==="MultiPolygon"){let w=1/0;for(let E=0;E<_.length;E++){let k=qa(_[E],!0,p.type==="Polygon"?[p.coordinates]:p.coordinates,v,w);if(isNaN(k))return k;if((w=Math.min(w,k))===0)return w}return w}return null}(r,s,this.geometries);if(e.geometryType()==="Polygon")return function(u,d,p){let _=[];for(let w of function(E,k){let D=E.length;if(D<=1)return[E];let N=[],B,q;for(let Z=0;Z<D;Z++){let oe=ef(E[Z]);oe!==0&&(E[Z].area=Math.abs(oe),q===void 0&&(q=oe<0),q===oe<0?(B&&N.push(B),B=[E[Z]]):B.push(E[Z]))}return B&&N.push(B),N}(u)){let E=[];for(let k=0;k<w.length;++k)E.push(An(w[k],d));_.push(E)}let v=new Re(_[0][0][0][1],"meters");if(p.type==="Point"||p.type==="MultiPoint"||p.type==="LineString")return qa(p.type==="Point"?[p.coordinates]:p.coordinates,p.type==="LineString",_,v);if(p.type==="MultiLineString"){let w=1/0;for(let E=0;E<p.coordinates.length;E++){let k=qa(p.coordinates[E],!0,_,v,w);if(isNaN(k))return k;if((w=Math.min(w,k))===0)return w}return w}return p.type==="Polygon"||p.type==="MultiPolygon"?function(w,E,k){let D=1/0;for(let N of w)for(let B of E){let q=ao(N,B,k,D);if(isNaN(q))return q;if((D=Math.min(D,q))===0)return D}return D}(p.type==="Polygon"?[p.coordinates]:p.coordinates,_,v):null}(r,s,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Io(t,e){switch(t){case"string":return Ks(e);case"number":return+e;case"boolean":return!!e;case"color":return jr.parse(e);case"formatted":return Ga.fromString(Ks(e));case"resolvedImage":return Qo.fromString(Ks(e))}return e}function ps(t,e,r,s){return s!==void 0&&(t=s*Math.round(t/s)),e!==void 0&&t<e&&(t=e),r!==void 0&&t>r&&(t=r),t}class fn{constructor(e,r,s){this.type=e,this.key=r,this.scope=s}static parse(e,r){let s=r.expectedType;if(s==null&&(s=Fr),e.length<2||e.length>3)return r.error("Invalid number of arguments for 'config' expression.");let u=r.parse(e[1],1);if(!(u instanceof bc))return r.error("Key name of 'config' expression must be a string literal.");if(e.length>=3){let d=r.parse(e[2],2);return d instanceof bc?new fn(s,Ks(u.value),Ks(d.value)):r.error("Scope of 'config' expression must be a string literal.")}return new fn(s,Ks(u.value))}evaluate(e){let r=[this.key,this.scope,e.scope].filter(Boolean).join(""),s=e.getConfig(r);if(!s)return null;let{type:u,value:d,values:p,minValue:_,maxValue:v,stepValue:w}=s,E=s.default.evaluate(e),k=E;if(d){let D=e.scope;e.scope=(D||"").split("").slice(1).join(""),k=d.evaluate(e),e.scope=D}return u&&(k=Io(u,k)),k===void 0||_===void 0&&v===void 0&&w===void 0||(typeof k=="number"?k=ps(k,_,v,w):Array.isArray(k)&&(k=k.map(D=>typeof D=="number"?ps(D,_,v,w):D))),d!==void 0&&k!==void 0&&p&&!p.includes(k)&&(k=E,u&&(k=Io(u,k))),(u&&u!==this.type||k!==void 0&&Ba(k)!==this.type)&&(k=Io(this.type.kind,k)),k}eachChild(){}outputDefined(){return!1}serialize(){let e=["config",this.key];return this.scope&&e.concat(this.key),e}}function jo(t){if(t instanceof Co&&(t.name==="get"&&t.args.length===1||t.name==="feature-state"||t.name==="has"&&t.args.length===1||t.name==="properties"||t.name==="geometry-type"||t.name==="id"||/^filter-/.test(t.name))||t instanceof I||t instanceof $a)return!1;let e=!0;return t.eachChild(r=>{e&&!jo(r)&&(e=!1)}),e}function Gl(t){if(t instanceof Co&&t.name==="feature-state")return!1;let e=!0;return t.eachChild(r=>{e&&!Gl(r)&&(e=!1)}),e}function Kc(t){if(t instanceof fn)return!1;let e=!0;return t.eachChild(r=>{e&&!Kc(r)&&(e=!1)}),e}function Js(t,e){if(t instanceof Co&&e.indexOf(t.name)>=0)return!1;let r=!0;return t.eachChild(s=>{r&&!Js(s,e)&&(r=!1)}),r}class ha{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(e.length!==2||typeof e[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");let s=e[1];return r.scope.has(s)?new ha(s,r.scope.get(s)):r.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Cu{constructor(e,r=[],s,u=new Kd,d=[],p,_){this.registry=e,this.path=r,this.key=r.map(v=>`[${v}]`).join(""),this.scope=u,this.errors=d,this.expectedType=s,this._scope=p,this.options=_}parse(e,r,s,u,d={}){return r||s?this.concat(r,s,u)._parse(e,d):this._parse(e,d)}_parse(e,r){function s(u,d,p){return p==="assert"?new Wa(d,[u]):p==="coerce"?new za(d,[u]):u}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let u=typeof e[0]=="string"?this.registry[e[0]]:void 0;if(u){let d=u.parse(e,this);if(!d)return null;if(this.expectedType){let p=this.expectedType,_=d.type;if(p.kind!=="string"&&p.kind!=="number"&&p.kind!=="boolean"&&p.kind!=="object"&&p.kind!=="array"||_.kind!=="value")if(p.kind!=="color"&&p.kind!=="formatted"&&p.kind!=="resolvedImage"||_.kind!=="value"&&_.kind!=="string"){if(this.checkSubtype(p,_))return null}else d=s(d,p,r.typeAnnotation||"coerce");else d=s(d,p,r.typeAnnotation||"assert")}if(!(d instanceof bc)&&d.type.kind!=="resolvedImage"&&yh(d)){let p=new cm(this._scope,this.options);try{d=new bc(d.type,d.evaluate(p))}catch(_){return this.error(_.message),null}}return d}return za.parse(["to-array",e],this)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,r,s){let u=typeof e=="number"?this.path.concat(e):this.path,d=s?this.scope.concat(s):this.scope;return new Cu(this.registry,u,r||null,d,this.errors,this._scope,this.options)}error(e,...r){let s=`${this.key}${r.map(u=>`[${u}]`).join("")}`;this.errors.push(new Ls(s,e))}checkSubtype(e,r){let s=nd(e,r);return s&&this.error(s),s}}var lp=Cu;function yh(t){if(t instanceof ha)return yh(t.boundExpression);if(t instanceof Co&&t.name==="error"||t instanceof wc||t instanceof I||t instanceof $a||t instanceof fn)return!1;let e=t instanceof za||t instanceof Wa,r=!0;return t.eachChild(s=>{r=e?r&&yh(s):r&&s instanceof bc}),!!r&&jo(t)&&Js(t,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Iu(t,e){let r=t.length-1,s,u,d=0,p=r,_=0;for(;d<=p;)if(_=Math.floor((d+p)/2),s=t[_],u=t[_+1],s<=e){if(_===r||e<u)return _;d=_+1}else{if(!(s>e))throw new no("Input is not a number.");p=_-1}return 0}class Sc{constructor(e,r,s){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(let[u,d]of s)this.labels.push(u),this.outputs.push(d)}static parse(e,r){if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");let s=r.parse(e[1],1,Ti);if(!s)return null;let u=[],d=null;r.expectedType&&r.expectedType.kind!=="value"&&(d=r.expectedType);for(let p=1;p<e.length;p+=2){let _=p===1?-1/0:e[p],v=e[p+1],w=p,E=p+1;if(typeof _!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',w);if(u.length&&u[u.length-1][0]>=_)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',w);let k=r.parse(v,E,d);if(!k)return null;d=d||k.type,u.push([_,k])}return new Sc(d,s,u)}evaluate(e){let r=this.labels,s=this.outputs;if(r.length===1)return s[0].evaluate(e);let u=this.input.evaluate(e);if(u<=r[0])return s[0].evaluate(e);let d=r.length;return u>=r[d-1]?s[d-1].evaluate(e):s[Iu(r,u)].evaluate(e)}eachChild(e){e(this.input);for(let r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e=["step",this.input.serialize()];for(let r=0;r<this.labels.length;r++)r>0&&e.push(this.labels[r]),e.push(this.outputs[r].serialize());return e}}let ku=.95047,Qs=1.08883,Jc=4/29,el=6/29,cp=3*el*el,bh=el*el*el,ld=Math.PI/180,cd=180/Math.PI;function ud(t){return t>bh?Math.pow(t,1/3):t/cp+Jc}function Mu(t){return t>el?t*t*t:cp*(t-Jc)}function Du(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function hd(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function hm(t){let e=hd(t.r),r=hd(t.g),s=hd(t.b),u=ud((.4124564*e+.3575761*r+.1804375*s)/ku),d=ud((.2126729*e+.7151522*r+.072175*s)/1);return{l:116*d-16,a:500*(u-d),b:200*(d-ud((.0193339*e+.119192*r+.9503041*s)/Qs)),alpha:t.a}}function rf(t){let e=(t.l+16)/116,r=isNaN(t.a)?e:e+t.a/500,s=isNaN(t.b)?e:e-t.b/200;return e=1*Mu(e),r=ku*Mu(r),s=Qs*Mu(s),new jr(Du(3.2404542*r-1.5371385*e-.4985314*s),Du(-.969266*r+1.8760108*e+.041556*s),Du(.0556434*r-.2040259*e+1.0572252*s),t.alpha)}function Qc(t,e,r){let s=e-t;return t+r*(s>180||s<-180?s-360*Math.round(s/360):s)}let dd={forward:hm,reverse:rf,interpolate:function(t,e,r){return{l:$i(t.l,e.l,r),a:$i(t.a,e.a,r),b:$i(t.b,e.b,r),alpha:$i(t.alpha,e.alpha,r)}}},wh={forward:function(t){let{l:e,a:r,b:s}=hm(t),u=Math.atan2(s,r)*cd;return{h:u<0?u+360:u,c:Math.sqrt(r*r+s*s),l:e,alpha:t.a}},reverse:function(t){let e=t.h*ld,r=t.c;return rf({l:t.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:t.alpha})},interpolate:function(t,e,r){return{h:Qc(t.h,e.h,r),c:$i(t.c,e.c,r),l:$i(t.l,e.l,r),alpha:$i(t.alpha,e.alpha,r)}}};var dm=Object.freeze({__proto__:null,hcl:wh,lab:dd});class ms{constructor(e,r,s,u,d){this.type=e,this.operator=r,this.interpolation=s,this.input=u,this.labels=[],this.outputs=[];for(let[p,_]of d)this.labels.push(p),this.outputs.push(_)}static interpolationFactor(e,r,s,u){let d=0;if(e.name==="exponential")d=Th(r,e.base,s,u);else if(e.name==="linear")d=Th(r,1,s,u);else if(e.name==="cubic-bezier"){let p=e.controlPoints;d=new Pl(p[0],p[1],p[2],p[3]).solve(Th(r,1,s,u))}return d}static parse(e,r){let[s,u,d,...p]=e;if(!Array.isArray(u)||u.length===0)return r.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){let w=u[1];if(typeof w!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:w}}else{if(u[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(u[0])}`,1,0);{let w=u.slice(1);if(w.length!==4||w.some(E=>typeof E!="number"||E<0||E>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:w}}}if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(d=r.parse(d,2,Ti),!d)return null;let _=[],v=null;s==="interpolate-hcl"||s==="interpolate-lab"?v=Ao:r.expectedType&&r.expectedType.kind!=="value"&&(v=r.expectedType);for(let w=0;w<p.length;w+=2){let E=p[w],k=p[w+1],D=w+3,N=w+4;if(typeof E!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(_.length&&_[_.length-1][0]>=E)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);let B=r.parse(k,N,v);if(!B)return null;v=v||B.type,_.push([E,B])}return v.kind==="number"||v.kind==="color"||v.kind==="array"&&v.itemType.kind==="number"&&typeof v.N=="number"?new ms(v,s,u,d,_):r.error(`Type ${ba(v)} is not interpolatable.`)}evaluate(e){let r=this.labels,s=this.outputs;if(r.length===1)return s[0].evaluate(e);let u=this.input.evaluate(e);if(u<=r[0])return s[0].evaluate(e);let d=r.length;if(u>=r[d-1])return s[d-1].evaluate(e);let p=Iu(r,u),_=ms.interpolationFactor(this.interpolation,u,r[p],r[p+1]),v=s[p].evaluate(e),w=s[p+1].evaluate(e);return this.operator==="interpolate"?Ko[this.type.kind.toLowerCase()](v,w,_):this.operator==="interpolate-hcl"?wh.reverse(wh.interpolate(wh.forward(v),wh.forward(w),_)):dd.reverse(dd.interpolate(dd.forward(v),dd.forward(w),_))}eachChild(e){e(this.input);for(let r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);let r=[this.operator,e,this.input.serialize()];for(let s=0;s<this.labels.length;s++)r.push(this.labels[s],this.outputs[s].serialize());return r}}function Th(t,e,r,s){let u=s-r,d=t-r;return u===0?0:e===1?d/u:(Math.pow(e,d)-1)/(Math.pow(e,u)-1)}class fd{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expectected at least one argument.");let s=null,u=r.expectedType;u&&u.kind!=="value"&&(s=u);let d=[];for(let _ of e.slice(1)){let v=r.parse(_,1+d.length,s,void 0,{typeAnnotation:"omit"});if(!v)return null;s=s||v.type,d.push(v)}let p=u&&d.some(_=>nd(u,_.type));return new fd(p?Fr:s,d)}evaluate(e){let r,s=null,u=0;for(let d of this.args){if(u++,s=d.evaluate(e),s&&s instanceof Qo&&!s.available&&(r||(r=s),s=null,u===this.args.length))return r;if(s!==null)break}return s}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){let e=["coalesce"];return this.eachChild(r=>{e.push(r.serialize())}),e}}class pd{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(let r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);let s=[];for(let d=1;d<e.length-1;d+=2){let p=e[d];if(typeof p!="string")return r.error(`Expected string, but found ${typeof p} instead.`,d);if(/[^a-zA-Z0-9_]/.test(p))return r.error("Variable names must contain only alphanumeric characters or '_'.",d);let _=r.parse(e[d+1],d+1);if(!_)return null;s.push([p,_])}let u=r.parse(e[e.length-1],e.length-1,r.expectedType,s);return u?new pd(s,u):null}outputDefined(){return this.result.outputDefined()}serialize(){let e=["let"];for(let[r,s]of this.bindings)e.push(r,s.serialize());return e.push(this.result.serialize()),e}}class Sh{constructor(e,r,s){this.type=e,this.index=r,this.input=s}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);let s=r.parse(e[1],1,Ti),u=r.parse(e[2],2,Jo(r.expectedType||Fr));return s&&u?new Sh(u.type.itemType,s,u):null}evaluate(e){let r=this.index.evaluate(e),s=this.input.evaluate(e);if(r<0)throw new no(`Array index out of bounds: ${r} < 0.`);if(r>=s.length)throw new no(`Array index out of bounds: ${r} > ${s.length-1}.`);if(r!==Math.floor(r))throw new no(`Array index must be an integer, but found ${r} instead.`);return s[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class md{constructor(e,r){this.type=Vr,this.needle=e,this.haystack=r}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);let s=r.parse(e[1],1,Fr),u=r.parse(e[2],2,Fr);return s&&u?rp(s.type,[Vr,Br,Ti,vc,Fr])?new md(s,u):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${ba(s.type)} instead`):null}evaluate(e){let r=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(s==null)return!1;if(!vh(r,["boolean","string","number","null"]))throw new no(`Expected first argument to be of type boolean, string, number or null, but found ${ba(Ba(r))} instead.`);if(!vh(s,["string","array"]))throw new no(`Expected second argument to be of type array or string, but found ${ba(Ba(s))} instead.`);return s.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class eu{constructor(e,r,s){this.type=Ti,this.needle=e,this.haystack=r,this.fromIndex=s}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);let s=r.parse(e[1],1,Fr),u=r.parse(e[2],2,Fr);if(!s||!u)return null;if(!rp(s.type,[Vr,Br,Ti,vc,Fr]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${ba(s.type)} instead`);if(e.length===4){let d=r.parse(e[3],3,Ti);return d?new eu(s,u,d):null}return new eu(s,u)}evaluate(e){let r=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!vh(r,["boolean","string","number","null"]))throw new no(`Expected first argument to be of type boolean, string, number or null, but found ${ba(Ba(r))} instead.`);if(!vh(s,["string","array"]))throw new no(`Expected second argument to be of type array or string, but found ${ba(Ba(s))} instead.`);if(this.fromIndex){let u=this.fromIndex.evaluate(e);return s.indexOf(r,u)}return s.indexOf(r)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){let e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Fu{constructor(e,r,s,u,d,p){this.inputType=e,this.type=r,this.input=s,this.cases=u,this.outputs=d,this.otherwise=p}static parse(e,r){if(e.length<5)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return r.error("Expected an even number of arguments.");let s,u;r.expectedType&&r.expectedType.kind!=="value"&&(u=r.expectedType);let d={},p=[];for(let w=2;w<e.length-1;w+=2){let E=e[w],k=e[w+1];Array.isArray(E)||(E=[E]);let D=r.concat(w);if(E.length===0)return D.error("Expected at least one branch label.");for(let B of E){if(typeof B!="number"&&typeof B!="string")return D.error("Branch labels must be numbers or strings.");if(typeof B=="number"&&Math.abs(B)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof B=="number"&&Math.floor(B)!==B)return D.error("Numeric branch labels must be integer values.");if(s){if(D.checkSubtype(s,Ba(B)))return null}else s=Ba(B);if(d[String(B)]!==void 0)return D.error("Branch labels must be unique.");d[String(B)]=p.length}let N=r.parse(k,w,u);if(!N)return null;u=u||N.type,p.push(N)}let _=r.parse(e[1],1,Fr);if(!_)return null;let v=r.parse(e[e.length-1],e.length-1,u);return v?_.type.kind!=="value"&&r.concat(1).checkSubtype(s,_.type)?null:new Fu(s,u,_,d,p,v):null}evaluate(e){let r=this.input.evaluate(e);return(Ba(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){let e=["match",this.input.serialize()],r=Object.keys(this.cases).sort(),s=[],u={};for(let p of r){let _=u[this.cases[p]];_===void 0?(u[this.cases[p]]=s.length,s.push([this.cases[p],[p]])):s[_][1].push(p)}let d=p=>this.inputType.kind==="number"?Number(p):p;for(let[p,_]of s)e.push(_.length===1?d(_[0]):_.map(d)),e.push(this.outputs[p].serialize());return e.push(this.otherwise.serialize()),e}}class up{constructor(e,r,s){this.type=e,this.branches=r,this.otherwise=s}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return r.error("Expected an odd number of arguments.");let s;r.expectedType&&r.expectedType.kind!=="value"&&(s=r.expectedType);let u=[];for(let p=1;p<e.length-1;p+=2){let _=r.parse(e[p],p,Vr);if(!_)return null;let v=r.parse(e[p+1],p+1,s);if(!v)return null;u.push([_,v]),s=s||v.type}let d=r.parse(e[e.length-1],e.length-1,s);return d?new up(s,u,d):null}evaluate(e){for(let[r,s]of this.branches)if(r.evaluate(e))return s.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(let[r,s]of this.branches)e(r),e(s);e(this.otherwise)}outputDefined(){return this.branches.every(([e,r])=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){let e=["case"];return this.eachChild(r=>{e.push(r.serialize())}),e}}class Pu{constructor(e,r,s,u){this.type=e,this.input=r,this.beginIndex=s,this.endIndex=u}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);let s=r.parse(e[1],1,Fr),u=r.parse(e[2],2,Ti);if(!s||!u)return null;if(!rp(s.type,[Jo(Fr),Br,Fr]))return r.error(`Expected first argument to be of type array or string, but found ${ba(s.type)} instead`);if(e.length===4){let d=r.parse(e[3],3,Ti);return d?new Pu(s.type,s,u,d):null}return new Pu(s.type,s,u)}evaluate(e){let r=this.input.evaluate(e),s=this.beginIndex.evaluate(e);if(!vh(r,["string","array"]))throw new no(`Expected first argument to be of type array or string, but found ${ba(Ba(r))} instead.`);if(this.endIndex){let u=this.endIndex.evaluate(e);return r.slice(s,u)}return r.slice(s)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){let e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Eh(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function nf(t,e,r,s){return s.compare(e,r)===0}function gs(t,e,r){let s=t!=="=="&&t!=="!=";return class EA{constructor(d,p,_){this.type=Vr,this.lhs=d,this.rhs=p,this.collator=_,this.hasUntypedArgument=d.type.kind==="value"||p.type.kind==="value"}static parse(d,p){if(d.length!==3&&d.length!==4)return p.error("Expected two or three arguments.");let _=d[0],v=p.parse(d[1],1,Fr);if(!v)return null;if(!Eh(_,v.type))return p.concat(1).error(`"${_}" comparisons are not supported for type '${ba(v.type)}'.`);let w=p.parse(d[2],2,Fr);if(!w)return null;if(!Eh(_,w.type))return p.concat(2).error(`"${_}" comparisons are not supported for type '${ba(w.type)}'.`);if(v.type.kind!==w.type.kind&&v.type.kind!=="value"&&w.type.kind!=="value")return p.error(`Cannot compare types '${ba(v.type)}' and '${ba(w.type)}'.`);s&&(v.type.kind==="value"&&w.type.kind!=="value"?v=new Wa(w.type,[v]):v.type.kind!=="value"&&w.type.kind==="value"&&(w=new Wa(v.type,[w])));let E=null;if(d.length===4){if(v.type.kind!=="string"&&w.type.kind!=="string"&&v.type.kind!=="value"&&w.type.kind!=="value")return p.error("Cannot use collator to compare non-string types.");if(E=p.parse(d[3],3,Rs),!E)return null}return new EA(v,w,E)}evaluate(d){let p=this.lhs.evaluate(d),_=this.rhs.evaluate(d);if(s&&this.hasUntypedArgument){let v=Ba(p),w=Ba(_);if(v.kind!==w.kind||v.kind!=="string"&&v.kind!=="number")throw new no(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${v.kind}, ${w.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){let v=Ba(p),w=Ba(_);if(v.kind!=="string"||w.kind!=="string")return e(d,p,_)}return this.collator?r(d,p,_,this.collator.evaluate(d)):e(d,p,_)}eachChild(d){d(this.lhs),d(this.rhs),this.collator&&d(this.collator)}outputDefined(){return!0}serialize(){let d=[t];return this.eachChild(p=>{d.push(p.serialize())}),d}}}let fm=gs("==",function(t,e,r){return e===r},nf),hp=gs("!=",function(t,e,r){return e!==r},function(t,e,r,s){return!nf(0,e,r,s)}),pm=gs("<",function(t,e,r){return e<r},function(t,e,r,s){return s.compare(e,r)<0}),dp=gs(">",function(t,e,r){return e>r},function(t,e,r,s){return s.compare(e,r)>0}),Lu=gs("<=",function(t,e,r){return e<=r},function(t,e,r,s){return s.compare(e,r)<=0}),fp=gs(">=",function(t,e,r){return e>=r},function(t,e,r,s){return s.compare(e,r)>=0});class Ah{constructor(e,r,s,u,d,p){this.type=Br,this.number=e,this.locale=r,this.currency=s,this.unit=u,this.minFractionDigits=d,this.maxFractionDigits=p}static parse(e,r){if(e.length!==3)return r.error("Expected two arguments.");let s=r.parse(e[1],1,Ti);if(!s)return null;let u=e[2];if(typeof u!="object"||Array.isArray(u))return r.error("NumberFormat options argument must be an object.");let d=null;if(u.locale&&(d=r.parse(u.locale,1,Br),!d))return null;let p=null;if(u.currency&&(p=r.parse(u.currency,1,Br),!p))return null;let _=null;if(u.unit&&(_=r.parse(u.unit,1,Br),!_))return null;let v=null;if(u["min-fraction-digits"]&&(v=r.parse(u["min-fraction-digits"],1,Ti),!v))return null;let w=null;return u["max-fraction-digits"]&&(w=r.parse(u["max-fraction-digits"],1,Ti),!w)?null:new Ah(s,d,p,_,v,w)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){let e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class pp{constructor(e){this.type=Ti,this.input=e}static parse(e,r){if(e.length!==2)return r.error(`Expected 1 argument, but found ${e.length-1} instead.`);let s=r.parse(e[1],1);return s?s.type.kind!=="array"&&s.type.kind!=="string"&&s.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${ba(s.type)} instead.`):new pp(s):null}evaluate(e){let r=this.input.evaluate(e);if(typeof r=="string"||Array.isArray(r))return r.length;throw new no(`Expected value to be of type string or array, but found ${ba(Ba(r))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){let e=["length"];return this.eachChild(r=>{e.push(r.serialize())}),e}}function mp(t){return function(){t=1831565813+(t|=0)|0;let e=Math.imul(t^t>>>15,1|t);return e=e+Math.imul(e^e>>>7,61|e)^e,((e^e>>>14)>>>0)/4294967296}}let Ru={"==":fm,"!=":hp,">":dp,"<":pm,">=":fp,"<=":Lu,array:Wa,at:Sh,boolean:Wa,case:up,coalesce:fd,collator:wc,format:Os,image:ad,in:md,"index-of":eu,interpolate:ms,"interpolate-hcl":ms,"interpolate-lab":ms,length:pp,let:pd,literal:bc,match:Fu,number:Wa,"number-format":Ah,object:Wa,slice:Pu,step:Sc,string:Wa,"to-boolean":za,"to-color":za,"to-number":za,"to-string":za,var:ha,within:I,distance:$a,config:fn};function Ch(t,[e,r,s,u]){e=e.evaluate(t),r=r.evaluate(t),s=s.evaluate(t);let d=u?u.evaluate(t):1,p=sm(e,r,s,d);if(p)throw new no(p);return new jr(e/255*d,r/255*d,s/255*d,d)}function af(t,[e,r,s,u]){e=e.evaluate(t),r=r.evaluate(t),s=s.evaluate(t);let d=u?u.evaluate(t):1,p=function(w,E,k,D){return typeof w=="number"&&w>=0&&w<=360?typeof E=="number"&&E>=0&&E<=100&&typeof k=="number"&&k>=0&&k<=100?D===void 0||typeof D=="number"&&D>=0&&D<=1?null:`Invalid hsla value [${[w,E,k,D].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof D=="number"?[w,E,k,D]:[w,E,k]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof D=="number"?[w,E,k,D]:[w,E,k]).join(", ")}]: 'h' must be between 0 and 360.`}(e,r,s,d);if(p)throw new no(p);let _=`hsla(${e}, ${r}%, ${s}%, ${d})`,v=jr.parse(_);if(!v)throw new no(`Failed to parse HSLA color: ${_}`);return v}function gd(t,e){return t in e}function wl(t,e){let r=e[t];return r===void 0?null:r}function _s(t){return{type:t}}function Ec(t){return{result:"success",value:t}}function Wl(t){return{result:"error",value:t}}function of(t,e){return!!t&&!!t.parameters&&t.parameters.indexOf(e)>-1}function _d(t){return t["property-type"]==="data-driven"}function F0(t){return of(t.expression,"measure-light")}function m(t){return of(t.expression,"zoom")}function o(t){return!!t.expression&&t.expression.interpolated}function h(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function g(t){return t}function y(t,e){let r=e.type==="color",s=t.stops&&typeof t.stops[0][0]=="object",u=s||!(s||t.property!==void 0),d=t.type||(o(e)?"exponential":"interval");if(r&&((t=_h({},t)).stops&&(t.stops=t.stops.map(w=>[w[0],jr.parse(w[1])])),t.default=jr.parse(t.default?t.default:e.default)),t.colorSpace&&t.colorSpace!=="rgb"&&!dm[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let p,_,v;if(d==="exponential")p=P;else if(d==="interval")p=C;else if(d==="categorical"){p=S,_=Object.create(null);for(let w of t.stops)_[w[0]]=w[1];v=typeof t.stops[0][0]}else{if(d!=="identity")throw new Error(`Unknown function type "${d}"`);p=O}if(s){let w={},E=[];for(let N=0;N<t.stops.length;N++){let B=t.stops[N],q=B[0].zoom;w[q]===void 0&&(w[q]={zoom:q,type:t.type,property:t.property,default:t.default,stops:[]},E.push(q)),w[q].stops.push([B[0].value,B[1]])}let k=[];for(let N of E)k.push([w[N].zoom,y(w[N],e)]);let D={name:"linear"};return{kind:"composite",interpolationType:D,interpolationFactor:ms.interpolationFactor.bind(void 0,D),zoomStops:k.map(N=>N[0]),evaluate:({zoom:N},B)=>P({stops:k,base:t.base},e,N).evaluate(N,B)}}if(u){let w=d==="exponential"?{name:"exponential",base:t.base!==void 0?t.base:1}:null;return{kind:"camera",interpolationType:w,interpolationFactor:ms.interpolationFactor.bind(void 0,w),zoomStops:t.stops.map(E=>E[0]),evaluate:({zoom:E})=>p(t,e,E,_,v)}}return{kind:"source",evaluate(w,E){let k=E&&E.properties?E.properties[t.property]:void 0;return k===void 0?b(t.default,e.default):p(t,e,k,_,v)}}}function b(t,e,r){return t!==void 0?t:e!==void 0?e:r!==void 0?r:void 0}function S(t,e,r,s,u){return b(typeof r===u?s[r]:void 0,t.default,e.default)}function C(t,e,r){if(Xc(r)!=="number")return b(t.default,e.default);let s=t.stops.length;if(s===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[s-1][0])return t.stops[s-1][1];let u=Iu(t.stops.map(d=>d[0]),r);return t.stops[u][1]}function P(t,e,r){let s=t.base!==void 0?t.base:1;if(Xc(r)!=="number")return b(t.default,e.default);let u=t.stops.length;if(u===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[u-1][0])return t.stops[u-1][1];let d=Iu(t.stops.map(E=>E[0]),r),p=function(E,k,D,N){let B=N-D,q=E-D;return B===0?0:k===1?q/B:(Math.pow(k,q)-1)/(Math.pow(k,B)-1)}(r,s,t.stops[d][0],t.stops[d+1][0]),_=t.stops[d][1],v=t.stops[d+1][1],w=Ko[e.type]||g;if(t.colorSpace&&t.colorSpace!=="rgb"){let E=dm[t.colorSpace];w=(k,D)=>E.reverse(E.interpolate(E.forward(k),E.forward(D),p))}return typeof _.evaluate=="function"?{evaluate(...E){let k=_.evaluate.apply(void 0,E),D=v.evaluate.apply(void 0,E);if(k!==void 0&&D!==void 0)return w(k,D,p)}}:w(_,v,p)}function O(t,e,r){return e.type==="color"?r=jr.parse(r):e.type==="formatted"?r=Ga.fromString(r.toString()):e.type==="resolvedImage"?r=Qo.fromString(r.toString()):Xc(r)===e.type||e.type==="enum"&&e.values[r]||(r=void 0),b(r,t.default,e.default)}Co.register(Ru,{error:[{kind:"error"},[Br],(t,[e])=>{throw new no(e.evaluate(t))}],typeof:[Br,[Fr],(t,[e])=>ba(Ba(e.evaluate(t)))],"to-rgba":[Jo(Ti,4),[Ao],(t,[e])=>e.evaluate(t).toRenderColor(null).toArray()],rgb:[Ao,[Ti,Ti,Ti],Ch],rgba:[Ao,[Ti,Ti,Ti,Ti],Ch],hsl:[Ao,[Ti,Ti,Ti],af],hsla:[Ao,[Ti,Ti,Ti,Ti],af],has:{type:Vr,overloads:[[[Br],(t,[e])=>gd(e.evaluate(t),t.properties())],[[Br,$c],(t,[e,r])=>gd(e.evaluate(t),r.evaluate(t))]]},get:{type:Fr,overloads:[[[Br],(t,[e])=>wl(e.evaluate(t),t.properties())],[[Br,$c],(t,[e,r])=>wl(e.evaluate(t),r.evaluate(t))]]},"feature-state":[Fr,[Br],(t,[e])=>wl(e.evaluate(t),t.featureState||{})],properties:[$c,[],t=>t.properties()],"geometry-type":[Br,[],t=>t.geometryType()],id:[Fr,[],t=>t.id()],zoom:[Ti,[],t=>t.globals.zoom],pitch:[Ti,[],t=>t.globals.pitch||0],"distance-from-center":[Ti,[],t=>t.distanceFromCenter()],"measure-light":[Ti,[Br],(t,[e])=>t.measureLight(e.evaluate(t))],"heatmap-density":[Ti,[],t=>t.globals.heatmapDensity||0],"line-progress":[Ti,[],t=>t.globals.lineProgress||0],"raster-value":[Ti,[],t=>t.globals.rasterValue||0],"raster-particle-speed":[Ti,[],t=>t.globals.rasterParticleSpeed||0],"sky-radial-progress":[Ti,[],t=>t.globals.skyRadialProgress||0],accumulated:[Fr,[],t=>t.globals.accumulated===void 0?null:t.globals.accumulated],"+":[Ti,_s(Ti),(t,e)=>{let r=0;for(let s of e)r+=s.evaluate(t);return r}],"*":[Ti,_s(Ti),(t,e)=>{let r=1;for(let s of e)r*=s.evaluate(t);return r}],"-":{type:Ti,overloads:[[[Ti,Ti],(t,[e,r])=>e.evaluate(t)-r.evaluate(t)],[[Ti],(t,[e])=>-e.evaluate(t)]]},"/":[Ti,[Ti,Ti],(t,[e,r])=>e.evaluate(t)/r.evaluate(t)],"%":[Ti,[Ti,Ti],(t,[e,r])=>e.evaluate(t)%r.evaluate(t)],ln2:[Ti,[],()=>Math.LN2],pi:[Ti,[],()=>Math.PI],e:[Ti,[],()=>Math.E],"^":[Ti,[Ti,Ti],(t,[e,r])=>Math.pow(e.evaluate(t),r.evaluate(t))],sqrt:[Ti,[Ti],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[Ti,[Ti],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[Ti,[Ti],(t,[e])=>Math.log(e.evaluate(t))],log2:[Ti,[Ti],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[Ti,[Ti],(t,[e])=>Math.sin(e.evaluate(t))],cos:[Ti,[Ti],(t,[e])=>Math.cos(e.evaluate(t))],tan:[Ti,[Ti],(t,[e])=>Math.tan(e.evaluate(t))],asin:[Ti,[Ti],(t,[e])=>Math.asin(e.evaluate(t))],acos:[Ti,[Ti],(t,[e])=>Math.acos(e.evaluate(t))],atan:[Ti,[Ti],(t,[e])=>Math.atan(e.evaluate(t))],min:[Ti,_s(Ti),(t,e)=>Math.min(...e.map(r=>r.evaluate(t)))],max:[Ti,_s(Ti),(t,e)=>Math.max(...e.map(r=>r.evaluate(t)))],abs:[Ti,[Ti],(t,[e])=>Math.abs(e.evaluate(t))],round:[Ti,[Ti],(t,[e])=>{let r=e.evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[Ti,[Ti],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[Ti,[Ti],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[Vr,[Br,Fr],(t,[e,r])=>t.properties()[e.value]===r.value],"filter-id-==":[Vr,[Fr],(t,[e])=>t.id()===e.value],"filter-type-==":[Vr,[Br],(t,[e])=>t.geometryType()===e.value],"filter-<":[Vr,[Br,Fr],(t,[e,r])=>{let s=t.properties()[e.value],u=r.value;return typeof s==typeof u&&s<u}],"filter-id-<":[Vr,[Fr],(t,[e])=>{let r=t.id(),s=e.value;return typeof r==typeof s&&r<s}],"filter->":[Vr,[Br,Fr],(t,[e,r])=>{let s=t.properties()[e.value],u=r.value;return typeof s==typeof u&&s>u}],"filter-id->":[Vr,[Fr],(t,[e])=>{let r=t.id(),s=e.value;return typeof r==typeof s&&r>s}],"filter-<=":[Vr,[Br,Fr],(t,[e,r])=>{let s=t.properties()[e.value],u=r.value;return typeof s==typeof u&&s<=u}],"filter-id-<=":[Vr,[Fr],(t,[e])=>{let r=t.id(),s=e.value;return typeof r==typeof s&&r<=s}],"filter->=":[Vr,[Br,Fr],(t,[e,r])=>{let s=t.properties()[e.value],u=r.value;return typeof s==typeof u&&s>=u}],"filter-id->=":[Vr,[Fr],(t,[e])=>{let r=t.id(),s=e.value;return typeof r==typeof s&&r>=s}],"filter-has":[Vr,[Fr],(t,[e])=>e.value in t.properties()],"filter-has-id":[Vr,[],t=>t.id()!==null&&t.id()!==void 0],"filter-type-in":[Vr,[Jo(Br)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[Vr,[Jo(Fr)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[Vr,[Br,Jo(Fr)],(t,[e,r])=>r.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[Vr,[Br,Jo(Fr)],(t,[e,r])=>function(s,u,d,p){for(;d<=p;){let _=d+p>>1;if(u[_]===s)return!0;u[_]>s?p=_-1:d=_+1}return!1}(t.properties()[e.value],r.value,0,r.value.length-1)],all:{type:Vr,overloads:[[[Vr,Vr],(t,[e,r])=>e.evaluate(t)&&r.evaluate(t)],[_s(Vr),(t,e)=>{for(let r of e)if(!r.evaluate(t))return!1;return!0}]]},any:{type:Vr,overloads:[[[Vr,Vr],(t,[e,r])=>e.evaluate(t)||r.evaluate(t)],[_s(Vr),(t,e)=>{for(let r of e)if(r.evaluate(t))return!0;return!1}]]},"!":[Vr,[Vr],(t,[e])=>!e.evaluate(t)],"is-supported-script":[Vr,[Br],(t,[e])=>{let r=t.globals&&t.globals.isSupportedScript;return!r||r(e.evaluate(t))}],upcase:[Br,[Br],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[Br,[Br],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[Br,_s(Fr),(t,e)=>e.map(r=>Ks(r.evaluate(t))).join("")],"resolved-locale":[Br,[Rs],(t,[e])=>e.evaluate(t).resolvedLocale()],random:[Ti,[Ti,Ti,Fr],(t,e)=>{let[r,s,u]=e.map(p=>p.evaluate(t));if(r>s||r===s)return r;let d;if(typeof u=="string")d=function(p){let _=0;if(p.length===0)return _;for(let v=0;v<p.length;v++)_=(_<<5)-_+p.charCodeAt(v),_|=0;return _}(u);else{if(typeof u!="number")throw new no(`Invalid seed input: ${u}`);d=u}return r+mp(d)()*(s-r)}]});class j{constructor(e,r,s,u){this.expression=e,this._warningHistory={},this._evaluator=new cm(s,u),this._defaultValue=r?function(d){return d.type==="color"&&(h(d.default)||Array.isArray(d.default))?new jr(0,0,0,0):d.type==="color"?jr.parse(d.default)||null:d.default===void 0?null:d.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(e,r,s,u,d,p,_,v){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=s,this._evaluator.canonical=u||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=p,this._evaluator.featureTileCoord=_||null,this._evaluator.featureDistanceData=v||null,this.expression.evaluate(this._evaluator)}evaluate(e,r,s,u,d,p,_,v){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=s||null,this._evaluator.canonical=u||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=p||null,this._evaluator.featureTileCoord=_||null,this._evaluator.featureDistanceData=v||null;try{let w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new no(`Expected value to be one of ${Object.keys(this._enumValues).map(E=>JSON.stringify(E)).join(", ")}, but found ${JSON.stringify(w)} instead.`);return w}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console<"u"&&console.warn(w.message)),this._defaultValue}}}function X(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in Ru}function re(t,e,r,s){let u=new lp(Ru,[],e?function(p){let _={color:Ao,string:Br,number:Ti,enum:Br,boolean:Vr,formatted:xh,resolvedImage:Vl};return p.type==="array"?Jo(_[p.value]||Fr,p.length):_[p.type]}(e):void 0,void 0,void 0,r,s),d=u.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?Ec(new j(d,e,r,s)):Wl(u.errors)}class ae{constructor(e,r,s){this.kind=e,this._styleExpression=r,this.isLightConstant=s,this.isStateDependent=e!=="constant"&&!Gl(r.expression),this.isConfigDependent=!Kc(r.expression)}evaluateWithoutErrorHandling(e,r,s,u,d,p){return this._styleExpression.evaluateWithoutErrorHandling(e,r,s,u,d,p)}evaluate(e,r,s,u,d,p){return this._styleExpression.evaluate(e,r,s,u,d,p)}}class ue{constructor(e,r,s,u,d){this.kind=e,this.zoomStops=s,this._styleExpression=r,this.isStateDependent=e!=="camera"&&!Gl(r.expression),this.isLightConstant=d,this.isConfigDependent=!Kc(r.expression),this.interpolationType=u}evaluateWithoutErrorHandling(e,r,s,u,d,p){return this._styleExpression.evaluateWithoutErrorHandling(e,r,s,u,d,p)}evaluate(e,r,s,u,d,p){return this._styleExpression.evaluate(e,r,s,u,d,p)}interpolationFactor(e,r,s){return this.interpolationType?ms.interpolationFactor(this.interpolationType,e,r,s):0}}function he(t,e,r,s){if((t=re(t,e,r,s)).result==="error")return t;let u=t.value.expression,d=jo(u);if(!d&&!_d(e))return Wl([new Ls("","data expressions not supported")]);let p=Js(u,["zoom","pitch","distance-from-center"]);if(!p&&!m(e))return Wl([new Ls("","zoom expressions not supported")]);let _=Js(u,["measure-light"]);if(!_&&!F0(e))return Wl([new Ls("","measure-light expression not supported")]);let v=e.expression&&e.expression.relaxZoomRestriction,w=me(u);return w||p||v?w instanceof Ls?Wl([w]):w instanceof ms&&!o(e)?Wl([new Ls("",'"interpolate" expressions cannot be used with this property')]):Ec(w?new ue(d?"camera":"composite",t.value,w.labels,w instanceof ms?w.interpolation:void 0,_):new ae(d?"constant":"source",t.value,_)):Wl([new Ls("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class fe{constructor(e,r){this._parameters=e,this._specification=r,_h(this,y(this._parameters,this._specification))}static deserialize(e){return new fe(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function me(t){let e=null;if(t instanceof pd)e=me(t.result);else if(t instanceof fd){for(let r of t.args)if(e=me(r),e)break}else(t instanceof Sc||t instanceof ms)&&t.input instanceof Co&&t.input.name==="zoom"&&(e=t);return e instanceof Ls||t.eachChild(r=>{let s=me(r);s instanceof Ls?e=s:e&&s&&e!==s&&(e=new Ls("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}var Le=Ne,Oe=3;function Ne(t,e,r){var s=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var u=new Int32Array(this.arrayBuffer);t=u[0],this.d=(e=u[1])+2*(r=u[2]);for(var d=0;d<this.d*this.d;d++){var p=u[Oe+d],_=u[Oe+d+1];s.push(p===_?null:u.subarray(p,_))}var v=u[Oe+s.length+1];this.keys=u.subarray(u[Oe+s.length],v),this.bboxes=u.subarray(v),this.insert=this._insertReadonly}else{this.d=e+2*r;for(var w=0;w<this.d*this.d;w++)s.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=r,this.scale=e/t,this.uid=0;var E=r/e*t;this.min=-E,this.max=t+E}Ne.prototype.insert=function(t,e,r,s,u){this._forEachCell(e,r,s,u,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(s),this.bboxes.push(u)},Ne.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ne.prototype._insertCell=function(t,e,r,s,u,d){this.cells[u].push(d)},Ne.prototype.query=function(t,e,r,s,u){var d=this.min,p=this.max;if(t<=d&&e<=d&&p<=r&&p<=s&&!u)return Array.prototype.slice.call(this.keys);var _=[];return this._forEachCell(t,e,r,s,this._queryCell,_,{},u),_},Ne.prototype._queryCell=function(t,e,r,s,u,d,p,_){var v=this.cells[u];if(v!==null)for(var w=this.keys,E=this.bboxes,k=0;k<v.length;k++){var D=v[k];if(p[D]===void 0){var N=4*D;(_?_(E[N+0],E[N+1],E[N+2],E[N+3]):t<=E[N+2]&&e<=E[N+3]&&r>=E[N+0]&&s>=E[N+1])?(p[D]=!0,d.push(w[D])):p[D]=!1}}},Ne.prototype._forEachCell=function(t,e,r,s,u,d,p,_){for(var v=this._convertToCellCoord(t),w=this._convertToCellCoord(e),E=this._convertToCellCoord(r),k=this._convertToCellCoord(s),D=v;D<=E;D++)for(var N=w;N<=k;N++){var B=this.d*N+D;if((!_||_(this._convertFromCellCoord(D),this._convertFromCellCoord(N),this._convertFromCellCoord(D+1),this._convertFromCellCoord(N+1)))&&u.call(this,t,e,r,s,B,d,p,_))return}},Ne.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Ne.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Ne.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=Oe+this.cells.length+1+1,r=0,s=0;s<this.cells.length;s++)r+=this.cells[s].length;var u=new Int32Array(e+r+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var d=e,p=0;p<t.length;p++){var _=t[p];u[Oe+p]=d,u.set(_,d),d+=_.length}return u[Oe+t.length]=d,u.set(this.keys,d),u[Oe+t.length+1]=d+=this.keys.length,u.set(this.bboxes,d),d+=this.bboxes.length,u.buffer};var Je=K(Le);let Ke={};function Pe(t,e,r={}){Object.defineProperty(t,"_classRegistryKey",{value:e,writable:!1}),Ke[e]={klass:t,omit:r.omit||[]}}Pe(Object,"Object"),Je.serialize=function(t,e){let r=t.toArrayBuffer();return e&&e.add(r),{buffer:r}},Je.deserialize=function(t){return new Je(t.buffer)},Object.defineProperty(Je,"name",{value:"Grid"}),Pe(Je,"Grid"),Pe(jr,"Color"),Pe(Error,"Error"),Pe(Ga,"Formatted"),Pe(yc,"FormattedSection"),Pe(Gc,"AJAXError"),Pe(Qo,"ResolvedImage"),Pe(fe,"StylePropertyFunction"),Pe(j,"StyleExpression",{omit:["_evaluator"]}),Pe(ue,"ZoomDependentExpression"),Pe(ae,"ZoomConstantExpression"),Pe(Co,"CompoundExpression",{omit:["_evaluate"]});for(let t in Ru)Ke[Ru[t]._classRegistryKey]||Pe(Ru[t],`Expression${t}`);function Be(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function je(t){return self.ImageBitmap&&t instanceof ImageBitmap}function at(t,e){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Be(t)||je(t))return e&&e.add(t),t;if(ArrayBuffer.isView(t)){let r=t;return e&&e.add(r.buffer),r}if(t instanceof ImageData)return e&&e.add(t.data.buffer),t;if(Array.isArray(t)){let r=[];for(let s of t)r.push(at(s,e));return r}if(t instanceof Map){let r={$name:"Map"};for(let[s,u]of t.entries())r[s]=at(u);return r}if(typeof t=="object"){let r=t.constructor,s=r._classRegistryKey;if(!s)throw new Error(`can't serialize object of unregistered class ${s}`);let u=r.serialize?r.serialize(t,e):{};if(!r.serialize){for(let d in t)t.hasOwnProperty(d)&&(Ke[s].omit.indexOf(d)>=0||(u[d]=at(t[d],e)));t instanceof Error&&(u.message=t.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return s!=="Object"&&(u.$name=s),u}throw new Error("can't serialize object of type "+typeof t)}function yt(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Be(t)||je(t)||ArrayBuffer.isView(t)||t instanceof ImageData)return t;if(Array.isArray(t))return t.map(yt);if(typeof t=="object"){let e=t.$name||"Object";if(e==="Map"){let u=new Map;for(let d of Object.keys(t))d!=="$name"&&u.set(d,yt(t[d]));return u}let{klass:r}=Ke[e];if(!r)throw new Error(`can't deserialize unregistered class ${e}`);if(r.deserialize)return r.deserialize(t);let s=Object.create(r.prototype);for(let u of Object.keys(t))u!=="$name"&&(s[u]=yt(t[u]));return s}throw new Error("can't deserialize object of type "+typeof t)}let qe={"Latin-1 Supplement":t=>t>=128&&t<=255,Arabic:t=>t>=1536&&t<=1791,"Arabic Supplement":t=>t>=1872&&t<=1919,"Arabic Extended-A":t=>t>=2208&&t<=2303,"Hangul Jamo":t=>t>=4352&&t<=4607,"Unified Canadian Aboriginal Syllabics":t=>t>=5120&&t<=5759,Khmer:t=>t>=6016&&t<=6143,"Unified Canadian Aboriginal Syllabics Extended":t=>t>=6320&&t<=6399,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"CJK Radicals Supplement":t=>t>=11904&&t<=12031,"Kangxi Radicals":t=>t>=12032&&t<=12255,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Bopomofo:t=>t>=12544&&t<=12591,"Hangul Compatibility Jamo":t=>t>=12592&&t<=12687,Kanbun:t=>t>=12688&&t<=12703,"Bopomofo Extended":t=>t>=12704&&t<=12735,"CJK Strokes":t=>t>=12736&&t<=12783,"Katakana Phonetic Extensions":t=>t>=12784&&t<=12799,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"CJK Unified Ideographs Extension A":t=>t>=13312&&t<=19903,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Yi Syllables":t=>t>=40960&&t<=42127,"Yi Radicals":t=>t>=42128&&t<=42191,"Hangul Jamo Extended-A":t=>t>=43360&&t<=43391,"Hangul Syllables":t=>t>=44032&&t<=55215,"Hangul Jamo Extended-B":t=>t>=55216&&t<=55295,"Private Use Area":t=>t>=57344&&t<=63743,"CJK Compatibility Ideographs":t=>t>=63744&&t<=64255,"Arabic Presentation Forms-A":t=>t>=64336&&t<=65023,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Arabic Presentation Forms-B":t=>t>=65136&&t<=65279,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519,"CJK Unified Ideographs Extension B":t=>t>=131072&&t<=173791};function bt(t){for(let e of t)if(qt(e.charCodeAt(0)))return!0;return!1}function Ct(t){for(let e of t)if(!Ht(e.charCodeAt(0)))return!1;return!0}function Ht(t){return!(qe.Arabic(t)||qe["Arabic Supplement"](t)||qe["Arabic Extended-A"](t)||qe["Arabic Presentation Forms-A"](t)||qe["Arabic Presentation Forms-B"](t))}function qt(t){return!(t!==746&&t!==747&&(t<4352||!(qe["Bopomofo Extended"](t)||qe.Bopomofo(t)||qe["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||qe["CJK Compatibility Ideographs"](t)||qe["CJK Compatibility"](t)||qe["CJK Radicals Supplement"](t)||qe["CJK Strokes"](t)||!(!qe["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||t===12336)||qe["CJK Unified Ideographs Extension A"](t)||qe["CJK Unified Ideographs"](t)||qe["Enclosed CJK Letters and Months"](t)||qe["Hangul Compatibility Jamo"](t)||qe["Hangul Jamo Extended-A"](t)||qe["Hangul Jamo Extended-B"](t)||qe["Hangul Jamo"](t)||qe["Hangul Syllables"](t)||qe.Hiragana(t)||qe["Ideographic Description Characters"](t)||qe.Kanbun(t)||qe["Kangxi Radicals"](t)||qe["Katakana Phonetic Extensions"](t)||qe.Katakana(t)&&t!==12540||!(!qe["Halfwidth and Fullwidth Forms"](t)||t===65288||t===65289||t===65293||t>=65306&&t<=65310||t===65339||t===65341||t===65343||t>=65371&&t<=65503||t===65507||t>=65512&&t<=65519)||!(!qe["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||qe["Unified Canadian Aboriginal Syllabics"](t)||qe["Unified Canadian Aboriginal Syllabics Extended"](t)||qe["Vertical Forms"](t)||qe["Yijing Hexagram Symbols"](t)||qe["Yi Syllables"](t)||qe["Yi Radicals"](t))))}function Ut(t){return!(qt(t)||function(e){return!!(qe["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||qe["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||qe["Letterlike Symbols"](e)||qe["Number Forms"](e)||qe["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||qe["Control Pictures"](e)&&e!==9251||qe["Optical Character Recognition"](e)||qe["Enclosed Alphanumerics"](e)||qe["Geometric Shapes"](e)||qe["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||qe["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||qe["CJK Symbols and Punctuation"](e)||qe.Katakana(e)||qe["Private Use Area"](e)||qe["CJK Compatibility Forms"](e)||qe["Small Form Variants"](e)||qe["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(t))}function ft(t){return t>=1424&&t<=2303||qe["Arabic Presentation Forms-A"](t)||qe["Arabic Presentation Forms-B"](t)}function kt(t,e){return!(!e&&ft(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||qe.Khmer(t))}function jt(t){for(let e of t)if(ft(e.charCodeAt(0)))return!0;return!1}let di="deferred",pi="loading",Ai="loaded",mi=null,Yt="unavailable",Nt=null,Li=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(Yt="error"),mi&&mi(t)};function pr(){nr.fire(new Na("pluginStateChange",{pluginStatus:Yt,pluginURL:Nt}))}let nr=new jl,Ir=function(){return Yt},Ur=function(){if(Yt!==di||!Nt)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Yt=pi,pr(),Nt&&ro({url:Nt},t=>{t?Li(t):(Yt=Ai,pr())})},un={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Yt===Ai||un.applyArabicShaping!=null,isLoading:()=>Yt===pi,setState(t){Yt=t.pluginStatus,Nt=t.pluginURL},isParsed:()=>un.applyArabicShaping!=null&&un.processBidirectionalText!=null&&un.processStyledBidirectionalText!=null,getPluginURL:()=>Nt};class ir{constructor(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.transition=r.transition,this.pitch=r.pitch,this.brightness=r.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(e){return function(r,s){for(let u of r)if(!kt(u.charCodeAt(0),s))return!1;return!0}(e,un.isLoaded())}}class tn{constructor(e,r,s,u){this.property=e,this.value=r,this.expression=function(d,p,_,v){if(h(d))return new fe(d,p);if(X(d)||Array.isArray(d)&&d.length>0){let w=he(d,p,_,v);if(w.result==="error")throw new Error(w.value.map(E=>`${E.key}: ${E.message}`).join(", "));return w.value}{let w=d;return typeof d=="string"&&p.type==="color"&&(w=jr.parse(d)),{kind:"constant",isConfigDependent:!1,evaluate:()=>w}}}(r===void 0?e.specification.default:r,e.specification,s,u)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,r,s){return this.property.possiblyEvaluate(this,e,r,s)}}class bn{constructor(e,r,s){this.property=e,this.value=new tn(e,void 0,r,s)}transitioned(e,r){return new Pr(this.property,this.value,r,ya({},e.transition,this.transition),e.now)}untransitioned(){return new Pr(this.property,this.value,null,{},0)}}class cn{constructor(e,r,s){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._scope=r,this._options=s,this.isConfigDependent=!1}getValue(e){return ss(this._values[e].value.value)}setValue(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new bn(this._values[e].property,this._scope,this._options)),this._values[e].value=new tn(this._values[e].property,r===null?void 0:ss(r),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[e].value.expression.isConfigDependent}setTransitionOrValue(e,r){r&&(this._options=r);let s=this._properties.properties;if(e)for(let u in e){let d=e[u];if(Ol(u,"-transition")){let p=u.slice(0,-11);s[p]&&this.setTransition(p,d)}else s.hasOwnProperty(u)&&this.setValue(u,d)}}getTransition(e){return ss(this._values[e].transition)}setTransition(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new bn(this._values[e].property)),this._values[e].transition=ss(r)||void 0}serialize(){let e={};for(let r of Object.keys(this._values)){let s=this.getValue(r);s!==void 0&&(e[r]=s);let u=this.getTransition(r);u!==void 0&&(e[`${r}-transition`]=u)}return e}transitioned(e,r){let s=new or(this._properties);for(let u of Object.keys(this._values))s._values[u]=this._values[u].transitioned(e,r._values[u]);return s}untransitioned(){let e=new or(this._properties);for(let r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}}class Pr{constructor(e,r,s,u,d){let p=u.delay||0,_=u.duration||0;d=d||0,this.property=e,this.value=r,this.begin=d+p,this.end=this.begin+_,e.specification.transition&&(u.delay||u.duration)&&(this.prior=s)}possiblyEvaluate(e,r,s){let u=e.now||0,d=this.value.possiblyEvaluate(e,r,s),p=this.prior;if(p){if(u>this.end)return this.prior=null,d;if(this.value.isDataDriven())return this.prior=null,d;if(u<this.begin)return p.possiblyEvaluate(e,r,s);{let _=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(p.possiblyEvaluate(e,r,s),d,sc(_))}}return d}}class or{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,r,s){let u=new pn(this._properties);for(let d of Object.keys(this._values))u._values[d]=this._values[d].possiblyEvaluate(e,r,s);return u}hasTransition(){for(let e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Fn{constructor(e,r,s){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._scope=r,this._options=s,this.isConfigDependent=!1}getValue(e){return ss(this._values[e].value)}setValue(e,r){this._values[e]=new tn(this._values[e].property,r===null?void 0:ss(r),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[e].expression.isConfigDependent}serialize(){let e={};for(let r of Object.keys(this._values)){let s=this.getValue(r);s!==void 0&&(e[r]=s)}return e}possiblyEvaluate(e,r,s){let u=new pn(this._properties);for(let d of Object.keys(this._values))u._values[d]=this._values[d].possiblyEvaluate(e,r,s);return u}}class zn{constructor(e,r,s){this.property=e,this.value=r,this.parameters=s}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,r,s,u){return this.property.evaluate(this.value,this.parameters,e,r,s,u)}}class pn{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Gt{constructor(e){this.specification=e}possiblyEvaluate(e,r){return e.expression.evaluate(r)}interpolate(e,r,s){let u=Ko[this.specification.type];return u?u(e,r,s):e}}class _i{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,s,u){return new zn(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(r,null,{},s,u)}:e.expression,r)}interpolate(e,r,s){if(e.value.kind!=="constant"||r.value.kind!=="constant")return e;if(e.value.value===void 0||r.value.value===void 0)return new zn(this,{kind:"constant",value:void 0},e.parameters);let u=Ko[this.specification.type];return u?new zn(this,{kind:"constant",value:u(e.value.value,r.value.value,s)},e.parameters):e}evaluate(e,r,s,u,d,p){return e.kind==="constant"?e.value:e.evaluate(r,s,u,d,p)}}class aa{constructor(e){this.specification=e}possiblyEvaluate(e,r,s,u){return!!e.expression.evaluate(r,null,{},s,u)}interpolate(){return!1}}class rn{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];let r=new ir(0,{});for(let s in e){let u=e[s];u.specification.overridable&&this.overridableProperties.push(s);let d=this.defaultPropertyValues[s]=new tn(u,void 0),p=this.defaultTransitionablePropertyValues[s]=new bn(u);this.defaultTransitioningPropertyValues[s]=p.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=d.possiblyEvaluate(r)}}}Pe(_i,"DataDrivenProperty"),Pe(Gt,"DataConstantProperty"),Pe(aa,"ColorRampProperty");var xt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant","experimental":true}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Tl(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Vo(t){if(Array.isArray(t))return t.map(Vo);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){let e={};for(let r in t)e[r]=Vo(t[r]);return e}return Tl(t)}function xs(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(let e of t.slice(1))if(!xs(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function bo(t,e="fill"){if(t==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};xs(t)||(t=tu(t));let r=t,s=!0;try{s=function(w){if(!Sl(w))return w;let E=Vo(w);return Ac(E),E=Ns(E),E}(r)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(r,null,2)}
        `)}let u=xt[`filter_${e}`],d=re(s,u),p=null;if(d.result==="error")throw new Error(d.value.map(w=>`${w.key}: ${w.message}`).join(", "));p=(w,E,k)=>d.value.evaluate(w,E,{},k);let _=null,v=null;if(s!==r){let w=re(r,u);if(w.result==="error")throw new Error(w.value.map(E=>`${E.key}: ${E.message}`).join(", "));_=(E,k,D,N,B)=>w.value.evaluate(E,k,{},D,void 0,void 0,N,B),v=!jo(w.value.expression)}return{filter:p,dynamicFilter:_||void 0,needGeometry:Ou(s),needFeature:!!v}}function Ns(t){if(!Array.isArray(t))return t;let e=function(r){if(Ih.has(r[0])){for(let s=1;s<r.length;s++)if(Sl(r[s]))return!0}return r}(t);return e===!0?e:e.map(r=>Ns(r))}function Ac(t){let e=!1,r=[];if(t[0]==="case"){for(let s=1;s<t.length-1;s+=2)e=e||Sl(t[s]),r.push(t[s+1]);r.push(t[t.length-1])}else if(t[0]==="match"){e=e||Sl(t[1]);for(let s=2;s<t.length-1;s+=2)r.push(t[s+1]);r.push(t[t.length-1])}else if(t[0]==="step"){e=e||Sl(t[1]);for(let s=1;s<t.length-1;s+=2)r.push(t[s+1])}e&&(t.length=0,t.push("any",...r));for(let s=1;s<t.length;s++)Ac(t[s])}function Sl(t){if(!Array.isArray(t))return!1;if((e=t[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let r=1;r<t.length;r++)if(Sl(t[r]))return!0;return!1}let Ih=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function kh(t,e){return t<e?-1:t>e?1:0}function Ou(t){if(!Array.isArray(t))return!1;if(t[0]==="within"||t[0]==="distance")return!0;for(let e=1;e<t.length;e++)if(Ou(t[e]))return!0;return!1}function tu(t){if(!t)return!0;let e=t[0];return t.length<=1?e!=="any":e==="=="?Nu(t[1],t[2],"=="):e==="!="?xd(Nu(t[1],t[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Nu(t[1],t[2],e):e==="any"?(r=t.slice(1),["any"].concat(r.map(tu))):e==="all"?["all"].concat(t.slice(1).map(tu)):e==="none"?["all"].concat(t.slice(1).map(tu).map(xd)):e==="in"?sf(t[1],t.slice(2)):e==="!in"?xd(sf(t[1],t.slice(2))):e==="has"?lf(t[1]):e!=="!has"||xd(lf(t[1]));var r}function Nu(t,e,r){switch(t){case"$type":return[`filter-type-${r}`,e];case"$id":return[`filter-id-${r}`,e];default:return[`filter-${r}`,t,e]}}function sf(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(r=>typeof r!=typeof e[0])?["filter-in-large",t,["literal",e.sort(kh)]]:["filter-in-small",t,["literal",e]]}}function lf(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function xd(t){return["!",t]}let cf="";function mm(t,e){return e?`${t}${cf}${e}`:t}let gm="-transition",P0=new Set(["fill","line","background","hillshade","raster"]);class ho extends jl{constructor(e,r,s,u,d){if(super(),this.id=e.id,this.fqid=mm(this.id,s),this.type=e.type,this.scope=s,this.lut=u,this.options=d,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&e.type!=="slot"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),e.slot&&(this.slot=e.slot),r.layout&&(this._unevaluatedLayout=new Fn(r.layout,this.scope,d),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),r.paint)){this._transitionablePaint=new cn(r.paint,this.scope,d);for(let p in e.paint)this.setPaintProperty(p,e.paint[p]);for(let p in e.layout)this.setLayoutProperty(p,e.layout[p]);this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new pn(r.paint)}}onAdd(e){}onRemove(e){}isDraped(e){return P0.has(this.type)}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,r){if(this.type==="custom"&&e==="visibility")return void(this.visibility=r);let s=this._unevaluatedLayout;s._properties.properties[e]&&(s.setValue(e,r),this.isConfigDependent=this.isConfigDependent||s.isConfigDependent,e==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(e){return Ol(e,gm)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r){let s=this._transitionablePaint,u=s._properties.properties;if(Ol(e,gm)){let k=e.slice(0,-11);return u[k]&&s.setTransition(k,r||void 0),!1}if(!u[e])return!1;let d=s._values[e],p=d.value.isDataDriven(),_=d.value;s.setValue(e,r),this.isConfigDependent=this.isConfigDependent||s.isConfigDependent,this._handleSpecialPaintPropertyUpdate(e);let v=s._values[e].value,w=v.isDataDriven(),E=Ol(e,"pattern")||e==="line-dasharray";return w||p||E||this._handleOverridablePaintPropertyUpdate(e,_,v)}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getDefaultProgramParams(e,r,s){return null}_handleOverridablePaintPropertyUpdate(e,r,s){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){return pl({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(e,r)=>!(e===void 0||r==="layout"&&!Object.keys(e).length||r==="paint"&&!Object.keys(e).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(let e in this.paint._values){let r=this.paint.get(e);if(r instanceof zn&&_d(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=bo(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(e){this._stats&&(e.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(e){}queryIntersectsFeature(e,r,s,u,d,p,_,v,w){}queryIntersectsMatchingFeature(e,r,s,u){}}let L0={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class uf{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Yn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.add(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){let r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...e){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...e){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function nn(t,e=1){let r=0,s=0;return{members:t.map(u=>{let d=L0[u.type].BYTES_PER_ELEMENT,p=r=G2(r,Math.max(e,d)),_=u.components||1;return s=Math.max(s,d),r+=d*_,{name:u.name,type:u.type,components:_,offset:p}}),size:G2(r,Math.max(s,e)),alignment:e}}function G2(t,e){return Math.ceil(t/e)*e}class Bu extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){let s=this.length;return this.resize(s+1),this.emplace(s,e,r)}emplace(e,r,s){let u=2*e;return this.int16[u+0]=r,this.int16[u+1]=s,e}}Bu.prototype.bytesPerElement=4,Pe(Bu,"StructArrayLayout2i4");class o_ extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,s){let u=this.length;return this.resize(u+1),this.emplace(u,e,r,s)}emplace(e,r,s,u){let d=3*e;return this.int16[d+0]=r,this.int16[d+1]=s,this.int16[d+2]=u,e}}o_.prototype.bytesPerElement=6,Pe(o_,"StructArrayLayout3i6");class hf extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,s,u){let d=this.length;return this.resize(d+1),this.emplace(d,e,r,s,u)}emplace(e,r,s,u,d){let p=4*e;return this.int16[p+0]=r,this.int16[p+1]=s,this.int16[p+2]=u,this.int16[p+3]=d,e}}hf.prototype.bytesPerElement=8,Pe(hf,"StructArrayLayout4i8");class Wx extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,s,u,d){let p=this.length;return this.resize(p+1),this.emplace(p,e,r,s,u,d)}emplace(e,r,s,u,d,p){let _=5*e;return this.int16[_+0]=r,this.int16[_+1]=s,this.int16[_+2]=u,this.int16[_+3]=d,this.int16[_+4]=p,e}}Wx.prototype.bytesPerElement=10,Pe(Wx,"StructArrayLayout5i10");class qx extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,d,p,_){let v=this.length;return this.resize(v+1),this.emplace(v,e,r,s,u,d,p,_)}emplace(e,r,s,u,d,p,_,v){let w=6*e,E=12*e,k=3*e;return this.int16[w+0]=r,this.int16[w+1]=s,this.uint8[E+4]=u,this.uint8[E+5]=d,this.uint8[E+6]=p,this.uint8[E+7]=_,this.float32[k+2]=v,e}}qx.prototype.bytesPerElement=12,Pe(qx,"StructArrayLayout2i4ub1f12");class df extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u){let d=this.length;return this.resize(d+1),this.emplace(d,e,r,s,u)}emplace(e,r,s,u,d){let p=4*e;return this.float32[p+0]=r,this.float32[p+1]=s,this.float32[p+2]=u,this.float32[p+3]=d,e}}df.prototype.bytesPerElement=16,Pe(df,"StructArrayLayout4f16");class ff extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s){let u=this.length;return this.resize(u+1),this.emplace(u,e,r,s)}emplace(e,r,s,u){let d=3*e;return this.float32[d+0]=r,this.float32[d+1]=s,this.float32[d+2]=u,e}}ff.prototype.bytesPerElement=12,Pe(ff,"StructArrayLayout3f12");class pf extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,d){let p=this.length;return this.resize(p+1),this.emplace(p,e,r,s,u,d)}emplace(e,r,s,u,d,p){let _=6*e,v=3*e;return this.uint16[_+0]=r,this.uint16[_+1]=s,this.uint16[_+2]=u,this.uint16[_+3]=d,this.float32[v+2]=p,e}}pf.prototype.bytesPerElement=12,Pe(pf,"StructArrayLayout4ui1f12");class s_ extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,s,u){let d=this.length;return this.resize(d+1),this.emplace(d,e,r,s,u)}emplace(e,r,s,u,d){let p=4*e;return this.uint16[p+0]=r,this.uint16[p+1]=s,this.uint16[p+2]=u,this.uint16[p+3]=d,e}}s_.prototype.bytesPerElement=8,Pe(s_,"StructArrayLayout4ui8");class l_ extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,s,u,d,p){let _=this.length;return this.resize(_+1),this.emplace(_,e,r,s,u,d,p)}emplace(e,r,s,u,d,p,_){let v=6*e;return this.int16[v+0]=r,this.int16[v+1]=s,this.int16[v+2]=u,this.int16[v+3]=d,this.int16[v+4]=p,this.int16[v+5]=_,e}}l_.prototype.bytesPerElement=12,Pe(l_,"StructArrayLayout6i12");class $x extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,s,u,d,p,_,v,w,E,k,D){let N=this.length;return this.resize(N+1),this.emplace(N,e,r,s,u,d,p,_,v,w,E,k,D)}emplace(e,r,s,u,d,p,_,v,w,E,k,D,N){let B=12*e;return this.int16[B+0]=r,this.int16[B+1]=s,this.int16[B+2]=u,this.int16[B+3]=d,this.uint16[B+4]=p,this.uint16[B+5]=_,this.uint16[B+6]=v,this.uint16[B+7]=w,this.int16[B+8]=E,this.int16[B+9]=k,this.int16[B+10]=D,this.int16[B+11]=N,e}}$x.prototype.bytesPerElement=24,Pe($x,"StructArrayLayout4i4ui4i24");class Xx extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,d,p){let _=this.length;return this.resize(_+1),this.emplace(_,e,r,s,u,d,p)}emplace(e,r,s,u,d,p,_){let v=10*e,w=5*e;return this.int16[v+0]=r,this.int16[v+1]=s,this.int16[v+2]=u,this.float32[w+2]=d,this.float32[w+3]=p,this.float32[w+4]=_,e}}Xx.prototype.bytesPerElement=20,Pe(Xx,"StructArrayLayout3i3f20");class Zx extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint32[1*e+0]=r,e}}Zx.prototype.bytesPerElement=4,Pe(Zx,"StructArrayLayout1ul4");class gp extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.float32[1*e+0]=r,e}}gp.prototype.bytesPerElement=4,Pe(gp,"StructArrayLayout1f4");class mf extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){let s=this.length;return this.resize(s+1),this.emplace(s,e,r)}emplace(e,r,s){let u=2*e;return this.uint16[u+0]=r,this.uint16[u+1]=s,e}}mf.prototype.bytesPerElement=4,Pe(mf,"StructArrayLayout2ui4");class Yx extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,s,u,d,p,_,v,w,E,k,D,N){let B=this.length;return this.resize(B+1),this.emplace(B,e,r,s,u,d,p,_,v,w,E,k,D,N)}emplace(e,r,s,u,d,p,_,v,w,E,k,D,N,B){let q=20*e,Z=10*e;return this.int16[q+0]=r,this.int16[q+1]=s,this.int16[q+2]=u,this.int16[q+3]=d,this.int16[q+4]=p,this.float32[Z+3]=_,this.float32[Z+4]=v,this.float32[Z+5]=w,this.float32[Z+6]=E,this.int16[q+14]=k,this.uint32[Z+8]=D,this.uint16[q+18]=N,this.uint16[q+19]=B,e}}Yx.prototype.bytesPerElement=40,Pe(Yx,"StructArrayLayout5i4f1i1ul2ui40");class c_ extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,s,u,d,p,_){let v=this.length;return this.resize(v+1),this.emplace(v,e,r,s,u,d,p,_)}emplace(e,r,s,u,d,p,_,v){let w=8*e;return this.int16[w+0]=r,this.int16[w+1]=s,this.int16[w+2]=u,this.int16[w+4]=d,this.int16[w+5]=p,this.int16[w+6]=_,this.int16[w+7]=v,e}}c_.prototype.bytesPerElement=16,Pe(c_,"StructArrayLayout3i2i2i16");class Kx extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,s,u,d){let p=this.length;return this.resize(p+1),this.emplace(p,e,r,s,u,d)}emplace(e,r,s,u,d,p){let _=4*e,v=8*e;return this.float32[_+0]=r,this.float32[_+1]=s,this.float32[_+2]=u,this.int16[v+6]=d,this.int16[v+7]=p,e}}Kx.prototype.bytesPerElement=16,Pe(Kx,"StructArrayLayout2f1f2i16");class Jx extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u){let d=this.length;return this.resize(d+1),this.emplace(d,e,r,s,u)}emplace(e,r,s,u,d){let p=12*e,_=3*e;return this.uint8[p+0]=r,this.uint8[p+1]=s,this.float32[_+1]=u,this.float32[_+2]=d,e}}Jx.prototype.bytesPerElement=12,Pe(Jx,"StructArrayLayout2ub2f12");class ko extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,s){let u=this.length;return this.resize(u+1),this.emplace(u,e,r,s)}emplace(e,r,s,u){let d=3*e;return this.uint16[d+0]=r,this.uint16[d+1]=s,this.uint16[d+2]=u,e}}ko.prototype.bytesPerElement=6,Pe(ko,"StructArrayLayout3ui6");class Qx extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,d,p,_,v,w,E,k,D,N,B,q,Z,oe,ve,be,we,$e){let Ge=this.length;return this.resize(Ge+1),this.emplace(Ge,e,r,s,u,d,p,_,v,w,E,k,D,N,B,q,Z,oe,ve,be,we,$e)}emplace(e,r,s,u,d,p,_,v,w,E,k,D,N,B,q,Z,oe,ve,be,we,$e,Ge){let it=30*e,ot=15*e,_t=60*e;return this.int16[it+0]=r,this.int16[it+1]=s,this.int16[it+2]=u,this.float32[ot+2]=d,this.float32[ot+3]=p,this.uint16[it+8]=_,this.uint16[it+9]=v,this.uint32[ot+5]=w,this.uint32[ot+6]=E,this.uint32[ot+7]=k,this.uint16[it+16]=D,this.uint16[it+17]=N,this.uint16[it+18]=B,this.float32[ot+10]=q,this.float32[ot+11]=Z,this.uint8[_t+48]=oe,this.uint8[_t+49]=ve,this.uint8[_t+50]=be,this.uint32[ot+13]=we,this.int16[it+28]=$e,this.uint8[_t+58]=Ge,e}}Qx.prototype.bytesPerElement=60,Pe(Qx,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class ev extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,d,p,_,v,w,E,k,D,N,B,q,Z,oe,ve,be,we,$e,Ge,it,ot,_t,Mt,At,zt,Jt,Ot,Xt,Dt,Zt,ri){let Kt=this.length;return this.resize(Kt+1),this.emplace(Kt,e,r,s,u,d,p,_,v,w,E,k,D,N,B,q,Z,oe,ve,be,we,$e,Ge,it,ot,_t,Mt,At,zt,Jt,Ot,Xt,Dt,Zt,ri)}emplace(e,r,s,u,d,p,_,v,w,E,k,D,N,B,q,Z,oe,ve,be,we,$e,Ge,it,ot,_t,Mt,At,zt,Jt,Ot,Xt,Dt,Zt,ri,Kt){let Si=22*e,ei=44*e,li=88*e;return this.float32[Si+0]=r,this.float32[Si+1]=s,this.int16[ei+4]=u,this.int16[ei+5]=d,this.int16[ei+6]=p,this.int16[ei+7]=_,this.int16[ei+8]=v,this.int16[ei+9]=w,this.int16[ei+10]=E,this.int16[ei+11]=k,this.int16[ei+12]=D,this.uint16[ei+13]=N,this.uint16[ei+14]=B,this.uint16[ei+15]=q,this.uint16[ei+16]=Z,this.uint16[ei+17]=oe,this.uint16[ei+18]=ve,this.uint16[ei+19]=be,this.uint16[ei+20]=we,this.uint16[ei+21]=$e,this.uint16[ei+22]=Ge,this.uint16[ei+23]=it,this.uint16[ei+24]=ot,this.uint16[ei+25]=_t,this.uint16[ei+26]=Mt,this.uint16[ei+27]=At,this.uint32[Si+14]=zt,this.float32[Si+15]=Jt,this.float32[Si+16]=Ot,this.float32[Si+17]=Xt,this.float32[Si+18]=Dt,this.float32[Si+19]=Zt,this.float32[Si+20]=ri,this.uint8[li+84]=Kt,e}}ev.prototype.bytesPerElement=88,Pe(ev,"StructArrayLayout2f9i15ui1ul6f1ub88");class _p extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,d){let p=this.length;return this.resize(p+1),this.emplace(p,e,r,s,u,d)}emplace(e,r,s,u,d,p){let _=5*e;return this.float32[_+0]=r,this.float32[_+1]=s,this.float32[_+2]=u,this.float32[_+3]=d,this.float32[_+4]=p,e}}_p.prototype.bytesPerElement=20,Pe(_p,"StructArrayLayout5f20");class tv extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,d,p,_){let v=this.length;return this.resize(v+1),this.emplace(v,e,r,s,u,d,p,_)}emplace(e,r,s,u,d,p,_,v){let w=7*e;return this.float32[w+0]=r,this.float32[w+1]=s,this.float32[w+2]=u,this.float32[w+3]=d,this.float32[w+4]=p,this.float32[w+5]=_,this.float32[w+6]=v,e}}tv.prototype.bytesPerElement=28,Pe(tv,"StructArrayLayout7f28");class _m extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){let s=this.length;return this.resize(s+1),this.emplace(s,e,r)}emplace(e,r,s){let u=2*e;return this.float32[u+0]=r,this.float32[u+1]=s,e}}_m.prototype.bytesPerElement=8,Pe(_m,"StructArrayLayout2f8");class iv extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,s,u){let d=this.length;return this.resize(d+1),this.emplace(d,e,r,s,u)}emplace(e,r,s,u,d){let p=6*e;return this.uint32[3*e+0]=r,this.uint16[p+2]=s,this.uint16[p+3]=u,this.uint16[p+4]=d,e}}iv.prototype.bytesPerElement=12,Pe(iv,"StructArrayLayout1ul3ui12");class R0 extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint16[1*e+0]=r,e}}R0.prototype.bytesPerElement=2,Pe(R0,"StructArrayLayout1ui2");class rv extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,d,p,_,v,w,E,k,D,N,B,q,Z){let oe=this.length;return this.resize(oe+1),this.emplace(oe,e,r,s,u,d,p,_,v,w,E,k,D,N,B,q,Z)}emplace(e,r,s,u,d,p,_,v,w,E,k,D,N,B,q,Z,oe){let ve=16*e;return this.float32[ve+0]=r,this.float32[ve+1]=s,this.float32[ve+2]=u,this.float32[ve+3]=d,this.float32[ve+4]=p,this.float32[ve+5]=_,this.float32[ve+6]=v,this.float32[ve+7]=w,this.float32[ve+8]=E,this.float32[ve+9]=k,this.float32[ve+10]=D,this.float32[ve+11]=N,this.float32[ve+12]=B,this.float32[ve+13]=q,this.float32[ve+14]=Z,this.float32[ve+15]=oe,e}}rv.prototype.bytesPerElement=64,Pe(rv,"StructArrayLayout16f64");class u_ extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,s,u,d,p,_){let v=this.length;return this.resize(v+1),this.emplace(v,e,r,s,u,d,p,_)}emplace(e,r,s,u,d,p,_,v){let w=10*e,E=5*e;return this.uint16[w+0]=r,this.uint16[w+1]=s,this.uint16[w+2]=u,this.uint16[w+3]=d,this.float32[E+2]=p,this.float32[E+3]=_,this.float32[E+4]=v,e}}u_.prototype.bytesPerElement=20,Pe(u_,"StructArrayLayout4ui3f20");class nv extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.int16[1*e+0]=r,e}}nv.prototype.bytesPerElement=2,Pe(nv,"StructArrayLayout1i2");class av extends Yn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(e){let r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint8[1*e+0]=r,e}}av.prototype.bytesPerElement=1,Pe(av,"StructArrayLayout1ub1");class W2 extends uf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}W2.prototype.size=40;class ov extends Yx{get(e){return new W2(this,e)}}Pe(ov,"CollisionBoxArray");class q2 extends uf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}q2.prototype.size=60;class $2 extends Qx{get(e){return new q2(this,e)}}Pe($2,"PlacedSymbolArray");class X2 extends uf{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(e){this._structArray.uint32[this._pos4+14]=e}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(e){this._structArray.float32[this._pos4+18]=e}get occlusionState(){return this._structArray.float32[this._pos4+19]}set occlusionState(e){this._structArray.float32[this._pos4+19]=e}get occlusionOpacity(){return this._structArray.float32[this._pos4+20]}set occlusionOpacity(e){this._structArray.float32[this._pos4+20]=e}get hasIconTextFit(){return this._structArray.uint8[this._pos1+84]}}X2.prototype.size=88;class Z2 extends ev{get(e){return new X2(this,e)}}Pe(Z2,"SymbolInstanceArray");class Y2 extends gp{getoffsetX(e){return this.float32[1*e+0]}}Pe(Y2,"GlyphOffsetArray");class K2 extends Bu{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}Pe(K2,"SymbolLineVertexArray");class J2 extends uf{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}J2.prototype.size=12;class Q2 extends iv{get(e){return new J2(this,e)}}Pe(Q2,"FeatureIndexArray");class ew extends mf{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}Pe(ew,"FillExtrusionCentroidArray");let aI=nn([{name:"a_pos",components:2,type:"Int16"}],4),oI=nn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class oa{constructor(e=[]){this.segments=e}_prepareSegment(e,r,s,u){let d=this.segments[this.segments.length-1];return e>oa.MAX_VERTEX_ARRAY_LENGTH&&Nn(`Max vertices per segment is ${oa.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!d||d.vertexLength+e>oa.MAX_VERTEX_ARRAY_LENGTH||d.sortKey!==u)&&(d={vertexOffset:r,primitiveOffset:s,vertexLength:0,primitiveLength:0},u!==void 0&&(d.sortKey=u),this.segments.push(d)),d}prepareSegment(e,r,s,u){return this._prepareSegment(e,r.length,s.length,u)}get(){return this.segments}destroy(){for(let e of this.segments)for(let r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,s,u){return new oa([{vertexOffset:e,primitiveOffset:r,vertexLength:s,primitiveLength:u,vaos:{},sortKey:0}])}}function tw(t,e){return 256*(t=lr(Math.floor(t),0,255))+lr(Math.floor(e),0,255)}oa.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Pe(oa,"SegmentVector");let sI=nn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),lI=nn([{name:"a_dash",components:4,type:"Uint16"}]);class O0{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(e,r,s,u){this.ids.push(iw(e)),this.positions.push(r,s,u)}eachPosition(e,r){let s=iw(e),u=0,d=this.ids.length-1;for(;u<d;){let p=u+d>>1;this.ids[p]>=s?d=p:u=p+1}for(;this.ids[u]===s;)r(this.positions[3*u],this.positions[3*u+1],this.positions[3*u+2]),u++}static serialize(e,r){let s=new Float64Array(e.ids),u=new Uint32Array(e.positions);return sv(s,u,0,s.length-1),r&&(r.add(s.buffer),r.add(u.buffer)),{ids:s,positions:u}}static deserialize(e){let r=new O0,s;r.ids=e.ids,r.positions=e.positions;for(let u of r.ids)u!==s&&r.uniqueIds.push(u),s=u;return r.indexed=!0,r}}function iw(t){let e=+t;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:na(String(t))}function sv(t,e,r,s){for(;r<s;){let u=t[r+s>>1],d=r-1,p=s+1;for(;;){do d++;while(t[d]<u);do p--;while(t[p]>u);if(d>=p)break;h_(t,d,p),h_(e,3*d,3*p),h_(e,3*d+1,3*p+1),h_(e,3*d+2,3*p+2)}p-r<s-p?(sv(t,e,r,p),r=p+1):(sv(t,e,p+1,s),s=p)}}function h_(t,e,r){let s=t[e];t[e]=t[r],t[r]=s}Pe(O0,"FeaturePositionMap");class vd{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,r){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,r),this.initialized=!0),!!this.location}set(e,r,s){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class d_ extends vd{constructor(e){super(e),this.current=0}set(e,r,s){this.fetchUniformLocation(e,r)&&this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}}class tl extends vd{constructor(e){super(e),this.current=0}set(e,r,s){this.fetchUniformLocation(e,r)&&this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class yd extends vd{constructor(e){super(e),this.current=[0,0]}set(e,r,s){this.fetchUniformLocation(e,r)&&(s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1])))}}class lv extends vd{constructor(e){super(e),this.current=[0,0,0]}set(e,r,s){this.fetchUniformLocation(e,r)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2])))}}class cv extends vd{constructor(e){super(e),this.current=[0,0,0,0]}set(e,r,s){this.fetchUniformLocation(e,r)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3])))}}class rw extends vd{constructor(e){super(e),this.current=jr.transparent.toRenderColor(null)}set(e,r,s){this.fetchUniformLocation(e,r)&&(s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a)))}}let cI=new Float32Array(16);class N0 extends vd{constructor(e){super(e),this.current=cI}set(e,r,s){if(this.fetchUniformLocation(e,r)){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let u=1;u<16;u++)if(s[u]!==this.current[u]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}}}let uI=new Float32Array(9),hI=new Float32Array(4);class uv extends vd{constructor(e){super(e),this.current=hI}set(e,r,s){if(this.fetchUniformLocation(e,r)){for(let u=0;u<4;u++)if(s[u]!==this.current[u]){this.current=s,this.gl.uniformMatrix2fv(this.location,!1,s);break}}}}function hv(t){return[tw(255*t.r,255*t.g),tw(255*t.b,255*t.a)]}class B0{constructor(e,r,s,u){this.value=e,this.uniformNames=r.map(d=>`u_${d}`),this.type=s,this.context=u}setUniform(e,r,s,u,d){let p=u.constantOr(this.value);r.set(e,d,p instanceof jr?p.toRenderColor(this.context.lut):p)}getBinding(e,r){return this.type==="color"?new rw(e):new tl(e)}}class xm{constructor(e,r){this.uniformNames=r.map(s=>`u_${s}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,r,s,u,d){let p=d==="u_pattern"||d==="u_dash"?this.pattern:d==="u_pixel_ratio"?this.pixelRatio:null;p&&r.set(e,d,p)}getBinding(e,r){return r==="u_pattern"||r==="u_dash"?new cv(e):new tl(e)}}class bd{constructor(e,r,s,u){this.expression=e,this.type=s,this.maxValue=0,this.paintVertexAttributes=r.map(d=>({name:`a_${d}`,type:"Float32",components:s==="color"?2:1,offset:0})),this.paintVertexArray=new u}populatePaintArray(e,r,s,u,d,p,_){let v=this.paintVertexArray.length,w=this.expression.evaluate(new ir(0,{brightness:p}),r,{},d,u,_);this.paintVertexArray.resize(e),this._setPaintValue(v,e,w,this.context)}updatePaintArray(e,r,s,u,d,p,_){let v=this.expression.evaluate({zoom:0,brightness:_},s,u,void 0,d);this._setPaintValue(e,r,v,this.context)}_setPaintValue(e,r,s,u){if(this.type==="color"){let d=hv(s.toRenderColor(u.lut));for(let p=e;p<r;p++)this.paintVertexArray.emplace(p,d[0],d[1])}else{for(let d=e;d<r;d++)this.paintVertexArray.emplace(d,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class zu{constructor(e,r,s,u,d,p){this.expression=e,this.uniformNames=r.map(_=>`u_${_}_t`),this.type=s,this.useIntegerZoom=u,this.context=d,this.maxValue=0,this.paintVertexAttributes=r.map(_=>({name:`a_${_}`,type:"Float32",components:s==="color"?4:2,offset:0})),this.paintVertexArray=new p}populatePaintArray(e,r,s,u,d,p,_){let v=this.expression.evaluate(new ir(this.context.zoom,{brightness:p}),r,{},d,u,_),w=this.expression.evaluate(new ir(this.context.zoom+1,{brightness:p}),r,{},d,u,_),E=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(E,e,v,w,this.context)}updatePaintArray(e,r,s,u,d,p,_){let v=this.expression.evaluate({zoom:this.context.zoom,brightness:_},s,u,void 0,d),w=this.expression.evaluate({zoom:this.context.zoom+1,brightness:_},s,u,void 0,d);this._setPaintValue(e,r,v,w,this.context)}_setPaintValue(e,r,s,u,d){if(this.type==="color"){let p=hv(s.toRenderColor(d.lut)),_=hv(s.toRenderColor(d.lut));for(let v=e;v<r;v++)this.paintVertexArray.emplace(v,p[0],p[1],_[0],_[1])}else{for(let p=e;p<r;p++)this.paintVertexArray.emplace(p,s,u);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,r,s,u,d){let p=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,_=lr(this.expression.interpolationFactor(p,this.context.zoom,this.context.zoom+1),0,1);r.set(e,d,_)}getBinding(e,r){return new tl(e)}}class gf{constructor(e,r,s,u,d){this.expression=e,this.layerId=d,this.paintVertexAttributes=(s==="array"?lI:sI).members;for(let p=0;p<r.length;++p);this.paintVertexArray=new u}populatePaintArray(e,r,s,u){let d=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(d,e,r.patterns&&r.patterns[this.layerId],s)}updatePaintArray(e,r,s,u,d,p,_){this._setPaintValues(e,r,s.patterns&&s.patterns[this.layerId],p)}_setPaintValues(e,r,s,u){if(!u||!s)return;let d=u[s];if(!d)return;let{tl:p,br:_,pixelRatio:v}=d;for(let w=e;w<r;w++)this.paintVertexArray.emplace(w,p[0],p[1],_[0],_[1],v)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class xp{constructor(e,r,s=()=>!0){this.binders={},this._buffers=[],this.context=r;let u=[];for(let d in e.paint._values){let p=e.paint.get(d);if(!s(d)||!(p instanceof zn&&_d(p.property.specification)))continue;let _=fI(d,e.type),v=p.value,w=p.property.specification.type,E=!!p.property.useIntegerZoom,k=d==="line-dasharray"||d.endsWith("pattern"),D=d==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(v.kind!=="constant"||D)if(v.kind==="source"||D||k){let N=nw(d,w,"source");this.binders[d]=k?new gf(v,_,w,N,e.id):new bd(v,_,w,N),u.push(`/a_${d}`)}else{let N=nw(d,w,"composite");this.binders[d]=new zu(v,_,w,E,r,N),u.push(`/z_${d}`)}else this.binders[d]=k?new xm(v.value,_):new B0(v.value,_,w,r),u.push(`/u_${d}`)}this.cacheKey=u.sort().join("")}getMaxValue(e){let r=this.binders[e];return r instanceof bd||r instanceof zu?r.maxValue:0}populatePaintArrays(e,r,s,u,d,p,_){for(let v in this.binders){let w=this.binders[v];w.context=this.context,(w instanceof bd||w instanceof zu||w instanceof gf)&&w.populatePaintArray(e,r,s,u,d,p,_)}}setConstantPatternPositions(e){for(let r in this.binders){let s=this.binders[r];s instanceof xm&&s.setConstantPatternPositions(e)}}updatePaintArrays(e,r,s,u,d,p,_,v){let w=!1,E=Object.keys(e),k=E.length!==0,D=k?E:r.uniqueIds;this.context.lut=d.lut;for(let N in this.binders){let B=this.binders[N];if(B.context=this.context,(B instanceof bd||B instanceof zu||B instanceof gf)&&(B.expression.isStateDependent===!0||B.expression.isLightConstant===!1)){let q=d.paint.get(N);B.expression=q.value;for(let Z of D){let oe=e[Z.toString()];r.eachPosition(Z,(ve,be,we)=>{let $e=u.feature(ve);B.updatePaintArray(be,we,$e,oe,p,_,v)})}if(!k)for(let Z of s.uniqueIds){let oe=e[Z.toString()];s.eachPosition(Z,(ve,be,we)=>{let $e=u.feature(ve);B.updatePaintArray(be,we,$e,oe,p,_,v)})}w=!0}}return w}defines(){let e=[];for(let r in this.binders){let s=this.binders[r];(s instanceof B0||s instanceof xm)&&e.push(...s.uniformNames.map(u=>`#define HAS_UNIFORM_${u}`))}return e}getBinderAttributes(){let e=[];for(let r in this.binders){let s=this.binders[r];if(s instanceof bd||s instanceof zu||s instanceof gf)for(let u=0;u<s.paintVertexAttributes.length;u++)e.push(s.paintVertexAttributes[u].name)}return e}getBinderUniforms(){let e=[];for(let r in this.binders){let s=this.binders[r];if(s instanceof B0||s instanceof xm||s instanceof zu)for(let u of s.uniformNames)e.push(u)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){let r=[];for(let s in this.binders){let u=this.binders[s];if(u instanceof B0||u instanceof xm||u instanceof zu)for(let d of u.uniformNames)r.push({name:d,property:s,binding:u.getBinding(e,d)})}return r}setUniforms(e,r,s,u,d){for(let{name:p,property:_,binding:v}of s)this.binders[_].setUniform(e,v,d,u.get(_),p)}updatePaintBuffers(){this._buffers=[];for(let e in this.binders){let r=this.binders[e];(r instanceof bd||r instanceof zu||r instanceof gf)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(e){for(let r in this.binders){let s=this.binders[r];(s instanceof bd||s instanceof zu||s instanceof gf)&&s.upload(e)}this.updatePaintBuffers()}destroy(){for(let e in this.binders){let r=this.binders[e];(r instanceof bd||r instanceof zu||r instanceof gf)&&r.destroy()}}}class _f{constructor(e,r,s=()=>!0){this.programConfigurations={};for(let u of e)this.programConfigurations[u.id]=new xp(u,r,s);this.needsUpload=!1,this._featureMap=new O0,this._featureMapWithoutIds=new O0,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(e,r,s,u,d,p,_,v){for(let w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(e,r,u,d,p,_,v);r.id!==void 0?this._featureMap.add(r.id,s,this._bufferOffset,e):(this._featureMapWithoutIds.add(this._idlessCounter,s,this._bufferOffset,e),this._idlessCounter+=1),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,s,u,d,p){for(let _ of s)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(e,this._featureMap,this._featureMapWithoutIds,r,_,u,d,p||0)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(let r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(let e in this.programConfigurations)this.programConfigurations[e].destroy()}}let dI={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function fI(t,e){return dI[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}let pI={"line-pattern":{source:pf,composite:pf},"fill-pattern":{source:pf,composite:pf},"fill-extrusion-pattern":{source:pf,composite:pf},"line-dasharray":{source:s_,composite:s_}},mI={color:{source:_m,composite:df},number:{source:gp,composite:_m}};function nw(t,e,r){let s=pI[t];return s&&s[r]||mI[e][r]}Pe(B0,"ConstantBinder"),Pe(xm,"PatternConstantBinder"),Pe(bd,"SourceExpressionBinder"),Pe(gf,"PatternCompositeBinder"),Pe(zu,"CompositeExpressionBinder"),Pe(xp,"ProgramConfiguration",{omit:["_buffers"]}),Pe(_f,"ProgramConfigurationSet");let il=rt/Math.PI/2,dv=5,aw=6,gI=16383,vm=64,fv=[vm,32,16],iu=-il,ru=il;function ym(t,e,r,s=il){return r=Tr(r),[t*Math.sin(r)*s,-e*s,t*Math.cos(r)*s]}function vp(t,e,r){return ym(Math.cos(Tr(t)),Math.sin(Tr(t)),e,r)}let bm=63710088e-1,pv=2*Math.PI*bm;class Xr{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error(`Invalid LngLat object: (${e}, ${r})`);if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Xr(Rl(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){let r=Math.PI/180,s=this.lat*r,u=e.lat*r,d=Math.sin(s)*Math.sin(u)+Math.cos(s)*Math.cos(u)*Math.cos((e.lng-this.lng)*r);return bm*Math.acos(Math.min(d,1))}toBounds(e=0){let r=360*e/40075017,s=r/Math.cos(Math.PI/180*this.lat);return new xf({lng:this.lng-s,lat:this.lat-r},{lng:this.lng+s,lat:this.lat+r})}toEcef(e){return vp(this.lat,this.lng,il+e*il/bm)}static convert(e){if(e instanceof Xr)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Xr(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Xr(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class xf{constructor(e,r){if(e)if(r)this.setSouthWest(e).setNorthEast(r);else if(e.length===4){let s=e;this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]])}else{let s=e;this.setSouthWest(s[0]).setNorthEast(s[1])}}setNorthEast(e){return this._ne=e instanceof Xr?new Xr(e.lng,e.lat):Xr.convert(e),this}setSouthWest(e){return this._sw=e instanceof Xr?new Xr(e.lng,e.lat):Xr.convert(e),this}extend(e){let r=this._sw,s=this._ne,u,d;if(e instanceof Xr)u=e,d=e;else{if(!(e instanceof xf))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(xf.convert(e)):this.extend(Xr.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(Xr.convert(e)):this;if(u=e._sw,d=e._ne,!u||!d)return this}return r||s?(r.lng=Math.min(u.lng,r.lng),r.lat=Math.min(u.lat,r.lat),s.lng=Math.max(d.lng,s.lng),s.lat=Math.max(d.lat,s.lat)):(this._sw=new Xr(u.lng,u.lat),this._ne=new Xr(d.lng,d.lat)),this}getCenter(){return new Xr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Xr(this.getWest(),this.getNorth())}getSouthEast(){return new Xr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){let{lng:r,lat:s}=Xr.convert(e),u=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=s&&s<=this._ne.lat&&u}static convert(e){return!e||e instanceof xf?e:new xf(e)}}var ow={};(function(t,e){(function(r){function s(d,p,_){var v=u(256*d,256*(p=Math.pow(2,_)-p-1),_),w=u(256*(d+1),256*(p+1),_);return v[0]+","+v[1]+","+w[0]+","+w[1]}function u(d,p,_){var v=2*Math.PI*6378137/256/Math.pow(2,_);return[d*v-2*Math.PI*6378137/2,p*v-2*Math.PI*6378137/2]}r.getURL=function(d,p,_,v,w,E){return E=E||{},d+"?"+["bbox="+s(_,v,w),"format="+(E.format||"image/png"),"service="+(E.service||"WMS"),"version="+(E.version||"1.1.1"),"request="+(E.request||"GetMap"),"srs="+(E.srs||"EPSG:3857"),"width="+(E.width||256),"height="+(E.height||256),"layers="+p].join("&")},r.getTileBBox=s,r.getMercCoords=u,Object.defineProperty(r,"__esModule",{value:!0})})(e)})(0,ow);var _I=ow;class yp{constructor(e,r,s){this.z=e,this.x=r,this.y=s,this.key=z0(0,e,e,r,s)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r){let s=_I.getTileBBox(this.x,this.y,this.z),u=function(d,p,_){let v,w="";for(let E=d;E>0;E--)v=1<<E-1,w+=(p&v?1:0)+(_&v?2:0);return w}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(r==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",s)}toString(){return`${this.z}/${this.x}/${this.y}`}}class sw{constructor(e,r){this.wrap=e,this.canonical=r,this.key=z0(e,r.z,r.z,r.x,r.y)}}class fo{constructor(e,r,s,u,d){this.overscaledZ=e,this.wrap=r,this.canonical=new yp(s,+u,+d),this.key=r===0&&e===s?this.canonical.key:z0(r,e,s,u,d)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){let r=this.canonical.z-e;return e>this.canonical.z?new fo(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new fo(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r=!0){if(this.overscaledZ===e&&r)return this.key;if(e>this.canonical.z)return z0(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y);{let s=this.canonical.z-e;return z0(this.wrap*+r,e,e,this.canonical.x>>s,this.canonical.y>>s)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;let r=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.z<this.canonical.z&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new fo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let r=this.canonical.z+1,s=2*this.canonical.x,u=2*this.canonical.y;return[new fo(r,this.wrap,r,s,u),new fo(r,this.wrap,r,s+1,u),new fo(r,this.wrap,r,s,u+1),new fo(r,this.wrap,r,s+1,u+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new fo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new fo(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new sw(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function z0(t,e,r,s,u){let d=1<<Math.min(r,22),p=d*(u%d)+s%d;return t&&r<22&&(p+=d*d*((t<0?-2*t-1:2*t)%(1<<2*(22-r)))),16*(32*p+r)+(e-r)}let xI=[t=>{let e=t.canonical.x-1,r=t.wrap;return e<0&&(e=(1<<t.canonical.z)-1,r--),new fo(t.overscaledZ,r,t.canonical.z,e,t.canonical.y)},t=>{let e=t.canonical.x+1,r=t.wrap;return e===1<<t.canonical.z&&(e=0,r++),new fo(t.overscaledZ,r,t.canonical.z,e,t.canonical.y)},t=>new fo(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,(t.canonical.y===0?1<<t.canonical.z:t.canonical.y)-1),t=>new fo(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y===(1<<t.canonical.z)-1?0:t.canonical.y+1)];Pe(yp,"CanonicalTileID"),Pe(fo,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});let vI=0,yI=25.5;function mv(t){return pv*Math.cos(t*Math.PI/180)}function Mh(t){return(180+t)/360}function Dh(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function rl(t,e){return t/mv(e)}function El(t){return 360*t-180}function Uo(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function lw(t,e){return t*mv(Uo(e))}let ja=85.051129;function cw(t){return Math.cos(Tr(lr(t,-ja,ja)))}function bp(t,e){let r=lr(e,vI,yI),s=Math.pow(2,r);return cw(t)*pv/(512*s)}function uw(t){return 1/Math.cos(t*Math.PI/180)}function f_(t,e=0){let r=Math.exp(Math.PI*(1-(t.y+e/rt)/(1<<t.z)*2));return 80150034*r/(r*r+1)/rt/(1<<t.z)}class vs{constructor(e,r,s=0){this.x=+e,this.y=+r,this.z=+s}static fromLngLat(e,r=0){let s=Xr.convert(e);return new vs(Mh(s.lng),Dh(s.lat),rl(r,s.lat))}toLngLat(){return new Xr(El(this.x),Uo(this.y))}toAltitude(){return lw(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/pv*uw(Uo(this.y))}}function gv(t,e,r,s,u,d,p,_,v){let w=(e+s)/2,E=(r+u)/2,k=new hi(w,E);_(k),function(D,N,B,q,Z,oe){let ve=B-Z,be=q-oe;return Math.abs((q-N)*ve-(B-D)*be)/Math.hypot(ve,be)}(k.x,k.y,d.x,d.y,p.x,p.y)>=v?(gv(t,e,r,w,E,d,k,_,v),gv(t,w,E,s,u,k,p,_,v)):t.push(p)}function hw(t,e,r){let s=t[0],u=s.x,d=s.y;e(s);let p=[s];for(let _=1;_<t.length;_++){let v=t[_],{x:w,y:E}=v;e(v),gv(p,u,d,w,E,s,v,e,r),u=w,d=E,s=v}return p}function _v(t,e,r,s){if(s(e,r)){let u=e.add(r)._mult(.5);_v(t,e,u,s),_v(t,u,r,s)}else t.push(r)}function bI(t,e){let r=t[0],s=[r];for(let u=1;u<t.length;u++){let d=t[u];_v(s,r,d,e),r=d}return s}let xv=Math.pow(2,14)-1,dw=-xv-1;function wI(t,e){let r=Math.round(t.x*e),s=Math.round(t.y*e);return t.x=lr(r,dw,xv),t.y=lr(s,dw,xv),(r<t.x||r>t.x+1||s<t.y||s>t.y+1)&&Nn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function ju(t,e,r){let s=t.loadGeometry(),u=t.extent,d=rt/u;if(e&&r&&r.projection.isReprojectedInTileSpace){let p=1<<e.z,{scale:_,x:v,y:w,projection:E}=r,k=D=>{let N=El((e.x+D.x/u)/p),B=Uo((e.y+D.y/u)/p),q=E.project(N,B);D.x=(q.x*_-v)*u,D.y=(q.y*_-w)*u};for(let D=0;D<s.length;D++)if(t.type!==1)s[D]=hw(s[D],k,1);else{let N=[];for(let B of s[D])B.x<0||B.x>=u||B.y<0||B.y>=u||(k(B),N.push(B));s[D]=N}}for(let p of s)for(let _ of p)wI(_,d);return s}function wd(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?ju(t):[]}}function p_(t,e,r,s,u){t.emplaceBack(2*e+(s+1)/2,2*r+(u+1)/2)}function m_(t,e,r){t.emplaceBack(e.x,e.y,e.z,r[0]*16384,r[1]*16384,r[2]*16384)}class vv{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Bu,this.indexArray=new ko,this.segments=new oa,this.programConfigurations=new _f(e.layers,{zoom:e.zoom,lut:e.lut}),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}updateFootprints(e,r){}populate(e,r,s,u){let d=this.layers[0],p=[],_=null;d.type==="circle"&&(_=d.layout.get("circle-sort-key"));for(let{feature:w,id:E,index:k,sourceLayerIndex:D}of e){let N=this.layers[0]._featureFilter.needGeometry,B=wd(w,N);if(!this.layers[0]._featureFilter.filter(new ir(this.zoom),B,s))continue;let q=_?_.evaluate(B,{},s):void 0,Z={id:E,properties:w.properties,type:w.type,sourceLayerIndex:D,index:k,geometry:N?B.geometry:ju(w,s,u),patterns:{},sortKey:q};p.push(Z)}_&&p.sort((w,E)=>w.sortKey-E.sortKey);let v=null;u.projection.name==="globe"&&(this.globeExtVertexArray=new l_,v=u.projection);for(let w of p){let{geometry:E,index:k,sourceLayerIndex:D}=w,N=e[k].feature;this.addFeature(w,E,k,r.availableImages,s,v,r.brightness),r.featureIndex.insert(N,E,k,D,this.index)}}update(e,r,s,u,d){let p=Object.keys(e).length!==0;p&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,r,p?this.stateDependentLayers:this.layers,s,u,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,aI.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,oI.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,r,s,u,d,p,_){for(let v of r)for(let w of v){let E=w.x,k=w.y;if(E<0||E>=rt||k<0||k>=rt)continue;if(p){let B=p.projectTilePoint(E,k,d),q=p.upVector(d,E,k),Z=this.globeExtVertexArray;m_(Z,B,q),m_(Z,B,q),m_(Z,B,q),m_(Z,B,q)}let D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),N=D.vertexLength;p_(this.layoutVertexArray,E,k,-1,-1),p_(this.layoutVertexArray,E,k,1,-1),p_(this.layoutVertexArray,E,k,1,1),p_(this.layoutVertexArray,E,k,-1,1),this.indexArray.emplaceBack(N,N+1,N+2),this.indexArray.emplaceBack(N,N+2,N+3),D.vertexLength+=4,D.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,{},u,d,_)}}function yv(t,e){for(let r=0;r<t.length;r++)if(vf(e,t[r]))return!0;for(let r=0;r<e.length;r++)if(vf(t,e[r]))return!0;return!!bv(t,e)}function TI(t,e,r){return!!vf(t,e)||!!wv(e,t,r)}function fw(t,e){if(t.length===1)return mw(e,t[0]);for(let r=0;r<e.length;r++){let s=e[r];for(let u=0;u<s.length;u++)if(vf(t,s[u]))return!0}for(let r=0;r<t.length;r++)if(mw(e,t[r]))return!0;for(let r=0;r<e.length;r++)if(bv(t,e[r]))return!0;return!1}function SI(t,e,r){if(t.length>1){if(bv(t,e))return!0;for(let s=0;s<e.length;s++)if(wv(e[s],t,r))return!0}for(let s=0;s<t.length;s++)if(wv(t[s],e,r))return!0;return!1}function bv(t,e){if(t.length===0||e.length===0)return!1;for(let r=0;r<t.length-1;r++){let s=t[r],u=t[r+1];for(let d=0;d<e.length-1;d++)if(EI(s,u,e[d],e[d+1]))return!0}return!1}function EI(t,e,r,s){return ls(t,r,s)!==ls(e,r,s)&&ls(t,e,r)!==ls(t,e,s)}function wv(t,e,r){let s=r*r;if(e.length===1)return t.distSqr(e[0])<s;for(let u=1;u<e.length;u++)if(pw(t,e[u-1],e[u])<s)return!0;return!1}function pw(t,e,r){let s=e.distSqr(r);if(s===0)return t.distSqr(e);let u=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/s;return t.distSqr(u<0?e:u>1?r:r.sub(e)._mult(u)._add(e))}function mw(t,e){let r,s,u,d=!1;for(let p=0;p<t.length;p++){r=t[p];for(let _=0,v=r.length-1;_<r.length;v=_++)s=r[_],u=r[v],s.y>e.y!=u.y>e.y&&e.x<(u.x-s.x)*(e.y-s.y)/(u.y-s.y)+s.x&&(d=!d)}return d}function vf(t,e){let r=!1;for(let s=0,u=t.length-1;s<t.length;u=s++){let d=t[s],p=t[u];d.y>e.y!=p.y>e.y&&e.x<(p.x-d.x)*(e.y-d.y)/(p.y-d.y)+d.x&&(r=!r)}return r}function gw(t,e,r,s,u){for(let p of t)if(e<=p.x&&r<=p.y&&s>=p.x&&u>=p.y)return!0;let d=[new hi(e,r),new hi(e,u),new hi(s,u),new hi(s,r)];if(t.length>2){for(let p of d)if(vf(t,p))return!0}for(let p=0;p<t.length-1;p++)if(AI(t[p],t[p+1],d))return!0;return!1}function AI(t,e,r){let s=r[0],u=r[2];if(t.x<s.x&&e.x<s.x||t.x>u.x&&e.x>u.x||t.y<s.y&&e.y<s.y||t.y>u.y&&e.y>u.y)return!1;let d=ls(t,e,r[0]);return d!==ls(t,e,r[1])||d!==ls(t,e,r[2])||d!==ls(t,e,r[3])}function wm(t,e,r,s,u,d){let p=e.y-t.y,_=t.x-e.x;if(d=d||0){let v=p*p+_*_;if(v===0)return!0;let w=Math.sqrt(v);p/=w,_/=w}return!((r.x-t.x)*p+(r.y-t.y)*_-d<0||(s.x-t.x)*p+(s.y-t.y)*_-d<0||(u.x-t.x)*p+(u.y-t.y)*_-d<0)}function Tv(t,e,r,s,u,d,p){return!(wm(t,e,s,u,d,p)||wm(e,r,s,u,d,p)||wm(r,t,s,u,d,p)||wm(s,u,t,e,r,p)||wm(u,d,t,e,r,p)||wm(d,s,t,e,r,p))}function Tm(t,e,r){let s=e.paint.get(t).value;return s.kind==="constant"?s.value:r.programConfigurations.get(e.id).getMaxValue(t)}function g_(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function _w(t,e,r,s,u){if(!e[0]&&!e[1])return t;let d=hi.convert(e)._mult(u);r==="viewport"&&d._rotate(-s);let p=[];for(let _=0;_<t.length;_++)p.push(t[_].sub(d));return p}function xw(t,e,r,s){let u=hi.convert(t)._mult(s);return e==="viewport"&&u._rotate(-r),u}Pe(vv,"CircleBucket",{omit:["layers"]});let CI=new rn({"circle-sort-key":new _i(xt.layout_circle["circle-sort-key"]),visibility:new Gt(xt.layout_circle.visibility)});var II={paint:new rn({"circle-radius":new _i(xt.paint_circle["circle-radius"]),"circle-color":new _i(xt.paint_circle["circle-color"]),"circle-blur":new _i(xt.paint_circle["circle-blur"]),"circle-opacity":new _i(xt.paint_circle["circle-opacity"]),"circle-translate":new Gt(xt.paint_circle["circle-translate"]),"circle-translate-anchor":new Gt(xt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Gt(xt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Gt(xt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new _i(xt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new _i(xt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new _i(xt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Gt(xt.paint_circle["circle-emissive-strength"])}),layout:CI};class Sv{constructor(e,r){this.pos=e,this.dir=r}intersectsPlane(e,r,s){let u=i._.dot(r,this.dir);if(Math.abs(u)<1e-6)return!1;let d=((e[0]-this.pos[0])*r[0]+(e[1]-this.pos[1])*r[1]+(e[2]-this.pos[2])*r[2])/u;return s[0]=this.pos[0]+this.dir[0]*d,s[1]=this.pos[1]+this.dir[1]*d,s[2]=this.pos[2]+this.dir[2]*d,!0}closestPointOnSphere(e,r,s){if(i._.equals(this.pos,e)||r===0)return s[0]=s[1]=s[2]=0,!1;let[u,d,p]=this.dir,_=this.pos[0]-e[0],v=this.pos[1]-e[1],w=this.pos[2]-e[2],E=u*u+d*d+p*p,k=2*(_*u+v*d+w*p),D=k*k-4*E*(_*_+v*v+w*w-r*r);if(D<0){let N=Math.max(-k/2,0),B=_+u*N,q=v+d*N,Z=w+p*N,oe=Math.hypot(B,q,Z);return s[0]=B*r/oe,s[1]=q*r/oe,s[2]=Z*r/oe,!1}{let N=(-k-Math.sqrt(D))/(2*E);if(N<0){let B=Math.hypot(_,v,w);return s[0]=_*r/B,s[1]=v*r/B,s[2]=w*r/B,!1}return s[0]=_+u*N,s[1]=v+d*N,s[2]=w+p*N,!0}}}class Ev{constructor(e,r,s,u,d){this.TL=e,this.TR=r,this.BR=s,this.BL=u,this.horizon=d}static fromInvProjectionMatrix(e,r,s){let u=[-1,1,1],d=[1,1,1],p=[1,-1,1],_=[-1,-1,1],v=i._.transformMat4(u,u,e),w=i._.transformMat4(d,d,e),E=i._.transformMat4(p,p,e),k=i._.transformMat4(_,_,e);return new Ev(v,w,E,k,r/s)}}function j0(t,e,r){let s=1/0,u=-1/0,d=[];for(let p of t){i._.sub(d,p,e);let _=i._.dot(d,r);s=Math.min(s,_),u=Math.max(u,_)}return[s,u]}function vw(t,e){let r=!0;for(let s=0;s<t.planes.length;s++){let u=t.planes[s],d=0;for(let p=0;p<e.length;p++)d+=i._.dot(u,e[p])+u[3]>=0;if(d===0)return 0;d!==e.length&&(r=!1)}return r?2:1}function yw(t,e){for(let r of t.projections){let s=j0(e,t.points[0],r.axis);if(r.projection[1]<s[0]||r.projection[0]>s[1])return 0}return 1}function bw(t,e){let r=0,s=[0,0,0,0];for(let u=0;u<t.length;u++)s[0]=t[u][0],s[1]=t[u][1],s[2]=t[u][2],s[3]=1,i.aA.dot(s,e)>=0&&r++;return r}class Av{constructor(e,r){this.points=e||new Array(8).fill([0,0,0]),this.planes=r||new Array(6).fill([0,0,0,0]),this.bounds=sa.fromPoints(this.points),this.projections=[],this.frustumEdges=[i._.sub([],this.points[2],this.points[3]),i._.sub([],this.points[0],this.points[3]),i._.sub([],this.points[4],this.points[0]),i._.sub([],this.points[5],this.points[1]),i._.sub([],this.points[6],this.points[2]),i._.sub([],this.points[7],this.points[3])];for(let s of this.frustumEdges){let u=[0,-s[2],s[1]],d=[s[2],0,-s[0]];this.projections.push({axis:u,projection:j0(this.points,this.points[0],u)}),this.projections.push({axis:d,projection:j0(this.points,this.points[0],d)})}}static fromInvProjectionMatrix(e,r,s,u){let d=Math.pow(2,s),p=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(w=>{let E=i.aA.transformMat4([],w,e),k=1/E[3]/r*d;return i.aA.mul(E,E,[k,k,u?1/E[3]:k,k])}),_=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(w=>{let E=i._.sub([],p[w[0]],p[w[1]]),k=i._.sub([],p[w[2]],p[w[1]]),D=i._.normalize([],i._.cross([],E,k)),N=-i._.dot(D,p[w[1]]);return D.concat(N)}),v=[];for(let w=0;w<p.length;w++)v.push([p[w][0],p[w][1],p[w][2]]);return new Av(v,_)}intersectsPrecise(e,r,s){for(let u=0;u<r.length;u++)if(!bw(e,r[u]))return 0;for(let u=0;u<this.planes.length;u++)if(!bw(e,this.planes[u]))return 0;for(let u of s)for(let d of this.frustumEdges){let p=i._.cross([],u,d),_=i._.length(p);if(_===0)continue;i._.scale(p,p,1/_);let v=j0(this.points,this.points[0],p),w=j0(e,this.points[0],p);if(v[0]>w[1]||w[0]>v[1])return 0}return 1}}class sa{static fromPoints(e){let r=[1/0,1/0,1/0],s=[-1/0,-1/0,-1/0];for(let u of e)i._.min(r,r,u),i._.max(s,s,u);return new sa(r,s)}static fromTileIdAndHeight(e,r,s){let u=1<<e.canonical.z,d=e.canonical.x,p=e.canonical.y;return new sa([d/u,p/u,r],[(d+1)/u,(p+1)/u,s])}static applyTransform(e,r){let s=e.getCorners();for(let u=0;u<s.length;++u)i._.transformMat4(s[u],s[u],r);return sa.fromPoints(s)}static projectAabbCorners(e,r){let s=e.getCorners();for(let u=0;u<s.length;++u)i._.transformMat4(s[u],s[u],r);return s}constructor(e,r){this.min=e,this.max=r,this.center=i._.scale([],i._.add([],this.min,this.max),.5)}quadrant(e){let r=[e%2==0,e<2],s=i._.clone(this.min),u=i._.clone(this.max);for(let d=0;d<r.length;d++)s[d]=r[d]?this.min[d]:this.center[d],u[d]=r[d]?this.center[d]:this.max[d];return u[2]=this.max[2],new sa(s,u)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){let e=this.min,r=this.max;return[[e[0],e[1],e[2]],[r[0],e[1],e[2]],[r[0],r[1],e[2]],[e[0],r[1],e[2]],[e[0],e[1],r[2]],[r[0],e[1],r[2]],[r[0],r[1],r[2]],[e[0],r[1],r[2]]]}intersects(e){return this.intersectsAabb(e.bounds)?vw(e,this.getCorners()):0}intersectsFlat(e){return this.intersectsAabb(e.bounds)?vw(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(e,r){return r||this.intersects(e)?yw(e,this.getCorners()):0}intersectsPreciseFlat(e,r){return r||this.intersectsFlat(e)?yw(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(e){for(let r=0;r<3;++r)if(this.min[r]>e.max[r]||e.min[r]>this.max[r])return!1;return!0}intersectsAabbXY(e){return!(this.min[0]>e.max[0]||e.min[0]>this.max[0]||this.min[1]>e.max[1]||e.min[1]>this.max[1])}encapsulate(e){for(let r=0;r<3;r++)this.min[r]=Math.min(this.min[r],e.min[r]),this.max[r]=Math.max(this.max[r],e.max[r])}encapsulatePoint(e){for(let r=0;r<3;r++)this.min[r]=Math.min(this.min[r],e[r]),this.max[r]=Math.max(this.max[r],e[r])}closestPoint(e){return[Math.max(Math.min(this.max[0],e[0]),this.min[0]),Math.max(Math.min(this.max[1],e[1]),this.min[1]),Math.max(Math.min(this.max[2],e[2]),this.min[2])]}}Pe(sa,"Aabb");let kI=nn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:__}=kI,ww=nn([{name:"a_pos_3",components:3,type:"Int16"}]);var V0=nn([{name:"a_pos",type:"Int16",components:2}]);function x_(t){return t*il/bm}let MI=[new sa([iu,iu,iu],[ru,ru,ru]),new sa([iu,iu,iu],[0,0,ru]),new sa([0,iu,iu],[ru,0,ru]),new sa([iu,0,iu],[0,ru,ru]),new sa([0,0,iu],[ru,ru,ru])];function Tw(t,e,r,s=!0){let u=i._.scale([],t._camera.position,t.worldSize),d=[e,r,1,1];i.aA.transformMat4(d,d,t.pixelMatrixInverse),i.aA.scale(d,d,1/d[3]);let p=i._.sub([],d,u),_=i._.normalize([],p),v=t.globeMatrix,w=[v[12],v[13],v[14]],E=i._.sub([],w,u),k=i._.length(E),D=i._.normalize([],E),N=t.worldSize/(2*Math.PI),B=i._.dot(D,_),q=Math.asin(N/k);if(q<Math.acos(B)){if(!s)return null;let At=[],zt=[];i._.scale(At,_,k/B),i._.normalize(zt,i._.sub(zt,At,E)),i._.normalize(_,i._.add(_,E,i._.scale(_,zt,Math.tan(q)*k)))}let Z=[];new Sv(u,_).closestPointOnSphere(w,N,Z);let oe=i._.normalize([],Rt(v,0)),ve=i._.normalize([],Rt(v,1)),be=i._.normalize([],Rt(v,2)),we=i._.dot(oe,Z),$e=i._.dot(ve,Z),Ge=i._.dot(be,Z),it=va(Math.asin(-$e/N)),ot=va(Math.atan2(we,Ge));ot=t.center.lng+function(At,zt){let Jt=(zt-At+180)%360-180;return Jt<-180?Jt+360:Jt}(t.center.lng,ot);let _t=Mh(ot),Mt=lr(Dh(it),0,1);return new vs(_t,Mt)}class DI{constructor(e,r,s){this.a=i._.sub([],e,s),this.b=i._.sub([],r,s),this.center=s;let u=i._.normalize([],this.a),d=i._.normalize([],this.b);this.angle=Math.acos(i._.dot(u,d))}}function Cv(t,e){if(t.angle===0)return null;let r;return r=t.a[e]===0?1/t.angle*.5*Math.PI:1/t.angle*Math.atan(t.b[e]/t.a[e]/Math.sin(t.angle)-1/Math.tan(t.angle)),r<0||r>1?null:function(s,u,d,p){let _=Math.sin(d);return s*(Math.sin((1-p)*d)/_)+u*(Math.sin(p*d)/_)}(t.a[e],t.b[e],t.angle,lr(r,0,1))+t.center[e]}function Fh(t){if(t.z<=1)return MI[t.z+2*t.y+t.x];let e=Iv(v_(t));return sa.fromPoints(e)}function Td(t,e,r){return i._.scale(t,t,1-r),i._.scaleAndAdd(t,t,e,r)}function Sw(t,e){let r=Sd(e.zoom);if(r===0)return Fh(t);let s=v_(t),u=Iv(s),d=Mh(s.getWest())*e.worldSize,p=Mh(s.getEast())*e.worldSize,_=Dh(s.getNorth())*e.worldSize,v=Dh(s.getSouth())*e.worldSize,w=[d,_,0],E=[p,_,0],k=[d,v,0],D=[p,v,0],N=i.ad.invert([],e.globeMatrix);return i._.transformMat4(w,w,N),i._.transformMat4(E,E,N),i._.transformMat4(k,k,N),i._.transformMat4(D,D,N),u[0]=Td(u[0],k,r),u[1]=Td(u[1],D,r),u[2]=Td(u[2],E,r),u[3]=Td(u[3],w,r),sa.fromPoints(u)}function Ew(t,e,r){for(let s of t)i._.transformMat4(s,s,e),i._.scale(s,s,r)}function Aw(t,e,r,s){let u=e/t.worldSize,d=t.globeMatrix;if(r.z<=1){let _t=Fh(r).getCorners();return Ew(_t,d,u),sa.fromPoints(_t)}let p=v_(r,s),_=Iv(p,il+x_(t._tileCoverLift));Ew(_,d,u);let v=Number.MAX_VALUE,w=[-v,-v,-v],E=[v,v,v];if(p.contains(t.center)){for(let At of _)i._.min(E,E,At),i._.max(w,w,At);w[2]=0;let _t=t.point,Mt=[_t.x*u,_t.y*u,0];return i._.min(E,E,Mt),i._.max(w,w,Mt),new sa(E,w)}if(t._tileCoverLift>0){for(let _t of _)i._.min(E,E,_t),i._.max(w,w,_t);return new sa(E,w)}let k=[d[12]*u,d[13]*u,d[14]*u],D=p.getCenter(),N=lr(t.center.lat,-ja,ja),B=lr(D.lat,-ja,ja),q=Mh(t.center.lng),Z=Dh(N),oe=q-Mh(D.lng),ve=Z-Dh(B);oe>.5?oe-=1:oe<-.5&&(oe+=1);let be=0;if(Math.abs(oe)>Math.abs(ve))be=oe>=0?1:3;else{be=ve>=0?0:2;let _t=[d[4]*u,d[5]*u,d[6]*u],Mt=-Math.sin(Tr(ve>=0?p.getSouth():p.getNorth()))*il;i._.scaleAndAdd(k,k,_t,Mt)}let we=_[be],$e=_[(be+1)%4],Ge=new DI(we,$e,k),it=[Cv(Ge,0)||we[0],Cv(Ge,1)||we[1],Cv(Ge,2)||we[2]],ot=Sd(t.zoom);if(ot>0){let _t=function({x:At,y:zt,z:Jt},Ot,Xt,Dt,Zt){let ri=1/(1<<Jt),Kt=At*ri,Si=Kt+ri,ei=zt*ri,li=ei+ri,Xi=0,zi=(Kt+Si)/2-Dt;return zi>.5?Xi=-1:zi<-.5&&(Xi=1),Kt=((Kt+Xi)*Ot-(Dt*=Ot))*Xt+Dt,Si=((Si+Xi)*Ot-Dt)*Xt+Dt,ei=(ei*Ot-(Zt*=Ot))*Xt+Zt,li=(li*Ot-Zt)*Xt+Zt,[[Kt,li,0],[Si,li,0],[Si,ei,0],[Kt,ei,0]]}(r,e,t._pixelsPerMercatorPixel,q,Z);for(let At=0;At<_.length;At++)Td(_[At],_t[At],ot);let Mt=i._.add([],_t[be],_t[(be+1)%4]);i._.scale(Mt,Mt,.5),Td(it,Mt,ot)}for(let _t of _)i._.min(E,E,_t),i._.max(w,w,_t);return E[2]=Math.min(we[2],$e[2]),i._.min(E,E,it),i._.max(w,w,it),new sa(E,w)}function v_({x:t,y:e,z:r},s=!1){let u=1/(1<<r),d=new Xr(El(t*u),e===(1<<r)-1&&s?-90:Uo((e+1)*u)),p=new Xr(El((t+1)*u),e===0&&s?90:Uo(e*u));return new xf(d,p)}function Iv(t,e=il){let r=Tr(t.getNorth()),s=Tr(t.getSouth()),u=Math.cos(r),d=Math.cos(s),p=Math.sin(r),_=Math.sin(s),v=t.getWest(),w=t.getEast();return[ym(d,_,v,e),ym(d,_,w,e),ym(u,p,w,e),ym(u,p,v,e)]}function U0(t,e,r,s){let u=1<<r.z,d=(t/rt+r.x)/u;return vp(Uo((e/rt+r.y)/u),El(d),s)}function y_({min:t,max:e}){return gI/Math.max(e[0]-t[0],e[1]-t[1],e[2]-t[2])}let Cw=new Float64Array(16);function H0(t){let e=y_(t),r=i.ad.fromScaling(Cw,[e,e,e]);return i.ad.translate(r,r,i._.negate([],t.min))}function kv(t){let e=i.ad.fromTranslation(Cw,t.min),r=1/y_(t);return i.ad.scale(e,e,[r,r,r])}function Mv(t){let e=rt/(2*Math.PI);return t/(2*Math.PI)/e}function Iw(t,e){return rt/(512*Math.pow(2,t))*y_(Fh(e))}function kw(t,e,r,s,u){let d=Mv(r),p=[t,e,-r/(2*Math.PI)],_=i.ad.identity(new Float64Array(16));return i.ad.translate(_,_,p),i.ad.scale(_,_,[d,d,d]),i.ad.rotateX(_,_,Tr(-u)),i.ad.rotateY(_,_,Tr(-s)),_}function Sd(t){return Ll(dv,aw,t)}function Mw(t,e){let r=vp(e.lat,e.lng),s=function(d){let p=vp(d._center.lat,d._center.lng),_=i._.fromValues(0,1,0),v=i._.cross([],_,p),w=i.ad.fromRotation([],-d.angle,p);v=i._.transformMat4(v,v,w),i.ad.fromRotation(w,-d._pitch,v);let E=i._.normalize([],p);return i._.scale(E,E,x_(d.cameraToCenterDistance/d.pixelsPerMeter)),i._.transformMat4(E,E,w),i._.add([],p,E)}(t),u=i._.subtract([],s,r);return i._.angle(u,r)}function Dv(t,e){return Mw(t,e)>Math.PI/2*1.01}let Dw=Tr(85),FI=Math.cos(Dw),PI=Math.sin(Dw),LI=i.ad.create(),Fw=t=>{let e=[];return t.paint.get("circle-pitch-alignment")==="map"&&e.push("PITCH_WITH_MAP"),t.paint.get("circle-pitch-scale")==="map"&&e.push("SCALE_WITH_MAP"),e};function Pw(t,e,r,s,u,d,p,_,v){if(d&&t.queryGeometry.isAboveHorizon)return!1;d&&(v*=t.pixelToTileUnitsFactor);let w=t.tileID.canonical,E=r.projection.upVectorScale(w,r.center.lat,r.worldSize).metersToTile;for(let k of e)for(let D of k){let N=D.add(_),B=u&&r.elevation?r.elevation.exaggeration()*u.getElevationAt(N.x,N.y,!0):0,q=r.projection.projectTilePoint(N.x,N.y,w);if(B>0){let be=r.projection.upVector(w,N.x,N.y);q.x+=be[0]*E*B,q.y+=be[1]*E*B,q.z+=be[2]*E*B}let Z=d?N:RI(q.x,q.y,q.z,s),oe=d?t.tilespaceRays.map(be=>NI(be,B)):t.queryGeometry.screenGeometry,ve=i.aA.transformMat4([],[q.x,q.y,q.z,1],s);if(!p&&d?v*=ve[3]/r.cameraToCenterDistance:p&&!d&&(v*=r.cameraToCenterDistance/ve[3]),d){let be=Uo((D.y/rt+w.y)/(1<<w.z));v/=r.projection.pixelsPerMeter(be,1)/rl(1,be)}if(TI(oe,Z,v))return!0}return!1}function RI(t,e,r,s){let u=i.aA.transformMat4([],[t,e,r,1],s);return new hi(u[0]/u[3],u[1]/u[3])}let Lw=i._.fromValues(0,0,0),OI=i._.fromValues(0,0,1);function NI(t,e){let r=i._.create();return Lw[2]=e,t.intersectsPlane(Lw,OI,r),new hi(r[0],r[1])}class Rw extends vv{}function Ow(t,{width:e,height:r},s,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==e*r*s)throw new RangeError("mismatched image size")}else u=new Uint8Array(e*r*s);return t.width=e,t.height=r,t.data=u,t}function Nw(t,e,r){let{width:s,height:u}=e;s===t.width&&u===t.height||(Fv(t,e,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,s),height:Math.min(t.height,u)},r,null),t.width=s,t.height=u,t.data=e.data)}function Fv(t,e,r,s,u,d,p,_){if(u.width===0||u.height===0)return e;if(u.width>t.width||u.height>t.height||r.x>t.width-u.width||r.y>t.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>e.width||u.height>e.height||s.x>e.width-u.width||s.y>e.height-u.height)throw new RangeError("out of range destination coordinates for image copy");let v=t.data,w=e.data,E=d===4&&_;for(let k=0;k<u.height;k++){let D=((r.y+k)*t.width+r.x)*d,N=((s.y+k)*e.width+s.x)*d;if(E)for(let B=0;B<u.width;B++){let q=D+B*d+3,Z=N+B*d;w[Z+0]=255,w[Z+1]=255,w[Z+2]=255,w[Z+3]=v[q]}else if(p)for(let B=0;B<u.width;B++){let q=D+B*d,Z=N+B*d,oe=v[q+3],ve=new jr(v[q+0]/255*oe,v[q+1]/255*oe,v[q+2]/255*oe,oe).toRenderColor(p).toArray();w[Z+0]=ve[0],w[Z+1]=ve[1],w[Z+2]=ve[2],w[Z+3]=ve[3]}else for(let B=0;B<u.width*d;B++)w[N+B]=v[D+B]}return e}Pe(Rw,"HeatmapBucket",{omit:["layers"]});class yf{constructor(e,r){Ow(this,e,1,r)}resize(e){Nw(this,new yf(e),1)}clone(){return new yf({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,s,u,d){Fv(e,r,s,u,d,1,null)}}class Cc{constructor(e,r){Ow(this,e,4,r)}resize(e){Nw(this,new Cc(e),4)}replace(e,r){r?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Cc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,s,u,d,p,_){Fv(e,r,s,u,d,4,p,_)}}class Bw{constructor(e,r){this.width=e.width,this.height=e.height,this.data=r instanceof Uint8Array?new Float32Array(r.buffer):r}}Pe(yf,"AlphaImage"),Pe(Cc,"RGBAImage");let BI=new rn({visibility:new Gt(xt.layout_heatmap.visibility)});var zI={paint:new rn({"heatmap-radius":new _i(xt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new _i(xt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Gt(xt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new aa(xt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Gt(xt.paint_heatmap["heatmap-opacity"])}),layout:BI};function G0(t){let e={},r=t.resolution||256,s=t.clips?t.clips.length:1,u=t.image||new Cc({width:r,height:s}),d=(p,_,v)=>{e[t.evaluationKey]=v;let w=t.expression.evaluate(e);w&&(u.data[p+_+0]=Math.floor(255*w.r/w.a),u.data[p+_+1]=Math.floor(255*w.g/w.a),u.data[p+_+2]=Math.floor(255*w.b/w.a),u.data[p+_+3]=Math.floor(255*w.a))};if(t.clips)for(let p=0,_=0;p<s;++p,_+=4*r)for(let v=0,w=0;v<r;v++,w+=4){let E=v/(r-1),{start:k,end:D}=t.clips[p];d(_,w,k*(1-E)+D*E)}else for(let p=0,_=0;p<r;p++,_+=4)d(0,_,p/(r-1));return u}let jI=new rn({visibility:new Gt(xt.layout_hillshade.visibility)});var VI={paint:new rn({"hillshade-illumination-direction":new Gt(xt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Gt(xt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Gt(xt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Gt(xt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Gt(xt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Gt(xt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Gt(xt.paint_hillshade["hillshade-emissive-strength"])}),layout:jI};let UI=nn([{name:"a_pos",components:2,type:"Int16"}],4),{members:HI}=UI;function W0(t,e,r=2){let s=e&&e.length,u=s?e[0]*r:t.length,d=zw(t,0,u,r,!0),p=[];if(!d||d.next===d.prev)return p;let _,v,w;if(s&&(d=function(E,k,D,N){let B=[];for(let q=0,Z=k.length;q<Z;q++){let oe=zw(E,k[q]*N,q<Z-1?k[q+1]*N:E.length,N,!1);oe===oe.next&&(oe.steiner=!0),B.push(KI(oe))}B.sort(XI);for(let q=0;q<B.length;q++)D=ZI(B[q],D);return D}(t,e,d,r)),t.length>80*r){_=1/0,v=1/0;let E=-1/0,k=-1/0;for(let D=r;D<u;D+=r){let N=t[D],B=t[D+1];N<_&&(_=N),B<v&&(v=B),N>E&&(E=N),B>k&&(k=B)}w=Math.max(E-_,k-v),w=w!==0?32767/w:0}return q0(d,p,r,_,v,w,0),p}function zw(t,e,r,s,u){let d;if(u===function(p,_,v,w){let E=0;for(let k=_,D=v-w;k<v;k+=w)E+=(p[D]-p[k])*(p[k+1]+p[D+1]),D=k;return E}(t,e,r,s)>0)for(let p=e;p<r;p+=s)d=Uw(p/s|0,t[p],t[p+1],d);else for(let p=r-s;p>=e;p-=s)d=Uw(p/s|0,t[p],t[p+1],d);return d&&b_(d,d.next)&&(X0(d),d=d.next),d}function wp(t,e){if(!t)return t;e||(e=t);let r,s=t;do if(r=!1,s.steiner||!b_(s,s.next)&&po(s.prev,s,s.next)!==0)s=s.next;else{if(X0(s),s=e=s.prev,s===s.next)break;r=!0}while(r||s!==e);return e}function q0(t,e,r,s,u,d,p){if(!t)return;!p&&d&&function(v,w,E,k){let D=v;do D.z===0&&(D.z=Pv(D.x,D.y,w,E,k)),D.prevZ=D.prev,D.nextZ=D.next,D=D.next;while(D!==v);D.prevZ.nextZ=null,D.prevZ=null,function(N){let B,q=1;do{let Z,oe=N;N=null;let ve=null;for(B=0;oe;){B++;let be=oe,we=0;for(let Ge=0;Ge<q&&(we++,be=be.nextZ,be);Ge++);let $e=q;for(;we>0||$e>0&&be;)we!==0&&($e===0||!be||oe.z<=be.z)?(Z=oe,oe=oe.nextZ,we--):(Z=be,be=be.nextZ,$e--),ve?ve.nextZ=Z:N=Z,Z.prevZ=ve,ve=Z;oe=be}ve.nextZ=null,q*=2}while(B>1)}(D)}(t,s,u,d);let _=t;for(;t.prev!==t.next;){let v=t.prev,w=t.next;if(d?WI(t,s,u,d):GI(t))e.push(v.i,t.i,w.i),X0(t),t=w.next,_=w.next;else if((t=w)===_){p?p===1?q0(t=qI(wp(t),e),e,r,s,u,d,2):p===2&&$I(t,e,r,s,u,d):q0(wp(t),e,r,s,u,d,1);break}}}function GI(t){let e=t.prev,r=t,s=t.next;if(po(e,r,s)>=0)return!1;let u=e.x,d=r.x,p=s.x,_=e.y,v=r.y,w=s.y,E=u<d?u<p?u:p:d<p?d:p,k=_<v?_<w?_:w:v<w?v:w,D=u>d?u>p?u:p:d>p?d:p,N=_>v?_>w?_:w:v>w?v:w,B=s.next;for(;B!==e;){if(B.x>=E&&B.x<=D&&B.y>=k&&B.y<=N&&Sm(u,_,d,v,p,w,B.x,B.y)&&po(B.prev,B,B.next)>=0)return!1;B=B.next}return!0}function WI(t,e,r,s){let u=t.prev,d=t,p=t.next;if(po(u,d,p)>=0)return!1;let _=u.x,v=d.x,w=p.x,E=u.y,k=d.y,D=p.y,N=_<v?_<w?_:w:v<w?v:w,B=E<k?E<D?E:D:k<D?k:D,q=_>v?_>w?_:w:v>w?v:w,Z=E>k?E>D?E:D:k>D?k:D,oe=Pv(N,B,e,r,s),ve=Pv(q,Z,e,r,s),be=t.prevZ,we=t.nextZ;for(;be&&be.z>=oe&&we&&we.z<=ve;){if(be.x>=N&&be.x<=q&&be.y>=B&&be.y<=Z&&be!==u&&be!==p&&Sm(_,E,v,k,w,D,be.x,be.y)&&po(be.prev,be,be.next)>=0||(be=be.prevZ,we.x>=N&&we.x<=q&&we.y>=B&&we.y<=Z&&we!==u&&we!==p&&Sm(_,E,v,k,w,D,we.x,we.y)&&po(we.prev,we,we.next)>=0))return!1;we=we.nextZ}for(;be&&be.z>=oe;){if(be.x>=N&&be.x<=q&&be.y>=B&&be.y<=Z&&be!==u&&be!==p&&Sm(_,E,v,k,w,D,be.x,be.y)&&po(be.prev,be,be.next)>=0)return!1;be=be.prevZ}for(;we&&we.z<=ve;){if(we.x>=N&&we.x<=q&&we.y>=B&&we.y<=Z&&we!==u&&we!==p&&Sm(_,E,v,k,w,D,we.x,we.y)&&po(we.prev,we,we.next)>=0)return!1;we=we.nextZ}return!0}function qI(t,e){let r=t;do{let s=r.prev,u=r.next.next;!b_(s,u)&&jw(s,r,r.next,u)&&$0(s,u)&&$0(u,s)&&(e.push(s.i,r.i,u.i),X0(r),X0(r.next),r=t=u),r=r.next}while(r!==t);return wp(r)}function $I(t,e,r,s,u,d){let p=t;do{let _=p.next.next;for(;_!==p.prev;){if(p.i!==_.i&&JI(p,_)){let v=Vw(p,_);return p=wp(p,p.next),v=wp(v,v.next),q0(p,e,r,s,u,d,0),void q0(v,e,r,s,u,d,0)}_=_.next}p=p.next}while(p!==t)}function XI(t,e){return t.x-e.x}function ZI(t,e){let r=function(u,d){let p=d,_=u.x,v=u.y,w,E=-1/0;do{if(v<=p.y&&v>=p.next.y&&p.next.y!==p.y){let q=p.x+(v-p.y)*(p.next.x-p.x)/(p.next.y-p.y);if(q<=_&&q>E&&(E=q,w=p.x<p.next.x?p:p.next,q===_))return w}p=p.next}while(p!==d);if(!w)return null;let k=w,D=w.x,N=w.y,B=1/0;p=w;do{if(_>=p.x&&p.x>=D&&_!==p.x&&Sm(v<N?_:E,v,D,N,v<N?E:_,v,p.x,p.y)){let q=Math.abs(v-p.y)/(_-p.x);$0(p,u)&&(q<B||q===B&&(p.x>w.x||p.x===w.x&&YI(w,p)))&&(w=p,B=q)}p=p.next}while(p!==k);return w}(t,e);if(!r)return e;let s=Vw(r,t);return wp(s,s.next),wp(r,r.next)}function YI(t,e){return po(t.prev,t,e.prev)<0&&po(e.next,t,t.next)<0}function Pv(t,e,r,s,u){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*u|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-s)*u|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function KI(t){let e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function Sm(t,e,r,s,u,d,p,_){return(u-p)*(e-_)>=(t-p)*(d-_)&&(t-p)*(s-_)>=(r-p)*(e-_)&&(r-p)*(d-_)>=(u-p)*(s-_)}function JI(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(r,s){let u=r;do{if(u.i!==r.i&&u.next.i!==r.i&&u.i!==s.i&&u.next.i!==s.i&&jw(u,u.next,r,s))return!0;u=u.next}while(u!==r);return!1}(t,e)&&($0(t,e)&&$0(e,t)&&function(r,s){let u=r,d=!1,p=(r.x+s.x)/2,_=(r.y+s.y)/2;do u.y>_!=u.next.y>_&&u.next.y!==u.y&&p<(u.next.x-u.x)*(_-u.y)/(u.next.y-u.y)+u.x&&(d=!d),u=u.next;while(u!==r);return d}(t,e)&&(po(t.prev,t,e.prev)||po(t,e.prev,e))||b_(t,e)&&po(t.prev,t,t.next)>0&&po(e.prev,e,e.next)>0)}function po(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function b_(t,e){return t.x===e.x&&t.y===e.y}function jw(t,e,r,s){let u=T_(po(t,e,r)),d=T_(po(t,e,s)),p=T_(po(r,s,t)),_=T_(po(r,s,e));return u!==d&&p!==_||!(u!==0||!w_(t,r,e))||!(d!==0||!w_(t,s,e))||!(p!==0||!w_(r,t,s))||!(_!==0||!w_(r,e,s))}function w_(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function T_(t){return t>0?1:t<0?-1:0}function $0(t,e){return po(t.prev,t,t.next)<0?po(t,e,t.next)>=0&&po(t,t.prev,e)>=0:po(t,e,t.prev)<0||po(t,t.next,e)<0}function Vw(t,e){let r=Lv(t.i,t.x,t.y),s=Lv(e.i,e.x,e.y),u=t.next,d=e.prev;return t.next=e,e.prev=t,r.next=u,u.prev=r,s.next=r,r.prev=s,d.next=s,s.prev=d,s}function Uw(t,e,r,s){let u=Lv(t,e,r);return s?(u.next=s.next,u.prev=s,s.next.prev=u,s.next=u):(u.prev=u,u.next=u),u}function X0(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Lv(t,e,r){return{i:t,x:e,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function S_(t,e){let r=t.length;if(r<=1)return[t];let s=[],u,d;for(let p=0;p<r;p++){let _=to(t[p]);_!==0&&(t[p].area=Math.abs(_),d===void 0&&(d=_<0),d===_<0?(u&&s.push(u),u=[t[p]]):u.push(t[p]))}if(u&&s.push(u),e>1)for(let p=0;p<s.length;p++)s[p].length<=e||(k0(s[p],e,1,s[p].length-1,QI),s[p]=s[p].slice(0,e));return s}function QI(t,e){return e.area-t.area}function Rv(t,e,r){let s=r.patternDependencies,u=!1;for(let d of e){let p=d.paint.get(`${t}-pattern`);p.isConstant()||(u=!0);let _=p.constantOr(null);_&&(u=!0,s[_]=!0)}return u}function Ov(t,e,r,s,u){let d=u.patternDependencies;for(let p of e){let _=p.paint.get(`${t}-pattern`).value;if(_.kind!=="constant"){let v=_.evaluate({zoom:s},r,{},u.availableImages);v=v&&v.name?v.name:v,d[v]=!0,r.patterns[p.id]=v}}return r}class E_{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Bu,this.indexArray=new ko,this.indexArray2=new mf,this.programConfigurations=new _f(e.layers,{zoom:e.zoom,lut:e.lut}),this.segments=new oa,this.segments2=new oa,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.projection=e.projection}updateFootprints(e,r){}populate(e,r,s,u){this.hasPattern=Rv("fill",this.layers,r);let d=this.layers[0].layout.get("fill-sort-key"),p=[];for(let{feature:_,id:v,index:w,sourceLayerIndex:E}of e){let k=this.layers[0]._featureFilter.needGeometry,D=wd(_,k);if(!this.layers[0]._featureFilter.filter(new ir(this.zoom),D,s))continue;let N=d?d.evaluate(D,{},s,r.availableImages):void 0,B={id:v,properties:_.properties,type:_.type,sourceLayerIndex:E,index:w,geometry:k?D.geometry:ju(_,s,u),patterns:{},sortKey:N};p.push(B)}d&&p.sort((_,v)=>_.sortKey-v.sortKey);for(let _ of p){let{geometry:v,index:w,sourceLayerIndex:E}=_;if(this.hasPattern){let k=Ov("fill",this.layers,_,this.zoom,r);this.patternFeatures.push(k)}else this.addFeature(_,v,w,s,{},r.availableImages,r.brightness);r.featureIndex.insert(e[w].feature,v,w,E,this.index)}}update(e,r,s,u,d){let p=Object.keys(e).length!==0;p&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,r,p?this.stateDependentLayers:this.layers,s,u,d)}addFeatures(e,r,s,u,d,p){for(let _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,r,s,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,HI),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,r,s,u,d,p=[],_){for(let v of S_(r,500)){let w=0;for(let q of v)w+=q.length;let E=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray),k=E.vertexLength,D=[],N=[];for(let q of v){if(q.length===0)continue;q!==v[0]&&N.push(D.length/2);let Z=this.segments2.prepareSegment(q.length,this.layoutVertexArray,this.indexArray2),oe=Z.vertexLength;this.layoutVertexArray.emplaceBack(q[0].x,q[0].y),this.indexArray2.emplaceBack(oe+q.length-1,oe),D.push(q[0].x),D.push(q[0].y);for(let ve=1;ve<q.length;ve++)this.layoutVertexArray.emplaceBack(q[ve].x,q[ve].y),this.indexArray2.emplaceBack(oe+ve-1,oe+ve),D.push(q[ve].x),D.push(q[ve].y);Z.vertexLength+=q.length,Z.primitiveLength+=q.length}let B=W0(D,N);for(let q=0;q<B.length;q+=3)this.indexArray.emplaceBack(k+B[q],k+B[q+1],k+B[q+2]);E.vertexLength+=w,E.primitiveLength+=B.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,d,p,u,_)}}Pe(E_,"FillBucket",{omit:["layers","patternFeatures"]});let ek=new rn({"fill-sort-key":new _i(xt.layout_fill["fill-sort-key"]),visibility:new Gt(xt.layout_fill.visibility)});var tk={paint:new rn({"fill-antialias":new Gt(xt.paint_fill["fill-antialias"]),"fill-opacity":new _i(xt.paint_fill["fill-opacity"]),"fill-color":new _i(xt.paint_fill["fill-color"]),"fill-outline-color":new _i(xt.paint_fill["fill-outline-color"]),"fill-translate":new Gt(xt.paint_fill["fill-translate"]),"fill-translate-anchor":new Gt(xt.paint_fill["fill-translate-anchor"]),"fill-pattern":new _i(xt.paint_fill["fill-pattern"]),"fill-emissive-strength":new Gt(xt.paint_fill["fill-emissive-strength"])}),layout:ek};class Nv{constructor(e,r,s,u){if(this.triangleCount=r.length/3,this.min=new hi(0,0),this.max=new hi(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||e.length===0)return;let[d,p]=[e[0].clone(),e[0].clone()];for(let k=1;k<e.length;++k){let D=e[k];d.x=Math.min(d.x,D.x),d.y=Math.min(d.y,D.y),p.x=Math.max(p.x,D.x),p.y=Math.max(p.y,D.y)}if(u){let k=Math.ceil(Math.max(p.x-d.x,p.y-d.y)/u);s=Math.max(s,k)}if(s===0)return;this.min=d,this.max=p;let _=this.max.sub(this.min);_.x=Math.max(_.x,1),_.y=Math.max(_.y,1);let v=Math.max(_.x,_.y)/s;this.cellsX=Math.max(1,Math.ceil(_.x/v)),this.cellsY=Math.max(1,Math.ceil(_.y/v)),this.xScale=1/v,this.yScale=1/v;let w=[];for(let k=0;k<this.triangleCount;k++){let D=e[r[3*k+0]].sub(this.min),N=e[r[3*k+1]].sub(this.min),B=e[r[3*k+2]].sub(this.min),q=Ph(Math.floor(Math.min(D.x,N.x,B.x)),this.xScale,this.cellsX),Z=Ph(Math.floor(Math.max(D.x,N.x,B.x)),this.xScale,this.cellsX),oe=Ph(Math.floor(Math.min(D.y,N.y,B.y)),this.yScale,this.cellsY),ve=Ph(Math.floor(Math.max(D.y,N.y,B.y)),this.yScale,this.cellsY),be=new hi(0,0),we=new hi(0,0),$e=new hi(0,0),Ge=new hi(0,0);for(let it=oe;it<=ve;++it){be.y=we.y=it*v,$e.y=Ge.y=(it+1)*v;for(let ot=q;ot<=Z;++ot)be.x=$e.x=ot*v,we.x=Ge.x=(ot+1)*v,(Tv(D,N,B,be,we,Ge)||Tv(D,N,B,be,Ge,$e))&&w.push({cellIdx:it*this.cellsX+ot,triIdx:k})}}if(w.length===0)return;w.sort((k,D)=>k.cellIdx-D.cellIdx||k.triIdx-D.triIdx);let E=0;for(;E<w.length;){let k=w[E].cellIdx,D={start:this.payload.length,len:0};for(;E<w.length&&w[E].cellIdx===k;)++D.len,this.payload.push(w[E++].triIdx);this.cells[k]=D}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(e,r){if(this.triangleCount===0||this.cells.length===0||e.x>this.max.x||this.min.x>e.x||e.y>this.max.y||this.min.y>e.y)return;let s=Ph(e.x-this.min.x,this.xScale,this.cellsX),u=Ph(e.y-this.min.y,this.yScale,this.cellsY),d=this.cells[u*this.cellsX+s];if(d){this._lazyInitLookup();for(let p=0;p<d.len;p++){let _=this.payload[d.start+p],v=Math.floor(_/8),w=1<<_%8;if(!(this.lookup[v]&w)&&(this.lookup[v]|=w,r.push(_),r.length===this.triangleCount))return}}}query(e,r,s){if(this.triangleCount===0||this.cells.length===0||e.x>this.max.x||this.min.x>r.x||e.y>this.max.y||this.min.y>r.y)return;this._lazyInitLookup();let u=Ph(e.x-this.min.x,this.xScale,this.cellsX),d=Ph(r.x-this.min.x,this.xScale,this.cellsX),p=Ph(e.y-this.min.y,this.yScale,this.cellsY),_=Ph(r.y-this.min.y,this.yScale,this.cellsY);for(let v=p;v<=_;v++)for(let w=u;w<=d;w++){let E=this.cells[v*this.cellsX+w];if(E)for(let k=0;k<E.len;k++){let D=this.payload[E.start+k],N=Math.floor(D/8),B=1<<D%8;if(!(this.lookup[N]&B)&&(this.lookup[N]|=B,s.push(D),s.length===this.triangleCount))return}}}}function Ph(t,e,r){return Math.max(0,Math.min(r-1,Math.floor(t*e)))}Pe(Nv,"TriangleGridIndex");class Hw{constructor(e){this.zoom=e.zoom,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=e.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.footprints=[]}updateFootprints(e,r){for(let s of this.footprints)r.push({footprint:s,id:e})}populate(e,r,s,u){let d=[];for(let{feature:p,id:_,index:v,sourceLayerIndex:w}of e){let E=this.layers[0]._featureFilter.needGeometry,k=wd(p,E);if(!this.layers[0]._featureFilter.filter(new ir(this.zoom),k,s))continue;let D={id:_,properties:p.properties,type:p.type,sourceLayerIndex:w,index:v,geometry:E?k.geometry:ju(p,s,u),patterns:{}};d.push(D)}for(let p of d){let{geometry:_,index:v,sourceLayerIndex:w}=p;this.addFeature(p,_,v,s,{},r.availableImages,r.brightness),r.featureIndex.insert(e[v].feature,_,v,w,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(e){}update(e,r,s,u,d){}destroy(){}addFeature(e,r,s,u,d,p=[],_){for(let v of S_(r,2)){let w=[],E=[],k=[],D=new hi(1/0,1/0),N=new hi(-1/0,-1/0);for(let Z of v)if(Z.length!==0){Z!==v[0]&&k.push(E.length/2);for(let oe=0;oe<Z.length;oe++)E.push(Z[oe].x),E.push(Z[oe].y),w.push(Z[oe]),D.x=Math.min(D.x,Z[oe].x),D.y=Math.min(D.y,Z[oe].y),N.x=Math.max(N.x,Z[oe].x),N.y=Math.max(N.y,Z[oe].y)}let B=W0(E,k),q=new Nv(w,B,8,256);this.footprints.push({vertices:w,indices:B,grid:q,min:D,max:N})}}}Pe(Hw,"ClipBucket",{omit:["layers"]});let ik=new rn({"clip-layer-types":new Gt(xt.layout_clip["clip-layer-types"])});var rk={paint:new rn({}),layout:ik};let nk=nn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),ak=nn([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),ok=nn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),sk=nn([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),lk=nn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:ck}=nk;var A_={},uk=Bc,Gw=Em;function Em(t,e,r,s,u){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=s,this._values=u,t.readFields(hk,this,e)}function hk(t,e,r){t==1?e.id=r.readVarint():t==2?function(s,u){for(var d=s.readVarint()+s.pos;s.pos<d;){var p=u._keys[s.readVarint()],_=u._values[s.readVarint()];u.properties[p]=_}}(r,e):t==3?e.type=r.readVarint():t==4&&(e._geometry=r.pos)}function dk(t){for(var e,r,s=0,u=0,d=t.length,p=d-1;u<d;p=u++)s+=((r=t[p]).x-(e=t[u]).x)*(e.y+r.y);return s}Em.types=["Unknown","Point","LineString","Polygon"],Em.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,r=t.readVarint()+t.pos,s=1,u=0,d=0,p=0,_=[];t.pos<r;){if(u<=0){var v=t.readVarint();s=7&v,u=v>>3}if(u--,s===1||s===2)d+=t.readSVarint(),p+=t.readSVarint(),s===1&&(e&&_.push(e),e=[]),e.push(new uk(d,p));else{if(s!==7)throw new Error("unknown command "+s);e&&e.push(e[0].clone())}}return e&&_.push(e),_},Em.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,s=0,u=0,d=0,p=1/0,_=-1/0,v=1/0,w=-1/0;t.pos<e;){if(s<=0){var E=t.readVarint();r=7&E,s=E>>3}if(s--,r===1||r===2)(u+=t.readSVarint())<p&&(p=u),u>_&&(_=u),(d+=t.readSVarint())<v&&(v=d),d>w&&(w=d);else if(r!==7)throw new Error("unknown command "+r)}return[p,v,_,w]},Em.prototype.toGeoJSON=function(t,e,r){var s,u,d=this.extent*Math.pow(2,r),p=this.extent*t,_=this.extent*e,v=this.loadGeometry(),w=Em.types[this.type];function E(N){for(var B=0;B<N.length;B++){var q=N[B];N[B]=[360*(q.x+p)/d-180,360/Math.PI*Math.atan(Math.exp((180-360*(q.y+_)/d)*Math.PI/180))-90]}}switch(this.type){case 1:var k=[];for(s=0;s<v.length;s++)k[s]=v[s][0];E(v=k);break;case 2:for(s=0;s<v.length;s++)E(v[s]);break;case 3:for(v=function(N){var B=N.length;if(B<=1)return[N];for(var q,Z,oe=[],ve=0;ve<B;ve++){var be=dk(N[ve]);be!==0&&(Z===void 0&&(Z=be<0),Z===be<0?(q&&oe.push(q),q=[N[ve]]):q.push(N[ve]))}return q&&oe.push(q),oe}(v),s=0;s<v.length;s++)for(u=0;u<v[s].length;u++)E(v[s][u])}v.length===1?v=v[0]:w="Multi"+w;var D={type:"Feature",geometry:{type:w,coordinates:v},properties:this.properties};return"id"in this&&(D.id=this.id),D};var fk=Gw,Ww=qw;function qw(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(pk,this,e),this.length=this._features.length}function pk(t,e,r){t===15?e.version=r.readVarint():t===1?e.name=r.readString():t===5?e.extent=r.readVarint():t===2?e._features.push(r.pos):t===3?e._keys.push(r.readString()):t===4&&e._values.push(function(s){for(var u=null,d=s.readVarint()+s.pos;s.pos<d;){var p=s.readVarint()>>3;u=p===1?s.readString():p===2?s.readFloat():p===3?s.readDouble():p===4?s.readVarint64():p===5?s.readVarint():p===6?s.readSVarint():p===7?s.readBoolean():null}return u}(r))}qw.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new fk(this._pbf,e,this.extent,this._keys,this._values)};var mk=Ww;function gk(t,e,r){if(t===3){var s=new mk(r,r.readVarint()+r.pos);s.length&&(e[s.name]=s)}}var Bv=A_.VectorTile=function(t,e){this.layers=t.readFields(gk,{},e)},C_=A_.VectorTileFeature=Gw;A_.VectorTileLayer=Ww;class Tp extends hi{constructor(e,r,s){super(e,r),this.z=s}}class $w extends Tp{constructor(e,r,s,u){super(e,r,s),this.w=u}}function I_(t,e,r,s){let u=[],d=s===0?(p,_,v,w,E,k)=>{p.push(new hi(k,v+(k-_)/(w-_)*(E-v)))}:(p,_,v,w,E,k)=>{p.push(new hi(_+(k-v)/(E-v)*(w-_),k))};for(let p of t){let _=[];for(let v of p){if(v.length<=2)continue;let w=[];for(let D=0;D<v.length-1;D++){let N=v[D].x,B=v[D].y,q=v[D+1].x,Z=v[D+1].y,oe=s===0?N:B,ve=s===0?q:Z;oe<e?ve>e&&d(w,N,B,q,Z,e):oe>r?ve<r&&d(w,N,B,q,Z,r):w.push(v[D]),ve<e&&oe>=e&&d(w,N,B,q,Z,e),ve>r&&oe<=r&&d(w,N,B,q,Z,r)}let E=v[v.length-1],k=s===0?E.x:E.y;k>=e&&k<=r&&w.push(E),w.length&&(E=w[w.length-1],w[0].x===E.x&&w[0].y===E.y||w.push(w[0]),_.push(w))}_.length&&u.push(_)}return u}function Xw(t,e,r,s){let u=r==="x"?"y":"x",d=(s-t[r])/(e[r]-t[r]);t[u]=t[u]+(e[u]-t[u])*d,t[r]=s,t.hasOwnProperty("z")&&(t.z=$i(t.z,e.z,d)),t.hasOwnProperty("w")&&(t.w=$i(t.w,e.w,d))}function Zw(t,e,r,s){let u=r,d=s;for(let p of["x","y"]){let _=t,v=e;_[p]>=v[p]&&(_=e,v=t),_[p]<u&&v[p]>u&&Xw(_,v,p,u),_[p]<d&&v[p]>d&&Xw(v,_,p,d)}}function k_(t,e){return t.x-e.x||t.y-e.y}function Yw(t,e){return k_(t.min,e.min)===0&&k_(t.max,e.max)===0}function zv(t,e){return!(t.min.x>e.max.x||t.max.x<e.min.x||t.min.y>e.max.y||t.max.y<e.min.y)}function jv(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r].sourceId!==e[r].sourceId||!Yw(t[r],e[r])||t[r].order!==e[r].order||t[r].clipMask!==e[r].clipMask)return!1;return!0}function Kw(t,e,r){let s=1/rt,u=1/(1<<r.canonical.z),d=(e.x*s+r.canonical.x)*u+r.wrap,p=(e.y*s+r.canonical.y)*u;return{min:new hi((t.x*s+r.canonical.x)*u+r.wrap,(t.y*s+r.canonical.y)*u),max:new hi(d,p)}}function _k(t,e,r){let s=1<<r.canonical.z,u=((e.x-r.wrap)*s-r.canonical.x)*rt,d=(e.y*s-r.canonical.y)*rt;return{min:new hi(((t.x-r.wrap)*s-r.canonical.x)*rt,(t.y*s-r.canonical.y)*rt),max:new hi(u,d)}}function Jw(t,e,r,s,u,d,p){let _=t.indices,v=t.vertices,w=[];for(let E=s;E<s+u;E+=3){let k=e[r[E+0]+d],D=e[r[E+1]+d],N=e[r[E+2]+d],B=Math.min(k.x,D.x,N.x),q=Math.max(k.x,D.x,N.x),Z=Math.min(k.y,D.y,N.y),oe=Math.max(k.y,D.y,N.y);w.length=0,t.grid.query(new hi(B,Z),new hi(q,oe),w);for(let ve=0;ve<w.length;ve++){let be=w[ve];if(Tv(v[_[3*be+0]],v[_[3*be+1]],v[_[3*be+2]],k,D,N,p))return!0}}return!1}function Qw(t,e,r,s){if(!t||!r)return!1;let u=t.vertices;if(!e.canonical.equals(s.canonical)||e.wrap!==s.wrap){if(r.vertices.length<t.vertices.length)return Qw(r,s,t,e);let d=e.canonical,p=s.canonical,_=Math.pow(2,p.z-d.z);u=t.vertices.map(v=>new hi((v.x+d.x*rt)*_-p.x*rt,(v.y+d.y*rt)*_-p.y*rt))}return Jw(r,u,t.indices,0,t.indices.length,0,0)}function e5(t,e,r,s){let u=Math.pow(2,s.z-r.z);return new hi((t+r.x*rt)*u-s.x*rt,(e+r.y*rt)*u-s.y*rt)}function t5(t,e){let r=[];e.footprint.grid.queryPoint(t,r);let s=e.footprint.indices,u=e.footprint.vertices;for(let d=0;d<r.length;d++){let p=r[d];if(vf([u[s[3*p+0]],u[s[3*p+1]],u[s[3*p+2]]],t))return!0}return!1}class i5{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,r){let s=this.toIdx(e,r);return{min:this.minimums[s],max:this.maximums[s]}}isLeaf(e,r){return this.leaves[this.toIdx(e,r)]}toIdx(e,r){return r*this.size+e}}function r5(t,e,r,s){let u=0,d=Number.MAX_VALUE;for(let p=0;p<3;p++)if(Math.abs(s[p])<1e-15){if(r[p]<t[p]||r[p]>e[p])return null}else{let _=1/s[p],v=(t[p]-r[p])*_,w=(e[p]-r[p])*_;if(v>w){let E=v;v=w,w=E}if(v>u&&(u=v),w<d&&(d=w),u>d)return null}return u}function n5(t,e,r,s,u,d,p,_,v,w,E){let k=s-t,D=u-e,N=d-r,B=p-t,q=_-e,Z=v-r,oe=E[1]*Z-E[2]*q,ve=E[2]*B-E[0]*Z,be=E[0]*q-E[1]*B,we=k*oe+D*ve+N*be;if(Math.abs(we)<1e-15)return null;let $e=1/we,Ge=w[0]-t,it=w[1]-e,ot=w[2]-r,_t=(Ge*oe+it*ve+ot*be)*$e;if(_t<0||_t>1)return null;let Mt=it*N-ot*D,At=ot*k-Ge*N,zt=Ge*D-it*k,Jt=(E[0]*Mt+E[1]*At+E[2]*zt)*$e;return Jt<0||_t+Jt>1?null:(B*Mt+q*At+Z*zt)*$e}function a5(t,e,r){return(t-e)/(r-e)}function o5(t,e,r,s,u,d,p,_,v){let w=1<<r,E=d-s,k=p-u,D=(t+1)/w*E+s,N=(e+0)/w*k+u,B=(e+1)/w*k+u;_[0]=(t+0)/w*E+s,_[1]=N,v[0]=D,v[1]=B}class s5{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;let r=function(d){let p=Math.ceil(Math.log2(d.dim/8)),_=[],v=Math.ceil(Math.pow(2,p)),w=1/v,E=(N,B,q,Z,oe)=>{let ve=Z?1:0,be=(N+1)*q-ve,we=B*q,$e=(B+1)*q-ve;oe[0]=N*q,oe[1]=we,oe[2]=be,oe[3]=$e},k=new i5(v),D=[];for(let N=0;N<v*v;N++){E(N%v,Math.floor(N/v),w,!1,D);let B=bf(D[0],D[1],d),q=bf(D[2],D[1],d),Z=bf(D[2],D[3],d),oe=bf(D[0],D[3],d);k.minimums.push(Math.min(B,q,Z,oe)),k.maximums.push(Math.max(B,q,Z,oe)),k.leaves.push(1)}for(_.push(k),v/=2;v>=1;v/=2){let N=_[_.length-1];k=new i5(v);for(let B=0;B<v*v;B++){E(B%v,Math.floor(B/v),2,!0,D);let q=N.getElevation(D[0],D[1]),Z=N.getElevation(D[2],D[1]),oe=N.getElevation(D[2],D[3]),ve=N.getElevation(D[0],D[3]),be=N.isLeaf(D[0],D[1]),we=N.isLeaf(D[2],D[1]),$e=N.isLeaf(D[2],D[3]),Ge=N.isLeaf(D[0],D[3]),it=Math.min(q.min,Z.min,oe.min,ve.min),ot=Math.max(q.max,Z.max,oe.max,ve.max),_t=be&&we&&$e&&Ge;k.maximums.push(ot),k.minimums.push(it),k.leaves.push(ot-it<=5&&_t?1:0)}_.push(k)}return _}(this.dem),s=r.length-1,u=r[s];this._addNode(u.minimums[0],u.maximums[0],u.leaves[0]),this._construct(r,0,0,s,0)}raycastRoot(e,r,s,u,d,p,_=1){return r5([e,r,-100],[s,u,this.maximums[0]*_],d,p)}raycast(e,r,s,u,d,p,_=1){if(!this.nodeCount)return null;let v=this.raycastRoot(e,r,s,u,d,p,_);if(v==null)return null;let w=[],E=[],k=[],D=[],N=[{idx:0,t:v,nodex:0,nodey:0,depth:0}];for(;N.length>0;){let{idx:B,t:q,nodex:Z,nodey:oe,depth:ve}=N.pop();if(this.leaves[B]){o5(Z,oe,ve,e,r,s,u,k,D);let we=1<<ve,$e=(Z+0)/we,Ge=(Z+1)/we,it=(oe+0)/we,ot=(oe+1)/we,_t=bf($e,it,this.dem)*_,Mt=bf(Ge,it,this.dem)*_,At=bf(Ge,ot,this.dem)*_,zt=bf($e,ot,this.dem)*_,Jt=n5(k[0],k[1],_t,D[0],k[1],Mt,D[0],D[1],At,d,p),Ot=n5(D[0],D[1],At,k[0],D[1],zt,k[0],k[1],_t,d,p),Xt=Math.min(Jt!==null?Jt:Number.MAX_VALUE,Ot!==null?Ot:Number.MAX_VALUE);if(Xt!==Number.MAX_VALUE)return Xt;{let Dt=i._.scaleAndAdd([],d,p,q);if(l5(_t,Mt,zt,At,a5(Dt[0],k[0],D[0]),a5(Dt[1],k[1],D[1]))>=Dt[2])return q}continue}let be=0;for(let we=0;we<this._siblingOffset.length;we++){o5((Z<<1)+this._siblingOffset[we][0],(oe<<1)+this._siblingOffset[we][1],ve+1,e,r,s,u,k,D),k[2]=-100,D[2]=this.maximums[this.childOffsets[B]+we]*_;let $e=r5(k,D,d,p);if($e!=null){let Ge=$e;w[we]=Ge;let it=!1;for(let ot=0;ot<be&&!it;ot++)Ge>=w[E[ot]]&&(E.splice(ot,0,we),it=!0);it||(E[be]=we),be++}}for(let we=0;we<be;we++){let $e=E[we];N.push({idx:this.childOffsets[B]+$e,t:w[$e],nodex:(Z<<1)+this._siblingOffset[$e][0],nodey:(oe<<1)+this._siblingOffset[$e][1],depth:ve+1})}}return null}_addNode(e,r,s){return this.minimums.push(e),this.maximums.push(r),this.leaves.push(s),this.childOffsets.push(0),this.nodeCount++}_construct(e,r,s,u,d){if(e[u].isLeaf(r,s)===1)return;this.childOffsets[d]||(this.childOffsets[d]=this.nodeCount);let p=u-1,_=e[p],v=0,w=0;for(let E=0;E<this._siblingOffset.length;E++){let k=2*r+this._siblingOffset[E][0],D=2*s+this._siblingOffset[E][1],N=_.getElevation(k,D),B=_.isLeaf(k,D),q=this._addNode(N.min,N.max,B);B&&(v|=1<<E),w||(w=q)}for(let E=0;E<this._siblingOffset.length;E++)v&1<<E||this._construct(e,2*r+this._siblingOffset[E][0],2*s+this._siblingOffset[E][1],p,w+E)}}function l5(t,e,r,s,u,d){return $i($i(t,r,d),$i(e,s,d),u)}function bf(t,e,r){let s=r.dim,u=lr(t*s-.5,0,s-1),d=lr(e*s-.5,0,s-1),p=Math.floor(u),_=Math.floor(d),v=Math.min(p+1,s-1),w=Math.min(_+1,s-1);return l5(r.get(p,_),r.get(v,_),r.get(p,w),r.get(v,w),u-p,d-_)}let xk={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function vk(t,e,r){return(256*t*256+256*e+r)/10-1e4}function yk(t,e,r){return 256*t+e+r/256-32768}class M_{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,r,s,u=!1){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(s&&s!=="mapbox"&&s!=="terrarium")return Nn(`"${s}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=r.height;let d=this.dim=r.height-2,p=new Uint32Array(r.data.buffer);if(this.pixels=new Uint8Array(r.data.buffer),this.floatView=new Float32Array(r.data.buffer),this.borderReady=u,this._modifiedForSources={},!u){for(let v=0;v<d;v++)p[this._idx(-1,v)]=p[this._idx(0,v)],p[this._idx(d,v)]=p[this._idx(d-1,v)],p[this._idx(v,-1)]=p[this._idx(v,0)],p[this._idx(v,d)]=p[this._idx(v,d-1)];p[this._idx(-1,-1)]=p[this._idx(0,0)],p[this._idx(d,-1)]=p[this._idx(d-1,0)],p[this._idx(-1,d)]=p[this._idx(0,d-1)],p[this._idx(d,d)]=p[this._idx(d-1,d-1)]}let _=s==="terrarium"?yk:vk;for(let v=0;v<p.length;++v){let w=4*v;this.floatView[v]=_(this.pixels[w],this.pixels[w+1],this.pixels[w+2])}this._timestamp=ur.now()}_buildQuadTree(){this._tree=new s5(this)}get(e,r,s=!1){s&&(e=lr(e,-1,this.dim),r=lr(r,-1,this.dim));let u=this._idx(e,r);return this.floatView[u]}set(e,r,s){let u=this._idx(e,r),d=this.floatView[u];return this.floatView[u]=s,s-d}static getUnpackVector(e){return xk[e]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)}static pack(e,r){let s=[0,0,0,0],u=M_.getUnpackVector(r),d=Math.floor((e+u[3])/u[2]);return s[2]=d%256,d=Math.floor(d/256),s[1]=d%256,d=Math.floor(d/256),s[0]=d,s}getPixels(){return new Bw({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,r,s){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let u=r*this.dim,d=r*this.dim+this.dim,p=s*this.dim,_=s*this.dim+this.dim;switch(r){case-1:u=d-1;break;case 1:d=u+1}switch(s){case-1:p=_-1;break;case 1:_=p+1}let v=-r*this.dim,w=-s*this.dim;for(let E=p;E<_;E++)for(let k=u;k<d;k++){let D=4*this._idx(k,E),N=4*this._idx(k+v,E+w);this.pixels[D+0]=e.pixels[N+0],this.pixels[D+1]=e.pixels[N+1],this.pixels[D+2]=e.pixels[N+2],this.pixels[D+3]=e.pixels[N+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Pe(M_,"DEMData"),Pe(s5,"DemMinMaxQuadTree",{omit:["dem"]});class Am{constructor(e,r,s){this._demTile=e,this._dem=this._demTile.dem,this._scale=r,this._offset=s}static create(e,r,s){let u=s||e.findDEMTileFor(r);if(!u||!u.dem)return;let d=u.dem,p=u.tileID,_=1<<r.canonical.z-p.canonical.z;return new Am(u,d.dim/rt/_,[(r.canonical.x/_-p.canonical.x)*d.dim,(r.canonical.y/_-p.canonical.y)*d.dim])}tileCoordToPixel(e,r){let s=r*this._scale+this._offset[1],u=Math.floor(e*this._scale+this._offset[0]),d=Math.floor(s);return new hi(u,d)}getElevationAt(e,r,s,u){let d=e*this._scale+this._offset[0],p=r*this._scale+this._offset[1],_=Math.floor(d),v=Math.floor(p),w=this._dem;return u=!!u,s?$i($i(w.get(_,v,u),w.get(_,v+1,u),p-v),$i(w.get(_+1,v,u),w.get(_+1,v+1,u),p-v),d-_):w.get(_,v,u)}getElevationAtPixel(e,r,s){return this._dem.get(e,r,!!s)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*rl(1,e)*this._dem.stride}}let c5={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7},bk=C_.types,wk=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],Tk=["fill-extrusion-flood-light-ground-radius"],Sk=Math.pow(2,13),Ek=Math.pow(2,15)-1,u5=new hi(0,1),wf=2147483648;function Z0(t,e,r,s,u,d,p,_){t.emplaceBack((e<<1)+p,(r<<1)+d,(Math.floor(s*Sk)<<1)+u,Math.round(_))}function D_(t,e,r,s,u,d){t.emplaceBack(e.x,e.y,(r.x<<1)+s,(r.y<<1)+u,d)}function Y0(t,e,r){t.emplaceBack(e.x,e.y,e.z,r[0]*16384,r[1]*16384,r[2]*16384)}class h5{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class d5{constructor(){this.centroidXY=new hi(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new hi(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new hi(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new hi(this.max.x-this.min.x,this.max.y-this.min.y)}}class f5{constructor(){this.acc=new hi(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(e,r){e.min.x===Number.MAX_VALUE&&(e.min.x=e.max.x=r.x,e.min.y=e.max.y=r.y)}appendEdge(e,r,s){this.accCount++,this.acc._add(r);let u=!!this.borders;r.x<e.min.x?(e.min.x=r.x,u=!0):r.x>e.max.x&&(e.max.x=r.x,u=!0),r.y<e.min.y?(e.min.y=r.y,u=!0):r.y>e.max.y&&(e.max.y=r.y,u=!0),((r.x===0||r.x===rt)&&r.x===s.x)!=((r.y===0||r.y===rt)&&r.y===s.y)&&this.processBorderOverlap(r,s),u&&this.checkBorderIntersection(r,s)}checkBorderIntersection(e,r){r.x<0!=e.x<0&&this.addBorderIntersection(0,$i(r.y,e.y,(0-r.x)/(e.x-r.x))),r.x>rt!=e.x>rt&&this.addBorderIntersection(1,$i(r.y,e.y,(rt-r.x)/(e.x-r.x))),r.y<0!=e.y<0&&this.addBorderIntersection(2,$i(r.x,e.x,(0-r.y)/(e.y-r.y))),r.y>rt!=e.y>rt&&this.addBorderIntersection(3,$i(r.x,e.x,(rt-r.y)/(e.y-r.y)))}addBorderIntersection(e,r){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);let s=this.borders[e];r<s[0]&&(s[0]=r),r>s[1]&&(s[1]=r)}processBorderOverlap(e,r){if(e.x===r.x){if(e.y===r.y)return;let s=e.x===0?0:1;this.addBorderIntersection(s,r.y),this.addBorderIntersection(s,e.y)}else{let s=e.y===0?2:3;this.addBorderIntersection(s,r.x),this.addBorderIntersection(s,e.x)}}centroid(){return this.accCount===0?new hi(0,0):new hi(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((e,r)=>e+ +(r[0]!==Number.MAX_VALUE),0):0}}function p5(t,e){let r=t.add(e)._unit(),s=lr(t.x*r.x+t.y*r.y,-1,1);var u,d,p;return u=Math.acos(s),Math.min(4,Math.max(-4,Math.tan(u)))/4*Ek*((d=t).x*(p=e).y-d.y*p.x<0?-1:1)}let Ak=[t=>t.x<0,t=>t.x>rt,t=>t.y<0,t=>t.y>rt];function Ck(t,e,r,s){let u=[4];if(s===0)return u;r._mult(s);let d=t.sub(r),p=e.sub(r),_=[t,e,d,p];for(let v=0;v<4;v++)for(let w of _)if(Ak[v](w)){u.push(v);break}return u}class m5{constructor(e){this.vertexArray=new Wx,this.indexArray=new ko,this.programConfigurations=new _f(e.layers,{zoom:e.zoom,lut:e.lut},r=>Tk.includes(r)),this._segments=new oa,this.hiddenByLandmarkVertexArray=new av,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new oa}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(e,r,s,u=!1){let d=e.length;if(d>2){let p=Math.max(0,this._segments.get().length-1),_=this._segments._prepareSegment(4*d,this.vertexArray.length,2*this._segmentToGroundQuads[p].length),v;p!==this._segments.get().length-1&&(p++,this._segmentToGroundQuads[p]=[],this._segmentToRegionTriCounts[p]=[0,0,0,0,0]);{let w=e[0],E=e[1];v=p5(w.sub(e[d-1])._perp()._unit(),E.sub(w)._perp()._unit())}for(let w=0;w<d;w++){let E=w===d-1?0:w+1,k=e[w],D=e[E],N=e[E===d-1?0:E+1],B=D.sub(k)._perp()._unit(),q=p5(B,N.sub(D)._perp()._unit()),Z=v,oe=q;if(Vv(k,D,r)||u&&x5(k,r)&&x5(D,r)){v=q;continue}let ve=_.vertexLength;D_(this.vertexArray,k,D,1,1,Z),D_(this.vertexArray,k,D,1,0,Z),D_(this.vertexArray,k,D,0,1,oe),D_(this.vertexArray,k,D,0,0,oe),_.vertexLength+=4;let be=Ck(k,D,B,s);for(let we of be)this._segmentToGroundQuads[p].push({id:ve,region:we}),this._segmentToRegionTriCounts[p][we]+=2,_.primitiveLength+=2;v=q}}}prepareBorderSegments(){if(!this.hasData())return;let e=this._segments.get(),r=e.length;for(let s=0;s<r;s++)this._segmentToGroundQuads[s].sort((u,d)=>u.region-d.region);for(let s=0;s<r;s++){let u=this._segmentToGroundQuads[s],d=e[s],p=this._segmentToRegionTriCounts[s];p.reduce((v,w)=>v+w,0);let _=0;for(let v=0;v<=4;v++){let w=p[v];if(w!==0){let E=this.regionSegments[v];E||(E=this.regionSegments[v]=new oa);let k={vertexOffset:d.vertexOffset,primitiveOffset:d.primitiveOffset+_,vertexLength:d.vertexLength,primitiveLength:w};E.get().push(k)}_+=w}for(let v=0;v<u.length;v++){let w=u[v].id;this.indexArray.emplaceBack(w,w+1,w+3),this.indexArray.emplaceBack(w,w+3,w+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(e,r,s,u,d,p){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,e,r,s,u,d,p)}upload(e){this.hasData()&&(this.vertexBuffer=e.createVertexBuffer(this.vertexArray,ak.members),this.indexBuffer=e.createIndexBuffer(this.indexArray))}uploadPaintProperties(e){this.hasData()&&this.programConfigurations.upload(e)}update(e,r,s,u,d,p){this.hasData()&&this.programConfigurations.updatePaintArrays(e,r,s,u,d,p)}updateHiddenByLandmark(e){if(!this.hasData())return;let r=e.groundVertexCount+e.groundVertexArrayOffset;if(e.groundVertexCount===0)return;let s=e.flags&wf?1:0;for(let u=e.groundVertexArrayOffset;u<r;++u)this.hiddenByLandmarkVertexArray.emplace(u,s);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(e){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=e.createVertexBuffer(this.hiddenByLandmarkVertexArray,sk.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let e=0;e<=4;e++){let r=this.regionSegments[e];r&&r.destroy()}}}}class F_{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new ko,this.footprintVertices=new Bu,this.footprintSegments=[],this.layoutVertexArray=new hf,this.centroidVertexArray=new ew,this.indexArray=new ko,this.programConfigurations=new _f(e.layers,{zoom:e.zoom,lut:e.lut},r=>wk.includes(r)),this.segments=new oa,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.groundEffect=new m5(e),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(e,r){}populate(e,r,s,u){this.features=[],this.hasPattern=Rv("fill-extrusion",this.layers,r),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=f_(s),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(let{feature:d,id:p,index:_,sourceLayerIndex:v}of e){let w=this.layers[0]._featureFilter.needGeometry,E=wd(d,w);if(!this.layers[0]._featureFilter.filter(new ir(this.zoom),E,s))continue;let k={id:p,sourceLayerIndex:v,index:_,geometry:w?E.geometry:ju(d,s,u),properties:d.properties,type:d.type,patterns:{}},D=this.layoutVertexArray.length;this.hasPattern?this.features.push(Ov("fill-extrusion",this.layers,k,this.zoom,r)):this.addFeature(k,k.geometry,_,s,{},r.availableImages,u,r.brightness),r.featureIndex.insert(d,k.geometry,_,v,this.index,D)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(e,r,s,u,d,p){for(let _ of this.features){let{geometry:v}=_;this.addFeature(_,v,_.index,r,s,u,d,p)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(e,r,s,u,d){let p=Object.keys(e).length!==0;if(p&&!this.stateDependentLayers.length)return;let _=p?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(e,r,_,s,u,d),this.groundEffect.update(e,r,_,s,u,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ck),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,lk.members,!0)),this.groundEffect.upload(e)),this.groundEffect.uploadPaintProperties(e),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.groundEffect.uploadHiddenByLandmark(e),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,ok.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,s,u,d,p,_,v){let w=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(e,{})/this.tileToMeter,E=[new hi(0,0),new hi(rt,rt)],k=_.projection,D=k.name==="globe",N=bk[e.type]==="Polygon",B=new f5;B.centroidDataIndex=this.centroidData.length;let q=new d5,Z=this.layers[0].paint.get("fill-extrusion-base").evaluate(e,{},u)<=0,oe=this.layers[0].paint.get("fill-extrusion-height").evaluate(e,{},u);q.height=oe,q.vertexArrayOffset=this.layoutVertexArray.length,q.groundVertexArrayOffset=this.groundEffect.vertexArray.length,D&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new l_);let ve=S_(r,500);for(let ot=ve.length-1;ot>=0;ot--){let _t=ve[ot];(_t.length===0||(be=_t[0]).every(Mt=>Mt.x<=0)||be.every(Mt=>Mt.x>=rt)||be.every(Mt=>Mt.y<=0)||be.every(Mt=>Mt.y>=rt))&&ve.splice(ot,1)}var be;let we;if(D)we=w5(ve,E,u);else{we=[];for(let ot of ve)we.push({polygon:ot,bounds:E})}let $e=N?this.edgeRadius:0,Ge=$e>0&&this.zoom<17,it=(ot,_t)=>{if(ot.length===0)return!1;let Mt=ot[ot.length-1];return _t.x===Mt.x&&_t.y===Mt.y};for(let{polygon:ot,bounds:_t}of we){let Mt=0,At=0;for(let Xt of ot)N&&!Xt[0].equals(Xt[Xt.length-1])&&Xt.push(Xt[0]),At+=N?Xt.length-1:Xt.length;let zt=this.segments.prepareSegment((N?5:4)*At,this.layoutVertexArray,this.indexArray);q.footprintSegIdx<0&&(q.footprintSegIdx=this.footprintSegments.length),q.polygonSegIdx<0&&(q.polygonSegIdx=this.polygonSegments.length);let Jt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Ot=new h5;if(Ot.vertexOffset=this.footprintVertices.length,Ot.indexOffset=3*this.footprintIndices.length,Ot.ringIndices=[],N){let Xt=[],Dt=[];Mt=zt.vertexLength;for(let ri=0;ri<ot.length;ri++){let Kt=ot[ri];Kt.length&&ri!==0&&Dt.push(Xt.length/2);let Si=[],ei,li;ei=Kt[1].sub(Kt[0])._perp()._unit(),Ot.ringIndices.push(Kt.length-1);for(let Xi=1;Xi<Kt.length;Xi++){let zi=Kt[Xi],Oi=Kt[Xi===Kt.length-1?1:Xi+1],ai=zi.clone();if($e){li=Oi.sub(zi)._perp()._unit();let Yi=ei.add(li)._unit(),mr=$e*Math.min(4,1/(ei.x*Yi.x+ei.y*Yi.y));ai.x+=mr*Yi.x,ai.y+=mr*Yi.y,ai.x=Math.round(ai.x),ai.y=Math.round(ai.y),ei=li}!Z||$e!==0&&!Ge||it(Si,ai)||Si.push(ai),Z0(this.layoutVertexArray,ai.x,ai.y,0,0,1,1,0),zt.vertexLength++,this.footprintVertices.emplaceBack(zi.x,zi.y),Xt.push(zi.x,zi.y),D&&Y0(this.layoutVertexExtArray,k.projectTilePoint(ai.x,ai.y,u),k.upVector(u,ai.x,ai.y))}Z&&($e===0||Ge)&&(Si.length!==0&&it(Si,Si[0])&&Si.pop(),this.groundEffect.addData(Si,_t,w))}let Zt=W0(Xt,Dt);for(let ri=0;ri<Zt.length;ri+=3)this.footprintIndices.emplaceBack(Ot.vertexOffset+Zt[ri+0],Ot.vertexOffset+Zt[ri+1],Ot.vertexOffset+Zt[ri+2]),this.indexArray.emplaceBack(Mt+Zt[ri],Mt+Zt[ri+2],Mt+Zt[ri+1]),zt.primitiveLength++;Ot.indexCount+=Zt.length,Ot.vertexCount+=this.footprintVertices.length-Ot.vertexOffset}for(let Xt=0;Xt<ot.length;Xt++){let Dt=ot[Xt];B.startRing(q,Dt[0]);let Zt=Dt.length>4&&v5(Dt[Dt.length-2],Dt[0],Dt[1]),ri=$e?Ik(Dt[Dt.length-2],Dt[0],Dt[1],$e):0,Kt=[],Si,ei,li;ei=Dt[1].sub(Dt[0])._perp()._unit();let Xi=!0;for(let zi=1,Oi=0;zi<Dt.length;zi++){let ai=Dt[zi-1],Yi=Dt[zi],mr=Dt[zi===Dt.length-1?1:zi+1];if(B.appendEdge(q,Yi,ai),Vv(Yi,ai,_t)){$e&&(ei=mr.sub(Yi)._perp()._unit(),Xi=!Xi);continue}let er=Yi.sub(ai)._perp(),br=er.x/(Math.abs(er.x)+Math.abs(er.y)),gr=er.y>0?1:0,Dr=ai.dist(Yi);if(Oi+Dr>32768&&(Oi=0),$e){li=mr.sub(Yi)._perp()._unit();let Zr=_5(ai,Yi,mr,g5(ei,li),$e);isNaN(Zr)&&(Zr=0);let Hr=Yi.sub(ai)._unit();ai=ai.add(Hr.mult(ri))._round(),Yi=Yi.add(Hr.mult(-Zr))._round(),ri=Zr,ei=li,Z&&this.zoom>=17&&(it(Kt,ai)||Kt.push(ai),it(Kt,Yi)||Kt.push(Yi))}let Ji=zt.vertexLength,gn=Dt.length>4&&v5(ai,Yi,mr),mn=y5(Oi,Zt,Xi);if(Z0(this.layoutVertexArray,ai.x,ai.y,br,gr,0,0,mn),Z0(this.layoutVertexArray,ai.x,ai.y,br,gr,0,1,mn),Oi+=Dr,mn=y5(Oi,gn,!Xi),Zt=gn,Z0(this.layoutVertexArray,Yi.x,Yi.y,br,gr,0,0,mn),Z0(this.layoutVertexArray,Yi.x,Yi.y,br,gr,0,1,mn),zt.vertexLength+=4,this.indexArray.emplaceBack(Ji+0,Ji+1,Ji+2),this.indexArray.emplaceBack(Ji+1,Ji+3,Ji+2),zt.primitiveLength+=2,$e){let Zr=Mt+(zi===1?Dt.length-2:zi-2),Hr=zi===1?Mt:Zr+1;if(this.indexArray.emplaceBack(Ji+1,Zr,Ji+3),this.indexArray.emplaceBack(Zr,Hr,Ji+3),zt.primitiveLength+=2,Si===void 0&&(Si=Ji),!Vv(mr,Dt[zi],_t)){let Yr=zi===Dt.length-1?Si:zt.vertexLength;this.indexArray.emplaceBack(Ji+2,Ji+3,Yr),this.indexArray.emplaceBack(Ji+3,Yr+1,Yr),this.indexArray.emplaceBack(Ji+3,Hr,Yr+1),zt.primitiveLength+=3}Xi=!Xi}if(D){let Zr=this.layoutVertexExtArray,Hr=k.projectTilePoint(ai.x,ai.y,u),Yr=k.projectTilePoint(Yi.x,Yi.y,u),Pn=k.upVector(u,ai.x,ai.y),wn=k.upVector(u,Yi.x,Yi.y);Y0(Zr,Hr,Pn),Y0(Zr,Hr,Pn),Y0(Zr,Yr,wn),Y0(Zr,Yr,wn)}}N&&(Mt+=Dt.length-1),Z&&$e&&this.zoom>=17&&(Kt.length!==0&&it(Kt,Kt[0])&&Kt.pop(),this.groundEffect.addData(Kt,_t,w,$e>0))}this.footprintSegments.push(Ot),Jt.triangleCount=this.indexArray.length-Jt.triangleArrayOffset,this.polygonSegments.push(Jt),++q.footprintSegLen,++q.polygonSegLen}if(q.vertexCount=this.layoutVertexArray.length-q.vertexArrayOffset,q.groundVertexCount=this.groundEffect.vertexArray.length-q.groundVertexArrayOffset,q.vertexCount!==0){if(q.centroidXY=B.borders?u5:this.encodeCentroid(B,q),this.centroidData.push(q),B.borders){this.featuresOnBorder.push(B);let ot=this.featuresOnBorder.length-1;for(let _t=0;_t<B.borders.length;_t++)B.borders[_t][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[_t].push(ot)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,d,p,u,v),this.groundEffect.addPaintPropertiesData(e,s,d,p,u,v),this.maxHeight=Math.max(this.maxHeight,oe)}}sortBorders(){for(let e=0;e<this.borderFeatureIndices.length;e++)this.borderFeatureIndices[e].sort((r,s)=>this.featuresOnBorder[r].borders[e][0]-this.featuresOnBorder[s].borders[e][0])}splitToSubtiles(){let e=[];for(let _=0;_<this.centroidData.length;_++){let v=this.centroidData[_],w=+(v.min.y+v.max.y>rt),E=2*w+(+(v.min.x+v.max.x>rt)^w);for(let k=0;k<v.polygonSegLen;k++){let D=v.polygonSegIdx+k;e.push({centroidIdx:_,subtile:E,polygonSegmentIdx:D,triangleSegmentIdx:this.polygonSegments[D].triangleSegIdx})}}let r=new ko;e.sort((_,v)=>_.triangleSegmentIdx===v.triangleSegmentIdx?_.subtile-v.subtile:_.triangleSegmentIdx-v.triangleSegmentIdx);let s=0,u=0,d=0;for(let _ of e){if(_.triangleSegmentIdx!==s)break;d++}let p=e.length;for(;u!==e.length;){s=e[u].triangleSegmentIdx;let _=0,v=u,w=u;for(let E=v;E<d&&e[E].subtile===_;E++)w++;for(;v!==d;){let E=e[v];_=E.subtile;let k=this.centroidData[E.centroidIdx].min.clone(),D=this.centroidData[E.centroidIdx].max.clone(),N={vertexOffset:this.segments.segments[s].vertexOffset,primitiveOffset:r.length,vertexLength:this.segments.segments[s].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let B=v;B<w;B++){let q=e[B],Z=this.polygonSegments[q.polygonSegmentIdx],oe=this.centroidData[q.centroidIdx].min,ve=this.centroidData[q.centroidIdx].max,be=this.indexArray.uint16;for(let we=Z.triangleArrayOffset;we<Z.triangleArrayOffset+Z.triangleCount;we++)r.emplaceBack(be[3*we],be[3*we+1],be[3*we+2]);N.primitiveLength+=Z.triangleCount,k.x=Math.min(k.x,oe.x),k.y=Math.min(k.y,oe.y),D.x=Math.max(D.x,ve.x),D.y=Math.max(D.y,ve.y)}N.primitiveLength>0&&this.triangleSubSegments.push({segment:N,min:k,max:D}),v=w;for(let B=v;B<d&&e[B].subtile===e[v].subtile;B++)w++}u=d;for(let E=u;E<p&&e[E].triangleSegmentIdx===e[u].triangleSegmentIdx;E++)d++}r._trim(),this.indexArray=r}getVisibleSegments(e,r,s){let u=0,d=0,p=1<<e.canonical.z;if(r){let q=r.getMinMaxForTile(e);q&&(u=q.min,d=q.max)}d+=this.maxHeight;let _=e.toUnwrapped(),v,w=[_.canonical.x/p+_.wrap,_.canonical.y/p],E=[(_.canonical.x+1)/p+_.wrap,(_.canonical.y+1)/p],k=new oa,D=(q,Z,oe)=>[q[0]*(1-oe[0])+Z[0]*oe[0],q[1]*(1-oe[1])+Z[1]*oe[1]],N=[],B=[];for(let q of this.triangleSubSegments){N[0]=q.min.x/rt,N[1]=q.min.y/rt,B[0]=q.max.x/rt,B[1]=q.max.y/rt;let Z=D(w,E,N),oe=D(w,E,B);if(new sa([Z[0],Z[1],u],[oe[0],oe[1],d]).intersectsPrecise(s)===0){v&&(k.segments.push(v),v=void 0);continue}let ve=q.segment;v&&v.vertexOffset!==ve.vertexOffset&&(k.segments.push(v),v=void 0),v?(v.vertexLength+=ve.vertexLength,v.primitiveLength+=ve.primitiveLength):v={vertexOffset:ve.vertexOffset,primitiveLength:ve.primitiveLength,vertexLength:ve.vertexLength,primitiveOffset:ve.primitiveOffset,sortKey:void 0,vaos:{}}}return v&&k.segments.push(v),k}encodeCentroid(e,r){let s=e.centroid(),u=r.span(),d=Math.min(7,Math.round(u.x*this.tileToMeter/10)),p=Math.min(7,Math.round(u.y*this.tileToMeter/10));return new hi(lr(s.x,1,rt-1)<<3|d,lr(s.y,1,rt-1)<<3|p)}encodeBorderCentroid(e){if(!e.borders)return new hi(0,0);let r=e.borders,s=Number.MAX_VALUE;if(r[0][0]!==s||r[1][0]!==s){let u=r[0][0]!==s?0:1;return new hi(6|(r[0][0]!==s?0:65528),(r[u][0]+r[u][1])/2<<3|6)}{let u=r[2][0]!==s?2:3;return new hi((r[u][0]+r[u][1])/2<<3|6,6|(r[2][0]!==s?0:65528))}}showCentroid(e){let r=this.centroidData[e.centroidDataIndex];r.flags&=wf,r.centroidXY.x=0,r.centroidXY.y=0,this.writeCentroidToBuffer(r)}writeCentroidToBuffer(e){this.groundEffect.updateHiddenByLandmark(e);let r=e.vertexArrayOffset,s=e.vertexCount+e.vertexArrayOffset,u=e.flags&wf?u5:e.centroidXY,d=this.centroidVertexArray.geta_centroid_pos0(r);if(this.centroidVertexArray.geta_centroid_pos1(r)!==u.y||d!==u.x){for(let p=r;p<s;++p)this.centroidVertexArray.emplace(p,u.x,u.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(let e of this.centroidData)this.writeCentroidToBuffer(e)}updateReplacement(e,r,s){if(r.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=r.updateTime;let u=r.getReplacementRegionsForTile(e.toUnwrapped());if(jv(this.activeReplacements,u))return;if(this.activeReplacements=u,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(let p of this.centroidData)p.flags&=2147483647;let d=[];for(let p of this.activeReplacements){if(p.order<s)continue;let _=Math.pow(2,p.footprintTileId.canonical.z-e.canonical.z);for(let v of this.centroidData)if(!(v.flags&wf||p.min.x>v.max.x||v.min.x>p.max.x||p.min.y>v.max.y||v.min.y>p.max.y))for(let w=0;w<v.footprintSegLen;w++){let E=this.footprintSegments[v.footprintSegIdx+w];if(d.length=0,kk(this.footprintVertices,E.vertexOffset,E.vertexCount,p.footprintTileId.canonical,e.canonical,d),Jw(p.footprint,d,this.footprintIndices.uint16,E.indexOffset,E.indexCount,-E.vertexOffset,-_)){v.flags|=wf;break}}}for(let p of this.centroidData)this.writeCentroidToBuffer(p);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(e,r,s){let u=!1;for(let d=0;d<s.footprintSegLen;d++){let p=this.footprintSegments[s.footprintSegIdx+d],_=0;for(let v of p.ringIndices){for(let w=_,E=v+_-1;w<v+_;E=w++){let k=this.footprintVertices.int16[2*(w+p.vertexOffset)+0],D=this.footprintVertices.int16[2*(w+p.vertexOffset)+1],N=this.footprintVertices.int16[2*(E+p.vertexOffset)+1];D>r!=N>r&&e<(this.footprintVertices.int16[2*(E+p.vertexOffset)+0]-k)*(r-D)/(N-D)+k&&(u=!u)}_=v}}return u}getHeightAtTileCoord(e,r){let s=Number.NEGATIVE_INFINITY,u=!0,d=4*(e+rt)*rt+(r+rt);if(this.partLookup.hasOwnProperty(d)){let p=this.partLookup[d];return p?{height:p.height,hidden:!!(p.flags&wf)}:void 0}for(let p of this.centroidData)e>p.max.x||p.min.x>e||r>p.max.y||p.min.y>r||this.footprintContainsPoint(e,r,p)&&p&&p.height>s&&(s=p.height,this.partLookup[d]=p,u=!!(p.flags&wf));if(s!==Number.NEGATIVE_INFINITY)return{height:s,hidden:u};this.partLookup[d]=void 0}}function g5(t,e){let r=t.add(e)._unit();return t.x*r.x+t.y*r.y}function Ik(t,e,r,s){let u=e.sub(t)._perp()._unit(),d=r.sub(e)._perp()._unit();return _5(t,e,r,g5(u,d),s)}function _5(t,e,r,s,u){let d=Math.sqrt(1-s*s);return Math.min(t.dist(e)/3,e.dist(r)/3,u*d/s)}function Vv(t,e,r){return t.x<r[0].x&&e.x<r[0].x||t.x>r[1].x&&e.x>r[1].x||t.y<r[0].y&&e.y<r[0].y||t.y>r[1].y&&e.y>r[1].y}function x5(t,e){return t.x<e[0].x||t.x>e[1].x||t.y<e[0].y||t.y>e[1].y}function v5(t,e,r){if(t.x<0||t.x>=rt||e.x<0||e.x>=rt||r.x<0||r.x>=rt)return!1;let s=r.sub(e),u=s.perp(),d=t.sub(e);return(s.x*d.x+s.y*d.y)/Math.sqrt((s.x*s.x+s.y*s.y)*(d.x*d.x+d.y*d.y))>-.866&&u.x*d.x+u.y*d.y<0}function y5(t,e,r){let s=e?2|t:-3&t;return r?1|s:-2&s}function b5(){let t=Math.PI/32,e=Math.tan(t),r=bm;return r*Math.sqrt(1+2*e*e)-r}function w5(t,e,r){let s=1<<r.z,u=El(r.x/s),d=El((r.x+1)/s),p=Uo(r.y/s),_=Uo((r.y+1)/s);return function(v,w,E,k,D=0,N){let B=[];if(!v.length||!E||!k)return B;let q=(Ge,it)=>{for(let ot of Ge)B.push({polygon:ot,bounds:it})},Z=Math.ceil(Math.log2(E)),oe=Math.ceil(Math.log2(k)),ve=Z-oe,be=[];for(let Ge=0;Ge<Math.abs(ve);Ge++)be.push(ve>0?0:1);for(let Ge=0;Ge<Math.min(Z,oe);Ge++)be.push(0),be.push(1);let we=v;if(we=I_(we,w[0].y-D,w[1].y+D,1),we=I_(we,w[0].x-D,w[1].x+D,0),!we.length)return B;let $e=[];for(be.length?$e.push({polygons:we,bounds:w,depth:0}):q(we,w);$e.length;){let Ge=$e.pop(),it=Ge.depth,ot=be[it],_t=Ge.bounds[0],Mt=Ge.bounds[1],At=ot===0?_t.x:_t.y,zt=ot===0?Mt.x:Mt.y,Jt=N?N(ot,At,zt):.5*(At+zt),Ot=I_(Ge.polygons,At-D,Jt+D,ot),Xt=I_(Ge.polygons,Jt-D,zt+D,ot);if(Ot.length){let Dt=[_t,new hi(ot===0?Jt:Mt.x,ot===1?Jt:Mt.y)];be.length>it+1?$e.push({polygons:Ot,bounds:Dt,depth:it+1}):q(Ot,Dt)}if(Xt.length){let Dt=[new hi(ot===0?Jt:_t.x,ot===1?Jt:_t.y),Mt];be.length>it+1?$e.push({polygons:Xt,bounds:Dt,depth:it+1}):q(Xt,Dt)}}return B}(t,e,Math.ceil((d-u)/11.25),Math.ceil((p-_)/11.25),1,(v,w,E)=>{if(v===0)return .5*(w+E);{let k=Uo((r.y+w/rt)/s);return(Dh(.5*(Uo((r.y+E/rt)/s)+k))*s-r.y)*rt}})}function kk(t,e,r,s,u,d){let p=Math.pow(2,s.z-u.z);for(let _=0;_<r;_++){let v=t.int16[2*(_+e)+0],w=t.int16[2*(_+e)+1];v=(v+u.x*rt)*p-s.x*rt,w=(w+u.y*rt)*p-s.y*rt,d.push(new hi(v,w))}}Pe(F_,"FillExtrusionBucket",{omit:["layers","features"]}),Pe(d5,"PartData"),Pe(h5,"FootprintSegment"),Pe(f5,"BorderCentroidData"),Pe(m5,"GroundEffect");let Mk=new rn({visibility:new Gt(xt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Gt(xt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Dk={paint:new rn({"fill-extrusion-opacity":new Gt(xt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new _i(xt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Gt(xt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Gt(xt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new _i(xt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new _i(xt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new _i(xt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Gt(xt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Gt(xt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Gt(xt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Gt(xt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Gt(xt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Gt(xt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Gt(xt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Gt(xt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new _i(xt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new _i(xt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Gt(xt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Gt(xt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Gt(xt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Gt(xt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Gt(xt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"])}),layout:Mk};function K0(t,e){return t.x*e.x+t.y*e.y}function T5(t,e){if(t.length===1){let r=0,s=e[r++],u;for(;!u||s.equals(u);)if(u=e[r++],!u)return 1/0;for(;r<e.length;r++){let d=e[r],p=t[0],_=u.sub(s),v=d.sub(s),w=p.sub(s),E=K0(_,_),k=K0(_,v),D=K0(v,v),N=K0(w,_),B=K0(w,v),q=E*D-k*k,Z=(D*N-k*B)/q,oe=(E*B-k*N)/q,ve=s.z*(1-Z-oe)+u.z*Z+d.z*oe;if(isFinite(ve))return ve}return 1/0}{let r=1/0;for(let s of e)r=Math.min(r,s.z);return r}}function S5(t,e,r,s,u,d,p,_){let v=p*u.getElevationAt(t,e,!0,!0),w=d[0]!==0,E=w?d[1]===0?p*(d[0]/7-450):p*function(k,D,N){let B=Math.floor(D[0]/8),q=Math.floor(D[1]/8),Z=10*(D[0]-8*B),oe=10*(D[1]-8*q),ve=k.getElevationAt(B,q,!0,!0),be=k.getMeterToDEM(N),we=Math.floor(.5*(Z*be-1)),$e=Math.floor(.5*(oe*be-1)),Ge=k.tileCoordToPixel(B,q),it=2*we+1,ot=2*$e+1,_t=function(Xt,Dt,Zt,ri,Kt){return[Xt.getElevationAtPixel(Dt,Zt,!0),Xt.getElevationAtPixel(Dt+Kt,Zt,!0),Xt.getElevationAtPixel(Dt,Zt+Kt,!0),Xt.getElevationAtPixel(Dt+ri,Zt+Kt,!0)]}(k,Ge.x-we,Ge.y-$e,it,ot),Mt=Math.abs(_t[0]-_t[1]),At=Math.abs(_t[2]-_t[3]),zt=Math.abs(_t[0]-_t[2])+Math.abs(_t[1]-_t[3]),Jt=Math.min(.25,.5*be*(Mt+At)/it),Ot=Math.min(.25,.5*be*zt/ot);return ve+Math.max(Jt*Z,Ot*oe)}(u,d,_):v;return{base:v+(r===0)?-1:r,top:w?Math.max(E+s,v+r+2):v+s}}let Fk=nn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Pk}=Fk,Lk=nn([{name:"a_packed",components:4,type:"Float32"}]),{members:Rk}=Lk,Ok=nn([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:Nk}=Ok,Bk=nn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),zk=nn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),jk=nn([{name:"a_projected_pos",components:4,type:"Float32"}],4);nn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);let Uv=nn([{name:"a_occlusion_query_opacity",components:1,type:"Float32"}],4),E5=nn([{name:"a_z_offset",components:1,type:"Float32"}],4),Vk=nn([{name:"a_texb",components:2,type:"Uint16"}]),Uk=nn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Hk=nn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_z_offset",components:1,type:"Float32"}]);nn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);let A5=nn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Gk=nn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);nn([{name:"triangle",components:3,type:"Uint16"}]),nn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),nn([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Float32",name:"occlusionState"},{type:"Float32",name:"occlusionOpacity"},{type:"Uint8",name:"hasIconTextFit"}]),nn([{type:"Float32",name:"offsetX"}]),nn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);class C5{constructor(e,r){this.width=e,this.height=r,this.nextRow=0,this.image=new yf({width:e,height:r}),this.positions={},this.uploaded=!1}getDash(e,r){let s=this.getKey(e,r);return this.positions[s]}trim(){let e=this.width,r=this.height=_u(this.nextRow);this.image.resize({width:e,height:r})}getKey(e,r){return e.join(",")+r}getDashRanges(e,r,s){let u=[],d=e.length%2==1?-e[e.length-1]*s:0,p=e[0]*s,_=!0;u.push({left:d,right:p,isDash:_,zeroLength:e[0]===0});let v=e[0];for(let w=1;w<e.length;w++){_=!_;let E=e[w];d=v*s,v+=E,p=v*s,u.push({left:d,right:p,isDash:_,zeroLength:E===0})}return u}addRoundDash(e,r,s){let u=r/2;for(let d=-s;d<=s;d++){let p=this.width*(this.nextRow+s+d),_=0,v=e[_];for(let w=0;w<this.width;w++){w/v.right>1&&(v=e[++_]);let E=Math.abs(w-v.left),k=Math.abs(w-v.right),D=Math.min(E,k),N,B=d/s*(u+1);if(v.isDash){let q=u-Math.abs(B);N=Math.sqrt(D*D+q*q)}else N=u-Math.sqrt(D*D+B*B);this.image.data[p+w]=Math.max(0,Math.min(255,N+128))}}}addRegularDash(e,r){for(let v=e.length-1;v>=0;--v){let w=e[v],E=e[v+1];w.zeroLength?e.splice(v,1):E&&E.isDash===w.isDash&&(E.left=w.left,e.splice(v,1))}let s=e[0],u=e[e.length-1];s.isDash===u.isDash&&(s.left=u.left-this.width,u.right=s.right+this.width);let d=this.width*this.nextRow,p=0,_=e[p];for(let v=0;v<this.width;v++){v/_.right>1&&(_=e[++p]);let w=Math.abs(v-_.left),E=Math.abs(v-_.right),k=Math.min(w,E);this.image.data[d+v]=Math.max(0,Math.min(255,(_.isDash?k:-k)+r+128))}}addDash(e,r){let s=this.getKey(e,r);if(this.positions[s])return this.positions[s];let u=r==="round",d=u?7:0,p=2*d+1;if(this.nextRow+p>this.height)return Nn("LineAtlas out of space"),null;e.length===0&&e.push(1);let _=0;for(let E=0;E<e.length;E++)e[E]<0&&(Nn("Negative value is found in line dasharray, replacing values with 0"),e[E]=0),_+=e[E];if(_!==0){let E=this.width/_,k=this.getDashRanges(e,this.width,E);u?this.addRoundDash(k,E,d):this.addRegularDash(k,r==="square"?.5*E:0)}let v=this.nextRow+d;this.nextRow+=p;let w={tl:[v,d],br:[_,0]};return this.positions[s]=w,w}}Pe(C5,"LineAtlas");let Wk=C_.types,qk=Math.cos(Math.PI/180*37.5),$k=Math.cos(Math.PI/180*5);class P_{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.hasZOffset=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new qx,this.layoutVertexArray2=new df,this.patternVertexArray=new ff,this.indexArray=new ko,this.programConfigurations=new _f(e.layers,{zoom:e.zoom,lut:e.lut}),this.segments=new oa,this.maxLineLength=0,this.zOffsetVertexArray=new gp,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.tessellationStep=e.tessellationStep?e.tessellationStep:rt/64}updateFootprints(e,r){}populate(e,r,s,u){this.hasPattern=Rv("line",this.layers,r);let d=this.layers[0].layout.get("line-sort-key"),p=this.layers[0].layout.get("line-z-offset");this.hasZOffset=!p.isConstant()||!!p.constantOr(0);let _=[];for(let{feature:k,id:D,index:N,sourceLayerIndex:B}of e){let q=this.layers[0]._featureFilter.needGeometry,Z=wd(k,q);if(!this.layers[0]._featureFilter.filter(new ir(this.zoom),Z,s))continue;let oe=d?d.evaluate(Z,{},s):void 0,ve={id:D,properties:k.properties,type:k.type,sourceLayerIndex:B,index:N,geometry:q?Z.geometry:ju(k,s,u),patterns:{},sortKey:oe};_.push(ve)}d&&_.sort((k,D)=>k.sortKey-D.sortKey);let{lineAtlas:v,featureIndex:w}=r,E=this.addConstantDashes(v);for(let k of _){let{geometry:D,index:N,sourceLayerIndex:B}=k;if(E&&this.addFeatureDashes(k,v),this.hasPattern){let q=Ov("line",this.layers,k,this.zoom,r);this.patternFeatures.push(q)}else this.addFeature(k,D,N,s,v.positions,r.availableImages,r.brightness);w.insert(e[N].feature,D,N,B,this.index)}}addConstantDashes(e){let r=!1;for(let s of this.layers){let u=s.paint.get("line-dasharray").value,d=s.layout.get("line-cap").value;if(u.kind!=="constant"||d.kind!=="constant")r=!0;else{let p=d.value,_=u.value;if(!_)continue;e.addDash(_,p)}}return r}addFeatureDashes(e,r){let s=this.zoom;for(let u of this.layers){let d=u.paint.get("line-dasharray").value,p=u.layout.get("line-cap").value;if(d.kind==="constant"&&p.kind==="constant")continue;let _,v;if(d.kind==="constant"){if(_=d.value,!_)continue}else _=d.evaluate({zoom:s},e);v=p.kind==="constant"?p.value:p.evaluate({zoom:s},e),r.addDash(_,v),e.patterns[u.id]=r.getKey(_,v)}}update(e,r,s,u,d){let p=Object.keys(e).length!==0;p&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,r,p?this.stateDependentLayers:this.layers,s,u,d)}addFeatures(e,r,s,u,d,p){for(let _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,r,s,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Rk)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=e.createVertexBuffer(this.patternVertexArray,Nk)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=e.createVertexBuffer(this.zOffsetVertexArray,E5.members,!0)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Pk),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,r,s,u,d,p,_){let v=this.layers[0].layout,w=v.get("line-join").evaluate(e,{}),E=v.get("line-cap").evaluate(e,{}),k=v.get("line-miter-limit"),D=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(let N of r)this.addLine(N,e,u,w,E,k,D);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,d,p,u,_)}addLine(e,r,s,u,d,p,_){this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.currentVertex=void 0;let v={zoom:this.zoom,lineProgress:void 0},w=this.layers[0].layout,E=u==="none";if(this.patternJoinNone=this.hasPattern&&E,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ge=0;Ge<e.length-1;Ge++)this.totalDistance+=e[Ge].dist(e[Ge+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let k=Wk[r.type]==="Polygon",D=e.length;for(;D>=2&&e[D-1].equals(e[D-2]);)D--;let N=0;for(;N<D-1&&e[N].equals(e[N+1]);)N++;if(D<(k?3:2))return;u==="bevel"&&(p=1.05);let B=this.overscaling<=16?15*rt/(512*this.overscaling):0,q=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray),Z,oe,ve,be,we,$e;this.e1=this.e2=-1,k&&(Z=e[D-2],we=e[N].sub(Z)._unit()._perp());for(let Ge=N;Ge<D;Ge++){if(ve=Ge===D-1?k?e[N+1]:void 0:e[Ge+1],ve&&e[Ge].equals(ve))continue;if(we&&(be=we),Z&&(oe=Z),Z=e[Ge],this.hasZOffset){let Dt=w.get("line-z-offset").value;if(Dt.kind==="constant")$e=Dt.value;else{if(this.lineClips){let Zt=this.totalDistance/(this.lineClips.end-this.lineClips.start);v.lineProgress=(Zt*this.lineClips.start+this.distance+(oe?oe.dist(Z):0))/Zt}else Nn(`line-z-offset evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`),v.lineProgress=0;$e=Dt.evaluate(v,r)}$e=$e||0}we=ve?ve.sub(Z)._unit()._perp():be,be=be||we;let it=oe&&ve,ot=it?u:k||E?"butt":d,_t=be.x*we.x+be.y*we.y;if(E){let Dt=function(Zt){if(Zt.patternJoinNone){let ri=Zt.segmentPoints.length/2,Kt=Zt.lineSoFar-Zt.segmentStart;for(let Si=0;Si<ri;++Si){let ei=Zt.segmentPoints[2*Si+1],li=Math.round(Zt.segmentPoints[2*Si])+.5+.25*ei;Zt.patternVertexArray.emplaceBack(li,Kt,Zt.segmentStart),Zt.patternVertexArray.emplaceBack(li,Kt,Zt.segmentStart)}Zt.segmentPoints.length=0}Zt.e1=Zt.e2=-1};if(it&&_t<$k){this.updateDistance(oe,Z),this.addCurrentVertex(Z,be,1,1,q,$e),Dt(this),this.addCurrentVertex(Z,we,-1,-1,q,$e);continue}if(oe){if(!ve){this.updateDistance(oe,Z),this.addCurrentVertex(Z,be,1,1,q,$e),Dt(this);continue}ot="miter"}}let Mt=be.add(we);Mt.x===0&&Mt.y===0||Mt._unit();let At=Mt.x*we.x+Mt.y*we.y,zt=At!==0?1/At:1/0,Jt=2*Math.sqrt(2-2*At),Ot=At<qk&&oe&&ve,Xt=be.x*we.y-be.y*we.x>0;if(Ot&&Ge>N){let Dt=Z.dist(oe);if(Dt>2*B){let Zt=Z.sub(Z.sub(oe)._mult(B/Dt)._round());this.updateDistance(oe,Zt),this.addCurrentVertex(Zt,be,0,0,q,$e),oe=Zt}}if(it&&ot==="round"&&(zt<_?ot="miter":zt<=2&&(ot="fakeround")),ot==="miter"&&zt>p&&(ot="bevel"),ot==="bevel"&&(zt>2&&(ot="flipbevel"),zt<p&&(ot="miter")),oe&&this.updateDistance(oe,Z),ot==="miter")Mt._mult(zt),this.addCurrentVertex(Z,Mt,0,0,q,$e);else if(ot==="flipbevel"){if(zt>100)Mt=we.mult(-1);else{let Dt=zt*be.add(we).mag()/be.sub(we).mag();Mt._perp()._mult(Dt*(Xt?-1:1))}this.addCurrentVertex(Z,Mt,0,0,q,$e),this.addCurrentVertex(Z,Mt.mult(-1),0,0,q,$e)}else if(ot==="bevel"||ot==="fakeround"){let Dt=-Math.sqrt(zt*zt-1),Zt=Xt?Dt:0,ri=Xt?0:Dt;if(oe&&this.addCurrentVertex(Z,be,Zt,ri,q,$e),ot==="fakeround"){let Kt=Math.round(180*Jt/Math.PI/20);for(let Si=1;Si<Kt;Si++){let ei=Si/Kt;if(ei!==.5){let Xi=ei-.5;ei+=ei*Xi*(ei-1)*((1.0904+_t*(_t*(3.55645-1.43519*_t)-3.2452))*Xi*Xi+(.848013+_t*(.215638*_t-1.06021)))}let li=we.sub(be)._mult(ei)._add(be)._unit()._mult(Xt?-1:1);this.addHalfVertex(Z,li.x,li.y,!1,Xt,0,q,$e)}}ve&&this.addCurrentVertex(Z,we,-Zt,-ri,q,$e)}else ot==="butt"?this.addCurrentVertex(Z,Mt,0,0,q,$e):ot==="square"?(oe||this.addCurrentVertex(Z,Mt,-1,-1,q,$e),this.addCurrentVertex(Z,Mt,0,0,q,$e),oe&&this.addCurrentVertex(Z,Mt,1,1,q,$e)):ot==="round"&&(oe&&(this.addCurrentVertex(Z,be,0,0,q,$e),this.addCurrentVertex(Z,be,1,1,q,$e,!0)),ve&&(this.addCurrentVertex(Z,we,-1,-1,q,$e,!0),this.addCurrentVertex(Z,we,0,0,q,$e)));if(Ot&&Ge<D-1){let Dt=Z.dist(ve);if(Dt>2*B){let Zt=Z.add(ve.sub(Z)._mult(B/Dt)._round());this.updateDistance(Z,Zt),this.addCurrentVertex(Zt,we,0,0,q,$e),Z=Zt}}}}addVerticesTo(e,r,s,u,d,p,_,v,w,E){let k=(r.w-e.w)/this.tessellationStep|0;if(k>1){this.lineSoFar=e.w;let D=(r.x-e.x)/k,N=(r.y-e.y)/k,B=(r.z-e.z)/k,q=(r.w-e.w)/k;for(let Z=1;Z<k;++Z)e.x+=D,e.y+=N,e.z+=B,this.lineSoFar+=q,this.addHalfVertex(e,s,u,E,!1,_,w,e.z),this.addHalfVertex(e,d,p,E,!0,-v,w,e.z)}this.lineSoFar=r.w,this.addHalfVertex(r,s,u,E,!1,_,w,r.z),this.addHalfVertex(r,d,p,E,!0,-v,w,r.z)}addCurrentVertex(e,r,s,u,d,p,_=!1){let v=r.x+r.y*s,w=r.y-r.x*s,E=r.y*u-r.x,k=-r.y-r.x*u;if(p!=null){let N=rt+10,B=p,q=new $w(e.x,e.y,B,this.lineSoFar),Z=I5(e,-10,N),oe=this.lineSoFar;if(this.currentVertex)if(Z){let ve=this.currentVertexIsOutside,be=this.currentVertex,we=new $w(e.x,e.y,B,this.lineSoFar);Zw(be,we,-10,N),I5(we,-10,N)||(ve&&(this.e1=this.e2=-1,this.lineSoFar=be.w,this.addHalfVertex(be,v,w,_,!1,s,d,be.z),this.addHalfVertex(be,E,k,_,!0,-u,d,be.z)),this.addVerticesTo(be,we,v,w,E,k,s,u,d,_))}else{let ve=this.currentVertex;this.currentVertexIsOutside&&(Zw(ve,q,-10,N),this.e1=this.e2=-1,this.lineSoFar=ve.w,this.addHalfVertex(ve,v,w,_,!1,s,d,ve.z),this.addHalfVertex(ve,E,k,_,!0,-u,d,ve.z)),this.addVerticesTo(ve,q,v,w,E,k,s,u,d,_)}else Z||(this.addHalfVertex(e,v,w,_,!1,s,d,p),this.addHalfVertex(e,E,k,_,!0,-u,d,p));this.currentVertex=q,this.currentVertexIsOutside=Z,this.lineSoFar=oe}else this.addHalfVertex(e,v,w,_,!1,s,d,p),this.addHalfVertex(e,E,k,_,!0,-u,d,p)}addHalfVertex({x:e,y:r},s,u,d,p,_,v,w){this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),p||this.segmentPoints.push(this.lineSoFar-this.segmentStart,_)),this.layoutVertexArray.emplaceBack((e<<1)+(d?1:0),(r<<1)+(p?1:0),Math.round(63*s)+128,Math.round(63*u)+128,1+(_===0?0:_<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);let E=v.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,E),v.primitiveLength++),p?this.e2=E:this.e1=E,w!=null&&this.zOffsetVertexArray.emplaceBack(w)}updateScaledDistance(){if(this.lineClips){let e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}}function I5(t,e,r){return t.x<e||t.x>r||t.y<e||t.y>r}Pe(P_,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});let Xk=new rn({"line-cap":new _i(xt.layout_line["line-cap"]),"line-join":new _i(xt.layout_line["line-join"]),"line-miter-limit":new Gt(xt.layout_line["line-miter-limit"]),"line-round-limit":new Gt(xt.layout_line["line-round-limit"]),"line-sort-key":new _i(xt.layout_line["line-sort-key"]),"line-z-offset":new _i(xt.layout_line["line-z-offset"]),visibility:new Gt(xt.layout_line.visibility)});var L_={paint:new rn({"line-opacity":new _i(xt.paint_line["line-opacity"]),"line-color":new _i(xt.paint_line["line-color"]),"line-translate":new Gt(xt.paint_line["line-translate"]),"line-translate-anchor":new Gt(xt.paint_line["line-translate-anchor"]),"line-width":new _i(xt.paint_line["line-width"]),"line-gap-width":new _i(xt.paint_line["line-gap-width"]),"line-offset":new _i(xt.paint_line["line-offset"]),"line-blur":new _i(xt.paint_line["line-blur"]),"line-dasharray":new _i(xt.paint_line["line-dasharray"]),"line-pattern":new _i(xt.paint_line["line-pattern"]),"line-gradient":new aa(xt.paint_line["line-gradient"]),"line-trim-offset":new Gt(xt.paint_line["line-trim-offset"]),"line-trim-fade-range":new Gt(xt.paint_line["line-trim-fade-range"]),"line-trim-color":new Gt(xt.paint_line["line-trim-color"]),"line-emissive-strength":new Gt(xt.paint_line["line-emissive-strength"]),"line-border-width":new _i(xt.paint_line["line-border-width"]),"line-border-color":new _i(xt.paint_line["line-border-color"]),"line-occlusion-opacity":new Gt(xt.paint_line["line-occlusion-opacity"])}),layout:Xk};function k5(t,e,r){return e*(rt/(t.tileSize*Math.pow(2,r-t.tileID.overscaledZ)))}function M5(t,e){return 1/k5(t,1,e.tileZoom)}function D5(t,e,r,s){return t.translatePosMatrix(s||e.tileID.projMatrix,e,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}let F5=t=>{let e=[];P5(t)&&e.push("RENDER_LINE_DASH"),t.paint.get("line-gradient")&&e.push("RENDER_LINE_GRADIENT");let r=t.paint.get("line-trim-offset");r[0]===0&&r[1]===0||e.push("RENDER_LINE_TRIM_OFFSET"),t.paint.get("line-border-width").constantOr(1)!==0&&e.push("RENDER_LINE_BORDER");let s=t.layout.get("line-join").constantOr("miter")==="none",u=!!t.paint.get("line-pattern").constantOr(1);return s&&u&&e.push("LINE_JOIN_NONE"),e};function P5(t){let e=t.paint.get("line-dasharray").value;return e.value||e.kind!=="constant"}class L5{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){let s=e[r];this._stringToNumber[s]=r,this._numberToString[r]=s}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}var Zk={read:function(t,e,r,s,u){var d,p,_=8*u-s-1,v=(1<<_)-1,w=v>>1,E=-7,k=r?u-1:0,D=r?-1:1,N=t[e+k];for(k+=D,d=N&(1<<-E)-1,N>>=-E,E+=_;E>0;d=256*d+t[e+k],k+=D,E-=8);for(p=d&(1<<-E)-1,d>>=-E,E+=s;E>0;p=256*p+t[e+k],k+=D,E-=8);if(d===0)d=1-w;else{if(d===v)return p?NaN:1/0*(N?-1:1);p+=Math.pow(2,s),d-=w}return(N?-1:1)*p*Math.pow(2,d-s)},write:function(t,e,r,s,u,d){var p,_,v,w=8*d-u-1,E=(1<<w)-1,k=E>>1,D=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,N=s?0:d-1,B=s?1:-1,q=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(_=isNaN(e)?1:0,p=E):(p=Math.floor(Math.log(e)/Math.LN2),e*(v=Math.pow(2,-p))<1&&(p--,v*=2),(e+=p+k>=1?D/v:D*Math.pow(2,1-k))*v>=2&&(p++,v/=2),p+k>=E?(_=0,p=E):p+k>=1?(_=(e*v-1)*Math.pow(2,u),p+=k):(_=e*Math.pow(2,k-1)*Math.pow(2,u),p=0));u>=8;t[r+N]=255&_,N+=B,_/=256,u-=8);for(p=p<<u|_,w+=u;w>0;t[r+N]=255&p,N+=B,p/=256,w-=8);t[r+N-B]|=128*q}},R5=Kn,R_=Zk;function Kn(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Kn.Varint=0,Kn.Fixed64=1,Kn.Bytes=2,Kn.Fixed32=5;var Hv=4294967296,O5=1/Hv,N5=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ed(t){return t.type===Kn.Bytes?t.readVarint()+t.pos:t.pos+1}function Cm(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function B5(t,e,r){var s=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(s);for(var u=r.pos-1;u>=t;u--)r.buf[u+s]=r.buf[u]}function Yk(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function Kk(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function Jk(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function Qk(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function eM(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function tM(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function iM(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function rM(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function nM(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function O_(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Im(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function z5(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}Kn.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var s=this.readVarint(),u=s>>3,d=this.pos;this.type=7&s,t(u,e,this),this.pos===d&&this.skip(s)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=O_(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=z5(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=O_(this.buf,this.pos)+O_(this.buf,this.pos+4)*Hv;return this.pos+=8,t},readSFixed64:function(){var t=O_(this.buf,this.pos)+z5(this.buf,this.pos+4)*Hv;return this.pos+=8,t},readFloat:function(){var t=R_.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=R_.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,r,s=this.buf;return e=127&(r=s[this.pos++]),r<128?e:(e|=(127&(r=s[this.pos++]))<<7,r<128?e:(e|=(127&(r=s[this.pos++]))<<14,r<128?e:(e|=(127&(r=s[this.pos++]))<<21,r<128?e:function(u,d,p){var _,v,w=p.buf;if(_=(112&(v=w[p.pos++]))>>4,v<128||(_|=(127&(v=w[p.pos++]))<<3,v<128)||(_|=(127&(v=w[p.pos++]))<<10,v<128)||(_|=(127&(v=w[p.pos++]))<<17,v<128)||(_|=(127&(v=w[p.pos++]))<<24,v<128)||(_|=(1&(v=w[p.pos++]))<<31,v<128))return Cm(u,_,d);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=s[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&N5?function(r,s,u){return N5.decode(r.subarray(s,u))}(this.buf,e,t):function(r,s,u){for(var d="",p=s;p<u;){var _,v,w,E=r[p],k=null,D=E>239?4:E>223?3:E>191?2:1;if(p+D>u)break;D===1?E<128&&(k=E):D===2?(192&(_=r[p+1]))==128&&(k=(31&E)<<6|63&_)<=127&&(k=null):D===3?(v=r[p+2],(192&(_=r[p+1]))==128&&(192&v)==128&&((k=(15&E)<<12|(63&_)<<6|63&v)<=2047||k>=55296&&k<=57343)&&(k=null)):D===4&&(v=r[p+2],w=r[p+3],(192&(_=r[p+1]))==128&&(192&v)==128&&(192&w)==128&&((k=(15&E)<<18|(63&_)<<12|(63&v)<<6|63&w)<=65535||k>=1114112)&&(k=null)),k===null?(k=65533,D=1):k>65535&&(k-=65536,d+=String.fromCharCode(k>>>10&1023|55296),k=56320|1023&k),d+=String.fromCharCode(k),p+=D}return d}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Kn.Bytes)return t.push(this.readVarint(e));var r=Ed(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Kn.Bytes)return t.push(this.readSVarint());var e=Ed(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Kn.Bytes)return t.push(this.readBoolean());var e=Ed(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Kn.Bytes)return t.push(this.readFloat());var e=Ed(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Kn.Bytes)return t.push(this.readDouble());var e=Ed(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Kn.Bytes)return t.push(this.readFixed32());var e=Ed(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Kn.Bytes)return t.push(this.readSFixed32());var e=Ed(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Kn.Bytes)return t.push(this.readFixed64());var e=Ed(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Kn.Bytes)return t.push(this.readSFixed64());var e=Ed(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Kn.Varint)for(;this.buf[this.pos++]>127;);else if(e===Kn.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Kn.Fixed32)this.pos+=4;else{if(e!==Kn.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Im(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Im(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Im(this.buf,-1&t,this.pos),Im(this.buf,Math.floor(t*O5),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Im(this.buf,-1&t,this.pos),Im(this.buf,Math.floor(t*O5),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,r){var s,u;if(e>=0?(s=e%4294967296|0,u=e/4294967296|0):(u=~(-e/4294967296),4294967295^(s=~(-e%4294967296))?s=s+1|0:(s=0,u=u+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),function(d,p,_){_.buf[_.pos++]=127&d|128,d>>>=7,_.buf[_.pos++]=127&d|128,d>>>=7,_.buf[_.pos++]=127&d|128,d>>>=7,_.buf[_.pos++]=127&d|128,_.buf[_.pos]=127&(d>>>=7)}(s,0,r),function(d,p){var _=(7&d)<<4;p.buf[p.pos++]|=_|((d>>>=3)?128:0),d&&(p.buf[p.pos++]=127&d|((d>>>=7)?128:0),d&&(p.buf[p.pos++]=127&d|((d>>>=7)?128:0),d&&(p.buf[p.pos++]=127&d|((d>>>=7)?128:0),d&&(p.buf[p.pos++]=127&d|((d>>>=7)?128:0),d&&(p.buf[p.pos++]=127&d)))))}(u,r)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(s,u,d){for(var p,_,v=0;v<u.length;v++){if((p=u.charCodeAt(v))>55295&&p<57344){if(!_){p>56319||v+1===u.length?(s[d++]=239,s[d++]=191,s[d++]=189):_=p;continue}if(p<56320){s[d++]=239,s[d++]=191,s[d++]=189,_=p;continue}p=_-55296<<10|p-56320|65536,_=null}else _&&(s[d++]=239,s[d++]=191,s[d++]=189,_=null);p<128?s[d++]=p:(p<2048?s[d++]=p>>6|192:(p<65536?s[d++]=p>>12|224:(s[d++]=p>>18|240,s[d++]=p>>12&63|128),s[d++]=p>>6&63|128),s[d++]=63&p|128)}return d}(this.buf,t,this.pos);var r=this.pos-e;r>=128&&B5(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),R_.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),R_.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var s=this.pos-r;s>=128&&B5(r,s,this),this.pos=r-1,this.writeVarint(s),this.pos+=s},writeMessage:function(t,e,r){this.writeTag(t,Kn.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Yk,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Kk,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,eM,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Jk,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Qk,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,tM,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,iM,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,rM,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,nM,e)},writeBytesField:function(t,e){this.writeTag(t,Kn.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Kn.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Kn.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Kn.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Kn.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Kn.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Kn.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Kn.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Kn.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Kn.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,!!e)}};var km=K(R5);let aM=["id","tile","layer","source","sourceLayer","state"];class j5{constructor(e,r,s,u,d){this.type="Feature",this._vectorTileFeature=e,this._z=r,this._x=s,this._y=u,this.properties=e.properties,this.id=d}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){let e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(let r of aM)this[r]!==void 0&&(e[r]=this[r]);return e}}class oM{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,s){let u=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},ya(this.stateChanges[e][u],s),this.deletedStates[e]===null){this.deletedStates[e]={};for(let d in this.state[e])d!==u&&(this.deletedStates[e][d]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][u]===null){this.deletedStates[e][u]={};for(let d in this.state[e][u])s[d]||(this.deletedStates[e][u][d]=null)}else for(let d in s)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][d]===null&&delete this.deletedStates[e][u][d]}removeFeatureState(e,r,s){if(this.deletedStates[e]===null)return;let u=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},s&&r!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][s]=null);else if(r!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(s in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][s]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,r){let s=String(r),u=ya({},(this.state[e]||{})[s],(this.stateChanges[e]||{})[s]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){let d=this.deletedStates[e][r];if(d===null)return{};for(let p in d)delete u[p]}return u}initializeTileState(e,r){e.setFeatureState(this.state,r)}coalesceChanges(e,r){let s={};for(let u in this.stateChanges){this.state[u]=this.state[u]||{};let d={};for(let p in this.stateChanges[u])this.state[u][p]||(this.state[u][p]={}),ya(this.state[u][p],this.stateChanges[u][p]),d[p]=this.state[u][p];s[u]=d}for(let u in this.deletedStates){this.state[u]=this.state[u]||{};let d={};if(this.deletedStates[u]===null)for(let p in this.state[u])d[p]={},this.state[u][p]={};else for(let p in this.deletedStates[u]){if(this.deletedStates[u][p]===null)this.state[u][p]={};else if(this.state[u][p])for(let _ of Object.keys(this.deletedStates[u][p]))delete this.state[u][p][_];d[p]=this.state[u][p]}s[u]=s[u]||{},ya(s[u],d)}if(this.stateChanges={},this.deletedStates={},Object.keys(s).length!==0)for(let u in e)e[u].setFeatureState(s,r)}}class V5{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Je(rt,16,0),this.featureIndexArray=new Q2,this.promoteId=r,this.is3DTile=!1}insert(e,r,s,u,d,p=0,_=0){let v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,u,d,p);let w=this.grid;for(let E=0;E<r.length;E++){let k=r[E],D=[1/0,1/0,-1/0,-1/0];for(let N=0;N<k.length;N++){let B=k[N];D[0]=Math.min(D[0],B.x),D[1]=Math.min(D[1],B.y),D[2]=Math.max(D[2],B.x),D[3]=Math.max(D[3],B.y)}_!==0&&(D[0]-=_,D[1]-=_,D[2]+=_,D[3]+=_),D[0]<rt&&D[1]<rt&&D[2]>=0&&D[3]>=0&&w.insert(v,D[0],D[1],D[2],D[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Bv(new km(this.rawTileData)).layers,this.sourceLayerCoder=new L5(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(let e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,r,s,u){this.loadVTLayers();let d=e.params||{},p=bo(d.filter),_=e.tileResult,v=e.transform,w=_.bufferedTilespaceBounds,E=this.grid.query(w.min.x,w.min.y,w.max.x,w.max.y,(B,q,Z,oe)=>gw(_.bufferedTilespaceGeometry,B,q,Z,oe));E.sort(sM);let k=null;v.elevation&&E.length>0&&(k=Am.create(v.elevation,this.tileID));let D={},N;for(let B=0;B<E.length;B++){let q=E[B];if(q===N)continue;N=q;let Z=this.featureIndexArray.get(q),oe=null;if(this.is3DTile){let ve=this.bucketLayerIDs[0][0],be=r[ve];if(be.type!=="model")continue;let{queryFeature:we,intersectionZ:$e}=be.queryIntersectsMatchingFeature(_,Z.featureIndex,p,v);we&&this.appendToResult(D,ve,Z.featureIndex,we,$e)}else this.loadMatchingFeature(D,Z,p,d.layers,d.availableImages,r,s,u,(ve,be,we,$e=0)=>(oe||(oe=ju(ve,this.tileID.canonical,e.tileTransform)),be.queryIntersectsFeature(_,ve,we,oe,this.z,e.transform,e.pixelPosMatrix,k,$e)))}return D}loadMatchingFeature(e,r,s,u,d,p,_,v,w){let{featureIndex:E,bucketIndex:k,sourceLayerIndex:D,layoutVertexArrayOffset:N}=r,B=this.bucketLayerIDs[k];if(u&&!function(ve,be){for(let we=0;we<ve.length;we++)if(be.indexOf(ve[we])>=0)return!0;return!1}(u,B))return;let q=this.sourceLayerCoder.decode(D),Z=this.vtLayers[q].feature(E);if(s.needGeometry){let ve=wd(Z,!0);if(!s.filter(new ir(this.tileID.overscaledZ),ve,this.tileID.canonical))return}else if(!s.filter(new ir(this.tileID.overscaledZ),Z))return;let oe=this.getId(Z,q);for(let ve=0;ve<B.length;ve++){let be=B[ve];if(u&&u.indexOf(be)<0)continue;let we=p[be];if(!we)continue;let $e={};oe!==void 0&&v&&($e=v.getState(we.sourceLayer||"_geojsonTileLayer",oe));let Ge=!w||w(Z,we,$e,N);if(!Ge)continue;let it=new j5(Z,this.z,this.x,this.y,oe),ot=ya({},_[be]);ot.paint=U5(ot.paint,we.paint,Z,$e,d),ot.layout=U5(ot.layout,we.layout,Z,$e,d),it.layer=ot,this.appendToResult(e,be,E,it,Ge)}}appendToResult(e,r,s,u,d){let p=e[r];p===void 0&&(p=e[r]=[]),p.push({featureIndex:s,feature:u,intersectionZ:d})}lookupSymbolFeatures(e,r,s,u,d,p,_,v){let w={};this.loadVTLayers();let E=bo(d);for(let k of e)this.loadMatchingFeature(w,{bucketIndex:s,sourceLayerIndex:u,featureIndex:k,layoutVertexArrayOffset:0},E,p,_,v,r);return w}loadFeature(e){let{featureIndex:r,sourceLayerIndex:s}=e;this.loadVTLayers();let u=this.sourceLayerCoder.decode(s),d=this.vtFeatures[u];if(d[r])return d[r];let p=this.vtLayers[u].feature(r);return d[r]=p,p}hasLayer(e){for(let r of this.bucketLayerIDs)for(let s of r)if(e===s)return!0;return!1}getId(e,r){let s=e.id;if(this.promoteId){let u=typeof this.promoteId=="string"?this.promoteId:this.promoteId[r];u!=null&&(s=e.properties[u]),typeof s=="boolean"&&(s=Number(s))}return s}}function U5(t,e,r,s,u){return zc(t,(d,p)=>{let _=e instanceof pn?e.get(p):null;return _&&_.evaluate?_.evaluate(r,s,u):_})}function sM(t,e){return e-t}Pe(V5,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});var ts=24;let Vu=128;function Gv(t,e){let{expression:r}=e;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new ir(t+1))};if(r.kind==="source")return{kind:"source"};{let{zoomStops:s,interpolationType:u}=r,d=0;for(;d<s.length&&s[d]<=t;)d++;d=Math.max(0,d-1);let p=d;for(;p<s.length&&s[p]<t+1;)p++;p=Math.min(s.length-1,p);let _=s[d],v=s[p];return r.kind==="composite"?{kind:"composite",minZoom:_,maxZoom:v,interpolationType:u}:{kind:"camera",minZoom:_,maxZoom:v,minSize:r.evaluate(new ir(_)),maxSize:r.evaluate(new ir(v)),interpolationType:u}}}function N_(t,{uSize:e,uSizeT:r},{lowerSize:s,upperSize:u}){return t.kind==="source"?s/Vu:t.kind==="composite"?$i(s/Vu,u/Vu,r):e}function Mm(t,e){let r=0,s=0;if(t.kind==="constant")s=t.layoutSize;else if(t.kind!=="source"){let{interpolationType:u,minZoom:d,maxZoom:p}=t,_=u?lr(ms.interpolationFactor(u,e,d,p),0,1):0;t.kind==="camera"?s=$i(t.minSize,t.maxSize,_):r=_}return{uSizeT:r,uSize:s}}var lM=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Vu,evaluateSizeForFeature:N_,evaluateSizeForZoom:Mm,getSizeData:Gv});function cM(t,e,r){return t.sections.forEach(s=>{s.text=function(u,d,p){let _=d.layout.get("text-transform").evaluate(p,{});return _==="uppercase"?u=u.toLocaleUpperCase():_==="lowercase"&&(u=u.toLocaleLowerCase()),un.applyArabicShaping&&(u=un.applyArabicShaping(u)),u}(s.text,e,r)}),t}let J0={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42","\u2190":"\u2191","\u2192":"\u2193"};function uM(t){return t==="\uFE36"||t==="\uFE48"||t==="\uFE38"||t==="\uFE44"||t==="\uFE42"||t==="\uFE3E"||t==="\uFE3C"||t==="\uFE3A"||t==="\uFE18"||t==="\uFE40"||t==="\uFE10"||t==="\uFE13"||t==="\uFE14"||t==="\uFF40"||t==="\uFFE3"||t==="\uFE11"||t==="\uFE12"}function hM(t){return t==="\uFE35"||t==="\uFE47"||t==="\uFE37"||t==="\uFE43"||t==="\uFE41"||t==="\uFE3D"||t==="\uFE3B"||t==="\uFE39"||t==="\uFE17"||t==="\uFE3F"}let Wv=3;function dM(t,e,r){e.glyphs=[],t===1&&r.readMessage(fM,e)}function fM(t,e,r){if(t===3){let{id:s,bitmap:u,width:d,height:p,left:_,top:v,advance:w}=r.readMessage(pM,{});e.glyphs.push({id:s,bitmap:new yf({width:d+2*Wv,height:p+2*Wv},u),metrics:{width:d,height:p,left:_,top:v,advance:w}})}else t===4?e.ascender=r.readSVarint():t===5&&(e.descender=r.readSVarint())}function pM(t,e,r){t===1?e.id=r.readVarint():t===2?e.bitmap=r.readBytes():t===3?e.width=r.readVarint():t===4?e.height=r.readVarint():t===5?e.left=r.readSVarint():t===6?e.top=r.readSVarint():t===7&&(e.advance=r.readVarint())}let H5=Wv,Ic={horizontal:1,vertical:2,horizontalOnly:3};class Q0{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,r){let s=new Q0;return s.scale=e||1,s.fontStack=r,s}static forImage(e){let r=new Q0;return r.imageName=e,r}}class Dm{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,r){let s=new Dm;for(let u=0;u<e.sections.length;u++){let d=e.sections[u];d.image?s.addImageSection(d):s.addTextSection(d,r)}return s}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCodePoint(e){return this.text.codePointAt(e)}verticalizePunctuation(e){this.text=function(r,s){let u="";for(let d=0;d<r.length;d++){let p=r.charCodeAt(d+1)||null,_=r.charCodeAt(d-1)||null;u+=!s&&(p&&Ut(p)&&!J0[r[d+1]]||_&&Ut(_)&&!J0[r[d-1]])||!J0[r[d]]?r[d]:J0[r[d]]}return u}(this.text,e)}trim(){let e=0;for(let s=0;s<this.text.length&&B_[this.text.charCodeAt(s)];s++)e++;let r=this.text.length;for(let s=this.text.length-1;s>=0&&s>=e&&B_[this.text.charCodeAt(s)];s--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)}substring(e,r){let s=new Dm;return s.text=this.text.substring(e,r),s.sectionIndex=this.sectionIndex.slice(e,r),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,r)=>Math.max(e,this.sections[r].scale),0)}addTextSection(e,r){this.text+=e.text,this.sections.push(Q0.forText(e.scale,e.fontStack||r));let s=this.sections.length-1;for(let u=0;u<e.text.length;++u)this.sectionIndex.push(s)}addImageSection(e){let r=e.image?e.image.namePrimary:"";if(r.length===0)return void Nn("Can't add FormattedSection with an empty image.");let s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCodePoint(s),this.sections.push(Q0.forImage(r)),this.sectionIndex.push(this.sections.length-1)):Nn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function qv(t,e,r,s,u,d,p,_,v,w,E,k,D,N,B){let q=Dm.fromFeature(t,u);k===Ic.vertical&&q.verticalizePunctuation(D);let Z=[],oe=function(Ge,it,ot,_t,Mt,At){if(!Ge)return[];let zt=[],Jt=function(Zt,ri,Kt,Si,ei,li){let Xi=0;for(let zi=0;zi<Zt.length();zi++){let Oi=Zt.getSection(zi);Xi+=G5(Zt.getCodePoint(zi),Oi,Si,ei,ri,li)}return Xi/Math.max(1,Math.ceil(Xi/Kt))}(Ge,it,ot,_t,Mt,At),Ot=Ge.text.indexOf("\u200B")>=0,Xt=0;for(let Zt=0;Zt<Ge.length();Zt++){let ri=Ge.getSection(Zt),Kt=Ge.getCodePoint(Zt);if(B_[Kt]||(Xt+=G5(Kt,ri,_t,Mt,it,At)),Zt<Ge.length()-1){let Si=!((Dt=Kt)<11904||!(qe["Bopomofo Extended"](Dt)||qe.Bopomofo(Dt)||qe["CJK Compatibility Forms"](Dt)||qe["CJK Compatibility Ideographs"](Dt)||qe["CJK Compatibility"](Dt)||qe["CJK Radicals Supplement"](Dt)||qe["CJK Strokes"](Dt)||qe["CJK Symbols and Punctuation"](Dt)||qe["CJK Unified Ideographs Extension A"](Dt)||qe["CJK Unified Ideographs"](Dt)||qe["Enclosed CJK Letters and Months"](Dt)||qe["Halfwidth and Fullwidth Forms"](Dt)||qe.Hiragana(Dt)||qe["Ideographic Description Characters"](Dt)||qe["Kangxi Radicals"](Dt)||qe["Katakana Phonetic Extensions"](Dt)||qe.Katakana(Dt)||qe["Vertical Forms"](Dt)||qe["Yi Radicals"](Dt)||qe["Yi Syllables"](Dt)));(mM[Kt]||Si||ri.imageName)&&zt.push(q5(Zt+1,Xt,Jt,zt,gM(Kt,Ge.getCodePoint(Zt+1),Si&&Ot),!1))}}var Dt;return $5(q5(Ge.length(),Xt,Jt,zt,0,!0))}(q,w,d,e,s,N),{processBidirectionalText:ve,processStyledBidirectionalText:be}=un;if(ve&&q.sections.length===1){let Ge=ve(q.toString(),oe);for(let it of Ge){let ot=new Dm;ot.text=it,ot.sections=q.sections;for(let _t=0;_t<it.length;_t++)ot.sectionIndex.push(0);Z.push(ot)}}else if(be){let Ge=be(q.text,q.sectionIndex,oe);for(let it of Ge){let ot=new Dm;ot.text=it[0],ot.sectionIndex=it[1],ot.sections=q.sections,Z.push(ot)}}else Z=function(Ge,it){let ot=[],_t=Ge.text,Mt=0;for(let At of it)ot.push(Ge.substring(Mt,At)),Mt=At;return Mt<_t.length&&ot.push(Ge.substring(Mt,_t.length)),ot}(q,oe);let we=[],$e={positionedLines:we,text:q.toString(),top:E[1],bottom:E[1],left:E[0],right:E[0],writingMode:k,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Ge,it,ot,_t,Mt,At,zt,Jt,Ot,Xt,Dt,Zt){let ri=0,Kt=0,Si=0,ei=Jt==="right"?1:Jt==="left"?0:.5,li=!1;for(let mr of Mt){let er=mr.getSections();for(let br of er){if(br.imageName)continue;let gr=it[br.fontStack];if(gr&&(li=gr.ascender!==void 0&&gr.descender!==void 0,!li))break}if(!li)break}let Xi=0;for(let mr of Mt){mr.trim();let er=mr.getMaxScale(),br=(er-1)*ts,gr={positionedGlyphs:[],lineOffset:0};Ge.positionedLines[Xi]=gr;let Dr=gr.positionedGlyphs,Ji=0;if(!mr.length()){Kt+=At,++Xi;continue}let gn=0,mn=0;for(let Hr=0;Hr<mr.length();Hr++){let Yr=mr.getSection(Hr),Pn=mr.getSectionIndex(Hr),wn=mr.getCodePoint(Hr),da=Yr.scale,la=null,ys=null,Da=null,Jn=ts,oo=0,Ho=!(Ot===Ic.horizontal||!Dt&&!qt(wn)||Dt&&(B_[wn]||(zi=wn,qe.Arabic(zi)||qe["Arabic Supplement"](zi)||qe["Arabic Extended-A"](zi)||qe["Arabic Presentation Forms-A"](zi)||qe["Arabic Presentation Forms-B"](zi))));if(Yr.imageName){let Go=_t[Yr.imageName];if(!Go)continue;Da=Yr.imageName,Ge.iconsInText=Ge.iconsInText||!0,ys=Go.paddedRect;let Cn=Go.displaySize;da=da*ts/Zt,la={width:Cn[0],height:Cn[1],left:0,top:-H5,advance:Ho?Cn[1]:Cn[0],localGlyph:!1},oo=li?-la.height*da:er*ts-17-Cn[1]*da,Jn=la.advance;let nl=(Ho?Cn[0]:Cn[1])*da-ts*er;nl>0&&nl>Ji&&(Ji=nl)}else{let Go=ot[Yr.fontStack];if(!Go)continue;Go[wn]&&(ys=Go[wn]);let Cn=it[Yr.fontStack];if(!Cn)continue;let nl=Cn.glyphs[wn];if(!nl)continue;if(la=nl.metrics,Jn=wn!==8203?ts:0,li){let Cd=Cn.ascender!==void 0?Math.abs(Cn.ascender):0,ou=Cn.descender!==void 0?Math.abs(Cn.descender):0,Xu=(Cd+ou)*da;gn<Xu&&(gn=Xu,mn=(Cd-ou)/2*da),oo=-Cd*da}else oo=(er-da)*ts-17}Ho?(Ge.verticalizable=!0,Dr.push({glyph:wn,imageName:Da,x:ri,y:Kt+oo,vertical:Ho,scale:da,localGlyph:la.localGlyph,fontStack:Yr.fontStack,sectionIndex:Pn,metrics:la,rect:ys}),ri+=Jn*da+Xt):(Dr.push({glyph:wn,imageName:Da,x:ri,y:Kt+oo,vertical:Ho,scale:da,localGlyph:la.localGlyph,fontStack:Yr.fontStack,sectionIndex:Pn,metrics:la,rect:ys}),ri+=la.advance*da+Xt)}Dr.length!==0&&(Si=Math.max(ri-Xt,Si),li?X5(Dr,ei,Ji,mn,At*er/2):X5(Dr,ei,Ji,0,At/2)),ri=0;let Zr=At*er+Ji;gr.lineOffset=Math.max(Ji,br),Kt+=Zr,++Xi}var zi;let Oi=Kt,{horizontalAlign:ai,verticalAlign:Yi}=$v(zt);(function(mr,er,br,gr,Dr,Ji){let gn=(er-br)*Dr,mn=-Ji*gr;for(let Zr of mr)for(let Hr of Zr.positionedGlyphs)Hr.x+=gn,Hr.y+=mn})(Ge.positionedLines,ei,ai,Yi,Si,Oi),Ge.top+=-Yi*Oi,Ge.bottom=Ge.top+Oi,Ge.left+=-ai*Si,Ge.right=Ge.left+Si,Ge.hasBaseline=li}($e,e,r,s,Z,p,_,v,k,w,D,B),!function(Ge){for(let it of Ge)if(it.positionedGlyphs.length!==0)return!1;return!0}(we)&&$e}let B_={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},mM={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function G5(t,e,r,s,u,d){if(e.imageName){let p=s[e.imageName];return p?p.displaySize[0]*e.scale*ts/d+u:0}{let p=r[e.fontStack],_=p&&p.glyphs[t];return _?_.metrics.advance*e.scale+u:0}}function W5(t,e,r,s){let u=Math.pow(t-e,2);return s?t<e?u/2:2*u:u+Math.abs(r)*r}function gM(t,e,r){let s=0;return t===10&&(s-=1e4),r&&(s+=150),t!==40&&t!==65288||(s+=50),e!==41&&e!==65289||(s+=50),s}function q5(t,e,r,s,u,d){let p=null,_=W5(e,r,u,d);for(let v of s){let w=W5(e-v.x,r,u,d)+v.badness;w<=_&&(p=v,_=w)}return{index:t,x:e,priorBreak:p,badness:_}}function $5(t){return t?$5(t.priorBreak).concat(t.index):[]}function $v(t){let e=.5,r=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function X5(t,e,r,s,u){if(!(e||r||s||u))return;let d=t.length-1,p=t[d],_=(p.x+p.metrics.advance*p.scale)*e;for(let v=0;v<=d;v++)t[v].x-=_,t[v].y+=r+s+u}function _M(t,e,r,s){let{horizontalAlign:u,verticalAlign:d}=$v(s),p=r[0]-t.displaySize[0]*u,_=r[1]-t.displaySize[1]*d;return{imagePrimary:t,imageSecondary:e,top:_,bottom:_+t.displaySize[1],left:p,right:p+t.displaySize[0]}}function Z5(t,e,r,s,u,d){let p=t.imagePrimary,_;if(p.content){let Z=p.content,oe=p.pixelRatio||1;_=[Z[0]/oe,Z[1]/oe,p.displaySize[0]-Z[2]/oe,p.displaySize[1]-Z[3]/oe]}let v=e.left*d,w=e.right*d,E,k,D,N;r==="width"||r==="both"?(N=u[0]+v-s[3],k=u[0]+w+s[1]):(N=u[0]+(v+w-p.displaySize[0])/2,k=N+p.displaySize[0]);let B=e.top*d,q=e.bottom*d;return r==="height"||r==="both"?(E=u[1]+B-s[0],D=u[1]+q+s[2]):(E=u[1]+(B+q-p.displaySize[1])/2,D=E+p.displaySize[1]),{imagePrimary:p,imageSecondary:void 0,top:E,right:k,bottom:D,left:N,collisionPadding:_}}class Ad extends hi{constructor(e,r,s,u,d){super(e,r),this.angle=u,this.z=s,d!==void 0&&(this.segment=d)}clone(){return new Ad(this.x,this.y,this.z,this.angle,this.segment)}}function Y5(t,e,r,s,u){if(e.segment===void 0)return!0;let d=e,p=e.segment+1,_=0;for(;_>-r/2;){if(p--,p<0)return!1;_-=t[p].dist(d),d=t[p]}_+=t[p].dist(t[p+1]),p++;let v=[],w=0;for(;_<r/2;){let E=t[p],k=t[p+1];if(!k)return!1;let D=t[p-1].angleTo(E)-E.angleTo(k);for(D=Math.abs((D+3*Math.PI)%(2*Math.PI)-Math.PI),v.push({distance:_,angleDelta:D}),w+=D;_-v[0].distance>s;)w-=v.shift().angleDelta;if(w>u)return!1;p++,_+=E.dist(k)}return!0}function K5(t){let e=0;for(let r=0;r<t.length-1;r++)e+=t[r].dist(t[r+1]);return e}function J5(t,e,r){return t?.6*e*r:0}function Q5(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function xM(t,e,r,s,u,d){let p=J5(r,u,d),_=Q5(r,s)*d,v=0,w=K5(t)/2;for(let E=0;E<t.length-1;E++){let k=t[E],D=t[E+1],N=k.dist(D);if(v+N>w){let B=(w-v)/N,q=$i(k.x,D.x,B),Z=$i(k.y,D.y,B),oe=new Ad(q,Z,0,D.angleTo(k),E);return!p||Y5(t,oe,_,p,e)?oe:void 0}v+=N}}function vM(t,e,r,s,u,d,p,_,v){let w=J5(s,d,p),E=Q5(s,u),k=E*p,D=t[0].x===0||t[0].x===v||t[0].y===0||t[0].y===v;return e-k<e/4&&(e=k+e/4),eT(t,D?e/2*_%e:(E/2+2*d)*p*_%e,e,w,r,k,D,!1,v)}function eT(t,e,r,s,u,d,p,_,v){let w=d/2,E=K5(t),k=0,D=e-r,N=[];for(let B=0;B<t.length-1;B++){let q=t[B],Z=t[B+1],oe=q.dist(Z),ve=Z.angleTo(q);for(;D+r<k+oe;){D+=r;let be=(D-k)/oe,we=$i(q.x,Z.x,be),$e=$i(q.y,Z.y,be);if(we>=0&&we<v&&$e>=0&&$e<v&&D-w>=0&&D+w<=E){let Ge=new Ad(we,$e,0,ve,B);s&&!Y5(t,Ge,d,s,u)||N.push(Ge)}}k+=oe}return _||N.length||p||(N=eT(t,k/2,r,s,u,d,p,!0,v)),N}function tT(t,e,r,s,u){let d=[];for(let p=0;p<t.length;p++){let _=t[p],v;for(let w=0;w<_.length-1;w++){let E=_[w],k=_[w+1];E.x<e&&k.x<e||(E.x<e?E=new hi(e,E.y+(e-E.x)/(k.x-E.x)*(k.y-E.y))._round():k.x<e&&(k=new hi(e,E.y+(e-E.x)/(k.x-E.x)*(k.y-E.y))._round()),E.y<r&&k.y<r||(E.y<r?E=new hi(E.x+(r-E.y)/(k.y-E.y)*(k.x-E.x),r)._round():k.y<r&&(k=new hi(E.x+(r-E.y)/(k.y-E.y)*(k.x-E.x),r)._round()),E.x>=s&&k.x>=s||(E.x>=s?E=new hi(s,E.y+(s-E.x)/(k.x-E.x)*(k.y-E.y))._round():k.x>=s&&(k=new hi(s,E.y+(s-E.x)/(k.x-E.x)*(k.y-E.y))._round()),E.y>=u&&k.y>=u||(E.y>=u?E=new hi(E.x+(u-E.y)/(k.y-E.y)*(k.x-E.x),u)._round():k.y>=u&&(k=new hi(E.x+(u-E.y)/(k.y-E.y)*(k.x-E.x),u)._round()),v&&E.equals(v[v.length-1])||(v=[E],d.push(v)),v.push(k)))))}}return d}function iT(t){let e=0,r=0;for(let p of t)e+=p.w*p.h,r=Math.max(r,p.w);t.sort((p,_)=>_.h-p.h);let s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}],u=0,d=0;for(let p of t)for(let _=s.length-1;_>=0;_--){let v=s[_];if(!(p.w>v.w||p.h>v.h)){if(p.x=v.x,p.y=v.y,d=Math.max(d,p.y+p.h),u=Math.max(u,p.x+p.w),p.w===v.w&&p.h===v.h){let w=s.pop();_<s.length&&(s[_]=w)}else p.h===v.h?(v.x+=p.w,v.w-=p.w):p.w===v.w?(v.y+=p.h,v.h-=p.h):(s.push({x:v.x+p.w,y:v.y,w:v.w-p.w,h:p.h}),v.y+=p.h,v.h-=p.h);break}}return{w:u,h:d,fill:e/(u*d)||0}}Pe(Ad,"Anchor");let ql=1;class Xv{constructor(e,{pixelRatio:r,version:s,stretchX:u,stretchY:d,content:p}){this.paddedRect=e,this.pixelRatio=r,this.stretchX=u,this.stretchY=d,this.content=p,this.version=s}get tl(){return[this.paddedRect.x+ql,this.paddedRect.y+ql]}get br(){return[this.paddedRect.x+this.paddedRect.w-ql,this.paddedRect.y+this.paddedRect.h-ql]}get displaySize(){return[(this.paddedRect.w-2*ql)/this.pixelRatio,(this.paddedRect.h-2*ql)/this.pixelRatio]}}class rT{constructor(e,r,s){let u={},d={};this.haveRenderCallbacks=[];let p=[];this.addImages(e,u,p),this.addImages(r,d,p);let{w:_,h:v}=iT(p),w=new Cc({width:_||1,height:v||1});for(let E in e){let k=e[E],D=u[E].paddedRect;Cc.copy(k.data,w,{x:0,y:0},{x:D.x+ql,y:D.y+ql},k.data,s,k.sdf)}for(let E in r){let k=r[E],D=d[E].paddedRect,N=D.x+ql,B=D.y+ql,q=k.data.width,Z=k.data.height;Cc.copy(k.data,w,{x:0,y:0},{x:N,y:B},k.data,s),Cc.copy(k.data,w,{x:0,y:Z-1},{x:N,y:B-1},{width:q,height:1},s),Cc.copy(k.data,w,{x:0,y:0},{x:N,y:B+Z},{width:q,height:1},s),Cc.copy(k.data,w,{x:q-1,y:0},{x:N-1,y:B},{width:1,height:Z},s),Cc.copy(k.data,w,{x:0,y:0},{x:N+q,y:B},{width:1,height:Z},s)}this.image=w,this.iconPositions=u,this.patternPositions=d}addImages(e,r,s){for(let u in e){let d=e[u],p={x:0,y:0,w:d.data.width+2*ql,h:d.data.height+2*ql};s.push(p),r[u]=new Xv(p,d),d.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(e,r,s){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(u=>e.hasImage(u,s)),e.dispatchRenderCallbacks(this.haveRenderCallbacks,s);for(let u in e.getUpdatedImages(s))this.patchUpdatedImage(this.iconPositions[u],e.getImage(u,s),r),this.patchUpdatedImage(this.patternPositions[u],e.getImage(u,s),r)}patchUpdatedImage(e,r,s){if(!e||!r||e.version===r.version)return;e.version=r.version;let[u,d]=e.tl,p=!!Object.keys(this.patternPositions).length;s.update(r.data,{useMipmap:p},{x:u,y:d})}}Pe(Xv,"ImagePosition"),Pe(rT,"ImageAtlas");let eg=1e20;function nT(t,e,r,s,u,d,p,_,v){for(let w=e;w<e+s;w++)aT(t,r*d+w,d,u,p,_,v);for(let w=r;w<r+u;w++)aT(t,w*d+e,1,s,p,_,v)}function aT(t,e,r,s,u,d,p){d[0]=0,p[0]=-eg,p[1]=eg,u[0]=t[e];for(let _=1,v=0,w=0;_<s;_++){u[_]=t[e+_*r];let E=_*_;do{let k=d[v];w=(u[_]-u[k]+E-k*k)/(_-k)/2}while(w<=p[v]&&--v>-1);v++,d[v]=_,p[v]=w,p[v+1]=eg}for(let _=0,v=0;_<s;_++){for(;p[v+1]<_;)v++;let w=d[v],E=_-w;t[e+_*r]=u[w]+E*E}}let Uu=2,Zv={none:0,ideographs:1,all:2};class Fm{constructor(e,r,s){this.requestManager=e,this.localGlyphMode=r,this.localFontFamily=s,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e,r){this.urls[r]=e}getGlyphs(e,r,s){let u=[],d=this.urls[r]||A.GLYPHS_URL;for(let p in e)for(let _ of e[p])u.push({stack:p,id:_});cc(u,({stack:p,id:_},v)=>{let w=this.entries[p];w||(w=this.entries[p]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let E=w.glyphs[_];if(E!==void 0)return void v(null,{stack:p,id:_,glyph:E});if(E=this._tinySDF(w,p,_),E)return w.glyphs[_]=E,void v(null,{stack:p,id:_,glyph:E});let k=Math.floor(_/256);if(256*k>65535)return void v(new Error("glyphs > 65535 not supported"));if(w.ranges[k])return void v(null,{stack:p,id:_,glyph:E});let D=w.requests[k];D||(D=w.requests[k]=[],Fm.loadGlyphRange(p,k,d,this.requestManager,(N,B)=>{if(B){w.ascender=B.ascender,w.descender=B.descender;for(let q in B.glyphs)this._doesCharSupportLocalGlyph(+q)||(w.glyphs[+q]=B.glyphs[+q]);w.ranges[k]=!0}for(let q of D)q(N,B);delete w.requests[k]})),D.push((N,B)=>{N?v(N):B&&v(null,{stack:p,id:_,glyph:B.glyphs[_]||null})})},(p,_)=>{if(p)s(p);else if(_){let v={};for(let{stack:w,id:E,glyph:k}of _)v[w]===void 0&&(v[w]={}),v[w].glyphs===void 0&&(v[w].glyphs={}),v[w].glyphs[E]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics},v[w].ascender=this.entries[w].ascender,v[w].descender=this.entries[w].descender;s(null,v)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==Zv.none&&(this.localGlyphMode===Zv.all?!!this.localFontFamily:!!this.localFontFamily&&(qe["CJK Unified Ideographs"](e)||qe["Hangul Syllables"](e)||qe.Hiragana(e)||qe.Katakana(e)||qe["CJK Symbols and Punctuation"](e)||qe["CJK Unified Ideographs Extension A"](e)||qe["CJK Unified Ideographs Extension B"](e)))}_tinySDF(e,r,s){let u=this.localFontFamily;if(!u||!this._doesCharSupportLocalGlyph(s))return;let d=e.tinySDF;if(!d){let q="400";/bold/i.test(r)?q="900":/medium/i.test(r)?q="500":/light/i.test(r)&&(q="200"),d=e.tinySDF=new Fm.TinySDF({fontFamily:u,fontWeight:q,fontSize:24*Uu,buffer:3*Uu,radius:8*Uu}),d.fontWeight=q}if(this.localGlyphs[d.fontWeight][s])return this.localGlyphs[d.fontWeight][s];let p=String.fromCodePoint(s),{data:_,width:v,height:w,glyphWidth:E,glyphHeight:k,glyphLeft:D,glyphTop:N,glyphAdvance:B}=d.draw(p);return this.localGlyphs[d.fontWeight][s]={id:s,bitmap:new yf({width:v,height:w},_),metrics:{width:E/Uu,height:k/Uu,left:D/Uu,top:N/Uu-27,advance:B/Uu,localGlyph:!0}}}}Fm.loadGlyphRange=function(t,e,r,s,u){let d=256*e,p=d+255,_=s.transformRequest(s.normalizeGlyphsURL(r).replace("{fontstack}",t).replace("{range}",`${d}-${p}`),fc.Glyphs);ro(_,(v,w)=>{if(v)u(v);else if(w){let E={},k=function(D){return new km(D).readFields(dM,{})}(w);for(let D of k.glyphs)E[D.id]=D;u(null,{glyphs:E,ascender:k.ascender,descender:k.descender})}})},Fm.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:r=8,cutoff:s=.25,fontFamily:u="sans-serif",fontWeight:d="normal",fontStyle:p="normal"}={}){this.buffer=e,this.cutoff=s,this.radius=r;let _=this.size=t+4*e,v=this._createCanvas(_),w=this.ctx=v.getContext("2d",{willReadFrequently:!0});w.font=`${p} ${d} ${t}px ${u}`,w.textBaseline="alphabetic",w.textAlign="left",w.fillStyle="black",this.gridOuter=new Float64Array(_*_),this.gridInner=new Float64Array(_*_),this.f=new Float64Array(_),this.z=new Float64Array(_+1),this.v=new Uint16Array(_)}_createCanvas(t){let e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){let{width:e,actualBoundingBoxAscent:r,actualBoundingBoxDescent:s,actualBoundingBoxLeft:u,actualBoundingBoxRight:d}=this.ctx.measureText(t),p=Math.ceil(r),_=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(d-u))),v=Math.min(this.size-this.buffer,p+Math.ceil(s)),w=_+2*this.buffer,E=v+2*this.buffer,k=Math.max(w*E,0),D=new Uint8ClampedArray(k),N={data:D,width:w,height:E,glyphWidth:_,glyphHeight:v,glyphTop:p,glyphLeft:0,glyphAdvance:e};if(_===0||v===0)return N;let{ctx:B,buffer:q,gridInner:Z,gridOuter:oe}=this;B.clearRect(q,q,_,v),B.fillText(t,q,q+p);let ve=B.getImageData(q,q,_,v);oe.fill(eg,0,k),Z.fill(0,0,k);for(let be=0;be<v;be++)for(let we=0;we<_;we++){let $e=ve.data[4*(be*_+we)+3]/255;if($e===0)continue;let Ge=(be+q)*w+we+q;if($e===1)oe[Ge]=0,Z[Ge]=eg;else{let it=.5-$e;oe[Ge]=it>0?it*it:0,Z[Ge]=it<0?it*it:0}}nT(oe,0,0,w,E,w,this.f,this.v,this.z),nT(Z,q,q,_,v,w,this.f,this.v,this.z);for(let be=0;be<k;be++){let we=Math.sqrt(oe[be])-Math.sqrt(Z[be]);D[be]=Math.round(255-255*(we/this.radius+this.cutoff))}return N}};let Tf=ql;function oT(t,e,r,s){let u=[],d=t.imagePrimary,p=d.pixelRatio,_=d.paddedRect.w-2*Tf,v=d.paddedRect.h-2*Tf,w=t.right-t.left,E=t.bottom-t.top,k=d.stretchX||[[0,_]],D=d.stretchY||[[0,v]],N=(At,zt)=>At+zt[1]-zt[0],B=k.reduce(N,0),q=D.reduce(N,0),Z=_-B,oe=v-q,ve=0,be=B,we=0,$e=q,Ge=0,it=Z,ot=0,_t=oe;if(d.content&&s){let At=d.content;ve=z_(k,0,At[0]),we=z_(D,0,At[1]),be=z_(k,At[0],At[2]),$e=z_(D,At[1],At[3]),Ge=At[0]-ve,ot=At[1]-we,it=At[2]-At[0]-be,_t=At[3]-At[1]-$e}let Mt=(At,zt,Jt,Ot)=>{let Xt=j_(At.stretch-ve,be,w,t.left),Dt=V_(At.fixed-Ge,it,At.stretch,B),Zt=j_(zt.stretch-we,$e,E,t.top),ri=V_(zt.fixed-ot,_t,zt.stretch,q),Kt=j_(Jt.stretch-ve,be,w,t.left),Si=V_(Jt.fixed-Ge,it,Jt.stretch,B),ei=j_(Ot.stretch-we,$e,E,t.top),li=V_(Ot.fixed-ot,_t,Ot.stretch,q),Xi=new hi(Xt,Zt),zi=new hi(Kt,Zt),Oi=new hi(Kt,ei),ai=new hi(Xt,ei),Yi=new hi(Dt/p,ri/p),mr=new hi(Si/p,li/p),er=e*Math.PI/180;if(er){let mn=Math.sin(er),Zr=Math.cos(er),Hr=[Zr,-mn,mn,Zr];Xi._matMult(Hr),zi._matMult(Hr),ai._matMult(Hr),Oi._matMult(Hr)}let br=At.stretch+At.fixed,gr=Jt.stretch+Jt.fixed,Dr=zt.stretch+zt.fixed,Ji=Ot.stretch+Ot.fixed,gn=t.imageSecondary;return{tl:Xi,tr:zi,bl:ai,br:Oi,texPrimary:{x:d.paddedRect.x+Tf+br,y:d.paddedRect.y+Tf+Dr,w:gr-br,h:Ji-Dr},texSecondary:gn?{x:gn.paddedRect.x+Tf+br,y:gn.paddedRect.y+Tf+Dr,w:gr-br,h:Ji-Dr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Yi,pixelOffsetBR:mr,minFontScaleX:it/p/w,minFontScaleY:_t/p/E,isSDF:r}};if(s&&(d.stretchX||d.stretchY)){let At=sT(k,Z,B),zt=sT(D,oe,q);for(let Jt=0;Jt<At.length-1;Jt++){let Ot=At[Jt],Xt=At[Jt+1];for(let Dt=0;Dt<zt.length-1;Dt++)u.push(Mt(Ot,zt[Dt],Xt,zt[Dt+1]))}}else u.push(Mt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:_+1},{fixed:0,stretch:v+1}));return u}function z_(t,e,r){let s=0;for(let u of t)s+=Math.max(e,Math.min(r,u[1]))-Math.max(e,Math.min(r,u[0]));return s}function sT(t,e,r){let s=[{fixed:-Tf,stretch:0}];for(let[u,d]of t){let p=s[s.length-1];s.push({fixed:u-p.stretch,stretch:p.stretch}),s.push({fixed:u-p.stretch,stretch:p.stretch+(d-u)})}return s.push({fixed:e+Tf,stretch:r}),s}function j_(t,e,r,s){return t/e*r+s}function V_(t,e,r,s){return t-e*r/s}function yM(t,e,r,s){let u=e+t.positionedLines[s].lineOffset;return s===0?r+u/2:r+(u+(e+t.positionedLines[s-1].lineOffset))/2}function bM(t,e=1,r=!1){let s=1/0,u=1/0,d=-1/0,p=-1/0,_=t[0];for(let N=0;N<_.length;N++){let B=_[N];(!N||B.x<s)&&(s=B.x),(!N||B.y<u)&&(u=B.y),(!N||B.x>d)&&(d=B.x),(!N||B.y>p)&&(p=B.y)}let v=Math.min(d-s,p-u),w=v/2,E=new St([],wM);if(v===0)return new hi(s,u);for(let N=s;N<d;N+=v)for(let B=u;B<p;B+=v)E.push(new Pm(N+w,B+w,w,t));let k=function(N){let B=0,q=0,Z=0,oe=N[0];for(let ve=0,be=oe.length,we=be-1;ve<be;we=ve++){let $e=oe[ve],Ge=oe[we],it=$e.x*Ge.y-Ge.x*$e.y;q+=($e.x+Ge.x)*it,Z+=($e.y+Ge.y)*it,B+=3*it}return new Pm(q/B,Z/B,0,N)}(t),D=E.length;for(;E.length;){let N=E.pop();(N.d>k.d||!k.d)&&(k=N,r&&console.log("found best %d after %d probes",Math.round(1e4*N.d)/1e4,D)),N.max-k.d<=e||(w=N.h/2,E.push(new Pm(N.p.x-w,N.p.y-w,w,t)),E.push(new Pm(N.p.x+w,N.p.y-w,w,t)),E.push(new Pm(N.p.x-w,N.p.y+w,w,t)),E.push(new Pm(N.p.x+w,N.p.y+w,w,t)),D+=4)}return r&&(console.log(`num probes: ${D}`),console.log(`best distance: ${k.d}`)),k.p}function wM(t,e){return e.max-t.max}class Pm{constructor(e,r,s,u){this.p=new hi(e,r),this.h=s,this.d=function(d,p){let _=!1,v=1/0;for(let w=0;w<p.length;w++){let E=p[w];for(let k=0,D=E.length,N=D-1;k<D;N=k++){let B=E[k],q=E[N];B.y>d.y!=q.y>d.y&&d.x<(q.x-B.x)*(d.y-B.y)/(q.y-B.y)+B.x&&(_=!_),v=Math.min(v,pw(d,B,q))}}return(_?1:-1)*Math.sqrt(v)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}}let Yv=Number.POSITIVE_INFINITY,TM=Math.sqrt(2);function lT(t,[e,r]){let s=0,u=0;if(r===Yv){e<0&&(e=0);let d=e/TM;switch(t){case"top-right":case"top-left":u=d-7;break;case"bottom-right":case"bottom-left":u=7-d;break;case"bottom":u=7-e;break;case"top":u=e-7}switch(t){case"top-right":case"bottom-right":s=-d;break;case"top-left":case"bottom-left":s=d;break;case"left":s=e;break;case"right":s=-e}}else{switch(e=Math.abs(e),r=Math.abs(r),t){case"top-right":case"top-left":case"top":u=r-7;break;case"bottom-right":case"bottom-left":case"bottom":u=7-r}switch(t){case"top-right":case"bottom-right":case"right":s=-e;break;case"top-left":case"bottom-left":case"left":s=e}}return[s,u]}function Kv(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function SM(t,e,r,s,u,d,p,_,v,w,E,k,D,N,B){let q=d.textMaxSize.evaluate(e,{},k);q===void 0&&(q=p);let Z=t.layers[0].layout,oe=Z.get("icon-offset").evaluate(e,{},k),ve=uT(r.horizontal)||r.vertical,be=D.name==="globe",we=ts,$e=p/we,Ge=t.tilePixelRatio*q/we,it=(Xt=t.overscaling,t.zoom>18&&Xt>2&&(Xt>>=1),Math.max(rt/(512*Xt),1)*Z.get("symbol-spacing")),ot=Z.get("text-padding")*t.tilePixelRatio,_t=Z.get("icon-padding")*t.tilePixelRatio,Mt=Tr(Z.get("text-max-angle")),At=Z.get("text-rotation-alignment")==="map"&&Z.get("symbol-placement")!=="point",zt=Z.get("icon-rotation-alignment")==="map"&&Z.get("symbol-placement")!=="point",Jt=Z.get("symbol-placement"),Ot=it/2;var Xt;let Dt=Z.get("icon-text-fit").evaluate(e,{},k),Zt=Z.get("icon-text-fit-padding").evaluate(e,{},k),ri=Dt!=="none",Kt;t.hasAnyIconTextFit===!1&&ri&&(t.hasAnyIconTextFit=!0),s&&ri&&(t.allowVerticalPlacement&&r.vertical&&(Kt=Z5(s,r.vertical,Dt,Zt,oe,$e)),ve&&(s=Z5(s,ve,Dt,Zt,oe,$e)));let Si=(ei,li,Xi)=>{if(li.x<0||li.x>=rt||li.y<0||li.y>=rt)return;let zi=null;if(be){let{x:Oi,y:ai,z:Yi}=D.projectTilePoint(li.x,li.y,Xi);zi={anchor:new Ad(Oi,ai,Yi,0,void 0),up:D.upVector(Xi,li.x,li.y)}}(function(Oi,ai,Yi,mr,er,br,gr,Dr,Ji,gn,mn,Zr,Hr,Yr,Pn,wn,da,la,ys,Da,Jn,oo,Ho,Go,Cn,nl,Cd){let ou=Oi.addToLineVertexArray(ai,mr),Xu,Mf,Df,kp,hS,dS,fS,pS=0,mS=0,gS=0,_S=0,Ay=-1,Cy=-1,Oh={},xS=na(""),Mp=Yi?Yi.anchor:ai,Iy=Ji.layout.get("icon-text-fit").evaluate(Jn,{},Cn)!=="none",ky=0,My=0;if(Ji._unevaluatedLayout.getValue("text-radial-offset")===void 0?[ky,My]=Ji.layout.get("text-offset").evaluate(Jn,{},Cn).map(Xl=>Xl*ts):(ky=Ji.layout.get("text-radial-offset").evaluate(Jn,{},Cn)*ts,My=Yv),Oi.allowVerticalPlacement&&er.vertical){let Xl=er.vertical;if(Pn)dS=Jv(Xl),Dr&&(fS=Jv(Dr));else{let Zl=Ji.layout.get("text-rotate").evaluate(Jn,{},Cn)+90;Df=U_(gn,Mp,ai,mn,Zr,Hr,Xl,Yr,Zl,wn),Dr&&(kp=U_(gn,Mp,ai,mn,Zr,Hr,Dr,la,Zl))}}if(br){let Xl=Ji.layout.get("icon-rotate").evaluate(Jn,{},Cn),Zl=oT(br,Xl,Ho,Iy),Um=Dr?oT(Dr,Xl,Ho,Iy):void 0;Mf=U_(gn,Mp,ai,mn,Zr,Hr,br,la,Xl),pS=4*Zl.length;let vS=Oi.iconSizeData,Dp=null;vS.kind==="source"?(Dp=[Vu*Ji.layout.get("icon-size").evaluate(Jn,{},Cn)],Dp[0]>Sf&&Nn(`${Oi.layerIds[0]}: Value for "icon-size" is >= ${tg}. Reduce your "icon-size".`)):vS.kind==="composite"&&(Dp=[Vu*oo.compositeIconSizes[0].evaluate(Jn,{},Cn),Vu*oo.compositeIconSizes[1].evaluate(Jn,{},Cn)],(Dp[0]>Sf||Dp[1]>Sf)&&Nn(`${Oi.layerIds[0]}: Value for "icon-size" is >= ${tg}. Reduce your "icon-size".`)),Oi.addSymbols(Oi.icon,Zl,Dp,Da,ys,Jn,!1,Yi,ai,ou.lineStartIndex,ou.lineLength,-1,Go,Cn,nl,Cd),Ay=Oi.icon.placedSymbolArray.length-1,Um&&(mS=4*Um.length,Oi.addSymbols(Oi.icon,Um,Dp,Da,ys,Jn,Ic.vertical,Yi,ai,ou.lineStartIndex,ou.lineLength,-1,Go,Cn,nl,Cd),Cy=Oi.icon.placedSymbolArray.length-1)}for(let Xl in er.horizontal){let Zl=er.horizontal[Xl];Xu||(xS=na(Zl.text),Pn?hS=Jv(Zl):Xu=U_(gn,Mp,ai,mn,Zr,Hr,Zl,Yr,Ji.layout.get("text-rotate").evaluate(Jn,{},Cn),wn));let Um=Zl.positionedLines.length===1;if(gS+=cT(Oi,Yi,ai,Zl,gr,Ji,Pn,Jn,wn,ou,er.vertical?Ic.horizontal:Ic.horizontalOnly,Um?Object.keys(er.horizontal):[Xl],Oh,Ay,oo,Go,Cn,nl),Um)break}er.vertical&&(_S+=cT(Oi,Yi,ai,er.vertical,gr,Ji,Pn,Jn,wn,ou,Ic.vertical,["vertical"],Oh,Cy,oo,Go,Cn,nl));let Ff=-1,Dy=(Xl,Zl)=>Xl?Math.max(Xl,Zl):Zl;Ff=Dy(hS,Ff),Ff=Dy(dS,Ff),Ff=Dy(fS,Ff);let HD=Ff>-1?1:0;Oi.glyphOffsetArray.length>=65535&&Nn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Jn.sortKey!==void 0&&Oi.addToSortKeyRanges(Oi.symbolInstances.length,Jn.sortKey),Oi.symbolInstances.emplaceBack(ai.x,ai.y,Mp.x,Mp.y,Mp.z,Oh.right>=0?Oh.right:-1,Oh.center>=0?Oh.center:-1,Oh.left>=0?Oh.left:-1,Oh.vertical>=0?Oh.vertical:-1,Ay,Cy,xS,Xu!==void 0?Xu:Oi.collisionBoxArray.length,Xu!==void 0?Xu+1:Oi.collisionBoxArray.length,Df!==void 0?Df:Oi.collisionBoxArray.length,Df!==void 0?Df+1:Oi.collisionBoxArray.length,Mf!==void 0?Mf:Oi.collisionBoxArray.length,Mf!==void 0?Mf+1:Oi.collisionBoxArray.length,kp||Oi.collisionBoxArray.length,kp?kp+1:Oi.collisionBoxArray.length,mn,gS,_S,pS,mS,HD,0,ky,My,Ff,0,1,1,Iy?1:0)})(t,li,zi,ei,r,s,u,Kt,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,ot,At,v,0,_t,zt,oe,e,d,w,E,k,N,B)};if(Jt==="line")for(let ei of tT(e.geometry,0,0,rt,rt)){let li=vM(ei,it,Mt,r.vertical||ve,s,we,Ge,t.overscaling,rt);for(let Xi of li)ve&&EM(t,ve.text,Ot,Xi)||Si(ei,Xi,k)}else if(Jt==="line-center"){for(let ei of e.geometry)if(ei.length>1){let li=xM(ei,Mt,r.vertical||ve,s,we,Ge);li&&Si(ei,li,k)}}else if(e.type==="Polygon")for(let ei of S_(e.geometry,0)){let li=bM(ei,16);Si(ei[0],new Ad(li.x,li.y,0,0,void 0),k)}else if(e.type==="LineString")for(let ei of e.geometry)Si(ei,new Ad(ei[0].x,ei[0].y,0,0,void 0),k);else if(e.type==="Point")for(let ei of e.geometry)for(let li of ei)Si([li],new Ad(li.x,li.y,0,0,void 0),k)}let tg=255,Sf=tg*Vu;function cT(t,e,r,s,u,d,p,_,v,w,E,k,D,N,B,q,Z,oe){let ve=function($e,Ge,it,ot,_t,Mt,At,zt){let Jt=[];if(Ge.positionedLines.length===0)return Jt;let Ot=ot.layout.get("text-rotate").evaluate(Mt,{})*Math.PI/180,Xt=function(Si){let ei=Si[0],li=Si[1],Xi=ei*li;return Xi>0?[ei,-li]:Xi<0?[-ei,li]:ei===0?[li,ei]:[li,-ei]}(it),Dt=Math.abs(Ge.top-Ge.bottom);for(let Si of Ge.positionedLines)Dt-=Si.lineOffset;let Zt=Ge.positionedLines.length,ri=Dt/Zt,Kt=Ge.top-it[1];for(let Si=0;Si<Zt;++Si){let ei=Ge.positionedLines[Si];Kt=yM(Ge,ri,Kt,Si);for(let li of ei.positionedGlyphs){if(!li.rect)continue;let Xi=li.rect||{},zi=H5+1,Oi=!0,ai=1,Yi=0;if(li.imageName){let Da=At[li.imageName];if(!Da)continue;if(Da.sdf){Nn("SDF images are not supported in formatted text and will be ignored.");continue}Oi=!1,ai=Da.pixelRatio,zi=ql/ai}let mr=(_t||zt)&&li.vertical,er=li.metrics.advance*li.scale/2,br=li.metrics,gr=li.rect;if(gr===null)continue;zt&&Ge.verticalizable&&(Yi=li.imageName?er-li.metrics.width*li.scale/2:0);let Dr=_t?[li.x+er,li.y]:[0,0],Ji=[0,0],gn=[0,0],mn=!1;_t||(mr?(gn=[li.x+er+Xt[0],li.y+Xt[1]-Yi],mn=!0):Ji=[li.x+er+it[0],li.y+it[1]-Yi]);let Zr=gr.w*li.scale/(ai*(li.localGlyph?Uu:1)),Hr=gr.h*li.scale/(ai*(li.localGlyph?Uu:1)),Yr,Pn,wn,da;if(mr){let Da=li.y-Kt,Jn=new hi(-er,er-Da),oo=-Math.PI/2,Ho=new hi(...gn);Yr=new hi(-er+Ji[0],Ji[1]),Yr._rotateAround(oo,Jn)._add(Ho),Yr.x+=-Da+er,Yr.y-=(br.left-zi)*li.scale;let Go=li.imageName?br.advance*li.scale:ts*li.scale,Cn=String.fromCodePoint(li.glyph);uM(Cn)?Yr.x+=(1-zi)*li.scale:hM(Cn)?Yr.x+=Go-br.height*li.scale+(-zi-1)*li.scale:Yr.x+=li.imageName||br.width+2*zi===gr.w&&br.height+2*zi===gr.h?(Go-Hr)/2:(Go-(br.height+2*zi)*li.scale)/2,Pn=new hi(Yr.x,Yr.y-Zr),wn=new hi(Yr.x+Hr,Yr.y),da=new hi(Yr.x+Hr,Yr.y-Zr)}else{let Da=(br.left-zi)*li.scale-er+Ji[0],Jn=(-br.top-zi)*li.scale+Ji[1],oo=Da+Zr,Ho=Jn+Hr;Yr=new hi(Da,Jn),Pn=new hi(oo,Jn),wn=new hi(Da,Ho),da=new hi(oo,Ho)}if(Ot){let Da;Da=_t?new hi(0,0):mn?new hi(Xt[0],Xt[1]):new hi(it[0],it[1]),Yr._rotateAround(Ot,Da),Pn._rotateAround(Ot,Da),wn._rotateAround(Ot,Da),da._rotateAround(Ot,Da)}let la=new hi(0,0),ys=new hi(0,0);Jt.push({tl:Yr,tr:Pn,bl:wn,br:da,texPrimary:Xi,texSecondary:void 0,writingMode:Ge.writingMode,glyphOffset:Dr,sectionIndex:li.sectionIndex,isSDF:Oi,pixelOffsetTL:la,pixelOffsetBR:ys,minFontScaleX:0,minFontScaleY:0})}}return Jt}(0,s,v,d,p,_,u,t.allowVerticalPlacement),be=t.textSizeData,we=null;be.kind==="source"?(we=[Vu*d.layout.get("text-size").evaluate(_,{},Z)],we[0]>Sf&&Nn(`${t.layerIds[0]}: Value for "text-size" is >= ${tg}. Reduce your "text-size".`)):be.kind==="composite"&&(we=[Vu*B.compositeTextSizes[0].evaluate(_,{},Z),Vu*B.compositeTextSizes[1].evaluate(_,{},Z)],(we[0]>Sf||we[1]>Sf)&&Nn(`${t.layerIds[0]}: Value for "text-size" is >= ${tg}. Reduce your "text-size".`)),t.addSymbols(t.text,ve,we,v,p,_,E,e,r,w.lineStartIndex,w.lineLength,N,q,Z,oe,!1);for(let $e of k)D[$e]=t.text.placedSymbolArray.length-1;return 4*ve.length}function uT(t){for(let e in t)return t[e];return null}function U_(t,e,r,s,u,d,p,_,v,w){let E=p.top,k=p.bottom,D=p.left,N=p.right,B=p.collisionPadding;if(B&&(D-=B[0],E-=B[1],N+=B[2],k+=B[3]),v){let q=new hi(D,E),Z=new hi(N,E),oe=new hi(D,k),ve=new hi(N,k),be=Tr(v),we=new hi(0,0);w&&(we=new hi(w[0],w[1])),q._rotateAround(be,we),Z._rotateAround(be,we),oe._rotateAround(be,we),ve._rotateAround(be,we),D=Math.min(q.x,Z.x,oe.x,ve.x),N=Math.max(q.x,Z.x,oe.x,ve.x),E=Math.min(q.y,Z.y,oe.y,ve.y),k=Math.max(q.y,Z.y,oe.y,ve.y)}return t.emplaceBack(e.x,e.y,e.z,r.x,r.y,D,E,N,k,_,s,u,d),t.length-1}function Jv(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);let e=t.bottom-t.top;return e>0?Math.max(10,e):null}function EM(t,e,r,s){let u=t.compareText;if(e in u){let d=u[e];for(let p=d.length-1;p>=0;p--)if(s.dist(d[p])<r)return!0}else u[e]=[];return u[e].push(s),!1}function hT(t,e){let r=t.fovAboveCenter,s=t.elevation?t.elevation.getMinElevationBelowMSL()*e:0,u=(t._camera.position[2]*t.worldSize-s)/Math.cos(t._pitch),d=Math.sin(r)*u/Math.sin(Math.max(Math.PI/2-t._pitch-r,.01)),p=Math.sin(t._pitch)*d+u;return Math.min(1.01*p,u*(1/t._horizonShift))}function Sp(t,e){if(!e.isReprojectedInTileSpace)return{scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};let r=Math.pow(2,-t.z),s=t.x*r,u=(t.x+1)*r,d=t.y*r,p=(t.y+1)*r,_=El(s),v=El(u),w=Uo(d),E=Uo(p),k=e.project(_,w),D=e.project(v,w),N=e.project(v,E),B=e.project(_,E),q=Math.min(k.x,D.x,N.x,B.x),Z=Math.min(k.y,D.y,N.y,B.y),oe=Math.max(k.x,D.x,N.x,B.x),ve=Math.max(k.y,D.y,N.y,B.y),be=r/16;function we(Ge,it,ot,_t,Mt,At){let zt=(ot+Mt)/2,Jt=(_t+At)/2,Ot=e.project(El(zt),Uo(Jt)),Xt=Math.max(0,q-Ot.x,Z-Ot.y,Ot.x-oe,Ot.y-ve);q=Math.min(q,Ot.x),oe=Math.max(oe,Ot.x),Z=Math.min(Z,Ot.y),ve=Math.max(ve,Ot.y),Xt>be&&(we(Ge,Ot,ot,_t,zt,Jt),we(Ot,it,zt,Jt,Mt,At))}we(k,D,s,d,u,d),we(D,N,u,d,u,p),we(N,B,u,p,s,p),we(B,k,s,p,s,d),q-=be,Z-=be,oe+=be,ve+=be;let $e=1/Math.max(oe-q,ve-Z);return{scale:$e,x:q*$e,y:Z*$e,x2:oe*$e,y2:ve*$e,projection:e}}function dT(t,{x:e,y:r},s=0){return new hi(((e-s)*t.scale-t.x)*rt,(r*t.scale-t.y)*rt)}let AM=i.ad.identity(new Float32Array(16));class Ef{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,r){return{x:0,y:0,z:0}}unproject(e,r){return new Xr(0,0)}projectTilePoint(e,r,s){return{x:e,y:r,z:0}}locationPoint(e,r,s=!0){return e._coordinatePoint(e.locationCoordinate(r),s)}pixelsPerMeter(e,r){return rl(1,e)*r}pixelSpaceConversion(e,r,s){return 1}farthestPixelDistance(e){return hT(e,e.pixelsPerMeter)}pointCoordinate(e,r,s,u){let d=e.horizonLineFromTop(!1),p=new hi(r,Math.max(d,s));return e.rayIntersectionCoordinate(e.pointRayIntersection(p,u))}pointCoordinate3D(e,r,s){let u=new hi(r,s);if(e.elevation)return e.elevation.pointCoordinate(u);{let d=this.pointCoordinate(e,u.x,u.y,0);return[d.x,d.y,d.z]}}isPointAboveHorizon(e,r){if(e.elevation&&e.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(e,r.x,r.y);let s=e.horizonLineFromTop();return r.y<s}createInversionMatrix(e,r){return AM}createTileMatrix(e,r,s){let u,d,p,_=s.canonical,v=i.ad.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){let w=Sp(_,this);u=1,d=w.x+s.wrap*w.scale,p=w.y,i.ad.scale(v,v,[u/w.scale,u/w.scale,e.pixelsPerMeter/r])}else u=r/e.zoomScale(_.z),d=(_.x+Math.pow(2,_.z)*s.wrap)*u,p=_.y*u;return i.ad.translate(v,v,[d,p,0]),i.ad.scale(v,v,[u/rt,u/rt,1]),v}upVector(e,r,s){return[0,0,1]}upVectorScale(e,r,s){return{metersToTile:1}}}class CM extends Ef{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];let[r,s]=this.parallels=e.parallels||[29.5,45.5],u=Math.sin(Tr(r));this.n=(u+Math.sin(Tr(s)))/2,this.c=1+u*(2*this.n-u),this.r0=Math.sqrt(this.c)/this.n}project(e,r){let{n:s,c:u,r0:d}=this,p=Tr(e-this.center[0]),_=Tr(r),v=Math.sqrt(u-2*s*Math.sin(_))/s;return{x:v*Math.sin(p*s),y:v*Math.cos(p*s)-d,z:0}}unproject(e,r){let{n:s,c:u,r0:d}=this,p=d+r,_=Math.atan2(e,Math.abs(p))*Math.sign(p);p*s<0&&(_-=Math.PI*Math.sign(e)*Math.sign(p));let v=Tr(this.center[0])*s;_=Rl(_,-Math.PI-v,Math.PI-v);let w=lr(va(_/s)+this.center[0],-180,180),E=Math.asin(lr((u-(e*e+p*p)*s*s)/(2*s),-1,1)),k=lr(va(E),-ja,ja);return new Xr(w,k)}}let ig=1.340264,rg=-.081106,ng=893e-6,ag=.003796,H_=Math.sqrt(3)/2;class IM extends Ef{project(e,r){r=r/180*Math.PI,e=e/180*Math.PI;let s=Math.asin(H_*Math.sin(r)),u=s*s,d=u*u*u;return{x:.5*(e*Math.cos(s)/(H_*(ig+3*rg*u+d*(7*ng+9*ag*u)))/Math.PI+.5),y:1-.5*(s*(ig+rg*u+d*(ng+ag*u))/Math.PI+1),z:0}}unproject(e,r){e=(2*e-.5)*Math.PI;let s=r=(2*(1-r)-1)*Math.PI,u=s*s,d=u*u*u;for(let E,k,D,N=0;N<12&&(k=s*(ig+rg*u+d*(ng+ag*u))-r,D=ig+3*rg*u+d*(7*ng+9*ag*u),E=k/D,s=lr(s-E,-Math.PI/3,Math.PI/3),u=s*s,d=u*u*u,!(Math.abs(E)<1e-12));++N);let p=H_*e*(ig+3*rg*u+d*(7*ng+9*ag*u))/Math.cos(s),_=Math.asin(Math.sin(s)/H_),v=lr(180*p/Math.PI,-180,180),w=lr(180*_/Math.PI,-ja,ja);return new Xr(v,w)}}class kM extends Ef{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,r){return{x:.5+e/360,y:.5-r/360,z:0}}unproject(e,r){let s=360*(e-.5),u=lr(360*(.5-r),-ja,ja);return new Xr(s,u)}}let Lm=Math.PI/2;function G_(t){return Math.tan((Lm+t)/2)}class MM extends Ef{constructor(e){super(e),this.center=e.center||[0,30];let[r,s]=this.parallels=e.parallels||[30,30],u=Tr(r),d=Tr(s);this.southernCenter=u+d<0,this.southernCenter&&(u=-u,d=-d);let p=Math.cos(u),_=G_(u);this.n=u===d?Math.sin(u):Math.log(p/Math.cos(d))/Math.log(G_(d)/_),this.f=p*Math.pow(G_(u),this.n)/this.n}project(e,r){r=Tr(r),this.southernCenter&&(r=-r),e=Tr(e-this.center[0]);let s=1e-6,{n:u,f:d}=this;d>0?r<-Lm+s&&(r=-Lm+s):r>Lm-s&&(r=Lm-s);let p=d/Math.pow(G_(r),u),_=p*Math.sin(u*e),v=d-p*Math.cos(u*e);return _=.5*(_/Math.PI+.5),v=.5*(v/Math.PI+.5),{x:_,y:this.southernCenter?v:1-v,z:0}}unproject(e,r){e=(2*e-.5)*Math.PI,this.southernCenter&&(r=1-r),r=(2*(1-r)-.5)*Math.PI;let{n:s,f:u}=this,d=u-r,p=Math.sign(d),_=Math.sign(s)*Math.sqrt(e*e+d*d),v=Math.atan2(e,Math.abs(d))*p;d*s<0&&(v-=Math.PI*Math.sign(e)*p);let w=lr(va(v/s)+this.center[0],-180,180),E=lr(va(2*Math.atan(Math.pow(u/_,1/s))-Lm),-ja,ja);return new Xr(w,this.southernCenter?-E:E)}}class fT extends Ef{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,r){return{x:Mh(e),y:Dh(r),z:0}}unproject(e,r){let s=El(e),u=Uo(r);return new Xr(s,u)}}let pT=Tr(ja);class DM extends Ef{project(e,r){let s=(r=Tr(r))*r,u=s*s;return{x:.5*((e=Tr(e))*(.8707-.131979*s+u*(u*(.003971*s-.001529*u)-.013791))/Math.PI+.5),y:1-.5*(r*(1.007226+s*(.015085+u*(.028874*s-.044475-.005916*u)))/Math.PI+1),z:0}}unproject(e,r){e=(2*e-.5)*Math.PI;let s=r=(2*(1-r)-1)*Math.PI,u=25,d=0,p=s*s;do{p=s*s;let w=p*p;d=(s*(1.007226+p*(.015085+w*(.028874*p-.044475-.005916*w)))-r)/(1.007226+p*(.045255+w*(.259866*p-.311325-.005916*11*w))),s=lr(s-d,-pT,pT)}while(Math.abs(d)>1e-6&&--u>0);p=s*s;let _=lr(va(e/(.8707+p*(p*(p*p*p*(.003971-.001529*p)-.013791)-.131979))),-180,180),v=va(s);return new Xr(_,v)}}let mT=Tr(ja);class FM extends Ef{project(e,r){r=Tr(r),e=Tr(e);let s=Math.cos(r),u=2/Math.PI,d=Math.acos(s*Math.cos(e/2)),p=Math.sin(d)/d,_=.5*(e*u+2*s*Math.sin(e/2)/p)||0,v=.5*(r+Math.sin(r)/p)||0;return{x:.5*(_/Math.PI+.5),y:1-.5*(v/Math.PI+1),z:0}}unproject(e,r){let s=e=(2*e-.5)*Math.PI,u=r=(2*(1-r)-1)*Math.PI,d=25,p=1e-6,_=0,v=0;do{let w=Math.cos(u),E=Math.sin(u),k=2*E*w,D=E*E,N=w*w,B=Math.cos(s/2),q=Math.sin(s/2),Z=2*B*q,oe=q*q,ve=1-N*B*B,be=ve?1/ve:0,we=ve?Math.acos(w*B)*Math.sqrt(1/ve):0,$e=.5*(2*we*w*q+2*s/Math.PI)-e,Ge=.5*(we*E+u)-r,it=.5*be*(N*oe+we*w*B*D)+1/Math.PI,ot=be*(Z*k/4-we*E*q),_t=.125*be*(k*q-we*E*N*Z),Mt=.5*be*(D*B+we*oe*w)+.5,At=ot*_t-Mt*it;_=(Ge*ot-$e*Mt)/At,v=($e*_t-Ge*it)/At,s=lr(s-_,-Math.PI,Math.PI),u=lr(u-v,-mT,mT)}while((Math.abs(_)>p||Math.abs(v)>p)&&--d>0);return new Xr(va(s),va(u))}}class gT extends Ef{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Tr(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,r){let{scale:s,cosPhi:u}=this;return{x:Tr(e)*u*s+.5,y:-Math.sin(Tr(r))/u*s+.5,z:0}}unproject(e,r){let{scale:s,cosPhi:u}=this,d=-(r-.5)/s,p=lr(va((e-.5)/s)/u,-180,180),_=Math.asin(lr(d*u,-1,1)),v=lr(va(_),-ja,ja);return new Xr(p,v)}}class PM extends fT{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,r,s){let u=U0(e,r,s),d=H0(Fh(s));return i._.transformMat4(u,u,d),{x:u[0],y:u[1],z:u[2]}}locationPoint(e,r){let s=vp(r.lat,r.lng),u=i._.normalize([],s),d=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(r),e._centerAltitude):e._centerAltitude,p=rl(1,0)*rt*d;i._.scaleAndAdd(s,s,u,p);let _=i.ad.identity(new Float64Array(16));return i.ad.multiply(_,e.pixelMatrix,e.globeMatrix),i._.transformMat4(s,s,_),new hi(s[0],s[1])}pixelsPerMeter(e,r){return rl(1,0)*r}pixelSpaceConversion(e,r,s){let u=rl(1,e)*r,d=$i(rl(1,45)*r,u,s);return this.pixelsPerMeter(e,r)/d}createTileMatrix(e,r,s){let u=kv(Fh(s.canonical));return i.ad.multiply(new Float64Array(16),e.globeMatrix,u)}createInversionMatrix(e,r){let{center:s}=e,u=H0(Fh(r));return i.ad.rotateY(u,u,Tr(s.lng)),i.ad.rotateX(u,u,Tr(s.lat)),i.ad.scale(u,u,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(u)}pointCoordinate(e,r,s,u){return Tw(e,r,s,!0)||new vs(0,0)}pointCoordinate3D(e,r,s){let u=this.pointCoordinate(e,r,s,0);return[u.x,u.y,u.z]}isPointAboveHorizon(e,r){return!Tw(e,r.x,r.y,!1)}farthestPixelDistance(e){let r=function(u,d){let p=u.cameraToCenterDistance,_=u._centerAltitude*d,v=u._camera,w=u._camera.forward(),E=i._.add([],i._.scale([],w,-p),[0,0,_]),k=u.worldSize/(2*Math.PI),D=[0,0,-k],N=u.width/u.height,B=Math.tan(u.fovAboveCenter),q=i._.scale([],v.up(),B),Z=i._.scale([],v.right(),B*N),oe=i._.normalize([],i._.add([],i._.add([],w,q),Z)),ve=[],be;if(new Sv(E,oe).closestPointOnSphere(D,k,ve)){let we=i._.add([],ve,D),$e=i._.sub([],we,E);be=Math.cos(u.fovAboveCenter)*i._.length($e)}else{let we=i._.sub([],E,D),$e=i._.sub([],D,E);i._.normalize($e,$e);let Ge=i._.length(we)-k;be=Math.sqrt(Ge*(Ge+2*k));let it=Math.acos(be/(k+Ge))-Math.acos(i._.dot(w,$e));be*=Math.cos(it)}return 1.01*be}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),s=Sd(e.zoom);if(s>0){let u=hT(e,rl(1,e.center.lat)*e.worldSize),d=e.worldSize/(2*Math.PI),p=Math.max(e.width,e.height)/e.worldSize*Math.PI;return $i(r,u+d*(1-Math.cos(p)),Math.pow(s,10))}return r}upVector(e,r,s){return U0(r,s,e,1)}upVectorScale(e){return{metersToTile:x_(y_(Fh(e)))}}}function _T(t){let e=t.parallels,r=!!e&&Math.abs(e[0]+e[1])<.01;switch(t.name){case"mercator":return new fT(t);case"equirectangular":return new kM(t);case"naturalEarth":return new DM(t);case"equalEarth":return new IM(t);case"winkelTripel":return new FM(t);case"albers":return r?new gT(t):new CM(t);case"lambertConformalConic":return r?new gT(t):new MM(t);case"globe":return new PM(t)}throw new Error(`Invalid projection name: ${t.name}`)}let LM=(()=>{class t{constructor(r,s,u,d){this.id=t.uniqueIdxCounter,t.uniqueIdxCounter++,this.context=r;let p=r.gl;this.buffer=p.createBuffer(),this.dynamicDraw=!!u,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||d||s.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){this.id=t.uniqueIdxCounter,t.uniqueIdxCounter++;let s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}return t.uniqueIdxCounter=0,t})();class Rm{constructor(e,r,s){this.func=e,this.mask=r,this.range=s}}Rm.ReadOnly=!1,Rm.ReadWrite=!0,Rm.disabled=new Rm(519,Rm.ReadOnly,[0,1]);let Qv=7680;class ey{constructor(e,r,s,u,d,p){this.test=e,this.ref=r,this.mask=s,this.fail=u,this.depthFail=d,this.pass=p}}ey.disabled=new ey({func:519,mask:0},0,0,Qv,Qv,Qv);let og=771;class $l{constructor(e,r,s,u){this.blendFunction=e,this.blendColor=r,this.mask=s,this.blendEquation=u}}$l.Replace=[1,0,1,0],$l.disabled=new $l($l.Replace,jr.transparent,[!1,!1,!1,!1]),$l.unblended=new $l($l.Replace,jr.transparent,[!0,!0,!0,!0]),$l.alphaBlended=new $l([1,og,1,og],jr.transparent,[!0,!0,!0,!0]),$l.alphaBlendedNonPremultiplied=new $l([770,og,770,og],jr.transparent,[!0,!0,!0,!0]),$l.multiply=new $l([774,0,774,0],jr.transparent,[!0,!0,!0,!0]);let ty=1029,iy=2305;class Hu{constructor(e,r,s){this.enable=e,this.mode=r,this.frontFace=s}}Hu.disabled=new Hu(!1,ty,iy),Hu.backCCW=new Hu(!0,ty,iy),Hu.backCW=new Hu(!0,ty,2304),Hu.frontCW=new Hu(!0,1028,2304),Hu.frontCCW=new Hu(!0,1028,iy);let RM=C_.types,OM=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function W_(t,e,r,s,u,d,p,_,v,w,E,k,D){let N=_?Math.min(Sf,Math.round(_[0])):0,B=_?Math.min(Sf,Math.round(_[1])):0;t.emplaceBack(e,r,Math.round(32*s),Math.round(32*u),d,p,(N<<1)+(v?1:0),B,16*w,16*E,256*k,256*D)}function q_(t,e,r){t.emplaceBack(e,r)}function $_(t,e,r,s,u,d,p){t.emplaceBack(e,r,s,u,d,p)}function X_(t,e,r,s,u){t.emplaceBack(e,r,s,u),t.emplaceBack(e,r,s,u),t.emplaceBack(e,r,s,u),t.emplaceBack(e,r,s,u)}function NM(t){for(let e of t.sections)if(jt(e.text))return!0;return!1}class ry{constructor(e){this.layoutVertexArray=new $x,this.indexArray=new ko,this.programConfigurations=e,this.segments=new oa,this.dynamicLayoutVertexArray=new df,this.opacityVertexArray=new Zx,this.occlusionQueryOpacityVertexArray=new gp,this.placedSymbolArray=new $2,this.iconTransitioningVertexArray=new mf,this.globeExtVertexArray=new Xx,this.zOffsetVertexArray=new gp}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(e,r,s,u,d){this.isEmpty()||(s&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Bk.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,jk.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,OM,!0),this.occlusionQueryOpacityVertexBuffer=e.createVertexBuffer(this.occlusionQueryOpacityVertexArray,Uv.members,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=e.createVertexBuffer(this.iconTransitioningVertexArray,Vk.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,zk.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||d)&&(this.zOffsetVertexBuffer=e.createVertexBuffer(this.zOffsetVertexArray,E5.members,!0)),this.opacityVertexBuffer.itemSize=1),(s||u)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.occlusionQueryOpacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}Pe(ry,"SymbolBuffers");class ny{constructor(e,r,s){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new s,this.segments=new oa,this.collisionVertexArray=new Jx,this.collisionVertexArrayExt=new df}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Uk.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,Hk.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Pe(ny,"CollisionBuffers");class Om{constructor(e){this.queries=new Map,this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.lut=e.lut,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(p=>p.fqid),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=i.ad.identity([]),this.placementViewportMatrix=i.ad.identity([]);let r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Gv(this.zoom,r["text-size"]),this.iconSizeData=Gv(this.zoom,r["icon-size"]);let s=this.layers[0].layout,u=s.get("symbol-sort-key"),d=s.get("symbol-z-order");this.canOverlap=s.get("text-allow-overlap")||s.get("icon-allow-overlap")||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey=d!=="viewport-y"&&u.constantOr(1)!==void 0,this.sortFeaturesByY=(d==="viewport-y"||d==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=s.get("text-writing-mode").map(p=>Ic[p]),this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id),this.sourceID=e.sourceID,this.projection=e.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=s.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new ry(new _f(this.layers,{zoom:this.zoom,lut:this.lut},e=>/^text/.test(e))),this.icon=new ry(new _f(this.layers,{zoom:this.zoom,lut:this.lut},e=>/^icon/.test(e))),this.glyphOffsetArray=new Y2,this.lineVertexArray=new K2,this.symbolInstances=new Z2}calculateGlyphDependencies(e,r,s,u,d){for(let p=0;p<e.length;p++){let _=e.codePointAt(p);if(_===void 0)break;if(r[_]=!0,u&&d&&_<=65535){let v=J0[e.charAt(p)];v&&(r[v.charCodeAt(0)]=!0)}}}updateFootprints(e,r){}updateReplacement(e,r){if(r.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=r.updateTime;let s=r.getReplacementRegionsForTile(e.toUnwrapped(),!0);return!jv(this.activeReplacements,s)&&(this.activeReplacements=s,!0)}populate(e,r,s,u){let d=this.layers[0],p=d.layout,_=this.projection.name==="globe",v=p.get("text-font"),w=p.get("text-field"),E=p.get("icon-image"),k=(w.value.kind!=="constant"||w.value.value instanceof Ga&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),D=E.value.kind!=="constant"||!!E.value.value||Object.keys(E.parameters).length>0,N=p.get("symbol-sort-key");if(this.features=[],!k&&!D)return;let B=r.iconDependencies,q=r.glyphDependencies,Z=r.availableImages,oe=new ir(this.zoom);for(let{feature:ve,id:be,index:we,sourceLayerIndex:$e}of e){let Ge=d._featureFilter.needGeometry,it=wd(ve,Ge);if(!d._featureFilter.filter(oe,it,s))continue;if(Ge||(it.geometry=ju(ve,s,u)),_&&ve.type!==1&&s.z<=5){let At=it.geometry,zt=.98078528056,Jt=(Ot,Xt)=>{let Dt=U0(Ot.x,Ot.y,s,1),Zt=U0(Xt.x,Xt.y,s,1);return i._.dot(Dt,Zt)<zt};for(let Ot=0;Ot<At.length;Ot++)At[Ot]=bI(At[Ot],Jt)}let ot,_t;if(k){let At=d.getValueAndResolveTokens("text-field",it,s,Z),zt=Ga.factory(At);NM(zt)&&(this.hasRTLText=!0),(!this.hasRTLText||Ir()==="unavailable"||this.hasRTLText&&un.isParsed())&&(ot=cM(zt,d,it))}if(D){let At=d.getValueAndResolveTokens("icon-image",it,s,Z);_t=At instanceof Qo?At:Qo.fromString(At)}if(!ot&&!_t)continue;let Mt=this.sortFeaturesByKey?N.evaluate(it,{},s):void 0;if(this.features.push({id:be,text:ot,icon:_t,index:we,sourceLayerIndex:$e,geometry:it.geometry,properties:ve.properties,type:RM[ve.type],sortKey:Mt}),_t&&(B[_t.namePrimary]=!0,_t.nameSecondary&&(B[_t.nameSecondary]=!0)),ot){let At=v.evaluate(it,{},s).join(","),zt=p.get("text-rotation-alignment")==="map"&&p.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ic.vertical)>=0;for(let Jt of ot.sections)if(Jt.image)B[Jt.image.namePrimary]=!0;else{let Ot=bt(ot.toString()),Xt=Jt.fontStack||At,Dt=q[Xt]=q[Xt]||{};this.calculateGlyphDependencies(Jt.text,Dt,zt,this.allowVerticalPlacement,Ot)}}}p.get("symbol-placement")==="line"&&(this.features=function(ve){let be={},we={},$e=[],Ge=0;function it(At){$e.push(ve[At]),Ge++}function ot(At,zt,Jt){let Ot=we[At];return delete we[At],we[zt]=Ot,$e[Ot].geometry[0].pop(),$e[Ot].geometry[0]=$e[Ot].geometry[0].concat(Jt[0]),Ot}function _t(At,zt,Jt){let Ot=be[zt];return delete be[zt],be[At]=Ot,$e[Ot].geometry[0].shift(),$e[Ot].geometry[0]=Jt[0].concat($e[Ot].geometry[0]),Ot}function Mt(At,zt,Jt){let Ot=Jt?zt[0][zt[0].length-1]:zt[0][0];return`${At}:${Ot.x}:${Ot.y}`}for(let At=0;At<ve.length;At++){let zt=ve[At],Jt=zt.geometry,Ot=zt.text?zt.text.toString():null;if(!Ot){it(At);continue}let Xt=Mt(Ot,Jt),Dt=Mt(Ot,Jt,!0);if(Xt in we&&Dt in be&&we[Xt]!==be[Dt]){let Zt=_t(Xt,Dt,Jt),ri=ot(Xt,Dt,$e[Zt].geometry);delete be[Xt],delete we[Dt],we[Mt(Ot,$e[ri].geometry,!0)]=ri,$e[Zt].geometry=null}else Xt in we?ot(Xt,Dt,Jt):Dt in be?_t(Xt,Dt,Jt):(it(At),be[Xt]=Ge-1,we[Dt]=Ge-1)}return $e.filter(At=>At.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ve,be)=>ve.sortKey-be.sortKey)}update(e,r,s,u,d){let p=Object.keys(e).length!==0;if(p&&!this.stateDependentLayers.length)return;let _=p?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(e,r,_,s,u,d),this.icon.programConfigurations.updatePaintArrays(e,r,_,s,u,d)}updateOcclusionOpacities(e,r,s){if(!r.useOcclusionQueries)return!1;let u=this;if(u.projection.name==="globe")return!1;let d=!1;u.hasTextData()&&(d=d||u.text.occlusionQueryOpacityVertexArray.length!==0),u.hasIconData()&&(d=d||u.icon.occlusionQueryOpacityVertexArray.length!==0);let p=u.layers[0].paint,_=p.get("icon-occlusion-opacity").constantOr(0),v=p.get("text-occlusion-opacity").constantOr(0);if(!u.layers[0].hasInitialOcclusionOpacityProperties||_===1&&v===1)return!1;let w=!d;for(let N=0;N<u.symbolInstances.length;N++){let B=u.symbolInstances.get(N),q=B.occlusionOpacity;B.occlusionOpacity+=(B.occlusionState>.5?1:-1)*r.fadeSpeed*s*.001,B.occlusionOpacity=lr(B.occlusionOpacity,0,1),w=w||B.occlusionOpacity!==q}if(!w)return!1;let E=0,k=0,D=(N,B,q,Z)=>{let oe=0,ve=0;q?(oe=k,k+=Z,ve=k):(oe=E,E+=Z,ve=E),ve>B.occlusionQueryOpacityVertexArray.length&&B.occlusionQueryOpacityVertexArray.resize(ve);let be=N.occlusionOpacity;for(let we=0;we<Z;we++)B.occlusionQueryOpacityVertexArray.emplace(we+oe,be)};for(let N=0;N<u.symbolInstances.length;N++){let B=u.symbolInstances.get(N),{numHorizontalGlyphVertices:q,numVerticalGlyphVertices:Z,numIconVertices:oe}=B,ve=oe>0;if((q>0||Z>0)&&(D(B,u.text,!1,q),D(B,u.text,!1,Z)),ve){let{placedIconSymbolIndex:be,verticalPlacedIconSymbolIndex:we}=B;be>=0&&D(B,u.icon,!0,oe),we>=0&&D(B,u.icon,!0,B.numVerticalIconVertices)}}return u.hasTextData()&&u.text.occlusionQueryOpacityVertexBuffer&&(u.text.occlusionQueryOpacityVertexBuffer.length<u.text.occlusionQueryOpacityVertexArray.length?u.text.occlusionQueryOpacityVertexBuffer=e.createVertexBuffer(u.text.occlusionQueryOpacityVertexArray,Uv.members,!0):u.text.occlusionQueryOpacityVertexBuffer.updateData(u.text.occlusionQueryOpacityVertexArray)),u.hasIconData()&&u.icon.occlusionQueryOpacityVertexBuffer&&(u.icon.occlusionQueryOpacityVertexBuffer.length<u.icon.occlusionQueryOpacityVertexArray.length?u.icon.occlusionQueryOpacityVertexBuffer=e.createVertexBuffer(u.icon.occlusionQueryOpacityVertexArray,Uv.members,!0):u.icon.occlusionQueryOpacityVertexBuffer.updateData(u.icon.occlusionQueryOpacityVertexArray)),!0}updateZOffset(){let e=(d,p,_)=>{s+=p,s>d.length&&d.resize(s);for(let v=-p;v<0;v++)d.emplace(v+s,_)},r=(d,p,_)=>{u+=p,u>d.length&&d.resize(u);for(let v=-p;v<0;v++)d.emplace(v+u,_)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let s=0,u=0;for(let d=0;d<this.symbolInstances.length;d++){let p=this.symbolInstances.get(d),{numHorizontalGlyphVertices:_,numVerticalGlyphVertices:v,numIconVertices:w}=p,E=p.zOffset,k=w>0;if((_>0||v>0)&&(e(this.text.zOffsetVertexArray,_,E),e(this.text.zOffsetVertexArray,v,E)),k){let{placedIconSymbolIndex:D,verticalPlacedIconSymbolIndex:N}=p;D>=0&&r(this.icon.zOffsetVertexArray,w,E),N>=0&&r(this.icon.zOffsetVertexArray,p.numVerticalIconVertices,E)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=_T(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData();for(let e of this.queries.values())e.destroy()}addToLineVertexArray(e,r){let s=this.lineVertexArray.length;if(e.segment!==void 0)for(let{x:u,y:d}of r)this.lineVertexArray.emplaceBack(u,d);return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(e,r,s,u,d,p,_,v,w,E,k,D,N,B,q,Z){let oe=e.indexArray,ve=e.layoutVertexArray,be=e.globeExtVertexArray,we=e.segments.prepareSegment(4*r.length,ve,oe,this.canOverlap?p.sortKey:void 0),$e=this.glyphOffsetArray.length,Ge=we.vertexLength,it=this.allowVerticalPlacement&&_===Ic.vertical?Math.PI/2:0,ot=p.text&&p.text.sections;for(let Mt=0;Mt<r.length;Mt++){let{tl:At,tr:zt,bl:Jt,br:Ot,texPrimary:Xt,texSecondary:Dt,pixelOffsetTL:Zt,pixelOffsetBR:ri,minFontScaleX:Kt,minFontScaleY:Si,glyphOffset:ei,isSDF:li,sectionIndex:Xi}=r[Mt],zi=we.vertexLength,Oi=ei[1];if(W_(ve,w.x,w.y,At.x,Oi+At.y,Xt.x,Xt.y,s,li,Zt.x,Zt.y,Kt,Si),W_(ve,w.x,w.y,zt.x,Oi+zt.y,Xt.x+Xt.w,Xt.y,s,li,ri.x,Zt.y,Kt,Si),W_(ve,w.x,w.y,Jt.x,Oi+Jt.y,Xt.x,Xt.y+Xt.h,s,li,Zt.x,ri.y,Kt,Si),W_(ve,w.x,w.y,Ot.x,Oi+Ot.y,Xt.x+Xt.w,Xt.y+Xt.h,s,li,ri.x,ri.y,Kt,Si),v){let{x:ai,y:Yi,z:mr}=v.anchor,[er,br,gr]=v.up;$_(be,ai,Yi,mr,er,br,gr),$_(be,ai,Yi,mr,er,br,gr),$_(be,ai,Yi,mr,er,br,gr),$_(be,ai,Yi,mr,er,br,gr),X_(e.dynamicLayoutVertexArray,ai,Yi,mr,it)}else X_(e.dynamicLayoutVertexArray,w.x,w.y,w.z,it);if(Z){let ai=Dt||Xt;q_(e.iconTransitioningVertexArray,ai.x,ai.y),q_(e.iconTransitioningVertexArray,ai.x+ai.w,ai.y),q_(e.iconTransitioningVertexArray,ai.x,ai.y+ai.h),q_(e.iconTransitioningVertexArray,ai.x+ai.w,ai.y+ai.h)}oe.emplaceBack(zi,zi+1,zi+2),oe.emplaceBack(zi+1,zi+2,zi+3),we.vertexLength+=4,we.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ei[0]),Mt!==r.length-1&&Xi===r[Mt+1].sectionIndex||e.programConfigurations.populatePaintArrays(ve.length,p,p.index,{},N,B,q,ot&&ot[Xi])}let _t=v?v.anchor:w;e.placedSymbolArray.emplaceBack(_t.x,_t.y,_t.z,w.x,w.y,$e,this.glyphOffsetArray.length-$e,Ge,E,k,w.segment,s?s[0]:0,s?s[1]:0,u[0],u[1],_,0,!1,0,D,0)}_commitLayoutVertex(e,r,s,u,d,p,_){e.emplaceBack(r,s,u,d,p,Math.round(_.x),Math.round(_.y))}_addCollisionDebugVertices(e,r,s,u,d,p,_){let v=s.segments.prepareSegment(4,s.layoutVertexArray,s.indexArray),w=v.vertexLength,E=_.tileAnchorX,k=_.tileAnchorY;for(let N=0;N<4;N++)s.collisionVertexArray.emplaceBack(0,0,0,0);this._commitDebugCollisionVertexUpdate(s.collisionVertexArrayExt,r,e.padding,_.zOffset),this._commitLayoutVertex(s.layoutVertexArray,u,d,p,E,k,new hi(e.x1,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,u,d,p,E,k,new hi(e.x2,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,u,d,p,E,k,new hi(e.x2,e.y2)),this._commitLayoutVertex(s.layoutVertexArray,u,d,p,E,k,new hi(e.x1,e.y2)),v.vertexLength+=4;let D=s.indexArray;D.emplaceBack(w,w+1),D.emplaceBack(w+1,w+2),D.emplaceBack(w+2,w+3),D.emplaceBack(w+3,w),v.primitiveLength+=4}_addTextDebugCollisionBoxes(e,r,s,u,d,p){for(let _=u;_<d;_++){let v=s.get(_),w=this.getSymbolInstanceTextSize(e,p,r,_);this._addCollisionDebugVertices(v,w,this.textCollisionBox,v.projectedAnchorX,v.projectedAnchorY,v.projectedAnchorZ,p)}}_addIconDebugCollisionBoxes(e,r,s,u,d,p){for(let _=u;_<d;_++){let v=s.get(_),w=this.getSymbolInstanceIconSize(e,r,p.placedIconSymbolIndex);this._addCollisionDebugVertices(v,w,this.iconCollisionBox,v.projectedAnchorX,v.projectedAnchorY,v.projectedAnchorZ,p)}}generateCollisionDebugBuffers(e,r){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ny(c_,A5.members,mf),this.iconCollisionBox=new ny(c_,A5.members,mf);let s=Mm(this.iconSizeData,e),u=Mm(this.textSizeData,e);for(let d=0;d<this.symbolInstances.length;d++){let p=this.symbolInstances.get(d);this._addTextDebugCollisionBoxes(u,e,r,p.textBoxStartIndex,p.textBoxEndIndex,p),this._addTextDebugCollisionBoxes(u,e,r,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p),this._addIconDebugCollisionBoxes(s,e,r,p.iconBoxStartIndex,p.iconBoxEndIndex,p),this._addIconDebugCollisionBoxes(s,e,r,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex,p)}}getSymbolInstanceTextSize(e,r,s,u){let d=this.text.placedSymbolArray.get(r.rightJustifiedTextSymbolIndex>=0?r.rightJustifiedTextSymbolIndex:r.centerJustifiedTextSymbolIndex>=0?r.centerJustifiedTextSymbolIndex:r.leftJustifiedTextSymbolIndex>=0?r.leftJustifiedTextSymbolIndex:r.verticalPlacedTextSymbolIndex>=0?r.verticalPlacedTextSymbolIndex:u),p=N_(this.textSizeData,e,d)/ts;return this.tilePixelRatio*p}getSymbolInstanceIconSize(e,r,s){let u=this.icon.placedSymbolArray.get(s),d=N_(this.iconSizeData,e,u);return this.tilePixelRatio*d}_commitDebugCollisionVertexUpdate(e,r,s,u){e.emplaceBack(r,-s,-s,u),e.emplaceBack(r,s,-s,u),e.emplaceBack(r,s,s,u),e.emplaceBack(r,-s,s,u)}_updateTextDebugCollisionBoxes(e,r,s,u,d,p){for(let _=u;_<d;_++){let v=s.get(_),w=this.getSymbolInstanceTextSize(e,p,r,_);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,w,v.padding,p.zOffset)}}_updateIconDebugCollisionBoxes(e,r,s,u,d,p){for(let _=u;_<d;_++){let v=s.get(_),w=this.getSymbolInstanceIconSize(e,r,p.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,w,v.padding,p.zOffset)}}updateCollisionDebugBuffers(e,r){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();let s=Mm(this.iconSizeData,e),u=Mm(this.textSizeData,e);for(let d=0;d<this.symbolInstances.length;d++){let p=this.symbolInstances.get(d);this._updateTextDebugCollisionBoxes(u,e,r,p.textBoxStartIndex,p.textBoxEndIndex,p),this._updateTextDebugCollisionBoxes(u,e,r,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p),this._updateIconDebugCollisionBoxes(s,e,r,p.iconBoxStartIndex,p.iconBoxEndIndex,p),this._updateIconDebugCollisionBoxes(s,e,r,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex,p)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,r,s,u,d,p,_,v,w){let E={};if(r<s){let{x1:k,y1:D,x2:N,y2:B,padding:q,projectedAnchorX:Z,projectedAnchorY:oe,projectedAnchorZ:ve,tileAnchorX:be,tileAnchorY:we,featureIndex:$e}=e.get(r);E.textBox={x1:k,y1:D,x2:N,y2:B,padding:q,projectedAnchorX:Z,projectedAnchorY:oe,projectedAnchorZ:ve,tileAnchorX:be,tileAnchorY:we},E.textFeatureIndex=$e}if(u<d){let{x1:k,y1:D,x2:N,y2:B,padding:q,projectedAnchorX:Z,projectedAnchorY:oe,projectedAnchorZ:ve,tileAnchorX:be,tileAnchorY:we,featureIndex:$e}=e.get(u);E.verticalTextBox={x1:k,y1:D,x2:N,y2:B,padding:q,projectedAnchorX:Z,projectedAnchorY:oe,projectedAnchorZ:ve,tileAnchorX:be,tileAnchorY:we},E.verticalTextFeatureIndex=$e}if(p<_){let{x1:k,y1:D,x2:N,y2:B,padding:q,projectedAnchorX:Z,projectedAnchorY:oe,projectedAnchorZ:ve,tileAnchorX:be,tileAnchorY:we,featureIndex:$e}=e.get(p);E.iconBox={x1:k,y1:D,x2:N,y2:B,padding:q,projectedAnchorX:Z,projectedAnchorY:oe,projectedAnchorZ:ve,tileAnchorX:be,tileAnchorY:we},E.iconFeatureIndex=$e}if(v<w){let{x1:k,y1:D,x2:N,y2:B,padding:q,projectedAnchorX:Z,projectedAnchorY:oe,projectedAnchorZ:ve,tileAnchorX:be,tileAnchorY:we,featureIndex:$e}=e.get(v);E.verticalIconBox={x1:k,y1:D,x2:N,y2:B,padding:q,projectedAnchorX:Z,projectedAnchorY:oe,projectedAnchorZ:ve,tileAnchorX:be,tileAnchorY:we},E.verticalIconFeatureIndex=$e}return E}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){let s=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(e,r){let s=e.placedSymbolArray.get(r),u=s.vertexStartIndex+4*s.numGlyphs;for(let d=s.vertexStartIndex;d<u;d+=4)e.indexArray.emplaceBack(d,d+1,d+2),e.indexArray.emplaceBack(d+1,d+2,d+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let r=Math.sin(e),s=Math.cos(e),u=[],d=[],p=[];for(let _=0;_<this.symbolInstances.length;++_){p.push(_);let v=this.symbolInstances.get(_);u.push(0|Math.round(r*v.tileAnchorX+s*v.tileAnchorY)),d.push(v.featureIndex)}return p.sort((_,v)=>u[_]-u[v]||d[v]-d[_]),p}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let e=0;e<this.symbolInstances.length;++e)this.symbolInstanceIndexesSortedZOffset.push(e)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((e,r)=>this.symbolInstances.get(r).zOffset-this.symbolInstances.get(e).zOffset)}addToSortKeyRanges(e,r){let s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===r?s.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let r of this.symbolInstanceIndexes){let s=this.symbolInstances.get(r);this.featureSortOrder.push(s.featureIndex);let{rightJustifiedTextSymbolIndex:u,centerJustifiedTextSymbolIndex:d,leftJustifiedTextSymbolIndex:p,verticalPlacedTextSymbolIndex:_,placedIconSymbolIndex:v,verticalPlacedIconSymbolIndex:w}=s;u>=0&&this.addIndicesForPlacedSymbol(this.text,u),d>=0&&d!==u&&this.addIndicesForPlacedSymbol(this.text,d),p>=0&&p!==d&&p!==u&&this.addIndicesForPlacedSymbol(this.text,p),_>=0&&this.addIndicesForPlacedSymbol(this.text,_),v>=0&&this.addIndicesForPlacedSymbol(this.icon,v),w>=0&&this.addIndicesForPlacedSymbol(this.icon,w)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Pe(Om,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Om.addDynamicAttributes=X_;class nu{constructor(e,r,s,u){this.context=e,this.format=s,this.texture=e.gl.createTexture(),this.update(r,u)}update(e,r,s){let{width:u,height:d}=e,{context:p}=this,{gl:_}=p;if(_.bindTexture(_.TEXTURE_2D,this.texture),p.pixelStoreUnpackFlipY.set(!1),p.pixelStoreUnpack.set(1),p.pixelStoreUnpackPremultiplyAlpha.set(this.format===_.RGBA&&(!r||r.premultiply!==!1)),s||this.size&&this.size[0]===u&&this.size[1]===d){let{x:v,y:w}=s||{x:0,y:0};if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||ImageBitmap&&e instanceof ImageBitmap)_.texSubImage2D(_.TEXTURE_2D,0,v,w,_.RGBA,_.UNSIGNED_BYTE,e);else{let E=this.format,k=_.UNSIGNED_BYTE;this.format===_.R32F&&(E=_.RED,k=_.FLOAT),_.texSubImage2D(_.TEXTURE_2D,0,v,w,u,d,E,k,e.data)}}else if(this.size=[u,d],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||ImageBitmap&&e instanceof ImageBitmap){let v=this.format;this.format===_.R8&&(v=_.RED),_.texImage2D(_.TEXTURE_2D,0,this.format,v,_.UNSIGNED_BYTE,e)}else{let v=this.format,w=this.format,E=_.UNSIGNED_BYTE;this.format===_.DEPTH_COMPONENT&&(v=_.DEPTH_COMPONENT16,E=_.UNSIGNED_SHORT),this.format===_.R8&&(w=_.RED),this.format===_.R32F&&(E=_.FLOAT,w=_.RED),_.texImage2D(_.TEXTURE_2D,0,v,u,d,0,w,E,e.data)}this.useMipmap=!!(r&&r.useMipmap),this.useMipmap&&_.generateMipmap(_.TEXTURE_2D)}bind(e,r,s=!1){let{context:u}=this,{gl:d}=u;d.bindTexture(d.TEXTURE_2D,this.texture),e!==this.minFilter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,e),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,this.useMipmap&&!s?e===d.NEAREST?d.NEAREST_MIPMAP_NEAREST:d.LINEAR_MIPMAP_LINEAR:e),this.minFilter=e),r!==this.wrapS&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,r),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,r),this.wrapS=r)}bindExtraParam(e,r,s,u){let{context:d}=this,{gl:p}=d;p.bindTexture(p.TEXTURE_2D,this.texture),r!==this.magFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,r),this.magFilter=r),e!==this.minFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.useMipmap?e===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_LINEAR:e),this.minFilter=e),s!==this.wrapS&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,s),this.wrapS=s),u!==this.wrapT&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,u),this.wrapT=u)}destroy(){let{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class Z_{constructor(e,r){this.context=e,this.texture=r}bind(e,r){let{context:s}=this,{gl:u}=s;u.bindTexture(u.TEXTURE_2D,this.texture),e!==this.minFilter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,e),this.minFilter=e),r!==this.wrapS&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,r),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,r),this.wrapS=r)}}let au=32,Lh=33,Af=new Uint16Array(8184);for(let t=0;t<2046;t++){let e=t+2,r=0,s=0,u=0,d=0,p=0,_=0;for(1&e?u=d=p=au:r=s=_=au;(e>>=1)>1;){let w=r+u>>1,E=s+d>>1;1&e?(u=r,d=s,r=p,s=_):(r=u,s=d,u=p,d=_),p=w,_=E}let v=4*t;Af[v+0]=r,Af[v+1]=s,Af[v+2]=u,Af[v+3]=d}let Rh=new Uint16Array(2178),Cf=new Uint8Array(1089),Y_=new Uint16Array(1089);function xT(t){return t===0?-.03125:t===32?.03125:0}var K_=nn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),BM=nn([{name:"a_index",type:"Int16",components:1}]);let vT={type:2,extent:rt,loadGeometry:()=>[[new hi(0,0),new hi(rt+1,0),new hi(rt+1,rt+1),new hi(0,rt+1),new hi(0,0)]]};class J_{constructor(e,r,s,u,d){this.tileID=e,this.uid=fl(),this.uses=0,this.tileSize=r,this.tileZoom=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=d,u&&u.style&&(this._lastUpdatedBrightness=u.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",u&&u.transform&&(this.projection=u.transform.projection)}registerFadeDuration(e){let r=e+this.timeAdded;r<ur.now()||this.fadeEndTime&&r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Sp(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,r,s){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,d){let p={};if(!d)return p;for(let _ of u){let v=_.layerIds.map(w=>d.getLayer(w)).filter(Boolean);if(v.length!==0){_.layers=v,_.stateDependentLayerIds&&(_.stateDependentLayers=_.stateDependentLayerIds.map(w=>v.filter(E=>E.id===w)[0]));for(let w of v)p[w.fqid]=_}}return p}(e.buckets,r.style),this.hasSymbolBuckets=!1;for(let u in this.buckets){let d=this.buckets[u];if(d instanceof Om){if(this.hasSymbolBuckets=!0,!s)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let u in this.buckets){let d=this.buckets[u];if(d instanceof Om&&d.hasRTLText){this.hasRTLText=!0,un.isLoading()||un.isLoaded()||Ir()!=="deferred"||Ur();break}}this.queryPadding=0;for(let u in this.buckets){let d=this.buckets[u],p=r.style.getOwnLayer(u);if(!p)continue;let _=p.queryRadius(d);this.queryPadding=Math.max(this.queryPadding,_)}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas),this._lastUpdatedBrightness=e.brightness}else this.collisionBoxArray=new ov}unloadVectorData(){if(this.hasData()){for(let e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.fqid]}upload(e){for(let u in this.buckets){let d=this.buckets[u];d.uploadPending()&&d.upload(e)}let r=e.gl,s=this.imageAtlas;if(s&&!s.uploaded){let u=!!Object.keys(s.patternPositions).length;this.imageAtlasTexture=new nu(e,s.image,r.RGBA,{useMipmap:u}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new nu(e,this.glyphAtlasImage,r.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new nu(e,this.lineAtlas.image,r.R8),this.lineAtlas.uploaded=!0)}prepare(e,r,s){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture,s),!r||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;let u=r.style.getBrightness();(this._lastUpdatedBrightness||u)&&(this._lastUpdatedBrightness&&u&&Math.abs(this._lastUpdatedBrightness-u)<.001||(this._lastUpdatedBrightness=u,this.updateBuckets(void 0,r)))}queryRenderedFeatures(e,r,s,u,d,p,_,v){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:u,pixelPosMatrix:_,transform:p,params:d,tileTransform:this.tileTransform},e,r,s):{}}querySourceFeatures(e,r){let s=this.latestFeatureIndex;if(!s||!s.rawTileData)return;let u=s.loadVTLayers(),d=r?r.sourceLayer:"",p=u._geojsonTileLayer||u[d];if(!p)return;let _=bo(r&&r.filter),{z:v,x:w,y:E}=this.tileID.canonical,k={z:v,x:w,y:E};for(let D=0;D<p.length;D++){let N=p.feature(D);if(_.needGeometry){let Z=wd(N,!0);if(!_.filter(new ir(this.tileID.overscaledZ),Z,this.tileID.canonical))continue}else if(!_.filter(new ir(this.tileID.overscaledZ),N))continue;let B=s.getId(N,d),q=new j5(N,v,w,E,B);q.tile=k,e.push(q)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}bucketsLoaded(){for(let e in this.buckets)if(this.buckets[e].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){let r=this.expirationTime;if(e.cacheControl){let s=jc(e.cacheControl);s["max-age"]&&(this.expirationTime=Date.now()+1e3*s["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){let s=Date.now(),u=!1;if(this.expirationTime>s)u=!1;else if(r)if(this.expirationTime<r)u=!0;else{let d=this.expirationTime-r;d?this.expirationTime=s+Math.max(d,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0&&r&&this.updateBuckets(e,r)}updateBuckets(e,r){if(!this.latestFeatureIndex)return;let s=this.latestFeatureIndex.loadVTLayers(),u=r.style.listImages(),d=r.style.getBrightness();for(let p in this.buckets){if(!r.style.hasLayer(p))continue;let _=this.buckets[p],v=_.layers[0].sourceLayer||"_geojsonTileLayer",w=s[v],E={};if(e&&(E=e[v],!w||!E||Object.keys(E).length===0))continue;if(_.update(E,w,u,this.imageAtlas&&this.imageAtlas.patternPositions||{},d),_ instanceof P_||_ instanceof E_){let D=r.style.getOwnSourceCache(_.layers[0].source);r._terrain&&r._terrain.enabled&&D&&_.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(D.id,this.tileID)}let k=r&&r.style&&r.style.getOwnLayer(p);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(_)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ur.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=ur.now()+e}setTexture(e,r){let s=r.context,u=s.gl;this.texture=this.texture||r.getTileTexture(e.width),this.texture&&this.texture instanceof nu?this.texture.update(e,{useMipmap:!0}):(this.texture=new nu(s,e,u.RGBA,{useMipmap:!0}),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE))}setDependencies(e,r){let s={};for(let u of r)s[u]=!0;this.dependencies[e]=s}hasDependency(e,r){for(let s of e){let u=this.dependencies[s];if(u){for(let d of r)if(u[d])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,r){if(!r||r.name==="mercator"||this._tileDebugBuffer)return;let s=ju(vT,this.tileID.canonical,this.tileTransform)[0],u=new Bu,d=new R0;for(let p=0;p<s.length;p++){let{x:_,y:v}=s[p];u.emplaceBack(_,v),d.emplaceBack(p)}d.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(d),this._tileDebugBuffer=e.createVertexBuffer(u,V0.members),this._tileDebugSegments=oa.simpleSegment(0,0,u.length,d.length)}_makeTileBoundsBuffers(e,r){if(this._tileBoundsBuffer||!r||r.name==="mercator")return;let s=ju(vT,this.tileID.canonical,this.tileTransform)[0],u,d;if(this.isRaster){let p=function(_,v){let w=Sp(_,v),E=Math.pow(2,_.z);for(let Z=0;Z<Lh;Z++)for(let oe=0;oe<Lh;oe++){let ve=El((_.x+(oe+xT(oe))/au)/E),be=Uo((_.y+(Z+xT(Z))/au)/E),we=v.project(ve,be),$e=Z*Lh+oe;Rh[2*$e+0]=Math.round((we.x*w.scale-w.x)*rt),Rh[2*$e+1]=Math.round((we.y*w.scale-w.y)*rt)}Cf.fill(0),Y_.fill(0);for(let Z=2045;Z>=0;Z--){let oe=4*Z,ve=Af[oe+0],be=Af[oe+1],we=Af[oe+2],$e=Af[oe+3],Ge=ve+we>>1,it=be+$e>>1,ot=Ge+it-be,_t=it+ve-Ge,Mt=be*Lh+ve,At=$e*Lh+we,zt=it*Lh+Ge,Jt=Math.hypot((Rh[2*Mt+0]+Rh[2*At+0])/2-Rh[2*zt+0],(Rh[2*Mt+1]+Rh[2*At+1])/2-Rh[2*zt+1])>=16;Cf[zt]=Cf[zt]||(Jt?1:0),Z<1022&&(Cf[zt]=Cf[zt]||Cf[(be+_t>>1)*Lh+(ve+ot>>1)]||Cf[($e+_t>>1)*Lh+(we+ot>>1)])}let k=new hf,D=new ko,N=0;function B(Z,oe){let ve=oe*Lh+Z;return Y_[ve]===0&&(k.emplaceBack(Rh[2*ve+0],Rh[2*ve+1],Z*rt/au,oe*rt/au),Y_[ve]=++N),Y_[ve]-1}function q(Z,oe,ve,be,we,$e){let Ge=Z+ve>>1,it=oe+be>>1;if(Math.abs(Z-we)+Math.abs(oe-$e)>1&&Cf[it*Lh+Ge])q(we,$e,Z,oe,Ge,it),q(ve,be,we,$e,Ge,it);else{let ot=B(Z,oe),_t=B(ve,be),Mt=B(we,$e);D.emplaceBack(ot,_t,Mt)}}return q(0,0,au,au,au,0),q(au,au,0,0,0,au),{vertices:k,indices:D}}(this.tileID.canonical,r);u=p.vertices,d=p.indices}else{u=new hf,d=new ko;for(let{x:_,y:v}of s)u.emplaceBack(_,v,0,0);let p=W0(u.int16,void 0,4);for(let _=0;_<p.length;_+=3)d.emplaceBack(p[_],p[_+1],p[_+2])}this._tileBoundsBuffer=e.createVertexBuffer(u,K_.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(d),this._tileBoundsSegments=oa.simpleSegment(0,0,u.length,d.length)}_makeGlobeTileDebugBuffers(e,r){let s=r.projection;if(!s||s.name!=="globe"||r.freezeTileCoverage)return;let u=this.tileID.canonical,d=H0(Sw(u,r)),p=Sd(r.zoom),_;p>0&&(_=i.ad.invert(new Float64Array(16),r.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,u,r,d,_,p),this._makeGlobeTileDebugTextBuffer(e,u,r,d,_,p)}_globePoint(e,r,s,u,d,p,_){let v=U0(e,r,s);if(p){let w=1<<s.z,E=Mh(u.center.lng),k=Dh(u.center.lat),D=(s.x+.5)/w-E,N=0;D>.5?N=-1:D<-.5&&(N=1);let B=(e/rt+s.x)/w+N,q=(r/rt+s.y)/w;B=(B-E)*u._pixelsPerMercatorPixel+E,q=(q-k)*u._pixelsPerMercatorPixel+k;let Z=[B*u.worldSize,q*u.worldSize,0];i._.transformMat4(Z,Z,p),v=Td(v,Z,_)}return i._.transformMat4(v,v,d)}_makeGlobeTileDebugBorderBuffer(e,r,s,u,d,p){let _=new Bu,v=new R0,w=new o_,E=(D,N,B,q,Z)=>{let oe=(B-D)/(Z-1),ve=(q-N)/(Z-1),be=_.length;for(let we=0;we<Z;we++){let $e=D+we*oe,Ge=N+we*ve;_.emplaceBack($e,Ge);let it=this._globePoint($e,Ge,r,s,u,d,p);w.emplaceBack(it[0],it[1],it[2]),v.emplaceBack(be+we)}},k=rt;E(0,0,k,0,16),E(k,0,k,k,16),E(k,k,0,k,16),E(0,k,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(v),this._tileDebugBuffer=e.createVertexBuffer(_,V0.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(w,ww.members),this._tileDebugSegments=oa.simpleSegment(0,0,_.length,v.length)}_makeGlobeTileDebugTextBuffer(e,r,s,u,d,p){let _=rt/4,v=new Bu,w=new ko,E=new o_,k=25;w.reserve(32),v.reserve(k),E.reserve(k);let D=(N,B)=>k*N+B;for(let N=0;N<k;N++){let B=N*_;for(let q=0;q<k;q++){let Z=q*_;v.emplaceBack(Z,B);let oe=this._globePoint(Z,B,r,s,u,d,p);E.emplaceBack(oe[0],oe[1],oe[2])}}for(let N=0;N<4;N++)for(let B=0;B<4;B++){let q=D(N,B),Z=D(N,B+1),oe=D(N+1,B),ve=D(N+1,B+1);w.emplaceBack(q,Z,oe),w.emplaceBack(oe,Z,ve)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(w),this._tileDebugTextBuffer=e.createVertexBuffer(v,V0.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(E,ww.members),this._tileDebugTextSegments=oa.simpleSegment(0,0,k,32)}destroy(e=!1){for(let r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!e&&this.texture&&this.texture instanceof nu&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}let hr={read:function(t,e){return t.readFields(hr._readField,{header_length:0,x:0,y:0,z:0,layers:[]},e)},_readField:function(t,e,r){t===1?e.header_length=r.readFixed32():t===2?e.x=r.readVarint():t===3?e.y=r.readVarint():t===4?e.z=r.readVarint():t===5&&e.layers.push(hr.Layer.read(r,r.readVarint()+r.pos))},PixelFormat:{PIXEL_FORMAT_UNKNOWN:{value:0,options:{}},PIXEL_FORMAT_UINT32:{value:1,options:{}},PIXEL_FORMAT_UINT16:{value:2,options:{}},PIXEL_FORMAT_UINT8:{value:3,options:{}}},Filter:{}};hr.Filter.read=function(t,e){return t.readFields(hr.Filter._readField,{delta_filter:null,filter:null,zigzag_filter:null,bitshuffle_filter:null,byteshuffle_filter:null},e)},hr.Filter._readField=function(t,e,r){t===1?(e.delta_filter=hr.Filter.Delta.read(r,r.readVarint()+r.pos),e.filter="delta_filter"):t===2?(e.zigzag_filter=hr.Filter.Zigzag.read(r,r.readVarint()+r.pos),e.filter="zigzag_filter"):t===3?(e.bitshuffle_filter=hr.Filter.BitShuffle.read(r,r.readVarint()+r.pos),e.filter="bitshuffle_filter"):t===4&&(e.byteshuffle_filter=hr.Filter.ByteShuffle.read(r,r.readVarint()+r.pos),e.filter="byteshuffle_filter")},hr.Filter.Delta={},hr.Filter.Delta.read=function(t,e){return t.readFields(hr.Filter.Delta._readField,{block_size:0},e)},hr.Filter.Delta._readField=function(t,e,r){t===1&&(e.block_size=r.readVarint())},hr.Filter.Zigzag={},hr.Filter.Zigzag.read=function(t,e){return t.readFields(hr.Filter.Zigzag._readField,{},e)},hr.Filter.Zigzag._readField=function(t,e,r){},hr.Filter.BitShuffle={},hr.Filter.BitShuffle.read=function(t,e){return t.readFields(hr.Filter.BitShuffle._readField,{},e)},hr.Filter.BitShuffle._readField=function(t,e,r){},hr.Filter.ByteShuffle={},hr.Filter.ByteShuffle.read=function(t,e){return t.readFields(hr.Filter.ByteShuffle._readField,{},e)},hr.Filter.ByteShuffle._readField=function(t,e,r){},hr.Codec={},hr.Codec.read=function(t,e){return t.readFields(hr.Codec._readField,{gzip_data:null,codec:null,jpeg_image:null,webp_image:null,png_image:null},e)},hr.Codec._readField=function(t,e,r){t===1?(e.gzip_data=hr.Codec.GzipData.read(r,r.readVarint()+r.pos),e.codec="gzip_data"):t===2?(e.jpeg_image=hr.Codec.JpegImage.read(r,r.readVarint()+r.pos),e.codec="jpeg_image"):t===3?(e.webp_image=hr.Codec.WebpImage.read(r,r.readVarint()+r.pos),e.codec="webp_image"):t===4&&(e.png_image=hr.Codec.PngImage.read(r,r.readVarint()+r.pos),e.codec="png_image")},hr.Codec.GzipData={},hr.Codec.GzipData.read=function(t,e){return t.readFields(hr.Codec.GzipData._readField,{},e)},hr.Codec.GzipData._readField=function(t,e,r){},hr.Codec.JpegImage={},hr.Codec.JpegImage.read=function(t,e){return t.readFields(hr.Codec.JpegImage._readField,{},e)},hr.Codec.JpegImage._readField=function(t,e,r){},hr.Codec.WebpImage={},hr.Codec.WebpImage.read=function(t,e){return t.readFields(hr.Codec.WebpImage._readField,{},e)},hr.Codec.WebpImage._readField=function(t,e,r){},hr.Codec.PngImage={},hr.Codec.PngImage.read=function(t,e){return t.readFields(hr.Codec.PngImage._readField,{},e)},hr.Codec.PngImage._readField=function(t,e,r){},hr.DataIndexEntry={},hr.DataIndexEntry.read=function(t,e){return t.readFields(hr.DataIndexEntry._readField,{first_byte:0,last_byte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},e)},hr.DataIndexEntry._readField=function(t,e,r){t===1?e.first_byte=r.readFixed64():t===2?e.last_byte=r.readFixed64():t===3?e.filters.push(hr.Filter.read(r,r.readVarint()+r.pos)):t===4?e.codec=hr.Codec.read(r,r.readVarint()+r.pos):t===5?e.offset=r.readFloat():t===6?e.scale=r.readFloat():t===7&&e.bands.push(r.readString())},hr.Layer={},hr.Layer.read=function(t,e){return t.readFields(hr.Layer._readField,{version:0,name:"",units:"",tilesize:0,buffer:0,pixel_format:0,data_index:[]},e)},hr.Layer._readField=function(t,e,r){t===1?e.version=r.readVarint():t===2?e.name=r.readString():t===3?e.units=r.readString():t===4?e.tilesize=r.readVarint():t===5?e.buffer=r.readVarint():t===6?e.pixel_format=r.readVarint():t===7&&e.data_index.push(hr.DataIndexEntry.read(r,r.readVarint()+r.pos))};let Gu={read:function(t,e){return t.readFields(Gu._readField,{uint32_values:null,values:null,fixed32_values:null},e)},_readField:function(t,e,r){t===2?(e.uint32_values=Gu.Uint32Values.read(r,r.readVarint()+r.pos),e.values="uint32_values"):t===3&&(e.fixed32_values=Gu.Fixed32Values.read(r,r.readVarint()+r.pos),e.values="fixed32_values")},Uint32Values:{}};Gu.Uint32Values.read=function(t,e){return t.readFields(Gu.Uint32Values._readField,{values:[]},e)},Gu.Uint32Values._readField=function(t,e,r){t===1&&(e.readValuesInto=function(s){if(s.type!==2)throw new Error(`Unsupported pbf type "${s.type}"`);let u=function(p){return p.type===2?p.readVarint()+p.pos:p.pos+1}(s),d=s.pos;return s.pos=u,function(p){s.pos=d;let _=0;for(;s.pos<u;){let v=s.readVarint();p[_++]=v}return p}}(r))},Gu.Fixed32Values={},Gu.Fixed32Values.read=function(t,e){return t.readFields(Gu.Fixed32Values._readField,{values:[]},e)},Gu.Fixed32Values._readField=function(t,e,r){throw new Error("Not implemented")};class zM{constructor(e=0,r=0,s=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=e,this.resetTtl=s,this.size=0,this.ttl=r}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(e){if(this.has(e)){let r=this.items[e];delete this.items[e],this.size--,r.prev!==null&&(r.prev.next=r.next),r.next!==null&&(r.next.prev=r.prev),this.first===r&&(this.first=r.next),this.last===r&&(this.last=r.prev)}return this}entries(e=this.keys()){return e.map(r=>[r,this.get(r)])}evict(e=!1){if(e||this.size>0){let r=this.first;delete this.items[r.key],--this.size==0?(this.first=null,this.last=null):(this.first=r.next,this.first.prev=null)}return this}expiresAt(e){let r;return this.has(e)&&(r=this.items[e].expiry),r}get(e){let r;if(this.has(e)){let s=this.items[e];this.ttl>0&&s.expiry<=Date.now()?this.delete(e):(r=s.value,this.set(e,r,!0))}return r}has(e){return e in this.items}keys(){let e=[],r=this.first;for(;r!==null;)e.push(r.key),r=r.next;return e}set(e,r,s=!1,u=this.resetTtl){let d;if(s||this.has(e)){if(d=this.items[e],d.value=r,s===!1&&u&&(d.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.last!==d){let p=this.last,_=d.next,v=d.prev;this.first===d&&(this.first=d.next),d.next=null,d.prev=this.last,p.next=d,v!==null&&(v.next=_),_!==null&&(_.prev=v)}}else this.max>0&&this.size===this.max&&this.evict(!0),d=this.items[e]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:r},++this.size==1?this.first=d:this.last.next=d;return this.last=d,this}values(e=this.keys()){return e.map(r=>this.get(r))}}function jM(t,e){if(e.length!==4)throw new Error(`Expected data of dimension 4 but got ${e.length}.`);let r=e[3];for(let s=2;s>=1;s--){let u=s===1?1:0,d=s===2?1:0;for(let p=0;p<e[0];p++){let _=e[1]*p;for(let v=u;v<e[1];v++){let w=e[2]*(v+_);for(let E=d;E<e[2];E++){let k=e[3]*(E+w);for(let D=0;D<e[3];D++){let N=k+D;t[N]+=t[N-r]}}}}r*=e[s]}return t}function VM(t){for(let e=0,r=t.length;e<r;e++)t[e]=t[e]>>>1^-(1&t[e]);return t}function UM(t,e){switch(e){case"uint32":return t;case"uint16":for(let r=0;r<t.length;r+=2){let s=t[r],u=t[r+1];t[r]=(240&s)>>4|(61440&s)>>8|(240&u)<<4|61440&u,t[r+1]=15&s|(3840&s)>>4|(15&u)<<8|(3840&u)<<4}return t;case"uint8":for(let r=0;r<t.length;r+=4){let s=t[r],u=t[r+1],d=t[r+2],p=t[r+3];t[r+0]=(192&s)>>6|(192&u)>>4|(192&d)>>2|192&p,t[r+1]=(48&s)>>4|(48&u)>>2|48&d|(48&p)<<2,t[r+2]=(12&s)>>2|12&u|(12&d)<<2|(12&p)<<4,t[r+3]=3&s|(3&u)<<2|(3&d)<<4|(3&p)<<6}return t;default:throw new Error(`Invalid pixel format, "${e}"`)}}class If extends Error{constructor(e){super(e),this.name="MRTError"}}var kc=Uint8Array,Nm=Uint16Array,HM=Int32Array,yT=new kc([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),bT=new kc([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),GM=new kc([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),wT=function(t,e){for(var r=new Nm(31),s=0;s<31;++s)r[s]=e+=1<<t[s-1];var u=new HM(r[30]);for(s=1;s<30;++s)for(var d=r[s];d<r[s+1];++d)u[d]=d-r[s]<<5|s;return{b:r,r:u}},TT=wT(yT,2),ST=TT.b,WM=TT.r;ST[28]=258,WM[258]=28;for(var qM=wT(bT,0).b,ay=new Nm(32768),Xa=0;Xa<32768;++Xa){var Bm=(43690&Xa)>>1|(21845&Xa)<<1;ay[Xa]=((65280&(Bm=(61680&(Bm=(52428&Bm)>>2|(13107&Bm)<<2))>>4|(3855&Bm)<<4))>>8|(255&Bm)<<8)>>1}var sg=function(t,e,r){for(var s=t.length,u=0,d=new Nm(e);u<s;++u)t[u]&&++d[t[u]-1];var p,_=new Nm(e);for(u=1;u<e;++u)_[u]=_[u-1]+d[u-1]<<1;if(r){p=new Nm(1<<e);var v=15-e;for(u=0;u<s;++u)if(t[u])for(var w=u<<4|t[u],E=e-t[u],k=_[t[u]-1]++<<E,D=k|(1<<E)-1;k<=D;++k)p[ay[k]>>v]=w}else for(p=new Nm(s),u=0;u<s;++u)t[u]&&(p[u]=ay[_[t[u]-1]++]>>15-t[u]);return p},lg=new kc(288);for(Xa=0;Xa<144;++Xa)lg[Xa]=8;for(Xa=144;Xa<256;++Xa)lg[Xa]=9;for(Xa=256;Xa<280;++Xa)lg[Xa]=7;for(Xa=280;Xa<288;++Xa)lg[Xa]=8;var ET=new kc(32);for(Xa=0;Xa<32;++Xa)ET[Xa]=5;var $M=sg(lg,9,1),XM=sg(ET,5,1),oy=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},Wu=function(t,e,r){var s=e/8|0;return(t[s]|t[s+1]<<8)>>(7&e)&r},sy=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(7&e)},ZM=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],qu=function(t,e,r){var s=new Error(e||ZM[t]);if(s.code=t,Error.captureStackTrace&&Error.captureStackTrace(s,qu),!r)throw s;return s},YM=new kc(0),KM=typeof TextDecoder<"u"&&new TextDecoder;try{KM.decode(YM,{stream:!0})}catch{}let JM={gzip_data:"gzip"},QM={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},eD={uint32:1,uint16:2,uint8:4},tD={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};class ly{constructor(e=1){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=e}getLayer(e){return this.layers[e]}getHeaderLength(e){let r=new Uint8Array(e),s=new DataView(e);if(r[0]!==13)throw new If("File is not a valid MRT.");return s.getUint32(1,!0)}parseHeader(e){let r=new Uint8Array(e),s=this.getHeaderLength(e);if(r.length<s)throw new If(`Expected header with length >= ${s} but got buffer of length ${r.length}`);let u=new km(r.subarray(0,s)),d=hr.read(u);if(!isNaN(this.x)&&(this.x!==d.x||this.y!==d.y||this.z!==d.z))throw new If(`Invalid attempt to parse header ${d.z}/${d.x}/${d.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=d.x,this.y=d.y,this.z=d.z;for(let p of d.layers)this.layers[p.name]=new iD(p,{cacheSize:this._cacheSize});return this}createDecodingTask(e){let r=[],s=this.getLayer(e.layerName);for(let u=0;u<s.dataIndex.length;u++){let d=s.dataIndex[u],p=d.first_byte-e.firstByte,_=d.last_byte+1-e.firstByte;if(u<e.firstBlock||u>e.lastBlock||s._blocksInProgress.has(u))continue;let v={layerName:s.name,firstByte:p,lastByte:_,pixelFormat:s.pixelFormat,blockIndex:u,blockShape:[d.bands.length].concat(s.bandShape),buffer:s.buffer,codec:d.codec.codec,filters:d.filters.map(w=>w.filter)};s._blocksInProgress.add(u),r.push(v)}return new AT(r,()=>{r.forEach(u=>s._blocksInProgress.delete(u.blockIndex))},(u,d)=>{if(r.forEach(p=>s._blocksInProgress.delete(p.blockIndex)),u)throw u;d.forEach(p=>{this.getLayer(p.layerName).processDecodedData(p)})})}}class iD{constructor({version:e,name:r,units:s,tilesize:u,pixel_format:d,buffer:p,data_index:_},v){if(this.version=e,this.version!==1)throw new If(`Cannot parse raster layer encoded with MRT version ${e}`);this.name=r,this.units=s,this.tileSize=u,this.buffer=p,this.pixelFormat=QM[d],this.dataIndex=_,this.bandShape=[u+2*p,u+2*p,eD[this.pixelFormat]],this._decodedBlocks=function(w=1e3,E=0,k=!1){if(isNaN(w)||w<0)throw new TypeError("Invalid max value");if(isNaN(E)||E<0)throw new TypeError("Invalid ttl value");if(typeof k!="boolean")throw new TypeError("Invalid resetTtl value");return new zM(w,E,k)}(v?v.cacheSize:5),this._blocksInProgress=new Set}processDecodedData(e){let r=e.blockIndex.toString();this._decodedBlocks.get(r)||this._decodedBlocks.set(r,e.data)}getBlockForBand(e){let r=0;switch(typeof e){case"string":for(let[s,u]of this.dataIndex.entries()){for(let[d,p]of u.bands.entries())if(p===e)return{bandIndex:r+d,blockIndex:s,blockBandIndex:d};r+=u.bands.length}break;case"number":for(let[s,u]of this.dataIndex.entries()){if(e>=r&&e<r+u.bands.length)return{bandIndex:e,blockIndex:s,blockBandIndex:e-r};r+=u.bands.length}break;default:throw new If(`Invalid band \`${JSON.stringify(e)}\`. Expected string or integer.`)}throw new If(`Band not found: ${JSON.stringify(e)}`)}getDataRange(e){let r=1/0,s=-1/0,u=1/0,d=-1/0;for(let p of e){let{blockIndex:_}=this.getBlockForBand(p);if(_<0)throw new If(`Invalid band: ${JSON.stringify(p)}`);let v=this.dataIndex[_];u=Math.min(u,_),d=Math.max(d,_),r=Math.min(r,v.first_byte),s=Math.max(s,v.last_byte)}return{layerName:this.name,firstByte:r,lastByte:s,firstBlock:u,lastBlock:d}}hasBand(e){let{blockIndex:r}=this.getBlockForBand(e);return r>=0}hasDataForBand(e){let{blockIndex:r}=this.getBlockForBand(e);return r>=0&&!!this._decodedBlocks.get(r.toString())}getBandView(e){let{blockIndex:r,blockBandIndex:s}=this.getBlockForBand(e),u=this._decodedBlocks.get(r.toString());if(!u)throw new If(`Data for band ${JSON.stringify(e)} of layer "${this.name}" not decoded.`);let d=this.dataIndex[r],p=this.bandShape.reduce((w,E)=>w*E,1),_=s*p,v=u.subarray(_,_+p);return{data:v,bytes:new Uint8Array(v.buffer).subarray(v.byteOffset,v.byteOffset+v.byteLength),tileSize:this.tileSize,buffer:this.buffer,offset:d.offset,scale:d.scale}}}class AT{constructor(e,r,s){this.tasks=e,this._onCancel=r,this._onComplete=s,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(e,r){this._finalized||(this._onComplete(e,r),this._finalized=!0)}}ly.performDecoding=function(t,e){return Promise.all(e.tasks.map(r=>{let{layerName:s,firstByte:u,lastByte:d,pixelFormat:p,blockShape:_,blockIndex:v,filters:w,codec:E}=r,k=new Uint8Array(t).subarray(u,d+1),D=new Uint32Array(_[0]*_[1]*_[2]),N;if(E!=="gzip_data")throw new Error(`Unhandled codec: ${E}`);return N=function(B,q){if(!globalThis.DecompressionStream&&q==="gzip_data")return Promise.resolve(((be=function(Ge){Ge[0]==31&&Ge[1]==139&&Ge[2]==8||qu(6,"invalid gzip data");var it=Ge[3],ot=10;4&it&&(ot+=2+(Ge[10]|Ge[11]<<8));for(var _t=(it>>3&1)+(it>>4&1);_t>0;_t-=!Ge[ot++]);return ot+(2&it)}(ve=B))+8>ve.length&&qu(6,"invalid gzip data"),function(Ge,it,ot,_t){var Mt=Ge.length;if(!Mt||it.f&&!it.l)return ot||new kc(0);var At=!ot,zt=At||it.i!=2,Jt=it.i;At&&(ot=new kc(3*Mt));var Ot,Xt,Dt=function(Mf){var Df=ot.length;if(Mf>Df){var kp=new kc(Math.max(2*Df,Mf));kp.set(ot),ot=kp}},Zt=it.f||0,ri=it.p||0,Kt=it.b||0,Si=it.l,ei=it.d,li=it.m,Xi=it.n,zi=8*Mt;do{if(!Si){Zt=Wu(Ge,ri,1);var Oi=Wu(Ge,ri+1,3);if(ri+=3,!Oi){var ai=Ge[(Hr=4+((ri+7)/8|0))-4]|Ge[Hr-3]<<8,Yi=Hr+ai;if(Yi>Mt){Jt&&qu(0);break}zt&&Dt(Kt+ai),ot.set(Ge.subarray(Hr,Yi),Kt),it.b=Kt+=ai,it.p=ri=8*Yi,it.f=Zt;continue}if(Oi==1)Si=$M,ei=XM,li=9,Xi=5;else if(Oi==2){var mr=Wu(Ge,ri,31)+257,er=Wu(Ge,ri+10,15)+4,br=mr+Wu(Ge,ri+5,31)+1;ri+=14;for(var gr=new kc(br),Dr=new kc(19),Ji=0;Ji<er;++Ji)Dr[GM[Ji]]=Wu(Ge,ri+3*Ji,7);ri+=3*er;var gn=oy(Dr),mn=(1<<gn)-1,Zr=sg(Dr,gn,1);for(Ji=0;Ji<br;){var Hr,Yr=Zr[Wu(Ge,ri,mn)];if(ri+=15&Yr,(Hr=Yr>>4)<16)gr[Ji++]=Hr;else{var Pn=0,wn=0;for(Hr==16?(wn=3+Wu(Ge,ri,3),ri+=2,Pn=gr[Ji-1]):Hr==17?(wn=3+Wu(Ge,ri,7),ri+=3):Hr==18&&(wn=11+Wu(Ge,ri,127),ri+=7);wn--;)gr[Ji++]=Pn}}var da=gr.subarray(0,mr),la=gr.subarray(mr);li=oy(da),Xi=oy(la),Si=sg(da,li,1),ei=sg(la,Xi,1)}else qu(1);if(ri>zi){Jt&&qu(0);break}}zt&&Dt(Kt+131072);for(var ys=(1<<li)-1,Da=(1<<Xi)-1,Jn=ri;;Jn=ri){var oo=(Pn=Si[sy(Ge,ri)&ys])>>4;if((ri+=15&Pn)>zi){Jt&&qu(0);break}if(Pn||qu(2),oo<256)ot[Kt++]=oo;else{if(oo==256){Jn=ri,Si=null;break}var Ho=oo-254;oo>264&&(Ho=Wu(Ge,ri,(1<<(nl=yT[Ji=oo-257]))-1)+ST[Ji],ri+=nl);var Go=ei[sy(Ge,ri)&Da],Cn=Go>>4;if(Go||qu(3),ri+=15&Go,la=qM[Cn],Cn>3){var nl=bT[Cn];la+=sy(Ge,ri)&(1<<nl)-1,ri+=nl}if(ri>zi){Jt&&qu(0);break}zt&&Dt(Kt+131072);var Cd=Kt+Ho;if(Kt<la){var ou=0-la,Xu=Math.min(la,Cd);for(ou+Kt<0&&qu(3);Kt<Xu;++Kt)ot[Kt]=(void 0)[ou+Kt]}for(;Kt<Cd;++Kt)ot[Kt]=ot[Kt-la]}}it.l=Si,it.p=Jn,it.b=Kt,it.f=Zt,Si&&(Zt=1,it.m=li,it.d=ei,it.n=Xi)}while(!Zt);return Kt!=ot.length&&At?(Ot=ot,((Xt=Kt)==null||Xt>Ot.length)&&(Xt=Ot.length),new kc(Ot.subarray(0,Xt))):ot.subarray(0,Kt)}(ve.subarray(be,-8),{i:2},new kc(((Z=ve)[(oe=Z.length)-4]|Z[oe-3]<<8|Z[oe-2]<<16|Z[oe-1]<<24)>>>0))));var Z,oe,ve,be;let we=JM[q];if(!we)throw new Error(`Unhandled codec: ${q}`);let $e=new globalThis.DecompressionStream(we);return new Response(new Blob([B]).stream().pipeThrough($e)).arrayBuffer().then(Ge=>new Uint8Array(Ge))}(k,E).then(B=>{let q=Gu.read(new km(B));if(q.values==="uint32_values")return q.uint32_values.readValuesInto(D),new tD[p](D.buffer);throw new Error(`Unhandled numeric data "${q.values}"`)}),N.then(B=>{for(let q=w.length-1;q>=0;q--)switch(w[q]){case"delta_filter":jM(B,_);break;case"zigzag_filter":VM(B);break;case"bitshuffle_filter":UM(B,p);break;default:throw new Error(`Unhandled filter "${w[q]}"`)}return{layerName:s,blockIndex:v,data:B}}).catch(B=>{throw B})}))};class CT extends J_{constructor(e,r,s,u,d){super(e,r,s,u,d),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(e,r){let s=r.context,u=s.gl;this.texture=this.texture||r.getTileTexture(e.width),this.texture&&this.texture instanceof nu?this.texture.update(e,{useMipmap:!1,premultiply:!1}):this.texture=new nu(s,e,u.RGBA,{useMipmap:!1,premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(e=16384,r){let s=this._mrt=new ly(30),u=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(e-1)}});return this.entireBuffer=null,this.request=ro(u,(d,p,_,v)=>{if(d)r(d);else try{let w=s.getHeaderLength(p);if(w>e)return void(this.request=this.fetchHeader(w,r));s.parseHeader(p),this._isHeaderLoaded=!0;let E=0;for(let k of Object.values(s.layers))E=Math.max(E,k.dataIndex[k.dataIndex.length-1].last_byte);p.byteLength>=E&&(this.entireBuffer=p),r(null,this.entireBuffer||p,_,v)}catch(w){r(w)}}),this.request}fetchBand(e,r,s){let u=this._mrt;if(!this._isHeaderLoaded||!u)return void s(new Error("Tile header is not ready"));let d=this.actor;if(!d)return void s(new Error("Can't fetch tile band without an actor"));let p,_=(k,D)=>{p.complete(k,D),k?s(k):(this.updateTextureDescriptor(e,r),s(null,this.textureDescriptor&&this.textureDescriptor.img))},v=(k,D)=>{if(k)return s(k);let N=d.send("decodeRasterArray",{buffer:D,task:p},_,void 0,!0);this._workQueue.push(()=>{N&&N.cancel(),p.cancel()})},w=u.getLayer(e);if(!w)return void s(new Error(`Unknown sourceLayer "${e}"`));if(w.hasDataForBand(r))return this.updateTextureDescriptor(e,r),void s(null,this.textureDescriptor?this.textureDescriptor.img:null);let E=w.getDataRange([r]);if(p=u.createDecodingTask(E),!p||p.tasks.length)if(this.flushQueues(),this.entireBuffer)v(null,this.entireBuffer.slice(E.firstByte,E.lastByte+1));else{let k=Object.assign({},this.requestParams,{headers:{Range:`bytes=${E.firstByte}-${E.lastByte}`}}),D=ro(k,v);this._fetchQueue.push(()=>{D.cancel(),p.cancel()})}else s(null)}updateNeeded(e,r){return(!this.textureDescriptor||this.textureDescriptor.band!==r||this.textureDescriptor.layer!==e)&&this.state!=="errored"}updateTextureDescriptor(e,r){if(!this._mrt)return;let s=this._mrt.getLayer(e);if(!s||!s.hasBand(r)||!s.hasDataForBand(r))return;let{bytes:u,tileSize:d,buffer:p,offset:_,scale:v}=s.getBandView(r),w=d+2*p,E={data:u,width:w,height:w},k=this.texture;k&&k instanceof nu&&k.update(E,{useMipmap:!1,premultiply:!1}),this.textureDescriptor={layer:e,band:r,img:E,buffer:p,offset:_,tileSize:d,format:s.pixelFormat,mix:[v,256*v,65536*v,16777216*v]}}}class rD{constructor(e,r){this.max=e,this.onRemove=r,this.reset()}reset(){for(let e in this.data)for(let r of this.data[e])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(e,r,s){let u=e.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);let d={value:r,timeout:void 0};if(s!==void 0&&(d.timeout=setTimeout(()=>{this.remove(e,d)},s)),this.data[u].push(d),this.order.push(u),this.order.length>this.max){let p=this._getAndRemoveByKey(this.order[0]);p&&this.onRemove(p)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){let r=this.data[e].shift();return r.timeout&&clearTimeout(r.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),r.value}getByKey(e){let r=this.data[e];return r?r[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,r){if(!this.has(e))return this;let s=e.wrapped().key,u=r===void 0?0:this.data[s].indexOf(r),d=this.data[s][u];return this.data[s].splice(u,1),d.timeout&&clearTimeout(d.timeout),this.data[s].length===0&&delete this.data[s],this.onRemove(d.value),this.order.splice(this.order.indexOf(s),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){let r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(e){let r=[];for(let s in this.data)for(let u of this.data[s])e(u.value)||r.push(u);for(let s of r)this.remove(s.value.tileID,s)}}class Ep extends jl{constructor(e,r,s){super(),this.id=e,this._onlySymbols=s,r.on("data",u=>{u.dataType==="source"&&u.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&u.dataType==="source"&&u.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),r.on("error",()=>{this._sourceErrored=!0}),this._source=r,this._tiles={},this._cache=new rD(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=r.minTileCacheSize,this._maxTileCacheSize=r.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new oM,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(let e in this._tiles){let r=this._tiles[e];if(r.state!=="errored"&&(r.state!=="loaded"||!r.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,r){return e.isSymbolTile=this._onlySymbols,e.isExtraShadowCaster=this._shadowCasterTiles[e.tileID.key],this._source.loadTile(e,r)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e)}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e)}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let r in this._tiles){let s=this._tiles[r];s.upload(e),s.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return eo(this._tiles).map(e=>e.tileID).sort(IT).map(e=>e.key)}getRenderableIds(e,r){let s=[];for(let u in this._tiles)this._isIdRenderable(+u,e,r)&&s.push(this._tiles[u]);return e?s.sort((u,d)=>{let p=u.tileID,_=d.tileID,v=new hi(p.canonical.x,p.canonical.y)._rotate(this.transform.angle),w=new hi(_.canonical.x,_.canonical.y)._rotate(this.transform.angle);return p.overscaledZ-_.overscaledZ||w.y-v.y||w.x-v.x}).map(u=>u.tileID.key):s.map(u=>u.tileID).sort(IT).map(u=>u.key)}hasRenderableParent(e){let r=this.findLoadedParent(e,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(e,r,s){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(r||!this._tiles[e].holdingForFade())&&(s||!this._shadowCasterTiles[e])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(let e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,r){let s=this._tiles[e];s&&(s.state!=="loading"&&(s.state=r),this._loadTile(s,this._tileLoaded.bind(this,s,e,r)))}_tileLoaded(e,r,s,u){if(u)if(e.state="errored",u.status!==404)this._source.fire(new xc(u,{tile:e}));else{if(!(e.tileID.key in this._loadedParentTiles))return void this._source.fire(new Na("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id}));if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){let d=this.map.painter.terrain;this.update(this.transform,d.getScaledDemTileSize(),!0),d.resetTileLookupCache(this.id)}else this.update(this.transform)}else e.timeAdded=ur.now(),s==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Na("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){let r=this.getRenderableIds();for(let u=0;u<r.length;u++){let d=r[u];if(e.neighboringTiles&&e.neighboringTiles[d]){let p=this.getTileByID(d);s(e,p),s(p,e)}}function s(u,d){if(!u.dem||u.dem.borderReady)return;u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0;let p=d.tileID.canonical.x-u.tileID.canonical.x,_=d.tileID.canonical.y-u.tileID.canonical.y,v=Math.pow(2,u.tileID.canonical.z),w=d.tileID.key;p===0&&_===0||Math.abs(_)>1||(Math.abs(p)>1&&(Math.abs(p+v)===1?p+=v:Math.abs(p-v)===1&&(p-=v)),d.dem&&u.dem&&(u.dem.backfillBorder(d.dem,p,_),u.neighboringTiles&&u.neighboringTiles[w]&&(u.neighboringTiles[w].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,r,s,u){for(let d in this._tiles){let p=this._tiles[d];if(u[d]||!p.hasData()||p.tileID.overscaledZ<=r||p.tileID.overscaledZ>s)continue;let _=p.tileID;for(;p&&p.tileID.overscaledZ>r+1;){let w=p.tileID.scaledTo(p.tileID.overscaledZ-1);p=this._tiles[w.key],p&&p.hasData()&&(_=w)}let v=_;for(;v.overscaledZ>r;)if(v=v.scaledTo(v.overscaledZ-1),e[v.key]){u[_.key]=_;break}}}findLoadedParent(e,r){if(e.key in this._loadedParentTiles){let s=this._loadedParentTiles[e.key];return s&&s.tileID.overscaledZ>=r?s:null}for(let s=e.overscaledZ-1;s>=r;s--){let u=e.scaledTo(s),d=this._getLoadedTile(u);if(d)return d}}_getLoadedTile(e){let r=this._tiles[e.key];return r&&r.hasData()?r:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,r){r=r||this._source.tileSize;let s=Math.ceil(e.width/r)+1,u=Math.ceil(e.height/r)+1,d=Math.floor(s*u*5),p=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,d):d,_=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(_)}handleWrapJump(e){let r=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,r){let s={};for(let u in this._tiles){let d=this._tiles[u];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+r),s[d.tileID.key]=d}this._tiles=s;for(let u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(let u in this._tiles)this._setTileReloadTimer(+u,this._tiles[u])}}update(e,r,s,u){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!s)return;let d;if(this.updateCacheSize(e,r),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain){if(this._source.tileID)d=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(v=>new fo(v.canonical.z,v.wrap,v.canonical.z,v.canonical.x,v.canonical.y));else if(this.tileCoverLift!==0){let v=e.clone();v.tileCoverLift=this.tileCoverLift,d=v.coveringTiles({tileSize:r||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!s,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.minzoom<=1&&e.projection.name==="globe"&&(d.push(new fo(1,0,1,0,0)),d.push(new fo(1,0,1,1,0)),d.push(new fo(1,0,1,0,1)),d.push(new fo(1,0,1,1,1)))}else if(d=e.coveringTiles({tileSize:r||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!s,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile){let v=this._source.hasTile.bind(this._source);d=d.filter(w=>v(w))}}else d=[];if(d.length>0&&this.castsShadows&&u&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!cy(this._source.type)){let v=e.coveringZoomLevel({tileSize:r||this._source.tileSize,roundZoom:this._source.roundZoom&&!s}),w=Math.min(v,this._source.maxzoom),E=e.extendTileCoverForShadows(d,u,w);for(let k of E)this._shadowCasterTiles[k.key]=!0,d.push(k)}let p=this._updateRetainedTiles(d);if(cy(this._source.type)&&d.length!==0){let v={},w={},E=Object.keys(p);for(let D of E){let N=p[D],B=this._tiles[D];if(!B||B.fadeEndTime&&B.fadeEndTime<=ur.now())continue;let q=this.findLoadedParent(N,Math.max(N.overscaledZ-Ep.maxOverzooming,this._source.minzoom));q&&(this._addTile(q.tileID),v[q.tileID.key]=q.tileID),w[D]=N}let k=d[d.length-1].overscaledZ;for(let D in this._tiles){let N=this._tiles[D];if(p[D]||!N.hasData())continue;let B=N.tileID;for(;B.overscaledZ>k;){B=B.scaledTo(B.overscaledZ-1);let q=this._tiles[B.key];if(q&&q.hasData()&&w[B.key]){p[D]=N.tileID;break}}}for(let D in v)p[D]||(this._coveredTiles[D]=!0,p[D]=v[D])}for(let v in p)this._tiles[v].clearFadeHold();let _=function(v,w){let E=[];for(let k in v)k in w||E.push(k);return E}(this._tiles,p);for(let v of _){let w=this._tiles[v];w.hasSymbolBuckets&&!w.holdingForFade()?w.setHoldDuration(this.map._fadeDuration):w.hasSymbolBuckets&&!w.symbolFadeFinished()||this._removeTile(+v)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(let e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){let r={};if(e.length===0)return r;let s={},u=e.reduce((w,E)=>Math.min(w,E.overscaledZ),1/0),d=e[0].overscaledZ,p=Math.max(d-Ep.maxOverzooming,this._source.minzoom),_=Math.max(d+Ep.maxUnderzooming,this._source.minzoom),v={};for(let w of e){let E=this._addTile(w);r[w.key]=w,E.hasData()||u<this._source.maxzoom&&(v[w.key]=w)}this._retainLoadedChildren(v,u,_,r);for(let w of e){let E=this._tiles[w.key];if(E.hasData())continue;if(w.canonical.z>=this._source.maxzoom){let D=w.children(this._source.maxzoom)[0],N=this.getTile(D);if(N&&N.hasData()){r[D.key]=D;continue}}else{let D=w.children(this._source.maxzoom);if(r[D[0].key]&&r[D[1].key]&&r[D[2].key]&&r[D[3].key])continue}let k=E.wasRequested();for(let D=w.overscaledZ-1;D>=p;--D){let N=w.scaledTo(D);if(s[N.key]||(s[N.key]=!0,E=this.getTile(N),!E&&k&&(E=this._addTile(N)),E&&(r[N.key]=N,k=E.wasRequested(),E.hasData())))break}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(let e in this._tiles){let r=[],s,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){s=this._loadedParentTiles[u.key];break}r.push(u.key);let d=u.scaledTo(u.overscaledZ-1);if(s=this._getLoadedTile(d),s)break;u=d}for(let d of r)this._loadedParentTiles[d]=s}}_addTile(e){let r=this._tiles[e.key];if(r)return r.isExtraShadowCaster!==!0||this._shadowCasterTiles[e.key]||this._reloadTile(e.key,"reloading"),r;r=this._cache.getAndRemove(e),r&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));let s=!!r;if(!s){let u=this.map?this.map.painter:null,d=this._source.tileSize*e.overscaleFactor();r=this._source.type==="raster-array"?new CT(e,d,this.transform.tileZoom,u,this._isRaster):new J_(e,d,this.transform.tileZoom,u,this._isRaster),this._loadTile(r,this._tileLoaded.bind(this,r,e.key,r.state))}return r?(r.uses++,this._tiles[e.key]=r,s||this._source.fire(new Na("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null}_setTileReloadTimer(e,r){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);let s=r.getExpiryTimeout();s&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},s))}_removeTile(e){let r=this._tiles[e];r&&(r.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),r.uses>0||(r.hasData()&&r.state!=="reloading"||r.state==="empty"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,r,s){let u=[],d=this.transform;if(!d)return u;let p=d.projection.name==="globe",_=Mh(d.center.lng);for(let v in this._tiles){let w=this._tiles[v];if(s&&w.clearQueryDebugViz(),w.holdingForFade())continue;let E;if(p){let k=w.tileID.canonical;if(k.z===0){let D=[Math.abs(lr(_,...cg(k,-1))-_),Math.abs(lr(_,...cg(k,1))-_)];E=[0,2*D.indexOf(Math.min(...D))-1]}else{let D=[Math.abs(lr(_,...cg(k,-1))-_),Math.abs(lr(_,...cg(k,0))-_),Math.abs(lr(_,...cg(k,1))-_)];E=[D.indexOf(Math.min(...D))-1]}}else E=[0];for(let k of E){let D=e.containsTile(w,d,r,k);D&&u.push(D)}}return u}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(e){return this._getRenderableCoordinates(e)}_getRenderableCoordinates(e,r){let s=this.getRenderableIds(e,r).map(d=>this._tiles[d].tileID),u=this.transform.projection.name==="globe";for(let d of s)d.projMatrix=this.transform.calculateProjMatrix(d.toUnwrapped()),d.expandedProjMatrix=u?this.transform.calculateProjMatrix(d.toUnwrapped(),!1,!0):d.projMatrix;return s}sortCoordinatesByDistance(e){let r=e.slice(),s=this.transform._camera.position,u=this.transform._camera.forward(),d={};for(let p of r){let _=1/(1<<p.canonical.z);d[p.key]=((p.canonical.x+.5)*_+p.wrap-s[0])*u[0]+((p.canonical.y+.5)*_-s[1])*u[1]-s[2]*u[2]}return r.sort((p,_)=>d[p.key]-d[_.key]),r}hasTransition(){if(this._source.hasTransition())return!0;if(cy(this._source.type))for(let e in this._tiles){let r=this._tiles[e];if(r.fadeEndTime!==void 0&&r.fadeEndTime>=ur.now())return!0}return!1}setFeatureState(e,r,s){this._state.updateState(e=e||"_geojsonTileLayer",r,s)}removeFeatureState(e,r,s){this._state.removeFeatureState(e=e||"_geojsonTileLayer",r,s)}getFeatureState(e,r){return this._state.getState(e=e||"_geojsonTileLayer",r)}setDependencies(e,r,s){let u=this._tiles[e];u&&u.setDependencies(r,s)}reloadTilesForDependencies(e,r){for(let s in this._tiles)this._tiles[s].hasDependency(e,r)&&this._reloadTile(+s,"reloading");this._cache.filter(s=>!s.hasDependency(e,r))}_preloadTiles(e,r){if(!this._sourceLoaded){let _=()=>{this._sourceLoaded&&(this._source.off("data",_),this._preloadTiles(e,r))};return void this._source.on("data",_)}let s=new Map,u=Array.isArray(e)?e:[e],d=this.map.painter.terrain,p=this.usedForTerrain&&d?d.getScaledDemTileSize():this._source.tileSize;for(let _ of u){let v=_.coveringTiles({tileSize:p,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(let w of v)s.set(w.key,w);this.usedForTerrain&&_.updateElevation(!1)}cc(Array.from(s.values()),(_,v)=>{let w=new J_(_,this._source.tileSize*_.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(w,E=>{this._source.type==="raster-dem"&&w.dem&&this._backfillDEM(w),v(E,w)})},r)}}function IT(t,e){let r=Math.abs(2*t.wrap)-+(t.wrap<0),s=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||s-r||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function cy(t){return t==="raster"||t==="image"||t==="video"||t==="custom"}function cg(t,e){let r=1<<t.z;return[t.x/r+e,(t.x+1)/r+e]}Ep.maxOverzooming=10,Ep.maxUnderzooming=3;let kT=new class extends _i{possiblyEvaluate(t,e){return e=new ir(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,r,s){return e=ya({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,r,s)}}(L_.paint.properties["line-width"].specification);function MT(t,e){return e>0?e+2*t:t}kT.useIntegerZoom=!0;let nD=new rn({"symbol-placement":new Gt(xt.layout_symbol["symbol-placement"]),"symbol-spacing":new Gt(xt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Gt(xt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new _i(xt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Gt(xt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Gt(xt.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new Gt(xt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Gt(xt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Gt(xt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Gt(xt.layout_symbol["icon-rotation-alignment"]),"icon-size":new _i(xt.layout_symbol["icon-size"]),"icon-text-fit":new _i(xt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new _i(xt.layout_symbol["icon-text-fit-padding"]),"icon-image":new _i(xt.layout_symbol["icon-image"]),"icon-rotate":new _i(xt.layout_symbol["icon-rotate"]),"icon-padding":new Gt(xt.layout_symbol["icon-padding"]),"icon-keep-upright":new Gt(xt.layout_symbol["icon-keep-upright"]),"icon-offset":new _i(xt.layout_symbol["icon-offset"]),"icon-anchor":new _i(xt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Gt(xt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Gt(xt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Gt(xt.layout_symbol["text-rotation-alignment"]),"text-field":new _i(xt.layout_symbol["text-field"]),"text-font":new _i(xt.layout_symbol["text-font"]),"text-size":new _i(xt.layout_symbol["text-size"]),"text-max-width":new _i(xt.layout_symbol["text-max-width"]),"text-line-height":new _i(xt.layout_symbol["text-line-height"]),"text-letter-spacing":new _i(xt.layout_symbol["text-letter-spacing"]),"text-justify":new _i(xt.layout_symbol["text-justify"]),"text-radial-offset":new _i(xt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Gt(xt.layout_symbol["text-variable-anchor"]),"text-anchor":new _i(xt.layout_symbol["text-anchor"]),"text-max-angle":new Gt(xt.layout_symbol["text-max-angle"]),"text-writing-mode":new Gt(xt.layout_symbol["text-writing-mode"]),"text-rotate":new _i(xt.layout_symbol["text-rotate"]),"text-padding":new Gt(xt.layout_symbol["text-padding"]),"text-keep-upright":new Gt(xt.layout_symbol["text-keep-upright"]),"text-transform":new _i(xt.layout_symbol["text-transform"]),"text-offset":new _i(xt.layout_symbol["text-offset"]),"text-allow-overlap":new Gt(xt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Gt(xt.layout_symbol["text-ignore-placement"]),"text-optional":new Gt(xt.layout_symbol["text-optional"]),visibility:new Gt(xt.layout_symbol.visibility)});var uy={paint:new rn({"icon-opacity":new _i(xt.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new _i(xt.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new _i(xt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new _i(xt.paint_symbol["text-emissive-strength"]),"icon-color":new _i(xt.paint_symbol["icon-color"]),"icon-halo-color":new _i(xt.paint_symbol["icon-halo-color"]),"icon-halo-width":new _i(xt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new _i(xt.paint_symbol["icon-halo-blur"]),"icon-translate":new Gt(xt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Gt(xt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new _i(xt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new _i(xt.paint_symbol["text-opacity"]),"text-occlusion-opacity":new _i(xt.paint_symbol["text-occlusion-opacity"]),"text-color":new _i(xt.paint_symbol["text-color"],{runtimeType:Ao,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new _i(xt.paint_symbol["text-halo-color"]),"text-halo-width":new _i(xt.paint_symbol["text-halo-width"]),"text-halo-blur":new _i(xt.paint_symbol["text-halo-blur"]),"text-translate":new Gt(xt.paint_symbol["text-translate"]),"text-translate-anchor":new Gt(xt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Gt(xt.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Gt(xt.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Gt(xt.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Gt(xt.paint_symbol["icon-color-brightness-max"])}),layout:nD};class DT{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:vc,this.defaultValue=e}evaluate(e){if(e.formattedSection){let r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Pe(DT,"FormatSectionOverride",{omit:["defaultValue"]});class Q_ extends ho{constructor(e,r,s,u){super(e,uy,r,s,u),this._colorAdjustmentMatrix=i.ad.identity([]),this.hasInitialOcclusionOpacityProperties=e.paint!==void 0&&("icon-occlusion-opacity"in e.paint||"text-occlusion-opacity"in e.paint)}recalculate(e,r){super.recalculate(e,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));let s=this.layout.get("text-writing-mode");if(s){let u=[];for(let d of s)u.indexOf(d)<0&&u.push(d);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(e,r,s,u){return this._saturation===e&&this._contrast===r&&this._brightnessMin===s&&this._brightnessMax===u||(this._colorAdjustmentMatrix=function(d,p,_,v){d=cr(d),p=Zi(p);let w=i.ad.create(),E=d/3,k=1-2*E,D=[k,E,E,0,E,k,E,0,E,E,k,0,0,0,0,1],N=.5-.5*p,B=v-_;return i.ad.multiply(w,[B,0,0,0,0,B,0,0,0,0,B,0,_,_,_,1],[p,0,0,0,0,p,0,0,0,0,p,0,N,N,N,1]),i.ad.multiply(w,w,D),w}(e,r,s,u),this._saturation=e,this._contrast=r,this._brightnessMin=s,this._brightnessMax=u),this._colorAdjustmentMatrix}getValueAndResolveTokens(e,r,s,u){let d=this.layout.get(e).evaluate(r,{},s,u),p=this._unevaluatedLayout._values[e];return p.isDataDriven()||X(p.value)||!d?d:function(_,v){return v.replace(/{([^{}]+)}/g,(w,E)=>E in _?String(_[E]):"")}(r.properties,d)}createBucket(e){return new Om(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(let e of uy.paint.overridableProperties){if(!Q_.hasPaintOverride(this.layout,e))continue;let r=this.paint.get(e),s=new DT(r),u=new j(s,r.property.specification,this.scope,this.options),d=null;d=r.value.kind==="constant"||r.value.kind==="source"?new ae("source",u):new ue("composite",u,r.value.zoomStops,r.value._interpolationType),this.paint._values[e]=new zn(r.property,d,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,s){return!(!this.layout||r.isDataDriven()||s.isDataDriven())&&Q_.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){let s=e.get("text-field"),u=uy.paint.properties[r],d=!1,p=_=>{for(let v of _)if(u.overrides&&u.overrides.hasOverride(v))return void(d=!0)};if(s.value.kind==="constant"&&s.value.value instanceof Ga)p(s.value.value.sections);else if(s.value.kind==="source"){let _=w=>{d||(w instanceof bc&&Ba(w.value)===xh?p(w.value.sections):w instanceof Os?p(w.sections):w.eachChild(_))},v=s.value;v._styleExpression&&_(v._styleExpression.expression)}return d}getProgramIds(){let e=this.paint.get("icon-opacity").constantOr(1)!==0,r=this.paint.get("text-opacity").constantOr(1)!==0,s=[];return e&&s.push("symbolIcon"),r&&s.push("symbolSDF"),s}getDefaultProgramParams(e,r,s){return{config:new xp(this,{zoom:r,lut:s}),overrideFog:!1}}}let aD=new rn({visibility:new Gt(xt.layout_background.visibility)});var oD={paint:new rn({"background-color":new Gt(xt.paint_background["background-color"]),"background-pattern":new Gt(xt.paint_background["background-pattern"]),"background-opacity":new Gt(xt.paint_background["background-opacity"]),"background-emissive-strength":new Gt(xt.paint_background["background-emissive-strength"])}),layout:aD};let sD=new rn({visibility:new Gt(xt.layout_raster.visibility)});var lD={paint:new rn({"raster-opacity":new Gt(xt.paint_raster["raster-opacity"]),"raster-color":new aa(xt.paint_raster["raster-color"]),"raster-color-mix":new Gt(xt.paint_raster["raster-color-mix"]),"raster-color-range":new Gt(xt.paint_raster["raster-color-range"]),"raster-hue-rotate":new Gt(xt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Gt(xt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Gt(xt.paint_raster["raster-brightness-max"]),"raster-saturation":new Gt(xt.paint_raster["raster-saturation"]),"raster-contrast":new Gt(xt.paint_raster["raster-contrast"]),"raster-resampling":new Gt(xt.paint_raster["raster-resampling"]),"raster-fade-duration":new Gt(xt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Gt(xt.paint_raster["raster-emissive-strength"]),"raster-array-band":new Gt(xt.paint_raster["raster-array-band"]),"raster-elevation":new Gt(xt.paint_raster["raster-elevation"])}),layout:sD};function e1(t,e,r,s,u,d,p,_){let v=[t,e,1,r,s,1,u,d,1],w=[p,_,1],E=i.bC.adjoint([],v),[k,D,N]=i._.transformMat3(w,w,E);return i.bC.multiply(v,v,[k,0,0,0,D,0,0,0,N])}function FT(t,e,r,s,u,d,p,_){let v=function(w,E,k,D,N,B,q,Z){let oe=e1(0,0,1,0,1,1,0,1),ve=e1(w,E,k,D,N,B,q,Z),be=i.bC.adjoint([],oe);return i.bC.multiply(ve,ve,be)}(t,e,r,s,u,d,p,_);return[v[2]/v[8]/rt,v[5]/v[8]/rt]}function t1(t){return[t[0],Math.min(Math.max(t[1],-ja),ja)]}class PT extends jl{constructor(e,r,s,u){super(),this.id=e,this.dispatcher=s,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(u),this.options=r,this._dirty=!1}load(e,r){if(this._loaded=r||!1,this.fire(new Na("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return e&&(this.coordinates=e),this._loaded=!0,void this._finishLoading();this._imageRequest=Xs(this.map._requestManager.transformRequest(this.url,fc.Image),(s,u)=>{this._imageRequest=null,this._loaded=!0,s?this.fire(new xc(s)):u&&(this.image=u instanceof HTMLImageElement?ur.getImageData(u):u,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,e&&(this.coordinates=e),this._finishLoading())})}loaded(){return this._loaded}updateImage(e){return e.url?(this._imageRequest&&e.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=e.url,this.load(e.coordinates,this._loaded),this):this}setTexture(e){if(!(e.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new Z_(this.map.painter.context,e.handle),this.width=e.dimensions[0],this.height=e.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Na("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(e){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof Z_||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(e){if(this.coordinates=e,this._boundsArray=void 0,this._unsupportedCoords=!1,!e.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let r=e[0][1],s=e[0][1];for(let d of e)d[1]>s&&(s=d[1]),d[1]<r&&(r=d[1]);let u=(s+r)/2;if(u>ja?this.onNorthPole=!0:u<-ja&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){let d=e.map(vs.fromLngLat);this.tileID=function(p){let _=1/0,v=1/0,w=-1/0,E=-1/0;for(let q of p)_=Math.min(_,q.x),v=Math.min(v,q.y),w=Math.max(w,q.x),E=Math.max(E,q.y);let k=Math.max(w-_,E-v),D=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),N=Math.pow(2,D),B=Math.floor((_+w)/2*N);return B>1&&(B-=1),new yp(D,B,Math.floor((v+E)/2*N))}(d),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Na("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(e){for(let Z in this.tiles){let oe=this.tiles[Z];oe.state!=="loaded"&&(oe.state="loaded",oe.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;let r=Sp(new yp(0,0,0),this.map.transform.projection),s=[r.projection.project(this.coordinates[0][0],this.coordinates[0][1]),r.projection.project(this.coordinates[1][0],this.coordinates[1][1]),r.projection.project(this.coordinates[2][0],this.coordinates[2][1]),r.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(Z){let oe=Z[1].x-Z[0].x,ve=Z[1].y-Z[0].y,be=Z[2].x-Z[1].x,we=Z[2].y-Z[1].y,$e=Z[3].x-Z[2].x,Ge=Z[3].y-Z[2].y,it=Z[0].x-Z[3].x,ot=Z[0].y-Z[3].y,_t=oe*we-be*ve,Mt=be*Ge-$e*we,At=$e*ot-it*Ge,zt=it*ve-oe*ot;return _t>0&&Mt>0&&At>0&&zt>0||_t<0&&Mt<0&&At<0&&zt<0}(s))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);let u=Sp(this.tileID,this.map.transform.projection),[d,p,_,v]=this.coordinates.map(Z=>{let oe=u.projection.project(Z[0],Z[1]);return dT(u,oe)._round()});this.perspectiveTransform=FT(d.x,d.y,p.x,p.y,_.x,_.y,v.x,v.y);let w=this._boundsArray=new hf;w.emplaceBack(d.x,d.y,0,0),w.emplaceBack(p.x,p.y,rt,0),w.emplaceBack(v.x,v.y,0,rt),w.emplaceBack(_.x,_.y,rt,rt),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=e.createVertexBuffer(w,K_.members),this.boundsSegments=oa.simpleSegment(0,0,4,2);let E=[],k=function(Z){return[t1(Z[0]),t1(Z[1]),t1(Z[2]),t1(Z[3])]}(this.coordinates),[D,N,B,q]=function(Z){let oe=Z[0][0],ve=oe,be=Z[0][1],we=be;for(let $e=1;$e<Z.length;$e++)Z[$e][0]<oe?oe=Z[$e][0]:Z[$e][0]>ve&&(ve=Z[$e][0]),Z[$e][1]<be?be=Z[$e][1]:Z[$e][1]>we&&(we=Z[$e][1]);return[oe,be,ve-oe,we-be]}(k);{let Z=new hf,[oe,ve,be,we]=function(Dt){let Zt=Dt[0].x,ri=Zt,Kt=Dt[0].y,Si=Kt;for(let ei=1;ei<Dt.length;ei++)Dt[ei].x<Zt?Zt=Dt[ei].x:Dt[ei].x>ri&&(ri=Dt[ei].x),Dt[ei].y<Kt?Kt=Dt[ei].y:Dt[ei].y>Si&&(Si=Dt[ei].y);return[Zt,Kt,ri-Zt,Si-Kt]}(s),$e=Dt=>[(Dt.x-oe)/be,(Dt.y-ve)/we],[Ge,it,ot,_t]=s.map($e),Mt=function(Dt,Zt,ri,Kt,Si,ei,li,Xi){let zi=e1(0,0,1,0,1,1,0,1),Oi=e1(Dt,Zt,ri,Kt,Si,ei,li,Xi),ai=i.bC.adjoint([],Oi);return i.bC.multiply(zi,zi,ai)}(Ge[0],Ge[1],it[0],it[1],ot[0],ot[1],_t[0],_t[1]);this.elevatedGlobePerspectiveTransform=FT(Ge[0],Ge[1],it[0],it[1],ot[0],ot[1],_t[0],_t[1]);let At=(Dt,Zt)=>{E.push(Dt.lng);let ri=Math.round((Dt.lng-D)/B*rt),Kt=Math.round((Dt.lat-N)/q*rt),Si=$e(Zt),ei=i._.transformMat3([],[Si[0],Si[1],1],Mt),li=Math.round(ei[0]/ei[2]*rt),Xi=Math.round(ei[1]/ei[2]*rt);Z.emplaceBack(ri,Kt,li,Xi)},zt=s[3].x-s[0].x,Jt=s[3].y-s[0].y,Ot=s[2].x-s[1].x,Xt=s[2].y-s[1].y;for(let Dt=0;Dt<65;Dt++){let Zt=Dt/64,ri=[s[0].x+Zt*zt,s[0].y+Zt*Jt],Kt=[s[1].x+Zt*Ot,s[1].y+Zt*Xt],Si=Kt[0]-ri[0],ei=Kt[1]-ri[1];for(let li=0;li<65;li++){let Xi=li/64,zi={x:ri[0]+Si*Xi,y:ri[1]+ei*Xi,z:0};At(r.projection.unproject(zi.x,zi.y),zi)}}this.elevatedGlobeVertexBuffer=e.createVertexBuffer(Z,K_.members)}{this.maxLongitudeTriangleSize=0;let Z=[],oe=new ko,ve=(be,we,$e)=>{oe.emplaceBack(be,we,$e);let Ge=E[be],it=E[we],ot=E[$e],_t=Math.min(Math.min(Ge,it),ot),Mt=Math.max(Math.max(Ge,it),ot)-_t;Mt>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Mt),Z.push(_t+Mt/2)};for(let be=0;be<64;be++)for(let we=0;we<64;we++){let $e=65*be+we,Ge=$e+1,it=$e+65,ot=it+1;ve($e,it,Ge),ve(Ge,it,ot)}[Z,oe]=function(be,we){let $e=Array.from({length:be.length},(ot,_t)=>_t);$e.sort((ot,_t)=>be[ot]-be[_t]);let Ge=[],it=new ko;for(let ot=0;ot<$e.length;ot++){let _t=$e[ot];Ge.push(be[_t]);let Mt=3*_t,At=Mt+1;it.emplaceBack(we.uint16[Mt],we.uint16[At],we.uint16[At+1])}return[Ge,it]}(Z,oe),this.elevatedGlobeTrianglesCenterLongitudes=Z,this.elevatedGlobeIndexBuffer=e.createIndexBuffer(oe)}this.elevatedGlobeSegments=oa.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,B/rt,0,q/rt,0,0,N,D,0])}prepare(){let e=Object.keys(this.tiles).length!==0;if(this.tileID&&!e)return;let r=this.map.painter.context,s=r.gl;!this._dirty||this.texture instanceof Z_||(this.texture?this.texture.update(this.image):(this.texture=new nu(r,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE)),this._dirty=!1),e&&this._prepareData(r)}loadTile(e,r){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},r(null)):(e.state="errored",r(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(e){let r=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!r)return null;let s=this.elevatedGlobeTrianglesCenterLongitudes,u=(d=e+180)+360*Math.round((s[0]-d)/360);var d;let p=new oa,_=(k,D)=>{p.segments.push({vertexOffset:0,primitiveOffset:k,vertexLength:r.segments[0].vertexLength,primitiveLength:D,sortKey:void 0,vaos:{}})},v=.51*this.maxLongitudeTriangleSize;if(Math.abs(s[0]-u)<=v){let k=Mi(s,0,s.length,u+v);return k===s.length||_(k,si(s,k+1,s.length,u+360-v)-k),p}u<s[0]&&(u+=360);let w=si(s,0,s.length,u-v);if(w===s.length)return _(0,s.length),p;_(0,w-0);let E=Mi(s,w+1,s.length,u+v);return E!==s.length&&_(E,s.length-E),p}}let cD=(Math.pow(256,2)-1)/16907520;class LT extends ho{constructor(e,r,s,u){super(e,lD,r,s,u),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(e){return!(e&&e._source instanceof PT&&(e._source.onNorthPole||e._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(e){e!=="raster-color"&&e!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(e){if(!this.hasColorMap()||!this._curRampRange)return;let r=this._transitionablePaint._values["raster-color"].value.expression,[s,u]=e||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(s)&&isNaN(u)||s===this._curRampRange[0]&&u===this._curRampRange[1]||(this.colorRamp=G0({expression:r,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:s,end:u}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[s,u])}}let uD=new rn({visibility:new Gt(xt["layout_raster-particle"].visibility)});var hD={paint:new rn({"raster-particle-array-band":new Gt(xt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Gt(xt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new aa(xt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Gt(xt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Gt(xt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Gt(xt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Gt(xt["paint_raster-particle"]["raster-particle-reset-rate-factor"])}),layout:uD};class RT extends ho{constructor(e,r,s,u){super(e,hD,r,s,u),this._updateColorRamp(),this.lastInvalidatedAt=ur.now()}onRemove(e){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(e){return!1}_handleSpecialPaintPropertyUpdate(e){e!=="raster-particle-color"&&e!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),e==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;let e=this._transitionablePaint._values["raster-particle-color"].value.expression,r=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=G0({expression:e,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:r}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=ur.now()}}class dD extends ho{constructor(e,r){super(e,{},r,null),this.implementation=e,e.slot&&(this.slot=e.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(e){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}let fD=new rn({visibility:new Gt(xt.layout_sky.visibility)});var pD={paint:new rn({"sky-type":new Gt(xt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Gt(xt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Gt(xt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Gt(xt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Gt(xt.paint_sky["sky-gradient-radius"]),"sky-gradient":new aa(xt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Gt(xt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Gt(xt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Gt(xt.paint_sky["sky-opacity"])}),layout:fD};function hy(t,e,r){let s=[0,0,1],u=i.av.identity([]);return i.av.rotateY(u,u,r?-Tr(t)+Math.PI:Tr(t)),i.av.rotateX(u,u,-Tr(e)),i._.transformQuat(s,s,u),i._.normalize(s,s)}var mD={paint:new rn({})};function OT(t,e){let r=i1(t.projection,t.zoom,t.width,t.height),s=function(d,p,_,v,w){let E=new Xr(_.lng-180*kf,_.lat),k=new Xr(_.lng+180*kf,_.lat),D=d.project(E.lng,E.lat),N=d.project(k.lng,k.lat),B=-Math.atan2(N.y-D.y,N.x-D.x),q=vs.fromLngLat(_);q.y=lr(q.y,-1+kf,1-kf);let Z=q.toLngLat(),oe=d.project(Z.lng,Z.lat),ve=vs.fromLngLat(Z);ve.x+=kf;let be=ve.toLngLat(),we=d.project(be.lng,be.lat),$e=zT(we.x-oe.x,we.y-oe.y,B),Ge=vs.fromLngLat(Z);Ge.y+=kf;let it=Ge.toLngLat(),ot=d.project(it.lng,it.lat),_t=zT(ot.x-oe.x,ot.y-oe.y,B),Mt=Math.abs($e.x)/Math.abs(_t.y),At=i.ad.identity([]);i.ad.rotateZ(At,At,-B*(1-(w?0:v)));let zt=i.ad.identity([]);return i.ad.scale(zt,zt,[1,1-(1-Mt)*v,1]),zt[4]=-_t.x/_t.y*v,i.ad.rotateZ(zt,zt,B),i.ad.multiply(zt,At,zt),zt}(t.projection,0,t.center,r,e),u=NT(t);return i.ad.scale(s,s,[u,u,1]),s}function NT(t){let e=t.projection,r=i1(t.projection,t.zoom,t.width,t.height),s=BT(e,t.center),u=BT(e,Xr.convert(e.center));return Math.pow(2,s*r+(1-r)*u)}function i1(t,e,r,s,u=1/0){let d=t.range;if(!d)return 0;let p=Math.min(u,Math.max(r,s)),_=Math.log(p/1024)/Math.LN2;return Ll(d[0]+_,d[1]+_,e)}let kf=1/4e4;function BT(t,e){let r=lr(e.lat,-ja,ja),s=new Xr(e.lng-180*kf,r),u=new Xr(e.lng+180*kf,r),d=t.project(s.lng,r),p=t.project(u.lng,r),_=vs.fromLngLat(s),v=vs.fromLngLat(u),w=p.x-d.x,E=p.y-d.y,k=v.x-_.x,D=v.y-_.y,N=Math.sqrt((k*k+D*D)/(w*w+E*E));return Math.log(N)/Math.LN2}function zT(t,e,r){let s=Math.cos(r),u=Math.sin(r);return{x:t*s-e*u,y:t*u+e*s}}function jT(t,e,r){i.ad.identity(t),i.ad.rotateZ(t,t,Tr(e[2])),i.ad.rotateX(t,t,Tr(e[0])),i.ad.rotateY(t,t,Tr(e[1])),i.ad.scale(t,t,r),i.ad.multiply(t,t,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function r1(t,e,r,s,u,d,p,_){let v=[r[0]-e[0],r[1]-e[1],0],w=[s[0]-e[0],s[1]-e[1],0];if(i._.length(v)<1e-12||i._.length(w)<1e-12)return i.av.identity(t);let E=i._.cross([],v,w);i._.normalize(E,E),i._.subtract(w,s,e),v[2]=(d-u)*_,w[2]=(p-u)*_;let k=v;return i._.cross(k,v,w),i._.normalize(k,k),i.av.rotationTo(t,E,k)}function dy(t,e,r=!1){let s=Sd(e.zoom),u=function(d,p,_){let v=p.worldSize,w=[d[12],d[13],d[14]],E=Uo(w[1]/v),k=El(w[0]/v),D=i.ad.identity([]),N=rl(1,E)*v,B=rl(1,0)*v*bp(E,p.zoom),q=1/Mv(v),Z=B*q;if(_){let we=i1(p.projection,p.zoom,p.width,p.height,1024);Z=q*p.projection.pixelSpaceConversion(p.center.lat,v,we)}let oe=vp(E,k);i._.add(oe,oe,i._.scale([],i._.normalize([],oe),N*Z*w[2]));let ve=function(we){let $e=[we[0],we[1],we[2]],Ge=[0,1,0],it=i._.cross([],Ge,$e);return i._.cross(Ge,$e,it),i._.squaredLength(Ge)===0&&(Ge=[0,1,0],i._.cross(it,$e,Ge)),i._.normalize(it,it),i._.normalize(Ge,Ge),i._.normalize($e,$e),[it[0],it[1],it[2],0,Ge[0],Ge[1],Ge[2],0,$e[0],$e[1],$e[2],0,we[0],we[1],we[2],1]}(oe);i.ad.scale(D,D,[Z,Z,Z*N]),i.ad.translate(D,D,[-w[0],-w[1],-w[2]]);let be=i.ad.multiply([],p.globeMatrix,ve);return i.ad.multiply(be,be,D),i.ad.multiply(be,be,d),be}(t,e,r);if(s>0){let d=function(p,_){let v=_.worldSize,w=rl(1,0)*v*bp(_.center.lat,_.zoom)/Mv(v),E=rl(1,_.center.lat)*v,k=i.ad.identity([]);return i.ad.rotateY(k,k,Tr(_.center.lng)),i.ad.rotateX(k,k,Tr(_.center.lat)),i.ad.translate(k,k,[0,0,il]),i.ad.scale(k,k,[w,w,w*E]),i.ad.translate(k,k,[_.point.x-.5*v,_.point.y-.5*v,0]),i.ad.multiply(k,k,p),i.ad.multiply(k,_.globeMatrix,k)}(t,e);return function(p,_,v){let w=(B,q,Z)=>{let oe=i._.length(B),ve=i._.length(q),be=Td(B,q,Z);return i._.scale(be,be,1/i._.length(be)*$i(oe,ve,Z))},E=w([p[0],p[1],p[2]],[_[0],_[1],_[2]],v),k=w([p[4],p[5],p[6]],[_[4],_[5],_[6]],v),D=w([p[8],p[9],p[10]],[_[8],_[9],_[10]],v),N=Td([p[12],p[13],p[14]],[_[12],_[13],_[14]],v);return[E[0],E[1],E[2],0,k[0],k[1],k[2],0,D[0],D[1],D[2],0,N[0],N[1],N[2],1]}(u,d,s)}return u}function VT(t,e,r,s){let u=sa.projectAabbCorners(s,r),d=Number.MAX_VALUE,p=-1;for(let w=0;w<u.length;++w){let E=u[w];E[0]=(.5*E[0]+.5)*e.width,E[1]=(.5-.5*E[1])*e.height,E[2]<d&&(p=w,d=E[2])}let _=w=>new hi(u[w][0],u[w][1]),v;switch(p){case 0:case 6:v=[_(1),_(5),_(4),_(7),_(3),_(2),_(1)];break;case 1:case 7:v=[_(0),_(4),_(5),_(6),_(2),_(3),_(0)];break;case 3:case 5:v=[_(1),_(0),_(4),_(7),_(6),_(2),_(1)];break;default:v=[_(1),_(5),_(6),_(7),_(3),_(0),_(1)]}if(yv(t,v))return d}let gD=nn([{name:"a_pos_3f",components:3,type:"Float32"}]),_D=nn([{name:"a_color_3f",components:3,type:"Float32"}]),xD=nn([{name:"a_color_4f",components:4,type:"Float32"}]),vD=nn([{name:"a_uv_2f",components:2,type:"Float32"}]),yD=nn([{name:"a_normal_3f",components:3,type:"Float32"}]),bD=nn([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),wD=nn([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class n1{constructor(e,r,s,u){this.message=(e?`${e}: `:"")+s,u&&(this.identifier=u),r!=null&&r.__line__&&(this.line=r.__line__)}}function UT(t,e){let r=t.indexOf("://")===-1;try{return new URL(t,r&&e?"http://example.com":void 0),!0}catch{return!1}}class HT{constructor(e,r){this.feature=e,this.instancedDataOffset=r,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class GT{constructor(){this.instancedDataArray=new rv,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class fy{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.fqid),this.projection=e.projection,this.index=e.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(e,r){}populate(e,r,s,u){this.tileToMeter=f_(s);let d=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(let{feature:p,id:_,index:v,sourceLayerIndex:w}of e){let E=_??(p.properties&&p.properties.hasOwnProperty("id")?p.properties.id:void 0),k=wd(p,d);if(!this.layers[0]._featureFilter.filter(new ir(this.zoom),k,s))continue;let D={id:E,sourceLayerIndex:w,index:v,geometry:d?k.geometry:ju(p,s,u),properties:p.properties,type:p.type,patterns:{}},N=this.addFeature(D,D.geometry,k);N&&r.featureIndex.insert(p,D.geometry,v,w,this.index,this.instancesPerModel[N].instancedDataArray.length,rt/32)}this.lookup=null}update(e,r,s,u){for(let d in this.instancesPerModel){let p=this.instancesPerModel[d];for(let _ in e)p.idToFeaturesIndex.hasOwnProperty(_)&&(this.evaluate(p.features[p.idToFeaturesIndex[_]],e[_],p,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let e=!1;for(let r in this.instancesPerModel){let s=this.instancesPerModel[r];for(let u of s.features){let d=this.layers[0],p=u.feature,_=this.canonical,v=d.paint.get("model-rotation").evaluate(p,{},_),w=d.paint.get("model-scale").evaluate(p,{},_),E=d.paint.get("model-translation").evaluate(p,{},_);i._.exactEquals(u.rotation,v)&&i._.exactEquals(u.scale,w)&&i._.exactEquals(u.translation,E)||(this.evaluate(u,u.featureStates,s,!0),e=!0)}}return e}updateReplacement(e,r,s){if(r.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=r.updateTime;let u=r.getReplacementRegionsForTile(e.toUnwrapped(),!0);if(jv(this.activeReplacements,u))return!1;this.activeReplacements=u;let d=!1;for(let p in this.instancesPerModel){let _=this.instancesPerModel[p],v=_.instancedDataArray;for(let w of _.features){let E=w.instancedDataOffset,k=w.instancedDataCount;for(let D=0;D<k;D++){let N=16*(D+E),B=v.float32[N+0];B=B>rt?B-rt:B;let q=Math.floor(B),Z=v.float32[N+1],oe=!1;for(let ve of this.activeReplacements)if(!(ve.order<s||ve.order===1/0)&&ve.clipMask&c5.Model&&!(ve.min.x>q||q>ve.max.x||ve.min.y>Z||Z>ve.max.y)&&(oe=t5(e5(q,Z,e.canonical,ve.footprintTileId.canonical),ve),oe))break;v.float32[N]=oe?B+rt:B,d=d||oe}}}return d}isEmpty(){for(let e in this.instancesPerModel)if(this.instancesPerModel[e].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(e){if(!this.uploaded)for(let r in this.instancesPerModel){let s=this.instancesPerModel[r];s.instancedDataArray.length<0||s.instancedDataArray.length===0||(s.instancedDataBuffer?s.instancedDataBuffer.updateData(s.instancedDataArray):s.instancedDataBuffer=e.createVertexBuffer(s.instancedDataArray,bD.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(let r in this.instancesPerModel){let s=this.instancesPerModel[r];s.instancedDataArray.length!==0&&s.instancedDataBuffer&&s.instancedDataBuffer.destroy()}let e=this.layers[0].modelManager;if(e&&this.modelUris)for(let r of this.modelUris)e.removeModel(r,"")}addFeature(e,r,s){let u=this.layers[0],d=u.layout.get("model-id").evaluate(s,{},this.canonical);if(!d)return Nn(`modelId is not evaluated for layer ${u.id} and it is not going to get rendered.`),d;UT(d,!1)&&(this.modelUris.includes(d)||this.modelUris.push(d)),this.instancesPerModel[d]||(this.instancesPerModel[d]=new GT);let p=this.instancesPerModel[d],_=p.instancedDataArray,v=new HT(s,_.length);for(let w of r)for(let E of w){if(E.x<0||E.x>=rt||E.y<0||E.y>=rt)continue;let k=(this.lookupDim-1)/rt,D=this.lookupDim*(E.y*k|0)+E.x*k|0;if(this.lookup){if(this.lookup[D]!==0)continue;this.lookup[D]=1}this.instanceCount++;let N=_.length;_.resize(N+1),p.instancesEvaluatedElevation.push(0),_.float32[16*N]=E.x,_.float32[16*N+1]=E.y}return v.instancedDataCount=p.instancedDataArray.length-v.instancedDataOffset,v.instancedDataCount>0&&(e.id&&(p.idToFeaturesIndex[e.id]=p.features.length),p.features.push(v),this.evaluate(v,{},p,!1)),d}getModelUris(){return this.modelUris}evaluate(e,r,s,u){let d=this.layers[0],p=e.feature,_=this.canonical,v=e.rotation=d.paint.get("model-rotation").evaluate(p,r,_),w=e.scale=d.paint.get("model-scale").evaluate(p,r,_),E=e.translation=d.paint.get("model-translation").evaluate(p,r,_),k=d.paint.get("model-color").evaluate(p,r,_);k.a=d.paint.get("model-color-mix-intensity").evaluate(p,r,_);let D=[];this.maxVerticalOffset<E[2]&&(this.maxVerticalOffset=E[2]),this.maxScale=Math.max(Math.max(this.maxScale,w[0]),Math.max(w[1],w[2])),jT(D,v,w);let N=Math.round(100*k.a)+k.b/1.05;for(let B=0;B<e.instancedDataCount;++B){let q=e.instancedDataOffset+B,Z=16*q,oe=s.instancedDataArray.float32,ve=0;u&&(ve=oe[Z+6]-s.instancesEvaluatedElevation[q]);let be=0|oe[Z+1];oe[Z]=(0|oe[Z])+k.r/1.05,oe[Z+1]=be+k.g/1.05,oe[Z+2]=N,oe[Z+3]=1/(_.z>10?this.tileToMeter:f_(_,be)),oe[Z+4]=E[0],oe[Z+5]=E[1],oe[Z+6]=E[2]+ve,oe[Z+7]=D[0],oe[Z+8]=D[1],oe[Z+9]=D[2],oe[Z+10]=D[4],oe[Z+11]=D[5],oe[Z+12]=D[6],oe[Z+13]=D[8],oe[Z+14]=D[9],oe[Z+15]=D[10],s.instancesEvaluatedElevation[q]=E[2]}}}Pe(fy,"ModelBucket",{omit:["layers"]}),Pe(GT,"PerModelAttributes"),Pe(HT,"ModelFeature");let TD=new rn({visibility:new Gt(xt.layout_model.visibility),"model-id":new _i(xt.layout_model["model-id"])});var SD={paint:new rn({"model-opacity":new Gt(xt.paint_model["model-opacity"]),"model-rotation":new _i(xt.paint_model["model-rotation"]),"model-scale":new _i(xt.paint_model["model-scale"]),"model-translation":new _i(xt.paint_model["model-translation"]),"model-color":new _i(xt.paint_model["model-color"]),"model-color-mix-intensity":new _i(xt.paint_model["model-color-mix-intensity"]),"model-type":new Gt(xt.paint_model["model-type"]),"model-cast-shadows":new Gt(xt.paint_model["model-cast-shadows"]),"model-receive-shadows":new Gt(xt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Gt(xt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new _i(xt.paint_model["model-emissive-strength"]),"model-roughness":new _i(xt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new _i(xt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Gt(xt.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Gt(xt.paint_model["model-front-cutoff"])}),layout:TD};let Ap=64,zm={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function WT(t,e,r,s,u,d,p,_,v,w=!1){let E=r.zoom,k=r.project(s),D=bp(s.lat,E),N=1/D;i.ad.identity(t),i.ad.translate(t,t,[k.x+p[0]*N,k.y+p[1]*N,p[2]]);let B=1,q=1,Z=r.worldSize;if(w){if(r.projection.name==="mercator"){let we=0;r.elevation&&(we=r.elevation.getAtPointOrZero(new vs(k.x/Z,k.y/Z),0));let $e=i.aA.transformMat4([],[k.x,k.y,we,1],r.projMatrix)[3]/r.cameraToCenterDistance;B=$e,q=$e*bp(r.center.lat,E)}else if(r.projection.name==="globe"){let we=dy(t,r),$e=i.ad.multiply([],r.projMatrix,we),Ge=[0,0,0,1];i.aA.transformMat4(Ge,Ge,$e);let it=Ge[3]/r.cameraToCenterDistance,ot=Sd(E),_t=r.projection.pixelsPerMeter(s.lat,Z)*bp(s.lat,E),Mt=r.projection.pixelsPerMeter(r.center.lat,Z)*bp(r.center.lat,E);B=it/$i(_t,cw(r.center.lat),ot),q=it*D/_t,B*=Mt,q*=Mt}}else B=N;i.ad.scale(t,t,[B,B,q]);let oe=[...t],ve=e.orientation,be=[];if(jT(be,[ve[0]+u[0],ve[1]+u[1],ve[2]+u[2]],d),i.ad.multiply(t,oe,be),_&&r.elevation){let we=0,$e=[];if(v&&r.elevation){we=function(ot,_t,Mt,At,zt){let Jt=_t.elevation;if(!Jt)return 0;let Ot=sa.projectAabbCorners(Mt,At),Xt=rl(1,zt.lat)*_t.worldSize,Dt=function(Yi,mr){let er=[0,0,1],br=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(let gr of br){let Dr=Yi[gr.corners[0]],Ji=Yi[gr.corners[1]],gn=Yi[gr.corners[2]],mn=[Ji[0]-Dr[0],Ji[1]-Dr[1],mr*(Ji[2]-Dr[2])],Zr=i._.cross(mn,mn,[gn[0]-Dr[0],gn[1]-Dr[1],mr*(gn[2]-Dr[2])]);i._.normalize(Zr,Zr),gr.dotProductWithUp=i._.dot(Zr,er)}return br.sort((gr,Dr)=>gr.dotProductWithUp-Dr.dotProductWithUp),br[0].corners}(Ot,Xt),Zt=Ot[Dt[0]],ri=Ot[Dt[1]],Kt=Ot[Dt[2]],Si=Ot[Dt[3]],ei=Jt.getAtPointOrZero(new vs(Zt[0]/_t.worldSize,Zt[1]/_t.worldSize),0),li=Jt.getAtPointOrZero(new vs(ri[0]/_t.worldSize,ri[1]/_t.worldSize),0),Xi=Jt.getAtPointOrZero(new vs(Kt[0]/_t.worldSize,Kt[1]/_t.worldSize),0),zi=Jt.getAtPointOrZero(new vs(Si[0]/_t.worldSize,Si[1]/_t.worldSize),0),Oi=(ei+zi)/2,ai=(li+Xi)/2;return Oi>ai?li<Xi?r1(ot,ri,Si,Zt,li,zi,ei,Xt):r1(ot,Kt,Zt,Si,Xi,ei,zi,Xt):ei<zi?r1(ot,Zt,ri,Kt,ei,li,Xi,Xt):r1(ot,Si,Kt,ri,zi,Xi,li,Xt),Math.max(Oi,ai)}($e,r,e.aabb,t,s);let Ge=i.ad.fromQuat([],$e),it=i.ad.multiply([],Ge,be);i.ad.multiply(t,oe,it)}else we=r.elevation.getAtPointOrZero(new vs(k.x/Z,k.y/Z),0);we!==0&&(t[14]+=we)}}function ug(t,e,r=!1){t.uploaded||(t.gfxTexture=new nu(e,t.image,r?e.gl.R8:e.gl.RGBA,{useMipmap:t.sampler.minFilter>=e.gl.NEAREST_MIPMAP_NEAREST}),t.uploaded=!0,t.image=null)}function ED(t,e,r){t.indexBuffer=e.createIndexBuffer(t.indexArray,!1,!0),t.vertexBuffer=e.createVertexBuffer(t.vertexArray,gD.members,!1,!0),t.normalArray&&(t.normalBuffer=e.createVertexBuffer(t.normalArray,yD.members,!1,!0)),t.texcoordArray&&(t.texcoordBuffer=e.createVertexBuffer(t.texcoordArray,vD.members,!1,!0)),t.colorArray&&(t.colorBuffer=e.createVertexBuffer(t.colorArray,(t.colorArray.bytesPerElement===12?_D:xD).members,!1,!0)),t.featureArray&&(t.pbrBuffer=e.createVertexBuffer(t.featureArray,wD.members,!0)),t.segments=oa.simpleSegment(0,0,t.vertexArray.length,t.indexArray.length);let s=t.material;s.pbrMetallicRoughness.baseColorTexture&&ug(s.pbrMetallicRoughness.baseColorTexture,e),s.pbrMetallicRoughness.metallicRoughnessTexture&&ug(s.pbrMetallicRoughness.metallicRoughnessTexture,e),s.normalTexture&&ug(s.normalTexture,e),s.occlusionTexture&&ug(s.occlusionTexture,e,r),s.emissionTexture&&ug(s.emissionTexture,e)}function py(t,e,r){if(t.meshes)for(let s of t.meshes)ED(s,e,r);if(t.children)for(let s of t.children)py(s,e,r)}function a1(t){if(t.meshes)for(let e of t.meshes)e.indexArray.destroy(),e.vertexArray.destroy(),e.colorArray&&e.colorArray.destroy(),e.normalArray&&e.normalArray.destroy(),e.texcoordArray&&e.texcoordArray.destroy(),e.featureArray&&e.featureArray.destroy();if(t.children)for(let e of t.children)a1(e)}function my(t){if(t.meshes)for(let r of t.meshes)r.vertexBuffer&&(r.vertexBuffer.destroy(),r.indexBuffer.destroy(),r.normalBuffer&&r.normalBuffer.destroy(),r.texcoordBuffer&&r.texcoordBuffer.destroy(),r.colorBuffer&&r.colorBuffer.destroy(),r.pbrBuffer&&r.pbrBuffer.destroy(),r.segments.destroy(),r.material&&((e=r.material).pbrMetallicRoughness.baseColorTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),e.pbrMetallicRoughness.metallicRoughnessTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),e.normalTexture&&e.normalTexture.gfxTexture&&e.normalTexture.gfxTexture.destroy(),e.emissionTexture&&e.emissionTexture.gfxTexture&&e.emissionTexture.gfxTexture.destroy(),e.occlusionTexture&&e.occlusionTexture.gfxTexture&&e.occlusionTexture.gfxTexture.destroy()));var e;if(t.children)for(let r of t.children)my(r)}class AD{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class CD{constructor(){this.tasks={},this.taskQueue=[],dh(["process"],this),this.invoker=new AD(this.process),this.nextId=0}add(e,r){let s=this.nextId++,u=function({type:d,isSymbolTile:p,zoom:_}){return _=_||0,d==="message"?0:d!=="maybePrepare"||p?d!=="parseTile"||p?d==="parseTile"&&p?300-_:d==="maybePrepare"&&p?400-_:500:200-_:100-_}(r);if(u===0){try{e()}finally{}return null}return this.tasks[s]={fn:e,metadata:r,priority:u,id:s},this.taskQueue.push(s),this.invoker.trigger(),{cancel:()=>{delete this.tasks[s]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(s=>!!this.tasks[s]),!this.taskQueue.length)return;let e=this.pick();if(e===null)return;let r=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!r)return;r.fn()}finally{}}pick(){let e=null,r=1/0;for(let u=0;u<this.taskQueue.length;u++){let d=this.tasks[this.taskQueue[u]];d.priority<r&&(r=d.priority,e=u)}if(e===null)return null;let s=this.taskQueue[e];return this.taskQueue.splice(e,1),s}remove(){this.invoker.remove()}}class qT{constructor(e,r,s){this.target=e,this.parent=r,this.mapId=s,this.callbacks={},this.cancelCallbacks={},dh(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new CD}send(e,r,s,u,d=!1,p){let _=Math.round(1e18*Math.random()).toString(36).substring(0,10);s&&(s.metadata=p,this.callbacks[_]=s);let v=new Set;return this.target.postMessage({id:_,type:e,hasCallback:!!s,targetMapId:u,mustQueue:d,sourceMapId:this.mapId,data:at(r,v)},v),{cancel:()=>{s&&delete this.callbacks[_],this.target.postMessage({id:_,type:"<cancel>",targetMapId:u,sourceMapId:this.mapId})}}}receive(e){let r=e.data,s=r.id;if(s&&(!r.targetMapId||this.mapId===r.targetMapId))if(r.type==="<cancel>"){let u=this.cancelCallbacks[s];delete this.cancelCallbacks[s],u&&u.cancel()}else if(r.mustQueue||io()){let u=this.callbacks[s],d=this.scheduler.add(()=>this.processTask(s,r),u&&u.metadata||{type:"message"});d&&(this.cancelCallbacks[s]=d)}else this.processTask(s,r)}processTask(e,r){if(delete this.cancelCallbacks[e],r.type==="<response>"){let s=this.callbacks[e];delete this.callbacks[e],s&&(r.error?s(yt(r.error)):s(null,yt(r.data)))}else{let s=new Set,u=r.hasCallback?(p,_)=>{this.target.postMessage({id:e,type:"<response>",sourceMapId:this.mapId,error:p?at(p):null,data:at(_,s)},s)}:p=>{},d=yt(r.data);if(this.parent[r.type])this.parent[r.type](r.sourceMapId,d,u);else if(this.parent.getWorkerSource){let p=r.type.split(".");this.parent.getWorkerSource(r.sourceMapId,p[0],d.source,d.scope)[p[1]](d,u)}else u(new Error(`Could not find function ${r.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}let gy=(()=>{class t{constructor(r,s){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=fl();let u=this.workerPool.acquire(this.id);for(let d=0;d<u.length;d++){let p=new t.Actor(u[d],s,this.id);p.name=`Worker ${d}`,this.actors.push(p)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(r,s,u){cc(this.actors,(d,p)=>{d.send(r,s,p)},u=u||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(r=>{r.remove()}),this.actors=[],this.workerPool.release(this.id)}}return t.Actor=qT,t})();var hg={workerUrl:"",workerClass:null,workerParams:void 0};function ID(){return hg.workerClass!=null?new hg.workerClass:new self.Worker(hg.workerUrl,hg.workerParams)}let _y="mapboxgl_preloaded_worker_pool";class dg{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<dg.workerCount;)this.workers.push(new ID);return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.workers&&this.numActive()===0&&(this.workers.forEach(r=>{r.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[_y]}numActive(){return Object.keys(this.active).length}}let fg;function o1(){return fg||(fg=new dg),fg}dg.workerCount=2;let s1,xy,$u,jm,vy,Vm=null;function $T(){return io()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:xy||A.DRACO_URL}function XT(){if(io()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(jm)return jm;let t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return jm=WebAssembly.validate(t)?A.MESHOPT_SIMD_URL:A.MESHOPT_URL,jm}let l1={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},kD={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},pg={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function ZT(t,e,r){let s=r.json.bufferViews.length,u=r.buffers.length;e.bufferView=s,r.json.bufferViews[s]={buffer:u,byteLength:t.byteLength},r.buffers[u]=t}let yy="KHR_draco_mesh_compression";function MD(t,e){let r=t.extensions&&t.extensions[yy];if(!r)return;let s=new $u.Decoder,u=QT(e,r.bufferView),d=new $u.Mesh;if(!s.DecodeArrayToMesh(u,u.byteLength,d))throw new Error("Failed to decode Draco mesh");let p=e.json.accessors[t.indices],_=l1[p.componentType],v=p.count*_.BYTES_PER_ELEMENT,w=$u._malloc(v);_===Uint16Array?s.GetTrianglesUInt16Array(d,v,w):s.GetTrianglesUInt32Array(d,v,w),ZT($u.memory.buffer.slice(w,w+v),p,e),$u._free(w);for(let E of Object.keys(r.attributes)){let k=s.GetAttributeByUniqueId(d,r.attributes[E]),D=e.json.accessors[t.attributes[E]],N=kD[D.componentType],B=D.count*pg[D.type]*l1[D.componentType].BYTES_PER_ELEMENT,q=$u._malloc(B);s.GetAttributeDataArrayForAllPoints(d,k,$u[N],B,q),ZT($u.memory.buffer.slice(q,q+B),D,e),$u._free(q)}s.destroy(),d.destroy(),delete t.extensions[yy]}let c1="EXT_meshopt_compression";function DD(t,e){if(!t.extensions||!t.extensions[c1])return;let r=t.extensions[c1],s=new Uint8Array(e.buffers[r.buffer],r.byteOffset||0,r.byteLength||0),u=new Uint8Array(r.count*r.byteStride);vy.decodeGltfBuffer(u,r.count,r.byteStride,s,r.mode,r.filter),t.buffer=e.buffers.length,t.byteOffset=0,e.buffers[t.buffer]=u.buffer,delete t.extensions[c1]}let YT=1179937895,KT=new TextDecoder("utf8");function JT(t,e){return new URL(t,e).href}function FD(t,e,r,s){return fetch(JT(t.uri,s)).then(u=>u.arrayBuffer()).then(u=>{e.buffers[r]=u})}function QT(t,e){let r=t.json.bufferViews[e];return new Uint8Array(t.buffers[r.buffer],r.byteOffset||0,r.byteLength)}function PD(t,e,r,s){if(t.uri){let u=JT(t.uri,s);return fetch(u).then(d=>d.blob()).then(d=>createImageBitmap(d)).then(d=>{e.images[r]=d})}if(t.bufferView!==void 0){let u=QT(e,t.bufferView),d=new Blob([u],{type:t.mimeType});return createImageBitmap(d).then(p=>{e.images[r]=p})}}function eS(t,e=0,r){let s={json:null,images:[],buffers:[]};if(new Uint32Array(t,e,1)[0]===YT){let E=new Uint32Array(t,e),k=2,D=(E[k++]>>2)-3,N=E[k++]>>2;if(k++,s.json=JSON.parse(KT.decode(E.subarray(k,k+N))),k+=N,k<D){let B=E[k++];k++;let q=e+(k<<2);s.buffers[0]=t.slice(q,q+B)}}else s.json=JSON.parse(KT.decode(new Uint8Array(t,e)));let{buffers:u,images:d,meshes:p,extensionsUsed:_,bufferViews:v}=s.json,w=Promise.resolve();if(u){let E=[];for(let k=0;k<u.length;k++){let D=u[k];D.uri?E.push(FD(D,s,k,r)):s.buffers[k]||(s.buffers[k]=null)}w=Promise.all(E)}return w.then(()=>{let E=[],k=_&&_.includes(yy),D=_&&_.includes(c1);if(k&&E.push(function(){if(!$u)return s1||(s1=function(N){let B,q=null;function Z(){B=new Uint8Array(q.buffer)}function oe(){throw new Error("Unexpected Draco error.")}let ve={a:{a:oe,d:function(be,we,$e){return B.copyWithin(be,we,we+$e)},c:function(be){let we=B.length,$e=Math.max(be>>>0,Math.ceil(1.2*we)),Ge=Math.ceil(($e-we)/65536);try{return q.grow(Ge),Z(),!0}catch{return!1}},b:oe}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(N,ve):N.then(be=>be.arrayBuffer()).then(be=>WebAssembly.instantiate(be,ve))).then(be=>{let{Rb:we,Qb:$e,P:Ge,T:it,X:ot,Ja:_t,La:Mt,Qa:At,Va:zt,Wa:Jt,eb:Ot,jb:Xt,f:Dt,e:Zt,yb:ri,zb:Kt,Ab:Si,Bb:ei,Db:li,Gb:Xi}=be.instance.exports;q=Zt;let zi=(()=>{let Oi=0,ai=0,Yi=0,mr=0;return er=>{Yi&&(we(mr),we(Oi),ai+=Yi,Yi=Oi=0),Oi||(ai+=128,Oi=$e(ai));let br=er.length+7&-8,gr=Oi;br>=ai&&(Yi=br,gr=mr=$e(br));for(let Dr=0;Dr<er.length;Dr++)B[gr+Dr]=er[Dr];return gr}})();return Z(),Dt(),{memory:Zt,_free:we,_malloc:$e,Mesh:class{constructor(){this.ptr=Ge()}destroy(){it(this.ptr)}},Decoder:class{constructor(){this.ptr=_t()}destroy(){Xt(this.ptr)}DecodeArrayToMesh(Oi,ai,Yi){let mr=zi(Oi),er=Mt(this.ptr,mr,ai,Yi.ptr);return!!ot(er)}GetAttributeByUniqueId(Oi,ai){return{ptr:At(this.ptr,Oi.ptr,ai)}}GetTrianglesUInt16Array(Oi,ai,Yi){zt(this.ptr,Oi.ptr,ai,Yi)}GetTrianglesUInt32Array(Oi,ai,Yi){Jt(this.ptr,Oi.ptr,ai,Yi)}GetAttributeDataArrayForAllPoints(Oi,ai,Yi,mr,er){Ot(this.ptr,Oi.ptr,ai.ptr,Yi,mr,er)}},DT_INT8:ri(),DT_UINT8:Kt(),DT_INT16:Si(),DT_UINT16:ei(),DT_UINT32:li(),DT_FLOAT32:Xi()}})}(fetch($T())),s1.then(N=>{$u=N,s1=void 0}))}()),D&&E.push(function(){if(vy)return;let N=function(B){let q,Z=WebAssembly.instantiateStreaming(B,{}).then(be=>{q=be.instance,q.exports.__wasm_call_ctors()}),oe={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},ve={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:Z,supported:!0,decodeGltfBuffer(be,we,$e,Ge,it,ot){(function(_t,Mt,At,zt,Jt,Ot,Xt){let Dt=_t.exports.sbrk,Zt=zt+3&-4,ri=Dt(Zt*Jt),Kt=Dt(Ot.length),Si=new Uint8Array(_t.exports.memory.buffer);Si.set(Ot,Kt);let ei=Mt(ri,zt,Jt,Kt,Ot.length);if(ei===0&&Xt&&Xt(ri,Zt,Jt),At.set(Si.subarray(ri,ri+zt*Jt)),Dt(ri-Dt(0)),ei!==0)throw new Error(`Malformed buffer data: ${ei}`)})(q,q.exports[ve[it]],be,we,$e,Ge,q.exports[oe[ot]])}}}(fetch(XT()));return N.ready.then(()=>{vy=N})}()),d)for(let N=0;N<d.length;N++)E.push(PD(d[N],s,N,r));return(E.length?Promise.all(E):Promise.resolve()).then(()=>{if(k&&p)for(let{primitives:N}of p)for(let B of N)MD(B,s);if(D&&p&&v)for(let N of v)DD(N,s);return s})})}function Cp(t,e){let r=t.json.bufferViews[e.bufferView],s=l1[e.componentType];return new s(t.buffers[r.buffer],(e.byteOffset||0)+(r.byteOffset||0),e.count*(r.byteStride&&r.byteStride!==pg[e.type]*s.BYTES_PER_ELEMENT?r.byteStride/s.BYTES_PER_ELEMENT:pg[e.type]))}function by(t,e,r,s){let u=l1[e.componentType],d=function(E){switch(E){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(u),p=t.json.bufferViews[e.bufferView],_=p.byteStride?p.byteStride/u.BYTES_PER_ELEMENT:pg[e.type],v=r.float32,w=v.length/r.capacity;for(let E=0,k=0;E<e.count*_;E+=_,k+=w)for(let D=0;D<w;D++)v[k+D]=s[E+D]*d;r._trim()}function LD(t,e,r){let s=t.indices,u=t.attributes,d={};d.indexArray=new ko;let p=e.json.accessors[s],_=p.count/3;d.indexArray.reserve(_);let v=Cp(e,p);for(let D=0;D<_;D++)d.indexArray.emplaceBack(v[3*D],v[3*D+1],v[3*D+2]);d.indexArray._trim(),d.vertexArray=new ff;let w=e.json.accessors[u.POSITION];d.vertexArray.reserve(w.count);let E=Cp(e,w);for(let D=0;D<w.count;D++)d.vertexArray.emplaceBack(E[3*D],E[3*D+1],E[3*D+2]);if(d.vertexArray._trim(),d.aabb=new sa(w.min,w.max),d.centroid=function(D,N){let B=[0,0,0],q=D.length;if(q>0){for(let Z=0;Z<q;Z++){let oe=3*D[Z];B[0]+=N[oe],B[1]+=N[oe+1],B[2]+=N[oe+2]}B[0]/=q,B[1]/=q,B[2]/=q}return B}(v,E),u.COLOR_0!==void 0){let D=e.json.accessors[u.COLOR_0],N=pg[D.type],B=Cp(e,D);d.colorArray=N===3?new ff:new df,d.colorArray.resize(D.count),by(e,D,d.colorArray,B)}if(u.NORMAL!==void 0){d.normalArray=new ff;let D=e.json.accessors[u.NORMAL];d.normalArray.resize(D.count);let N=Cp(e,D);by(e,D,d.normalArray,N)}if(u.TEXCOORD_0!==void 0&&r.length>0){d.texcoordArray=new _m;let D=e.json.accessors[u.TEXCOORD_0];d.texcoordArray.resize(D.count);let N=Cp(e,D);by(e,D,d.texcoordArray,N)}if(u._FEATURE_ID_RGBA4444!==void 0){let D=e.json.accessors[u._FEATURE_ID_RGBA4444];e.json.extensionsUsed&&e.json.extensionsUsed.includes("EXT_meshopt_compression")&&(d.featureData=Cp(e,D))}u._FEATURE_RGBA4444!==void 0&&(d.featureData=new Uint32Array(Cp(e,e.json.accessors[u._FEATURE_RGBA4444]).buffer));let k=t.material;return d.material=function(D,N){let{emissiveFactor:B=[0,0,0],alphaMode:q="OPAQUE",alphaCutoff:Z=.5,normalTexture:oe,occlusionTexture:ve,emissiveTexture:be,doubleSided:we}=D,{baseColorFactor:$e=[1,1,1,1],metallicFactor:Ge=1,roughnessFactor:it=1,baseColorTexture:ot,metallicRoughnessTexture:_t}=D.pbrMetallicRoughness||{},Mt=ve?N[ve.index]:void 0;if(ve&&ve.extensions&&ve.extensions.KHR_texture_transform&&Mt){let At=ve.extensions.KHR_texture_transform;Mt.offsetScale=[At.offset[0],At.offset[1],At.scale[0],At.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new jr(...$e),metallicFactor:Ge,roughnessFactor:it,baseColorTexture:ot?N[ot.index]:void 0,metallicRoughnessTexture:_t?N[_t.index]:void 0},doubleSided:we,emissiveFactor:B,alphaMode:q,alphaCutoff:Z,normalTexture:oe?N[oe.index]:void 0,occlusionTexture:Mt,emissionTexture:be?N[be.index]:void 0,defined:D.defined===void 0}}(k!==void 0?e.json.materials[k]:{defined:!1},r),d}function tS(t,e,r){let{matrix:s,rotation:u,translation:d,scale:p,mesh:_,extras:v,children:w}=t,E={};if(E.matrix=s||i.ad.fromRotationTranslationScale([],u||[0,0,0,1],d||[0,0,0],p||[1,1,1]),_!==void 0){E.meshes=r[_];let k=E.anchor=[0,0];for(let D of E.meshes){let{min:N,max:B}=D.aabb;k[0]+=N[0]+B[0],k[1]+=N[1]+B[1]}k[0]=Math.floor(k[0]/E.meshes.length/2),k[1]=Math.floor(k[1]/E.meshes.length/2)}if(v&&(v.id&&(E.id=v.id),v.lights&&(E.lights=function(k){if(!k.length)return[];let D=function(oe){let ve=atob(oe),be=new Uint8Array(ve.length);for(let we=0;we<ve.length;we++)be[we]=ve.codePointAt(we);return be}(k),N=[],B=D.length/24,q=new Uint16Array(D.buffer),Z=new Float32Array(D.buffer);for(let oe=0;oe<B;oe++){let ve=q[2*oe*6]/30,be=q[2*oe*6+1]/30,we=q[2*oe*6+10]/100,$e=Z[6*oe+1],Ge=Z[6*oe+2],it=Z[6*oe+3],ot=Z[6*oe+4],_t=it-$e,Mt=ot-Ge,At=Math.hypot(_t,Mt);N.push({pos:[$e+.5*_t,Ge+.5*Mt,be],normal:[Mt/At,-_t/At,0],width:At,height:ve,depth:we,points:[$e,Ge,it,ot]})}return N}(v.lights))),w){let k=[];for(let D of w)k.push(tS(e.json.nodes[D],e,r));E.children=k}return E}function RD(t){if(t.vertices.length===0||t.indices.length===0)return null;let e=new Nv(t.vertices,t.indices,8,256),[r,s]=[e.min.clone(),e.max.clone()];return{vertices:t.vertices,indices:t.indices,grid:e,min:r,max:s}}function OD(t){if(!t.extras||!t.extras.ground)return null;let e=t.extras.ground;if(!e||!Array.isArray(e)||e.length===0)return null;let r=e[0];if(!r||!Array.isArray(r)||r.length===0)return null;let s=[];for(let p of r){if(!Array.isArray(p)||p.length!==2)continue;let _=p[0],v=p[1];typeof _=="number"&&typeof v=="number"&&s.push(new hi(_,v))}if(s.length<3)return null;s.length>1&&s[s.length-1].equals(s[0])&&s.pop();let u=0;for(let p=0;p<s.length;p++){let _=s[p],v=s[(p+1)%s.length],w=s[(p+2)%s.length];u+=(_.x-v.x)*(w.y-v.y)-(w.x-v.x)*(_.y-v.y)}u>0&&s.reverse();let d=W0(s.flatMap(p=>[p.x,p.y]),[]);return d.length===0?null:{vertices:s,indices:d}}function ND(t,e){let r=[],s=[],u=0,d=[];for(let p of t){u=r.length;let _=p.vertexArray.float32,v=p.indexArray.uint16;for(let w=0;w<p.vertexArray.length;w++)d[0]=_[3*w+0],d[1]=_[3*w+1],d[2]=_[3*w+2],i._.transformMat4(d,d,e),r.push(new hi(d[0],d[1]));for(let w=0;w<3*p.indexArray.length;w++)s.push(v[w]+u)}if(s.length%3!=0)return null;for(let p=0;p<s.length;p+=3){let _=r[s[p+0]],v=r[s[p+1]],w=r[s[p+2]];(_.x-v.x)*(w.y-v.y)-(w.x-v.x)*(_.y-v.y)>0&&([s[p+1],s[p+2]]=[s[p+2],s[p+1]])}return{vertices:r,indices:s}}function iS(t){let e=function(v,w){let E=[],k=WebGL2RenderingContext;if(v.json.textures)for(let D of v.json.textures){let N={magFilter:k.LINEAR,minFilter:k.NEAREST,wrapS:k.REPEAT,wrapT:k.REPEAT};D.sampler!==void 0&&Object.assign(N,v.json.samplers[D.sampler]),E.push({image:w[D.source],sampler:N,uploaded:!1})}return E}(t,t.images),r=function(v,w){let E=[];for(let k of v.json.meshes){let D=[];for(let N of k.primitives)D.push(LD(N,v,w));E.push(D)}return E}(t,e),{scenes:s,scene:u,nodes:d}=t.json,p=s?s[u||0].nodes:d,_=[];for(let v of p)_.push(tS(d[v],t,r));return function(v,w,E){let k={},D=new Set;for(let N=0;N<v.length;N++){let B=E[w[N]];if(!B.extras)continue;let q=B.extras["mapbox:footprint:version"],Z=B.extras["mapbox:footprint:id"];(q||Z)&&D.add(N),q==="1.0.0"&&Z&&(k[Z]=N)}for(let N=0;N<v.length;N++){if(D.has(N))continue;let B=v[N],q=E[w[N]];if(!q.extras)continue;let Z=null;B.id in k&&(Z=ND(v[k[B.id]].meshes,B.matrix)),Z||(Z=OD(q)),Z&&(B.footprint=RD(Z))}if(D.size>0){let N=Array.from(D.values()).sort((B,q)=>B-q);for(let B=N.length-1;B>=0;B--)v.splice(N[B],1)}}(_,p,t.json.nodes),_}function BD(t){t.heightmap=new Float32Array(4096),t.heightmap.fill(-1);let e=t.vertexArray.float32,r=t.aabb.min[0]-1,s=t.aabb.min[1]-1,u=Ap/(t.aabb.max[0]-r+2),d=Ap/(t.aabb.max[1]-s+2);for(let p=0;p<e.length;p+=3){let _=e[p+2],v=(e[p+0]-r)*u|0,w=(e[p+1]-s)*d|0;_>t.heightmap[w*Ap+v]&&(t.heightmap[w*Ap+v]=_)}}function zD(t,e){let r={};r.indexArray=new ko,r.indexArray.reserve(4*t.length),r.vertexArray=new ff,r.vertexArray.reserve(10*t.length),r.colorArray=new df,r.vertexArray.reserve(10*t.length);let s=0;for(let p of t){let _=Math.min(10,Math.max(4,1.3*p.height))*e,v=[-p.normal[1],p.normal[0],0],w=Math.min(.29,.1*p.width/p.depth),E=p.width-2*p.depth*e*(w+.01),k=i._.scaleAndAdd([],p.pos,v,E/2),D=i._.scaleAndAdd([],p.pos,v,-E/2),N=[k[0],k[1],k[2]+p.height],B=[D[0],D[1],D[2]+p.height],q=i._.scaleAndAdd([],p.normal,v,w);i._.scale(q,q,_);let Z=i._.scaleAndAdd([],p.normal,v,-w);i._.scale(Z,Z,_),i._.add(q,k,q),i._.add(Z,D,Z),k[2]+=.1,D[2]+=.1,r.vertexArray.emplaceBack(q[0],q[1],q[2]),r.vertexArray.emplaceBack(Z[0],Z[1],Z[2]),r.vertexArray.emplaceBack(k[0],k[1],k[2]),r.vertexArray.emplaceBack(D[0],D[1],D[2]),r.vertexArray.emplaceBack(N[0],N[1],N[2]),r.vertexArray.emplaceBack(B[0],B[1],B[2]),r.vertexArray.emplaceBack(k[0],k[1],k[2]),r.vertexArray.emplaceBack(D[0],D[1],D[2]),r.vertexArray.emplaceBack(q[0],q[1],q[2]),r.vertexArray.emplaceBack(Z[0],Z[1],Z[2]);let oe=E/_/2;r.colorArray.emplaceBack(-oe-w,-1,oe,.8),r.colorArray.emplaceBack(oe+w,-1,oe,.8),r.colorArray.emplaceBack(-oe,0,oe,1.3),r.colorArray.emplaceBack(oe,0,oe,1.3),r.colorArray.emplaceBack(oe+w,-.8,oe,.7),r.colorArray.emplaceBack(oe+w,-.8,oe,.7),r.colorArray.emplaceBack(0,0,oe,1.3),r.colorArray.emplaceBack(0,0,oe,1.3),r.colorArray.emplaceBack(oe+w,-1.2,oe,.8),r.colorArray.emplaceBack(oe+w,-1.2,oe,.8),r.indexArray.emplaceBack(6+s,4+s,8+s),r.indexArray.emplaceBack(7+s,9+s,5+s),r.indexArray.emplaceBack(0+s,1+s,2+s),r.indexArray.emplaceBack(1+s,3+s,2+s),s+=10}let u={defined:!0,emissiveFactor:[0,0,0]},d={};return d.baseColorFactor=jr.white,u.pbrMetallicRoughness=d,r.material=u,r.aabb=new sa([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),r}let wy=new Float32Array(262144),Ip=new Uint8Array(262144);function rS(t){let e=0;if(t.meshes)for(let r of t.meshes)e=Math.max(e,r.aabb.max[2]);if(t.children)for(let r of t.children)e=Math.max(e,rS(r));return e}function nS(t,e,r){if(t.meshes)for(let s of t.meshes)s.aabb.min[0]!==1/0&&r.insert(e,s.aabb.min[0],s.aabb.min[1],s.aabb.max[0],s.aabb.max[1]);if(t.children)for(let s of t.children)nS(s,e,r)}let aS=["","wall","door","roof","window","lamp","logo"];class oS{constructor(e){this.node=e,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:e.id,geometry:[],properties:{height:rS(e)}},this.aabb=this._getLocalBounds()}_getLocalBounds(){if(!this.node.meshes)return new sa([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let e=0,r=new sa([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(let s of this.node.meshes)this.node.lightMeshIndex!==e&&(s.transformedAabb=sa.applyTransform(s.aabb,this.node.matrix),r.encapsulate(s.transformedAabb)),e++;this.aabb=r}return this.aabb}}class u1{constructor(e,r,s,u,d,p){this.id=r,this.modelTraits|=zm.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,s&&(this.modelTraits|=zm.HasMapboxMeshFeatures),u&&(this.modelTraits|=zm.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=d,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(let _ of e)this.nodesInfo.push(new oS(_)),nS(_,p.featureIndexArray.length,p.grid),p.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,p.bucketLayerIDs.length-1,0)}updateFootprints(e,r){for(let s of this.getNodesInfo()){let u=s.node;u.footprint&&r.push({footprint:u.footprint,id:e})}}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(e){if(!this.needsUpload)return;let r=this.getNodesInfo();for(let s of r){let u=s.node;this.uploaded?this.updatePbrBuffer(u):py(u,e,!0)}for(let s of r)a1(s.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(e){let r=!1;if(!e.meshes)return r;for(let s of e.meshes)s.pbrBuffer&&(s.pbrBuffer.updateData(s.featureArray),r=!0);return r}needsReEvaluation(e,r,s){let u=e.transform.projectionOptions,d=e.style.getBrightness(),p=this.brightness!==d;return!!(!this.uploaded||this.dirty||u.name!==this.projection.name||mg(s.paint.get("model-color").value,p)||mg(s.paint.get("model-color-mix-intensity").value,p)||mg(s.paint.get("model-roughness").value,p)||mg(s.paint.get("model-emissive-strength").value,p)||mg(s.paint.get("model-height-based-emissive-strength-multiplier").value,p))&&(this.projection=u,this.brightness=d,!0)}evaluateScale(e,r){if(e.transform.zoom===this.zoom)return;this.zoom=e.transform.zoom;let s=this.getNodesInfo(),u=this.id.canonical;for(let d of s){let p=d.feature;d.evaluatedScale=r.paint.get("model-scale").evaluate(p,{},u)}}evaluate(e){let r=this.getNodesInfo();for(let s of r){if(!s.node.meshes)continue;let u=s.feature,d=s.node.meshes&&s.node.meshes[0].featureData,p=s.evaluatedColor[2],_=s.evaluatedRMEA[2],v=this.id.canonical;if(s.hasTranslucentParts=!1,d){for(let w=0;w<aS.length;w++){let E=aS[w];E.length&&(u.properties.part=E);let k=e.paint.get("model-color").evaluate(u,{},v).toRenderColor(null),D=e.paint.get("model-color-mix-intensity").evaluate(u,{},v);s.evaluatedColor[w]=[k.r,k.g,k.b,D],s.evaluatedRMEA[w][0]=e.paint.get("model-roughness").evaluate(u,{},v),s.evaluatedRMEA[w][2]=e.paint.get("model-emissive-strength").evaluate(u,{},v),s.evaluatedRMEA[w][3]=k.a,s.emissionHeightBasedParams[w]=e.paint.get("model-height-based-emissive-strength-multiplier").evaluate(u,{},v),!s.hasTranslucentParts&&k.a<1&&(s.hasTranslucentParts=!0)}delete u.properties.part,VD(s,p!==s.evaluatedColor[2]||_!==s.evaluatedRMEA[2],this.modelTraits)}else s.evaluatedRMEA[0][2]=e.paint.get("model-emissive-strength").evaluate(u,{},v);s.evaluatedScale=e.paint.get("model-scale").evaluate(u,{},v),this.updatePbrBuffer(s.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(e,r,s,u){let d=e.findDEMTileFor(s);if(d&&(d.tileID.canonical!==this.terrainTile||r!==this.terrainExaggeration)){if(d.dem&&d.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=d.tileID.overscaledZ;let p=Am.create(e,s,d);if(!p)return;this.modelTraits&zm.HasMapboxMeshFeatures&&this.updateDEM(e,p,s,u);for(let _ of this.getNodesInfo()){let v=_.node;if(!v.footprint||!v.footprint.vertices||!v.footprint.vertices.length)continue;let w=v.footprint.vertices,E=p.getElevationAt(w[0].x,w[0].y,!0,!0);for(let k=1;k<w.length;k++)E=Math.min(E,p.getElevationAt(w[k].x,w[k].y,!0,!0));v.elevation=E}}this.terrainTile=d.tileID.canonical,this.terrainExaggeration=r}}updateDEM(e,r,s,u){let d=r._dem._modifiedForSources[u];if(d===void 0&&(r._dem._modifiedForSources[u]=[],d=r._dem._modifiedForSources[u]),d.includes(s.canonical))return;let p=r._dem.dim;d.push(s.canonical);let _=!1;for(let v of this.getNodesInfo()){let w=v.node;if(!w.footprint||!w.footprint.grid)continue;let E=w.footprint.grid,k=r.tileCoordToPixel(E.min.x,E.min.y),D=r.tileCoordToPixel(E.max.x,E.max.y),N=Math.min(Math.min(p-D.y,k.x),Math.min(k.y,p-D.x));if(N<0)continue;let B=lr(N,2,5),q=Math.max(0,k.x-B),Z=Math.max(0,k.y-B),oe=Math.min(D.x+B,p-1),ve=Math.min(D.y+B,p-1);for(let Ge=Z;Ge<=ve;++Ge)for(let it=q;it<=oe;++it)Ip[Ge*p+it]=255;let be=0,we=0;for(let Ge=0;Ge<E.cellsY;++Ge)for(let it=0;it<E.cellsX;++it){if(!E.cells[Ge*E.cellsX+it])continue;let ot=r.tileCoordToPixel(E.min.x+it/E.xScale,E.min.y+Ge/E.yScale),_t=r.tileCoordToPixel(E.min.x+(it+1)/E.xScale,E.min.y+(Ge+1)/E.yScale);for(let Mt=ot.y;Mt<=Math.min(_t.y+1,p-1);++Mt)for(let At=ot.x;At<=Math.min(_t.x+1,p-1);++At)Ip[Mt*p+At]===255&&(Ip[Mt*p+At]=0,be+=r.getElevationAtPixel(At,Mt),we++)}let $e=be/we;q=Math.max(1,k.x-B),Z=Math.max(1,k.y-B),oe=Math.min(D.x+B,p-2),ve=Math.min(D.y+B,p-2),_=!0;for(let Ge=Z;Ge<=ve;++Ge)for(let it=q;it<=oe;++it)Ip[Ge*p+it]===0&&(wy[Ge*p+it]=r._dem.set(it,Ge,$e));for(let Ge=1;Ge<B;++Ge){q=Math.max(1,k.x-Ge),Z=Math.max(1,k.y-Ge),oe=Math.min(D.x+Ge,p-2),ve=Math.min(D.y+Ge,p-2);for(let it=Z;it<=ve;++it)for(let ot=q;ot<=oe;++ot){let _t=it*p+ot;if(Ip[_t]===255){let Mt=0,At=0,zt=-1,Jt=-1;for(let Ot=-1;Ot<=1;++Ot)for(let Xt=-1;Xt<=1;++Xt){let Dt=(it+Ot)*p+ot+Xt;if(Ip[Dt]>=Ge)continue;let Zt=wy[Dt],ri=Math.abs(Zt);ri>At&&(Mt=Zt,At=ri,zt=Xt,Jt=Ot)}if(At>.1){let Ot=1-(Ge+.5*Math.abs(zt*Jt))/B,Xt=r._dem.get(ot,it)+Mt*Ot,Dt=r._dem.get(ot+zt,it+Jt),Zt=r._dem.get(ot-zt,it-Jt,!0);(Xt-Dt)*(Xt-Zt)>0&&(Xt=(Dt+Zt)/2),wy[_t]=r._dem.set(ot,it,Xt),Ip[_t]=Ge}}}}}_&&(r._demTile.needsDEMTextureUpload=!0,r._dem._timestamp=ur.now())}getNodesInfo(){return this.nodesInfo}destroy(){let e=this.getNodesInfo();for(let r of e)a1(r.node),my(r.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(e,r){if(r.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=r.updateTime;let s=r.getReplacementRegionsForTile(e.toUnwrapped()),u=this.getNodesInfo();for(let d=0;d<this.nodesInfo.length;d++){let p=u[d].node;u[d].hiddenByReplacement=!!p.footprint&&!s.find(_=>_.footprint===p.footprint)}}getHeightAtTileCoord(e,r){let s=this.getNodesInfo(),u=[],d=[0,0,0],p=i.ad.identity([]);for(let _=0;_<this.nodesInfo.length;_++){let v=s[_],w=v.node.meshes[0],E=w.transformedAabb;if(e<E.min[0]||r<E.min[1]||e>E.max[0]||r>E.max[1])continue;if(v.node.hidden===!0)return{height:0,maxHeight:v.feature.properties.height,hidden:!1,verticalScale:v.evaluatedScale[2]};i.ad.invert(p,v.node.matrix),d[0]=e,d[1]=r,i._.transformMat4(d,d,p);let k=(d[0]-w.aabb.min[0])/(w.aabb.max[0]-w.aabb.min[0])*Ap|0,D=Math.min(63,(d[1]-w.aabb.min[1])/(w.aabb.max[1]-w.aabb.min[1])*Ap|0)*Ap+Math.min(63,k),N=w.heightmap[D];if(!(N<0&&v.node.footprint))return v.hiddenByReplacement?void 0:{height:N,maxHeight:v.feature.properties.height,hidden:!1,verticalScale:v.evaluatedScale[2]};if(v.node.footprint.grid.query(new hi(e,r),new hi(e,r),u),u.length>0)return{height:void 0,maxHeight:v.feature.properties.height,hidden:v.hiddenByReplacement,verticalScale:v.evaluatedScale[2]}}}}function mg(t,e){return!t.isLightConstant&&e}function jD(t,e,r,s,u,d,p,_){let v=(61440&e|(61440&e)>>4)>>8,w=(3840&e|(3840&e)>>4)>>4,E=240&e|(240&e)>>4;r[3]>0&&(v=$i(v,255*r[0],r[3]),w=$i(w,255*r[1],r[3]),E=$i(E,255*r[2],r[3]));let k=v<<8|w,D=E<<8|Math.floor(255*s[3]),N=function(Ge){let it=lr(Ge,0,2);return Math.min(Math.round(.5*it*255),255)}(s[2])<<8|15*s[0]<<4|15*s[1],B=lr(u[0],0,1),q=lr(u[1],0,1),Z=lr(u[2],0,1),oe=lr(u[3],0,1),ve,be,we,$e;if(B!==q&&p!==d&&q!==B){let Ge=p-d;be=1/(Ge*(q-B)),we=-(d+Ge*B)/(Ge*(q-B));let it=lr(u[4],-1,1);$e=Math.pow(10,it),ve=255*Z<<8|255*oe}else ve=65535,be=0,we=1,$e=1;if(t.emplaceBack(k,D,N,ve,be,we,$e),_){let Ge=_.length;_.clear();for(let it=0;it<Ge;it++)_.emplaceBack(k,D,N,ve,be,we,$e)}}function VD(t,e,r){let s=t.node,u=0,d=r&zm.HasMeshoptCompression;for(let p of s.meshes){if(s.lights&&s.lightMeshIndex===u||!p.featureData)continue;p.featureArray=new u_,p.featureArray.reserve(p.featureData.length);let _=e;for(let v of p.featureData){let w=d?65535&v:v>>16&65535,E=d?v>>16&65535:65535&v,k=(15&E)<8?15&E:0,D=t.evaluatedRMEA[k],N=t.evaluatedColor[k],B=t.emissionHeightBasedParams[k],q;if(_&&k===2&&s.lights&&(q=new u_,q.resize(10*s.lights.length)),jD(p.featureArray,w,N,D,B,p.aabb.min[2],p.aabb.max[2],q),q&&_){_=!1;let Z=s.meshes[s.lightMeshIndex];Z.featureArray=q,Z.featureArray._trim()}}p.featureArray._trim(),u++}}function sS(t,e,r,s){let u=1<<t.z;e.lat=Uo((s/rt+t.y)/u),e.lng=El((r/rt+t.x)/u)}Pe(u1,"Tiled3dModelBucket",{omit:["layers"]}),Pe(oS,"Tiled3dModelFeature");let UD={circle:class extends ho{constructor(t,e,r,s){super(t,II,e,r,s)}createBucket(t){return new vv(t)}queryRadius(t){let e=t;return Tm("circle-radius",this,e)+Tm("circle-stroke-width",this,e)+g_(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,r,s,u,d,p,_){let v=xw(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),d.angle,t.pixelToTileUnitsFactor),w=this.paint.get("circle-radius").evaluate(e,r)+this.paint.get("circle-stroke-width").evaluate(e,r);return Pw(t,s,d,p,_,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",v,w)}getProgramIds(){return["circle"]}getDefaultProgramParams(t,e,r){let s=Fw(this);return{config:new xp(this,{zoom:e,lut:r}),defines:s,overrideFog:!1}}},heatmap:class extends ho{createBucket(t){return new Rw(t)}constructor(t,e,r,s){super(t,zI,e,r,s),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=G0({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return Tm("heatmap-radius",this,t)}queryIntersectsFeature(t,e,r,s,u,d,p,_){let v=this.paint.get("heatmap-radius").evaluate(e,r);return Pw(t,s,d,p,_,!0,!0,new hi(0,0),v)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(t,e,r){return t==="heatmap"?{config:new xp(this,{zoom:e,lut:r}),overrideFog:!1}:{}}},hillshade:class extends ho{constructor(t,e,r,s){super(t,VI,e,r,s)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(t,e,r){return{overrideFog:!1}}},fill:class extends ho{constructor(t,e,r,s){super(t,tk,e,r,s)}getProgramIds(){let t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),r=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&r.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),r}getDefaultProgramParams(t,e,r){return{config:new xp(this,{zoom:e,lut:r}),overrideFog:!1}}recalculate(t,e){super.recalculate(t,e);let r=this.paint._values["fill-outline-color"];r.value.kind==="constant"&&r.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new E_(t)}queryRadius(){return g_(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,r,s,u,d){return!t.queryGeometry.isAboveHorizon&&fw(_w(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),d.angle,t.pixelToTileUnitsFactor),s)}isTileClipped(){return!0}},"fill-extrusion":class extends ho{constructor(t,e,r,s){super(t,Dk,e,r,s),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(t){return new F_(t)}queryRadius(){return g_(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(t,e,r,s,u,d,p,_,v){let w=xw(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),d.angle,t.pixelToTileUnitsFactor),E=this.paint.get("fill-extrusion-height").evaluate(e,r),k=this.paint.get("fill-extrusion-base").evaluate(e,r),D=[0,0],N=_&&d.elevation,B=d.elevation?d.elevation.exaggeration():1,q=t.tile.getBucket(this);if(N&&q instanceof F_){let we=q.centroidVertexArray,$e=v+1;$e<we.length&&(D[0]=we.geta_centroid_pos0($e),D[1]=we.geta_centroid_pos1($e))}if(D[0]===0&&D[1]===1)return!1;d.projection.name==="globe"&&(s=w5([s],[new hi(0,0),new hi(rt,rt)],t.tileID.canonical).map(we=>we.polygon).flat());let Z=N?_:null,[oe,ve]=function(we,$e,Ge,it,ot,_t,Mt,At,zt,Jt,Ot){return we.projection.name==="globe"?function(Xt,Dt,Zt,ri,Kt,Si,ei,li,Xi,zi,Oi){let ai=[],Yi=[],mr=Xt.projection.upVectorScale(Oi,Xt.center.lat,Xt.worldSize).metersToTile,er=[0,0,0,1],br=[0,0,0,1],gr=(Ji,gn,mn,Zr)=>{Ji[0]=gn,Ji[1]=mn,Ji[2]=Zr,Ji[3]=1},Dr=b5();Zt>0&&(Zt+=Dr),ri+=Dr;for(let Ji of Dt){let gn=[],mn=[];for(let Zr of Ji){let Hr=Zr.x+Kt.x,Yr=Zr.y+Kt.y,Pn=Xt.projection.projectTilePoint(Hr,Yr,Oi),wn=Xt.projection.upVector(Oi,Zr.x,Zr.y),da=Zt,la=ri;if(ei){let ys=S5(Hr,Yr,Zt,ri,ei,li,Xi,zi);da+=ys.base,la+=ys.top}Zt!==0?gr(er,Pn.x+wn[0]*mr*da,Pn.y+wn[1]*mr*da,Pn.z+wn[2]*mr*da):gr(er,Pn.x,Pn.y,Pn.z),gr(br,Pn.x+wn[0]*mr*la,Pn.y+wn[1]*mr*la,Pn.z+wn[2]*mr*la),i._.transformMat4(er,er,Si),i._.transformMat4(br,br,Si),gn.push(new Tp(er[0],er[1],er[2])),mn.push(new Tp(br[0],br[1],br[2]))}ai.push(gn),Yi.push(mn)}return[ai,Yi]}(we,$e,Ge,it,ot,_t,Mt,At,zt,Jt,Ot):Mt?function(Xt,Dt,Zt,ri,Kt,Si,ei,li,Xi){let zi=[],Oi=[],ai=[0,0,0,1];for(let Yi of Xt){let mr=[],er=[];for(let br of Yi){let gr=br.x+ri.x,Dr=br.y+ri.y,Ji=S5(gr,Dr,Dt,Zt,Si,ei,li,Xi);ai[0]=gr,ai[1]=Dr,ai[2]=Ji.base,ai[3]=1,i.aA.transformMat4(ai,ai,Kt),ai[3]=Math.max(ai[3],1e-5);let gn=new Tp(ai[0]/ai[3],ai[1]/ai[3],ai[2]/ai[3]);ai[0]=gr,ai[1]=Dr,ai[2]=Ji.top,ai[3]=1,i.aA.transformMat4(ai,ai,Kt),ai[3]=Math.max(ai[3],1e-5);let mn=new Tp(ai[0]/ai[3],ai[1]/ai[3],ai[2]/ai[3]);mr.push(gn),er.push(mn)}zi.push(mr),Oi.push(er)}return[zi,Oi]}($e,Ge,it,ot,_t,Mt,At,zt,Jt):function(Xt,Dt,Zt,ri,Kt){let Si=[],ei=[],li=Kt[8]*Dt,Xi=Kt[9]*Dt,zi=Kt[10]*Dt,Oi=Kt[11]*Dt,ai=Kt[8]*Zt,Yi=Kt[9]*Zt,mr=Kt[10]*Zt,er=Kt[11]*Zt;for(let br of Xt){let gr=[],Dr=[];for(let Ji of br){let gn=Ji.x+ri.x,mn=Ji.y+ri.y,Zr=Kt[0]*gn+Kt[4]*mn+Kt[12],Hr=Kt[1]*gn+Kt[5]*mn+Kt[13],Yr=Kt[2]*gn+Kt[6]*mn+Kt[14],Pn=Kt[3]*gn+Kt[7]*mn+Kt[15],wn=Zr+li,da=Hr+Xi,la=Yr+zi,ys=Math.max(Pn+Oi,1e-5),Da=Zr+ai,Jn=Hr+Yi,oo=Yr+mr,Ho=Math.max(Pn+er,1e-5);gr.push(new Tp(wn/ys,da/ys,la/ys)),Dr.push(new Tp(Da/Ho,Jn/Ho,oo/Ho))}Si.push(gr),ei.push(Dr)}return[Si,ei]}($e,Ge,it,ot,_t)}(d,s,k,E,w,p,Z,D,B,d.center.lat,t.tileID.canonical),be=t.queryGeometry;return function(we,$e,Ge){let it=1/0;fw(Ge,$e)&&(it=T5(Ge,$e[0]));for(let ot=0;ot<$e.length;ot++){let _t=$e[ot],Mt=we[ot];for(let At=0;At<_t.length-1;At++){let zt=_t[At],Jt=[zt,_t[At+1],Mt[At+1],Mt[At],zt];yv(Ge,Jt)&&(it=Math.min(it,T5(Ge,Jt)))}}return it!==1/0&&it}(oe,ve,be.isPointQuery()?be.screenBounds:be.screenGeometry)}},line:class extends ho{constructor(t,e,r,s){super(t,L_,e,r,s),L_.layout&&(this.layout=new pn(L_.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){let e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Sc,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=kT.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new P_(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(t,e,r){let s=F5(this);return{config:new xp(this,{zoom:e,lut:r}),defines:s,overrideFog:!1}}queryRadius(t){let e=t,r=MT(Tm("line-width",this,e),Tm("line-gap-width",this,e)),s=Tm("line-offset",this,e);return r/2+Math.abs(s)+g_(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,r,s,u,d){if(t.queryGeometry.isAboveHorizon)return!1;let p=_w(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),d.angle,t.pixelToTileUnitsFactor),_=t.pixelToTileUnitsFactor/2*MT(this.paint.get("line-width").evaluate(e,r),this.paint.get("line-gap-width").evaluate(e,r)),v=this.paint.get("line-offset").evaluate(e,r);return v&&(s=function(w,E){let k=[],D=new hi(0,0);for(let N=0;N<w.length;N++){let B=w[N],q=[];for(let Z=0;Z<B.length;Z++){let oe=B[Z],ve=B[Z+1],be=Z===0?D:oe.sub(B[Z-1])._unit()._perp(),we=Z===B.length-1?D:ve.sub(oe)._unit()._perp(),$e=be._add(we)._unit();$e._mult(1/($e.x*we.x+$e.y*we.y)),q.push($e._mult(E)._add(oe))}k.push(q)}return k}(s,v*t.pixelToTileUnitsFactor)),function(w,E,k){for(let D=0;D<E.length;D++){let N=E[D];if(w.length>=3){for(let B=0;B<N.length;B++)if(vf(w,N[B]))return!0}if(SI(w,N,k))return!0}return!1}(p,s,_)}isTileClipped(){return!0}isDraped(t){let e=this.layout.get("line-z-offset");return e.isConstant()&&!e.constantOr(0)}},symbol:Q_,background:class extends ho{constructor(t,e,r,s){super(t,oD,e,r,s)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(t,e,r){return{overrideFog:!1}}},raster:LT,"raster-particle":RT,sky:class extends ho{constructor(t,e,r,s){super(t,pD,e,r,s),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="sky-gradient"?this._updateColorRamp():t!=="sky-atmosphere-sun"&&t!=="sky-atmosphere-halo-color"&&t!=="sky-atmosphere-color"&&t!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=G0({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){let e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(t,e){if(this.paint.get("sky-type")==="atmosphere"){let s=this.paint.get("sky-atmosphere-sun"),u=!s,d=t.style.light,p=d.properties.get("position");return u&&d.properties.get("anchor")==="viewport"&&Nn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),u?hy(p.azimuthal,90-p.polar,e):hy(s[0],90-s[1],e)}let r=this.paint.get("sky-gradient-center");return hy(r[0],90-r[1],e)}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){let t=this.paint.get("sky-type");return t==="atmosphere"?["skyboxCapture","skybox"]:t==="gradient"?["skyboxGradient"]:null}},slot:class extends ho{constructor(t,e,r,s){super(t,mD,e,null)}},model:class extends ho{constructor(t,e,r,s){super(t,SD,e,r,s),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(t){return new fy(t)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(t){return t instanceof u1?rt-1:0}queryIntersectsFeature(t,e,r,s,u,d){if(!this.modelManager)return!1;let p=this.modelManager,_=t.tile.getBucket(this);if(!(_&&_ instanceof fy))return!1;let v=_;for(let w in v.instancesPerModel){let E=v.instancesPerModel[w],k=e.id!==void 0?e.id:e.properties&&e.properties.hasOwnProperty("id")?e.properties.id:void 0;if(E.idToFeaturesIndex.hasOwnProperty(k)){let D=E.features[E.idToFeaturesIndex[k]],N=p.getModel(w,this.scope);if(!N)return!1;let B=i.ad.create(),q=new Xr(0,0),Z=v.canonical,oe=Number.MAX_VALUE;for(let ve=0;ve<D.instancedDataCount;++ve){let be=16*(D.instancedDataOffset+ve),we=E.instancedDataArray.float32,$e=[we[be+4],we[be+5],we[be+6]];sS(Z,q,we[be],0|we[be+1]),WT(B,N,d,q,D.rotation,D.scale,$e,!1,!1,!1),d.projection.name==="globe"&&(B=dy(B,d));let Ge=i.ad.multiply([],d.projMatrix,B),it=t.queryGeometry,ot=VT(it.isPointQuery()?it.screenBounds:it.screenGeometry,d,Ge,N.aabb);ot!=null&&(oe=Math.min(ot,oe))}return oe!==Number.MAX_VALUE&&oe}}return!1}_handleOverridablePaintPropertyUpdate(t,e,r){return!(!this.layout||e.isDataDriven()||r.isDataDriven()||t!=="model-color"&&t!=="model-color-mix-intensity"&&t!=="model-rotation"&&t!=="model-scale"&&t!=="model-translation"&&t!=="model-emissive-strength")}_isPropertyZoomDependent(t){let e=this._transitionablePaint._values[t];return e!=null&&e.value!=null&&e.value.expression!=null&&e.value.expression instanceof ue}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(t,e,r,s){let u=t.tile,d=u.getBucket(this),p=null,_=Number.MAX_VALUE;if(!(d&&d instanceof u1))return{queryFeature:p,intersectionZ:_};let v=d.getNodesInfo()[e];if(v.hiddenByReplacement||!v.node.meshes||!r.filter(new ir(u.tileID.overscaledZ),v.feature,u.tileID.canonical))return{queryFeature:p,intersectionZ:_};let w=v.node,E=s.calculatePosMatrix(u.tileID.toUnwrapped(),s.worldSize),k=v.evaluatedScale,D=0;s.elevation&&w.elevation&&(D=w.elevation*s.elevation.exaggeration()),i.ad.translate(E,E,[(w.anchor?w.anchor[0]:0)*(k[0]-1),(w.anchor?w.anchor[1]:0)*(k[1]-1),D]),i.ad.scale(E,E,k),i.ad.multiply(E,E,w.matrix);let N=t.queryGeometry,B=N.isPointQuery()?N.screenBounds:N.screenGeometry,q=function(oe){let ve=i.ad.multiply([],E,oe.matrix),be=i.ad.multiply(ve,s.expandedFarZProjMatrix,ve);for(let we=0;we<oe.meshes.length;++we){let $e=oe.meshes[we];if(we===oe.lightMeshIndex)continue;let Ge=VT(B,s,be,$e.aabb);Ge!=null&&(_=Math.min(Ge,_))}if(oe.children)for(let we of oe.children)q(we)};if(q(w),_===Number.MAX_VALUE)return{queryFeature:p,intersectionZ:_};let Z=new Xr(0,0);return sS(u.tileID.canonical,Z,v.node.anchor[0],v.node.anchor[1]),p={type:"Feature",geometry:{type:"Point",coordinates:[Z.lng,Z.lat]},properties:v.feature.properties,id:v.feature.id,state:{},layer:this.serialize()},{queryFeature:p,intersectionZ:_}}},clip:class extends ho{constructor(t,e,r,s){super(t,rk,e,r,s)}recalculate(t,e){super.recalculate(t,e)}createBucket(t){return new Hw(t)}isTileClipped(){return!0}is3D(){return!0}}};Pe(AT,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});let lS=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Ty{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[r,s]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");let u=s>>4;if(u!==1)throw new Error(`Got v${u} data when expected v1.`);let d=lS[15&s];if(!d)throw new Error("Unrecognized array type.");let[p]=new Uint16Array(e,2,1),[_]=new Uint32Array(e,4,1);return new Ty(_,p,d,e)}constructor(e,r=64,s=Float64Array,u){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=s,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;let d=lS.indexOf(this.ArrayType),p=2*e*this.ArrayType.BYTES_PER_ELEMENT,_=e*this.IndexArrayType.BYTES_PER_ELEMENT,v=(8-_%8)%8;if(d<0)throw new Error(`Unexpected typed array class: ${s}.`);u&&u instanceof ArrayBuffer?(this.data=u,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+_+v,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+p+_+v),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+_+v,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+d]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){let s=this._pos>>1;return this.ids[s]=s,this.coords[this._pos++]=e,this.coords[this._pos++]=r,s}finish(){let e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Sy(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,s,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:d,coords:p,nodeSize:_}=this,v=[0,d.length-1,0],w=[];for(;v.length;){let E=v.pop()||0,k=v.pop()||0,D=v.pop()||0;if(k-D<=_){for(let Z=D;Z<=k;Z++){let oe=p[2*Z],ve=p[2*Z+1];oe>=e&&oe<=s&&ve>=r&&ve<=u&&w.push(d[Z])}continue}let N=D+k>>1,B=p[2*N],q=p[2*N+1];B>=e&&B<=s&&q>=r&&q<=u&&w.push(d[N]),(E===0?e<=B:r<=q)&&(v.push(D),v.push(N-1),v.push(1-E)),(E===0?s>=B:u>=q)&&(v.push(N+1),v.push(k),v.push(1-E))}return w}within(e,r,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:u,coords:d,nodeSize:p}=this,_=[0,u.length-1,0],v=[],w=s*s;for(;_.length;){let E=_.pop()||0,k=_.pop()||0,D=_.pop()||0;if(k-D<=p){for(let Z=D;Z<=k;Z++)uS(d[2*Z],d[2*Z+1],e,r)<=w&&v.push(u[Z]);continue}let N=D+k>>1,B=d[2*N],q=d[2*N+1];uS(B,q,e,r)<=w&&v.push(u[N]),(E===0?e-s<=B:r-s<=q)&&(_.push(D),_.push(N-1),_.push(1-E)),(E===0?e+s>=B:r+s>=q)&&(_.push(N+1),_.push(k),_.push(1-E))}return v}}function Sy(t,e,r,s,u,d){if(u-s<=r)return;let p=s+u>>1;cS(t,e,p,s,u,d),Sy(t,e,r,s,p-1,1-d),Sy(t,e,r,p+1,u,1-d)}function cS(t,e,r,s,u,d){for(;u>s;){if(u-s>600){let w=u-s+1,E=r-s+1,k=Math.log(w),D=.5*Math.exp(2*k/3),N=.5*Math.sqrt(k*D*(w-D)/w)*(E-w/2<0?-1:1);cS(t,e,r,Math.max(s,Math.floor(r-E*D/w+N)),Math.min(u,Math.floor(r+(w-E)*D/w+N)),d)}let p=e[2*r+d],_=s,v=u;for(gg(t,e,s,r),e[2*u+d]>p&&gg(t,e,s,u);_<v;){for(gg(t,e,_,v),_++,v--;e[2*_+d]<p;)_++;for(;e[2*v+d]>p;)v--}e[2*s+d]===p?gg(t,e,s,v):(v++,gg(t,e,v,u)),v<=r&&(s=v+1),r<=v&&(u=v-1)}}function gg(t,e,r,s){Ey(t,r,s),Ey(e,2*r,2*s),Ey(e,2*r+1,2*s+1)}function Ey(t,e,r){let s=t[e];t[e]=t[r],t[r]=s}function uS(t,e,r,s){let u=t-r,d=e-s;return u*u+d*d}i.$=Ll,i.A=Js,i.B=jo,i.C=jr,i.D=Co,i.E=jl,i.G=xs,i.H=h,i.I=LM,i.J=F0,i.K=function(t){let e=t.value,r=[];if(!e)return r;let s=Xc(e);return s!=="string"?(r=r.concat([new n1(t.key,e,`string expected, "${s}" found`)]),r):(UT(e,!0)||(r=r.concat([new n1(t.key,e,`invalid url "${e}"`)])),r)},i.L=xt,i.M=class{constructor(t,e,r,s){this.id=t,this.position=e!=null?new Xr(e[0],e[1]):new Xr(0,0),this.orientation=r??[0,0,0],this.nodes=s,this.uploaded=!1,this.aabb=new sa([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(t,e){if(i.ad.multiply(t.matrix,e,t.matrix),t.meshes)for(let r of t.meshes){let s=sa.applyTransform(r.aabb,t.matrix);this.aabb.encapsulate(s)}if(t.children)for(let r of t.children)this._applyTransformations(r,t.matrix)}computeBoundsAndApplyParent(){let t=i.ad.identity([]);for(let e of this.nodes)this._applyTransformations(e,t)}computeModelMatrix(t,e,r,s,u,d,p=!1){WT(this.matrix,this,t.transform,this.position,e,r,s,u,d,p)}upload(t){if(!this.uploaded){for(let e of this.nodes)py(e,t);for(let e of this.nodes)a1(e);this.uploaded=!0}}destroy(){for(let t of this.nodes)my(t)}},i.N=rn,i.O=Gt,i.P=hi,i.Q=class{constructor(t){this.specification=t}possiblyEvaluate(t,e){return $s(t.expression.evaluate(e))}interpolate(t,e,r){return{x:$i(t.x,e.x,r),y:$i(t.y,e.y,r),z:$i(t.z,e.z,r),azimuthal:$i(t.azimuthal,e.azimuthal,r),polar:$i(t.polar,e.polar,r)}}},i.R=fc,i.S=nv,i.T=nu,i.U=cn,i.V=n1,i.W=ya,i.X=ir,i.Y=vs,i.Z=ue,i.a=$l,i.a$=function(t){let{x:e,y:r}=t.point,{lng:s,lat:u}=t._center;return kw(e,r,t.worldSize,s,u)},i.a0=pn,i.a1=Sd,i.a2=$i,i.a3=rt,i.a4=ds,i.a5=class{constructor(t){this.specification=t}possiblyEvaluate(t,e){return function([r,s]){let u=$s([1,r,s]);return{x:u.x,y:u.y,z:u.z}}(t.expression.evaluate(e))}interpolate(t,e,r){return{x:$i(t.x,e.x,r),y:$i(t.y,e.y,r),z:$i(t.z,e.z,r)}}},i.a6=N0,i.a7=d_,i.a8=yd,i.a9=rw,i.aB=function(t,e){let{x:r,y:s}=t.point,u=kw(r,s,t.worldSize/t._pixelsPerMercatorPixel,0,0);return i.ad.multiply(u,u,kv(Fh(e)))},i.aD=Mm,i.aE=Ic,i.aF=N_,i.aG=function(t,e,r,s,u){let d=5*e+2;t.float32[d+0]=r,t.float32[d+1]=s,t.float32[d+2]=u},i.aH=X_,i.aI=Xr,i.aJ=_T,i.aK=sw,i.aL=fo,i.aM=Av,i.aN=NT,i.aO=yp,i.aP=Aw,i.aQ=function(t,e,r,s,u,d,p,_,v){if(v.name==="globe")return Aw(t,e,new yp(r,s,u),!1);let w=Sp({z:r,x:s,y:u},v);return new sa([(d+w.x/w.scale)*e,e*(w.y/w.scale),p],[(d+w.x2/w.scale)*e,e*(w.y2/w.scale),_])},i.aR=function(t,e,r){let s=0;for(let u=0;u<2;++u)t[u]>0&&(s+=(t[u]-0)*(t[u]-0)),e[u]<0&&(s+=(0-e[u])*(0-e[u]));return s},i.aS=ja,i.aT=Sv,i.aU=aw,i.aV=function(t){let e=i.ad.identity(new Float64Array(16));i.ad.multiply(e,t.pixelMatrix,t.globeMatrix);let r=[0,iu,0],s=[0,ru,0];return i._.transformMat4(r,r,e),i._.transformMat4(s,s,e),[r[0]>0&&r[0]<=t.width&&r[1]>0&&r[1]<=t.height&&!Dv(t,new Xr(t.center.lat,90)),s[0]>0&&s[0]<=t.width&&s[1]>0&&s[1]<=t.height&&!Dv(t,new Xr(t.center.lat,-90))]},i.aW=function(t,e){let{scale:r}=t.tileTransform,s=r*rt/(t.tileSize*Math.pow(2,e.zoom-t.tileID.overscaledZ+t.tileID.canonical.z));return i.aC.scale(new Float32Array(4),e.inverseAdjustmentMatrix,[s,s])},i.aX=i1,i.aY=OT,i.aZ=function(t){let e=OT(t,!0);return i.aC.invert([],[e[0],e[1],e[4],e[5]])},i.a_=Ev,i.aa=tl,i.ab=Tr,i.ac=function(t,e,r){let s=Math.sqrt(t*t+e*e+r*r),u=s>0?Math.acos(r/s)*oc:0,d=t!==0||e!==0?Math.atan2(-e,-t)*oc+90:0;return d<0&&(d+=360),[s,d,u]},i.ae=Rm,i.af=Hu,i.ag=ey,i.ah=function(t,e){let r={};for(let s=0;s<e.length;s++){let u=e[s];u in t&&(r[u]=t[u])}return r},i.ai=xf,i.aj=Mh,i.ak=Dh,i.al=mm,i.am=function(t){xu++,xu>vo&&(t.getActor().send("enforceCacheSizeLimit",Ra),xu=0)},i.an=Fs,i.ao=class{constructor(t){this.entries={},this.scheduler=t}request(t,e,r,s){let u=this.entries[t]=this.entries[t]||{callbacks:[]};if(u.result){let[d,p]=u.result;return this.scheduler?this.scheduler.add(()=>{s(d,p)},e):s(d,p),()=>{}}return u.callbacks.push(s),u.cancel||(u.cancel=r((d,p)=>{u.result=[d,p];for(let _ of u.callbacks)this.scheduler?this.scheduler.add(()=>{_(d,p)},e):_(d,p);setTimeout(()=>delete this.entries[t],3e3)})),()=>{u.result||(u.callbacks=u.callbacks.filter(d=>d!==s),u.callbacks.length||(u.cancel(),delete this.entries[t]))}}},i.ap=function(t,e,r){let s=JSON.stringify(t.request);return t.data&&(this.deduped.entries[s]={result:[null,t.data]}),this.deduped.request(s,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},u=>{let d=ro(t.request,(p,_,v,w)=>{p?u(p):_&&u(null,{vectorTile:r?void 0:new Bv(new km(_)),rawData:_,cacheControl:v,expires:w})});return()=>{d.cancel(),u()}},e)},i.aq=lv,i.ar=class extends vd{constructor(t){super(t),this.current=uI}set(t,e,r){if(this.fetchUniformLocation(t,e)){for(let s=0;s<9;s++)if(r[s]!==this.current[s]){this.current=r,this.gl.uniformMatrix3fv(this.location,!1,r);break}}}},i.as=cv,i.at=lr,i.au=Rl,i.aw=Rt,i.ax=rl,i.ay=Uo,i.az=function(t,e,r){t[4*e+0]=r[0],t[4*e+1]=r[1],t[4*e+2]=r[2],t[4*e+3]=r[3]},i.b=oa,i.b$=wf,i.b0=va,i.b1=dv,i.b2=function(t){let e=Math.round((t+45+360)%360/90)%4;return Xd[e]},i.b3=45,i.b4=mv,i.b5=f_,i.b6=sa,i.b7=$s,i.b8=function(t){return[Math.pow(t[0],1/2.2),Math.pow(t[1],1/2.2),Math.pow(t[2],1/2.2)]},i.b9=sc,i.bA=function(t,e){return[Math.pow(t[0],2.2)*e,Math.pow(t[1],2.2)*e,Math.pow(t[2],2.2)*e]},i.bB=k5,i.bD=Iw,i.bE=cr,i.bF=Zi,i.bG=256,i.bH=function(t,e){let r=[0,0,0],s=H0(Fh(e.canonical));return i._.transformMat4(r,r,s),i._.transformMat4(r,r,t),r},i.bI=t=>({u_camera_to_center_distance:new tl(t),u_extrude_scale:new uv(t),u_device_pixel_ratio:new tl(t),u_matrix:new N0(t),u_inv_rot_matrix:new N0(t),u_merc_center:new yd(t),u_tile_id:new lv(t),u_zoom_transition:new tl(t),u_up_dir:new lv(t),u_emissive_strength:new tl(t)}),i.bJ=t=>({u_matrix:new N0(t),u_pixels_to_tile_units:new uv(t),u_device_pixel_ratio:new tl(t),u_units_to_pixels:new yd(t),u_dash_image:new d_(t),u_gradient_image:new d_(t),u_image_height:new tl(t),u_texsize:new yd(t),u_tile_units_to_pixels:new tl(t),u_alpha_discard_threshold:new tl(t),u_trim_offset:new yd(t),u_trim_fade_range:new yd(t),u_trim_color:new cv(t),u_emissive_strength:new tl(t)}),i.bK=t=>({u_matrix:new N0(t),u_texsize:new yd(t),u_pixels_to_tile_units:new uv(t),u_device_pixel_ratio:new tl(t),u_image:new d_(t),u_units_to_pixels:new yd(t),u_tile_units_to_pixels:new tl(t),u_alpha_discard_threshold:new tl(t),u_trim_offset:new yd(t)}),i.bL=Kx,i.bM=Gk,i.bN=ts,i.bO=lM,i.bP=lT,i.bQ=$v,i.bR=Fw,i.bS=(t,e,r,s,u,d)=>{let p=t.transform,_=p.projection.name==="globe",v;if(d.paint.get("circle-pitch-alignment")==="map")if(_){let E=Iw(p.zoom,e.canonical)*p._pixelsPerMercatorPixel;v=Float32Array.from([E,0,0,E])}else v=p.calculatePixelsToTileUnitsMatrix(r);else v=new Float32Array([p.pixelsToGLUnits[0],0,0,p.pixelsToGLUnits[1]]);let w={u_camera_to_center_distance:t.transform.getCameraToCenterDistance(p.projection),u_matrix:t.translatePosMatrix(e.projMatrix,r,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_device_pixel_ratio:ur.devicePixelRatio,u_extrude_scale:v,u_inv_rot_matrix:LI,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:d.paint.get("circle-emissive-strength")};if(_){w.u_inv_rot_matrix=s,w.u_merc_center=u,w.u_tile_id=[e.canonical.x,e.canonical.y,1<<e.canonical.z],w.u_zoom_transition=Sd(p.zoom);let E=u[0]*rt,k=u[1]*rt;w.u_up_dir=p.projection.upVector(new yp(0,0,0),E,k)}return w},i.bT=F5,i.bU=(t,e,r,s,u,d)=>{let p=t.transform;return{u_matrix:D5(t,e,r,s),u_texsize:e.imageAtlasTexture?e.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:p.calculatePixelsToTileUnitsMatrix(e),u_device_pixel_ratio:u,u_image:0,u_tile_units_to_pixels:M5(e,p),u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:d}},i.bV=(t,e,r,s,u,d,p)=>{let _=t.transform,v=_.calculatePixelsToTileUnitsMatrix(e);return{u_matrix:D5(t,e,r,s),u_pixels_to_tile_units:v,u_device_pixel_ratio:d,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:u,u_texsize:P5(r)&&e.lineAtlasTexture?e.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:M5(e,t.transform),u_alpha_discard_threshold:0,u_trim_offset:p,u_trim_fade_range:r.paint.get("line-trim-fade-range"),u_trim_color:r.paint.get("line-trim-color").toRenderColor(r.lut).toArray01(),u_emissive_strength:r.paint.get("line-emissive-strength")}},i.bW=_u,i.bX=G0,i.bY=b5,i.bZ=xI,i.b_=F_,i.ba=function(t,e,r){let s=Sd(r.zoom),u=t.style.map._antialias,d=e.options.extStandardDerivativesForceOff||t.terrain&&t.terrain.exaggeration()>0;return s===0&&!u&&!d},i.bb=function(t){let e=t.pixelsPerMeter,r=e/rl(1,t.center.lat),s=i.ad.identity(new Float64Array(16));return i.ad.translate(s,s,[t.point.x,t.point.y,0]),i.ad.scale(s,s,[r,r,e]),Float32Array.from(s)},i.bc=v_,i.bd=function(t){let e=ja-5;t=lr(t,-e,e)/e*90;let r=Math.pow(Math.abs(Math.sin(Tr(t))),3);return Math.round(r*(fv.length-1))},i.be=function(t,e,r,s){let u=e.getNorth(),d=e.getSouth(),p=e.getWest(),_=e.getEast(),v=1<<t.z,w=_-p,E=u-d,k=w/vm,D=-E/fv[r],N=[0,k,0,D,0,0,u,p,0];if(t.z>0){let B=180/s;i.bC.multiply(N,N,[B/w+1,0,0,0,B/E+1,0,-.5*B/k,.5*B/D,1])}return N[2]=v,N[5]=t.x,N[8]=t.y,N},i.bf=H0,i.bg=Fh,i.bh=function(t,e,r){let s=i.ad.identity(new Float64Array(16)),u=(e/(1<<t)-.5)*Math.PI*2;return i.ad.rotateY(s,r.globeMatrix,u),Float32Array.from(s)},i.bi=Mr,i.bj=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},i.bk=LT,i.bl=RT,i.bm=PT,i.bn=function(t,e){let r=document.createElement("video");r.muted=!0,r.onloadstart=function(){e(null,r)};for(let s=0;s<t.length;s++){let u=document.createElement("source");Zd(t[s])||(r.crossOrigin="Anonymous"),u.src=t[s],r.appendChild(u)}return{cancel:()=>{}}},i.bo=Z_,i.bp=dh,i.bq=class{isDataAvailableAtPoint(t){let e=this._source();if(this.isUsingMockSource()||!e||t.y<0||t.y>1)return!1;let r=e.getSource().maxzoom,s=1<<r,u=Math.floor(t.x),d=Math.floor((t.x-u)*s),p=Math.floor(t.y*s),_=this.findDEMTileFor(new fo(r,u,r,d,p));return!(!_||!_.dem)}getAtPointOrZero(t,e=0){return this.getAtPoint(t,e)||0}getAtPoint(t,e,r=!0){if(this.isUsingMockSource())return null;e==null&&(e=null);let s=this._source();if(!s||t.y<0||t.y>1)return e;let u=s.getSource().maxzoom,d=1<<u,p=Math.floor(t.x),_=t.x-p,v=new fo(u,p,u,Math.floor(_*d),Math.floor(t.y*d)),w=this.findDEMTileFor(v);if(!w||!w.dem)return e;let E=w.dem,k=1<<w.tileID.canonical.z,D=(_*k-w.tileID.canonical.x)*E.dim,N=(t.y*k-w.tileID.canonical.y)*E.dim,B=Math.floor(D),q=Math.floor(N);return(r?this.exaggeration():1)*$i($i(E.get(B,q),E.get(B,q+1),N-q),$i(E.get(B+1,q),E.get(B+1,q+1),N-q),D-B)}getAtTileOffset(t,e,r){let s=1<<t.canonical.z;return this.getAtPointOrZero(new vs(t.wrap+(t.canonical.x+e/rt)/s,(t.canonical.y+r/rt)/s))}getAtTileOffsetFunc(t,e,r,s){return u=>{let d=this.getAtTileOffset(t,u.x,u.y),p=s.upVector(t.canonical,u.x,u.y),_=s.upVectorScale(t.canonical,e,r).metersToTile;return i._.scale(p,p,d*_),p}}getForTilePoints(t,e,r,s){if(this.isUsingMockSource())return!1;let u=Am.create(this,t,s);return!!u&&(e.forEach(d=>{d[2]=this.exaggeration()*u.getElevationAt(d[0],d[1],r)}),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;let e=this.findDEMTileFor(t);if(!e||!e.dem)return null;let r=e.dem.tree,s=e.tileID,u=1<<t.canonical.z-s.canonical.z,d=t.canonical.x/u-s.canonical.x,p=t.canonical.y/u-s.canonical.y,_=0;for(let v=0;v<t.canonical.z-s.canonical.z&&!r.leaves[_];v++){d*=2,p*=2;let w=2*Math.floor(p)+Math.floor(d);_=r.childOffsets[_]+w,d%=1,p%=1}return{min:this.exaggeration()*r.minimums[_],max:this.exaggeration()*r.maximums[_]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,r){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){let t=this.visibleDemTiles;if(t.length===0)return null;let e=!1,r=Number.MAX_VALUE,s=Number.MIN_VALUE;for(let u of t){let d=this.getMinMaxForTile(u.tileID);d&&(r=Math.min(r,d.min),s=Math.max(s,d.max),e=!0)}return e?{min:r,max:s}:null}},i.br=V0,i.bs=x_,i.bt=Bu,i.bu=ko,i.bv=Ep,i.bw=gy,i.bx=o1,i.by=J_,i.bz=Bw,i.c=iS,i.c$=mc,i.c0=450,i.c1=7,i.c2=cD,i.c3=CT,i.c4=256,i.c5=Sw,i.c6=kv,i.c7=nn,i.c8=ff,i.c9=_p,i.cA=function(t){let e=1/0,r=1/0,s=-1/0,u=-1/0;for(let d of t)e=Math.min(e,d.x),r=Math.min(r,d.y),s=Math.max(s,d.x),u=Math.max(u,d.y);return{min:new hi(e,r),max:new hi(s,u)}},i.cB=vf,i.cC=hw,i.cD=il,i.cE=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.cF=tT,i.cG=yv,i.cH=e5,i.cI=t5,i.cJ=Kv,i.cK=Ty,i.cL=function(t){return t({pluginStatus:Yt,pluginURL:Nt}),nr.on("pluginStateChange",t),t},i.cM=Fm,i.cN=Zv,i.cO=pc,i.cP=Li,i.cQ=F,i.cR=ua,i.cS=na,i.cT=ss,i.cU=function(t){let e=t.indexOf(cf);return e>=0?t.slice(0,e):t},i.cV=function(t){return t.indexOf(cf)>=0},i.cW=function(t){let e=t.indexOf(cf);return e>=0?t.slice(e+1):""},i.cX=function(t){let e=[],r=t.id;return r===void 0&&e.push({message:`layers.${r}: missing required property "id"`}),t.render===void 0&&e.push({message:`layers.${r}: missing required method "render"`}),t.renderingMode&&t.renderingMode!=="2d"&&t.renderingMode!=="3d"&&e.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),e},i.cY=function(t,e,r,s){return t.type==="custom"?new dD(t,e):new UD[t.type](t,e,r,s)},i.cZ=pl,i.c_=nr,i.ca=1,i.cb=og,i.cc=0,i.cd=tv,i.ce=function(t,e,r,s,u){return lr((t-e)/(r-e)*(u-s)+s,s,u)},i.cf=mp,i.cg=bp,i.ch=class{constructor(t,e,r,s){this.context=t,this.format=s,this.size=r,this.texture=t.gl.createTexture();let[u,d,p]=this.size,{gl:_}=t;_.bindTexture(_.TEXTURE_3D,this.texture),t.pixelStoreUnpackFlipY.set(!1),t.pixelStoreUnpack.set(1),t.pixelStoreUnpackPremultiplyAlpha.set(!1);let v=this.format,w=_.UNSIGNED_BYTE;this.format===_.DEPTH_COMPONENT&&(v=_.DEPTH_COMPONENT16,w=_.UNSIGNED_SHORT),this.format===_.R8&&(s=_.RED),this.format===_.R32F&&(w=_.FLOAT,s=_.RED),_.texImage3D(_.TEXTURE_3D,0,v,u,d,p,0,s,w,e.data)}bind(t,e){let{context:r}=this,{gl:s}=r;s.bindTexture(s.TEXTURE_3D,this.texture),t!==this.minFilter&&(s.texParameteri(s.TEXTURE_3D,s.TEXTURE_MAG_FILTER,t),s.texParameteri(s.TEXTURE_3D,s.TEXTURE_MIN_FILTER,t),this.minFilter=t),e!==this.wrapS&&(s.texParameteri(s.TEXTURE_3D,s.TEXTURE_WRAP_S,e),s.texParameteri(s.TEXTURE_3D,s.TEXTURE_WRAP_T,e),this.wrapS=e)}destroy(){let{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}},i.ci=dy,i.cj=[1,1,1],i.ck=Am,i.cl=zm,i.cm=mf,i.cn=_m,i.co=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new hi(1/0,1/0),max:new hi(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(t,e=!1){let r=Kw(new hi(0,0),new hi(rt,rt),t),s=[];if(e&&!zv(r,this._globalClipBounds))return s;for(let u of this._activeRegions){if(u.hiddenByOverlap||!zv(r,u))continue;let d=_k(u.min,u.max,t);s.push({min:d.min,max:d.max,sourceId:this._sourceIds[u.priority],footprint:u.footprint,footprintTileId:u.tileId,order:u.order,clipMask:u.clipMask})}return s}setSources(t){this._setSources(t.map(e=>({getSourceId:()=>e.cache.id,getFootprints:()=>{let r=[];for(let s of e.cache.getVisibleCoordinates()){let u=e.cache.getTile(s).buckets[e.layer];u&&u.updateFootprints(s.toUnwrapped(),r)}return r},getOrder:()=>e.order,getClipMask:()=>e.clipMask})))}_addSource(t){let e=t.getFootprints();if(e.length===0)return;let r=t.getOrder(),s=t.getClipMask();for(let u of e){if(!u.footprint)continue;let d=Kw(u.footprint.min,u.footprint.max,u.id);this._activeRegions.push({min:d.min,max:d.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:u.id,footprint:u.footprint,order:r,clipMask:s})}this._sourceIds.push(t.getSourceId())}_computeReplacement(){this._activeRegions.sort((e,r)=>e.priority-r.priority||k_(e.min,r.min)||k_(e.max,r.max));let t=this._activeRegions.length!==this._prevRegions.length;if(!t){let e=0;for(;!t&&e!==this._activeRegions.length;){let r=this._activeRegions[e],s=this._prevRegions[e];t=r.priority!==s.priority||!Yw(r,s)||r.order!==s.order||r.clipMask!==s.clipMask,++e}}if(t){++this._updateTime;for(let r of this._activeRegions)r.order!==1/0&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,r.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,r.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,r.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,r.max.y));let e=r=>{let s=this._activeRegions;if(r>=s.length)return r;let u=s[r].priority;for(;r<s.length&&s[r].priority===u;)++r;return r};if(this._sourceIds.length>1){let r=0,s=e(r);for(;r!==s;){let u=r,d=r;for(;u!==s;){let p=this._activeRegions[u];p.hiddenByOverlap=!1;for(let _=0;_<d;_++){let v=this._activeRegions[_];if(!v.hiddenByOverlap&&p.order===1/0&&zv(p,v)&&(p.hiddenByOverlap=Qw(p.footprint,p.tileId,v.footprint,v.tileId),p.hiddenByOverlap))break}++u}r=s,s=e(r)}}}}_setSources(t){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let e=t.length-1;e>=0;e--)this._addSource(t[e]);this._computeReplacement()}},i.cp=hf,i.cq=K_,i.cr=R0,i.cs=class{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(let t of this._poleSegments)t.destroy();for(let t of this._gridSegments)t.withSkirts.destroy(),t.withoutSkirts.destroy()}_fillGridMeshWithLods(t,e){let r=new Bu,s=new ko,u=[],d=t+1+2,p=e[0]+1,_=e[0]+1+(1+e.length),v=(w,E,k)=>{let D=w===d-1?w-2:w===0?w:w-1;return D+=k?24575:0,[D,E]};for(let w=0;w<d;++w)r.emplaceBack(...v(w,0,!0));for(let w=0;w<p;++w)for(let E=0;E<d;++E)r.emplaceBack(...v(E,w,(E===0||E===d-1)&&!0));for(let w=0;w<e.length;++w){let E=e[w];for(let k=0;k<d;++k)r.emplaceBack(...v(k,E,!0))}for(let w=0;w<e.length;++w){let E=s.length,k=e[w]+1+2,D=new ko;for(let q=0;q<k-1;q++){let Z=q===k-2,oe=Z?d*(_-e.length+w-q):d;for(let ve=0;ve<d-1;ve++){let be=q*d+ve;q===0||Z||ve===0||ve===d-2?(D.emplaceBack(be+1,be,be+oe),D.emplaceBack(be+oe,be+oe+1,be+1)):(s.emplaceBack(be+1,be,be+oe),s.emplaceBack(be+oe,be+oe+1,be+1))}}let N=oa.simpleSegment(0,E,r.length,s.length-E);for(let q=0;q<D.uint16.length;q+=3)s.emplaceBack(D.uint16[q],D.uint16[q+1],D.uint16[q+2]);let B=oa.simpleSegment(0,E,r.length,s.length-E);u.push({withoutSkirts:N,withSkirts:B})}return{vertices:r,indices:s,segments:u}}_createGrid(t){let e=this._fillGridMeshWithLods(vm,fv);this._gridSegments=e.segments,this._gridBuffer=t.createVertexBuffer(e.vertices,V0.members),this._gridIndexBuffer=t.createIndexBuffer(e.indices,!0)}_createPoles(t){let e=new ko;for(let p=0;p<=vm;p++)e.emplaceBack(0,p+1,p+2);this._poleIndexBuffer=t.createIndexBuffer(e,!0);let r=new _p,s=new _p,u=new _p,d=new _p;this._poleSegments=[];for(let p=0,_=0;p<dv;p++){let v=360/(1<<p);r.emplaceBack(0,-il,0,.5,0),s.emplaceBack(0,-il,0,.5,1),u.emplaceBack(0,-il,0,.5,.5),d.emplaceBack(0,-il,0,.5,.5);for(let w=0;w<=vm;w++){let E=w/vm,k=0,D=$i(0,v,E),[N,B,q]=ym(FI,PI,D,il);r.emplaceBack(N,B,q,E,k),s.emplaceBack(N,B,q,E,1-k);let Z=Tr(D);E=.5+.5*Math.sin(Z),k=.5+.5*Math.cos(Z),u.emplaceBack(N,B,q,E,k),d.emplaceBack(N,B,q,E,1-k)}this._poleSegments.push(oa.simpleSegment(_,0,66,64)),_+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(r,__,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(s,__,!1),this._texturedPoleNorthVertexBuffer=t.createVertexBuffer(u,__,!1),this._texturedPoleSouthVertexBuffer=t.createVertexBuffer(d,__,!1)}getGridBuffers(t,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[t].withSkirts:this._gridSegments[t].withoutSkirts]}getPoleBuffers(t,e){return[e?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,e?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}},i.ct=function(t){return Ys.has(t)},i.cu=c5,i.cv=function(t,e,r=0,s=!0){let u=new hi(r,r),d=t.sub(u),p=e.add(u),_=[d,new hi(p.x,d.y),p,new hi(d.x,p.y)];return s&&_.push(d.clone()),_},i.cw=function(t,e){let r=[];for(let s=0;s<t.length;s++){let u=Rl(s-1,-1,t.length-1),d=Rl(s+1,-1,t.length-1),p=t[s],_=t[d],v=t[u].sub(p).unit(),w=_.sub(p).unit(),E=w.angleWithSep(v.x,v.y),k=v.add(w).unit().mult(-1*e/Math.sin(E/2));r.push(p.add(k))}return r},i.cx=dT,i.cy=gw,i.cz=function(t,e,r=0){return i._.fromValues(((e.x-r)*t.scale-t.x)*rt,(e.y*t.scale-t.y)*rt,lw(e.z,e.y))},i.d=xc,i.d$=Bc,i.d0=lc,i.d1=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.d2=dl,i.d3=uw,i.d4=vp,i.d5=function([t,e,r]){let s=Math.hypot(t,e,r),u=Math.atan2(t,r),d=.5*Math.PI-Math.acos(-e/s);return new Xr(va(u),va(d))},i.d6=El,i.d7=bm,i.d8=A,i.d9=Dv,i.dA=function(t){let e=us();if(!e)return;let r=e.delete(Ma);t&&r.catch(t).then(()=>t())},i.dB=hg,i.dC=$T,i.dD=function(t){xy=ur.resolveURL(t),Vm||(Vm=new gy(o1(),new jl)),Vm.broadcast("setDracoUrl",xy)},i.dE=XT,i.dF=function(t){jm=ur.resolveURL(t),Vm||(Vm=new gy(o1(),new jl)),Vm.broadcast("setMeshoptUrl",jm)},i.dG=eo,i.dH=Pe,i.dI=yf,i.dJ=Uu,i.dK=Sp,i.dL=ov,i.dM=L5,i.dN=V5,i.dO=C5,i.dP=zc,i.dQ=rT,i.dR=Om,i.dS=function(t,e,r,s,u,d,p,_,v,w,E){t.createArrays(),t.tilePixelRatio=rt/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;let k=t.layers[0].layout,D=t.layers[0]._unevaluatedLayout._values,N={};if(t.textSizeData.kind==="composite"){let{minZoom:oe,maxZoom:ve}=t.textSizeData;N.compositeTextSizes=[D["text-size"].possiblyEvaluate(new ir(oe),_),D["text-size"].possiblyEvaluate(new ir(ve),_)]}if(t.iconSizeData.kind==="composite"){let{minZoom:oe,maxZoom:ve}=t.iconSizeData;N.compositeIconSizes=[D["icon-size"].possiblyEvaluate(new ir(oe),_),D["icon-size"].possiblyEvaluate(new ir(ve),_)]}N.layoutTextSize=D["text-size"].possiblyEvaluate(new ir(v+1),_),N.layoutIconSize=D["icon-size"].possiblyEvaluate(new ir(v+1),_),N.textMaxSize=D["text-size"].possiblyEvaluate(new ir(18),_);let B=k.get("text-rotation-alignment")==="map"&&k.get("symbol-placement")!=="point",q=k.get("text-size"),Z=!1;for(let oe of t.features)if(oe.icon&&oe.icon.nameSecondary){Z=!0;break}for(let oe of t.features){let ve=k.get("text-font").evaluate(oe,{},_).join(","),be=q.evaluate(oe,{},_),we=N.layoutTextSize.evaluate(oe,{},_),$e=(N.layoutIconSize.evaluate(oe,{},_),{horizontal:{},vertical:void 0}),Ge=oe.text,it,ot=[0,0];if(Ge){let At=Ge.toString(),zt=k.get("text-letter-spacing").evaluate(oe,{},_)*ts,Jt=k.get("text-line-height").evaluate(oe,{},_)*ts,Ot=Ct(At)?zt:0,Xt=k.get("text-anchor").evaluate(oe,{},_),Dt=k.get("text-variable-anchor");if(!Dt){let ei=k.get("text-radial-offset").evaluate(oe,{},_);ot=ei?lT(Xt,[ei*ts,Yv]):k.get("text-offset").evaluate(oe,{},_).map(li=>li*ts)}let Zt=B?"center":k.get("text-justify").evaluate(oe,{},_),ri=k.get("symbol-placement")==="point",Kt=ri?k.get("text-max-width").evaluate(oe,{},_)*ts:1/0,Si=ei=>{t.allowVerticalPlacement&&bt(At)&&($e.vertical=qv(Ge,e,r,u,ve,Kt,Jt,Xt,ei,Ot,ot,Ic.vertical,!0,we,be))};if(!B&&Dt){let ei=Zt==="auto"?Dt.map(Xi=>Kv(Xi)):[Zt],li=!1;for(let Xi=0;Xi<ei.length;Xi++){let zi=ei[Xi];if(!$e.horizontal[zi])if(li)$e.horizontal[zi]=$e.horizontal[0];else{let Oi=qv(Ge,e,r,u,ve,Kt,Jt,"center",zi,Ot,ot,Ic.horizontal,!1,we,be);Oi&&($e.horizontal[zi]=Oi,li=Oi.positionedLines.length===1)}}Si("left")}else{if(Zt==="auto"&&(Zt=Kv(Xt)),ri||k.get("text-writing-mode").indexOf("horizontal")>=0||!bt(At)){let ei=qv(Ge,e,r,u,ve,Kt,Jt,Xt,Zt,Ot,ot,Ic.horizontal,!1,we,be);ei&&($e.horizontal[Zt]=ei)}Si(ri?"left":Zt)}}let _t=!1;if(oe.icon&&oe.icon.namePrimary){let At=s[oe.icon.namePrimary];At&&(it=_M(u[oe.icon.namePrimary],oe.icon.nameSecondary?u[oe.icon.nameSecondary]:void 0,k.get("icon-offset").evaluate(oe,{},_),k.get("icon-anchor").evaluate(oe,{},_)),_t=At.sdf,t.sdfIcons===void 0?t.sdfIcons=At.sdf:t.sdfIcons!==At.sdf&&Nn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(At.pixelRatio!==t.pixelRatio||k.get("icon-rotate").constantOr(1)!==0)&&(t.iconsNeedLinear=!0))}let Mt=uT($e.horizontal)||$e.vertical;t.iconsInText||(t.iconsInText=!!Mt&&Mt.iconsInText),(Mt||it)&&SM(t,oe,$e,it,s,N,we,0,ot,_t,p,_,w,E,Z)}d&&t.generateCollisionDebugBuffers(v,t.collisionBoxArray)},i.dT=P_,i.dU=E_,i.dV=Bv,i.dW=km,i.dX=M_,i.dY=ly,i.dZ=C_,i.d_=A_,i.da=Mw,i.db=function(t){let e=[0,0,0],r=i.ad.identity(new Float64Array(16));return i.ad.multiply(r,t.pixelMatrix,t.globeMatrix),i._.transformMat4(e,e,r),new hi(e[0],e[1])},i.dc=H,i.dd=te,i.de=function(t){let e=t.navigator?t.navigator.userAgent:null;return!!function(r){if(ct==null){let s=r.navigator?r.navigator.userAgent:null;ct=!!r.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return ct}(t)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},i.df=fl,i.dg=class{constructor(t,e,r){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!r,this._createSkuToken()}_createSkuToken(){let t=function(){let e="";for(let r=0;r<10;r++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",td,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!F(t))return t;let r=Oa(t);return r.params.push(`sdk=js-${x}`),r.path=`/styles/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!F(t))return t;let r=Oa(t);return r.path=`/fonts/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||e)}normalizeModelURL(t,e){if(!F(t))return t;let r=Oa(t);return r.path=`/models/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||e)}normalizeSourceURL(t,e,r,s){if(!F(t))return t;let u=Oa(t);return u.path=`/v4/${u.authority}.json`,u.params.push("secure"),r&&u.params.push(`language=${r}`),s&&u.params.push(`worldview=${s}`),this._makeAPIURL(u,this._customAccessToken||e)}normalizeSpriteURL(t,e,r,s){let u=Oa(t);return F(t)?(u.path=`/styles/v1${u.path}/sprite${e}${r}`,this._makeAPIURL(u,this._customAccessToken||s)):(u.path+=`${e}${r}`,No(u))}normalizeTileURL(t,e,r){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!F(t))return t;let s=Oa(t);s.path=s.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||r&&s.authority!=="raster"&&r===512?"@2x":""}${Uc.supported?".webp":"$1"}`),s.authority==="raster"?s.path=`/${A.RASTER_URL_PREFIX}${s.path}`:s.authority==="rasterarrays"?s.path=`/${A.RASTERARRAYS_URL_PREFIX}${s.path}`:s.authority==="3dtiles"?s.path=`/${A.TILES3D_URL_PREFIX}${s.path}`:(s.path=s.path.replace(/^.+\/v4\//,"/"),s.path=`/${A.TILE_URL_VERSION}${s.path}`);let u=this._customAccessToken||function(d){for(let p of d){let _=p.match(/^access_token=(.*)$/);if(_)return _[1]}return null}(s.params)||A.ACCESS_TOKEN;return A.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&s.params.push(`sku=${this._skuToken}`),this._makeAPIURL(s,u)}canonicalizeTileURL(t,e){let r=Oa(t);if(!r.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!r.path.match(/\.[\w]+$/))return t;let s="mapbox://";r.path.match(/^\/raster\/v1\//)?s+=`raster/${r.path.replace(`/${A.RASTER_URL_PREFIX}/`,"")}`:r.path.match(/^\/rasterarrays\/v1\//)?s+=`rasterarrays/${r.path.replace(`/${A.RASTERARRAYS_URL_PREFIX}/`,"")}`:s+=`tiles/${r.path.replace(`/${A.TILE_URL_VERSION}/`,"")}`;let u=r.params;return e&&(u=u.filter(d=>!d.match(/^access_token=/))),u.length&&(s+=`?${u.join("&")}`),s}canonicalizeTileset(t,e){let r=!!e&&F(e),s=[];for(let u of t.tiles||[])M(u)?s.push(this.canonicalizeTileURL(u,r)):s.push(u);return s}_makeAPIURL(t,e){let r="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",s=Oa(A.API_URL);if(t.protocol=s.protocol,t.authority=s.authority,t.protocol==="http"){let u=t.params.indexOf("secure");u>=0&&t.params.splice(u,1)}if(s.path!=="/"&&(t.path=`${s.path}${t.path}`),!A.REQUIRE_ACCESS_TOKEN)return No(t);if(e=e||A.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${r}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${r}`)}return t.params=t.params.filter(u=>u.indexOf("access_token")===-1),t.params.push(`access_token=${e||""}`),No(t)}},i.dh=function(t,e){e?Ys.add(t):Ys.delete(t)},i.di=Uc,i.dj=Tu,i.dk=zl,i.dl=id,i.dm=ph,i.dn=xl,i.dp=function(t){Ys.delete(t)},i.dq=vl,i.dr=Bl,i.ds=cc,i.dt=x,i.du=function(t,e){Ra=t,vo=e},i.dv=function(t,e,r=!1){if(Yt===di||Yt===pi||Yt===Ai)throw new Error("setRTLTextPlugin cannot be called multiple times.");Nt=ur.resolveURL(t),Yt=di,mi=e,pr(),r||Ur()},i.dw=Ir,i.dx=function(){o1().acquire(_y)},i.dy=function(){let t=fg;t&&(t.isPreloaded()&&t.numActive()===1?(t.release(_y),fg=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.dz=dg,i.e=ur,i.e0=R5,i.e1=K,i.e2=ro,i.e3=function(t){let e=0;if(new Uint32Array(t,0,1)[0]!==YT){let r=new Uint32Array(t,0,7),[,,s,u,d,p]=r;e=r.byteLength+u+d+p+d,(s!==t.byteLength||e>=t.byteLength)&&Nn("Invalid b3dm header information.")}return eS(t,e)},i.e4=function(t,e){let r=iS(t);for(let s of r){for(let u of s.meshes)BD(u);s.lights&&(s.lightMeshIndex=s.meshes.length,s.meshes.push(zD(s.lights,e)))}return r},i.e5=u1,i.e6=qT,i.e7=un,i.e8=function(t){Ms(),ra&&ra.then(e=>{e.keys().then(r=>{for(let s=0;s<r.length-t;s++)e.delete(r[s])})})},i.f=Na,i.g=function(t,e){return mc(ya(t,{type:"json"}),e)},i.h=Xs,i.i=Cc,i.j=iT,i.k=Xv,i.l=function(t){return fetch(t).then(e=>e.arrayBuffer()).then(e=>eS(e,0,t))},i.m=class extends n1{},i.n=Xc,i.o=_h,i.p=BM,i.q=_d,i.r=m,i.s=o,i.t=X,i.u=Tl,i.v=Vo,i.w=Nn,i.x=he,i.y=re,i.z=Gl}),c(["./shared"],function(i){function x(ee){let z=ee?ee.url.toString():void 0;return z?performance.getEntriesByName(z):[]}function T(ee){if(typeof ee=="number"||typeof ee=="boolean"||typeof ee=="string"||ee==null)return JSON.stringify(ee);if(Array.isArray(ee)){let G="[";for(let Q of ee)G+=`${T(Q)},`;return`${G}]`}let z="{";for(let G of Object.keys(ee).sort())z+=`${G}:${T(ee[G])},`;return`${z}}`}function A(ee){let z="";for(let G of i.cE)z+=`/${T(ee[G])}`;return z}class M{constructor(z){this.keyCache={},this._layers={},this._layerConfigs={},z&&this.replace(z)}replace(z,G){this._layerConfigs={},this._layers={},this.update(z,[],G)}update(z,G,Q){this._options=Q;for(let le of z)this._layerConfigs[le.id]=le,(this._layers[le.id]=i.cY(le,this.scope,null,this._options)).compileFilter(),this.keyCache[le.id]&&delete this.keyCache[le.id];for(let le of G)delete this.keyCache[le],delete this._layerConfigs[le],delete this._layers[le];this.familiesBySource={};let se=function(le,Me){let Ze={};for(let We=0;We<le.length;We++){let nt=Me&&Me[le[We].id]||A(le[We]);Me&&(Me[le[We].id]=nt);let dt=Ze[nt];dt||(dt=Ze[nt]=[]),dt.push(le[We])}let ke=[];for(let We in Ze)ke.push(Ze[We]);return ke}(i.dG(this._layerConfigs),this.keyCache);for(let le of se){let Me=le.map(Pt=>this._layers[Pt.id]),Ze=Me[0];if(Ze.visibility==="none")continue;let ke=Ze.source||"",We=this.familiesBySource[ke];We||(We=this.familiesBySource[ke]={});let nt=Ze.sourceLayer||"_geojsonTileLayer",dt=We[nt];dt||(dt=We[nt]=[]),dt.push(Me)}}}let F=1*i.dJ;class W{constructor(z){let G={},Q=[];for(let Ze in z){let ke=z[Ze],We=G[Ze]={};for(let nt in ke.glyphs){let dt=ke.glyphs[+nt];if(!dt||dt.bitmap.width===0||dt.bitmap.height===0)continue;let Pt=dt.metrics.localGlyph?F:1,ti={x:0,y:0,w:dt.bitmap.width+2*Pt,h:dt.bitmap.height+2*Pt};Q.push(ti),We[nt]=ti}}let{w:se,h:le}=i.j(Q),Me=new i.dI({width:se||1,height:le||1});for(let Ze in z){let ke=z[Ze];for(let We in ke.glyphs){let nt=ke.glyphs[+We];if(!nt||nt.bitmap.width===0||nt.bitmap.height===0)continue;let dt=G[Ze][We],Pt=nt.metrics.localGlyph?F:1;i.dI.copy(nt.bitmap,Me,{x:0,y:0},{x:dt.x+Pt,y:dt.y+Pt},nt.bitmap)}}this.image=Me,this.positions=G}}i.dH(W,"GlyphAtlas");class V{constructor(z){this.tileID=new i.aL(z.tileID.overscaledZ,z.tileID.wrap,z.tileID.canonical.z,z.tileID.canonical.x,z.tileID.canonical.y),this.tileZoom=z.tileZoom,this.uid=z.uid,this.zoom=z.zoom,this.lut=z.lut,this.canonical=z.tileID.canonical,this.pixelRatio=z.pixelRatio,this.tileSize=z.tileSize,this.source=z.source,this.scope=z.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=z.showCollisionBoxes,this.collectResourceTiming=!!z.collectResourceTiming,this.promoteId=z.promoteId,this.isSymbolTile=z.isSymbolTile,this.tileTransform=i.dK(z.tileID.canonical,z.projection),this.projection=z.projection,this.brightness=z.brightness,this.extraShadowCaster=!!z.extraShadowCaster,this.tessellationStep=z.tessellationStep}parse(z,G,Q,se,le){this.status="parsing",this.data=z,this.collisionBoxArray=new i.dL;let Me=new i.dM(Object.keys(z.layers).sort()),Ze=new i.dN(this.tileID,this.promoteId);Ze.bucketLayerIDs=[];let ke={},We=new i.dO(256,256),nt={featureIndex:Ze,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:We,availableImages:Q,brightness:this.brightness},dt=G.familiesBySource[this.source];for(let wi in dt){let wr=z.layers[wi];if(!wr)continue;let dr=!1,yr=!1,xn=!1;for(let On of dt[wi])On[0].type==="symbol"?dr=!0:yr=!0,On[0].is3D()&&On[0].type!=="model"&&(xn=!0);if(this.extraShadowCaster&&!xn||this.isSymbolTile===!0&&!dr||this.isSymbolTile===!1&&!yr)continue;wr.version===1&&i.w(`Vector tile source "${this.source}" layer "${wi}" does not use vector tile spec v2 and therefore may have some rendering errors.`);let en=Me.encode(wi),En=[];for(let On=0;On<wr.length;On++){let sn=wr.feature(On),Fl=Ze.getId(sn,wi);En.push({feature:sn,id:Fl,index:On,sourceLayerIndex:en})}for(let On of dt[wi]){let sn=On[0];(!this.extraShadowCaster||sn.is3D()&&sn.type!=="model")&&(this.isSymbolTile!==void 0&&sn.type==="symbol"!==this.isSymbolTile||sn.minzoom&&this.zoom<Math.floor(sn.minzoom)||sn.maxzoom&&this.zoom>=sn.maxzoom||sn.visibility!=="none"&&(R(On,this.zoom,nt.brightness,Q),(ke[sn.id]=sn.createBucket({index:Ze.bucketLayerIDs.length,layers:On,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:en,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(En,nt,this.tileID.canonical,this.tileTransform),Ze.bucketLayerIDs.push(On.map(Fl=>Fl.id))))}}let Pt,ti,Qt,oi;We.trim();let Ei={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Wi=()=>{if(Pt)return this.status="done",le(Pt);if(this.extraShadowCaster)this.status="done",le(null,{buckets:i.dG(ke).filter(wi=>!wi.isEmpty()),featureIndex:Ze,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:nt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(ti&&Qt&&oi){let wi=new W(ti),wr=new i.dQ(Qt,oi,this.lut);for(let dr in ke){let yr=ke[dr];yr instanceof i.dR?(R(yr.layers,this.zoom,nt.brightness,Q),i.dS(yr,ti,wi.positions,Qt,wr.iconPositions,this.showCollisionBoxes,Q,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):yr.hasPattern&&(yr instanceof i.dT||yr instanceof i.dU||yr instanceof i.b_)&&(R(yr.layers,this.zoom,nt.brightness,Q),yr.addFeatures(nt,this.tileID.canonical,wr.patternPositions,Q,this.tileTransform,this.brightness))}this.status="done",le(null,{buckets:i.dG(ke).filter(dr=>!dr.isEmpty()),featureIndex:Ze,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:wi.image,lineAtlas:We,imageAtlas:wr,brightness:nt.brightness})}};if(!this.extraShadowCaster){let wi=i.dP(nt.glyphDependencies,yr=>Object.keys(yr).map(Number));Object.keys(wi).length?se.send("getGlyphs",{uid:this.uid,stacks:wi,scope:this.scope},(yr,xn)=>{Pt||(Pt=yr,ti=xn,Wi())},void 0,!1,Ei):ti={};let wr=Object.keys(nt.iconDependencies);wr.length?se.send("getImages",{icons:wr,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(yr,xn)=>{Pt||(Pt=yr,Qt=xn,Wi())},void 0,!1,Ei):Qt={};let dr=Object.keys(nt.patternDependencies);dr.length?se.send("getImages",{icons:dr,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(yr,xn)=>{Pt||(Pt=yr,oi=xn,Wi())},void 0,!1,Ei):oi={}}Wi()}}function R(ee,z,G,Q){let se=new i.X(z,{brightness:G});for(let le of ee)le.recalculate(se,Q)}class te extends i.E{constructor(z,G,Q,se,le,Me){super(),this.actor=z,this.layerIndex=G,this.availableImages=Q,this.loadVectorData=le||i.ap,this.loading={},this.loaded={},this.deduped=new i.ao(z.scheduler),this.isSpriteLoaded=se,this.scheduler=z.scheduler,this.brightness=Me}loadTile(z,G){let Q=z.uid,se=z&&z.request,le=se&&se.collectResourceTiming,Me=this.loading[Q]=new V(z);Me.abort=this.loadVectorData(z,(Ze,ke)=>{let We=!this.loading[Q];if(delete this.loading[Q],We||Ze||!ke)return Me.status="done",We||(this.loaded[Q]=Me),G(Ze);let nt=ke.rawData,dt={};ke.expires&&(dt.expires=ke.expires),ke.cacheControl&&(dt.cacheControl=ke.cacheControl),Me.vectorTile=ke.vectorTile||new i.dV(new i.dW(nt));let Pt=()=>{Me.parse(Me.vectorTile,this.layerIndex,this.availableImages,this.actor,(ti,Qt)=>{if(ti||!Qt)return G(ti);let oi={};if(le){let Ei=x(se);Ei.length>0&&(oi.resourceTiming=JSON.parse(JSON.stringify(Ei)))}G(null,i.W({rawTileData:nt.slice(0)},Qt,dt,oi))})};this.isSpriteLoaded?Pt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Pt,{type:"parseTile",isSymbolTile:z.isSymbolTile,zoom:z.tileZoom}):Pt()}),this.loaded=this.loaded||{},this.loaded[Q]=Me})}reloadTile(z,G){let Q=this.loaded,se=z.uid;if(Q&&Q[se]){let le=Q[se];le.showCollisionBoxes=z.showCollisionBoxes,le.projection=z.projection,le.brightness=z.brightness,le.tileTransform=i.dK(z.tileID.canonical,z.projection),le.extraShadowCaster=z.extraShadowCaster,le.lut=z.lut;let Me=(Ze,ke)=>{let We=le.reloadCallback;We&&(delete le.reloadCallback,le.parse(le.vectorTile,this.layerIndex,this.availableImages,this.actor,We)),G(Ze,ke)};le.status==="parsing"?le.reloadCallback=Me:le.status==="done"&&(le.vectorTile?le.parse(le.vectorTile,this.layerIndex,this.availableImages,this.actor,Me):Me())}else G(null,void 0)}abortTile(z,G){let Q=z.uid,se=this.loading[Q];se&&(se.abort&&se.abort(),delete this.loading[Q]),G()}removeTile(z,G){let Q=this.loaded,se=z.uid;Q&&Q[se]&&delete Q[se],G()}}class H{loadTile(z,G){let{uid:Q,encoding:se,rawImageData:le,padding:Me}=z,Ze=ImageBitmap&&le instanceof ImageBitmap?this.getImageData(le,Me):le;G(null,new i.dX(Q,Ze,se,Me<1))}getImageData(z,G){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(z.width,z.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=z.width,this.offscreenCanvas.height=z.height,this.offscreenCanvasContext.drawImage(z,0,0,z.width,z.height);let Q=this.offscreenCanvasContext.getImageData(-G,-G,z.width+2*G,z.height+2*G);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Q}}class J{decodeRasterArray({task:z,buffer:G},Q){i.dY.performDecoding(G,z).then(se=>{Q(null,se)},se=>{Q(se)})}}let K=i.dZ.prototype.toGeoJSON,ne=class{constructor(ee){this._feature=ee,this.extent=i.a3,this.type=ee.type,this.properties=ee.tags,"id"in ee&&!isNaN(ee.id)&&(this.id=parseInt(ee.id,10))}loadGeometry(){if(this._feature.type===1){let ee=[];for(let z of this._feature.geometry)ee.push([new i.P(z[0],z[1])]);return ee}{let ee=[];for(let z of this._feature.geometry){let G=[];for(let Q of z)G.push(new i.P(Q[0],Q[1]));ee.push(G)}return ee}}toGeoJSON(ee,z,G){return K.call(this,ee,z,G)}},de=class{constructor(ee){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.a3,this.length=ee.length,this._features=ee}feature(ee){return new ne(this._features[ee])}},De=64/4096;class Fe{constructor(){this.features=new Map}clear(){this.features.clear()}load(z=[],G){for(let Q of z){let se=Q.id;if(se==null)continue;let le=this.features.get(se);le&&this.updateCache(le,G),Q.geometry?(le=Te(Q),this.updateCache(le,G),this.features.set(se,le)):this.features.delete(se),this.updateCache(le,G)}}updateCache(z,G){for(let{canonical:Q,uid:se}of Object.values(G)){let{z:le,x:Me,y:Ze}=Q;et(z,Math.pow(2,le),Me,Ze)&&delete G[se]}}getTile(z,G,Q){let se=Math.pow(2,z),le=[];for(let Me of this.features.values())et(Me,se,G,Q)&&le.push(_e(Me,se,G,Q));return{features:le}}getFeatures(){return[...this.features.values()]}}function et({minX:ee,minY:z,maxX:G,maxY:Q},se,le,Me){return ee<(le+1+De)/se&&z<(Me+1+De)/se&&G>(le-De)/se&&Q>(Me-De)/se}function Te(ee){let{id:z,geometry:G,properties:Q}=ee;if(!G)return;if(G.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");let{type:se,coordinates:le}=G,Me={id:z,type:1,geometry:[],tags:Q,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},Ze=Me.geometry;if(se==="Point")ge(le,Ze,Me);else if(se==="MultiPoint")for(let ke of le)ge(ke,Ze,Me);else if(se==="LineString")Me.type=2,Ve(le,Ze,Me);else if(se==="MultiLineString")Me.type=2,Ae(le,Ze,Me);else if(se==="Polygon")Me.type=3,Ae(le,Ze,Me,!0);else{if(se!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");Me.type=3;for(let ke of le)Ae(ke,Ze,Me,!0)}return Me}function ge([ee,z],G,Q){let se=i.aj(ee),le=i.ak(z);le=le<0?0:le>1?1:le,G.push(se,le),Q.minX=Math.min(Q.minX,se),Q.minY=Math.min(Q.minY,le),Q.maxX=Math.max(Q.maxX,se),Q.maxY=Math.max(Q.maxY,le)}function Ve(ee,z,G,Q=!1,se=!1){let le=[];for(let Me of ee)ge(Me,le,G);z.push(le),Q&&function(Me,Ze){let ke=0;for(let We=0,nt=Me.length,dt=nt-2;We<nt;dt=We,We+=2)ke+=(Me[We]-Me[dt])*(Me[We+1]+Me[dt+1]);if(ke>0===Ze)for(let We=0,nt=Me.length;We<nt/2;We+=2){let dt=Me[We],Pt=Me[We+1];Me[We]=Me[nt-2-We],Me[We+1]=Me[nt-1-We],Me[nt-2-We]=dt,Me[nt-1-We]=Pt}}(le,se)}function Ae(ee,z,G,Q=!1){for(let se=0;se<ee.length;se++)Ve(ee[se],z,G,Q,se===0)}function _e(ee,z,G,Q){let{id:se,type:le,geometry:Me,tags:Ze}=ee,ke=[];if(le===1)xe(Me,z,G,Q,ke);else for(let We of Me)ke.push(xe(We,z,G,Q));return{id:se,type:le,geometry:ke,tags:Ze}}function xe(ee,z,G,Q,se=[]){for(let le=0;le<ee.length;le+=2)se.push(Qe(ee[le],ee[le+1],z,G,Q));return se}function Qe(ee,z,G,Q,se){return[Math.round(i.a3*(ee*G-Q)),Math.round(i.a3*(z*G-se))]}var Ce={exports:{}},Ye=i.d$,ut=i.d_.VectorTileFeature,st=pt;function pt(ee,z){this.options=z||{},this.features=ee,this.length=ee.length}function Tt(ee,z){this.id=typeof ee.id=="number"?ee.id:void 0,this.type=ee.type,this.rawGeometry=ee.type===1?[ee.geometry]:ee.geometry,this.properties=ee.tags,this.extent=z||4096}pt.prototype.feature=function(ee){return new Tt(this.features[ee],this.options.extent)},Tt.prototype.loadGeometry=function(){var ee=this.rawGeometry;this.geometry=[];for(var z=0;z<ee.length;z++){for(var G=ee[z],Q=[],se=0;se<G.length;se++)Q.push(new Ye(G[se][0],G[se][1]));this.geometry.push(Q)}return this.geometry},Tt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ee=this.geometry,z=1/0,G=-1/0,Q=1/0,se=-1/0,le=0;le<ee.length;le++)for(var Me=ee[le],Ze=0;Ze<Me.length;Ze++){var ke=Me[Ze];z=Math.min(z,ke.x),G=Math.max(G,ke.x),Q=Math.min(Q,ke.y),se=Math.max(se,ke.y)}return[z,Q,G,se]},Tt.prototype.toGeoJSON=ut.prototype.toGeoJSON;var ht=i.e0,Wt=st;function ie(ee){var z=new ht;return function(G,Q){for(var se in G.layers)Q.writeMessage(3,ye,G.layers[se])}(ee,z),z.finish()}function ye(ee,z){var G;z.writeVarintField(15,ee.version||1),z.writeStringField(1,ee.name||""),z.writeVarintField(5,ee.extent||4096);var Q={keys:[],values:[],keycache:{},valuecache:{}};for(G=0;G<ee.length;G++)Q.feature=ee.feature(G),z.writeMessage(2,pe,Q);var se=Q.keys;for(G=0;G<se.length;G++)z.writeStringField(3,se[G]);var le=Q.values;for(G=0;G<le.length;G++)z.writeMessage(4,wt,le[G])}function pe(ee,z){var G=ee.feature;G.id!==void 0&&z.writeVarintField(1,G.id),z.writeMessage(2,Ie,ee),z.writeVarintField(3,G.type),z.writeMessage(4,mt,G)}function Ie(ee,z){var G=ee.feature,Q=ee.keys,se=ee.values,le=ee.keycache,Me=ee.valuecache;for(var Ze in G.properties){var ke=G.properties[Ze],We=le[Ze];if(ke!==null){We===void 0&&(Q.push(Ze),le[Ze]=We=Q.length-1),z.writeVarint(We);var nt=typeof ke;nt!=="string"&&nt!=="boolean"&&nt!=="number"&&(ke=JSON.stringify(ke));var dt=nt+":"+ke,Pt=Me[dt];Pt===void 0&&(se.push(ke),Me[dt]=Pt=se.length-1),z.writeVarint(Pt)}}}function Ue(ee,z){return(z<<3)+(7&ee)}function gt(ee){return ee<<1^ee>>31}function mt(ee,z){for(var G=ee.loadGeometry(),Q=ee.type,se=0,le=0,Me=G.length,Ze=0;Ze<Me;Ze++){var ke=G[Ze],We=1;Q===1&&(We=ke.length),z.writeVarint(Ue(1,We));for(var nt=Q===3?ke.length-1:ke.length,dt=0;dt<nt;dt++){dt===1&&Q!==1&&z.writeVarint(Ue(2,nt-1));var Pt=ke[dt].x-se,ti=ke[dt].y-le;z.writeVarint(gt(Pt)),z.writeVarint(gt(ti)),se+=Pt,le+=ti}Q===3&&z.writeVarint(Ue(7,1))}}function wt(ee,z){var G=typeof ee;G==="string"?z.writeStringField(1,ee):G==="boolean"?z.writeBooleanField(7,ee):G==="number"&&(ee%1!=0?z.writeDoubleField(3,ee):ee<0?z.writeSVarintField(6,ee):z.writeVarintField(5,ee))}Ce.exports=ie,Ce.exports.fromVectorTileJs=ie,Ce.exports.fromGeojsonVt=function(ee,z){z=z||{};var G={};for(var Q in ee)G[Q]=new Wt(ee[Q].features,z),G[Q].name=Q,G[Q].version=z.version,G[Q].extent=z.extent;return ie({layers:G})},Ce.exports.GeoJSONWrapper=Wt;var Lt=i.e1(Ce.exports);let fi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ee=>ee},yi=Math.fround||(Fi=new Float32Array(1),ee=>(Fi[0]=+ee,Fi[0]));var Fi;let Pi=3,$t=5,lt=6;class Bt{constructor(z){this.options=Object.assign(Object.create(fi),z),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(z){let{log:G,minZoom:Q,maxZoom:se}=this.options;G&&console.time("total time");let le=`prepare ${z.length} points`;G&&console.time(le),this.points=z;let Me=[];for(let ke=0;ke<z.length;ke++){let We=z[ke];if(!We.geometry)continue;let[nt,dt]=We.geometry.coordinates,Pt=yi(ki(nt)),ti=yi(Ni(dt));Me.push(Pt,ti,1/0,ke,-1,1),this.options.reduce&&Me.push(0)}let Ze=this.trees[se+1]=this._createTree(Me);G&&console.timeEnd(le);for(let ke=se;ke>=Q;ke--){let We=+Date.now();Ze=this.trees[ke]=this._createTree(this._cluster(Ze,ke)),G&&console.log("z%d: %d clusters in %dms",ke,Ze.numItems,+Date.now()-We)}return G&&console.timeEnd("total time"),this}getClusters(z,G){let Q=((z[0]+180)%360+360)%360-180,se=Math.max(-90,Math.min(90,z[1])),le=z[2]===180?180:((z[2]+180)%360+360)%360-180,Me=Math.max(-90,Math.min(90,z[3]));if(z[2]-z[0]>=360)Q=-180,le=180;else if(Q>le){let dt=this.getClusters([Q,se,180,Me],G),Pt=this.getClusters([-180,se,le,Me],G);return dt.concat(Pt)}let Ze=this.trees[this._limitZoom(G)],ke=Ze.range(ki(Q),Ni(Me),ki(le),Ni(se)),We=Ze.data,nt=[];for(let dt of ke){let Pt=this.stride*dt;nt.push(We[Pt+$t]>1?ni(We,Pt,this.clusterProps):this.points[We[Pt+Pi]])}return nt}getChildren(z){let G=this._getOriginId(z),Q=this._getOriginZoom(z),se="No cluster with the specified id.",le=this.trees[Q];if(!le)throw new Error(se);let Me=le.data;if(G*this.stride>=Me.length)throw new Error(se);let Ze=this.options.radius/(this.options.extent*Math.pow(2,Q-1)),ke=le.within(Me[G*this.stride],Me[G*this.stride+1],Ze),We=[];for(let nt of ke){let dt=nt*this.stride;Me[dt+4]===z&&We.push(Me[dt+$t]>1?ni(Me,dt,this.clusterProps):this.points[Me[dt+Pi]])}if(We.length===0)throw new Error(se);return We}getLeaves(z,G,Q){let se=[];return this._appendLeaves(se,z,G=G||10,Q=Q||0,0),se}getTile(z,G,Q){let se=this.trees[this._limitZoom(z)],le=Math.pow(2,z),{extent:Me,radius:Ze}=this.options,ke=Ze/Me,We=(Q-ke)/le,nt=(Q+1+ke)/le,dt={features:[]};return this._addTileFeatures(se.range((G-ke)/le,We,(G+1+ke)/le,nt),se.data,G,Q,le,dt),G===0&&this._addTileFeatures(se.range(1-ke/le,We,1,nt),se.data,le,Q,le,dt),G===le-1&&this._addTileFeatures(se.range(0,We,ke/le,nt),se.data,-1,Q,le,dt),dt.features.length?dt:null}getClusterExpansionZoom(z){let G=this._getOriginZoom(z)-1;for(;G<=this.options.maxZoom;){let Q=this.getChildren(z);if(G++,Q.length!==1)break;z=Q[0].properties.cluster_id}return G}_appendLeaves(z,G,Q,se,le){let Me=this.getChildren(G);for(let Ze of Me){let ke=Ze.properties;if(ke&&ke.cluster?le+ke.point_count<=se?le+=ke.point_count:le=this._appendLeaves(z,ke.cluster_id,Q,se,le):le<se?le++:z.push(Ze),z.length===Q)break}return le}_createTree(z){let G=new i.cK(z.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Q=0;Q<z.length;Q+=this.stride)G.add(z[Q],z[Q+1]);return G.finish(),G.data=z,G}_addTileFeatures(z,G,Q,se,le,Me){for(let Ze of z){let ke=Ze*this.stride,We=G[ke+$t]>1,nt,dt,Pt;if(We)nt=bi(G,ke,this.clusterProps),dt=G[ke],Pt=G[ke+1];else{let oi=this.points[G[ke+Pi]];nt=oi.properties;let[Ei,Wi]=oi.geometry.coordinates;dt=ki(Ei),Pt=Ni(Wi)}let ti={type:1,geometry:[[Math.round(this.options.extent*(dt*le-Q)),Math.round(this.options.extent*(Pt*le-se))]],tags:nt},Qt;Qt=We||this.options.generateId?G[ke+Pi]:this.points[G[ke+Pi]].id,Qt!==void 0&&(ti.id=Qt),Me.features.push(ti)}}_limitZoom(z){return Math.max(this.options.minZoom,Math.min(Math.floor(+z),this.options.maxZoom+1))}_cluster(z,G){let{radius:Q,extent:se,reduce:le,minPoints:Me}=this.options,Ze=Q/(se*Math.pow(2,G)),ke=z.data,We=[],nt=this.stride;for(let dt=0;dt<ke.length;dt+=nt){if(ke[dt+2]<=G)continue;ke[dt+2]=G;let Pt=ke[dt],ti=ke[dt+1],Qt=z.within(ke[dt],ke[dt+1],Ze),oi=ke[dt+$t],Ei=oi;for(let Wi of Qt){let wi=Wi*nt;ke[wi+2]>G&&(Ei+=ke[wi+$t])}if(Ei>oi&&Ei>=Me){let Wi,wi=Pt*oi,wr=ti*oi,dr=-1,yr=(dt/nt<<5)+(G+1)+this.points.length;for(let xn of Qt){let en=xn*nt;if(ke[en+2]<=G)continue;ke[en+2]=G;let En=ke[en+$t];wi+=ke[en]*En,wr+=ke[en+1]*En,ke[en+4]=yr,le&&(Wi||(Wi=this._map(ke,dt,!0),dr=this.clusterProps.length,this.clusterProps.push(Wi)),le(Wi,this._map(ke,en)))}ke[dt+4]=yr,We.push(wi/Ei,wr/Ei,1/0,yr,-1,Ei),le&&We.push(dr)}else{for(let Wi=0;Wi<nt;Wi++)We.push(ke[dt+Wi]);if(Ei>1)for(let Wi of Qt){let wi=Wi*nt;if(!(ke[wi+2]<=G)){ke[wi+2]=G;for(let wr=0;wr<nt;wr++)We.push(ke[wi+wr])}}}}return We}_getOriginId(z){return z-this.points.length>>5}_getOriginZoom(z){return(z-this.points.length)%32}_map(z,G,Q){if(z[G+$t]>1){let Me=this.clusterProps[z[G+lt]];return Q?Object.assign({},Me):Me}let se=this.points[z[G+Pi]].properties,le=this.options.map(se);return Q&&le===se?Object.assign({},le):le}}function ni(ee,z,G){return{type:"Feature",id:ee[z+Pi],properties:bi(ee,z,G),geometry:{type:"Point",coordinates:[(Q=ee[z],360*(Q-.5)),Bi(ee[z+1])]}};var Q}function bi(ee,z,G){let Q=ee[z+$t],se=Q>=1e4?`${Math.round(Q/1e3)}k`:Q>=1e3?Math.round(Q/100)/10+"k":Q,le=ee[z+lt],Me=le===-1?{}:Object.assign({},G[le]);return Object.assign(Me,{cluster:!0,cluster_id:ee[z+Pi],point_count:Q,point_count_abbreviated:se})}function ki(ee){return ee/360+.5}function Ni(ee){let z=Math.sin(ee*Math.PI/180),G=.5-.25*Math.log((1+z)/(1-z))/Math.PI;return G<0?0:G>1?1:G}function Bi(ee){let z=(180-360*ee)*Math.PI/180;return 360*Math.atan(Math.exp(z))/Math.PI-90}function tr(ee,z,G,Q){let se=Q,le=z+(G-z>>1),Me,Ze=G-z,ke=ee[z],We=ee[z+1],nt=ee[G],dt=ee[G+1];for(let Pt=z+3;Pt<G;Pt+=3){let ti=ar(ee[Pt],ee[Pt+1],ke,We,nt,dt);if(ti>se)Me=Pt,se=ti;else if(ti===se){let Qt=Math.abs(Pt-le);Qt<Ze&&(Me=Pt,Ze=Qt)}}se>Q&&(Me-z>3&&tr(ee,z,Me,Q),ee[Me+2]=se,G-Me>3&&tr(ee,Me,G,Q))}function ar(ee,z,G,Q,se,le){let Me=se-G,Ze=le-Q;if(Me!==0||Ze!==0){let ke=((ee-G)*Me+(z-Q)*Ze)/(Me*Me+Ze*Ze);ke>1?(G=se,Q=le):ke>0&&(G+=Me*ke,Q+=Ze*ke)}return Me=ee-G,Ze=z-Q,Me*Me+Ze*Ze}function vr(ee,z,G,Q){let se={id:ee??null,type:z,geometry:G,tags:Q,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(z==="Point"||z==="MultiPoint"||z==="LineString")kr(se,G);else if(z==="Polygon")kr(se,G[0]);else if(z==="MultiLineString")for(let le of G)kr(se,le);else if(z==="MultiPolygon")for(let le of G)kr(se,le[0]);return se}function kr(ee,z){for(let G=0;G<z.length;G+=3)ee.minX=Math.min(ee.minX,z[G]),ee.minY=Math.min(ee.minY,z[G+1]),ee.maxX=Math.max(ee.maxX,z[G]),ee.maxY=Math.max(ee.maxY,z[G+1])}function qr(ee,z,G,Q){if(!z.geometry)return;let se=z.geometry.coordinates;if(se&&se.length===0)return;let le=z.geometry.type,Me=Math.pow(G.tolerance/((1<<G.maxZoom)*G.extent),2),Ze=[],ke=z.id;if(G.promoteId?ke=z.properties[G.promoteId]:G.generateId&&(ke=Q||0),le==="Point")Kr(se,Ze);else if(le==="MultiPoint")for(let We of se)Kr(We,Ze);else if(le==="LineString")xr(se,Ze,Me,!1);else if(le==="MultiLineString"){if(G.lineMetrics){for(let We of se)Ze=[],xr(We,Ze,Me,!1),ee.push(vr(ke,"LineString",Ze,z.properties));return}Or(se,Ze,Me,!1)}else if(le==="Polygon")Or(se,Ze,Me,!0);else{if(le!=="MultiPolygon"){if(le==="GeometryCollection"){for(let We of z.geometry.geometries)qr(ee,{id:ke,geometry:We,properties:z.properties},G,Q);return}throw new Error("Input data is not a valid GeoJSON object.")}for(let We of se){let nt=[];Or(We,nt,Me,!0),Ze.push(nt)}}ee.push(vr(ke,le,Ze,z.properties))}function Kr(ee,z){z.push(Ri(ee[0]),La(ee[1]),0)}function xr(ee,z,G,Q){let se,le,Me=0;for(let ke=0;ke<ee.length;ke++){let We=Ri(ee[ke][0]),nt=La(ee[ke][1]);z.push(We,nt,0),ke>0&&(Me+=Q?(se*nt-We*le)/2:Math.sqrt(Math.pow(We-se,2)+Math.pow(nt-le,2))),se=We,le=nt}let Ze=z.length-3;z[2]=1,tr(z,0,Ze,G),z[Ze+2]=1,z.size=Math.abs(Me),z.start=0,z.end=z.size}function Or(ee,z,G,Q){for(let se=0;se<ee.length;se++){let le=[];xr(ee[se],le,G,Q),z.push(le)}}function Ri(ee){return ee/360+.5}function La(ee){let z=Math.sin(ee*Math.PI/180),G=.5-.25*Math.log((1+z)/(1-z))/Math.PI;return G<0?0:G>1?1:G}function Di(ee,z,G,Q,se,le,Me,Ze){if(Q/=z,le>=(G/=z)&&Me<Q)return ee;if(Me<G||le>=Q)return null;let ke=[];for(let We of ee){let nt=We.geometry,dt=We.type,Pt=se===0?We.minX:We.minY,ti=se===0?We.maxX:We.maxY;if(Pt>=G&&ti<Q){ke.push(We);continue}if(ti<G||Pt>=Q)continue;let Qt=[];if(dt==="Point"||dt==="MultiPoint")go(nt,Qt,G,Q,se);else if(dt==="LineString")fr(nt,Qt,G,Q,se,!1,Ze.lineMetrics);else if(dt==="MultiLineString")_o(nt,Qt,G,Q,se,!1);else if(dt==="Polygon")_o(nt,Qt,G,Q,se,!0);else if(dt==="MultiPolygon")for(let oi of nt){let Ei=[];_o(oi,Ei,G,Q,se,!0),Ei.length&&Qt.push(Ei)}if(Qt.length){if(Ze.lineMetrics&&dt==="LineString"){for(let oi of Qt)ke.push(vr(We.id,dt,oi,We.tags));continue}dt!=="LineString"&&dt!=="MultiLineString"||(Qt.length===1?(dt="LineString",Qt=Qt[0]):dt="MultiLineString"),dt!=="Point"&&dt!=="MultiPoint"||(dt=Qt.length===3?"Point":"MultiPoint"),ke.push(vr(We.id,dt,Qt,We.tags))}}return ke.length?ke:null}function go(ee,z,G,Q,se){for(let le=0;le<ee.length;le+=3){let Me=ee[le+se];Me>=G&&Me<=Q&&$r(z,ee[le],ee[le+1],ee[le+2])}}function fr(ee,z,G,Q,se,le,Me){let Ze=Sn(ee),ke=se===0?so:Rn,We,nt,dt=ee.start;for(let Ei=0;Ei<ee.length-3;Ei+=3){let Wi=ee[Ei],wi=ee[Ei+1],wr=ee[Ei+2],dr=ee[Ei+3],yr=ee[Ei+4],xn=se===0?Wi:wi,en=se===0?dr:yr,En=!1;Me&&(We=Math.sqrt(Math.pow(Wi-dr,2)+Math.pow(wi-yr,2))),xn<G?en>G&&(nt=ke(Ze,Wi,wi,dr,yr,G),Me&&(Ze.start=dt+We*nt)):xn>Q?en<Q&&(nt=ke(Ze,Wi,wi,dr,yr,Q),Me&&(Ze.start=dt+We*nt)):$r(Ze,Wi,wi,wr),en<G&&xn>=G&&(nt=ke(Ze,Wi,wi,dr,yr,G),En=!0),en>Q&&xn<=Q&&(nt=ke(Ze,Wi,wi,dr,yr,Q),En=!0),!le&&En&&(Me&&(Ze.end=dt+We*nt),z.push(Ze),Ze=Sn(ee)),Me&&(dt+=We)}let Pt=ee.length-3,ti=ee[Pt],Qt=ee[Pt+1],oi=se===0?ti:Qt;oi>=G&&oi<=Q&&$r(Ze,ti,Qt,ee[Pt+2]),Pt=Ze.length-3,le&&Pt>=3&&(Ze[Pt]!==Ze[0]||Ze[Pt+1]!==Ze[1])&&$r(Ze,Ze[0],Ze[1],Ze[2]),Ze.length&&z.push(Ze)}function Sn(ee){let z=[];return z.size=ee.size,z.start=ee.start,z.end=ee.end,z}function _o(ee,z,G,Q,se,le){for(let Me of ee)fr(Me,z,G,Q,se,le,!1)}function $r(ee,z,G,Q){ee.push(z,G,Q)}function so(ee,z,G,Q,se,le){let Me=(le-z)/(Q-z);return $r(ee,le,G+(se-G)*Me,1),Me}function Rn(ee,z,G,Q,se,le){let Me=(le-G)/(se-G);return $r(ee,z+(Q-z)*Me,le,1),Me}function Ja(ee,z){let G=[];for(let Q=0;Q<ee.length;Q++){let se=ee[Q],le=se.type,Me;if(le==="Point"||le==="MultiPoint"||le==="LineString")Me=xo(se.geometry,z);else if(le==="MultiLineString"||le==="Polygon"){Me=[];for(let Ze of se.geometry)Me.push(xo(Ze,z))}else if(le==="MultiPolygon"){Me=[];for(let Ze of se.geometry){let ke=[];for(let We of Ze)ke.push(xo(We,z));Me.push(ke)}}G.push(vr(se.id,le,Me,se.tags))}return G}function xo(ee,z){let G=[];G.size=ee.size,ee.start!==void 0&&(G.start=ee.start,G.end=ee.end);for(let Q=0;Q<ee.length;Q+=3)G.push(ee[Q]+z,ee[Q+1],ee[Q+2]);return G}function vn(ee,z){if(ee.transformed)return ee;let G=1<<ee.z,Q=ee.x,se=ee.y;for(let le of ee.features){let Me=le.geometry,Ze=le.type;if(le.geometry=[],Ze===1)for(let ke=0;ke<Me.length;ke+=2)le.geometry.push(Ar(Me[ke],Me[ke+1],z,G,Q,se));else for(let ke=0;ke<Me.length;ke++){let We=[];for(let nt=0;nt<Me[ke].length;nt+=2)We.push(Ar(Me[ke][nt],Me[ke][nt+1],z,G,Q,se));le.geometry.push(We)}}return ee.transformed=!0,ee}function Ar(ee,z,G,Q,se,le){return[Math.round(G*(ee*Q-se)),Math.round(G*(z*Q-le))]}function dn(ee,z,G,Q,se){let le=z===se.maxZoom?0:se.tolerance/((1<<z)*se.extent),Me={features:[],numPoints:0,numSimplified:0,numFeatures:ee.length,source:null,x:G,y:Q,z,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(let Ze of ee)as(Me,Ze,le,se);return Me}function as(ee,z,G,Q){let se=z.geometry,le=z.type,Me=[];if(ee.minX=Math.min(ee.minX,z.minX),ee.minY=Math.min(ee.minY,z.minY),ee.maxX=Math.max(ee.maxX,z.maxX),ee.maxY=Math.max(ee.maxY,z.maxY),le==="Point"||le==="MultiPoint")for(let Ze=0;Ze<se.length;Ze+=3)Me.push(se[Ze],se[Ze+1]),ee.numPoints++,ee.numSimplified++;else if(le==="LineString")kn(Me,se,ee,G,!1,!1);else if(le==="MultiLineString"||le==="Polygon")for(let Ze=0;Ze<se.length;Ze++)kn(Me,se[Ze],ee,G,le==="Polygon",Ze===0);else if(le==="MultiPolygon")for(let Ze=0;Ze<se.length;Ze++){let ke=se[Ze];for(let We=0;We<ke.length;We++)kn(Me,ke[We],ee,G,!0,We===0)}if(Me.length){let Ze=z.tags||null;if(le==="LineString"&&Q.lineMetrics){Ze={};for(let We in z.tags)Ze[We]=z.tags[We];Ze.mapbox_clip_start=se.start/se.size,Ze.mapbox_clip_end=se.end/se.size}let ke={geometry:Me,type:le==="Polygon"||le==="MultiPolygon"?3:le==="LineString"||le==="MultiLineString"?2:1,tags:Ze};z.id!==null&&(ke.id=z.id),ee.features.push(ke)}}function kn(ee,z,G,Q,se,le){let Me=Q*Q;if(Q>0&&z.size<(se?Me:Q))return void(G.numPoints+=z.length/3);let Ze=[];for(let ke=0;ke<z.length;ke+=3)(Q===0||z[ke+2]>Me)&&(G.numSimplified++,Ze.push(z[ke],z[ke+1])),G.numPoints++;se&&function(ke,We){let nt=0;for(let dt=0,Pt=ke.length,ti=Pt-2;dt<Pt;ti=dt,dt+=2)nt+=(ke[dt]-ke[ti])*(ke[dt+1]+ke[ti+1]);if(nt>0===We)for(let dt=0,Pt=ke.length;dt<Pt/2;dt+=2){let ti=ke[dt],Qt=ke[dt+1];ke[dt]=ke[Pt-2-dt],ke[dt+1]=ke[Pt-1-dt],ke[Pt-2-dt]=ti,ke[Pt-1-dt]=Qt}}(Ze,le),ee.push(Ze)}let lo={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class ka{constructor(z,G){let Q=(G=this.options=function(le,Me){for(let Ze in Me)le[Ze]=Me[Ze];return le}(Object.create(lo),G)).debug;if(Q&&console.time("preprocess data"),G.maxZoom<0||G.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(G.promoteId&&G.generateId)throw new Error("promoteId and generateId cannot be used together.");let se=function(le,Me){let Ze=[];if(le.type==="FeatureCollection")for(let ke=0;ke<le.features.length;ke++)qr(Ze,le.features[ke],Me,ke);else qr(Ze,le.type==="Feature"?le:{geometry:le},Me);return Ze}(z,G);this.tiles={},this.tileCoords=[],Q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",G.indexMaxZoom,G.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),se=function(le,Me){let Ze=Me.buffer/Me.extent,ke=le,We=Di(le,1,-1-Ze,Ze,0,-1,2,Me),nt=Di(le,1,1-Ze,2+Ze,0,-1,2,Me);return(We||nt)&&(ke=Di(le,1,-Ze,1+Ze,0,-1,2,Me)||[],We&&(ke=Ja(We,1).concat(ke)),nt&&(ke=ke.concat(Ja(nt,-1)))),ke}(se,G),se.length&&this.splitTile(se,0,0,0),Q&&(se.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(z,G,Q,se,le,Me,Ze){let ke=[z,G,Q,se],We=this.options,nt=We.debug;for(;ke.length;){se=ke.pop(),Q=ke.pop(),G=ke.pop(),z=ke.pop();let dt=1<<G,Pt=Ki(G,Q,se),ti=this.tiles[Pt];if(!ti&&(nt>1&&console.time("creation"),ti=this.tiles[Pt]=dn(z,G,Q,se,We),this.tileCoords.push({z:G,x:Q,y:se}),nt)){nt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",G,Q,se,ti.numFeatures,ti.numPoints,ti.numSimplified),console.timeEnd("creation"));let En=`z${G}`;this.stats[En]=(this.stats[En]||0)+1,this.total++}if(ti.source=z,le==null){if(G===We.indexMaxZoom||ti.numPoints<=We.indexMaxPoints)continue}else{if(G===We.maxZoom||G===le)continue;if(le!=null){let En=le-G;if(Q!==Me>>En||se!==Ze>>En)continue}}if(ti.source=null,z.length===0)continue;nt>1&&console.time("clipping");let Qt=.5*We.buffer/We.extent,oi=.5-Qt,Ei=.5+Qt,Wi=1+Qt,wi=null,wr=null,dr=null,yr=null,xn=Di(z,dt,Q-Qt,Q+Ei,0,ti.minX,ti.maxX,We),en=Di(z,dt,Q+oi,Q+Wi,0,ti.minX,ti.maxX,We);z=null,xn&&(wi=Di(xn,dt,se-Qt,se+Ei,1,ti.minY,ti.maxY,We),wr=Di(xn,dt,se+oi,se+Wi,1,ti.minY,ti.maxY,We),xn=null),en&&(dr=Di(en,dt,se-Qt,se+Ei,1,ti.minY,ti.maxY,We),yr=Di(en,dt,se+oi,se+Wi,1,ti.minY,ti.maxY,We),en=null),nt>1&&console.timeEnd("clipping"),ke.push(wi||[],G+1,2*Q,2*se),ke.push(wr||[],G+1,2*Q,2*se+1),ke.push(dr||[],G+1,2*Q+1,2*se),ke.push(yr||[],G+1,2*Q+1,2*se+1)}}getTile(z,G,Q){z=+z,G=+G,Q=+Q;let se=this.options,{extent:le,debug:Me}=se;if(z<0||z>24)return null;let Ze=1<<z,ke=Ki(z,G=G+Ze&Ze-1,Q);if(this.tiles[ke])return vn(this.tiles[ke],le);Me>1&&console.log("drilling down to z%d-%d-%d",z,G,Q);let We,nt=z,dt=G,Pt=Q;for(;!We&&nt>0;)nt--,dt>>=1,Pt>>=1,We=this.tiles[Ki(nt,dt,Pt)];return We&&We.source?(Me>1&&(console.log("found parent tile z%d-%d-%d",nt,dt,Pt),console.time("drilling down")),this.splitTile(We.source,nt,dt,Pt,z,G,Q),Me>1&&console.timeEnd("drilling down"),this.tiles[ke]?vn(this.tiles[ke],le):null):null}}function Ki(ee,z,G){return 32*((1<<ee)*G+z)+ee}function Ro(ee,z){let G=ee.tileID.canonical;if(!this._geoJSONIndex)return z(null,null);let Q=this._geoJSONIndex.getTile(G.z,G.x,G.y);if(!Q)return z(null,null);let se=new de(Q.features),le=Lt(se);le.byteOffset===0&&le.byteLength===le.buffer.byteLength||(le=new Uint8Array(le)),z(null,{vectorTile:se,rawData:le.buffer})}class Qa extends te{constructor(z,G,Q,se,le,Me){super(z,G,Q,se,Ro,Me),le&&(this.loadGeoJSON=le),this._dynamicIndex=new Fe}loadData(z,G){let Q=z&&z.request,se=Q&&Q.collectResourceTiming;this.loadGeoJSON(z,(le,Me)=>{if(le||!Me)return G(le);if(typeof Me!="object")return G(new Error(`Input data given to '${z.source}' is not a valid GeoJSON object.`));{try{if(z.filter){let ke=i.y(z.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ke.result==="error")throw new Error(ke.value.map(We=>`${We.key}: ${We.message}`).join(", "));Me.features=Me.features.filter(We=>ke.value.evaluate({zoom:0},We))}z.dynamic?(Me.type==="Feature"&&(Me={type:"FeatureCollection",features:[Me]}),z.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(Me.features,this.loaded),z.cluster&&(Me.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=z.cluster?new Bt(function({superclusterOptions:ke,clusterProperties:We}){if(!We||!ke)return ke;let nt={},dt={},Pt={accumulated:null,zoom:0},ti={properties:null},Qt=Object.keys(We);for(let oi of Qt){let[Ei,Wi]=We[oi],wi=i.y(Wi),wr=i.y(typeof Ei=="string"?[Ei,["accumulated"],["get",oi]]:Ei);nt[oi]=wi.value,dt[oi]=wr.value}return ke.map=oi=>{ti.properties=oi;let Ei={};for(let Wi of Qt)Ei[Wi]=nt[Wi].evaluate(Pt,ti);return Ei},ke.reduce=(oi,Ei)=>{ti.properties=Ei;for(let Wi of Qt)Pt.accumulated=oi[Wi],oi[Wi]=dt[Wi].evaluate(Pt,ti)},ke}(z)).load(Me.features):z.dynamic?this._dynamicIndex:function(ke,We){return new ka(ke,We)}(Me,z.geojsonVtOptions)}catch(ke){return G(ke)}let Ze={};if(se){let ke=x(Q);ke&&(Ze.resourceTiming={},Ze.resourceTiming[z.source]=JSON.parse(JSON.stringify(ke)))}G(null,Ze)}})}reloadTile(z,G){let Q=this.loaded;return Q&&Q[z.uid]?z.partial?G(null,void 0):super.reloadTile(z,G):this.loadTile(z,G)}loadGeoJSON(z,G){if(z.request)i.g(z.request,G);else{if(typeof z.data!="string")return G(new Error(`Input data given to '${z.source}' is not a valid GeoJSON object.`));try{return G(null,JSON.parse(z.data))}catch{return G(new Error(`Input data given to '${z.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(z,G){try{G(null,this._geoJSONIndex.getClusterExpansionZoom(z.clusterId))}catch(Q){G(Q)}}getClusterChildren(z,G){try{G(null,this._geoJSONIndex.getChildren(z.clusterId))}catch(Q){G(Q)}}getClusterLeaves(z,G){try{G(null,this._geoJSONIndex.getLeaves(z.clusterId,z.limit,z.offset))}catch(Q){G(Q)}}}class Va{constructor(z,G){this.tileID=new i.aL(z.tileID.overscaledZ,z.tileID.wrap,z.tileID.canonical.z,z.tileID.canonical.x,z.tileID.canonical.y),this.tileZoom=z.tileZoom,this.uid=z.uid,this.zoom=z.zoom,this.canonical=z.tileID.canonical,this.pixelRatio=z.pixelRatio,this.tileSize=z.tileSize,this.source=z.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=z.projection,this.brightness=G}parse(z,G,Q,se){this.status="parsing";let le=new i.aL(Q.tileID.overscaledZ,Q.tileID.wrap,Q.tileID.canonical.z,Q.tileID.canonical.x,Q.tileID.canonical.y),Me={},Ze=G.familiesBySource[Q.source],ke=new i.dN(le,Q.promoteId);return ke.bucketLayerIDs=[],ke.is3DTile=!0,i.e3(z).then(We=>{if(!We)return se(new Error("Could not parse tile"));let nt=i.e4(We,1/i.b5(Q.tileID.canonical)),dt=We.json.extensionsUsed&&We.json.extensionsUsed.includes("MAPBOX_mesh_features")||We.json.asset.extras&&We.json.asset.extras.MAPBOX_mesh_features,Pt=We.json.extensionsUsed&&We.json.extensionsUsed.includes("EXT_meshopt_compression"),ti=new i.X(this.zoom,{brightness:this.brightness});for(let Qt in Ze)for(let oi of Ze[Qt]){let Ei=oi[0];ke.bucketLayerIDs.push(oi.map(wi=>wi.id)),Ei.recalculate(ti,[]);let Wi=new i.e5(nt,le,dt,Pt,this.brightness,ke);dt||(Wi.needsUpload=!0),Me[Ei.fqid]=Wi,Wi.evaluate(Ei)}this.status="done",se(null,{buckets:Me,featureIndex:ke})}).catch(We=>se(new Error(We.message)))}}class ca{constructor(z,G,Q,se,le,Me){this.actor=z,this.layerIndex=G,this.brightness=Me,this.loading={},this.loaded={}}loadTile(z,G){let Q=z.uid,se=this.loading[Q]=new Va(z,this.brightness);i.e2(z.request,(le,Me)=>{let Ze=!this.loading[Q];return delete this.loading[Q],Ze||le?(se.status="done",Ze||(this.loaded[Q]=se),G(le)):Me&&Me.byteLength!==0?void se.parse(Me,this.layerIndex,z,(ke,We)=>{se.status="done",this.loaded=this.loaded||{},this.loaded[Q]=se,ke||!We?G(ke):G(null,We)}):(se.status="done",this.loaded[Q]=se,G())})}reloadTile(z,G){let Q=this.loaded,se=z.uid;if(Q&&Q[se]){let le=Q[se];le.projection=z.projection,le.brightness=z.brightness;let Me=(Ze,ke)=>{le.reloadCallback&&(delete le.reloadCallback,this.loadTile(z,G)),G(Ze,ke)};le.status==="parsing"?le.reloadCallback=Me:le.status==="done"&&this.loadTile(z,G)}}abortTile(z,G){let Q=z.uid;this.loading[Q]&&delete this.loading[Q],G()}removeTile(z,G){let Q=this.loaded,se=z.uid;Q&&Q[se]&&delete Q[se],G()}}class $n{constructor(z){this.self=z,this.actor=new i.e6(z,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=i.aJ({name:"mercator"}),this.workerSourceTypes={vector:te,geojson:Qa,"batched-model":ca},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(G,Q)=>{if(this.workerSourceTypes[G])throw new Error(`Worker source with name "${G}" already registered.`);this.workerSourceTypes[G]=Q},this.self.registerRTLTextPlugin=G=>{if(i.e7.isParsed())throw new Error("RTL text plugin already registered.");i.e7.applyArabicShaping=G.applyArabicShaping,i.e7.processBidirectionalText=G.processBidirectionalText,i.e7.processStyledBidirectionalText=G.processStyledBidirectionalText}}clearCaches(z,G,Q){delete this.layerIndexes[z],delete this.availableImages[z],delete this.workerSources[z],delete this.demWorkerSources[z],delete this.rasterArrayWorkerSource,Q()}checkIfReady(z,G,Q){Q()}setReferrer(z,G){this.referrer=G}spriteLoaded(z,{scope:G,isLoaded:Q}){if(this.isSpriteLoaded[z]||(this.isSpriteLoaded[z]={}),this.isSpriteLoaded[z][G]=Q,this.workerSources[z]&&this.workerSources[z][G])for(let se in this.workerSources[z][G]){let le=this.workerSources[z][G][se];for(let Me in le){let Ze=le[Me];Ze instanceof te&&(Ze.isSpriteLoaded=Q,Ze.fire(new i.f("isSpriteLoaded")))}}}setImages(z,{scope:G,images:Q},se){if(this.availableImages[z]||(this.availableImages[z]={}),this.availableImages[z][G]=Q,this.workerSources[z]&&this.workerSources[z][G]){for(let le in this.workerSources[z][G]){let Me=this.workerSources[z][G][le];for(let Ze in Me)Me[Ze].availableImages=Q}se()}else se()}setProjection(z,G){this.projections[z]=i.aJ(G)}setBrightness(z,G,Q){this.brightness=G,Q()}setLayers(z,G,Q){this.getLayerIndex(z,G.scope).replace(G.layers,G.options),Q()}updateLayers(z,G,Q){this.getLayerIndex(z,G.scope).update(G.layers,G.removedIds,G.options),Q()}loadTile(z,G,Q){G.projection=this.projections[z]||this.defaultProjection,this.getWorkerSource(z,G.type,G.source,G.scope).loadTile(G,Q)}loadDEMTile(z,G,Q){this.getDEMWorkerSource(z,G.source,G.scope).loadTile(G,Q)}decodeRasterArray(z,G,Q){this.getRasterArrayWorkerSource().decodeRasterArray(G,Q)}reloadTile(z,G,Q){G.projection=this.projections[z]||this.defaultProjection,this.getWorkerSource(z,G.type,G.source,G.scope).reloadTile(G,Q)}abortTile(z,G,Q){this.getWorkerSource(z,G.type,G.source,G.scope).abortTile(G,Q)}removeTile(z,G,Q){this.getWorkerSource(z,G.type,G.source,G.scope).removeTile(G,Q)}removeSource(z,G,Q){if(!(this.workerSources[z]&&this.workerSources[z][G.scope]&&this.workerSources[z][G.scope][G.type]&&this.workerSources[z][G.scope][G.type][G.source]))return;let se=this.workerSources[z][G.scope][G.type][G.source];delete this.workerSources[z][G.scope][G.type][G.source],se.removeSource!==void 0?se.removeSource(G,Q):Q()}loadWorkerSource(z,G,Q){try{this.self.importScripts(G.url),Q()}catch(se){Q(se.toString())}}syncRTLPluginState(z,G,Q){try{i.e7.setState(G);let se=i.e7.getPluginURL();if(i.e7.isLoaded()&&!i.e7.isParsed()&&se!=null){this.self.importScripts(se);let le=i.e7.isParsed();Q(le?void 0:new Error(`RTL Text Plugin failed to import scripts from ${se}`),le)}}catch(se){Q(se.toString())}}setDracoUrl(z,G){this.dracoUrl=G}getAvailableImages(z,G){this.availableImages[z]||(this.availableImages[z]={});let Q=this.availableImages[z][G];return Q||(Q=[]),Q}getLayerIndex(z,G){this.layerIndexes[z]||(this.layerIndexes[z]={});let Q=this.layerIndexes[z][G];return Q||(Q=this.layerIndexes[z][G]=new M,Q.scope=G),Q}getWorkerSource(z,G,Q,se){return this.workerSources[z]||(this.workerSources[z]={}),this.workerSources[z][se]||(this.workerSources[z][se]={}),this.workerSources[z][se][G]||(this.workerSources[z][se][G]={}),this.isSpriteLoaded[z]||(this.isSpriteLoaded[z]={}),this.workerSources[z][se][G][Q]||(this.workerSources[z][se][G][Q]=new this.workerSourceTypes[G]({send:(le,Me,Ze,ke,We,nt)=>{this.actor.send(le,Me,Ze,z,We,nt)},scheduler:this.actor.scheduler},this.getLayerIndex(z,se),this.getAvailableImages(z,se),this.isSpriteLoaded[z][se],void 0,this.brightness)),this.workerSources[z][se][G][Q]}getDEMWorkerSource(z,G,Q){return this.demWorkerSources[z]||(this.demWorkerSources[z]={}),this.demWorkerSources[z][Q]||(this.demWorkerSources[z][Q]={}),this.demWorkerSources[z][Q][G]||(this.demWorkerSources[z][Q][G]=new H),this.demWorkerSources[z][Q][G]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new J),this.rasterArrayWorkerSource}enforceCacheSizeLimit(z,G){i.e8(G)}getWorkerPerformanceMetrics(z,G,Q){Q(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new $n(self)),$n}),c(["./shared"],function(i){function x(m,o){if(Array.isArray(m)){if(!Array.isArray(o)||m.length!==o.length)return!1;for(let h=0;h<m.length;h++)if(!x(m[h],o[h]))return!1;return!0}if(typeof m=="object"&&m!==null&&o!==null){if(typeof o!="object"||Object.keys(m).length!==Object.keys(o).length)return!1;for(let h in m)if(!x(m[h],o[h]))return!1;return!0}return m===o}var T=A;function A(m){return!function(o){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var g,y,b=new Blob([""],{type:"text/javascript"}),S=URL.createObjectURL(b);try{y=new Worker(S),g=!0}catch{g=!1}return y&&y.terminate(),URL.revokeObjectURL(S),g}()?function(){var g=document.createElement("canvas");g.width=g.height=1;var y=g.getContext("2d");if(!y)return!1;var b=y.getImageData(0,0,1,1);return b&&b.width===g.width}()?(M[h=o&&o.failIfMajorPerformanceCaveat]===void 0&&(M[h]=function(g){var y,b=function(S){var C=document.createElement("canvas"),P=Object.create(A.webGLContextAttributes);return P.failIfMajorPerformanceCaveat=S,C.getContext("webgl2",P)}(g);if(!b)return!1;try{y=b.createShader(b.VERTEX_SHADER)}catch{return!1}return!(!y||b.isContextLost())&&(b.shaderSource(y,"void main() {}"),b.compileShader(y),b.getShaderParameter(y,b.COMPILE_STATUS)===!0)}(h)),M[h]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var h}(m)}var M={};function F(m,o,h){let g=document.createElement(m);return o!=null&&(g.className=o),h&&h.appendChild(g),g}function W(m,o,h){let g=document.createElementNS("http://www.w3.org/2000/svg",m);for(let y of Object.keys(o))g.setAttributeNS(null,y,String(o[y]));return h&&h.appendChild(g),g}A.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};let V=typeof document<"u"?document.documentElement&&document.documentElement.style:null,R=V&&V.userSelect!==void 0?"userSelect":"WebkitUserSelect",te;function H(){V&&R&&(te=V[R],V[R]="none")}function J(){V&&R&&(V[R]=te)}function K(m){m.preventDefault(),m.stopPropagation(),window.removeEventListener("click",K,!0)}function ne(){window.addEventListener("click",K,!0),window.setTimeout(()=>{window.removeEventListener("click",K,!0)},0)}function de(m,o){let h=m.getBoundingClientRect();return et(m,h,o)}function De(m,o){let h=m.getBoundingClientRect(),g=[];for(let y=0;y<o.length;y++)g.push(et(m,h,o[y]));return g}function Fe(m){return window.InstallTrigger!==void 0&&m.button===2&&m.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:m.button}function et(m,o,h){let g=m.offsetWidth===o.width?1:m.offsetWidth/o.width;return new i.P((h.clientX-o.left)*g,(h.clientY-o.top)*g)}class Te{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(o,h){this._updatedSourceCaches[o]=h,this.setDirty()}discardSourceCacheUpdate(o){delete this._updatedSourceCaches[o]}updateLayer(o){let h=o.scope;this._updatedLayers[h]=this._updatedLayers[h]||new Set,this._updatedLayers[h].add(o.id),this.setDirty()}removeLayer(o){let h=o.scope;this._removedLayers[h]=this._removedLayers[h]||{},this._updatedLayers[h]=this._updatedLayers[h]||new Set,this._removedLayers[h][o.id]=o,this._updatedLayers[h].delete(o.id),this._updatedPaintProps.delete(o.fqid),this.setDirty()}getRemovedLayer(o){return this._removedLayers[o.scope]?this._removedLayers[o.scope][o.id]:null}discardLayerRemoval(o){this._removedLayers[o.scope]&&delete this._removedLayers[o.scope][o.id]}getLayerUpdatesByScope(){let o={};for(let h in this._updatedLayers)o[h]=o[h]||{},o[h].updatedIds=Array.from(this._updatedLayers[h].values());for(let h in this._removedLayers)o[h]=o[h]||{},o[h].removedIds=Object.keys(this._removedLayers[h]);return o}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(o){this._updatedPaintProps.add(o.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(o){this._updatedImages.add(o),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}let ge={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ve{constructor(o,h,g,y,b,S){this.length=h.length,this.attributes=g,this.itemSize=h.bytesPerElement,this.dynamicDraw=y,this.instanceCount=S,this.context=o;let C=o.gl;this.buffer=C.createBuffer(),o.bindVertexBuffer.set(this.buffer),C.bufferData(C.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||b||h.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){let h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,h){for(let g=0;g<this.attributes.length;g++){let y=h.attributes[this.attributes[g].name];y!==void 0&&o.enableVertexAttribArray(y)}}setVertexAttribPointers(o,h,g){for(let y=0;y<this.attributes.length;y++){let b=this.attributes[y],S=h.attributes[b.name];S!==void 0&&o.vertexAttribPointer(S,b.components,o[ge[b.type]],!1,this.itemSize,b.offset+this.itemSize*(g||0))}}setVertexAttribDivisor(o,h,g){for(let y=0;y<this.attributes.length;y++){let b=h.attributes[this.attributes[y].name];b!==void 0&&this.instanceCount&&this.instanceCount>0&&o.vertexAttribDivisor(b,g)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ae{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class _e extends Ae{getDefault(){return i.C.transparent}set(o){let h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class xe extends Ae{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class Qe extends Ae{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class Ce extends Ae{getDefault(){return[!0,!0,!0,!0]}set(o){let h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Ye extends Ae{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class ut extends Ae{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class st extends Ae{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){let h=this.current;(o.func!==h.func||o.ref!==h.ref||o.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class pt extends Ae{getDefault(){let o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){let h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class Tt extends Ae{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;let h=this.gl;o?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=o,this.dirty=!1}}class ht extends Ae{getDefault(){return[0,1]}set(o){let h=this.current;(o[0]!==h[0]||o[1]!==h[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class Wt extends Ae{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;let h=this.gl;o?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=o,this.dirty=!1}}class ie extends Ae{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class ye extends Ae{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;let h=this.gl;o?h.enable(h.BLEND):h.disable(h.BLEND),this.current=o,this.dirty=!1}}class pe extends Ae{getDefault(){let o=this.gl;return[o.ONE,o.ZERO,o.ONE,o.ZERO]}set(o){let h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.blendFuncSeparate(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Ie extends Ae{getDefault(){return i.C.transparent}set(o){let h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Ue extends Ae{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(o,o),this.current=o,this.dirty=!1)}}class gt extends Ae{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;let h=this.gl;o?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=o,this.dirty=!1}}class mt extends Ae{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class wt extends Ae{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}let Lt=class extends Ae{getDefault(){return null}set(m){(m!==this.current||this.dirty)&&(this.gl.useProgram(m),this.current=m,this.dirty=!1)}};class fi extends Ae{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class yi extends Ae{getDefault(){let o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){let h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Fi extends Ae{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;let h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class Pi extends Ae{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;let h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class $t extends Ae{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;let h=this.gl;h.bindTexture(h.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class lt extends Ae{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;let h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Bt extends Ae{getDefault(){return null}set(o){let h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class ni extends Ae{getDefault(){return null}set(o){this.gl&&(o!==this.current||this.dirty)&&(this.gl.bindVertexArray(o),this.current=o,this.dirty=!1)}}class bi extends Ae{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;let h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class ki extends Ae{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;let h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Ni extends Ae{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;let h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class Bi extends Ae{constructor(o,h){super(o),this.context=o,this.parent=h}getDefault(){return null}}class tr extends Bi{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class ar extends Bi{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,this.attachment(),h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class vr extends Bi{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,this.attachment(),h.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class kr extends ar{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class qr{constructor(o,h,g,y,b){this.context=o,this.width=h,this.height=g;let S=this.framebuffer=o.gl.createFramebuffer();y&&(this.colorAttachment=new tr(o,S)),b&&(this.depthAttachmentType=b,this.depthAttachment=b==="renderbuffer"?new ar(o,S):new vr(o,S))}destroy(){let o=this.context.gl;if(this.colorAttachment){let h=this.colorAttachment.get();h&&o.deleteTexture(h)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){let h=this.depthAttachment.get();h&&o.deleteRenderbuffer(h)}else{let h=this.depthAttachment.get();h&&o.deleteTexture(h)}o.deleteFramebuffer(this.framebuffer)}}class Kr{constructor(o,h){this.gl=o,this.clearColor=new _e(this),this.clearDepth=new xe(this),this.clearStencil=new Qe(this),this.colorMask=new Ce(this),this.depthMask=new Ye(this),this.stencilMask=new ut(this),this.stencilFunc=new st(this),this.stencilOp=new pt(this),this.stencilTest=new Tt(this),this.depthRange=new ht(this),this.depthTest=new Wt(this),this.depthFunc=new ie(this),this.blend=new ye(this),this.blendFunc=new pe(this),this.blendColor=new Ie(this),this.blendEquation=new Ue(this),this.cullFace=new gt(this),this.cullFaceSide=new mt(this),this.frontFace=new wt(this),this.program=new Lt(this),this.activeTexture=new fi(this),this.viewport=new yi(this),this.bindFramebuffer=new Fi(this),this.bindRenderbuffer=new Pi(this),this.bindTexture=new $t(this),this.bindVertexBuffer=new lt(this),this.bindElementBuffer=new Bt(this),this.bindVertexArrayOES=new ni(this),this.pixelStoreUnpack=new bi(this),this.pixelStoreUnpackPremultiplyAlpha=new ki(this),this.pixelStoreUnpackFlipY=new Ni(this),this.options=h?In({},h):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=o.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=o.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=o.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=o.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),this.maxPointSize=o.getParameter(o.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,h,g){return new i.I(this,o,h,g)}createVertexBuffer(o,h,g,y,b){return new Ve(this,o,h,g,y,b)}createRenderbuffer(o,h,g){let y=this.gl,b=y.createRenderbuffer();return this.bindRenderbuffer.set(b),y.renderbufferStorage(y.RENDERBUFFER,o,h,g),this.bindRenderbuffer.set(null),b}createFramebuffer(o,h,g,y){return new qr(this,o,h,g,y)}clear({color:o,depth:h,stencil:g,colorMask:y}){let b=this.gl,S=0;o&&(S|=b.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set(y||[!0,!0,!0,!0])),h!==void 0&&(S|=b.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),g!==void 0&&(S|=b.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),b.clear(S)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){x(o.blendFunction,i.a.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor),o.blendEquation?this.blendEquation.set(o.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(o.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}class xr{constructor(o){this._gl=o.gl,this._query=this._gl.createQuery(),this._isFree=!0}begin(){this._gl.beginQuery(this._gl.ANY_SAMPLES_PASSED,this._query),this._isFree=!1}end(){this._gl.endQuery(this._gl.ANY_SAMPLES_PASSED)}isResultAvailable(){return this._gl.getQueryParameter(this._query,this._gl.QUERY_RESULT_AVAILABLE)}consumeResult(){let o=this._gl.getQueryParameter(this._query,this._gl.QUERY_RESULT);return this._isFree=!0,o}isFree(){return this._isFree}destroy(){this._gl.deleteQuery(this._query)}}class Or{constructor(o){this.useOcclusionQueries=!0,this.visualizeOcclusions="none",this.occlusionQueryFrameWindow=5,this.occluderSize=32,this.fadeSpeed=7,this.depthOffset=-1e-4,o.registerParameter(this,["Symbols"],"useOcclusionQueries"),o.registerParameter(this,["Symbols"],"visualizeOcclusions",{options:{none:"none",zPass:"zPass",zTest:"zTest"}}),o.registerParameter(this,["Symbols"],"occlusionQueryFrameWindow",{min:1,max:30,step:1}),o.registerParameter(this,["Symbols"],"occluderSize",{min:1,max:100,step:1}),o.registerParameter(this,["Symbols"],"fadeSpeed",{min:.1,max:50,step:.1}),o.registerParameter(this,["Symbols"],"depthOffset",{min:-.001,max:0,step:1e-4})}}class Ri{constructor(o,h,g,y){let b={width:g[0],height:g[1],data:null},S=o.gl;this.targetColorTexture=new i.T(o,b,S.RGBA,{useMipmap:!1}),this.backgroundColorTexture=new i.T(o,b,S.RGBA,{useMipmap:!1}),this.context=o,this.updateParticleTexture(h,y),this.lastInvalidatedAt=0}updateParticleTexture(o,h){if(this.particleTextureDimension===h.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());let g=this.context.gl,y=h.width*h.height;this.particleTexture0=new i.T(this.context,h,g.RGBA,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new i.T(this.context,h,g.RGBA,{premultiply:!1,useMipmap:!1});let b=new i.S;b.reserve(y);for(let S=0;S<y;S++)b.emplaceBack(S);this.particleIndexBuffer=this.context.createVertexBuffer(b,i.p.members,!0),this.particleSegment=i.b.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=h.width}update(o){return!(this.lastInvalidatedAt<o&&(this.lastInvalidatedAt=i.e.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}class La extends i.E{constructor(o){super(),this.requestManager=o,this.models={"":{}},this.numModelsLoading={}}loadModel(o,h){return i.l(this.requestManager.transformRequest(h,i.R.Model).url).then(g=>{if(!g)return;let y=i.c(g),b=new i.M(o,void 0,void 0,y);return b.computeBoundsAndApplyParent(),b}).catch(g=>{if(g&&g.status===404)return null;this.fire(new i.d(new Error(`Could not load model ${o} from ${h}: ${g.message}`)))})}load(o,h){this.models[h]||(this.models[h]={});let g=Object.keys(o);this.numModelsLoading[h]=(this.numModelsLoading[h]||0)+g.length;let y=[];for(let b of g)y.push(this.loadModel(b,o[b]));Promise.allSettled(y).then(b=>{for(let S=0;S<b.length;S++){let{status:C,value:P}=b[S];C==="fulfilled"&&P&&(this.models[h][g[S]]={model:P,numReferences:1})}this.numModelsLoading[h]-=g.length,this.fire(new i.f("data",{dataType:"style"}))}).catch(b=>{this.fire(new i.d(new Error(`Could not load models: ${b.message}`)))})}isLoaded(){for(let o in this.numModelsLoading)if(this.numModelsLoading[o]>0)return!1;return!0}hasModel(o,h){return!!this.getModel(o,h)}getModel(o,h){return this.models[h]||(this.models[h]={}),this.models[h][o]?this.models[h][o].model:void 0}addModel(o,h,g){this.models[g]||(this.models[g]={}),this.hasModel(o,g)&&this.models[g][o].numReferences++,this.load({[o]:this.requestManager.normalizeModelURL(h)},g)}addModels(o,h){this.models[h]||(this.models[h]={});let g={};for(let y in o)this.models[h][y]={},g[y]=this.requestManager.normalizeModelURL(o[y]);this.load(g,h)}addModelsFromBucket(o,h){this.models[h]||(this.models[h]={});let g={};for(let y of o)this.hasModel(y,h)?this.models[h][y].numReferences++:g[y]=this.requestManager.normalizeModelURL(y);this.load(g,h)}removeModel(o,h){if(this.models[h]&&this.models[h][o]&&(this.models[h][o].numReferences--,this.models[h][o].numReferences===0)){let g=this.models[h][o].model;delete this.models[h][o],g.destroy()}}listModels(o){return this.models[o]||(this.models[o]={}),Object.keys(this.models[o])}upload(o,h){this.models[h]||(this.models[h]={});for(let g in this.models[h])this.models[h][g].model&&this.models[h][g].model.upload(o.context)}}function Di(m){let{userImage:o}=m;return!!(o&&o.render&&o.render())&&(m.data.replace(new Uint8Array(o.data.buffer)),!0)}class go extends i.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(o){this.images[o]={},this.loaded[o]=!1,this.updatedImages[o]={},this.patterns[o]={},this.callbackDispatchedThisFrame[o]={},this.atlasImage[o]=new i.i({width:1,height:1})}isLoaded(){for(let o in this.loaded)if(!this.loaded[o])return!1;return!0}setLoaded(o,h){if(this.loaded[h]!==o&&(this.loaded[h]=o,o)){for(let{ids:g,callback:y}of this.requestors)this._notify(g,h,y);this.requestors=[]}}hasImage(o,h){return!!this.getImage(o,h)}getImage(o,h){return this.images[h][o]}addImage(o,h,g){this._validate(o,g)&&(this.images[h][o]=g)}_validate(o,h){let g=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new i.d(new Error(`Image "${o}" has invalid "stretchX" value`))),g=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new i.d(new Error(`Image "${o}" has invalid "stretchY" value`))),g=!1),this._validateContent(h.content,h)||(this.fire(new i.d(new Error(`Image "${o}" has invalid "content" value`))),g=!1),g}_validateStretch(o,h){if(!o)return!0;let g=0;for(let y of o){if(y[0]<g||y[1]<y[0]||h<y[1])return!1;g=y[1]}return!0}_validateContent(o,h){return!(o&&(o.length!==4||o[0]<0||h.data.width<o[0]||o[1]<0||h.data.height<o[1]||o[2]<0||h.data.width<o[2]||o[3]<0||h.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))}updateImage(o,h,g){g.version=this.images[h][o].version+1,this.images[h][o]=g,this.updatedImages[h][o]=!0}removeImage(o,h){let g=this.images[h][o];delete this.images[h][o],delete this.patterns[h][o],g.userImage&&g.userImage.onRemove&&g.userImage.onRemove()}listImages(o){return Object.keys(this.images[o])}getImages(o,h,g){let y=!0,b=!!this.loaded[h];if(!b)for(let S of o)this.images[h][S]||(y=!1);b||y?this._notify(o,h,g):this.requestors.push({ids:o,scope:h,callback:g})}getUpdatedImages(o){return this.updatedImages[o]}_notify(o,h,g){let y={};for(let b of o){this.images[h][b]||this.fire(new i.f("styleimagemissing",{id:b}));let S=this.images[h][b];S?y[b]={data:S.data.clone(),pixelRatio:S.pixelRatio,sdf:S.sdf,version:S.version,stretchX:S.stretchX,stretchY:S.stretchY,content:S.content,hasRenderCallback:!!(S.userImage&&S.userImage.render)}:i.w(`Image "${b}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}g(null,y)}getPixelSize(o){let{width:h,height:g}=this.atlasImage[o];return{width:h,height:g}}getPattern(o,h,g){let y=this.patterns[h][o],b=this.getImage(o,h);if(!b)return null;if(y&&y.position.version===b.version)return y.position;if(y)y.position.version=b.version;else{let S={w:b.data.width+2,h:b.data.height+2,x:0,y:0},C=new i.k(S,b);this.patterns[h][o]={bin:S,position:C}}return this._updatePatternAtlas(h,g),this.patterns[h][o].position}bind(o,h){let g=o.gl,y=this.atlasTexture[h];y?this.dirty&&(y.update(this.atlasImage[h]),this.dirty=!1):(y=new i.T(o,this.atlasImage[h],g.RGBA),this.atlasTexture[h]=y),y.bind(g.LINEAR,g.CLAMP_TO_EDGE)}_updatePatternAtlas(o,h){let g=[];for(let C in this.patterns[o])g.push(this.patterns[o][C].bin);let{w:y,h:b}=i.j(g),S=this.atlasImage[o];S.resize({width:y||1,height:b||1});for(let C in this.patterns[o]){let{bin:P}=this.patterns[o][C],O=P.x+1,j=P.y+1,X=this.images[o][C].data,re=X.width,ae=X.height;i.i.copy(X,S,{x:0,y:0},{x:O,y:j},{width:re,height:ae},h),i.i.copy(X,S,{x:0,y:ae-1},{x:O,y:j-1},{width:re,height:1},h),i.i.copy(X,S,{x:0,y:0},{x:O,y:j+ae},{width:re,height:1},h),i.i.copy(X,S,{x:re-1,y:0},{x:O-1,y:j},{width:1,height:ae},h),i.i.copy(X,S,{x:0,y:0},{x:O+re,y:j},{width:1,height:ae},h)}this.dirty=!0}beginFrame(){for(let o in this.images)this.callbackDispatchedThisFrame[o]={}}dispatchRenderCallbacks(o,h){for(let g of o){if(this.callbackDispatchedThisFrame[h][g])continue;this.callbackDispatchedThisFrame[h][g]=!0;let y=this.images[h][g];Di(y)&&this.updateImage(g,h,y)}}}function fr(m){let o=m.key,h=m.value,g=m.valueSpec||{},y=m.objectElementValidators||{},b=m.style,S=m.styleSpec,C=[],P=i.n(h);if(P!=="object")return[new i.V(o,h,`object expected, ${P} found`)];for(let O in h){let j=O.split(".")[0],X;y[j]?X=y[j]:g[j]?X=z:y["*"]?X=y["*"]:g["*"]&&(X=z),X?C=C.concat(X({key:(o&&`${o}.`)+O,value:h[O],valueSpec:g[j]||g["*"],style:b,styleSpec:S,object:h,objectKey:O},h)):C.push(new i.m(o,h[O],`unknown property "${O}"`))}for(let O in g)y[O]||g[O].required&&g[O].default===void 0&&h[O]===void 0&&C.push(new i.V(o,h,`missing required property "${O}"`));return C}function Sn(m){let o=m.value,h=m.valueSpec,g=m.style,y=m.styleSpec,b=m.key,S=m.arrayElementValidator||z;if(i.n(o)!=="array")return[new i.V(b,o,`array expected, ${i.n(o)} found`)];if(h.length&&o.length!==h.length)return[new i.V(b,o,`array length ${h.length} expected, length ${o.length} found`)];if(h["min-length"]&&o.length<h["min-length"])return[new i.V(b,o,`array length at least ${h["min-length"]} expected, length ${o.length} found`)];let C={type:h.value,values:h.values,minimum:h.minimum,maximum:h.maximum,function:void 0};y.$version<7&&(C.function=h.function),i.n(h.value)==="object"&&(C=h.value);let P=[];for(let O=0;O<o.length;O++)P=P.concat(S({array:o,arrayIndex:O,value:o[O],valueSpec:C,style:g,styleSpec:y,key:`${b}[${O}]`},!0));return P}function _o(m){let o=m.key,h=m.value,g=m.valueSpec,y=i.n(h);if(y==="number"&&h!=h&&(y="NaN"),y!=="number")return[new i.V(o,h,`number expected, ${y} found`)];if("minimum"in g){let b=g.minimum;if(i.n(g.minimum)==="array"&&(b=g.minimum[m.arrayIndex]),h<b)return[new i.V(o,h,`${h} is less than the minimum value ${b}`)]}if("maximum"in g){let b=g.maximum;if(i.n(g.maximum)==="array"&&(b=g.maximum[m.arrayIndex]),h>b)return[new i.V(o,h,`${h} is greater than the maximum value ${b}`)]}return[]}function $r(m){let o=m.valueSpec,h=i.u(m.value.type),g,y,b,S={},C=h!=="categorical"&&m.value.property===void 0,P=!C,O=i.n(m.value.stops)==="array"&&i.n(m.value.stops[0])==="array"&&i.n(m.value.stops[0][0])==="object",j=fr({key:m.key,value:m.value,valueSpec:m.styleSpec.function,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{stops:function(ae){if(h==="identity")return[new i.V(ae.key,ae.value,'identity function may not have a "stops" property')];let ue=[],he=ae.value;return ue=ue.concat(Sn({key:ae.key,value:he,valueSpec:ae.valueSpec,style:ae.style,styleSpec:ae.styleSpec,arrayElementValidator:X})),i.n(he)==="array"&&he.length===0&&ue.push(new i.V(ae.key,he,"array must have at least one stop")),ue},default:function(ae){return z({key:ae.key,value:ae.value,valueSpec:o,style:ae.style,styleSpec:ae.styleSpec})}}});return h==="identity"&&C&&j.push(new i.V(m.key,m.value,'missing required property "property"')),h==="identity"||m.value.stops||j.push(new i.V(m.key,m.value,'missing required property "stops"')),h==="exponential"&&m.valueSpec.expression&&!i.s(m.valueSpec)&&j.push(new i.V(m.key,m.value,"exponential functions not supported")),m.styleSpec.$version>=8&&(P&&!i.q(m.valueSpec)?j.push(new i.V(m.key,m.value,"property functions not supported")):C&&!i.r(m.valueSpec)&&j.push(new i.V(m.key,m.value,"zoom functions not supported"))),h!=="categorical"&&!O||m.value.property!==void 0||j.push(new i.V(m.key,m.value,'"property" property is required')),j;function X(ae){let ue=[],he=ae.value,fe=ae.key;if(i.n(he)!=="array")return[new i.V(fe,he,`array expected, ${i.n(he)} found`)];if(he.length!==2)return[new i.V(fe,he,`array length 2 expected, length ${he.length} found`)];if(O){if(i.n(he[0])!=="object")return[new i.V(fe,he,`object expected, ${i.n(he[0])} found`)];if(he[0].zoom===void 0)return[new i.V(fe,he,"object stop key must have zoom")];if(he[0].value===void 0)return[new i.V(fe,he,"object stop key must have value")];let me=i.u(he[0].zoom);if(typeof me!="number")return[new i.V(fe,he[0].zoom,"stop zoom values must be numbers")];if(b&&b>me)return[new i.V(fe,he[0].zoom,"stop zoom values must appear in ascending order")];me!==b&&(b=me,y=void 0,S={}),ue=ue.concat(fr({key:`${fe}[0]`,value:he[0],valueSpec:{zoom:{}},style:ae.style,styleSpec:ae.styleSpec,objectElementValidators:{zoom:_o,value:re}}))}else ue=ue.concat(re({key:`${fe}[0]`,value:he[0],valueSpec:{},style:ae.style,styleSpec:ae.styleSpec},he));return i.t(i.v(he[1]))?ue.concat([new i.V(`${fe}[1]`,he[1],"expressions are not allowed in function stops.")]):ue.concat(z({key:`${fe}[1]`,value:he[1],valueSpec:o,style:ae.style,styleSpec:ae.styleSpec}))}function re(ae,ue){let he=i.n(ae.value),fe=i.u(ae.value),me=ae.value!==null?ae.value:ue;if(g){if(he!==g)return[new i.V(ae.key,me,`${he} stop domain type must match previous stop domain type ${g}`)]}else g=he;if(he!=="number"&&he!=="string"&&he!=="boolean"&&typeof fe!="number"&&typeof fe!="string"&&typeof fe!="boolean")return[new i.V(ae.key,me,"stop domain value must be a number, string, or boolean")];if(he!=="number"&&h!=="categorical"){let Le=`number expected, ${he} found`;return i.q(o)&&h===void 0&&(Le+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i.V(ae.key,me,Le)]}return h!=="categorical"||he!=="number"||typeof fe=="number"&&isFinite(fe)&&Math.floor(fe)===fe?h!=="categorical"&&he==="number"&&typeof fe=="number"&&typeof y=="number"&&y!==void 0&&fe<y?[new i.V(ae.key,me,"stop domain values must appear in ascending order")]:(y=fe,h==="categorical"&&fe in S?[new i.V(ae.key,me,"stop domain values must be unique")]:(S[fe]=!0,[])):[new i.V(ae.key,me,`integer expected, found ${String(fe)}`)]}}function so(m){let o=(m.expressionContext==="property"?i.x:i.y)(i.v(m.value),m.valueSpec);if(o.result==="error")return o.value.map(g=>new i.V(`${m.key}${g.key}`,m.value,g.message));let h=o.value.expression||o.value._styleExpression.expression;if(m.expressionContext==="property"&&m.propertyKey==="text-font"&&!h.outputDefined())return[new i.V(m.key,m.value,`Invalid data expression for "${m.propertyKey}". Output values must be contained as literals within the expression.`)];if(m.expressionContext==="property"&&m.propertyType==="layout"&&!i.z(h))return[new i.V(m.key,m.value,'"feature-state" data expressions are not supported with layout properties.')];if(m.expressionContext==="filter")return Rn(h,m);if(m.expressionContext&&m.expressionContext.indexOf("cluster")===0){if(!i.A(h,["zoom","feature-state"]))return[new i.V(m.key,m.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(m.expressionContext==="cluster-initial"&&!i.B(h))return[new i.V(m.key,m.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Rn(m,o){let h=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(o.valueSpec&&o.valueSpec.expression)for(let y of o.valueSpec.expression.parameters)h.delete(y);if(h.size===0)return[];let g=[];return m instanceof i.D&&h.has(m.name)?[new i.V(o.key,o.value,`["${m.name}"] expression is not supported in a filter for a ${o.object.type} layer with id: ${o.object.id}`)]:(m.eachChild(y=>{g.push(...Rn(y,o))}),g)}function Ja(m){let o=m.key,h=m.value,g=m.valueSpec,y=[];return Array.isArray(g.values)?g.values.indexOf(i.u(h))===-1&&y.push(new i.V(o,h,`expected one of [${g.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(g.values).indexOf(i.u(h))===-1&&y.push(new i.V(o,h,`expected one of [${Object.keys(g.values).join(", ")}], ${JSON.stringify(h)} found`)),y}function xo(m){return i.G(i.v(m.value))?so(i.o({},m,{expressionContext:"filter",valueSpec:m.styleSpec[`filter_${m.layerType||"fill"}`]})):vn(m)}function vn(m){let o=m.value,h=m.key;if(i.n(o)!=="array")return[new i.V(h,o,`array expected, ${i.n(o)} found`)];let g=m.styleSpec,y,b=[];if(o.length<1)return[new i.V(h,o,"filter array must have at least 1 element")];switch(b=b.concat(Ja({key:`${h}[0]`,value:o[0],valueSpec:g.filter_operator,style:m.style,styleSpec:m.styleSpec})),i.u(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&i.u(o[1])==="$type"&&b.push(new i.V(h,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":o.length!==3&&b.push(new i.V(h,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(y=i.n(o[1]),y!=="string"&&b.push(new i.V(`${h}[1]`,o[1],`string expected, ${y} found`)));for(let S=2;S<o.length;S++)y=i.n(o[S]),i.u(o[1])==="$type"?b=b.concat(Ja({key:`${h}[${S}]`,value:o[S],valueSpec:g.geometry_type,style:m.style,styleSpec:m.styleSpec})):y!=="string"&&y!=="number"&&y!=="boolean"&&b.push(new i.V(`${h}[${S}]`,o[S],`string, number, or boolean expected, ${y} found`));break;case"any":case"all":case"none":for(let S=1;S<o.length;S++)b=b.concat(vn({key:`${h}[${S}]`,value:o[S],style:m.style,styleSpec:m.styleSpec}));break;case"has":case"!has":y=i.n(o[1]),o.length!==2?b.push(new i.V(h,o,`filter array for "${o[0]}" operator must have 2 elements`)):y!=="string"&&b.push(new i.V(`${h}[1]`,o[1],`string expected, ${y} found`))}return b}function Ar(m,o){let h=m.key,g=m.style,y=m.layer,b=m.styleSpec,S=m.value,C=m.objectKey,P=b[`${o}_${m.layerType}`];if(!P)return[];let O=C.match(/^(.*)-transition$/);if(o==="paint"&&O&&P[O[1]]&&P[O[1]].transition)return z({key:h,value:S,valueSpec:b.transition,style:g,styleSpec:b});let j=m.valueSpec||P[C];if(!j)return[new i.m(h,S,`unknown property "${C}"`)];let X;if(i.n(S)==="string"&&i.q(j)&&!j.tokens&&(X=/^{([^}]+)}$/.exec(S))){let ae=`\`{ "type": "identity", "property": ${X?JSON.stringify(X[1]):'"_"'} }\``;return[new i.V(h,S,`"${C}" does not support interpolation syntax
Use an identity property function instead: ${ae}.`)]}let re=[];if(m.layerType==="symbol")C!=="text-field"||!g||g.glyphs||g.imports||re.push(new i.V(h,S,'use of "text-field" requires a style "glyphs" property')),C==="text-font"&&i.H(i.v(S))&&i.u(S.type)==="identity"&&re.push(new i.V(h,S,'"text-font" does not support identity functions'));else if(m.layerType==="model"&&o==="paint"&&y&&y.layout&&y.layout.hasOwnProperty("model-id")&&i.q(j)&&(i.J(j)||i.r(j))){let ae=i.x(i.v(S),j),ue=ae.value.expression||ae.value._styleExpression.expression;ue&&!i.A(ue,["measure-light"])&&(C==="model-emissive-strength"&&i.B(ue)&&i.z(ue)||re.push(new i.V(h,S,`${C} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return re.concat(z({key:m.key,value:S,valueSpec:j,style:g,styleSpec:b,expressionContext:"property",propertyType:o,propertyKey:C}))}function dn(m){return Ar(m,"paint")}function as(m){return Ar(m,"layout")}function kn(m){let o=[],h=m.value,g=m.key,y=m.style,b=m.styleSpec;h.type||h.ref||o.push(new i.V(g,h,'either "type" or "ref" is required'));let S=i.u(h.type),C=i.u(h.ref);if(h.id){let P=i.u(h.id);for(let O=0;O<m.arrayIndex;O++){let j=y.layers[O];i.u(j.id)===P&&o.push(new i.V(g,h.id,`duplicate layer id "${h.id}", previously used at line ${j.id.__line__}`))}}if("ref"in h){let P;["type","source","source-layer","filter","layout"].forEach(O=>{O in h&&o.push(new i.V(g,h[O],`"${O}" is prohibited for ref layers`))}),y.layers.forEach(O=>{i.u(O.id)===C&&(P=O)}),P?P.ref?o.push(new i.V(g,h.ref,"ref cannot reference another ref layer")):S=i.u(P.type):typeof C=="string"&&o.push(new i.V(g,h.ref,`ref layer "${C}" not found`))}else if(S!=="background"&&S!=="sky"&&S!=="slot")if(h.source){let P=y.sources&&y.sources[h.source],O=P&&i.u(P.type);P?O==="vector"&&S==="raster"?o.push(new i.V(g,h.source,`layer "${h.id}" requires a raster source`)):O==="raster"&&S!=="raster"?o.push(new i.V(g,h.source,`layer "${h.id}" requires a vector source`)):O!=="vector"||h["source-layer"]?O==="raster-dem"&&S!=="hillshade"?o.push(new i.V(g,h.source,"raster-dem source can only be used with layer type 'hillshade'.")):O!=="raster-array"||["raster","raster-particle"].includes(S)?S!=="line"||!h.paint||!h.paint["line-gradient"]&&!h.paint["line-trim-offset"]||O==="geojson"&&P.lineMetrics?S==="raster-particle"&&O!=="raster-array"&&o.push(new i.V(g,h.source,`layer "${h.id}" requires a 'raster-array' source.`)):o.push(new i.V(g,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):o.push(new i.V(g,h.source,"raster-array source can only be used with layer type 'raster'.")):o.push(new i.V(g,h,`layer "${h.id}" must specify a "source-layer"`)):o.push(new i.V(g,h.source,`source "${h.source}" not found`))}else o.push(new i.V(g,h,'missing required property "source"'));return o=o.concat(fr({key:g,value:h,valueSpec:b.layer,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{"*":()=>[],type:()=>z({key:`${g}.type`,value:h.type,valueSpec:b.layer.type,style:m.style,styleSpec:m.styleSpec,object:h,objectKey:"type"}),filter:P=>xo(i.o({layerType:S},P)),layout:P=>fr({layer:h,key:P.key,value:P.value,valueSpec:{},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":O=>as(i.o({layerType:S},O))}}),paint:P=>fr({layer:h,key:P.key,value:P.value,valueSpec:{},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":O=>dn(i.o({layerType:S,layer:h},O))}})}})),o}function lo(m){let o=m.value,h=m.key,g=i.n(o);return g!=="string"?[new i.V(h,o,`string expected, ${g} found`)]:[]}let ka={promoteId:function({key:m,value:o}){if(i.n(o)==="string")return lo({key:m,value:o});{let h=[];for(let g in o)h.push(...lo({key:`${m}.${g}`,value:o[g]}));return h}}};function Ki(m){let o=m.value,h=m.key,g=m.styleSpec,y=m.style;if(!o.type)return[new i.V(h,o,'"type" is required')];let b=i.u(o.type),S=[];switch(["vector","raster","raster-dem","raster-array"].includes(b)&&(o.url||o.tiles||S.push(new i.m(h,o,'Either "url" or "tiles" is required.'))),b){case"vector":case"raster":case"raster-dem":case"raster-array":return S=S.concat(fr({key:h,value:o,valueSpec:g[`source_${b.replace("-","_")}`],style:m.style,styleSpec:g,objectElementValidators:ka})),S;case"geojson":if(S=fr({key:h,value:o,valueSpec:g.source_geojson,style:y,styleSpec:g,objectElementValidators:ka}),o.cluster)for(let C in o.clusterProperties){let[P,O]=o.clusterProperties[C],j=typeof P=="string"?[P,["accumulated"],["get",C]]:P;S.push(...so({key:`${h}.${C}.map`,value:O,expressionContext:"cluster-map"})),S.push(...so({key:`${h}.${C}.reduce`,value:j,expressionContext:"cluster-reduce"}))}return S;case"video":return fr({key:h,value:o,valueSpec:g.source_video,style:y,styleSpec:g});case"image":return fr({key:h,value:o,valueSpec:g.source_image,style:y,styleSpec:g});case"canvas":return[new i.V(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ja({key:`${h}.type`,value:o.type,valueSpec:{values:Ro(g)},style:y,styleSpec:g})}}function Ro(m){return m.source.reduce((o,h)=>{let g=m[h];return g.type.type==="enum"&&(o=o.concat(Object.keys(g.type.values))),o},[])}function Qa(m){let o=m.value,h=m.styleSpec,g=h.light,y=m.style,b=[],S=i.n(o);if(o===void 0)return b;if(S!=="object")return b=b.concat([new i.V("light",o,`object expected, ${S} found`)]),b;for(let C in o){let P=C.match(/^(.*)-transition$/);b=b.concat(P&&g[P[1]]&&g[P[1]].transition?z({key:C,value:o[C],valueSpec:h.transition,style:y,styleSpec:h}):g[C]?z({key:C,value:o[C],valueSpec:g[C],style:y,styleSpec:h}):[new i.V(C,o[C],`unknown property "${C}"`)])}return b}function Va(m){let o=m.value,h=[];if(!o)return h;let g=i.n(o);if(g!=="object")return h=h.concat([new i.V("light-3d",o,`object expected, ${g} found`)]),h;let y=m.styleSpec,b=y["light-3d"],S=m.key,C=m.style,P=m.style.lights;for(let X of["type","id"])if(!(X in o))return h=h.concat([new i.V("light-3d",o,`missing property ${X} on light`)]),h;if(o.type&&P)for(let X=0;X<m.arrayIndex;X++){let re=i.u(o.type),ae=P[X];i.u(ae.type)===re&&h.push(new i.V(S,o.id,`duplicate light type "${o.type}", previously defined at line ${ae.id.__line__}`))}let O=`properties_light_${o.type}`;if(!(O in y))return h=h.concat([new i.V("light-3d",o,`Invalid light type ${o.type}`)]),h;let j=y[O];for(let X in o)if(X==="properties"){let re=o[X],ae=i.n(re);if(ae!=="object")return h=h.concat([new i.V("properties",re,`object expected, ${ae} found`)]),h;for(let ue in re)h=h.concat(j[ue]?z({key:ue,value:re[ue],valueSpec:j[ue],style:C,styleSpec:y}):[new i.m(m.key,re[ue],`unknown property "${ue}"`)])}else{let re=X.match(/^(.*)-transition$/);h=h.concat(re&&b[re[1]]&&b[re[1]].transition?z({key:X,value:o[X],valueSpec:y.transition,style:C,styleSpec:y}):b[X]?z({key:X,value:o[X],valueSpec:b[X],style:C,styleSpec:y}):[new i.m(X,o[X],`unknown property "${X}"`)])}return h}function ca(m){let o=m.value,h=m.key,g=m.style,y=m.styleSpec,b=y.terrain,S=[],C=i.n(o);if(o===void 0||C==="null")return S;if(C!=="object")return S=S.concat([new i.V("terrain",o,`object expected, ${C} found`)]),S;for(let P in o){let O=P.match(/^(.*)-transition$/);S=S.concat(O&&b[O[1]]&&b[O[1]].transition?z({key:P,value:o[P],valueSpec:y.transition,style:g,styleSpec:y}):b[P]?z({key:P,value:o[P],valueSpec:b[P],style:g,styleSpec:y}):[new i.m(P,o[P],`unknown property "${P}"`)])}if(o.source){let P=g.sources&&g.sources[o.source],O=P&&i.u(P.type);P?O!=="raster-dem"&&S.push(new i.V(h,o.source,`terrain cannot be used with a source of type ${String(O)}, it only be used with a "raster-dem" source type`)):S.push(new i.V(h,o.source,`source "${o.source}" not found`))}else S.push(new i.V(h,o,'terrain is missing required property "source"'));return S}function $n(m){let o=m.value,h=m.style,g=m.styleSpec,y=g.fog,b=[],S=i.n(o);if(o===void 0)return b;if(S!=="object")return b=b.concat([new i.V("fog",o,`object expected, ${S} found`)]),b;for(let C in o){let P=C.match(/^(.*)-transition$/);b=b.concat(P&&y[P[1]]&&y[P[1]].transition?z({key:C,value:o[C],valueSpec:g.transition,style:h,styleSpec:g}):y[C]?z({key:C,value:o[C],valueSpec:y[C],style:h,styleSpec:g}):[new i.m(C,o[C],`unknown property "${C}"`)])}return b}let ee={"*":()=>[],array:Sn,boolean:function(m){let o=m.value,h=m.key,g=i.n(o);return g!=="boolean"?[new i.V(h,o,`boolean expected, ${g} found`)]:[]},number:_o,color:function(m){let o=m.key,h=m.value,g=i.n(h);return g!=="string"?[new i.V(o,h,`color expected, ${g} found`)]:i.F(h)===null?[new i.V(o,h,`color expected, "${h}" found`)]:[]},enum:Ja,filter:xo,function:$r,layer:kn,object:fr,source:Ki,model:i.K,light:Qa,"light-3d":Va,terrain:ca,fog:$n,string:lo,formatted:function(m){return lo(m).length===0?[]:so(m)},resolvedImage:function(m){return lo(m).length===0?[]:so(m)},projection:function(m){let o=m.value,h=m.styleSpec,g=h.projection,y=m.style,b=[],S=i.n(o);if(S==="object")for(let C in o)b=b.concat(z({key:C,value:o[C],valueSpec:g[C],style:y,styleSpec:h}));else S!=="string"&&(b=b.concat([new i.V("projection",o,`object or string expected, ${S} found`)]));return b},import:function(m){let{value:o,styleSpec:h}=m,S=o,{data:g}=S,y=yS(S,["data"]);Object.defineProperty(y,"__line__",{value:o.__line__,enumerable:!1});let b=fr(i.o({},m,{value:y,valueSpec:h.import}));return i.u(y.id)===""&&b.push(new i.V(`${m.key}.id`,y,"import id can't be an empty string")),g&&(b=b.concat(Q(g,h,{key:`${m.key}.data`}))),b}};function z(m,o=!1){let h=m.value,g=m.valueSpec,y=m.styleSpec;if(g.expression&&i.H(i.u(h)))return $r(m);if(g.expression&&i.t(i.v(h)))return so(m);if(g.type&&ee[g.type]){let b=ee[g.type](m);return o===!0&&b.length>0&&i.n(m.value)==="array"?so(m):b}return fr(i.o({},m,{valueSpec:g.type?y[g.type]:g}))}function G(m){let o=m.value,h=m.key,g=lo(m);return g.length||(o.indexOf("{fontstack}")===-1&&g.push(new i.V(h,o,'"glyphs" url must include a "{fontstack}" token')),o.indexOf("{range}")===-1&&g.push(new i.V(h,o,'"glyphs" url must include a "{range}" token'))),g}function Q(m,o=i.L,h={}){return z({key:h.key||"",value:m,valueSpec:o.$root,styleSpec:o,style:m,objectElementValidators:{glyphs:G,"*":()=>[]}})}function se(m,o=i.L){return oi(Q(m,o))}let le=m=>oi(Ki(m)),Me=m=>oi(Qa(m)),Ze=m=>oi(Va(m)),ke=m=>oi(ca(m)),We=m=>oi($n(m)),nt=m=>oi(kn(m)),dt=m=>oi(xo(m)),Pt=m=>oi(dn(m)),ti=m=>oi(as(m)),Qt=m=>oi(i.K(m));function oi(m){return m.slice().sort((o,h)=>o.line&&h.line?o.line-h.line:0)}function Ei(m,o){let h=!1;if(o&&o.length)for(let g of o)g instanceof i.m?i.w(g.message):(m.fire(new i.d(new Error(g.message))),h=!0);return h}let Wi=new i.N({anchor:new i.O(i.L.light.anchor),position:new i.Q(i.L.light.position),color:new i.O(i.L.light.color),intensity:new i.O(i.L.light.intensity)});class wi extends i.E{constructor(o,h="flat"){super(),this._transitionable=new i.U(Wi),this.setLight(o,h),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,h,g={}){this._validate(Me,o,g)||(this._transitionable.setTransitionOrValue(o),this.id=h)}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,h,g){return(!g||g.validate!==!1)&&Ei(this,o.call(se,i.W({value:h,style:{glyphs:!0,sprite:!0},styleSpec:i.L})))}}let wr=new i.N({source:new i.O(i.L.terrain.source),exaggeration:new i.O(i.L.terrain.exaggeration)}),dr=class extends i.E{constructor(m,o,h,g){super(),this.scope=h,this._transitionable=new i.U(wr,h,g),this._transitionable.setTransitionOrValue(m,g),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=o}get(){return this._transitionable.serialize()}set(m,o){this._transitionable.setTransitionOrValue(m,o)}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}getExaggeration(m){return this._transitioning.possiblyEvaluate(new i.X(m)).get("exaggeration")}isZoomDependent(){let m=this._transitionable._values.exaggeration;return m!=null&&m.value!=null&&m.value.expression!=null&&m.value.expression instanceof i.Z}},yr=45,xn=65,en=.05;function En(m,o,h,g){let y=i.$(yr,xn,h),[b,S]=On(m,g),C=1-Math.min(1,Math.exp((o-b)/(S-b)*-6));return C*=C*C,C=Math.min(1,1.00747*C),C*y*m.alpha}function On(m,o){let h=.5/Math.tan(.5*o);return[m.range[0]+h,m.range[1]+h]}function sn(m,o,h,g,y){let b=i._.transformMat4([],[o,h,g],y.mercatorFogMatrix);return En(m,i._.length(b),y.pitch,y._fov)}function Fl(m,o,h,g,y,b,S){let C=[[h,g,0],[y,g,0],[y,b,0],[h,b,0]],P=Number.MAX_VALUE,O=-Number.MAX_VALUE;for(let j of C){let X=i._.transformMat4([],j,o),re=i._.length(X);P=Math.min(P,re),O=Math.max(O,re)}return[En(m,P,S.pitch,S._fov),En(m,O,S.pitch,S._fov)]}let oh=new i.N({range:new i.O(i.L.fog.range),color:new i.O(i.L.fog.color),"high-color":new i.O(i.L.fog["high-color"]),"space-color":new i.O(i.L.fog["space-color"]),"horizon-blend":new i.O(i.L.fog["horizon-blend"]),"star-intensity":new i.O(i.L.fog["star-intensity"]),"vertical-range":new i.O(i.L.fog["vertical-range"])});class Zh extends i.E{constructor(o,h,g,y){super(),this._transitionable=new i.U(oh,g,new Map(y)),this.set(o,y),this._transitioning=this._transitionable.untransitioned(),this._transform=h,this.properties=new i.a0(oh),this.scope=g}get state(){let o=this._transform,h=o.projection.name==="globe",g=i.a1(o.zoom),y=this.properties.get("range"),b=[.5,3];return{range:h?[i.a2(b[0],y[0],g),i.a2(b[1],y[1],g)]:y,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,h,g={}){if(this._validate(We,o,g))return;let y=i.W({},o);for(let b of Object.keys(i.L.fog))y[b]===void 0&&(y[b]=i.L.fog[b].default);this._options=y,this._transitionable.setTransitionOrValue(this._options,h)}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;let h=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.$(yr,xn,o))*h.a}getOpacityAtLatLng(o,h){return this._transform.projection.supportsFog?function(g,y,b){let S=i.Y.fromLngLat(y),C=b.elevation?b.elevation.getAtPointOrZero(S):0;return sn(g,S.x,S.y,C,b)}(this.state,o,h):0}getOpacityForTile(o){if(!this._transform.projection.supportsFog)return[1,1];let h=this._transform.calculateFogTileMatrix(o.toUnwrapped());return Fl(this.state,h,0,0,i.a3,i.a3,this._transform)}getOpacityForBounds(o,h,g,y,b){return this._transform.projection.supportsFog?Fl(this.state,o,h,g,y,b,this._transform):[1,1]}getFovAdjustedRange(o){return this._transform.projection.supportsFog?On(this.state,o):[0,1]}isVisibleOnFrustum(o){if(!this._transform.projection.supportsFog)return!1;let h=[4,5,6,7];for(let g of h){let y=o.points[g],b;if(y[2]>=0)b=y;else{let S=o.points[g-4];b=i.a4(S,y,S[2]/(S[2]-y[2]))}if(sn(this.state,b[0],b[1],0,this._transform)>=en)return!0}return!1}updateConfig(o){this._transitionable.setTransitionOrValue(this._options,new Map(o))}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,h,g){return(!g||g.validate!==!1)&&Ei(this,o.call(se,i.W({value:h,style:{glyphs:!0,sprite:!0},styleSpec:i.L})))}}class nc extends i.E{constructor(o,h,g,y){super(),this.scope=g,this._options=o,this.properties=new i.a0(h),this._transitionable=new i.U(h,g,new Map(y)),this._transitionable.setTransitionOrValue(o.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(o){this._transitionable.setTransitionOrValue(this._options.properties,new Map(o))}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(o,h){this._options=o,this._transitionable.setTransitionOrValue(o.properties,h)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}let sr=new i.N({color:new i.O(i.L.properties_light_ambient.color),intensity:new i.O(i.L.properties_light_ambient.intensity)}),Cs=new i.N({direction:new i.a5(i.L.properties_light_directional.direction),color:new i.O(i.L.properties_light_directional.color),intensity:new i.O(i.L.properties_light_directional.intensity),"cast-shadows":new i.O(i.L.properties_light_directional["cast-shadows"]),"shadow-intensity":new i.O(i.L.properties_light_directional["shadow-intensity"])});var Is=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,Oo=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,vec2 pos,vec2 lod_coord) {vec2 size=vec2(textureSize(image,0));vec2 dx=dFdx(lod_coord.xy*size);vec2 dy=dFdy(lod_coord.xy*size);float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,fu=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,sh="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Yh=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture(u_depth,uv-df.xz)),unpack_depth(texture(u_depth,uv+df.xz)),unpack_depth(texture(u_depth,uv-df.zy)),unpack_depth(texture(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,lh=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Kh=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,ch=`#ifdef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Jh=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec4 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=vec2(u_data_offset+dot(t.rg,u_data_scale.yx),-(u_data_offset+dot(t.ba,u_data_scale.yx)));velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,pu=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Wd=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef NATIVE
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;let Oc=[];Ua(Is,Oc),Ua(fu,Oc),Ua(Oo,Oc);let uh={"_prelude_fog.vertex.glsl":lh,"_prelude_terrain.vertex.glsl":Yh,"_prelude_shadow.vertex.glsl":pu,"_prelude_fog.fragment.glsl":Kh,"_prelude_shadow.fragment.glsl":Wd,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":ch,"_prelude_raster_particle.glsl":Jh},qs={};Cr("",Yh),Cr(Kh,lh),Cr(Wd,pu),Cr(ch,""),Cr(Jh,"");let mu=Cr(Oo,fu),gu=Is;var Qh={background:Cr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Cr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Cr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Cr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Cr(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Cr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Cr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in float a_size_scale;in vec2 a_padding;in float a_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(a_z_offset+elevation(a_anchor_pos)),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Cr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Cr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Cr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Cr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Cr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Cr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Cr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
uniform float u_emissive_strength;in float v_height;void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,u_emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=max(0.01,cutoff_opacity(u_cutoff_params,ground.z));if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff < 0.01 && centroid_pos.x !=0.0));gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Cr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Cr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
out vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Cr(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Cr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Cr(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Cr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Cr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform lowp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/clamp(u_trim_fade_range[0],1e-4,1.0)));float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/clamp(u_trim_fade_range[1],1e-4,1.0)));float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=out_color.a;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trim_alpha,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED)
in float a_z_offset;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#if defined(ELEVATED)
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);
#else
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Cr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;float x=mod(pattern_x,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}
#endif
#ifdef LINE_JOIN_NONE
float pattern_len=pattern_size/aspect;float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED)
in float a_z_offset;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#if defined(ELEVATED)
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);
#else
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef LINE_JOIN_NONE
v_width=floorwidth+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Cr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Cr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Cr("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-vec2(1.0),0.0,1.0);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Cr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Cr(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp float speed=velocity==INVALID_VELOCITY ? 0.0 : length(velocity);highp float reset_rate_bump=speed*u_reset_rate;highp vec2 particle_pos_min=-u_particle_pos_offset;highp vec2 particle_pos_max=vec2(1.0)+u_particle_pos_offset;highp vec2 pos_drop_rate=vec2(1.0)-step(particle_pos_min,pos)+step(particle_pos_max,pos);highp float drop_rate=max(u_reset_rate+reset_rate_bump,length(pos_drop_rate));highp float drop=step(1.0-drop_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbolIcon:Cr(`#include "_prelude_lighting.glsl"
uniform sampler2D u_texture;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
in float v_fade_opacity;in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
lowp float alpha=opacity*v_fade_opacity;vec4 out_color;
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
out_color*=alpha;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=globe_occlusion_fade;
#ifdef SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH
occlusion_fade*=occlusionFade(projected_point);
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
v_tex_a=a_tex/u_texsize;
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
v_fade_opacity=out_fade_opacity;
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);v_fade_opacity*=occludedFadeMultiplier;
#endif
}`),symbolSDF:Cr(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;in float v_draw_halo;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=globe_occlusion_fade;
#ifdef SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH
occlusion_fade*=occlusionFade(projected_point);
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}`),symbolTextAndIcon:Cr(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;in float v_draw_halo;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=globe_occlusion_fade;
#ifdef SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH
occlusion_fade*=occlusionFade(projected_point);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+ xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}`),terrainRaster:Cr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Cr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Cr(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,sh),skyboxGradient:Cr(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,sh),skyboxCapture:Cr(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Cr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Cr(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Cr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture(u_depthTexture,coord));return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#else
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Cr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Cr(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),occlusion:Cr("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Ua(m,o){let h=m.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let g of h)if(g=g.trim(),g[0]==="#"&&g.includes("if")&&!g.includes("endif")){g=g.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();let y=g.split(" ");for(let b of y)o.includes(b)||o.push(b)}}function Cr(m,o){let h=/#include\s+"([^"]+)"/g,g=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g,y=o.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);y&&(y=y.map(O=>{let j=O.split(" ");return j[j.length-1]}),y=[...new Set(y)]);let b={},S=[],C=[];if(m=m.replace(h,(O,j)=>(C.push(j),"")),(o=o.replace(h,(O,j)=>(S.push(j),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let P=[...Oc];Ua(m,P),Ua(o,P);for(let O of[...S,...C])uh[O]||console.error(`Undefined include: ${O}`),qs[O]||(qs[O]=[],Ua(uh[O],qs[O])),P=[...P,...qs[O]];return{fragmentSource:m=m.replace(g,(O,j,X,re,ae)=>(b[ae]=!0,j==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
in ${X} ${re} ${ae};
#else
uniform ${X} ${re} u_${ae};
#endif
`:j==="initialize"?`
#ifdef HAS_UNIFORM_u_${ae}
    ${X} ${re} ${ae} = u_${ae};
#endif
`:j==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    in ${X} ${re} ${ae};
#endif
`:j==="initialize-attribute"?"":void 0)),vertexSource:o=o.replace(g,(O,j,X,re,ae)=>{let ue=re==="float"?"vec2":re,he=ae.match(/color/)?"color":ue;return j==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
in ${X} ${re} a_${ae};
#endif
`:b[ae]?j==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
uniform lowp float u_${ae}_t;
in ${X} ${ue} a_${ae};
out ${X} ${re} ${ae};
#else
uniform ${X} ${re} u_${ae};
#endif
`:j==="initialize"?he==="vec4"?`
#ifndef HAS_UNIFORM_u_${ae}
    ${ae} = a_${ae};
#else
    ${X} ${re} ${ae} = u_${ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ae}
    ${ae} = unpack_mix_${he}(a_${ae}, u_${ae}_t);
#else
    ${X} ${re} ${ae} = u_${ae};
#endif
`:j==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    in ${X} ${re} a_${ae};
    out ${X} ${re} ${ae};
#endif
`:j==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    ${ae} = a_${ae};
#endif
`:void 0:j==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
uniform lowp float u_${ae}_t;
in ${X} ${ue} a_${ae};
#else
uniform ${X} ${re} u_${ae};
#endif
`:j==="define-instanced"?he==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${ae}0;
in vec4 a_${ae}1;
in vec4 a_${ae}2;
in vec4 a_${ae}3;
#else
uniform ${X} ${re} u_${ae};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${X} ${ue} a_${ae};
#else
uniform ${X} ${re} u_${ae};
#endif
`:j==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    ${X} ${re} ${ae} = a_${ae};
#endif
`:he==="vec4"?`
#ifndef HAS_UNIFORM_u_${ae}
    ${X} ${re} ${ae} = a_${ae};
#else
    ${X} ${re} ${ae} = u_${ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ae}
    ${X} ${re} ${ae} = unpack_mix_${he}(a_${ae}, u_${ae}_t);
#else
    ${X} ${re} ${ae} = u_${ae};
#endif
`}),staticAttributes:y,usedDefines:P,vertexIncludes:S,fragmentIncludes:C}}class qd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(o,h,g,y,b,S,C,P){this.context=o;let O=this.boundPaintVertexBuffers.length!==y.length;for(let X=0;!O&&X<y.length;X++)this.boundPaintVertexBuffers[X]!==y[X]&&(O=!0);let j=this.boundDynamicVertexBuffers.length!==C.length;for(let X=0;!j&&X<C.length;X++)this.boundDynamicVertexBuffers[X]!==C[X]&&(j=!0);if(!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==g||O||j||this.boundIndexBuffer!==b||this.boundVertexOffset!==S)this.freshBind(h,g,y,b,S,C,P);else{o.bindVertexArrayOES.set(this.vao);for(let X of C)X&&(X.bind(),P&&X.instanceCount&&X.setVertexAttribDivisor(o.gl,h,P));b&&b.dynamicDraw&&b.bind()}}freshBind(o,h,g,y,b,S,C){let P=o.numAttributes,O=this.context,j=O.gl;this.vao&&this.destroy(),this.vao=O.gl.createVertexArray(),O.bindVertexArrayOES.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=y,this.boundVertexOffset=b,this.boundDynamicVertexBuffers=S,h.enableAttributes(j,o),h.bind(),h.setVertexAttribPointers(j,o,b);for(let X of g)X.enableAttributes(j,o),X.bind(),X.setVertexAttribPointers(j,o,b);for(let X of S)X&&(X.enableAttributes(j,o),X.bind(),X.setVertexAttribPointers(j,o,b),C&&X.instanceCount&&X.setVertexAttribDivisor(j,o,C));y&&y.bind(),O.currentNumAttributes=P}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Nr(m,o){let h=Math.pow(2,o.canonical.z),g=o.canonical.y;return[new i.Y(0,g/h).toLngLat().lat,new i.Y(0,(g+1)/h).toLngLat().lat]}function Qf(m,o,h,g,y,b,S){let C=m.context,P=C.gl,O=h.hillshadeFBO;if(!O)return;m.prepareDrawTile();let j=m.isTileAffectedByFog(o),X=m.getOrCreateProgram("hillshade",{overrideFog:j});C.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,O.colorAttachment.get());let re=((fe,me,Le,Oe)=>{let Ne=Le.paint.get("hillshade-shadow-color"),Je=Le.paint.get("hillshade-highlight-color"),Ke=Le.paint.get("hillshade-accent-color"),Pe=Le.paint.get("hillshade-emissive-strength"),Be=i.ab(Le.paint.get("hillshade-illumination-direction"));if(Le.paint.get("hillshade-illumination-anchor")==="viewport")Be-=fe.transform.angle;else if(fe.style&&fe.style.enable3dLights()&&fe.style.directionalLight){let at=fe.style.directionalLight.properties.get("direction"),yt=i.ac(at.x,at.y,at.z);Be=i.ab(yt[1])}let je=!fe.options.moving;return{u_matrix:Oe||fe.transform.calculateProjMatrix(me.tileID.toUnwrapped(),je),u_image:0,u_latrange:Nr(0,me.tileID),u_light:[Le.paint.get("hillshade-exaggeration"),Be],u_shadow:Ne.toRenderColor(Le.lut),u_highlight:Je.toRenderColor(Le.lut),u_emissive_strength:Pe,u_accent:Ke.toRenderColor(Le.lut)}})(m,h,g,m.terrain?o.projMatrix:null);m.uploadCommonUniforms(C,X,o.toUnwrapped());let{tileBoundsBuffer:ae,tileBoundsIndexBuffer:ue,tileBoundsSegments:he}=m.getTileBoundsBuffers(h);X.draw(m,P.TRIANGLES,y,b,S,i.af.disabled,re,g.id,ae,ue,he)}function ed(m,o,h){if(!o.needsDEMTextureUpload)return;let g=m.context,y=g.gl;g.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||m.getTileTexture(h.stride);let b=h.getPixels();o.demTexture?o.demTexture.update(b,{premultiply:!1}):o.demTexture=new i.T(g,b,y.R32F,{premultiply:!1}),o.needsDEMTextureUpload=!1}function co(m,o,h){let g=m.context,y=g.gl;if(!o.dem)return;let b=o.dem;if(g.activeTexture.set(y.TEXTURE1),ed(m,o,b),!o.demTexture)return;o.demTexture.bind(y.NEAREST,y.CLAMP_TO_EDGE);let S=b.dim;g.activeTexture.set(y.TEXTURE0);let C=o.hillshadeFBO;if(!C){let re=new i.T(g,{width:S,height:S,data:null},y.RGBA);re.bind(y.LINEAR,y.CLAMP_TO_EDGE),C=o.hillshadeFBO=g.createFramebuffer(S,S,!0,"renderbuffer"),C.colorAttachment.set(re.texture)}g.bindFramebuffer.set(C.framebuffer),g.viewport.set([0,0,S,S]);let{tileBoundsBuffer:P,tileBoundsIndexBuffer:O,tileBoundsSegments:j}=m.getMercatorTileBoundsBuffers(),X=[];m.linearFloatFilteringSupported()&&X.push("TERRAIN_DEM_FLOAT_FORMAT"),m.getOrCreateProgram("hillshadePrepare",{defines:X}).draw(m,y.TRIANGLES,i.ae.disabled,i.ag.disabled,i.a.unblended,i.af.disabled,((re,ae)=>{let ue=ae.stride,he=i.ad.create();return i.ad.ortho(he,0,i.a3,-i.a3,0,0,1),i.ad.translate(he,he,[0,-i.a3,0]),{u_matrix:he,u_image:1,u_dimension:[ue,ue],u_zoom:re.overscaledZ}})(o.tileID,b),h.id,P,O,j),o.needsHillshadePrepare=!1}function hh(m,o,h,g,y){let b=function(S,C){if(S)return y(S);if(C){if(m.url&&C.tiles&&m.tiles&&delete m.tiles,C.variants){if(!Array.isArray(C.variants))return y(new Error("variants must be an array"));for(let O of C.variants){if(O==null||typeof O!="object"||O.constructor!==Object)return y(new Error("variant must be an object"));if(!Array.isArray(O.capabilities))return y(new Error("capabilities must be an array"));if(O.capabilities.length===1&&O.capabilities[0]==="meshopt"){C=i.W(C,O);break}}}let P=i.ah(i.W(C,m),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);C.vector_layers&&(P.vectorLayers=C.vector_layers,P.vectorLayerIds=P.vectorLayers.map(O=>O.id)),C.raster_layers&&(P.rasterLayers=C.raster_layers,P.rasterLayerIds=P.rasterLayers.map(O=>O.id)),P.tiles=o.canonicalizeTileset(P,m.url),y(null,P)}};return m.url?i.g(o.transformRequest(o.normalizeSourceURL(m.url,null,h,g),i.R.Source),b):i.e.frame(()=>b(null,m))}class Nc{constructor(o,h,g){this.bounds=i.ai.convert(this.validateBounds(o)),this.minzoom=h||0,this.maxzoom=g||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){let h=Math.pow(2,o.z),g=Math.floor(i.aj(this.bounds.getWest())*h),y=Math.floor(i.ak(this.bounds.getNorth())*h),b=Math.ceil(i.aj(this.bounds.getEast())*h),S=Math.ceil(i.ak(this.bounds.getSouth())*h);return o.x>=g&&o.x<b&&o.y>=y&&o.y<S}}class Pl extends i.E{constructor(o,h,g,y){super(),this.id=o,this.dispatcher=g,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.W({type:"raster"},h),i.W(this,i.ah(h,["url","scheme","tileSize"]))}load(o){this._loaded=!1,this.fire(new i.f("dataloading",{dataType:"source"})),this._tileJSONRequest=hh(this._options,this.map._requestManager,null,null,(h,g)=>{this._tileJSONRequest=null,this._loaded=!0,h?this.fire(new i.d(h)):g&&(i.W(this,g),g.bounds&&(this.tileBounds=new Nc(g.bounds,this.minzoom,this.maxzoom)),i.an(g.tiles),this.fire(new i.f("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.f("data",{dataType:"source",sourceDataType:"content"}))),o&&o(h)})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest();let o=i.al(this.id,this.scope);this.load(()=>this.map.style.clearSource(o))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(o){this.cancelTileJSONRequest()}serialize(){return i.W({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,h){let g=i.e.devicePixelRatio>=2,y=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),g,this.tileSize);o.request=i.h(this.map._requestManager.transformRequest(y,i.R.Tile),(b,S,C,P)=>(delete o.request,o.aborted?(o.state="unloaded",h(null)):b?(o.state="errored",h(b)):S?(this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:C,expires:P}),o.setTexture(S,this.map.painter),o.state="loaded",i.am(this.dispatcher),void h(null)):h(null)))}abortTile(o,h){o.request&&(o.request.cancel(),delete o.request),h&&h()}unloadTile(o,h){o.texture&&o.texture instanceof i.T?(o.destroy(!0),o.texture&&o.texture instanceof i.T&&this.map.painter.saveTileTexture(o.texture)):o.destroy(),h&&h()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Bc extends i.E{constructor(o,h,g,y){if(super(),this.id=o,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.W(this,i.ah(h,["url","scheme","tileSize","promoteId"])),this._options=i.W({type:"vector"},h),this._collectResourceTiming=!!h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y),this._tileWorkers={},this._deduped=new i.ao}load(o){this._loaded=!1,this.fire(new i.f("dataloading",{dataType:"source"}));let h=Array.isArray(this.map._language)?this.map._language.join():this.map._language,g=this.map._worldview;this._tileJSONRequest=hh(this._options,this.map._requestManager,h,g,(y,b)=>{this._tileJSONRequest=null,this._loaded=!0,y?(h&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${h}`),g&&g.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${g}`),this.fire(new i.d(y))):b&&(i.W(this,b),b.bounds&&(this.tileBounds=new Nc(b.bounds,this.minzoom,this.maxzoom)),i.an(b.tiles,this.map._requestManager._customAccessToken),this.fire(new i.f("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.f("data",{dataType:"source",sourceDataType:"content"}))),o&&o(y)})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest();let o=i.al(this.id,this.scope);this.load(()=>this.map.style.clearSource(o))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(o){this.cancelTileJSONRequest()}serialize(){return i.W({},this._options)}loadTile(o,h){let g=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),y=this.map._requestManager.transformRequest(g,i.R.Tile),b=this.map.style?this.map.style.getLut(this.scope):null,S={request:y,data:void 0,uid:o.uid,tileID:o.tileID,tileZoom:o.tileZoom,zoom:o.tileID.overscaledZ,lut:b?{image:b.image.clone()}:null,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.e.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:o.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:o.isExtraShadowCaster,tessellationStep:this.map._tessellationStep};if(S.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired")o.state==="loading"?o.reloadCallback=h:o.request=o.actor.send("reloadTile",S,C.bind(this));else if(o.actor=this._tileWorkers[g]=this._tileWorkers[g]||this.dispatcher.getActor(),this.dispatcher.ready)o.request=o.actor.send("loadTile",S,C.bind(this),void 0,!0);else{let P=i.ap.call({deduped:this._deduped},S,(O,j)=>{O||!j?C.call(this,O):(S.data={cacheControl:j.cacheControl,expires:j.expires,rawData:j.rawData.slice(0)},o.actor&&o.actor.send("loadTile",S,C.bind(this),void 0,!0))},!0);o.request={cancel:P}}function C(P,O){return delete o.request,o.aborted?h(null):P&&P.status!==404?h(P):(O&&O.resourceTiming&&(o.resourceTiming=O.resourceTiming),this.map._refreshExpiredTiles&&O&&o.setExpiryData(O),o.loadVectorData(O,this.map.painter),i.am(this.dispatcher),h(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(o,h){o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope}),o.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let ac=m=>({u_matrix:new i.a6(m),u_image0:new i.a7(m),u_skirt_height:new i.aa(m),u_ground_shadow_factor:new i.aq(m)}),hi=(m,o,h)=>({u_matrix:m,u_image0:0,u_skirt_height:o,u_ground_shadow_factor:h}),$d=(m,o,h,g,y,b,S,C,P,O,j,X,re,ae,ue,he)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:o,u_normalize_matrix:Float32Array.from(g),u_merc_matrix:h,u_zoom_transition:y,u_merc_center:b,u_image0:0,u_frustum_tl:S,u_frustum_tr:C,u_frustum_br:P,u_frustum_bl:O,u_globe_pos:j,u_globe_radius:X,u_viewport:re,u_grid_matrix:he?Float32Array.from(he):new Float32Array(9),u_skirt_height:ae,u_far_z_cutoff:ue});class oc{constructor(o=0,h=0,g=0,y=0){if(isNaN(o)||o<0||isNaN(h)||h<0||isNaN(g)||g<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=h,this.left=g,this.right=y}interpolate(o,h,g){return h.top!=null&&o.top!=null&&(this.top=i.a2(o.top,h.top,g)),h.bottom!=null&&o.bottom!=null&&(this.bottom=i.a2(o.bottom,h.bottom,g)),h.left!=null&&o.left!=null&&(this.left=i.a2(o.left,h.left,g)),h.right!=null&&o.right!=null&&(this.right=i.a2(o.right,h.right,g)),this}getCenter(o,h){let g=i.at((this.left+o-this.right)/2,0,o),y=i.at((this.top+h-this.bottom)/2,0,h);return new i.P(g,y)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new oc(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Tr(m,o){let h=i.aw(m,3);i.ad.fromQuat(m,o),i.az(m,3,h)}function va(m,o){let h=i.av.identity([]);return i.av.rotateZ(h,h,-o),i.av.rotateX(h,h,-m),h}function Xd(m,o){let h=[m[0],m[1],0],g=[o[0],o[1],0];if(i._.length(h)>=1e-15){let S=i._.normalize([],h);i._.scale(g,S,i._.dot(g,S)),o[0]=g[0],o[1]=g[1]}let y=i._.cross([],o,m);if(i._.len(y)<1e-15)return null;let b=Math.atan2(-y[1],y[0]);return va(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),b)}class sc{constructor(o,h){this.position=o,this.orientation=h}get position(){return this._position}set position(o){if(o){let h=o instanceof i.Y?o:new i.Y(o[0],o[1],o[2]);this._renderWorldCopies&&(h.x=i.au(h.x,0,1)),this._position=h}else this._position=null}lookAtPoint(o,h){if(this.orientation=null,!this.position)return;let g=this.position,y=this._elevation?this._elevation.getAtPointOrZero(i.Y.fromLngLat(o)):0,b=i.Y.fromLngLat(o,y),S=[b.x-g.x,b.y-g.y,b.z-g.z];h||(h=[0,0,1]),h[2]=Math.abs(h[2]),this.orientation=Xd(S,h)}setPitchBearing(o,h){this.orientation=va(i.ab(o),i.ab(-h))}}class lc{constructor(o,h){this._transform=i.ad.identity([]),this.orientation=h,this.position=o}get mercatorPosition(){let o=this.position;return new i.Y(o[0],o[1],o[2])}get position(){let o=i.aw(this._transform,3);return[o[0],o[1],o[2]]}set position(o){var h;o&&i.az(this._transform,3,[(h=o)[0],h[1],h[2],1])}get orientation(){return this._orientation}set orientation(o){this._orientation=o||i.av.identity([]),o&&Tr(this._transform,this._orientation)}getPitchBearing(){let o=this.forward(),h=this.right();return{bearing:Math.atan2(-h[1],h[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,h){this._orientation=va(o,h),Tr(this._transform,this._orientation)}forward(){let o=i.aw(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){let o=i.aw(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){let o=i.aw(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,h){let g=new Float64Array(16);return i.ad.invert(g,this.getWorldToCamera(o,h)),g}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(o,h,g){let y=this.position;i._.scale(y,y,-o);let b=new Float64Array(16);return i.ad.fromScaling(b,[g,g,g]),i.ad.translate(b,b,y),b[10]*=h,b}getWorldToCamera(o,h){let g=new Float64Array(16),y=new Float64Array(4),b=this.position;return i.av.conjugate(y,this._orientation),i._.scale(b,b,-o),i.ad.fromQuat(g,y),i.ad.translate(g,g,b),g[1]*=-1,g[5]*=-1,g[9]*=-1,g[13]*=-1,g[8]*=h,g[9]*=h,g[10]*=h,g[11]*=h,g}getCameraToClipPerspective(o,h,g,y){let b=new Float64Array(16);return i.ad.perspective(b,o,h,g,y),b}getCameraToClipOrthographic(o,h,g,y,b,S){let C=new Float64Array(16);return i.ad.ortho(C,o,h,g,y,b,S),C}getDistanceToElevation(o,h=!1){let g=o===0?0:i.ax(o,h?i.ay(this.position[1]):this.position[1]),y=this.forward();return(g-this.position[2])/y[2]}clone(){return new lc([...this.position],[...this.orientation])}}let dl={unknown:0,flipRequired:1,flipNotRequired:2},lr=Math.tan(85*Math.PI/180);function Ll(m,o,h,g,y,b,S){let C=i.ad.create();if(h)if(b.name==="globe"){let P=i.aB(y,o);i.ad.multiply(C,C,P)}else{let P=i.aC.invert([],S);C[0]=P[0],C[1]=P[1],C[4]=P[2],C[5]=P[3],g||i.ad.rotateZ(C,C,y.angle)}else i.ad.multiply(C,y.labelPlaneMatrix,m);return C}function Rl(m,o,h,g,y,b,S){let C=Ll(m,o,h,g,y,b,S);return b.name==="globe"&&h||(C[2]=C[6]=C[10]=C[14]=0),C}function cc(m,o,h,g,y,b,S){if(h){if(b.name==="globe"){let C=Ll(m,o,h,g,y,b,S);return i.ad.invert(C,C),i.ad.multiply(C,m,C),C}{let C=i.ad.clone(m),P=i.ad.identity([]);return P[0]=S[0],P[1]=S[1],P[4]=S[2],P[5]=S[3],i.ad.multiply(C,C,P),g||i.ad.rotateZ(C,C,-y.angle),C}}return y.glCoordMatrix}function eo(m,o,h,g){let y=[m,o,h,1];h?i.aA.transformMat4(y,y,g):ss(y,y,g);let b=y[3];return y[0]/=b,y[1]/=b,y[2]/=b,y}function ya(m,o){return Math.min(.5+m/o*.5,1.5)}function ep(m,o){let h=m[0]/m[3],g=m[1]/m[3];return h>=-o[0]&&h<=o[0]&&g>=-o[1]&&g<=o[1]}function fl(m,o,h,g,y,b,S,C,P,O){let j=h.transform,X=g?m.textSizeData:m.iconSizeData,re=i.aD(X,h.transform.zoom),ae=j.projection.name==="globe",ue=[256/h.width*2+1,256/h.height*2+1],he=g?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;he.clear();let fe=null;ae&&(fe=g?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);let me=m.lineVertexArray,Le=g?m.text.placedSymbolArray:m.icon.placedSymbolArray,Oe=h.transform.width/h.transform.height,Ne,Je=!1;for(let Ke=0;Ke<Le.length;Ke++){let Pe=Le.get(Ke),{numGlyphs:Be,writingMode:je}=Pe;if(je!==i.aE.vertical||Je||Ne===i.aE.horizontal||(Je=!0),Ne=je,(Pe.hidden||je===i.aE.vertical)&&!Je){pl(Be,he);continue}Je=!1;let at=new i.P(Pe.tileAnchorX,Pe.tileAnchorY),{x:yt,y:qe,z:bt}=j.projection.projectTilePoint(at.x,at.y,O.canonical);if(P){let[Ai,mi,Yt]=P(at);yt+=Ai,qe+=mi,bt+=Yt}let Ct=[yt,qe,bt,1];if(i.aA.transformMat4(Ct,Ct,o),!ep(Ct,ue)){pl(Be,he);continue}let Ht=Ct[3],qt=ya(h.transform.getCameraToCenterDistance(j.projection),Ht),Ut=i.aF(X,re,Pe),ft=S?Ut/qt:Ut*qt,kt=eo(yt,qe,bt,y);if(kt[3]<=0){pl(Be,he);continue}let jt={},di=S?null:P,pi=uc(Pe,ft,!1,C,o,y,b,m.glyphOffsetArray,me,he,fe,kt,at,jt,Oe,di,j.projection,O,S);Je=pi.useVertical,di&&pi.needsFlipping&&(jt={}),(pi.notEnoughRoom||Je||pi.needsFlipping&&uc(Pe,ft,!0,C,o,y,b,m.glyphOffsetArray,me,he,fe,kt,at,jt,Oe,di,j.projection,O,S).notEnoughRoom)&&pl(Be,he)}g?(m.text.dynamicLayoutVertexBuffer.updateData(he),fe&&m.text.globeExtVertexBuffer&&m.text.globeExtVertexBuffer.updateData(fe)):(m.icon.dynamicLayoutVertexBuffer.updateData(he),fe&&m.icon.globeExtVertexBuffer&&m.icon.globeExtVertexBuffer.updateData(fe))}function os(m,o,h,g,y,b,S,C,P,O,j,X,re,ae,ue,he){let{lineStartIndex:fe,glyphStartIndex:me,segment:Le}=C,Oe=me+C.numGlyphs,Ne=fe+C.lineLength,Je=o.getoffsetX(me),Ke=o.getoffsetX(Oe-1),Pe=zc(m*Je,h,g,y,b,S,Le,fe,Ne,P,O,j,X,re,!0,ae,ue,he);if(!Pe)return null;let Be=zc(m*Ke,h,g,y,b,S,Le,fe,Ne,P,O,j,X,re,!0,ae,ue,he);return Be?{first:Pe,last:Be}:null}function _u(m,o,h,g){return m===i.aE.horizontal&&Math.abs(g)>Math.abs(h)?{useVertical:!0}:m===i.aE.vertical?g>0?{needsFlipping:!0}:null:o!==dl.unknown&&function(y,b){return y===0||Math.abs(b/y)>lr}(h,g)?o===dl.flipRequired?{needsFlipping:!0}:null:h<0?{needsFlipping:!0}:null}function uc(m,o,h,g,y,b,S,C,P,O,j,X,re,ae,ue,he,fe,me,Le){let Oe=o/24,Ne=m.lineOffsetX*Oe,Je=m.lineOffsetY*Oe,{lineStartIndex:Ke,glyphStartIndex:Pe,numGlyphs:Be,segment:je,writingMode:at,flipState:yt}=m,qe=Ke+m.lineLength,bt=Ct=>{if(j){let[ft,kt,jt]=Ct.up,di=O.length;i.aG(j,di+0,ft,kt,jt),i.aG(j,di+1,ft,kt,jt),i.aG(j,di+2,ft,kt,jt),i.aG(j,di+3,ft,kt,jt)}let[Ht,qt,Ut]=Ct.point;i.aH(O,Ht,qt,Ut,Ct.angle)};if(Be>1){let Ct=os(Oe,C,Ne,Je,h,X,re,m,P,b,ae,he,!1,fe,me,Le);if(!Ct)return{notEnoughRoom:!0};if(g&&!h){let[Ht,qt,Ut]=Ct.first.point,[ft,kt,jt]=Ct.last.point;[Ht,qt]=eo(Ht,qt,Ut,S),[ft,kt]=eo(ft,kt,jt,S);let di=_u(at,yt,(ft-Ht)*ue,kt-qt);if(m.flipState=di&&di.needsFlipping?dl.flipRequired:dl.flipNotRequired,di)return di}bt(Ct.first);for(let Ht=Pe+1;Ht<Pe+Be-1;Ht++){let qt=zc(Oe*C.getoffsetX(Ht),Ne,Je,h,X,re,je,Ke,qe,P,b,ae,he,!1,!1,fe,me,Le);if(!qt)return O.length-=4*(Ht-Pe),{notEnoughRoom:!0};bt(qt)}bt(Ct.last)}else{if(g&&!h){let Ht=eo(re.x,re.y,0,y),qt=Ke+je+1,Ut=new i.P(P.getx(qt),P.gety(qt)),ft=eo(Ut.x,Ut.y,0,y),kt=ft[3]>0?ft:Ol(re,Ut,Ht,1,y,void 0,fe,me.canonical),jt=_u(at,yt,(kt[0]-Ht[0])*ue,kt[1]-Ht[1]);if(m.flipState=jt&&jt.needsFlipping?dl.flipRequired:dl.flipNotRequired,jt)return jt}let Ct=zc(Oe*C.getoffsetX(Pe),Ne,Je,h,X,re,je,Ke,qe,P,b,ae,he,!1,!1,fe,me,Le);if(!Ct)return{notEnoughRoom:!0};bt(Ct)}return{}}function dh(m,o,h,g,y){let{x:b,y:S,z:C}=g.projectTilePoint(m.x,m.y,o);if(!y)return eo(b,S,C,h);let[P,O,j]=y(m);return eo(b+P,S+O,C+j,h)}function Ol(m,o,h,g,y,b,S,C){let P=dh(m.sub(o)._unit()._add(m),C,y,S,b);return i._.sub(P,h,P),i._.normalize(P,P),i._.scaleAndAdd(P,h,P,g)}function zc(m,o,h,g,y,b,S,C,P,O,j,X,re,ae,ue,he,fe,me){let Le=g?m-o:m+o,Oe=Le>0?1:-1,Ne=0;g&&(Oe*=-1,Ne=Math.PI),Oe<0&&(Ne+=Math.PI);let Je=C+S+(Oe>0?0:1)|0,Ke=y,Pe=y,Be=0,je=0,at=Math.abs(Le),yt=[],qe=[],bt=b,Ct=bt,Ht=()=>Ol(Ct,bt,Pe,at-Be+1,j,re,he,fe.canonical);for(;Be+je<=at;){if(Je+=Oe,Je<C||Je>=P)return null;if(Pe=Ke,Ct=bt,yt.push(Pe),ae&&qe.push(Ct),bt=new i.P(O.getx(Je),O.gety(Je)),Ke=X[Je],!Ke){let mi=dh(bt,fe.canonical,j,he,re);Ke=mi[3]>0?X[Je]=mi:Ht()}Be+=je,je=i._.distance(Pe,Ke)}ue&&re&&(X[Je]&&(Ke=Ht(),je=i._.distance(Pe,Ke)),X[Je]=Ke);let qt=(at-Be)/je,Ut=bt.sub(Ct)._mult(qt)._add(Ct),ft=i._.sub([],Ke,Pe),kt=i._.scaleAndAdd([],Pe,ft,qt),jt=[0,0,1],di=ft[0],pi=ft[1];if(me&&(jt=he.upVector(fe.canonical,Ut.x,Ut.y),jt[0]!==0||jt[1]!==0||jt[2]!==1)){let mi=[jt[2],0,-jt[0]],Yt=i._.cross([],jt,mi);i._.normalize(mi,mi),i._.normalize(Yt,Yt),di=i._.dot(ft,mi),pi=i._.dot(ft,Yt)}if(h){let mi=i._.cross([],jt,ft);i._.normalize(mi,mi),i._.scaleAndAdd(kt,kt,mi,h*Oe)}let Ai=Ne+Math.atan2(pi,di);return yt.push(kt),ae&&qe.push(Ut),{point:kt,angle:Ai,path:yt,tilePath:qe,up:jt}}function pl(m,o){let h=o.length,g=h+4*m;o.resize(g),o.float32.fill(-1/0,4*h,4*g)}function ss(m,o,h){let g=o[0],y=o[1];return m[0]=h[0]*g+h[4]*y+h[12],m[1]=h[1]*g+h[5]*y+h[13],m[3]=h[3]*g+h[7]*y+h[15],m}let fh=(m,o,h)=>(1-h)*m+h*o,Nn=m=>m*m*m*m*m;class ls{constructor(o,h,g,y,b,S,C){this.tileSize=512,this._renderWorldCopies=b===void 0||b,this._minZoom=o||0,this._maxZoom=h||22,this._minPitch=g??0,this._maxPitch=y??60,this.setProjection(S),this.setMaxBounds(C),this.width=0,this.height=0,this._center=new i.aI(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new oc,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new lc,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){let o=new ls(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,o.tileSize=this.tileSize,o.mercatorFromTransition=this.mercatorFromTransition,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._seaLevelZoom=this._seaLevelZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o.frustumCorners=this.frustumCorners,o}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(o,h=!1){let g=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||g)&&this._updateCameraOnTerrain(),(o||g)&&this._constrainCamera(h),this._calcMatrices()}getProjection(){return i.ah(this.projection,["name","center","parallels"])}setProjection(o){this.projectionOptions=o||{name:"mercator"};let h=this.projection?this.getProjection():void 0;this.projection=i.aJ(this.projectionOptions);let g=!x(h,this.getProjection());return g&&this._calcMatrices(),this.mercatorFromTransition=!1,g}setOrthographicProjectionAtLowPitch(o){return this._orthographicProjectionAtLowPitch!==o&&(this._orthographicProjectionAtLowPitch=o,this._calcMatrices(),!0)}setMercatorFromTransition(){let o=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.aJ({name:"mercator"});let h=o!==this.projection.name;return h&&this._calcMatrices(),h}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){let o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get cameraWorldSize(){let o=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.ax(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.au(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){let h=-o*Math.PI/180;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=i.aC.create(),i.aC.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){let h=i.at(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){let o=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/o)}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=i.ab(o),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(o){let h=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._setZoom(h),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(o){this._tileCoverLift!==o&&(this._tileCoverLift=o)}_updateCameraOnTerrain(){let o=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,h=this.elevation&&o===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||o===Number.NEGATIVE_INFINITY&&(!h||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);let g=this._elevation;h||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&g.exaggeration()&&this._centerAltitudeValidForExaggeration!==g.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*g.exaggeration(),this._centerAltitudeValidForExaggeration=g.exaggeration()):(this._centerAltitude=o||0,this._centerAltitudeValidForExaggeration=g.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;let o=this._elevation,h=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],g=this.horizonLineFromTop(),y=0,b=0;for(let S=0;S<h.length;S++){let C=new i.P(h[S][0]*this.width,g+h[S][1]*(this.height-g)),P=o.pointCoordinate(C);if(!P)continue;let O=1/Math.hypot(P[0]-this._camera.position[0],P[1]-this._camera.position[1]);y+=P[3]*O,b+=O}return b===0?NaN:y/b}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;let o=this._seaLevelZoom,h=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),g=this.pixelsPerMeter/this.worldSize*h,y=this._mercatorZfromZoom(o),b=this._mercatorZfromZoom(this._maxZoom),S=Math.max(y-g,b);this._setZoom(this._zoomFromMercatorZ(S))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){let h=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude())),g;g=o.z<this._camera.position[2]?[h.x,h.y,h.z]:[o.x,o.y,o.z];let y=i._.length(i._.sub([],this._camera.position,g));return i.at(this._zoomFromMercatorZ(y),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let h=!1;if(o.orientation&&!i.av.exactEquals(o.orientation,this._camera.orientation)&&(h=this._setCameraOrientation(o.orientation)),o.position){let g=[o.position.x,o.position.y,o.position.z];i._.exactEquals(g,this._camera.position)||(this._setCameraPosition(g),h=!0)}h&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();let o=this._camera.position,h=new sc;return h.position=new i.Y(o[0],o[1],o[2]),h.orientation=this._camera.orientation,h._elevation=this.elevation,h._renderWorldCopies=this.renderWorldCopies,h}_setCameraOrientation(o){if(!i.av.length(o))return!1;i.av.normalize(o,o);let h=i._.transformQuat([],[0,0,-1],o),g=i._.transformQuat([],[0,-1,0],o);if(g[2]<0)return!1;let y=Xd(h,g);return!!y&&(this._camera.orientation=y,!0)}_setCameraPosition(o){let h=this.zoomScale(this.minZoom)*this.tileSize,g=this.zoomScale(this.maxZoom)*this.tileSize,y=this.cameraToCenterDistance;o[2]=i.at(o[2],y/g,y/h),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,h,g){this._unmodified=!1,this._edgeInsets.interpolate(o,h,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){let h=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(o){let h=[new i.aK(0,o)];if(this.renderWorldCopies){let g=this.pointCoordinate(new i.P(0,0)),y=this.pointCoordinate(new i.P(this.width,0)),b=this.pointCoordinate(new i.P(this.width,this.height)),S=this.pointCoordinate(new i.P(0,this.height)),C=Math.floor(Math.min(g.x,y.x,b.x,S.x)),P=Math.floor(Math.max(g.x,y.x,b.x,S.x)),O=1;for(let j=C-O;j<=P+O;j++)j!==0&&h.push(new i.aK(j,o))}return h}isLODDisabled(o){return(!o||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(o,h,g){let y=[];if(h[0]===0&&h[1]===0)return y;for(let S of o){let C=S.canonical,P=S.overscaledZ,O=S.wrap,j=1<<C.z,X=C.x+1<j,re=C.x>0,ae=C.y+1<j,ue=C.y>0,he=S.wrap-(re?0:1),fe=S.wrap+(X?0:1),me=re?C.x-1:j-1,Le=X?C.x+1:0;h[0]<0?(y.push(new i.aL(P,fe,C.z,Le,C.y)),h[1]<0&&ae&&(y.push(new i.aL(P,O,C.z,C.x,C.y+1)),y.push(new i.aL(P,fe,C.z,Le,C.y+1))),h[1]>0&&ue&&(y.push(new i.aL(P,O,C.z,C.x,C.y-1)),y.push(new i.aL(P,fe,C.z,Le,C.y-1)))):h[0]>0?(y.push(new i.aL(P,he,C.z,me,C.y)),h[1]<0&&ae&&(y.push(new i.aL(P,O,C.z,C.x,C.y+1)),y.push(new i.aL(P,he,C.z,me,C.y+1))),h[1]>0&&ue&&(y.push(new i.aL(P,O,C.z,C.x,C.y-1)),y.push(new i.aL(P,he,C.z,me,C.y-1)))):h[1]<0&&ae?y.push(new i.aL(P,O,C.z,C.x,C.y+1)):ue&&y.push(new i.aL(P,O,C.z,C.x,C.y-1))}if(y.length>1){y.sort((P,O)=>P.overscaledZ-O.overscaledZ||P.wrap-O.wrap||P.canonical.z-O.canonical.z||P.canonical.x-O.canonical.x||P.canonical.y-O.canonical.y);let S=0,C=0;for(;C<y.length;)y[C].equals(y[S])?++C:y[++S]=y[C++];y.length=S+1}let b=[];for(let S of y)y.some(C=>S.isChildOf(C))||b.push(S);return y=b.filter(S=>!o.some(C=>!!(S.overscaledZ<g&&C.isChildOf(S))||S.equals(C)||S.isChildOf(C))),y}coveringTiles(o){let h=this.coveringZoomLevel(o),g=h,y=this.elevation&&this.elevation.exaggeration(),b=y&&!o.isTerrainDEM,S=this.projection.name==="mercator";if(o.minzoom!==void 0&&h<o.minzoom)return[];o.maxzoom!==void 0&&h>o.maxzoom&&(h=o.maxzoom);let C=this.locationCoordinate(this.center),P=this.center.lat,O=1<<h,j=[O*C.x,O*C.y,0],X=this.projection.name==="globe",re=!X,ae=i.aM.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h,re),ue=X?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),he=O*i.ax(1,this.center.lat),fe=this._camera.position[2]/i.ax(1,this.center.lat),me=[O*ue.x,O*ue.y,fe*(re?1:he)],Le=X||y,Oe=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),Ne=this.isLODDisabled(!0)?h:0,Je;if(this._elevation&&o.isTerrainDEM)Je=1e4*this._elevation.exaggeration();else if(this._elevation){let ft=this._elevation.getMinMaxForVisibleTiles();Je=ft?ft.max:this._centerAltitude}else Je=this._centerAltitude;let Ke=o.isTerrainDEM?-Je:this._elevation?this._elevation.getMinElevationBelowMSL():0,Pe=this.projection.isReprojectedInTileSpace?i.aN(this):1,Be=ft=>{let jt=new i.Y(ft.x+25e-6,ft.y,ft.z),di=new i.Y(ft.x,ft.y+25e-6,ft.z),pi=ft.toLngLat(),Ai=jt.toLngLat(),mi=di.toLngLat(),Yt=this.locationCoordinate(pi),Nt=this.locationCoordinate(Ai),Li=this.locationCoordinate(mi),pr=Math.hypot(Nt.x-Yt.x,Nt.y-Yt.y),nr=Math.hypot(Li.x-Yt.x,Li.y-Yt.y);return Math.sqrt(pr*nr)*Pe/25e-6},je=ft=>{let kt=Je,jt=Ke;return{aabb:i.aQ(this,O,0,0,0,ft,jt,kt,this.projection),zoom:0,x:0,y:0,minZ:jt,maxZ:kt,wrap:ft,fullyVisible:!1}},at=[],yt=[],qe=h,bt=o.reparseOverscaled?g:h,Ct=ft=>ft*ft,Ht=Ct((fe-this._centerAltitude)*he),qt=ft=>{if(!this._elevation||!ft.tileID||!S)return;let kt=this._elevation.getMinMaxForTile(ft.tileID),jt=ft.aabb;kt?(jt.min[2]=kt.min,jt.max[2]=kt.max,jt.center[2]=(jt.min[2]+jt.max[2])/2):(ft.shouldSplit=Ut(ft),ft.shouldSplit||(jt.min[2]=jt.max[2]=jt.center[2]=this._centerAltitude))},Ut=ft=>{if(ft.zoom<Ne)return!0;if(ft.zoom===qe)return!1;if(ft.shouldSplit!=null)return ft.shouldSplit;let kt=ft.aabb.distanceX(me),jt=ft.aabb.distanceY(me),di=Ht,pi=1;if(X){di=Ct(ft.aabb.distanceZ(me));let Yt=Math.pow(2,ft.zoom),Nt=i.ay((ft.y+1)/Yt),Li=i.ay(ft.y/Yt),pr=Math.min(Math.max(P,Nt),Li),nr=i.b4(pr)/i.b4(P);if(pi=pr===P?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,nr/this._mercatorScaleRatio),this.zoom<=i.b1&&ft.zoom===qe-1&&nr>=.9)return!0}else if(b&&(di=Ct(ft.aabb.distanceZ(me)*he)),this.projection.isReprojectedInTileSpace&&g<=5){let Yt=Math.pow(2,ft.zoom),Nt=Be(new i.Y((ft.x+.5)/Yt,(ft.y+.5)/Yt));pi=Nt>.85?1:Nt}let Ai=kt*kt+jt*jt+di,mi=Ct((1<<qe-ft.zoom)*Oe*pi*((Yt,Nt)=>{if(Nt*Ct(.707)<Yt)return 1;let Li=Math.sqrt(Nt/Yt);return Li/(1.4144271570014144+(Math.pow(1.1,Li-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(di,Ht),Ai));return Ai<mi};if(this.renderWorldCopies)for(let ft=1;ft<=3;ft++)at.push(je(-ft)),at.push(je(ft));for(at.push(je(0));at.length>0;){let ft=at.pop(),kt=ft.x,jt=ft.y,di=ft.fullyVisible,pi=()=>this.projection.name==="globe"&&(ft.y===0||ft.y===(1<<ft.zoom)-1);if(!di){let Ai=Le?ft.aabb.intersects(ae):ft.aabb.intersectsFlat(ae);if(Ai===0&&pi()){let mi=new i.aO(ft.zoom,kt,jt);Ai=i.aP(this,O,mi,!0).intersects(ae)}if(Ai===0)continue;di=Ai===2}if(ft.zoom!==qe&&Ut(ft))for(let Ai=0;Ai<4;Ai++){let mi=(kt<<1)+Ai%2,Yt=(jt<<1)+(Ai>>1),Nt={aabb:S?ft.aabb.quadrant(Ai):i.aQ(this,O,ft.zoom+1,mi,Yt,ft.wrap,ft.minZ,ft.maxZ,this.projection),zoom:ft.zoom+1,x:mi,y:Yt,wrap:ft.wrap,fullyVisible:di,tileID:void 0,shouldSplit:void 0,minZ:ft.minZ,maxZ:ft.maxZ};b&&!X&&(Nt.tileID=new i.aL(ft.zoom+1===qe?bt:ft.zoom+1,ft.wrap,ft.zoom+1,mi,Yt),qt(Nt)),at.push(Nt)}else{let Ai=ft.zoom===qe?bt:ft.zoom;if(o.minzoom&&o.minzoom>Ai)continue;if(!di){let Li=Le?ft.aabb.intersectsPrecise(ae):ft.aabb.intersectsPreciseFlat(ae);if(Li===0&&pi()){let pr=new i.aO(ft.zoom,kt,jt);Li=i.aP(this,O,pr,!0).intersectsPrecise(ae)}if(Li===0)continue}let mi=j[0]-(.5+kt+(ft.wrap<<ft.zoom))*(1<<h-ft.zoom),Yt=j[1]-.5-jt,Nt=ft.tileID?ft.tileID:new i.aL(Ai,ft.wrap,ft.zoom,kt,jt);yt.push({tileID:Nt,distanceSq:mi*mi+Yt*Yt})}}if(this.fogCullDistSq){let ft=this.fogCullDistSq,kt=this.horizonLineFromTop();yt=yt.filter(jt=>{let di=[0,0,0,1],pi=[i.a3,i.a3,0,1],Ai=this.calculateFogTileMatrix(jt.tileID.toUnwrapped());i.aA.transformMat4(di,di,Ai),i.aA.transformMat4(pi,pi,Ai);let mi=i.aA.min([],di,pi),Yt=i.aA.max([],di,pi),Nt=i.aR(mi,Yt);if(Nt===0)return!0;let Li=!1,pr=this._elevation;if(pr&&Nt>ft&&kt!==0){let nr=this.calculateProjMatrix(jt.tileID.toUnwrapped()),Ir;o.isTerrainDEM||(Ir=pr.getMinMaxForTile(jt.tileID)),Ir||(Ir={min:Ke,max:Je});let Ur=i.b2(this.rotation),un=[Ur[0]*i.a3,Ur[1]*i.a3,Ir.max];i._.transformMat4(un,un,nr),Li=(1-un[1])*this.height*.5<kt}return Nt<ft||Li})}return yt.sort((ft,kt)=>ft.distanceSq-kt.distanceSq).map(ft=>ft.tileID)}resize(o,h){this.width=o,this.height=h,this.pixelsToGLUnits=[2/o,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){let h=i.at(o.lat,-i.aS,i.aS),g=this.projection.project(o.lng,h);return new i.P(g.x*this.worldSize,g.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.ax(1,this.center.lat)/this.worldSize}setLocationAtPoint(o,h){let g,y,b=this.centerPoint;if(this.projection.name==="globe"){let C=this.worldSize;g=(h.x-b.x)/C,y=(h.y-b.y)/C}else{let C=this.pointCoordinate(h),P=this.pointCoordinate(b);g=C.x-P.x,y=C.y-P.y}let S=this.locationCoordinate(o);this.setLocation(new i.Y(S.x-g,S.y-y))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o){return this.projection.locationPoint(this,o)}locationPoint3D(o){return this.projection.locationPoint(this,o,!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o){return this.coordinateLocation(this.pointCoordinate3D(o))}locationCoordinate(o,h){let g=h?i.ax(h,o.lat):void 0,y=this.projection.project(o.lng,o.lat);return new i.Y(y.x,y.y,g)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,h){let g=h??this._centerAltitude,y=[o.x,o.y,0,1],b=[o.x,o.y,1,1];i.aA.transformMat4(y,y,this.pixelMatrixInverse),i.aA.transformMat4(b,b,this.pixelMatrixInverse);let S=b[3];i.aA.scale(y,y,1/y[3]),i.aA.scale(b,b,1/S);let C=y[2],P=b[2];return{p0:y,p1:b,t:C===P?0:(g-C)/(P-C)}}screenPointToMercatorRay(o){let h=[o.x,o.y,0,1],g=[o.x,o.y,1,1];return i.aA.transformMat4(h,h,this.pixelMatrixInverse),i.aA.transformMat4(g,g,this.pixelMatrixInverse),i.aA.scale(h,h,1/h[3]),i.aA.scale(g,g,1/g[3]),h[2]=i.ax(h[2],this._center.lat)*this.worldSize,g[2]=i.ax(g[2],this._center.lat)*this.worldSize,i.aA.scale(h,h,1/this.worldSize),i.aA.scale(g,g,1/this.worldSize),new i.aT([h[0],h[1],h[2]],i._.normalize([],i._.sub([],g,h)))}rayIntersectionCoordinate(o){let{p0:h,p1:g,t:y}=o,b=i.ax(h[2],this._center.lat),S=i.ax(g[2],this._center.lat);return new i.Y(i.a2(h[0],g[0],y)/this.worldSize,i.a2(h[1],g[1],y)/this.worldSize,i.a2(b,S,y))}pointCoordinate(o,h=this._centerAltitude){return this.projection.pointCoordinate(this,o.x,o.y,h)}pointCoordinate3D(o){if(!this.elevation)return this.pointCoordinate(o);let h=this.projection.pointCoordinate3D(this,o.x,o.y);if(h)return new i.Y(h[0],h[1],h[2]);let g=0,y=this.horizonLineFromTop();if(o.y>y)return this.pointCoordinate(o);let b=.02*y,S=o.clone();for(let C=0;C<10&&y-g>b;C++){S.y=i.a2(g,y,.66);let P=this.projection.pointCoordinate3D(this,S.x,S.y);P?(y=S.y,h=P):g=S.y}return h?new i.Y(h[0],h[1],h[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){return this.projection.isPointAboveHorizon(this,o)}isPointOnSurface(o){if(o.y<0||o.y>this.height||o.x<0||o.x>this.width)return!1;if(this.elevation||this.zoom>=i.aU)return!this.isPointAboveHorizon(o);let h=this.pointCoordinate(o);return h.y>=0&&h.y<=1}_coordinatePoint(o,h){let g=h&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,y=[o.x*this.worldSize,o.y*this.worldSize,g+o.toAltitude(),1];return i.aA.transformMat4(y,y,this.pixelMatrix),y[3]>0?new i.P(y[0]/y[3],y[1]/y[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){let{top:o,left:h}=this._edgeInsets,g=this.height-this._edgeInsets.bottom,y=this.width-this._edgeInsets.right,b=this.pointLocation3D(new i.P(h,o)),S=this.pointLocation3D(new i.P(y,o)),C=this.pointLocation3D(new i.P(y,g)),P=this.pointLocation3D(new i.P(h,g)),O=Math.min(b.lng,S.lng,C.lng,P.lng),j=Math.max(b.lng,S.lng,C.lng,P.lng),X=Math.min(b.lat,S.lat,C.lat,P.lat),re=Math.max(b.lat,S.lat,C.lat,P.lat),ae=Math.pow(2,-this.zoom)/16*270,ue=this.projection.name==="globe"?1:4,he=(fe,me,Le,Oe,Ne)=>{let Je=(fe+Le)/2,Ke=(me+Oe)/2,Pe=new i.P(Je,Ke),{lng:Be,lat:je}=this.pointLocation3D(Pe),at=Math.max(0,O-Be,X-je,Be-j,je-re);O=Math.min(O,Be),j=Math.max(j,Be),X=Math.min(X,je),re=Math.max(re,je),(Ne<ue||at>ae)&&(he(fe,me,Je,Ke,Ne+1),he(Je,Ke,Le,Oe,Ne+1))};if(he(h,o,y,o,1),he(y,o,y,g,1),he(y,g,h,g,1),he(h,g,h,o,1),this.projection.name==="globe"){let[fe,me]=i.aV(this);fe?(re=90,j=180,O=-180):me&&(X=-90,j=180,O=-180)}return new i.ai(new i.aI(O,X),new i.aI(j,re))}_getBoundsRectangular(o,h){let{top:g,left:y}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,C=new i.P(y,g),P=new i.P(S,g),O=new i.P(S,b),j=new i.P(y,b),X=this.pointCoordinate(C,o),re=this.pointCoordinate(P,o),ae=this.pointCoordinate(O,h),ue=this.pointCoordinate(j,h),he=(fe,me)=>(me.y-fe.y)/(me.x-fe.x);return X.y>1&&re.y>=0?X=new i.Y((1-ue.y)/he(ue,X)+ue.x,1):X.y<0&&re.y<=1&&(X=new i.Y(-ue.y/he(ue,X)+ue.x,0)),re.y>1&&X.y>=0?re=new i.Y((1-ae.y)/he(ae,re)+ae.x,1):re.y<0&&X.y<=1&&(re=new i.Y(-ae.y/he(ae,re)+ae.x,0)),new i.ai().extend(this.coordinateLocation(X)).extend(this.coordinateLocation(re)).extend(this.coordinateLocation(ue)).extend(this.coordinateLocation(ae))}_getBoundsRectangularTerrain(){let o=this.elevation;if(!o.visibleDemTiles.length||o.isUsingMockSource())return this._getBoundsRectangular(0,0);let h=o.visibleDemTiles.reduce((g,y)=>{if(y.dem){let b=y.dem.tree;g.min=Math.min(g.min,b.minimums[0]),g.max=Math.max(g.max,b.maximums[0])}return g},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(h.min*o.exaggeration(),h.max*o.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(o=!0){let h=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,g=this.height/2-h*(1-this._horizonShift);return o?Math.max(0,g):g}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-i.aS,this.maxLat=i.aS,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.aj(this.minLng)*this.tileSize,this.worldMaxX=i.aj(this.maxLng)*this.tileSize,this.worldMinY=i.ak(this.maxLat)*this.tileSize,this.worldMaxY=i.ak(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,h){return this.projection.createTileMatrix(this,h,o)}calculateDistanceTileData(o){let h=o.key,g=this._distanceTileDataCache;if(g[h])return g[h];let y=o.canonical,b=1/this.height,S=this.cameraWorldSize,C=S/this.zoomScale(y.z),P=(y.x+Math.pow(2,y.z)*o.wrap)*C,O=y.y*C,j=this.point;j.x*=S/this.worldSize,j.y*=S/this.worldSize;let X=this.angle,re=Math.sin(-X),ae=-Math.cos(-X);return g[h]={bearing:[re,ae],center:[(j.x-P)*b,(j.y-O)*b],scale:C/i.a3*b},g[h]}calculateFogTileMatrix(o){let h=o.key,g=this._fogTileMatrixCache;if(g[h])return g[h];let y=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,o);return i.ad.multiply(y,this.worldToFogMatrix,y),g[h]=new Float32Array(y),g[h]}calculateProjMatrix(o,h=!1,g=!1){let y=o.key,b;if(b=g?this._expandedProjMatrixCache:h?this._alignedProjMatrixCache:this._projMatrixCache,b[y])return b[y];let S=this.calculatePosMatrix(o,this.worldSize),C;return C=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:g?this.expandedFarZProjMatrix:h?this.alignedProjMatrix:this.projMatrix,i.ad.multiply(S,C,S),b[y]=new Float32Array(S),b[y]}calculatePixelsToTileUnitsMatrix(o){let h=o.tileID.key,g=this._pixelsToTileUnitsCache;if(g[h])return g[h];let y=i.aW(o,this);return g[h]=y,g[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){let o=1/this.worldSize,h=i.ad.fromScaling([],[o,o,o]);return i.ad.multiply(h,h,this.globeMatrix),h}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;let o=this._elevation;this._updateCameraState();let h=i.ax(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(h),y=this._camera.forward(),b=i.ax(1,this._center.lat);g[2]/=b,y[2]/=b,i._.normalize(y,y);let S=o.raycast(g,y,o.exaggeration());if(S){let C=i._.scaleAndAdd([],g,y,S),P=new i.Y(C[0],C[1],i.ax(C[2],i.ay(C[1]))),O=(P.z+i._.length([P.x-g[0],P.y-g[1],P.z-g[2]*b]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(O),this._centerAltitude=P.toAltitude(),this._center=this.coordinateLocation(P),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(o=!1){if(!this._elevation)return;let h=this._elevation,g=i.ax(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(g),b=h.getAtPointOrZero(new i.Y(...y)),S=this.pixelsPerMeter/this.worldSize*b,C=this._minimumHeightOverTerrain(),P=y[2]-S;if(P<=C)if(P<0||o){let O=this.locationCoordinate(this._center,this._centerAltitude),j=[y[0],y[1],O.z-y[2]],X=i._.length(j);j[2]-=(C-P)/this._pixelsPerMercatorPixel;let re=i._.length(j);if(re===0)return;i._.scale(j,j,X/re*this._pixelsPerMercatorPixel),this._camera.position=[y[0],y[1],O.z*this._pixelsPerMercatorPixel-j[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let o=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||o){let re=this.center;return re.lat=i.at(re.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!o)&&(re.lng=i.at(re.lng,this.minLng,this.maxLng)),this.center=re,void(this._constraining=!1)}let h=this._unmodified,{x:g,y}=this.point,b=0,S=g,C=y,P=this.width/2,O=this.height/2,j=this.worldMinY*this.scale,X=this.worldMaxY*this.scale;if(y-O<j&&(C=j+O),y+O>X&&(C=X-O),X-j<this.height&&(b=Math.max(b,this.height/(X-j)),C=(X+j)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){let re=this.worldMinX*this.scale,ae=this.worldMaxX*this.scale,ue=this.worldSize/2-(re+ae)/2;S=(g+ue+this.worldSize)%this.worldSize-ue,S-P<re&&(S=re+P),S+P>ae&&(S=ae-P),ae-re<this.width&&(b=Math.max(b,this.width/(ae-re)),S=(ae+re)/2)}S===g&&C===y||(this.center=this.unproject(new i.P(S,C))),b&&(this.zoom+=this.scaleZoom(b)),this._constrainCamera(),this._unmodified=h,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;let o=this.centerOffset,h=this.projection.name==="globe",g=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.ax(1,this.center.lat)/i.ax(1,i.b3));let y=i.aX(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,y),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;let b=this.projection.zAxisUnit==="meters"?g:1,S=this._camera.getWorldToCamera(this.worldSize,b),C,P=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(P[8]=2*-o.x/this.width,P[9]=2*o.y/this.height,this.isOrthographic){let je=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),at=je*this.aspect,yt=-at,qe=-je;at-=o.x,yt-=o.x,je+=o.y,qe+=o.y,C=this._camera.getCameraToClipOrthographic(yt,at,qe,je,this._nearZ,this._farZ),((bt,Ct,Ht,qt)=>{for(let Ut=0;Ut<16;Ut++)bt[Ut]=fh(Ct[Ut],Ht[Ut],qt)})(C,C,P,Nn(this.pitch>=15?1:this.pitch/15))}else C=P;let O=i.ad.mul([],P,S),j=i.ad.mul([],C,S);if(this.projection.isReprojectedInTileSpace){let je=this.locationCoordinate(this.center),at=i.ad.identity([]);i.ad.translate(at,at,[je.x*this.worldSize,je.y*this.worldSize,0]),i.ad.multiply(at,at,i.aY(this)),i.ad.translate(at,at,[-je.x*this.worldSize,-je.y*this.worldSize,0]),i.ad.multiply(j,j,at),i.ad.multiply(O,O,at),this.inverseAdjustmentMatrix=i.aZ(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.ad.scale([],j,[this.worldSize,this.worldSize,this.worldSize/b,1]),this.projMatrix=j,this.invProjMatrix=i.ad.invert(new Float64Array(16),this.projMatrix),h){let je=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);je[8]=2*-o.x/this.width,je[9]=2*o.y/this.height,this.expandedFarZProjMatrix=i.ad.mul([],je,S)}else this.expandedFarZProjMatrix=this.projMatrix;let X=i.ad.invert([],C);this.frustumCorners=i.a_.fromInvProjectionMatrix(X,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.aM.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!h);let re=new Float32Array(16);i.ad.identity(re),i.ad.scale(re,re,[1,-1,1]),i.ad.rotateX(re,re,this._pitch),i.ad.rotateZ(re,re,this.angle);let ae=i.ad.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.ad.clone(ae);let ue=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ae[8]=2*-o.x/this.width,ae[9]=2*(o.y+ue)/this.height,this.skyboxMatrix=i.ad.multiply(re,ae,re);let he=this.point,fe=he.x,me=he.y,Le=this.width%2/2,Oe=this.height%2/2,Ne=Math.cos(this.angle),Je=Math.sin(this.angle),Ke=fe-Math.round(fe)+Ne*Le+Je*Oe,Pe=me-Math.round(me)+Ne*Oe+Je*Le,Be=new Float64Array(j);if(i.ad.translate(Be,Be,[Ke>.5?Ke-1:Ke,Pe>.5?Pe-1:Pe,0]),this.alignedProjMatrix=Be,j=i.ad.create(),i.ad.scale(j,j,[this.width/2,-this.height/2,1]),i.ad.translate(j,j,[1,-1,0]),this.labelPlaneMatrix=j,j=i.ad.create(),i.ad.scale(j,j,[1,-1,1]),i.ad.translate(j,j,[-1,-1,0]),i.ad.scale(j,j,[2/this.width,2/this.height,1]),this.glCoordMatrix=j,this.pixelMatrix=i.ad.multiply(new Float64Array(16),this.labelPlaneMatrix,O),this._calcFogMatrices(),this._distanceTileDataCache={},j=i.ad.invert(new Float64Array(16),this.pixelMatrix),!j)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=j,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.a$(this);let je=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i._.transformMat4(je,je,S),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=j;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};let o=this.cameraWorldSizeForFog,h=this.cameraPixelsPerMeter,g=this._camera.position,y=1/this.height/this._pixelsPerMercatorPixel,b=[o,o,h];i._.scale(b,b,y),i._.scale(g,g,-1),i._.multiply(g,g,b);let S=i.ad.create();i.ad.translate(S,S,g),i.ad.scale(S,S,b),this.mercatorFogMatrix=S,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,h,y)}_computeCameraPosition(o){let h=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,g=this._camera.forward(),y=this.point,b=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*h-o/this.worldSize*this._centerAltitude;return[y.x/this.worldSize-g[0]*b,y.y/this.worldSize-g[1]*b,o/this.worldSize*this._centerAltitude-g[2]*b]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){let h=this._maxCameraBoundsDistance()*Math.cos(this._pitch),g=this._camera.position[2],y=o[2],b=1;this.projection.wrap&&(this.center=this.center.wrap()),y>0&&(b=Math.min((h-g)/y,1)),this._camera.position=i._.scaleAndAdd([],this._camera.position,o,b),this._updateStateFromCamera()}_updateStateFromCamera(){let o=this._camera.position,h=this._camera.forward(),{pitch:g,bearing:y}=this._camera.getPitchBearing(),b=i.ax(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,S=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.ab(this._maxPitch)),C=Math.max((o[2]-b)/Math.cos(g),S),P=this._zoomFromMercatorZ(C);i._.scaleAndAdd(o,o,h,C),this._pitch=i.at(g,i.ab(this.minPitch),i.ab(this.maxPitch)),this.angle=i.au(y,-Math.PI,Math.PI),this._setZoom(i.at(P,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.Y(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){let o=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(o*this.tileSize))}zoomFromMercatorZAdjusted(o){let h=0,g=i.aU,y=0,b=1/0;for(;g-h>1e-6&&g>h;){let S=h+.5*(g-h),C=this.tileSize*Math.pow(2,S),P=this.getCameraToCenterDistance(this.projection,S,C),O=this.scaleZoom(P/(o*this.tileSize)),j=Math.abs(S-O);j<b&&(b=j,y=S),S<O?h=S:g=S}return y}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(o,h){let g=Math.min(o.x,h.x),y=Math.max(o.x,h.x),b=Math.min(o.y,h.y),S=Math.max(o.y,h.y);if(b<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;let C=[new i.P(g,b),new i.P(y,S),new i.P(g,S),new i.P(y,b)],P=this.renderWorldCopies?-3:0,O=this.renderWorldCopies?4:1;for(let j of C){let X=this.pointRayIntersection(j);if(X.t<0)return!0;let re=this.rayIntersectionCoordinate(X);if(re.x<P||re.y<0||re.x>O||re.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.b0(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(o,h){let g=i._.length(i._.sub([],this._camera.position,o)),y=this._zoomFromMercatorZ(g)+h;return g-this._mercatorZfromZoom(y)}getCameraPoint(){if(this.projection.name==="globe"){let o=function([h,g,y],b){let S=[h,g,y,1];i.aA.transformMat4(S,S,b);let C=S[3]=Math.max(S[3],1e-6);return S[0]/=C,S[1]/=C,S[2]/=C,S}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(o[0],o[1])}{let o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,o))}}getCameraToCenterDistance(o,h=this.zoom,g=this.worldSize){let y=i.aX(o,h,this.width,this.height,1024),b=o.pixelSpaceConversion(this.center.lat,g,y),S=.5/Math.tan(.5*this._fov)*this.height*b;return this.isOrthographic&&(S=fh(1,S,Nn(this.pitch>=15?1:this.pitch/15))),S}getWorldToCameraMatrix(){let o=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.ad.multiply(o,o,this.globeMatrix),o}getFrustum(o){return i.aM.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,o,this.projection.zAxisUnit==="meters")}}let to={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11},$s=(m,o)=>{if(o>0&&m.terrain&&i.w("Cutoff is currently disabled on terrain"),o<=0||m.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};let h=m.transform,g=Math.max(Math.abs(h._zoom-(m.minCutoffZoom-1)),1),y=h.isLODDisabled(!1)?i.$(60,45,h.pitch):i.$(30,15,h.pitch),b=h._farZ-h._nearZ,S=o*h.height,C=((1-(P=y))*h.cameraToCenterDistance+P*(h._farZ+S))*g;var P;return{shouldRenderCutoff:y<1,uniformValues:{u_cutoff_params:[h._nearZ,h._farZ,(C-h._nearZ)/b,(C-S-h._nearZ)/b]}}},io={cascadeCount:2,shadowMapResolution:2048};class jc{constructor(o,h){this.aabb=o,this.lastCascade=h}}class hc{add(o,h){let g=this.receivers[o.key];g!==void 0?(g.aabb.min[0]=Math.min(g.aabb.min[0],h.min[0]),g.aabb.min[1]=Math.min(g.aabb.min[1],h.min[1]),g.aabb.min[2]=Math.min(g.aabb.min[2],h.min[2]),g.aabb.max[0]=Math.max(g.aabb.max[0],h.max[0]),g.aabb.max[1]=Math.max(g.aabb.max[1],h.max[1]),g.aabb.max[2]=Math.max(g.aabb.max[2],h.max[2])):this.receivers[o.key]=new jc(h,null)}clear(){this.receivers={}}get(o){return this.receivers[o.key]}computeRequiredCascades(o,h,g){let y=i.b6.fromPoints(o.points),b=0;for(let S in this.receivers){let C=this.receivers[S];if(!C||!y.intersectsAabb(C.aabb))continue;C.aabb.min=y.closestPoint(C.aabb.min),C.aabb.max=y.closestPoint(C.aabb.max);let P=C.aabb.getCorners();for(let O=0;O<g.length;O++){let j=!0;for(let X of P){let re=[X[0]*h,X[1]*h,X[2]];if(i._.transformMat4(re,re,g[O].matrix),re[0]<-1||re[0]>1||re[1]<-1||re[1]>1){j=!1;break}}if(C.lastCascade=O,b=Math.max(b,O),j)break}}return b+1}}class Vc{constructor(o){this.painter=o,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new hc,this._depthMode=new i.ae(o.context.gl.LEQUAL,i.ae.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,o.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),o.tp.registerParameter(io,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),o.tp.registerParameter(io,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),o.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(let o of this._cascades)o.texture.destroy(),o.framebuffer.destroy();this._cascades=[]}updateShadowParameters(o,h){let g=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!h||!h.properties)return;let y=h.properties.get("shadow-intensity");if(!h.shadowsEnabled()||y<=0||(this._shadowLayerCount=g.style.order.reduce((ue,he)=>{let fe=g.style._mergedLayers[he];return ue+(fe.hasShadowPass()&&!fe.isHidden(o.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;let b=g.context,S=io.shadowMapResolution,C=io.shadowMapResolution;if(this._cascades.length===0||io.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ue=0;ue<io.cascadeCount;++ue){let he=g._shadowMapDebug,fe=b.gl,me=b.createFramebuffer(S,C,he,"texture"),Le=new i.T(b,{width:S,height:C,data:null},fe.DEPTH_COMPONENT);if(me.depthAttachment.set(Le.texture),he){let Oe=new i.T(b,{width:S,height:C,data:null},fe.RGBA);me.colorAttachment.set(Oe.texture)}this._cascades.push({framebuffer:me,texture:Le,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.aM,scale:0})}}this.shadowDirection=dc(h);let P=0;if(o.elevation){let ue=o.elevation,he=[1e4,-1e4];ue.visibleDemTiles.filter(fe=>fe.dem).forEach(fe=>{let me=fe.dem.tree;he[0]=Math.min(he[0],me.minimums[0]),he[1]=Math.max(he[1],me.maximums[0])}),he[0]!==1e4&&(P=(he[1]-he[0])*ue.exaggeration())}let O=1.5*o.cameraToCenterDistance,j=3*O,X=new Float64Array(16);for(let ue=0;ue<this._cascades.length;++ue){let he=this._cascades[ue],fe=o.height/50,me=1;io.cascadeCount===1?me=j:ue===0?me=O:(fe=O,me=j);let[Le,Oe]=Ee(o,this.shadowDirection,fe,me,io.shadowMapResolution,P);he.scale=o.scale,he.matrix=Le,he.boundingSphereRadius=Oe,i.ad.invert(X,he.matrix),he.frustum=i.aM.fromInvProjectionMatrix(X,1,0,!0),he.far=me}let re=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[re].far,this._cascades[re].far],this._uniformValues.u_shadow_intensity=y,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/io.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=io.shadowMapResolution,this._uniformValues.u_shadowmap_0=to.ShadowMap0,this._uniformValues.u_shadowmap_1=to.ShadowMap0+1,this._groundShadowTiles=g.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});let ae=g.transform.elevation;for(let ue of this._groundShadowTiles){let he={min:0,max:0};if(ae){let fe=ae.getMinMaxForTile(ue);fe&&(he=fe)}this.addShadowReceiver(ue.toUnwrapped(),he.min,he.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(o){this._enabled=o}drawShadowPass(o,h){if(!this.enabled)return;let g=this.painter,y=g.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(g.transform.getFrustum(0),g.transform.worldSize,this._cascades),y.viewport.set([0,0,io.shadowMapResolution,io.shadowMapResolution]);for(let b=0;b<this._numCascadesToRender;++b){g.currentShadowCascade=b,y.bindFramebuffer.set(this._cascades[b].framebuffer.framebuffer),y.clear({color:i.C.white,depth:1});for(let S of o.order){let C=o._mergedLayers[S];if(!C.hasShadowPass()||C.isHidden(g.transform.zoom))continue;let P=o.getLayerSourceCache(C),O=P?h[P.id]:void 0;(C.type==="model"||O&&O.length)&&g.renderLayer(g,P,C,O)}}g.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;let o=this.painter,h=o.style,g=o.context,y=h.directionalLight,b=h.ambientLight;if(!y||!b)return;let S=[],C=$s(o,o.longestCutoffRange);C.shouldRenderCutoff&&S.push("RENDER_CUTOFF");let P=U(h,y,b),O=new i.ae(g.gl.LEQUAL,i.ae.ReadOnly,o.depthRangeFor3D);for(let j of this._groundShadowTiles){let X=j.toUnwrapped(),re=o.isTileAffectedByFog(j),ae=o.getOrCreateProgram("groundShadow",{defines:S,overrideFog:re});this.setupShadows(X,ae),o.uploadCommonUniforms(g,ae,X,null,C);let ue={u_matrix:o.transform.calculateProjMatrix(X),u_ground_shadow_factor:P};ae.draw(o,g.gl.TRIANGLES,O,i.ag.disabled,i.a.multiply,i.af.disabled,ue,"ground_shadow",o.tileExtentBuffer,o.quadTriangleIndexBuffer,o.tileExtentSegments,{},o.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?i.a.unblended:i.a.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(o){let h=this.painter.transform,g=h.calculatePosMatrix(o,h.worldSize);return i.ad.multiply(g,this._cascades[this.painter.currentShadowCascade].matrix,g),Float32Array.from(g)}calculateShadowPassMatrixFromMatrix(o){return i.ad.multiply(o,this._cascades[this.painter.currentShadowCascade].matrix,o),Float32Array.from(o)}setupShadows(o,h,g,y=0){if(!this.enabled)return;let b=this.painter.transform,S=this.painter.context,C=S.gl,P=this._uniformValues,O=new Float64Array(16),j=b.calculatePosMatrix(o,b.worldSize);for(let X=0;X<this._cascades.length;X++)i.ad.multiply(O,this._cascades[X].matrix,j),P[X===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(O),S.activeTexture.set(C.TEXTURE0+to.ShadowMap0+X),this._cascades[X].texture.bind(C.NEAREST,C.CLAMP_TO_EDGE);if(this.useNormalOffset=!!g,this.useNormalOffset){let X=i.b5(o.canonical),re=2/b.tileSize*i.a3/io.shadowMapResolution,ae=re*this._cascades[0].boundingSphereRadius,ue=re*this._cascades[this._cascades.length-1].boundingSphereRadius,he=(g==="vector-tile"?1:3)/Math.pow(2,y-o.canonical.z-(1-b.zoom+Math.floor(b.zoom)));P.u_shadow_normal_offset=[X,ae*he,ue*he],P.u_shadow_bias=[6e-5,.0012,.012]}else P.u_shadow_bias=[36e-5,.0012,.012];h.setShadowUniformValues(S,P)}setupShadowsFromMatrix(o,h,g=!1){if(!this.enabled)return;let y=this.painter.context,b=y.gl,S=this._uniformValues,C=new Float64Array(16);for(let P=0;P<io.cascadeCount;P++)i.ad.multiply(C,this._cascades[P].matrix,o),S[P===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(C),y.activeTexture.set(b.TEXTURE0+to.ShadowMap0+P),this._cascades[P].texture.bind(b.NEAREST,b.CLAMP_TO_EDGE);this.useNormalOffset=g,g?(S.u_shadow_normal_offset=[1,5,5],S.u_shadow_bias=[6e-5,.0012,.012]):S.u_shadow_bias=[36e-5,.0012,.012],h.setShadowUniformValues(y,S)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(o,h,g,y){if(y[2]>=0)return{};let b=function(P,O,j){let X=j/(1<<P.canonical.z);return new i.b6([P.canonical.x*X+P.wrap*j,P.canonical.y*X+P.wrap*j,0],[(P.canonical.x+1)*X+P.wrap*j,(P.canonical.y+1)*X+P.wrap*j,O])}(o,h,g).getCorners(),S=h/-y[2];y[0]<0?(i._.add(b[0],b[0],[y[0]*S,0,0]),i._.add(b[3],b[3],[y[0]*S,0,0])):y[0]>0&&(i._.add(b[1],b[1],[y[0]*S,0,0]),i._.add(b[2],b[2],[y[0]*S,0,0])),y[1]<0?(i._.add(b[0],b[0],[0,y[1]*S,0]),i._.add(b[1],b[1],[0,y[1]*S,0])):y[1]>0&&(i._.add(b[2],b[2],[0,y[1]*S,0]),i._.add(b[3],b[3],[0,y[1]*S,0]));let C={};return C.vertices=b,C.planes=[ks(b[1],b[0],b[4]),ks(b[2],b[1],b[5]),ks(b[3],b[2],b[6]),ks(b[0],b[3],b[7])],C}addShadowReceiver(o,h,g){this._receivers.add(o,i.b6.fromTileIdAndHeight(o,h,g))}getMaxCascadeForTile(o){let h=this._receivers.get(o);return h&&h.lastCascade?h.lastCascade:0}}function ks(m,o,h){let g=i._.sub([],h,o),y=i._.sub([],m,o),b=i._.cross([],g,y),S=i._.length(b);return S===0?[0,0,1,0]:(i._.scale(b,b,1/S),[b[0],b[1],b[2],-i._.dot(b,o)])}function dc(m){let o=m.properties.get("direction"),h=i.ac(o.x,o.y,o.z);h[2]=i.at(h[2],0,75);let g=i.b7([h[0],h[1],h[2]]);return i._.fromValues(g.x,g.y,g.z)}function U(m,o,h){let g=o.properties.get("color"),y=o.properties.get("intensity"),b=o.properties.get("direction"),S=[b.x,b.y,b.z],C=h.properties.get("color"),P=h.properties.get("intensity"),O=Math.max(i._.dot([0,0,1],S),0),j=[0,0,0];i._.scale(j,C.toRenderColor(m.getLut(o.scope)).toArray01Linear().slice(0,3),P);let X=[0,0,0];return i._.scale(X,g.toRenderColor(m.getLut(h.scope)).toArray01Linear().slice(0,3),O*y),i.b8([j[0]>0?j[0]/(j[0]+X[0]):0,j[1]>0?j[1]/(j[1]+X[1]):0,j[2]>0?j[2]/(j[2]+X[2]):0])}function Ee(m,o,h,g,y,b){let S=m.zoom,C=m.scale,P=m.worldSize,O=1/P,j=m.aspect,X=Math.sqrt(1+j*j)*Math.tan(.5*m.fovX),re=X*X,ae=g-h,ue=g+h,he,fe;re>ae/ue?(he=g,fe=g*X):(he=.5*ue*(1+re),fe=.5*Math.sqrt(ae*ae+2*(g*g+h*h)*re+ue*ue*re*re));let me=m.projection.pixelsPerMeter(m.center.lat,P),Le=m._camera.getCameraToWorldMercator(),Oe=[0,0,-he*O];i._.transformMat4(Oe,Oe,Le);let Ne=fe*O,Je=m._edgeInsets;if(!(Je.left===0&&Je.top===0&&Je.right===0&&Je.bottom===0||Je.left===Je.right&&Je.top===Je.bottom)){let di=m._camera.getWorldToCamera(m.worldSize,m.projection.zAxisUnit==="meters"?me:1),pi=m._camera.getCameraToClipPerspective(m._fov,m.width/m.height,h,g);pi[8]=2*-m.centerOffset.x/m.width,pi[9]=2*m.centerOffset.y/m.height;let Ai=new Float64Array(16);i.ad.mul(Ai,pi,di);let mi=new Float64Array(16);i.ad.invert(mi,Ai);let Yt=i.aM.fromInvProjectionMatrix(mi,P,S,!0);for(let Nt of Yt.points){let Li=((Ke=Nt)[0]/=C,Ke[1]/=C,Ke[2]=i.ax(Ke[2],m._center.lat),Ke);Ne=Math.max(Ne,i._.len(i._.subtract([],Oe,Li)))}}var Ke;Ne*=y/(y-1);let Pe=Math.acos(o[2]),Be=Math.atan2(-o[0],-o[1]),je=new lc;je.position=Oe,je.setPitchBearing(Pe,Be);let at=je.getWorldToCamera(P,me),yt=Ne*P,qe=Math.min(m._mercatorZfromZoom(17)*P*-2,-2*yt),bt=je.getCameraToClipOrthographic(-yt,yt,-yt,yt,qe,(yt+b*me)/o[2]),Ct=new Float64Array(16);i.ad.multiply(Ct,bt,at);let Ht=i._.fromValues(Math.floor(1e6*Oe[0])/1e6*P,Math.floor(1e6*Oe[1])/1e6*P,0),qt=.5*y,Ut=[0,0,0];i._.transformMat4(Ut,Ht,Ct),i._.scale(Ut,Ut,qt);let ft=[Math.floor(Ut[0]),Math.floor(Ut[1]),Math.floor(Ut[2])],kt=[0,0,0];i._.sub(kt,Ut,ft),i._.scale(kt,kt,-1/qt);let jt=new Float64Array(16);return i.ad.identity(jt),i.ad.translate(jt,jt,kt),i.ad.multiply(Ct,jt,Ct),[Ct,yt]}function ct(m,o){return m!=null&&o!=null&&!(!m.hasData()||!o.hasData())&&m.demTexture!=null&&o.demTexture!=null&&m.tileID.key!==o.tileID.key}let vt=new class{constructor(){this.operations={}}newMorphing(m,o,h,g,y){if(m in this.operations){let b=this.operations[m];b.to.tileID.key!==h.tileID.key&&(b.queued=h)}else this.operations[m]={startTime:g,phase:0,duration:y,from:o,to:h,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;let o=this.operations[m];return{from:o.from,to:o.to,phase:o.phase}}update(m){for(let o in this.operations){let h=this.operations[o];for(h.phase=(m-h.startTime)/h.duration;h.phase>=1||!this._validOp(h);)if(!this._nextOp(h,m)){delete this.operations[o];break}}}_nextOp(m,o){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=o,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},Rt={0:null,1:"TERRAIN_VERTEX_MORPHING"};function si(m,o,h){if(o===0)return 0;let g=o<1&&h===514?.25/o:1;return 6*Math.pow(1.5,22-m)*Math.max(o,1)*g}function Mi(m,o){let h=1<<m.z;return!o&&(m.x===0||m.x===h-1)||m.y===0||m.y===h-1}let Zi=m=>({u_matrix:m});function cr(m,o,h,g,y){if(y>0){let b=i.e.now(),S=(b-m.timeAdded)/y,C=o?(b-o.timeAdded)/y:-1,P=h.getSource(),O=g.coveringZoomLevel({tileSize:P.tileSize,roundZoom:P.roundZoom}),j=!o||Math.abs(o.tileID.overscaledZ-O)>Math.abs(m.tileID.overscaledZ-O),X=j&&m.refreshedUponExpiration?1:i.at(j?S:1-C,0,1);return m.refreshedUponExpiration&&S>=1&&(m.refreshedUponExpiration=!1),o?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}class Mr extends Pl{constructor(o,h,g,y){super(o,h,g,y),this.type="raster-array",this.maxzoom=22,this._options=i.W({type:"raster-array"},h)}triggerRepaint(o){let h=this.map.painter._terrain,g=this.map.style.getSourceCache(this.id);h&&h.enabled&&g&&h._clearRenderCacheForTile(g.id,o.tileID),this.map.triggerRepaint()}loadTile(o,h){let g=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),y=this.map._requestManager.transformRequest(g,i.R.Tile);o.requestParams=y,o.actor||(o.actor=this.dispatcher.getActor()),o.request=o.fetchHeader(void 0,(b,S,C,P)=>{if(delete o.request,o.aborted)return o.state="unloaded",h(null);if(b)return b.code===20?void 0:(o.state="errored",h(b));this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:C,expires:P}),o.state="empty",h(null)})}unloadTile(o,h){let g=o.texture;g&&g instanceof i.T?(o.destroy(!0),this.map.painter.saveTileTexture(g)):(o.destroy(),o.flushQueues(),o._isHeaderLoaded=!1,delete o._mrt,delete o.textureDescriptor),o.fbo&&(o.fbo.destroy(),delete o.fbo),delete o.request,delete o.requestParams,delete o.neighboringTiles,o.state="unloaded"}prepareTile(o,h,g){o._isHeaderLoaded&&(o.state!=="empty"&&(o.state="reloading"),o.fetchBand(h,g,(y,b)=>{if(y)return o.state="errored",this.fire(new i.d(y)),void this.triggerRepaint(o);b&&(o.setTexture(b,this.map.painter),o.state="loaded",this.triggerRepaint(o))}))}getInitialBand(o){if(!this.rasterLayers)return 0;let h=this.rasterLayers.find(({id:b})=>b===o),g=h&&h.fields,y=g&&g.bands&&g.bands;return y?y[0]:0}getTextureDescriptor(o,h,g){if(!o)return;let y=h.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!y)return;let b=null;h instanceof i.bk?b=h.paint.get("raster-array-band"):h instanceof i.bl&&(b=h.paint.get("raster-particle-array-band"));let S=b||this.getInitialBand(y);if(S!=null)if(o.textureDescriptor){if(!o.updateNeeded(y,S)||g)return Object.assign({},o.textureDescriptor,{texture:o.texture})}else this.prepareTile(o,y,S)}}let ur={vector:Bc,raster:Pl,"raster-dem":class extends Pl{constructor(m,o,h,g){super(m,o,h,g),this.type="raster-dem",this.maxzoom=22,this._options=i.W({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(m,o){let h=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function g(y,b){y&&(m.state="errored",o(y)),b&&(m.dem=b,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",o(null))}m.request=i.h(this.map._requestManager.transformRequest(h,i.R.Tile),(function(y,b,S,C){if(delete m.request,m.aborted)m.state="unloaded",o(null);else if(y)m.state="errored",o(y);else if(b){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:S,expires:C});let P=ImageBitmap&&b instanceof ImageBitmap&&i.bi(),O=1-(b.width-i.bj(b.width))/2;O<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));let j=P?b:i.e.getImageData(b,O),X={uid:m.uid,coord:m.tileID,source:this.id,scope:this.scope,rawImageData:j,encoding:this.encoding,padding:O};m.actor&&m.state!=="expired"||(m.actor=this.dispatcher.getActor(),m.actor.send("loadDEMTile",X,g.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(m){let o=m.canonical,h=Math.pow(2,o.z),g=(o.x-1+h)%h,y=o.x===0?m.wrap-1:m.wrap,b=(o.x+1+h)%h,S=o.x+1===h?m.wrap+1:m.wrap,C={};return C[new i.aL(m.overscaledZ,y,o.z,g,o.y).key]={backfilled:!1},C[new i.aL(m.overscaledZ,S,o.z,b,o.y).key]={backfilled:!1},o.y>0&&(C[new i.aL(m.overscaledZ,y,o.z,g,o.y-1).key]={backfilled:!1},C[new i.aL(m.overscaledZ,m.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},C[new i.aL(m.overscaledZ,S,o.z,b,o.y-1).key]={backfilled:!1}),o.y+1<h&&(C[new i.aL(m.overscaledZ,y,o.z,g,o.y+1).key]={backfilled:!1},C[new i.aL(m.overscaledZ,m.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},C[new i.aL(m.overscaledZ,S,o.z,b,o.y+1).key]={backfilled:!1}),C}},"raster-array":Mr,geojson:class extends i.E{constructor(m,o,h,g){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=h.getActor(),this.setEventedParent(g),this._data=o.data,this._options=i.W({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.minzoom!==void 0&&(this.minzoom=o.minzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;let y=i.a3/this.tileSize;this.workerOptions=i.W({source:this.id,scope:this.scope,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*y,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*y,extent:i.a3,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:i.a3,radius:(o.clusterRadius!==void 0?o.clusterRadius:50)*y,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter,dynamic:o.dynamic},o.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}updateData(m){return this._options.dynamic?typeof m!="string"&&(m.type==="Feature"&&(m={type:"FeatureCollection",features:[m]}),m.type!=="FeatureCollection")?this.fire(new i.d(new Error("Data to update should be a feature or a feature collection."))):(this._coalesce&&typeof m!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"?this._data.features.push(...m.features):this._data=m,this._updateWorkerData(!0),this):this.fire(new i.d(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")))}getClusterExpansionZoom(m,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id,scope:this.scope},o),this}getClusterChildren(m,o){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id,scope:this.scope},o),this}getClusterLeaves(m,o,h,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:m,limit:o,offset:h},g),this}_updateWorkerData(m=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.f("dataloading",{dataType:"source"})),this._loaded=!1;let o=i.W({append:m},this.workerOptions);o.scope=this.scope;let h=this._data;typeof h=="string"?(o.request=this.map._requestManager.transformRequest(i.e.resolveURL(h),i.R.Source),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(h),this._pendingLoad=this.actor.send(`${this.type}.loadData`,o,(g,y)=>{if(this._loaded=!0,this._pendingLoad=null,g)this.fire(new i.d(g));else{let b={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&y&&y.resourceTiming&&y.resourceTiming[this.id]&&(b.resourceTiming=y.resourceTiming[this.id]),m&&(this._partialReload=!0),this.fire(new i.f("data",b)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(m),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(m,o){let h=m.actor?"reloadTile":"loadTile";m.actor=this.actor;let g=this.map.style?this.map.style.getLut(this.scope):null,y=this._partialReload,b={type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:g?{image:g.image.clone()}:null,scope:this.scope,pixelRatio:i.e.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,partial:y};m.request=this.actor.send(h,b,(S,C)=>y&&!C?(m.state="loaded",o(null)):(delete m.request,m.destroy(),m.aborted?o(null):S?o(S):(m.loadVectorData(C,this.map.painter,h==="reloadTile"),o(null))),void 0,h==="loadTile")}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m,o){this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id,scope:this.scope}),m.destroy()}onRemove(m){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return i.W({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.bm{constructor(m,o,h,g){super(m,o,h,g),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;let m=this.options;this.urls=[];for(let o of m.urls)this.urls.push(this.map._requestManager.transformRequest(o,i.R.Source).url);i.bn(this.urls,(o,h)=>{this._loaded=!0,o?this.fire(new i.d(o)):h&&(this.video=h,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){let o=this.video.seekable;m<o.start(0)||m>o.end(0)?this.fire(new i.d(new i.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let m=this.map.painter.context,o=m.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(m,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.bm,model:class extends i.E{constructor(m,o,h,g){super(),this.id=m,this.type="model",this.models=[],this._loaded=!1,this._options=o}load(){let m=[];for(let o in this._options.models){let h=this._options.models[o],g=i.l(this.map._requestManager.transformRequest(h.uri,i.R.Model).url).then(y=>{if(!y)return;let b=i.c(y),S=new i.M(o,h.position,h.orientation,b);S.computeBoundsAndApplyParent(),this.models.push(S)}).catch(y=>{this.fire(new i.d(new Error(`Could not load model ${o} from ${h.uri}: ${y.message}`)))});m.push(g)}return Promise.allSettled(m).then(()=>{this._loaded=!0,this.fire(new i.f("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(o=>{this.fire(new i.d(new Error(`Could not load models: ${o.message}`)))})}onAdd(m){this.map=m,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(m,o){}serialize(){return{type:"model"}}},"batched-model":class extends i.E{constructor(m,o,h,g){super(),this.type="batched-model",this.id=m,this.tileSize=512,this._options=o,this.tiles=this._options.tiles,this.maxzoom=o.maxzoom||19,this.minzoom=o.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=h,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(g)}onAdd(m){this.map=m,this.load()}load(m){this._loaded=!1,this.fire(new i.f("dataloading",{dataType:"source"}));let o=Array.isArray(this.map._language)?this.map._language.join():this.map._language,h=this.map._worldview;this._tileJSONRequest=hh(this._options,this.map._requestManager,o,h,(g,y)=>{this._tileJSONRequest=null,this._loaded=!0,g?(o&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${o}`),h&&h.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${h}`),this.fire(new i.d(g))):y&&(i.W(this,y),y.bounds&&(this.tileBounds=new Nc(y.bounds,this.minzoom,this.maxzoom)),i.an(y.tiles,this.map._requestManager._customAccessToken),this.fire(new i.f("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.f("data",{dataType:"source",sourceDataType:"content"}))),m&&m(g)})}hasTransition(){return!1}hasTile(m){return!this.tileBounds||this.tileBounds.contains(m.canonical)}loaded(){return this._loaded}loadTile(m,o){let h=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme)),g={request:this.map._requestManager.transformRequest(h,i.R.Tile),data:void 0,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,tileSize:this.tileSize*m.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:m.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(m.actor&&m.state!=="expired")if(m.state==="loading")m.reloadCallback=o;else{if(m.buckets){let b=Object.values(m.buckets);for(let S of b)S.dirty=!0;return void(m.state="loaded")}m.request=m.actor.send("reloadTile",g,y.bind(this))}else m.actor=this.dispatcher.getActor(),m.request=m.actor.send("loadTile",g,y.bind(this),void 0,!0);function y(b,S){return m.aborted?o(null):b&&b.status!==404?o(b):(S&&(S.resourceTiming&&(m.resourceTiming=S.resourceTiming),this.map._refreshExpiredTiles&&m.setExpiryData(S),m.buckets=In(In({},m.buckets),S.buckets),S.featureIndex&&(m.latestFeatureIndex=S.featureIndex)),m.state="loaded",void o(null))}}serialize(){return i.W({},this._options)}},canvas:class extends i.bm{constructor(m,o,h,g){super(m,o,h,g),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(b=>typeof b!="number"))||this.fire(new i.d(new i.V(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.d(new i.V(`sources.${m}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new i.d(new i.V(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new i.d(new i.V(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.d(new i.V(`sources.${m}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.d(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(m){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let o=this.map.painter.context;this.texture?!m&&!this._playing||this.texture instanceof i.bo||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(o,this.canvas,o.gl.RGBA,{premultiply:!0}),this._prepareData(o)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends i.E{constructor(m,o,h,g){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=h,this._implementation=o,this.setEventedParent(g),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.d(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.d(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Nc(this._implementation.bounds,this.minzoom,this.maxzoom)),o.update=this._update.bind(this),o.clearTiles=this._clearTiles.bind(this),o.coveringTiles=this._coveringTiles.bind(this),i.W(this,i.ah(o,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.ah(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.f("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.f("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this._map=m,this._loaded=!1,this.fire(new i.f("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){let{x:o,y:h,z:g}=m.canonical;return this._implementation.hasTile({x:o,y:h,z:g})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,o){let{x:h,y:g,z:y}=m.tileID.canonical,b=new AbortController;m.request=Promise.resolve(this._implementation.loadTile({x:h,y:g,z:y},{signal:b.signal})).then((function(S){return delete m.request,m.aborted?(m.state="unloaded",o(null)):S===void 0?(m.state="errored",o(null)):S===null?(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",o(null)):function(C){return C instanceof ImageData||C instanceof HTMLCanvasElement||C instanceof ImageBitmap||C instanceof HTMLImageElement}(S)?(this.loadTileData(m,S),m.state="loaded",void o(null)):(m.state="errored",o(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(S=>{S.code!==20&&(m.state="errored",o(S))}),m.request.cancel=()=>b.abort()}loadTileData(m,o){m.setTexture(o,this._map.painter)}unloadTile(m,o){if(m.texture&&m.texture instanceof i.T?(m.destroy(!0),m.texture&&m.texture instanceof i.T&&this._map.painter.saveTileTexture(m.texture)):m.destroy(),this._implementation.unloadTile){let{x:h,y:g,z:y}=m.tileID.canonical;this._implementation.unloadTile({x:h,y:g,z:y})}o&&o()}abortTile(m,o){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),o&&o()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z}))}_clearTiles(){let m=i.al(this.id,this.scope);this._map.style.clearSource(m)}_update(){this.fire(new i.f("data",{dataType:"source",sourceDataType:"content"}))}}},ln=function(m,o,h,g){let y=new ur[o.type](m,o,h,g);if(y.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${y.id}`);return i.bp(["load","abort","unload","serialize","prepare"],y),y};class ua extends i.bv{constructor(o){let h={type:"raster-dem",maxzoom:o.transform.maxZoom},g=new i.bw(i.bx(),null),y=ln("mock-dem",h,g,o.style);super("mock-dem",y,!1),y.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,h){o.state="loaded",h(null)}}class Ma extends i.bv{constructor(o){let h=ln("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},new i.bw(i.bx(),null),o.style);super("proxy",h,!1),h.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,h,g){if(o.freezeTileCoverage)return;this.transform=o;let y=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((b,S)=>{if(b[S.key]="",!this._tiles[S.key]){let C=new i.by(S,this._source.tileSize*S.overscaleFactor(),o.tileZoom);C.state="loaded",this._tiles[S.key]=C}return b},{});for(let b in this._tiles)b in y||(this.freeFBO(b),this._tiles[b].unloadVectorData(),delete this._tiles[b])}freeFBO(o){let h=this.proxyCachedFBO[o];if(h!==void 0){let g=Object.values(h);this.renderCachePool.push(...g),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach(o=>o.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Ra extends i.aL{constructor(o,h,g){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=h,this.projMatrix=g}}class vo extends i.bq{constructor(o,h){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},o.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),o.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),o.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};let[g,y,b]=function(P){let O=new i.bt,j=new i.bu,X=131;O.reserve(17161),j.reserve(33800);let re=i.a3/128,ae=i.a3+re/2,ue=ae+re;for(let fe=-re;fe<ue;fe+=re)for(let me=-re;me<ue;me+=re){let Le=me<0||me>ae||fe<0||fe>ae?24575:0,Oe=i.at(Math.round(me),0,i.a3),Ne=i.at(Math.round(fe),0,i.a3);O.emplaceBack(Oe+Le,Ne)}let he=(fe,me)=>{let Le=me*X+fe;j.emplaceBack(Le+1,Le,Le+X),j.emplaceBack(Le+X,Le+X+1,Le+1)};for(let fe=1;fe<129;fe++)for(let me=1;me<129;me++)he(me,fe);return[0,129].forEach(fe=>{for(let me=0;me<130;me++)he(me,fe),he(fe,me)}),[O,j,32768]}(),S=o.context;this.gridBuffer=S.createVertexBuffer(g,i.br.members),this.gridIndexBuffer=S.createIndexBuffer(y),this.gridSegments=i.b.simpleSegment(0,0,g.length,y.length),this.gridNoSkirtSegments=i.b.simpleSegment(0,0,g.length,b),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Ma(h.map),this.orthoMatrix=i.ad.create(),i.ad.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.a3,0,i.a3,0,1);let C=S.gl;this._overlapStencilMode=new i.ag({func:C.GEQUAL,mask:255},0,255,C.KEEP,C.KEEP,C.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=h,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new ua(h.map),this._pendingGroundEffectLayers=[]}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),this._style=o,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(o,h,g){if(o&&o.terrain){this._style!==o&&(this.style=o,this._evaluationZoom=void 0);let y=o.terrain.properties,b=o.terrain.drapeRenderMode===0,S=o.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.e.now();let C=o.terrain&&o.terrain.scope,P=y.get("source"),O=b?this._mockSourceCache:o.getSourceCache(P,C);if(!O)return void i.w(`Couldn't find terrain source "${P}".`);if(this.sourceCache=O,this._exaggeration=S?this.calculateExaggeration(h):y.get("exaggeration"),!h.projection.requiresDraping&&S&&this._exaggeration===0)return void this._disable();this.enabled=!0;let j=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);let X=this.getScaledDemTileSize();this.sourceCache.update(h,X,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,j(),this._initializing=!0),j(),h.updateElevation(!0,g),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(h),this._emptyDEMTextureDirty=!0,this._previousZoom=h.zoom}else this._disable()}calculateExaggeration(o){let h=this._previousCameraAltitude,g=o.getFreeCameraOptions().position.z/o.pixelsPerMeter*o.worldSize;this._previousCameraAltitude=g;let y=h!=null?g-h:Number.MAX_VALUE;if(Math.abs(y)<2)return this._exaggeration;let b=o.zoom,S=this._style.terrain;if(!this._previousUpdateTimestamp)return S.getExaggeration(b);let C=b-this._previousZoom,P=this._previousUpdateTimestamp,O=b;this._evaluationZoom!=null&&(O=this._evaluationZoom,Math.abs(b-O)>.5&&(C=.5*(b-O+C)),C*y<0&&(O+=C)),this._evaluationZoom=O;let j=S.getExaggeration(O),X=j===S.getExaggeration(Math.max(0,O-.1));if(X&&Math.abs(j-this._exaggeration)<.01)return j;let re=Math.min(.1,.00375*(this._updateTimestamp-P));return(X||j<.1||Math.abs(C)<1e-4)&&(re=Math.min(.2,4*re)),i.a2(this._exaggeration,j,re)}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(o){o.coord&&o.dataType==="source"?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):o.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(let o in this._style._mergedSourceCaches)this._style._mergedSourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(o=>o.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){let o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;let h=this.proxySourceCache,g=this.painter.transform;this._initializing&&(this._initializing=g._centerAltitude===0&&this.getAtPointOrZero(i.Y.fromLngLat(g.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);let y=this.proxyCoords=h.getIds().map(P=>{let O=h.getTileByID(P).tileID;return O.projMatrix=g.calculateProjMatrix(O.toUnwrapped()),O});(function(P,O){let j=O.transform.pointCoordinate(O.transform.getCameraPoint()),X=new i.P(j.x,j.y);P.sort((re,ae)=>{if(ae.overscaledZ-re.overscaledZ)return ae.overscaledZ-re.overscaledZ;let ue=new i.P(re.canonical.x+(1<<re.canonical.z)*re.wrap,re.canonical.y),he=new i.P(ae.canonical.x+(1<<ae.canonical.z)*ae.wrap,ae.canonical.y),fe=X.mult(1<<re.canonical.z);return fe.x-=.5,fe.y-=.5,fe.distSqr(ue)-fe.distSqr(he)})})(y,this.painter);let b=this.proxyToSource||{};this.proxyToSource={},y.forEach(P=>{this.proxyToSource[P.key]={}}),this.terrainTileForTile={};let S=this._style._mergedSourceCaches;for(let P in S){let O=S[P];if(!O.used||(O!==this.sourceCache&&this.resetTileLookupCache(O.id),this._setupProxiedCoordsForOrtho(O,o[P],b),O.usedForTerrain))continue;let j=o[P];O.getSource().reparseOverscaled&&this._assignTerrainTiles(j)}this.proxiedCoords[h.id]=y.map(P=>new Ra(P,P.key,this.orthoMatrix)),this._assignTerrainTiles(y),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(b),this.renderingToTexture=!1;let C={};this._visibleDemTiles=[];for(let P of this.proxyCoords){let O=this.terrainTileForTile[P.key];if(!O)continue;let j=O.tileID.key;j in C||(this._visibleDemTiles.push(O),C[j]=j)}}_assignTerrainTiles(o){this._initializing||o.forEach(h=>{if(this.terrainTileForTile[h.key])return;let g=this._findTileCoveringTileID(h,this.sourceCache);g&&(this.terrainTileForTile[h.key]=g)})}_prepareDEMTextures(){let o=this.painter.context,h=o.gl;for(let g in this.terrainTileForTile){let y=this.terrainTileForTile[g],b=y.dem;!b||y.demTexture&&!y.needsDEMTextureUpload||(o.activeTexture.set(h.TEXTURE1),ed(this.painter,y,b))}}_prepareDemTileUniforms(o,h,g,y){if(!h||h.demTexture==null)return!1;let b=o.tileID.canonical,S=Math.pow(2,h.tileID.canonical.z-b.z),C=y||"";return g[`u_dem_tl${C}`]=[b.x*S%1,b.y*S%1],g[`u_dem_scale${C}`]=S,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){let o=this.painter.context,h=o.gl;if(!this._emptyDepthBufferTexture){let g=new i.i({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new i.T(o,g,h.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let o=0,h=this._visibleDemTiles.reduce((g,y)=>{if(!y.dem)return g;let b=y.dem.tree.minimums[0];return b>0&&o++,g+b},0);return o?h/o:0}_updateEmptyDEMTexture(){let o=this.painter.context,h=o.gl;o.activeTexture.set(h.TEXTURE2);let g=this._getLoadedAreaMinimum(),[y,b]=(()=>{let C=new i.bz({width:1,height:1},new Float32Array([g]));return[h.R32F,C]})();this._emptyDEMTextureDirty=!1;let S=this._emptyDEMTexture;return S?S.update(b,{premultiply:!1}):S=this._emptyDEMTexture=new i.T(o,b,y,{premultiply:!1}),S}setupElevationDraw(o,h,g){let y=this.painter.context,b=y.gl,S={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0};S.u_exaggeration=this.exaggeration();let C=null,P=null,O=1;if(g&&g.morphing&&this._useVertexMorphing){let ae=g.morphing.srcDemTile,ue=g.morphing.dstDemTile;O=g.morphing.phase,ae&&ue&&(this._prepareDemTileUniforms(o,ae,S,"_prev")&&(P=ae),this._prepareDemTileUniforms(o,ue,S)&&(C=ue))}let j=ae=>ae&&ae.demTexture&&this.painter.linearFloatFilteringSupported()?b.LINEAR:b.NEAREST,X=null;var re;if(this.enabled?P&&C?(X=C.demTexture,y.activeTexture.set(b.TEXTURE4),P.demTexture.bind(j(P),b.CLAMP_TO_EDGE),S.u_dem_lerp=O):(C=this.terrainTileForTile[o.tileID.key],X=this._prepareDemTileUniforms(o,C,S)?C.demTexture:this.emptyDEMTexture):X=this.emptyDEMTexture,y.activeTexture.set(b.TEXTURE2),X&&(S.u_dem_size=(re=X).size[0]===1?1:re.size[0]-2,X.bind(j(C),b.CLAMP_TO_EDGE)),y.activeTexture.set(b.TEXTURE3),g&&g.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),this._depthFBO&&(S.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),S.u_depth_size_inv=[1,1]),g&&g.useMeterToDem&&C){let ae=(1<<C.tileID.canonical.z)*i.ax(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;S.u_meter_to_dem=ae}if(g&&g.labelPlaneMatrixInv&&(S.u_label_plane_matrix_inv=g.labelPlaneMatrixInv),h.setTerrainUniformValues(y,S),this.painter.transform.projection.name==="globe"){let ae=this.globeUniformValues(this.painter.transform,o.tileID.canonical,g&&g.useDenormalizedUpVectorScale);h.setGlobeUniformValues(y,ae)}}globeUniformValues(o,h,g){let y=o.projection;return{u_tile_tl_up:y.upVector(h,0,0),u_tile_tr_up:y.upVector(h,i.a3,0),u_tile_br_up:y.upVector(h,i.a3,i.a3),u_tile_bl_up:y.upVector(h,0,i.a3),u_tile_up_scale:g?i.bs(1):y.upVectorScale(h,o.center.lat,o.worldSize).metersToTile}}renderToBackBuffer(o){let h=this.painter,g=this.painter.context;o.length!==0&&(g.bindFramebuffer.set(null),g.viewport.set([0,0,h.width,h.height]),h.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(y,b,S,C,P){if(y.transform.projection.name==="globe")(function(O,j,X,re,ae){let ue=O.context,he=ue.gl,fe,me,Le=O.transform,Oe=i.ba(O,ue,Le),Ne=(bt,Ct)=>{if(me===Ct)return;let Ht=[Rt[Ct],"PROJECTION_GLOBE_VIEW"];Oe&&Ht.push("CUSTOM_ANTIALIASING");let qt=O.isTileAffectedByFog(bt);fe=O.getOrCreateProgram("globeRaster",{defines:Ht,overrideFog:qt}),me=Ct},Je=O.colorModeForRenderPass(),Ke=new i.ae(he.LEQUAL,i.ae.ReadWrite,O.depthRangeFor3D);vt.update(ae);let Pe=i.bb(Le),Be=[i.aj(Le.center.lng),i.ak(Le.center.lat)],je=O.globeSharedBuffers,at=[Le.width*i.e.devicePixelRatio,Le.height*i.e.devicePixelRatio],yt=Float32Array.from(Le.globeMatrix),qe={useDenormalizedUpVectorScale:!0};{let bt=O.transform,Ct=si(bt.zoom,j.exaggeration(),j.sourceCache._source.tileSize);me=-1;let Ht=he.TRIANGLES;for(let qt of re){let Ut=X.getTile(qt),ft=i.ag.disabled,kt=j.prevTerrainTileForTile[qt.key],jt=j.terrainTileForTile[qt.key];ct(kt,jt)&&vt.newMorphing(qt.key,kt,jt,ae,250),ue.activeTexture.set(he.TEXTURE0),Ut.texture&&Ut.texture.bind(he.LINEAR,he.CLAMP_TO_EDGE);let di=vt.getMorphValuesForProxy(qt.key),pi=di?1:0;di&&i.o(qe,{morphing:{srcDemTile:di.from,dstDemTile:di.to,phase:i.b9(di.phase)}});let Ai=i.bc(qt.canonical),mi=i.bd(Ai.getCenter().lat),Yt=i.be(qt.canonical,Ai,mi,bt.worldSize/bt._pixelsPerMercatorPixel),Nt=i.bf(i.bg(qt.canonical)),Li=$d(bt.expandedFarZProjMatrix,yt,Pe,Nt,i.a1(bt.zoom),Be,bt.frustumCorners.TL,bt.frustumCorners.TR,bt.frustumCorners.BR,bt.frustumCorners.BL,bt.globeCenterInViewSpace,bt.globeRadius,at,Ct,bt._farZ,Yt);if(Ne(qt,pi),fe&&(j.setupElevationDraw(Ut,fe,qe),O.uploadCommonUniforms(ue,fe,qt.toUnwrapped()),je)){let[pr,nr,Ir]=je.getGridBuffers(mi,Ct!==0);fe.draw(O,Ht,Ke,ft,Je,i.af.backCCW,Li,"globe_raster",pr,nr,Ir)}}}if(je&&(O.renderDefaultNorthPole||O.renderDefaultSouthPole)){let bt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Oe&&bt.push("CUSTOM_ANTIALIASING"),fe=O.getOrCreateProgram("globeRaster",{defines:bt});for(let Ct of re){let{x:Ht,y:qt,z:Ut}=Ct.canonical,ft=qt===0,kt=qt===(1<<Ut)-1,[jt,di,pi,Ai]=je.getPoleBuffers(Ut,!1);if(Ai&&(ft||kt)){let mi=X.getTile(Ct);ue.activeTexture.set(he.TEXTURE0),mi.texture&&mi.texture.bind(he.LINEAR,he.CLAMP_TO_EDGE);let Yt=i.bh(Ut,Ht,Le),Nt=i.bf(i.bg(Ct.canonical)),Li=(pr,nr)=>pr.draw(O,he.TRIANGLES,Ke,i.ag.disabled,Je,i.af.disabled,$d(Le.expandedFarZProjMatrix,Yt,Yt,Nt,0,Be,Le.frustumCorners.TL,Le.frustumCorners.TR,Le.frustumCorners.BR,Le.frustumCorners.BL,Le.globeCenterInViewSpace,Le.globeRadius,at,0,Le._farZ),"globe_pole_raster",nr,pi,Ai);j.setupElevationDraw(mi,fe,qe),O.uploadCommonUniforms(ue,fe,Ct.toUnwrapped()),ft&&O.renderDefaultNorthPole&&Li(fe,jt),kt&&O.renderDefaultSouthPole&&(Yt=i.ad.scale(i.ad.create(),Yt,[1,-1,1]),Li(fe,di))}}}})(y,b,S,C,P);else{let O=y.context,j=O.gl,X,re,ae=y.shadowRenderer,ue=$s(y,y.longestCutoffRange),he=Je=>{if(re===Je)return;let Ke=[];Ke.push(Rt[Je]),ue.shouldRenderCutoff&&Ke.push("RENDER_CUTOFF"),X=y.getOrCreateProgram("terrainRaster",{defines:Ke}),re=Je},fe=y.colorModeForRenderPass(),me=new i.ae(j.LEQUAL,i.ae.ReadWrite,y.depthRangeFor3D);vt.update(P);let Le=y.transform,Oe=si(Le.zoom,b.exaggeration(),b.sourceCache._source.tileSize),Ne=[0,0,0];if(ae){let Je=y.style.directionalLight,Ke=y.style.ambientLight;Je&&Ke&&(Ne=U(y.style,Je,Ke))}{re=-1;let Je=j.TRIANGLES,[Ke,Pe]=[b.gridIndexBuffer,b.gridSegments];for(let Be of C){let je=S.getTile(Be),at=i.ag.disabled,yt=b.prevTerrainTileForTile[Be.key],qe=b.terrainTileForTile[Be.key];ct(yt,qe)&&vt.newMorphing(Be.key,yt,qe,P,250),O.activeTexture.set(j.TEXTURE0),je.texture&&je.texture.bind(j.LINEAR,j.CLAMP_TO_EDGE);let bt=vt.getMorphValuesForProxy(Be.key),Ct=bt?1:0,Ht;bt&&(Ht={morphing:{srcDemTile:bt.from,dstDemTile:bt.to,phase:i.b9(bt.phase)}});let qt=hi(Be.projMatrix,Mi(Be.canonical,Le.renderWorldCopies)?Oe/10:Oe,Ne);if(he(Ct),!X)continue;b.setupElevationDraw(je,X,Ht);let Ut=Be.toUnwrapped();ae&&ae.setupShadows(Ut,X),y.uploadCommonUniforms(O,X,Ut,null,ue),X.draw(y,Je,me,at,fe,i.af.backCCW,qt,"terrain_raster",b.gridBuffer,Ke,Pe)}}}}(h,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,h.gpuTimingDeferredRenderEnd(),o.splice(0,o.length))}renderBatch(o){if(this._drapedRenderBatches.length===0)return o+1;this.renderingToTexture=!0;let h=this.painter,g=this.painter.context,y=this.proxySourceCache,b=this.proxiedCoords[y.id],S=this._drapedRenderBatches.shift(),C=h.style.order,P=[],O=0;for(let j of b){let X=y.getTileByID(j.proxyTileKey),re=y.proxyCachedFBO[j.key]?y.proxyCachedFBO[j.key][o]:void 0,ae=re!==void 0?y.renderCache[re]:this.pool[O++],ue=re!==void 0;if(X.texture=ae.tex,ue&&!ae.dirty){P.push(X.tileID);continue}let he;g.bindFramebuffer.set(ae.fb.framebuffer),this.renderedToTile=!1,ae.dirty&&(g.clear({color:i.C.transparent,stencil:0}),ae.dirty=!1);for(let fe=S.start;fe<=S.end;++fe){let me=h.style._mergedLayers[C[fe]];if(me.isHidden(h.transform.zoom))continue;let Le=h.style.getLayerSourceCache(me),Oe=Le?this.proxyToSource[j.key][Le.id]:[j];if(!Oe)continue;let Ne=Oe;g.viewport.set([0,0,ae.fb.width,ae.fb.height]),he!==(Le?Le.id:null)&&(this._setupStencil(ae,Oe,me,Le),he=Le?Le.id:null),h.renderLayer(h,Le,me,Ne)}if(this._drapedRenderBatches.length===0)for(let fe of this._pendingGroundEffectLayers){let me=h.style._mergedLayers[C[fe]];if(me.isHidden(h.transform.zoom))continue;let Le=h.style.getLayerSourceCache(me),Oe=Le?this.proxyToSource[j.key][Le.id]:[j];if(!Oe)continue;let Ne=Oe;g.viewport.set([0,0,ae.fb.width,ae.fb.height]),he!==(Le?Le.id:null)&&(this._setupStencil(ae,Oe,me,Le),he=Le?Le.id:null),h.renderLayer(h,Le,me,Ne)}this.renderedToTile?(ae.dirty=!0,P.push(X.tileID)):ue||--O,O===5&&(O=0,this.renderToBackBuffer(P))}return this.renderToBackBuffer(P),this.renderingToTexture=!1,g.bindFramebuffer.set(null),g.viewport.set([0,0,h.width,h.height]),S.end+1}postRender(){}isLayerOrderingCorrect(o){let h=o.order.length,g=-1,y=h;for(let b=0;b<h;++b)this._style.isLayerDraped(o._mergedLayers[o.order[b]])?g=Math.max(g,b):y=Math.min(y,b);return y>g}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter(h=>h.dem).forEach(h=>{o=Math.min(o,h.dem.tree.minimums[0])}),o===0?o:(o-30)*this._exaggeration}raycast(o,h,g){if(!this._visibleDemTiles)return null;let y=this._visibleDemTiles.filter(b=>b.dem).map(b=>{let S=b.tileID,C=1<<S.overscaledZ,{x:P,y:O}=S.canonical,j=P/C,X=(P+1)/C,re=O/C,ae=(O+1)/C;return{minx:j,miny:re,maxx:X,maxy:ae,t:b.dem.tree.raycastRoot(j,re,X,ae,o,h,g),tile:b}});y.sort((b,S)=>(b.t!==null?b.t:Number.MAX_VALUE)-(S.t!==null?S.t:Number.MAX_VALUE));for(let b of y){if(b.t==null)return null;let S=b.tile.dem.tree.raycast(b.minx,b.miny,b.maxx,b.maxy,o,h,g);if(S!=null)return S}return null}_createFBO(){let o=this.painter.context,h=o.gl,g=this.drapeBufferSize;o.activeTexture.set(h.TEXTURE0);let y=new i.T(o,{width:g[0],height:g[1],data:null},h.RGBA);y.bind(h.LINEAR,h.CLAMP_TO_EDGE);let b=o.createFramebuffer(g[0],g[1],!0,null);return b.colorAttachment.set(y.texture),b.depthAttachment=new kr(o,b.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,g[0],g[1]),this._stencilRef=0,b.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):b.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&h.texParameterf(h.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:b,tex:y,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(let o in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[o].hasTransition())return!0;return this._style.order.some(o=>{let h=this._style._mergedLayers[o],g=h.isHidden(this.painter.transform.zoom);return h.type==="custom"?!g&&h.shouldRedrape():!g&&h.hasTransition()})}_clearLineLayersFromRenderCache(){let o=!1;for(let g of this._style.getSources())if(g instanceof Bc){o=!0;break}if(!o)return;let h={};for(let g=0;g<this._style.order.length;++g){let y=this._style._mergedLayers[this._style.order[g]],b=this._style.getLayerSourceCache(y);if(b&&!h[b.id]&&!y.isHidden(this.painter.transform.zoom)&&y.type==="line"&&y.widthExpression()instanceof i.Z){h[b.id]=!0;for(let S of this.proxyCoords){let C=this.proxyToSource[S.key][b.id];if(C)for(let P of C)this._clearRenderCacheForTile(b.id,P)}}}}_clearRasterLayersFromRenderCache(){let o=!1;for(let g in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[g]._source instanceof Pl){o=!0;break}if(!o)return;let h={};for(let g=0;g<this._style.order.length;++g){let y=this._style._mergedLayers[this._style.order[g]],b=this._style.getLayerSourceCache(y);if(!b||h[b.id]||y.isHidden(this.painter.transform.zoom)||y.type!=="raster")continue;let S=y.paint.get("raster-fade-duration");for(let C of this.proxyCoords){let P=this.proxyToSource[C.key][b.id];if(P)for(let O of P){let j=cr(b.getTile(O),b.findLoadedParent(O,0),b,this.painter.transform,S);(j.opacity!==1||j.mix!==0)&&this._clearRenderCacheForTile(b.id,O)}}}}_setupDrapedRenderBatches(){let o=this._style.order,h=o.length;if(h===0)return;let g=[];this._pendingGroundEffectLayers=[];let y,b=0,S=this._style._mergedLayers[o[b]];for(;!this._style.isLayerDraped(S)&&S.isHidden(this.painter.transform.zoom)&&++b<h;)S=this._style._mergedLayers[o[b]];for(;b<h;++b){let C=this._style._mergedLayers[o[b]];C.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(C)?y===void 0&&(y=b):(C.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(b),y!==void 0&&(g.push({start:y,end:b-1}),y=void 0)))}if(y!==void 0&&g.push({start:y,end:b-1}),g.length!==0){let C=g[g.length-1];this._pendingGroundEffectLayers.every(P=>P>C.end)||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=g}_setupRenderCache(o){let h=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,h.renderCache.length>h.renderCachePool.length){let S=Object.values(h.proxyCachedFBO);h.proxyCachedFBO={};for(let C=0;C<S.length;++C){let P=Object.values(S[C]);h.renderCachePool.push(...P)}}return}this._clearRasterLayersFromRenderCache();let g=this.proxyCoords,y=this._tilesDirty;for(let S=g.length-1;S>=0;S--){let C=g[S];if(h.getTileByID(C.key),h.proxyCachedFBO[C.key]!==void 0){let P=o[C.key],O=this.proxyToSource[C.key],j=0;for(let X in O){let re=O[X],ae=P[X];if(!ae||ae.length!==re.length||re.some((ue,he)=>ue!==ae[he]||y[X]&&y[X].hasOwnProperty(ue.key))){j=-1;break}++j}for(let X in h.proxyCachedFBO[C.key])h.renderCache[h.proxyCachedFBO[C.key][X]].dirty=j<0||j!==Object.values(P).length}}let b=[...this._drapedRenderBatches];b.sort((S,C)=>C.end-C.start-(S.end-S.start));for(let S of b)for(let C of g){if(h.proxyCachedFBO[C.key])continue;let P=h.renderCachePool.pop();P===void 0&&h.renderCache.length<50&&(P=h.renderCache.length,h.renderCache.push(this._createFBO())),P!==void 0&&(h.proxyCachedFBO[C.key]={},h.proxyCachedFBO[C.key][S.start]=P,h.renderCache[P].dirty=!0)}this._tilesDirty={}}_setupStencil(o,h,g,y){if(!y||!this._sourceTilesOverlap[y.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));let b=this.painter.context,S=b.gl;if(h.length<=1)return void(this._overlapStencilType=!1);let C;if(g.isTileClipped())C=h.length,this._overlapStencilMode.test={func:S.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(h[0].overscaledZ>h[h.length-1].overscaledZ))return void(this._overlapStencilType=!1);C=1,this._overlapStencilMode.test={func:S.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+C>255&&(b.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=C,this._overlapStencilMode.ref=this._stencilRef,g.isTileClipped()&&this._renderTileClippingMasks(h,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):i.ag.disabled}_renderTileClippingMasks(o,h){let g=this.painter,y=this.painter.context,b=y.gl;g._tileClippingMaskIDs={},y.setColorMode(i.a.disabled),y.setDepthMode(i.ae.disabled);let S=g.getOrCreateProgram("clippingMask");for(let C of o){let P=g._tileClippingMaskIDs[C.key]=--h;S.draw(g,b.TRIANGLES,i.ae.disabled,new i.ag({func:b.ALWAYS,mask:0},P,255,b.KEEP,b.KEEP,b.REPLACE),i.a.disabled,i.af.disabled,Zi(C.projMatrix),"$clipping",g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}}pointCoordinate(o){let h=this.painter.transform;if(o.x<0||o.x>h.width||o.y<0||o.y>h.height)return null;let g=[o.x,o.y,1,1];i.aA.transformMat4(g,g,h.pixelMatrixInverse),i.aA.scale(g,g,1/g[3]),g[0]/=h.worldSize,g[1]/=h.worldSize;let y=h._camera.position,b=i.ax(1,h.center.lat),S=[y[0],y[1],y[2]/b,0],C=i._.subtract([],g.slice(0,3),S);i._.normalize(C,C);let P=this.raycast(S,C,this._exaggeration);return P!==null&&P?(i._.scaleAndAdd(S,S,C,P),S[3]=S[2],S[2]*=b,S):null}drawDepth(){let o=this.painter,h=o.context,g=this.proxySourceCache,y=Math.ceil(o.width),b=Math.ceil(o.height);if(!this._depthFBO||this._depthFBO.width===y&&this._depthFBO.height===b||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){let S=h.gl,C=h.createFramebuffer(y,b,!0,"renderbuffer");h.activeTexture.set(S.TEXTURE0);let P=new i.T(h,{width:y,height:b,data:null},S.RGBA);P.bind(S.NEAREST,S.CLAMP_TO_EDGE),C.colorAttachment.set(P.texture);let O=h.createRenderbuffer(h.gl.DEPTH_COMPONENT16,y,b);C.depthAttachment.set(O),this._depthFBO=C,this._depthTexture=P}h.bindFramebuffer.set(this._depthFBO.framebuffer),h.viewport.set([0,0,y,b]),function(S,C,P,O){if(S.transform.projection.name==="globe")return;let j=S.context,X=j.gl;j.clear({depth:1});let re=S.getOrCreateProgram("terrainDepth"),ae=new i.ae(X.LESS,i.ae.ReadWrite,S.depthRangeFor3D);for(let ue of O){let he=P.getTile(ue),fe=hi(ue.projMatrix,0,[0,0,0]);C.setupElevationDraw(he,re),re.draw(S,X.TRIANGLES,ae,i.ag.disabled,i.a.unblended,i.af.backCCW,fe,"terrain_depth",C.gridBuffer,C.gridIndexBuffer,C.gridNoSkirtSegments)}}(o,this,g,this.proxyCoords)}_setupProxiedCoordsForOrtho(o,h,g){if(o.getSource()instanceof i.bm)return this._setupProxiedCoordsForImageSource(o,h,g);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};let y=this.proxiedCoords[o.id]=[],b=this.proxyCoords;for(let P=0;P<b.length;P++){let O=b[P],j=this._findTileCoveringTileID(O,o);if(j){let X=this._createProxiedId(O,j,g[O.key]&&g[O.key][o.id]);y.push(X),this.proxyToSource[O.key][o.id]=[X]}}let S=!1,C=new Set;for(let P=0;P<h.length;P++){let O=o.getTile(h[P]);if(!O||!O.hasData())continue;let j=this._findTileCoveringTileID(O.tileID,this.proxySourceCache);if(j&&j.tileID.canonical.z!==O.tileID.canonical.z){let X=this.proxyToSource[j.tileID.key][o.id],re=this._createProxiedId(j.tileID,O,g[j.tileID.key]&&g[j.tileID.key][o.id]);X?X.splice(X.length-1,0,re):this.proxyToSource[j.tileID.key][o.id]=[re];let ae=this.proxyToSource[j.tileID.key][o.id];C.has(ae)||C.add(ae),y.push(re),S=!0}}if(this._sourceTilesOverlap[o.id]=S,S&&this._debugParams.sortTilesHiZFirst)for(let P of C)P.sort((O,j)=>j.overscaledZ-O.overscaledZ)}_setupProxiedCoordsForImageSource(o,h,g){if(!o.getSource().loaded())return;let y=this.proxiedCoords[o.id]=[],b=this.proxyCoords,S=o.getSource(),C=S.tileID;if(!C)return;let P=new i.P(C.x,C.y)._div(1<<C.z),O=S.coordinates.map(i.Y.fromLngLat).reduce((X,re)=>(X.min.x=Math.min(X.min.x,re.x-P.x),X.min.y=Math.min(X.min.y,re.y-P.y),X.max.x=Math.max(X.max.x,re.x-P.x),X.max.y=Math.max(X.max.y,re.y-P.y),X),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),j=(X,re)=>{let ae=X.wrap+X.canonical.x/(1<<X.canonical.z),ue=X.canonical.y/(1<<X.canonical.z),he=i.a3/(1<<X.canonical.z),fe=re.wrap+re.canonical.x/(1<<re.canonical.z),me=re.canonical.y/(1<<re.canonical.z);return ae+he<fe+O.min.x||ae>fe+O.max.x||ue+he<me+O.min.y||ue>me+O.max.y};for(let X=0;X<b.length;X++){let re=b[X];for(let ae=0;ae<h.length;ae++){let ue=o.getTile(h[ae]);if(!ue||!ue.hasData()||j(re,ue.tileID))continue;let he=this._createProxiedId(re,ue,g[re.key]&&g[re.key][o.id]),fe=this.proxyToSource[re.key][o.id];fe?fe.push(he):this.proxyToSource[re.key][o.id]=[he],y.push(he)}}}_createProxiedId(o,h,g){let y=this.orthoMatrix;if(g){let b=g.find(S=>S.key===h.tileID.key);if(b)return b}if(h.tileID.key!==o.key){let b=o.canonical.z-h.tileID.canonical.z,S,C,P;y=i.ad.create();let O=h.tileID.wrap-o.wrap<<o.overscaledZ;b>0?(S=i.a3>>b,C=S*((h.tileID.canonical.x<<b)-o.canonical.x+O),P=S*((h.tileID.canonical.y<<b)-o.canonical.y)):(S=i.a3<<-b,C=i.a3*(h.tileID.canonical.x-(o.canonical.x+O<<-b)),P=i.a3*(h.tileID.canonical.y-(o.canonical.y<<-b))),i.ad.ortho(y,0,S,0,S,0,1),i.ad.translate(y,y,[C,P,0])}return new Ra(h.tileID,o.key,y)}_findTileCoveringTileID(o,h){let g=h.getTile(o);if(g&&g.hasData())return g;let y=this._findCoveringTileCache[h.id],b=y[o.key];if(g=b?h.getTileByID(b):null,g&&g.hasData()||b===null)return g;let S=g?g.tileID:o,C=S.overscaledZ,P=h.getSource().minzoom,O=[];if(!b){let X=h.getSource().maxzoom;if(o.canonical.z>=X){let re=o.canonical.z-X;h.getSource().reparseOverscaled?(C=Math.max(o.canonical.z+2,h.transform.tileZoom),S=new i.aL(C,o.wrap,X,o.canonical.x>>re,o.canonical.y>>re)):re!==0&&(C=X,S=new i.aL(C,o.wrap,X,o.canonical.x>>re,o.canonical.y>>re))}S.key!==o.key&&(O.push(S.key),g=h.getTile(S))}let j=X=>{O.forEach(re=>{y[re]=X}),O.length=0};for(C-=1;C>=P&&(!g||!g.hasData());C--){g&&j(g.tileID.key);let X=S.calculateScaledKey(C);if(g=h.getTileByID(X),g&&g.hasData())break;let re=y[X];if(re===null)break;re===void 0?O.push(X):g=h.getTileByID(re)}return j(g?g.tileID.key:null),g&&g.hasData()?g:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(o,h){let g=this._tilesDirty[o];g||(g=this._tilesDirty[o]={}),g[h.key]=!0}}function ra(m,o,h){let g=function(C,P,O){let j=i._.dot(P,C),X=i._.dot(O,[.2126,.7152,.0722]),re=(ue,he,fe)=>(1-fe)*ue+fe*he,ae=re(1-.3*Math.min(X,1),1,Math.min(j+1,1));return re(.92,1,Math.asin(i.at(P[2],-1,1))/Math.PI+.5)*ae}(m,[0,0,1],o),y=[0,0,0];i._.scale(y,h.slice(0,3),g);let b=[0,0,0];i._.scale(b,o.slice(0,3),m[2]);let S=[0,0,0];return i._.add(S,y,b),i.b8(S)}let cs=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],us=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class Ms{static cacheKey(o,h,g,y){let b=`${h}${y?y.cacheKey:""}`;for(let S of g)o.usedDefines.includes(S)&&(b+=`/${S}`);return b}constructor(o,h,g,y,b,S){let C=o.gl;this.program=C.createProgram(),this.configuration=y,this.name=h,this.fixedDefines=[...S];let P=y?y.getBinderAttributes():[],O=(g.staticAttributes||[]).concat(P),j=y?y.defines():[];j=j.concat(S.map(fe=>`#define ${fe}`));let X=`#version 300 es
`,re=X+j.concat("precision mediump float;",gu,mu.fragmentSource).join(`
`);for(let fe of g.fragmentIncludes)re+=`
${uh[fe]}`;re+=`
${g.fragmentSource}`;let ae=X+j.concat("precision highp float;",gu,mu.vertexSource).join(`
`);for(let fe of g.vertexIncludes)ae+=`
${uh[fe]}`;ae+=`
${g.vertexSource}`;let ue=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);C.shaderSource(ue,re),C.compileShader(ue),C.attachShader(this.program,ue);let he=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())this.failedToCreate=!0;else{C.shaderSource(he,ae),C.compileShader(he),C.attachShader(this.program,he),this.attributes={},this.numAttributes=O.length;for(let fe=0;fe<this.numAttributes;fe++)if(O[fe]){let me=O[fe].startsWith("a_")?O[fe]:`a_${O[fe]}`;C.bindAttribLocation(this.program,fe,me),this.attributes[me]=fe}C.linkProgram(this.program),C.deleteShader(he),C.deleteShader(ue),this.fixedUniforms=b(o),this.binderUniforms=y?y.getUniforms(o):[],S.includes("TERRAIN")&&(this.terrainUniforms=(fe=>({u_dem:new i.a7(fe),u_dem_prev:new i.a7(fe),u_dem_tl:new i.a8(fe),u_dem_scale:new i.aa(fe),u_dem_tl_prev:new i.a8(fe),u_dem_scale_prev:new i.aa(fe),u_dem_size:new i.aa(fe),u_dem_lerp:new i.aa(fe),u_exaggeration:new i.aa(fe),u_depth:new i.a7(fe),u_depth_size_inv:new i.a8(fe),u_meter_to_dem:new i.aa(fe),u_label_plane_matrix_inv:new i.a6(fe)}))(o)),S.includes("GLOBE")&&(this.globeUniforms=(fe=>({u_tile_tl_up:new i.aq(fe),u_tile_tr_up:new i.aq(fe),u_tile_br_up:new i.aq(fe),u_tile_bl_up:new i.aq(fe),u_tile_up_scale:new i.aa(fe)}))(o)),S.includes("FOG")&&(this.fogUniforms=(fe=>({u_fog_matrix:new i.a6(fe),u_fog_range:new i.a8(fe),u_fog_color:new i.as(fe),u_fog_horizon_blend:new i.aa(fe),u_fog_vertical_limit:new i.a8(fe),u_fog_temporal_offset:new i.aa(fe),u_frustum_tl:new i.aq(fe),u_frustum_tr:new i.aq(fe),u_frustum_br:new i.aq(fe),u_frustum_bl:new i.aq(fe),u_globe_pos:new i.aq(fe),u_globe_radius:new i.aa(fe),u_globe_transition:new i.aa(fe),u_is_globe:new i.a7(fe),u_viewport:new i.a8(fe)}))(o)),S.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(fe=>({u_cutoff_params:new i.as(fe)}))(o)),S.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(fe=>({u_lighting_ambient_color:new i.aq(fe),u_lighting_directional_dir:new i.aq(fe),u_lighting_directional_color:new i.aq(fe),u_ground_radiance:new i.aq(fe)}))(o)),S.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(fe=>({u_light_matrix_0:new i.a6(fe),u_light_matrix_1:new i.a6(fe),u_fade_range:new i.a8(fe),u_shadow_normal_offset:new i.aq(fe),u_shadow_intensity:new i.aa(fe),u_shadow_texel_size:new i.aa(fe),u_shadow_map_resolution:new i.aa(fe),u_shadow_direction:new i.aq(fe),u_shadow_bias:new i.aq(fe),u_shadowmap_0:new i.a7(fe),u_shadowmap_1:new i.a7(fe)}))(o))}}setTerrainUniformValues(o,h){if(!this.terrainUniforms)return;let g=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(let y in h)g[y]&&g[y].set(this.program,y,h[y])}}setGlobeUniformValues(o,h){if(!this.globeUniforms)return;let g=this.globeUniforms;if(!this.failedToCreate){o.program.set(this.program);for(let y in h)g[y]&&g[y].set(this.program,y,h[y])}}setFogUniformValues(o,h){if(!this.fogUniforms)return;let g=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(let y in h)g[y].set(this.program,y,h[y])}}setCutoffUniformValues(o,h){if(!this.cutoffUniforms)return;let g=this.cutoffUniforms;if(!this.failedToCreate){o.program.set(this.program);for(let y in h)g[y].set(this.program,y,h[y])}}setLightsUniformValues(o,h){if(!this.lightsUniforms)return;let g=this.lightsUniforms;if(!this.failedToCreate){o.program.set(this.program);for(let y in h)g[y].set(this.program,y,h[y])}}setShadowUniformValues(o,h){if(this.failedToCreate||!this.shadowUniforms)return;let g=this.shadowUniforms;o.program.set(this.program);for(let y in h)g[y].set(this.program,y,h[y])}_drawDebugWireframe(o,h,g,y,b,S,C,P,O,j){let X=o.options.wireframe;if(X.terrain===!1&&X.layers2D===!1&&X.layers3D===!1)return;let re=o.context;if(!(!(!X.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!X.layers2D||o._terrain&&o._terrain.renderingToTexture||!cs.includes(this.name))||!(!X.layers3D||!us.includes(this.name))))return;let ae=re.gl,ue=o.wireframeDebugCache.getLinesFromTrianglesBuffer(o.frameCounter,b,re);if(!ue)return;let he=[...this.fixedDefines];he.push("DEBUG_WIREFRAME");let fe=o.getOrCreateProgram(this.name,{config:this.configuration,defines:he});re.program.set(fe.program);let me=(Ne,Je,Ke)=>{if(Je[Ne]&&Ke[Ne])for(let Pe in Je[Ne])Ke[Ne][Pe]&&Ke[Ne][Pe].set(Ke.program,Pe,Je[Ne][Pe].current)};O&&O.setUniforms(fe.program,re,fe.binderUniforms,C,{zoom:P}),me("fixedUniforms",this,fe),me("terrainUniforms",this,fe),me("globeUniforms",this,fe),me("fogUniforms",this,fe),me("lightsUniforms",this,fe),me("shadowUniforms",this,fe),ue.bind(),re.setColorMode(new i.a([ae.ONE,ae.ONE_MINUS_SRC_ALPHA,ae.ZERO,ae.ONE],i.C.transparent,[!0,!0,!0,!1])),re.setDepthMode(new i.ae(h.func===ae.LESS?ae.LEQUAL:h.func,i.ae.ReadOnly,h.range)),re.setStencilMode(i.ag.disabled);let Le=3*S.primitiveLength*2,Oe=3*S.primitiveOffset*2*2;j&&j>1?ae.drawElementsInstanced(ae.LINES,Le,ae.UNSIGNED_SHORT,Oe,j):ae.drawElements(ae.LINES,Le,ae.UNSIGNED_SHORT,Oe),b.bind(),re.program.set(this.program),re.setDepthMode(h),re.setStencilMode(g),re.setColorMode(y)}draw(o,h,g,y,b,S,C,P,O,j,X,re,ae,ue,he,fe){let me=o.context,Le=me.gl;if(this.failedToCreate)return;me.program.set(this.program),me.setDepthMode(g),me.setStencilMode(y),me.setColorMode(b),me.setCullFace(S);for(let Je of Object.keys(this.fixedUniforms))this.fixedUniforms[Je].set(this.program,Je,C[Je]);ue&&ue.setUniforms(this.program,me,this.binderUniforms,re,{zoom:ae});let Oe={[Le.POINTS]:1,[Le.LINES]:2,[Le.TRIANGLES]:3,[Le.LINE_STRIP]:1}[h],Ne=fe&&fe>0?1:void 0;for(let Je of X.get()){let Ke=Je.vaos||(Je.vaos={});(Ke[P]||(Ke[P]=new qd)).bind(me,this,O,ue?ue.getPaintVertexBuffers():[],j,Je.vertexOffset,he||[],Ne),fe&&fe>1?Le.drawElementsInstanced(h,Je.primitiveLength*Oe,Le.UNSIGNED_SHORT,Je.primitiveOffset*Oe*2,fe):j?Le.drawElements(h,Je.primitiveLength*Oe,Le.UNSIGNED_SHORT,Je.primitiveOffset*Oe*2):Le.drawArrays(h,Je.vertexOffset,Je.vertexLength),h===Le.TRIANGLES&&j&&this._drawDebugWireframe(o,g,y,b,j,Je,re,ae,ue,fe)}}}function xu(m,o){let h=Math.pow(2,o.tileID.overscaledZ),g=o.tileSize*Math.pow(2,m.transform.tileZoom)/h,y=g*(o.tileID.canonical.x+o.tileID.wrap*h),b=g*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture?o.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.bB(o,1,m.transform.tileZoom),u_pixel_coord_upper:[y>>16,b>>16],u_pixel_coord_lower:[65535&y,65535&b]}}let Uc=i.ad.create(),Nl=(m,o,h,g,y,b,S,C,P,O,j,X,re,ae,ue,he)=>{let fe=o.style.light,me=fe.properties.get("position"),Le=[me.x,me.y,me.z],Oe=i.bC.create();fe.properties.get("anchor")==="viewport"&&(i.bC.fromRotation(Oe,-o.transform.angle),i._.transformMat3(Le,Le,Oe));let Ne=fe.properties.get("color"),Je=o.transform,Ke={u_matrix:m,u_lightpos:Le,u_lightintensity:fe.properties.get("intensity"),u_lightcolor:[Ne.r,Ne.g,Ne.b],u_vertical_gradient:+h,u_opacity:g,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Uc,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:y,u_edge_radius:b,u_flood_light_color:X,u_vertical_scale:re,u_flood_light_intensity:ae,u_ground_shadow_factor:ue,u_emissive_strength:he};return Je.projection.name==="globe"&&(Ke.u_tile_id=[S.canonical.x,S.canonical.y,1<<S.canonical.z],Ke.u_zoom_transition=P,Ke.u_inv_rot_matrix=j,Ke.u_merc_center=O,Ke.u_up_dir=Je.projection.upVector(new i.aO(0,0,0),O[0]*i.a3,O[1]*i.a3),Ke.u_height_lift=C),Ke},ml=(m,o,h)=>({u_matrix:m,u_edge_radius:o,u_vertical_scale:h}),vu=(m,o,h,g,y,b,S,C,P,O,j,X,re,ae)=>{let ue=Nl(m,o,h,g,y,b,S,P,O,j,X,re,ae,1,[0,0,0],0),he={u_height_factor:-Math.pow(2,S.overscaledZ)/C.tileSize/8};return i.W(ue,xu(o,C),he)},yu=(m,o)=>({u_matrix:m,u_emissive_strength:o}),Hc=(m,o,h,g)=>i.W(yu(m,o),xu(h,g)),Zo=(m,o,h)=>({u_matrix:m,u_world:h,u_emissive_strength:o}),fc=(m,o,h,g,y)=>i.W(Hc(m,o,h,g),{u_world:y}),Gc=(m,o,h,g)=>{let y=i.a3/h.tileSize;return{u_matrix:m,u_camera_to_center_distance:o.getCameraToCenterDistance(g),u_extrude_scale:[o.pixelsToGLUnits[0]/y,o.pixelsToGLUnits[1]/y]}},pc=(m,o,h=1)=>({u_matrix:m,u_color:o.toRenderColor(null),u_overlay:0,u_overlay_scale:h}),mc=i.ad.create(),ro=(m,o,h,g,y,b,S)=>{let C=m.transform,P=C.projection.name==="globe",O=P?i.bD(C.zoom,o.canonical)*C._pixelsPerMercatorPixel:i.bB(h,1,b),j={u_matrix:o.projMatrix,u_extrude_scale:O,u_intensity:S,u_inv_rot_matrix:mc,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(P){j.u_inv_rot_matrix=g,j.u_merc_center=y,j.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],j.u_zoom_transition=i.a1(C.zoom);let X=y[0]*i.a3,re=y[1]*i.a3;j.u_up_dir=C.projection.upVector(new i.aO(0,0,0),X,re)}return j};function Zd(m,[o,h,g,y],[b,S]){if(b===S)return[0,0,0,0];let C=255*(m-1)/(m*(S-b));return[o*C,h*C,g*C,y*C]}function bu(m,o,[h,g]){return h===g?0:.5/m+(o-h)*(m-1)/(m*(g-h))}let Wc=(m,o,h,g,y,b,S,C,P,O,j,X,re,ae,ue,he,fe,me,Le,Oe,Ne)=>({u_matrix:m,u_normalize_matrix:o,u_globe_matrix:h,u_merc_matrix:g,u_grid_matrix:y,u_tl_parent:b,u_scale_parent:O,u_fade_t:j.mix,u_opacity:j.opacity*X.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:X.paint.get("raster-brightness-min"),u_brightness_high:X.paint.get("raster-brightness-max"),u_saturation_factor:i.bE(X.paint.get("raster-saturation")),u_contrast_factor:i.bF(X.paint.get("raster-contrast")),u_spin_weights:Yo(X.paint.get("raster-hue-rotate")),u_perspective_transform:re,u_raster_elevation:ae,u_zoom_transition:S,u_merc_center:C,u_cutoff_params:P,u_colorization_mix:Zd(i.bG,he,me),u_colorization_offset:bu(i.bG,fe,me),u_color_ramp:ue,u_texture_offset:[Oe/(Le+2*Oe),Le/(Le+2*Oe)],u_texture_res:[Le+2*Oe,Le+2*Oe],u_emissive_strength:Ne});function Yo(m){m*=Math.PI/180;let o=Math.sin(m),h=Math.cos(m);return[(2*h+1)/3,(-Math.sqrt(3)*o-h+1)/3,(Math.sqrt(3)*o-h+1)/3]}let Xs=.15,td=(m,o,h,g,y,b,S,C,P,O,j,X)=>({u_matrix:m,u_normalize_matrix:o,u_globe_matrix:h,u_merc_matrix:g,u_grid_matrix:y,u_tl_parent:b,u_scale_parent:O,u_fade_t:j.mix,u_opacity:j.opacity,u_image0:0,u_image1:1,u_raster_elevation:X,u_zoom_transition:S,u_merc_center:C,u_cutoff_params:P}),id=(m,o,h,g,y,b,S,C,P,O)=>({u_particle_texture:m,u_particle_texture_side_len:o,u_tile_offset:h,u_velocity:g,u_color_ramp:b,u_velocity_res:y,u_max_speed:S,u_uv_offset:C,u_data_scale:P,u_data_offset:O,u_particle_pos_scale:1.3,u_particle_pos_offset:[Xs,Xs]}),qc=(m,o,h,g,y,b,S,C,P,O)=>({u_particle_texture:m,u_particle_texture_side_len:o,u_velocity:h,u_velocity_res:g,u_max_speed:y,u_speed_factor:b,u_reset_rate:S,u_rand_seed:Math.random(),u_uv_offset:C,u_data_scale:P,u_data_offset:O,u_particle_pos_scale:1.3,u_particle_pos_offset:[Xs,Xs]}),Oa=i.ad.create(),No=(m,o,h,g,y,b,S,C,P,O,j,X,re,ae,ue,he,fe,me)=>{let Le=y.transform,Oe={u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:Le.getCameraToCenterDistance(he),u_rotate_symbol:+h,u_aspect_ratio:Le.width/Le.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:S,u_coord_matrix:C,u_is_text:+P,u_pitch_with_map:+g,u_texsize:O,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Oa,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Oa,u_up_vector:[0,-1,0],u_color_adj_mat:fe,u_icon_transition:me||0};return he.name==="globe"&&(Oe.u_tile_id=[j.canonical.x,j.canonical.y,1<<j.canonical.z],Oe.u_zoom_transition=X,Oe.u_inv_rot_matrix=ae,Oe.u_merc_center=re,Oe.u_camera_forward=Le._camera.forward(),Oe.u_ecef_origin=i.bH(Le.globeMatrix,j.toUnwrapped()),Oe.u_tile_matrix=Float32Array.from(Le.globeMatrix),Oe.u_up_vector=ue),Oe},gl=(m,o,h,g,y,b,S,C,P,O,j,X,re,ae,ue,he,fe)=>i.W(No(m,o,h,g,y,b,S,C,P,O,X,re,ae,ue,he,fe),{u_gamma_scale:g?y.transform.getCameraToCenterDistance(fe)*Math.cos(y.terrain?0:y.transform._pitch):1,u_device_pixel_ratio:i.e.devicePixelRatio,u_is_halo:+j,undefined:void 0}),_l=(m,o,h,g,y,b,S,C,P,O,j,X,re,ae,ue,he)=>i.W(gl(m,o,h,g,y,b,S,C,!0,P,!0,j,X,re,ae,ue,he),{u_texsize_icon:O,u_texture_icon:1}),Ds=(m,o,h,g)=>({u_matrix:m,u_emissive_strength:o,u_opacity:h,u_color:g}),wu=(m,o,h,g,y,b,S,C)=>i.W(function(P,O,j,X,re){let{width:ae,height:ue}=X.imageManager.getPixelSize(O),he=Math.pow(2,re.tileID.overscaledZ),fe=re.tileSize*Math.pow(2,X.transform.tileZoom)/he,me=fe*(re.tileID.canonical.x+re.tileID.wrap*he),Le=fe*re.tileID.canonical.y;return{u_image:0,u_pattern_tl:j.tl,u_pattern_br:j.br,u_texsize:[ae,ue],u_pattern_size:j.displaySize,u_tile_units_to_pixels:1/i.bB(re,1,X.transform.tileZoom),u_pixel_coord_upper:[me>>16,Le>>16],u_pixel_coord_lower:[65535&me,65535&Le]}}(0,b,S,g,C),{u_matrix:m,u_emissive_strength:o,u_opacity:h}),Fs=new Float32Array(i.ad.identity([])),Bl=(m,o,h,g,y,b,S,C,P,O,j,X,re,ae=[0,0,0],ue)=>{let he=y.style.light,fe=he.properties.get("position"),me=[-fe.x,-fe.y,fe.z],Le=i.bC.create();he.properties.get("anchor")==="viewport"&&(i.bC.fromRotation(Le,-y.transform.angle),i._.transformMat3(me,me,Le));let Oe=j.alphaMode==="MASK",Ne=he.properties.get("color").toRenderColor(null),Je=re.paint.get("model-ambient-occlusion-intensity"),Ke=re.paint.get("model-color").constantOr(i.C.white).toRenderColor(null),Pe=re.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:m,u_lighting_matrix:o,u_normal_matrix:h,u_node_matrix:g||Fs,u_lightpos:me,u_lightintensity:he.properties.get("intensity"),u_lightcolor:[Ne.r,Ne.g,Ne.b],u_camera_pos:ae,u_opacity:b,u_baseTextureIsAlpha:0,u_alphaMask:+Oe,u_alphaCutoff:j.alphaCutoff,u_baseColorFactor:[S.r,S.g,S.b,S.a],u_emissiveFactor:[C[0],C[1],C[2],1],u_metallicFactor:P,u_roughnessFactor:O,u_baseColorTexture:to.BaseColor,u_metallicRoughnessTexture:to.MetallicRoughness,u_normalTexture:to.Normal,u_occlusionTexture:to.Occlusion,u_emissionTexture:to.Emission,u_lutTexture:to.LUT,u_color_mix:[Ke.r,Ke.g,Ke.b,Pe],u_aoIntensity:Je,u_emissive_strength:X,u_occlusionTextureTransform:ue||[0,0,0,0]}},ph=(m,o=Fs,h=Fs)=>({u_matrix:m,u_instance:o,u_node_matrix:h}),gc=(m,o,h,g,y)=>({u_matrix:Float32Array.from(m),u_anchorPos:o,u_screenSizePx:h,u_occluderSizePx:g,u_color:y}),xl={fillExtrusion:m=>({u_matrix:new i.a6(m),u_lightpos:new i.aq(m),u_lightintensity:new i.aa(m),u_lightcolor:new i.aq(m),u_vertical_gradient:new i.aa(m),u_opacity:new i.aa(m),u_edge_radius:new i.aa(m),u_ao:new i.a8(m),u_tile_id:new i.aq(m),u_zoom_transition:new i.aa(m),u_inv_rot_matrix:new i.a6(m),u_merc_center:new i.a8(m),u_up_dir:new i.aq(m),u_height_lift:new i.aa(m),u_flood_light_color:new i.aq(m),u_vertical_scale:new i.aa(m),u_flood_light_intensity:new i.aa(m),u_ground_shadow_factor:new i.aq(m),u_emissive_strength:new i.aa(m)}),fillExtrusionDepth:m=>({u_matrix:new i.a6(m),u_edge_radius:new i.aa(m),u_vertical_scale:new i.aa(m)}),fillExtrusionPattern:m=>({u_matrix:new i.a6(m),u_lightpos:new i.aq(m),u_lightintensity:new i.aa(m),u_lightcolor:new i.aq(m),u_vertical_gradient:new i.aa(m),u_height_factor:new i.aa(m),u_edge_radius:new i.aa(m),u_ao:new i.a8(m),u_tile_id:new i.aq(m),u_zoom_transition:new i.aa(m),u_inv_rot_matrix:new i.a6(m),u_merc_center:new i.a8(m),u_up_dir:new i.aq(m),u_height_lift:new i.aa(m),u_image:new i.a7(m),u_texsize:new i.a8(m),u_pixel_coord_upper:new i.a8(m),u_pixel_coord_lower:new i.a8(m),u_tile_units_to_pixels:new i.aa(m),u_opacity:new i.aa(m)}),fillExtrusionGroundEffect:m=>({u_matrix:new i.a6(m),u_opacity:new i.aa(m),u_ao_pass:new i.aa(m),u_meter_to_tile:new i.aa(m),u_ao:new i.a8(m),u_flood_light_intensity:new i.aa(m),u_flood_light_color:new i.aq(m),u_attenuation:new i.aa(m),u_edge_radius:new i.aa(m),u_fb:new i.a7(m),u_fb_size:new i.aa(m)}),fill:m=>({u_matrix:new i.a6(m),u_emissive_strength:new i.aa(m)}),fillPattern:m=>({u_matrix:new i.a6(m),u_emissive_strength:new i.aa(m),u_image:new i.a7(m),u_texsize:new i.a8(m),u_pixel_coord_upper:new i.a8(m),u_pixel_coord_lower:new i.a8(m),u_tile_units_to_pixels:new i.aa(m)}),fillOutline:m=>({u_matrix:new i.a6(m),u_emissive_strength:new i.aa(m),u_world:new i.a8(m)}),fillOutlinePattern:m=>({u_matrix:new i.a6(m),u_emissive_strength:new i.aa(m),u_world:new i.a8(m),u_image:new i.a7(m),u_texsize:new i.a8(m),u_pixel_coord_upper:new i.a8(m),u_pixel_coord_lower:new i.a8(m),u_tile_units_to_pixels:new i.aa(m)}),circle:i.bI,collisionBox:m=>({u_matrix:new i.a6(m),u_camera_to_center_distance:new i.aa(m),u_extrude_scale:new i.a8(m)}),collisionCircle:m=>({u_matrix:new i.a6(m),u_inv_matrix:new i.a6(m),u_camera_to_center_distance:new i.aa(m),u_viewport_size:new i.a8(m)}),debug:m=>({u_color:new i.a9(m),u_matrix:new i.a6(m),u_overlay:new i.a7(m),u_overlay_scale:new i.aa(m)}),clippingMask:m=>({u_matrix:new i.a6(m)}),heatmap:m=>({u_extrude_scale:new i.aa(m),u_intensity:new i.aa(m),u_matrix:new i.a6(m),u_inv_rot_matrix:new i.a6(m),u_merc_center:new i.a8(m),u_tile_id:new i.aq(m),u_zoom_transition:new i.aa(m),u_up_dir:new i.aq(m)}),heatmapTexture:m=>({u_image:new i.a7(m),u_color_ramp:new i.a7(m),u_opacity:new i.aa(m)}),hillshade:m=>({u_matrix:new i.a6(m),u_image:new i.a7(m),u_latrange:new i.a8(m),u_light:new i.a8(m),u_shadow:new i.a9(m),u_highlight:new i.a9(m),u_emissive_strength:new i.aa(m),u_accent:new i.a9(m)}),hillshadePrepare:m=>({u_matrix:new i.a6(m),u_image:new i.a7(m),u_dimension:new i.a8(m),u_zoom:new i.aa(m)}),line:i.bJ,linePattern:i.bK,raster:m=>({u_matrix:new i.a6(m),u_normalize_matrix:new i.a6(m),u_globe_matrix:new i.a6(m),u_merc_matrix:new i.a6(m),u_grid_matrix:new i.ar(m),u_tl_parent:new i.a8(m),u_scale_parent:new i.aa(m),u_fade_t:new i.aa(m),u_opacity:new i.aa(m),u_image0:new i.a7(m),u_image1:new i.a7(m),u_brightness_low:new i.aa(m),u_brightness_high:new i.aa(m),u_saturation_factor:new i.aa(m),u_contrast_factor:new i.aa(m),u_spin_weights:new i.aq(m),u_perspective_transform:new i.a8(m),u_raster_elevation:new i.aa(m),u_zoom_transition:new i.aa(m),u_merc_center:new i.a8(m),u_cutoff_params:new i.as(m),u_colorization_mix:new i.as(m),u_colorization_offset:new i.aa(m),u_color_ramp:new i.a7(m),u_texture_offset:new i.a8(m),u_texture_res:new i.a8(m),u_emissive_strength:new i.aa(m)}),rasterParticle:m=>({u_matrix:new i.a6(m),u_normalize_matrix:new i.a6(m),u_globe_matrix:new i.a6(m),u_merc_matrix:new i.a6(m),u_grid_matrix:new i.ar(m),u_tl_parent:new i.a8(m),u_scale_parent:new i.aa(m),u_fade_t:new i.aa(m),u_opacity:new i.aa(m),u_image0:new i.a7(m),u_image1:new i.a7(m),u_raster_elevation:new i.aa(m),u_zoom_transition:new i.aa(m),u_merc_center:new i.a8(m),u_cutoff_params:new i.as(m)}),rasterParticleTexture:m=>({u_texture:new i.a7(m),u_opacity:new i.aa(m)}),rasterParticleDraw:m=>({u_particle_texture:new i.a7(m),u_particle_texture_side_len:new i.aa(m),u_tile_offset:new i.a8(m),u_velocity:new i.a7(m),u_color_ramp:new i.a7(m),u_velocity_res:new i.a8(m),u_max_speed:new i.aa(m),u_uv_offset:new i.a8(m),u_data_scale:new i.as(m),u_data_offset:new i.aa(m),u_particle_pos_scale:new i.aa(m),u_particle_pos_offset:new i.a8(m)}),rasterParticleUpdate:m=>({u_particle_texture:new i.a7(m),u_particle_texture_side_len:new i.aa(m),u_velocity:new i.a7(m),u_velocity_res:new i.a8(m),u_max_speed:new i.aa(m),u_speed_factor:new i.aa(m),u_reset_rate:new i.aa(m),u_rand_seed:new i.aa(m),u_uv_offset:new i.a8(m),u_data_scale:new i.as(m),u_data_offset:new i.aa(m),u_particle_pos_scale:new i.aa(m),u_particle_pos_offset:new i.a8(m)}),symbolIcon:m=>({u_is_size_zoom_constant:new i.a7(m),u_is_size_feature_constant:new i.a7(m),u_size_t:new i.aa(m),u_size:new i.aa(m),u_camera_to_center_distance:new i.aa(m),u_rotate_symbol:new i.a7(m),u_aspect_ratio:new i.aa(m),u_fade_change:new i.aa(m),u_matrix:new i.a6(m),u_label_plane_matrix:new i.a6(m),u_coord_matrix:new i.a6(m),u_is_text:new i.a7(m),u_pitch_with_map:new i.a7(m),u_texsize:new i.a8(m),u_tile_id:new i.aq(m),u_zoom_transition:new i.aa(m),u_inv_rot_matrix:new i.a6(m),u_merc_center:new i.a8(m),u_camera_forward:new i.aq(m),u_tile_matrix:new i.a6(m),u_up_vector:new i.aq(m),u_ecef_origin:new i.aq(m),u_texture:new i.a7(m),u_icon_transition:new i.aa(m),u_color_adj_mat:new i.a6(m)}),symbolSDF:m=>({u_is_size_zoom_constant:new i.a7(m),u_is_size_feature_constant:new i.a7(m),u_size_t:new i.aa(m),u_size:new i.aa(m),u_camera_to_center_distance:new i.aa(m),u_rotate_symbol:new i.a7(m),u_aspect_ratio:new i.aa(m),u_fade_change:new i.aa(m),u_matrix:new i.a6(m),u_label_plane_matrix:new i.a6(m),u_coord_matrix:new i.a6(m),u_is_text:new i.a7(m),u_pitch_with_map:new i.a7(m),u_texsize:new i.a8(m),u_texture:new i.a7(m),u_gamma_scale:new i.aa(m),u_device_pixel_ratio:new i.aa(m),u_tile_id:new i.aq(m),u_zoom_transition:new i.aa(m),u_inv_rot_matrix:new i.a6(m),u_merc_center:new i.a8(m),u_camera_forward:new i.aq(m),u_tile_matrix:new i.a6(m),u_up_vector:new i.aq(m),u_ecef_origin:new i.aq(m),u_is_halo:new i.a7(m)}),symbolTextAndIcon:m=>({u_is_size_zoom_constant:new i.a7(m),u_is_size_feature_constant:new i.a7(m),u_size_t:new i.aa(m),u_size:new i.aa(m),u_camera_to_center_distance:new i.aa(m),u_rotate_symbol:new i.a7(m),u_aspect_ratio:new i.aa(m),u_fade_change:new i.aa(m),u_matrix:new i.a6(m),u_label_plane_matrix:new i.a6(m),u_coord_matrix:new i.a6(m),u_is_text:new i.a7(m),u_pitch_with_map:new i.a7(m),u_texsize:new i.a8(m),u_texsize_icon:new i.a8(m),u_texture:new i.a7(m),u_texture_icon:new i.a7(m),u_gamma_scale:new i.aa(m),u_device_pixel_ratio:new i.aa(m),u_is_halo:new i.a7(m)}),background:m=>({u_matrix:new i.a6(m),u_emissive_strength:new i.aa(m),u_opacity:new i.aa(m),u_color:new i.a9(m)}),backgroundPattern:m=>({u_matrix:new i.a6(m),u_emissive_strength:new i.aa(m),u_opacity:new i.aa(m),u_image:new i.a7(m),u_pattern_tl:new i.a8(m),u_pattern_br:new i.a8(m),u_texsize:new i.a8(m),u_pattern_size:new i.a8(m),u_pixel_coord_upper:new i.a8(m),u_pixel_coord_lower:new i.a8(m),u_tile_units_to_pixels:new i.aa(m)}),terrainRaster:ac,terrainDepth:ac,skybox:m=>({u_matrix:new i.a6(m),u_sun_direction:new i.aq(m),u_cubemap:new i.a7(m),u_opacity:new i.aa(m),u_temporal_offset:new i.aa(m)}),skyboxGradient:m=>({u_matrix:new i.a6(m),u_color_ramp:new i.a7(m),u_center_direction:new i.aq(m),u_radius:new i.aa(m),u_opacity:new i.aa(m),u_temporal_offset:new i.aa(m)}),skyboxCapture:m=>({u_matrix_3f:new i.ar(m),u_sun_direction:new i.aq(m),u_sun_intensity:new i.aa(m),u_color_tint_r:new i.as(m),u_color_tint_m:new i.as(m),u_luminance:new i.aa(m)}),globeRaster:m=>({u_proj_matrix:new i.a6(m),u_globe_matrix:new i.a6(m),u_normalize_matrix:new i.a6(m),u_merc_matrix:new i.a6(m),u_zoom_transition:new i.aa(m),u_merc_center:new i.a8(m),u_image0:new i.a7(m),u_grid_matrix:new i.ar(m),u_skirt_height:new i.aa(m),u_far_z_cutoff:new i.aa(m),u_frustum_tl:new i.aq(m),u_frustum_tr:new i.aq(m),u_frustum_br:new i.aq(m),u_frustum_bl:new i.aq(m),u_globe_pos:new i.aq(m),u_globe_radius:new i.aa(m),u_viewport:new i.a8(m)}),globeAtmosphere:m=>({u_frustum_tl:new i.aq(m),u_frustum_tr:new i.aq(m),u_frustum_br:new i.aq(m),u_frustum_bl:new i.aq(m),u_horizon:new i.aa(m),u_transition:new i.aa(m),u_fadeout_range:new i.aa(m),u_color:new i.as(m),u_high_color:new i.as(m),u_space_color:new i.as(m),u_temporal_offset:new i.aa(m),u_horizon_angle:new i.aa(m)}),model:m=>({u_matrix:new i.a6(m),u_lighting_matrix:new i.a6(m),u_normal_matrix:new i.a6(m),u_node_matrix:new i.a6(m),u_lightpos:new i.aq(m),u_lightintensity:new i.aa(m),u_lightcolor:new i.aq(m),u_camera_pos:new i.aq(m),u_opacity:new i.aa(m),u_baseColorFactor:new i.as(m),u_emissiveFactor:new i.as(m),u_metallicFactor:new i.aa(m),u_roughnessFactor:new i.aa(m),u_baseTextureIsAlpha:new i.a7(m),u_alphaMask:new i.a7(m),u_alphaCutoff:new i.aa(m),u_baseColorTexture:new i.a7(m),u_metallicRoughnessTexture:new i.a7(m),u_normalTexture:new i.a7(m),u_occlusionTexture:new i.a7(m),u_emissionTexture:new i.a7(m),u_lutTexture:new i.a7(m),u_color_mix:new i.as(m),u_aoIntensity:new i.aa(m),u_emissive_strength:new i.aa(m),u_occlusionTextureTransform:new i.as(m)}),modelDepth:m=>({u_matrix:new i.a6(m),u_instance:new i.a6(m),u_node_matrix:new i.a6(m)}),groundShadow:m=>({u_matrix:new i.a6(m),u_ground_shadow_factor:new i.aq(m)}),stars:m=>({u_matrix:new i.a6(m),u_up:new i.aq(m),u_right:new i.aq(m),u_intensity_multiplier:new i.aa(m)}),occlusion:m=>({u_matrix:new i.a6(m),u_anchorPos:new i.aq(m),u_screenSizePx:new i.a8(m),u_occluderSizePx:new i.a8(m),u_color:new i.as(m)})};function Zs(m,o,h){let g=o.createTileMatrix(m,m.worldSize,h.toUnwrapped());return i.ad.multiply(new Float32Array(16),m.projMatrix,g)}function Tu(m,o,h){if(o.projection.name===h.projection.name)return m.projMatrix;let g=h.clone();return g.setProjection(o.projection),Zs(g,o.getProjection(),m)}function vl(m,o,h){return o.name===h.projection.name?m.projMatrix:Zs(h,o,m)}let zl;function Ys(m,o,h,g,y,b,S){let C=m.context,P=C.gl,O=m.transform,j=m.getOrCreateProgram("collisionBox"),X=[],re=0,ae=0;for(let Ne=0;Ne<g.length;Ne++){let Je=g[Ne],Ke=o.getTile(Je),Pe=Ke.getBucket(h);if(!Pe)continue;let Be=Tu(Je,Pe,O),je=Be;y[0]===0&&y[1]===0||(je=m.translatePosMatrix(Be,Ke,y,b));let at=S?Pe.textCollisionBox:Pe.iconCollisionBox,yt=Pe.collisionCircleArray;if(yt.length>0){let qe=i.ad.create(),bt=je;i.ad.mul(qe,Pe.placementInvProjMatrix,O.glCoordMatrix),i.ad.mul(qe,qe,Pe.placementViewportMatrix),X.push({circleArray:yt,circleOffset:ae,transform:bt,invTransform:qe,projection:Pe.getProjection()}),re+=yt.length/4,ae=re}at&&(m.terrain&&m.terrain.setupElevationDraw(Ke,j),j.draw(m,P.LINES,i.ae.disabled,i.ag.disabled,m.colorModeForRenderPass(),i.af.disabled,Gc(je,O,Ke,Pe.getProjection()),h.id,at.layoutVertexBuffer,at.indexBuffer,at.segments,null,O.zoom,null,[at.collisionVertexBuffer,at.collisionVertexBufferExt]))}if(!S||!X.length)return;let ue=m.getOrCreateProgram("collisionCircle"),he=new i.bL;he.resize(4*re),he._trim();let fe=0;for(let Ne of X)for(let Je=0;Je<Ne.circleArray.length/4;Je++){let Ke=4*Je,Pe=Ne.circleArray[Ke+0],Be=Ne.circleArray[Ke+1],je=Ne.circleArray[Ke+2],at=Ne.circleArray[Ke+3];he.emplace(fe++,Pe,Be,je,at,0),he.emplace(fe++,Pe,Be,je,at,1),he.emplace(fe++,Pe,Be,je,at,2),he.emplace(fe++,Pe,Be,je,at,3)}(!zl||zl.length<2*re)&&(zl=function(Ne){let Je=2*Ne,Ke=new i.bu;Ke.resize(Je),Ke._trim();for(let Pe=0;Pe<Je;Pe++){let Be=6*Pe;Ke.uint16[Be+0]=4*Pe+0,Ke.uint16[Be+1]=4*Pe+1,Ke.uint16[Be+2]=4*Pe+2,Ke.uint16[Be+3]=4*Pe+2,Ke.uint16[Be+4]=4*Pe+3,Ke.uint16[Be+5]=4*Pe+0}return Ke}(re));let me=C.createIndexBuffer(zl,!0),Le=C.createVertexBuffer(he,i.bM.members,!0);for(let Ne of X){let Je={u_matrix:Ne.transform,u_inv_matrix:Ne.invTransform,u_camera_to_center_distance:(Oe=O).getCameraToCenterDistance(Ne.projection),u_viewport_size:[Oe.width,Oe.height]};ue.draw(m,P.TRIANGLES,i.ae.disabled,i.ag.disabled,m.colorModeForRenderPass(),i.af.disabled,Je,h.id,Le,me,i.b.simpleSegment(0,2*Ne.circleOffset,Ne.circleArray.length,Ne.circleArray.length/2),null,O.zoom)}var Oe;Le.destroy(),me.destroy()}let yl=i.ad.create();function Ps(m){let o=m._camera.getWorldToCamera(m.worldSize,1),h=i.ad.multiply([],o,m.globeMatrix);i.ad.invert(h,h);let g=[0,0,0],y=[0,1,0,0];return i.aA.transformMat4(y,y,h),g[0]=y[0],g[1]=y[1],g[2]=y[2],i._.normalize(g,g),g}function _c({width:m,height:o,anchor:h,textOffset:g,textScale:y},b){let{horizontalAlign:S,verticalAlign:C}=i.bQ(h),P=-(S-.5)*m,O=-(C-.5)*o,j=i.bP(h,g);return new i.P((P/y+j[0])*b,(O/y+j[1])*b)}function Xn(m,o,h,g,y,b,S,C,P,O,j){let X=m.text.placedSymbolArray,re=m.text.dynamicLayoutVertexArray,ae=m.icon.dynamicLayoutVertexArray,ue={},he=m.getProjection(),fe=vl(C,he,b),me=b.elevation,Le=he.upVectorScale(C.canonical,b.center.lat,b.worldSize).metersToTile;re.clear();for(let Oe=0;Oe<X.length;Oe++){let Ne=X.get(Oe),{tileAnchorX:Je,tileAnchorY:Ke,numGlyphs:Pe}=Ne,Be=Ne.hidden||!Ne.crossTileID||m.allowVerticalPlacement&&!Ne.placedOrientation?null:g[Ne.crossTileID];if(Be){let je=0,at=0,yt=0;if(me){let jt=me?me.getAtTileOffset(C,Je,Ke):0,[di,pi,Ai]=he.upVector(C.canonical,Je,Ke);je=jt*di*Le,at=jt*pi*Le,yt=jt*Ai*Le}let[qe,bt,Ct,Ht]=eo(Ne.projectedAnchorX+je,Ne.projectedAnchorY+at,Ne.projectedAnchorZ+yt,h?fe:S),qt=ya(b.getCameraToCenterDistance(he),Ht),Ut=y.evaluateSizeForFeature(m.textSizeData,O,Ne)*qt/i.bN;h&&(Ut*=m.tilePixelRatio/P);let ft=_c(Be,Ut);h?({x:qe,y:bt,z:Ct}=he.projectTilePoint(Je+ft.x,Ke+ft.y,C.canonical),[qe,bt,Ct]=eo(qe+je,bt+at,Ct+yt,S)):(o&&ft._rotate(-b.angle),qe+=ft.x,bt+=ft.y,Ct=0);let kt=m.allowVerticalPlacement&&Ne.placedOrientation===i.aE.vertical?Math.PI/2:0;for(let jt=0;jt<Pe;jt++)i.aH(re,qe,bt,Ct,kt);j&&Ne.associatedIconIndex>=0&&(ue[Ne.associatedIconIndex]={x:qe,y:bt,z:Ct,angle:kt})}else pl(Pe,re)}if(j){ae.clear();let Oe=m.icon.placedSymbolArray;for(let Ne=0;Ne<Oe.length;Ne++){let Je=Oe.get(Ne),{numGlyphs:Ke}=Je,Pe=ue[Ne];if(Je.hidden||!Pe)pl(Ke,ae);else{let{x:Be,y:je,z:at,angle:yt}=Pe;for(let qe=0;qe<Ke;qe++)i.aH(ae,Be,je,at,yt)}}m.icon.dynamicLayoutVertexBuffer.updateData(ae)}m.text.dynamicLayoutVertexBuffer.updateData(re)}function Vn(m,o,h,g,y,b,S={}){let C=h.paint.get("icon-translate"),P=h.paint.get("text-translate"),O=h.paint.get("icon-translate-anchor"),j=h.paint.get("text-translate-anchor"),X=h.layout.get("icon-rotation-alignment"),re=h.layout.get("text-rotation-alignment"),ae=h.layout.get("icon-pitch-alignment"),ue=h.layout.get("text-pitch-alignment"),he=h.layout.get("icon-keep-upright"),fe=h.layout.get("text-keep-upright"),me=h.paint.get("icon-color-saturation"),Le=h.paint.get("icon-color-contrast"),Oe=h.paint.get("icon-color-brightness-min"),Ne=h.paint.get("icon-color-brightness-max"),Je=h.paint.get("icon-occlusion-opacity").constantOr(0),Ke=h.paint.get("text-occlusion-opacity").constantOr(0),Pe=m.context,Be=Pe.gl,je=m.transform,at=X==="map",yt=re==="map",qe=ae==="map",bt=ue==="map",Ct=Je!==1,Ht=Ke!==1,qt=h.layout.get("symbol-sort-key").constantOr(1)!==void 0,Ut=!1,ft=m.depthModeForSublayer(0,i.ae.ReadOnly),kt=[i.aj(je.center.lng),i.ak(je.center.lat)],jt=h.layout.get("text-variable-anchor"),di=je.projection.name==="globe",pi=[],Ai=[0,-1,0];for(let mi of g){let Yt=o.getTile(mi),Nt=Yt.getBucket(h);if(!Nt||Nt.projection.name==="mercator"&&di||Nt.fullyClipped)continue;let Li=Nt.projection.name==="globe",pr=Li?i.a1(je.zoom):0,nr=vl(mi,Nt.getProjection(),je),Ir=je.calculatePixelsToTileUnitsMatrix(Yt),Ur=jt&&Nt.hasTextData(),un=Nt.hasIconTextFit()&&Ur&&Nt.hasIconData(),ir=Nt.getProjection().createInversionMatrix(je,mi.canonical),tn=()=>{let Gt=at&&h.layout.get("symbol-placement")!=="point",_i=[];h.hasInitialOcclusionOpacityProperties&&Ct&&m.symbolParams.useOcclusionQueries&&!Li&&!di&&_i.push("OCCLUSION_QUERIES"),h.hasInitialOcclusionOpacityProperties||_i.push("SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH");let aa=Gt||un,rn=h.paint.get("icon-image-cross-fade").constantOr(0);m.terrainRenderModeElevated()&&qe&&_i.push("PITCH_WITH_MAP_TERRAIN"),Li&&(_i.push("PROJECTION_GLOBE_VIEW"),aa&&_i.push("PROJECTED_POS_ON_VIEWPORT")),rn>0&&_i.push("ICON_TRANSITION"),Nt.icon.zOffsetVertexBuffer&&_i.push("Z_OFFSET"),me===0&&Le===0&&Oe===0&&Ne===1||_i.push("COLOR_ADJUSTMENT");let xt=Nt.icon.programConfigurations.get(h.id),Tl=m.getOrCreateProgram(Nt.sdfIcons?"symbolSDF":"symbolIcon",{config:xt,defines:_i}),Vo,xs=Yt.imageAtlasTexture?Yt.imageAtlasTexture.size:[0,0],bo=Nt.iconSizeData,Ns=i.aD(bo,je.zoom),Ac=qe||je.pitch!==0,Sl=Ll(nr,Yt.tileID.canonical,qe,at,je,Nt.getProjection(),Ir),Ih=cc(nr,Yt.tileID.canonical,qe,at,je,Nt.getProjection(),Ir),kh=m.translatePosMatrix(Ih,Yt,C,O,!0),Ou=m.translatePosMatrix(nr,Yt,C,O),tu=aa?yl:Sl,Nu=at&&!qe&&!Gt,sf=Ai;!di&&!je.mercatorFromTransition||at||(sf=Ps(je));let lf=Li?sf:Ai;if(Nt.sdfIcons&&!Nt.iconsInText)Vo=gl(bo.kind,Ns,Nu,qe,m,Ou,tu,kh,!1,xs,!0,mi,pr,kt,ir,lf,Nt.getProjection());else{let ho=h.getColorAdjustmentMatrix(me,Le,Oe,Ne);Vo=No(bo.kind,Ns,Nu,qe,m,Ou,tu,kh,!1,xs,mi,pr,kt,ir,lf,Nt.getProjection(),ho,rn)}let xd=Yt.imageAtlasTexture?Yt.imageAtlasTexture:null,cf=h.layout.get("icon-size").constantOr(0)!==1||Nt.iconsNeedLinear,mm=Nt.sdfIcons||m.options.rotating||m.options.zooming||cf||Ac?Be.LINEAR:Be.NEAREST,gm=Nt.sdfIcons&&h.paint.get("icon-halo-width").constantOr(1)!==0,P0=m.terrain&&qe&&Gt?i.ad.invert(i.ad.create(),Sl):yl;if(Gt&&Nt.icon){let ho=je.elevation,L0=ho?ho.getAtTileOffsetFunc(mi,je.center.lat,je.worldSize,Nt.getProjection()):null,uf=Rl(nr,Yt.tileID.canonical,qe,at,je,Nt.getProjection(),Ir);fl(Nt,nr,m,!1,uf,Ih,qe,he,L0,mi)}return{program:Tl,buffers:Nt.icon,uniformValues:Vo,atlasTexture:xd,atlasTextureIcon:null,atlasInterpolation:mm,atlasInterpolationIcon:null,isSDF:Nt.sdfIcons,hasHalo:gm,tile:Yt,labelPlaneMatrixInv:P0}},bn=()=>{let Gt=yt&&h.layout.get("symbol-placement")!=="point",_i=[],aa=Gt||jt||un;h.hasInitialOcclusionOpacityProperties&&Ht&&m.symbolParams.useOcclusionQueries&&!Li&&!di&&_i.push("OCCLUSION_QUERIES"),h.hasInitialOcclusionOpacityProperties||_i.push("SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH"),m.terrainRenderModeElevated()&&bt&&_i.push("PITCH_WITH_MAP_TERRAIN"),Li&&(_i.push("PROJECTION_GLOBE_VIEW"),aa&&_i.push("PROJECTED_POS_ON_VIEWPORT")),Nt.text.zOffsetVertexBuffer&&_i.push("Z_OFFSET");let rn=Nt.text.programConfigurations.get(h.id),xt=m.getOrCreateProgram(Nt.iconsInText?"symbolTextAndIcon":"symbolSDF",{config:rn,defines:_i}),Tl,Vo=[0,0],xs=null,bo=Nt.textSizeData;Nt.iconsInText&&(Vo=Yt.imageAtlasTexture?Yt.imageAtlasTexture.size:[0,0],xs=Yt.imageAtlasTexture?Yt.imageAtlasTexture:null,Tl=bt||je.pitch!==0||m.options.rotating||m.options.zooming||bo.kind==="composite"||bo.kind==="camera"?Be.LINEAR:Be.NEAREST);let Ns=Yt.glyphAtlasTexture?Yt.glyphAtlasTexture.size:[0,0],Ac=i.aD(bo,je.zoom),Sl=Ll(nr,Yt.tileID.canonical,bt,yt,je,Nt.getProjection(),Ir),Ih=cc(nr,Yt.tileID.canonical,bt,yt,je,Nt.getProjection(),Ir),kh=m.translatePosMatrix(Ih,Yt,P,j,!0),Ou=m.translatePosMatrix(nr,Yt,P,j),tu=aa?yl:Sl,Nu=yt&&!bt&&!Gt,sf=Ai;!di&&!je.mercatorFromTransition||yt||(sf=Ps(je));let lf=Li?sf:Ai,xd;xd=Nt.iconsInText?_l(bo.kind,Ac,Nu,bt,m,Ou,tu,kh,Ns,Vo,mi,pr,kt,ir,lf,Nt.getProjection()):gl(bo.kind,Ac,Nu,bt,m,Ou,tu,kh,!0,Ns,!0,mi,pr,kt,ir,lf,Nt.getProjection());let cf=Yt.glyphAtlasTexture?Yt.glyphAtlasTexture:null,mm=Be.LINEAR,gm=h.paint.get("text-halo-width").constantOr(1)!==0,P0=m.terrain&&bt&&Gt?i.ad.invert(i.ad.create(),Sl):yl;if(Gt&&Nt.text){let ho=je.elevation,L0=ho?ho.getAtTileOffsetFunc(mi,je.center.lat,je.worldSize,Nt.getProjection()):null,uf=Rl(nr,Yt.tileID.canonical,bt,yt,je,Nt.getProjection(),Ir);fl(Nt,nr,m,!0,uf,Ih,bt,fe,L0,mi)}return{program:xt,buffers:Nt.text,uniformValues:xd,atlasTexture:cf,atlasTextureIcon:xs,atlasInterpolation:mm,atlasInterpolationIcon:Tl,isSDF:!0,hasHalo:gm,tile:Yt,labelPlaneMatrixInv:P0}},cn=Nt.icon.segments.get().length,Pr=Nt.text.segments.get().length,or=cn&&!S.onlyText?tn():null,Fn=Pr&&!S.onlyIcons?bn():null,zn=h.paint.get("icon-opacity").constantOr(1),pn=h.paint.get("text-opacity").constantOr(1);if(qt&&Nt.canOverlap){Ut=!0;let Gt=zn&&!S.onlyText?Nt.icon.segments.get():[],_i=pn&&!S.onlyIcons?Nt.text.segments.get():[];for(let aa of Gt)pi.push({segments:new i.b([aa]),sortKey:aa.sortKey,state:or});for(let aa of _i)pi.push({segments:new i.b([aa]),sortKey:aa.sortKey,state:Fn})}else S.onlyText||pi.push({segments:zn?Nt.icon.segments:new i.b([]),sortKey:0,state:or}),S.onlyIcons||pi.push({segments:pn?Nt.text.segments:new i.b([]),sortKey:0,state:Fn})}Ut&&pi.sort((mi,Yt)=>mi.sortKey-Yt.sortKey);for(let mi of pi){let Yt=mi.state;if(Yt)if(m.terrain&&m.terrain.setupElevationDraw(Yt.tile,Yt.program,{useDepthForOcclusion:!h.hasInitialOcclusionOpacityProperties&&je.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Yt.labelPlaneMatrixInv}),Pe.activeTexture.set(Be.TEXTURE0),Yt.atlasTexture&&Yt.atlasTexture.bind(Yt.atlasInterpolation,Be.CLAMP_TO_EDGE,!0),Yt.atlasTextureIcon&&(Pe.activeTexture.set(Be.TEXTURE1),Yt.atlasTextureIcon&&Yt.atlasTextureIcon.bind(Yt.atlasInterpolationIcon,Be.CLAMP_TO_EDGE,!0)),m.uploadCommonLightUniforms(m.context,Yt.program),Yt.hasHalo){let Nt=Yt.uniformValues;Nt.u_is_halo=1,na(Yt.buffers,mi.segments,h,m,Yt.program,ft,y,b,Nt,2),Nt.u_is_halo=0}else{if(Yt.isSDF){let Nt=Yt.uniformValues;Yt.hasHalo&&(Nt.u_is_halo=1,na(Yt.buffers,mi.segments,h,m,Yt.program,ft,y,b,Nt,1)),Nt.u_is_halo=0}na(Yt.buffers,mi.segments,h,m,Yt.program,ft,y,b,Yt.uniformValues,1)}}}function na(m,o,h,g,y,b,S,C,P,O){let j=g.context.gl,X=[m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.iconTransitioningVertexBuffer,m.globeExtVertexBuffer,m.zOffsetVertexBuffer];m.occlusionQueryOpacityVertexBuffer.length>0&&X.push(m.occlusionQueryOpacityVertexBuffer),y.draw(g,j.TRIANGLES,b,S,C,i.af.disabled,P,h.id,m.layoutVertexBuffer,m.indexBuffer,o,h.paint,g.transform.zoom,m.programConfigurations.get(h.id),X,O)}function Ha(m,o,h,g,y,b,S){let C=m.context.gl,P=h.paint.get("fill-pattern"),O=P&&P.constantOr(1),j,X,re,ae,ue;S?(X=O&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",j=C.LINES):(X=O?"fillPattern":"fill",j=C.TRIANGLES);for(let he of g){let fe=o.getTile(he);if(O&&!fe.patternsLoaded())continue;let me=fe.getBucket(h);if(!me)continue;m.prepareDrawTile();let Le=me.programConfigurations.get(h.id),Oe=m.isTileAffectedByFog(he),Ne=m.getOrCreateProgram(X,{config:Le,overrideFog:Oe});O&&(m.context.activeTexture.set(C.TEXTURE0),fe.imageAtlasTexture&&fe.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),Le.updatePaintBuffers());let Je=P.constantOr(null);if(Je&&fe.imageAtlas){let Be=fe.imageAtlas.patternPositions[Je.toString()];Be&&Le.setConstantPatternPositions(Be)}let Ke=m.translatePosMatrix(he.projMatrix,fe,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor")),Pe=h.paint.get("fill-emissive-strength");if(S){ae=me.indexBuffer2,ue=me.segments2;let Be=m.terrain&&m.terrain.renderingToTexture?m.terrain.drapeBufferSize:[C.drawingBufferWidth,C.drawingBufferHeight];re=X==="fillOutlinePattern"&&O?fc(Ke,Pe,m,fe,Be):Zo(Ke,Pe,Be)}else ae=me.indexBuffer,ue=me.segments,re=O?Hc(Ke,Pe,m,fe):yu(Ke,Pe);m.uploadCommonUniforms(m.context,Ne,he.toUnwrapped()),Ne.draw(m,j,y,m.stencilModeForClipping(he),b,i.af.disabled,re,h.id,me.layoutVertexBuffer,ae,ue,h.paint,m.transform.zoom,Le,void 0)}}function hs(m,o,h,g,y,b,S,C){h.resetLayerRenderingStats(m);let P=m.context,O=P.gl,j=m.transform,X=h.paint.get("fill-extrusion-pattern"),re=X.constantOr(1),ae=h.paint.get("fill-extrusion-opacity"),ue=m.style.enable3dLights(),he=h.paint.get(ue&&!re?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),fe=[h.paint.get("fill-extrusion-ambient-occlusion-intensity"),he],me=h.layout.get("fill-extrusion-edge-radius"),Le=me>0&&!h.paint.get("fill-extrusion-rounded-roof"),Oe=Le?0:me,Ne=j.projection.name==="globe"?i.bY():0,Je=j.projection.name==="globe",Ke=Je?i.a1(j.zoom):0,Pe=[i.aj(j.center.lng),i.ak(j.center.lat)],Be=h.paint.get("fill-extrusion-flood-light-color").toRenderColor(h.lut).toArray01().slice(0,3),je=h.paint.get("fill-extrusion-flood-light-intensity"),at=h.paint.get("fill-extrusion-vertical-scale"),yt=$s(m,h.paint.get("fill-extrusion-cutoff-fade-range")),qe=h.paint.get("fill-extrusion-emissive-strength"),bt=[],Ct;Je&&bt.push("PROJECTION_GLOBE_VIEW"),fe[0]>0&&bt.push("FAUX_AO"),Le&&bt.push("ZERO_ROOF_RADIUS"),C&&bt.push("HAS_CENTROID"),je>0&&bt.push("FLOOD_LIGHT"),yt.shouldRenderCutoff&&bt.push("RENDER_CUTOFF");let Ht=m.renderPass==="shadow",qt=m.shadowRenderer,Ut=Ht&&!!qt;m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!0);let ft=[0,0,0];if(qt){let di=m.style.directionalLight,pi=m.style.ambientLight;di&&pi&&(ft=U(m.style,di,pi)),Ct=bt.concat(["SHADOWS_SINGLE_CASCADE"])}let kt=Ut?"fillExtrusionDepth":re?"fillExtrusionPattern":"fillExtrusion",jt=h.getLayerRenderingStats();for(let di of g){let pi=o.getTile(di),Ai=pi.getBucket(h);if(!Ai||Ai.projection.name!==j.projection.name)continue;let mi=!1;qt&&(mi=qt.getMaxCascadeForTile(di.toUnwrapped())===0);let Yt=m.isTileAffectedByFog(di),Nt=Ai.programConfigurations.get(h.id),Li=m.getOrCreateProgram(kt,{config:Nt,defines:mi?Ct:bt,overrideFog:Yt});if(m.terrain&&m.terrain.setupElevationDraw(pi,Li,{useMeterToDem:!0}),!Ai.centroidVertexBuffer){let ir=Li.attributes.a_centroid_pos;ir!==void 0&&O.vertexAttrib2f(ir,0,0)}!Ht&&qt&&qt.setupShadows(pi.tileID.toUnwrapped(),Li,"vector-tile",pi.tileID.overscaledZ),re&&(m.context.activeTexture.set(O.TEXTURE0),pi.imageAtlasTexture&&pi.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),Nt.updatePaintBuffers());let pr=X.constantOr(null);if(pr&&pi.imageAtlas){let ir=pi.imageAtlas.patternPositions[pr.toString()];ir&&Nt.setConstantPatternPositions(ir)}let nr=h.paint.get("fill-extrusion-vertical-gradient"),Ir;if(Ht&&qt){if(Yd(pi.tileID,Ai,m))continue;let ir=qt.calculateShadowPassMatrixFromTile(pi.tileID.toUnwrapped());Ir=ml(ir,Oe,at)}else{let ir=m.translatePosMatrix(di.expandedProjMatrix,pi,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),tn=j.projection.createInversionMatrix(j,di.canonical);Ir=re?vu(ir,m,nr,ae,fe,Oe,di,pi,Ne,Ke,Pe,tn,Be,at):Nl(ir,m,nr,ae,fe,Oe,di,Ne,Ke,Pe,tn,Be,at,je,ft,qe)}m.uploadCommonUniforms(P,Li,di.toUnwrapped(),null,yt);let Ur=Ai.segments;if(j.projection.name==="mercator"&&!Ht&&(Ur=Ai.getVisibleSegments(pi.tileID,m.terrain,m.transform.getFrustum(0)),!Ur.get().length))continue;if(jt)if(Ht)for(let ir of Ur.get())jt.numRenderedVerticesInShadowPass+=ir.primitiveLength;else for(let ir of Ur.get())jt.numRenderedVerticesInTransparentPass+=ir.primitiveLength;let un=[];(m.terrain||C)&&un.push(Ai.centroidVertexBuffer),Je&&un.push(Ai.layoutVertexExtBuffer),Li.draw(m,P.gl.TRIANGLES,y,b,S,i.af.backCCW,Ir,h.id,Ai.layoutVertexBuffer,Ai.indexBuffer,Ur,h.paint,m.transform.zoom,Nt,un)}m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!1)}function Na(m,o,h,g,y,b,S,C,P,O,j,X,re,ae,ue,he,fe,me,Le){let Oe=m.context,Ne=Oe.gl,Je=m.transform,Ke=m.transform.zoom,Pe=[],Be=$s(m,h.paint.get("fill-extrusion-cutoff-fade-range"));O==="clear"?(Pe.push("CLEAR_SUBPASS"),Le&&(Pe.push("CLEAR_FROM_TEXTURE"),Oe.activeTexture.set(Ne.TEXTURE0),Le.bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE))):O==="sdf"&&Pe.push("SDF_SUBPASS"),fe&&Pe.push("HAS_CENTROID"),Be.shouldRenderCutoff&&Pe.push("RENDER_CUTOFF");let je=h.layout.get("fill-extrusion-edge-radius"),at=(yt,qe,bt,Ct,Ht)=>{let qt=qe.programConfigurations.get(h.id),Ut=m.isTileAffectedByFog(yt),ft=m.getOrCreateProgram("fillExtrusionGroundEffect",{config:qt,defines:Pe,overrideFog:Ut}),kt=((di,pi,Ai,mi,Yt,Nt,Li,pr,nr,Ir,Ur)=>({u_matrix:pi,u_opacity:Ai,u_ao_pass:mi?1:0,u_meter_to_tile:Yt,u_ao:Nt,u_flood_light_intensity:Li,u_flood_light_color:pr,u_attenuation:nr,u_edge_radius:Ir,u_fb:0,u_fb_size:Ur}))(0,Ct,j,P,Ht,[X,re*Ht],ae,ue,he,Ke>=17?0:je*Ht,Le?Le.size[0]:0),jt=[];fe&&jt.push(qe.hiddenByLandmarkVertexBuffer),m.uploadCommonUniforms(Oe,ft,yt.toUnwrapped(),null,Be),ft.draw(m,Oe.gl.TRIANGLES,y,b,S,C,kt,h.id,qe.vertexBuffer,qe.indexBuffer,bt,h.paint,Ke,qt,jt)};for(let yt of g){let qe=o.getTile(yt),bt=qe.getBucket(h);if(!bt||bt.projection.name!==Je.projection.name||!bt.groundEffect||bt.groundEffect&&!bt.groundEffect.hasData())continue;let Ct=bt.groundEffect,Ht=1/bt.tileToMeter;{let qt=m.translatePosMatrix(yt.projMatrix,qe,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),Ut=Ct.getDefaultSegment();at(yt,Ct,Ut,qt,Ht)}if(me)for(let qt=0;qt<4;qt++){let Ut=i.bZ[qt](yt),ft=o.getTile(Ut);if(!ft)continue;let kt=ft.getBucket(h);if(!kt||kt.projection.name!==Je.projection.name||!kt.groundEffect||kt.groundEffect&&!kt.groundEffect.hasData())continue;let jt=kt.groundEffect,di,pi;qt===0?(di=[-i.a3,0,0],pi=1):qt===1?(di=[i.a3,0,0],pi=0):qt===2?(di=[0,-i.a3,0],pi=3):(di=[0,i.a3,0],pi=2);let Ai=jt.regionSegments[pi];if(!Ai)continue;let mi=new Float32Array(16);i.ad.translate(mi,yt.projMatrix,di),at(yt,jt,Ai,m.translatePosMatrix(mi,qe,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),Ht)}}}function xc(m,o,h,g,y,b,S){g.centroidVertexArray.length===0&&g.createCentroidsBuffer();let C=b?b.findDEMTileFor(h):null;if(!(C&&C.dem||S))return;let P=me=>new i.P(Math.ceil((me+i.c0)*i.c1),0),O=me=>{let Le=o.getSource().minzoom,Oe=Je=>{let Ke=o.getTileByID(Je);if(Ke&&Ke.hasData())return Ke.getBucket(y)},Ne=[0,-1,1];for(let Je of Ne){if(me.overscaledZ+Je<Le)continue;let Ke=Oe(me.calculateScaledKey(me.overscaledZ+Je));if(Ke)return Ke}},j=[0,0,0],X=(me,Le)=>(j[0]=Math.min(me.min.y,Le.min.y),j[1]=Math.max(me.max.y,Le.max.y),j[2]=i.a3-Le.min.x>me.max.x?Le.min.x-i.a3:me.max.x,j),re=(me,Le)=>(j[0]=Math.min(me.min.x,Le.min.x),j[1]=Math.max(me.max.x,Le.max.x),j[2]=i.a3-Le.min.y>me.max.y?Le.min.y-i.a3:me.max.y,j),ae=[(me,Le)=>X(me,Le),(me,Le)=>X(Le,me),(me,Le)=>re(me,Le),(me,Le)=>re(Le,me)],ue=(me,Le,Oe,Ne,Je,Ke,Pe)=>{if(!b)return 0;let Be=[[Ke?Oe:me,Ke?me:Oe,0],[Ke?Oe:Le,Ke?Le:Oe,0]],je=Pe<0?i.a3+Pe:Pe,at=[Ke?je:(me+Le)/2,Ke?(me+Le)/2:je,0];return Oe===0&&Pe<0||Oe!==0&&Pe>0?b.getForTilePoints(Je,[at],!0,Ne):Be.push(at),b.getForTilePoints(h,Be,!0,C),Math.max(Be[0][2],Be[1][2],at[2])/b.exaggeration()};for(let me=0;me<4;me++){let Le=g.borderFeatureIndices[me];if(Le.length===0)continue;let Oe=i.bZ[me](h),Ne=O(Oe);if(!(Ne&&Ne instanceof i.b_)||g.borderDoneWithNeighborZ[me]===Ne.canonical.z)continue;Ne.centroidVertexArray.length===0&&Ne.createCentroidsBuffer();let Je=b?b.findDEMTileFor(Oe):null;if(!(Je&&Je.dem||S))continue;let Ke=(me<2?1:5)-me,Pe=Ne.borderDoneWithNeighborZ[Ke]!==g.canonical.z,Be=Ne.borderFeatureIndices[Ke],je=0;if(g.canonical.z!==Ne.canonical.z){for(let at of Le)g.showCentroid(g.featuresOnBorder[at]);if(Pe)for(let at of Be)Ne.showCentroid(Ne.featuresOnBorder[at]);g.borderDoneWithNeighborZ[me]=Ne.canonical.z,Ne.borderDoneWithNeighborZ[Ke]=g.canonical.z}for(let at of Le){let yt=g.featuresOnBorder[at],qe=g.centroidData[yt.centroidDataIndex],bt=yt.borders[me],Ct;for(;je<Be.length;){Ct=Ne.featuresOnBorder[Be[je]];let Ht=Ct.borders[Ke];if(Ht[1]>bt[0]+3||Ht[0]>bt[0]-3)break;Ne.showCentroid(Ct),je++}if(Ct&&je<Be.length){let Ht=je,qt=0;for(;!(Ct.borders[Ke][0]>bt[1]-3)&&(qt++,++je!==Be.length);)Ct=Ne.featuresOnBorder[Be[je]];if(Ct=Ne.featuresOnBorder[Be[Ht]],qt>1){let kt=Ct.borders[Ke];Math.abs(bt[0]-kt[0])<3&&Math.abs(bt[1]-kt[1])<3&&(qt=1,je=Ht+1)}else if(qt===0){g.showCentroid(yt);continue}let Ut=Ne.centroidData[Ct.centroidDataIndex];S&&qt===1&&(((he=qe).flags|(fe=Ut).flags)&i.b$?(he.flags|=i.b$,fe.flags|=i.b$):(he.flags&=~i.b$,fe.flags&=~i.b$));let ft=yt.intersectsCount()>1||Ct.intersectsCount()>1;if(qt>1)je=Ht,qe.centroidXY=Ut.centroidXY=new i.P(0,0);else if(Je&&Je.dem&&!ft){let kt=ae[me](qe,Ut),jt=me%2?i.a3-1:0,di=ue(kt[0],Math.min(i.a3-1,kt[1]),jt,Je,Oe,me<2,kt[2]);qe.centroidXY=Ut.centroidXY=P(di)}else ft?qe.centroidXY=Ut.centroidXY=new i.P(0,0):(qe.centroidXY=g.encodeBorderCentroid(yt),Ut.centroidXY=Ne.encodeBorderCentroid(Ct));g.writeCentroidToBuffer(qe),Ne.writeCentroidToBuffer(Ut)}else g.showCentroid(yt)}g.borderDoneWithNeighborZ[me]=Ne.canonical.z,Ne.borderDoneWithNeighborZ[Ke]=g.canonical.z}var he,fe;(g.needsCentroidUpdate||!g.centroidVertexBuffer&&g.centroidVertexArray.length!==0)&&g.uploadCentroid(m)}let jl=[1,0,0],tp=[0,1,0],rd=[0,0,1];function Yd(m,o,h){let g=h.transform,y=h.shadowRenderer;if(!y)return!0;let b=m.toUnwrapped(),S=g.tileSize*y._cascades[h.currentShadowCascade].scale,C=o.maxHeight;if(g.elevation){let he=g.elevation.getMinMaxForTile(m);he&&(C+=he.max)}let P=[...y.shadowDirection];P[2]=-P[2];let O=y.computeSimplifiedTileShadowVolume(b,C,S,P);if(!O)return!1;let j=[jl,tp,rd,P,[P[0],0,P[2]],[0,P[1],P[2]]],X=g.projection.name==="globe",re=g.scaleZoom(S),ae=i.aM.fromInvProjectionMatrix(g.invProjMatrix,g.worldSize,re,!X),ue=y.getCurrentCascadeFrustum();return ae.intersectsPrecise(O.vertices,O.planes,j)===0||ue.intersectsPrecise(O.vertices,O.planes,j)===0}function mh(m){return[m[0]*i.c2,m[1]*i.c2,m[2]*i.c2,0]}function gh(m,o,h,g,y,b,S,C,P){let O=g.getSource(),j=h.globeSharedBuffers;if(!j)return;let X,re,ae;if(o&&(X=g.getTile(o)),O instanceof i.bm?(re=O.texture,ae=i.bh(0,0,h.transform)):X&&o&&(re=X.texture,ae=i.bh(o.canonical.z,o.canonical.x,h.transform)),!re||!ae)return;m||(ae=i.ad.scale(i.ad.create(),ae,[1,-1,1]));let ue=h.context,he=ue.gl,fe=y.paint.get("raster-resampling")==="nearest"?he.NEAREST:he.LINEAR,me=h.colorModeForDrapableLayerRenderPass(b),Le=S.defines;Le.push("GLOBE_POLES");let Oe=new i.ae(he.LEQUAL,i.ae.ReadWrite,h.depthRangeFor3D),Ne=Float32Array.from(h.transform.expandedFarZProjMatrix),Je=Float32Array.from(i.bf(i.bg(new i.aO(0,0,0))));h.terrain&&h.terrain.prepareDrawTile(),ue.activeTexture.set(he.TEXTURE0),re.bind(fe,he.CLAMP_TO_EDGE),ue.activeTexture.set(he.TEXTURE1),re.bind(fe,he.CLAMP_TO_EDGE),re.useMipmap&&ue.extTextureFilterAnisotropic&&h.transform.pitch>20&&he.texParameterf(he.TEXTURE_2D,ue.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ue.extTextureFilterAnisotropicMax);let[Ke,Pe,Be,je]=o?j.getPoleBuffers(o.canonical.z,!1):j.getPoleBuffers(0,!0),at=y.paint.get("raster-elevation"),yt;m?(yt=Ke,h.renderDefaultNorthPole=at!==0):(yt=Pe,h.renderDefaultSouthPole=at!==0);let qe=mh(S.mix),bt=((Ht,qt,Ut,ft,kt,jt,di,pi,Ai,mi,Yt,Nt,Li)=>Wc(Ht,qt,Ut,new Float32Array(16),new Float32Array(9),[0,0],ft,[0,0],[0,0,0,0],1,{opacity:1,mix:0},jt,[0,0],pi,2,mi,Yt,Nt,1,0,Li))(Ne,Je,ae,i.a1(h.transform.zoom),0,y,0,at,0,qe,S.offset,S.range,b),Ct=h.getOrCreateProgram("raster",{defines:Le});h.uploadCommonUniforms(ue,Ct,null),Ct.draw(h,he.TRIANGLES,Oe,P,me,C,bt,y.id,yt,Be,je)}function jr(m){let o=m._nearZ,h=m.projection.farthestPixelDistance(m),g=h-o,y=.2*m.height,b=o+y;return[o,h,(b-y-o)/g,(b-o)/g]}function ip(m,o,h,g){if(m)return o instanceof Mr&&m instanceof i.c3?o.getTextureDescriptor(m,h,!0):{texture:m.texture,mix:mh(g.mix),offset:g.offset,buffer:0,tileSize:1}}function $i(m,o,h){if(!m)return null;let g=o.getTextureDescriptor(m,h,!0);if(!g)return null;let{texture:y,mix:b,offset:S,tileSize:C,buffer:P,format:O}=g;if(!y||!O)return null;let j=!1;return O==="uint32"&&(j=!0,b[3]=0,b=Zd(i.c4,b,[0,h.paint.get("raster-particle-max-speed")]),S=bu(i.c4,S,[0,h.paint.get("raster-particle-max-speed")])),{texture:y,textureOffset:[P/(C+2*P),C/(C+2*P)],tileSize:C,scalarData:j,scale:b,offset:S,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[O]]}}function ds(m){let o=m._nearZ,h=m.projection.farthestPixelDistance(m),g=h-o,y=.2*m.height,b=o+y;return[o,h,(b-y-o)/g,(b-o)/g]}let Ko=new i.C(1,0,0,1),_h=new i.C(0,1,0,1),Ls=new i.C(0,0,1,1),Kd=new i.C(1,0,1,1),vc=new i.C(0,1,1,1);function Ti(m,o,h,g,y,b,S){let C=m.context,P=m.transform,O=C.gl,j=P.projection.name==="globe",X=j?["PROJECTION_GLOBE_VIEW"]:[],re=i.ad.clone(h.projMatrix);if(j&&i.a1(P.zoom)>0){let qe=i.c5(h.canonical,P),bt=i.c6(qe);re=i.ad.multiply(new Float32Array(16),P.globeMatrix,bt),i.ad.multiply(re,P.projMatrix,re)}let ae=i.ad.create();ae[12]+=2*y/(i.e.devicePixelRatio*P.width),ae[13]+=2*b/(i.e.devicePixelRatio*P.height),i.ad.multiply(re,ae,re);let ue=m.getOrCreateProgram("debug",{defines:X}),he=o.getTileByID(h.key);m.terrain&&m.terrain.setupElevationDraw(he,ue);let fe=i.ae.disabled,me=i.ag.disabled,Le=m.colorModeForRenderPass(),Oe="$debug";C.activeTexture.set(O.TEXTURE0),m.emptyTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),j?he._makeGlobeTileDebugBuffers(m.context,P):he._makeDebugTileBoundsBuffers(m.context,P.projection);let Ne=he._tileDebugBuffer||m.debugBuffer,Je=he._tileDebugIndexBuffer||m.debugIndexBuffer,Ke=he._tileDebugSegments||m.debugSegments;if(ue.draw(m,O.LINE_STRIP,fe,me,Le,i.af.disabled,pc(re,g),Oe,Ne,Je,Ke,null,null,null,[he._globeTileDebugBorderBuffer]),S){let qe=he.latestRawTileData,bt=Math.floor((qe&&qe.byteLength||0)/1024),Ct=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(Ct+=` => ${h.overscaledZ}`),Ct+=` ${he.state}`,Ct+=` ${bt}kb`,function(Ht,qt){Ht.initDebugOverlayCanvas();let Ut=Ht.debugOverlayCanvas,ft=Ht.context.gl,kt=Ht.debugOverlayCanvas.getContext("2d");kt.clearRect(0,0,Ut.width,Ut.height),kt.shadowColor="white",kt.shadowBlur=2,kt.lineWidth=1.5,kt.strokeStyle="white",kt.textBaseline="top",kt.font="bold 36px Open Sans, sans-serif",kt.fillText(qt,5,5),kt.strokeText(qt,5,5),Ht.debugOverlayTexture.update(Ut),Ht.debugOverlayTexture.bind(ft.LINEAR,ft.CLAMP_TO_EDGE)}(m,Ct)}let Pe=o.getTile(h).tileSize,Be=512/Math.min(Pe,512)*(h.overscaledZ/P.zoom)*.5,je=he._tileDebugTextBuffer||m.debugBuffer,at=he._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,yt=he._tileDebugTextSegments||m.debugSegments;ue.draw(m,O.TRIANGLES,fe,me,i.a.alphaBlended,i.af.disabled,pc(re,i.C.transparent,Be),Oe,je,at,yt,null,null,null,[he._globeTileDebugTextBuffer])}function Br(m,o,h,g){Ao(m,0,o+h/2,m.transform.width,h,g)}function Vr(m,o,h,g){Ao(m,o-h/2,0,h,m.transform.height,g)}function Ao(m,o,h,g,y,b){let S=m.context,C=S.gl;C.enable(C.SCISSOR_TEST),C.scissor(o*i.e.devicePixelRatio,h*i.e.devicePixelRatio,g*i.e.devicePixelRatio,y*i.e.devicePixelRatio),S.clear({color:b}),C.disable(C.SCISSOR_TEST)}let $c=i.c7([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Fr}=$c;function Rs(m,o,h,g){m.emplaceBack(o,h,g)}class xh{constructor(o){this.vertexArray=new i.c8,this.indices=new i.bu,Rs(this.vertexArray,-1,-1,1),Rs(this.vertexArray,1,-1,1),Rs(this.vertexArray,-1,1,1),Rs(this.vertexArray,1,1,1),Rs(this.vertexArray,-1,-1,-1),Rs(this.vertexArray,1,-1,-1),Rs(this.vertexArray,-1,1,-1),Rs(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,Fr),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=i.b.simpleSegment(0,0,36,12)}}function Vl(m,o,h,g,y,b){let S=m.context.gl,C=o.paint.get("sky-atmosphere-color"),P=o.paint.get("sky-atmosphere-halo-color"),O=o.paint.get("sky-atmosphere-sun-intensity"),j=((X,re,ae,ue,he)=>({u_matrix_3f:X,u_sun_direction:re,u_sun_intensity:ae,u_color_tint_r:[ue.r,ue.g,ue.b,ue.a],u_color_tint_m:[he.r,he.g,he.b,he.a],u_luminance:5e-5}))(i.bC.fromMat4(i.bC.create(),g),y,O,C,P);S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,S.TEXTURE_CUBE_MAP_POSITIVE_X+b,o.skyboxTexture,0),h.draw(m,S.TRIANGLES,i.ae.disabled,i.ag.disabled,i.a.unblended,i.af.frontCW,j,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}let Jo=i.c7([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class ba{constructor(o){let h=new i.c9;h.emplaceBack(-1,1,1,0,0),h.emplaceBack(1,1,1,1,0),h.emplaceBack(1,-1,1,1,1),h.emplaceBack(-1,-1,1,0,1);let g=new i.bu;g.emplaceBack(0,1,2),g.emplaceBack(2,3,0),this.vertexBuffer=o.createVertexBuffer(h,Jo.members),this.indexBuffer=o.createIndexBuffer(g),this.segments=i.b.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}let I0=i.c7([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class nd{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class rp{constructor(o){this.colorModeAlphaBlendedWriteRGB=new i.a([i.ca,i.cb,i.ca,i.cb],i.C.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new i.a([i.ca,i.cc,i.ca,i.cc],i.C.transparent,[!1,!1,!1,!0]),this.params=new nd,this.updateNeeded=!0,o.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),o.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),o.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),o.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(o){let h=o.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new ba(h);let g=this.params.sizeRange,y=this.params.intensityRange,b=function(j){let X=i.cf(30),re=[];for(let ae=0;ae<j;++ae){let ue=2*Math.PI*X(),he=Math.acos(1-2*X())-.5*Math.PI;re.push(i._.fromValues(Math.cos(he)*Math.cos(ue),Math.cos(he)*Math.sin(ue),Math.sin(he)))}return re}(this.params.starsCount),S=i.cf(300),C=new i.cd,P=new i.bu,O=0;for(let j=0;j<b.length;++j){let X=i._.scale([],b[j],200),re=Math.max(0,1+.01*g*(1*S()-.5)),ae=Math.max(0,1+.01*y*(1*S()-.5));C.emplaceBack(X[0],X[1],X[2],-1,-1,re,ae),C.emplaceBack(X[0],X[1],X[2],1,-1,re,ae),C.emplaceBack(X[0],X[1],X[2],1,1,re,ae),C.emplaceBack(X[0],X[1],X[2],-1,1,re,ae),P.emplaceBack(O+0,O+1,O+2),P.emplaceBack(O+0,O+2,O+3),O+=4}this.starsVx=h.createVertexBuffer(C,I0.members),this.starsIdx=h.createIndexBuffer(P),this.starsSegments=i.b.simpleSegment(0,0,C.length,P.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(o,h){let g=o.context,y=g.gl,b=o.transform,S=new i.ae(y.LEQUAL,i.ae.ReadOnly,[0,1]),C=i.a1(b.zoom),P=o.style.getLut(h.scope),O=h.properties.get("color").toRenderColor(P).toArray01(),j=h.properties.get("high-color").toRenderColor(P).toArray01(),X=h.properties.get("space-color").toRenderColor(P).toArray01PremultipliedAlpha(),re=5e-4,ae=i.ce(h.properties.get("horizon-blend"),0,1,re,.25),ue=i.ba(o,g,b)&&ae===re?b.worldSize/(2*Math.PI*1.025)-1:b.globeRadius,he=o.frameCounter/1e3%1,fe=i._.length(b.globeCenterInViewSpace),me=Math.sqrt(Math.pow(fe,2)-Math.pow(ue,2)),Le=Math.acos(me/fe),Oe=Ne=>{let Je=b.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Ne&&Je.push("ALPHA_PASS");let Ke=o.getOrCreateProgram("globeAtmosphere",{defines:Je}),Pe=((je,at,yt,qe,bt,Ct,Ht,qt,Ut,ft,kt,jt)=>({u_frustum_tl:je,u_frustum_tr:at,u_frustum_br:yt,u_frustum_bl:qe,u_horizon:bt,u_transition:Ct,u_fadeout_range:Ht,u_color:qt,u_high_color:Ut,u_space_color:ft,u_temporal_offset:kt,u_horizon_angle:jt}))(b.frustumCorners.TL,b.frustumCorners.TR,b.frustumCorners.BR,b.frustumCorners.BL,b.frustumCorners.horizon,C,ae,O,j,X,he,Le);o.uploadCommonUniforms(g,Ke);let Be=this.atmosphereBuffer;Be&&Ke.draw(o,y.TRIANGLES,S,i.ag.disabled,Ne?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,i.af.backCW,Pe,Ne?"atmosphere_glow_alpha":"atmosphere_glow",Be.vertexBuffer,Be.indexBuffer,Be.segments)};Oe(!1),Oe(!0)}drawStars(o,h){let g=i.at(h.properties.get("star-intensity"),0,1);if(g===0)return;let y=o.context,b=y.gl,S=o.transform,C=o.getOrCreateProgram("stars"),P=i.av.identity([]);i.av.rotateX(P,P,-S._pitch),i.av.rotateZ(P,P,-S.angle),i.av.rotateX(P,P,i.ab(S._center.lat)),i.av.rotateY(P,P,-i.ab(S._center.lng));let O=i.ad.fromQuat(new Float32Array(16),P),j=i.ad.multiply([],S.starsProjMatrix,O),X=i.bC.fromMat4([],O),re=i.bC.invert([],X),ae=[0,1,0];i._.transformMat3(ae,ae,re),i._.scale(ae,ae,this.params.sizeMultiplier);let ue=[1,0,0];i._.transformMat3(ue,ue,re),i._.scale(ue,ue,this.params.sizeMultiplier);let he=(fe=ae,me=ue,Le=g,{u_matrix:Float32Array.from(j),u_up:fe,u_right:me,u_intensity_multiplier:Le});var fe,me,Le;o.uploadCommonUniforms(y,C),this.starsVx&&this.starsIdx&&C.draw(o,b.TRIANGLES,i.ae.disabled,i.ag.disabled,this.colorModeAlphaBlendedWriteRGB,i.af.disabled,he,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function vh(m,o){let h=[...m],g=o.cameraWorldSizeForFog/o.worldSize,y=i.ad.identity([]);return i.ad.scale(y,y,[g,g,1]),i.ad.multiply(h,y,h),i.ad.multiply(h,o.worldToFogMatrix,h),h}function Su(m,o,h,g,y){let b=h.material,S=g.context,{baseColorTexture:C,metallicRoughnessTexture:P}=b.pbrMetallicRoughness,{normalTexture:O,occlusionTexture:j,emissionTexture:X}=b;function re(ae,ue,he){if(ae&&(m.push(ue),S.activeTexture.set(S.gl.TEXTURE0+he),ae.gfxTexture)){let{minFilter:fe,magFilter:me,wrapS:Le,wrapT:Oe}=ae.sampler;ae.gfxTexture.bindExtraParam(fe,me,Le,Oe)}}re(C,"HAS_TEXTURE_u_baseColorTexture",to.BaseColor),re(P,"HAS_TEXTURE_u_metallicRoughnessTexture",to.MetallicRoughness),re(O,"HAS_TEXTURE_u_normalTexture",to.Normal),re(j,"HAS_TEXTURE_u_occlusionTexture",to.Occlusion),re(X,"HAS_TEXTURE_u_emissionTexture",to.Emission),y&&(y.texture||(y.texture=new i.ch(g.context,y.image,[y.image.height,y.image.height,y.image.height],S.gl.RGBA)),S.activeTexture.set(S.gl.TEXTURE0+to.LUT),y.texture&&y.texture.bind(S.gl.LINEAR,S.gl.CLAMP_TO_EDGE),m.push("APPLY_LUT_ON_GPU")),h.texcoordBuffer&&(m.push("HAS_ATTRIBUTE_a_uv_2f"),o.push(h.texcoordBuffer)),h.colorBuffer&&(m.push(h.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),o.push(h.colorBuffer)),h.normalBuffer&&(m.push("HAS_ATTRIBUTE_a_normal_3f"),o.push(h.normalBuffer)),h.pbrBuffer&&(m.push("HAS_ATTRIBUTE_a_pbr"),m.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),o.push(h.pbrBuffer)),b.alphaMode!=="OPAQUE"&&b.alphaMode!=="MASK"||m.push("UNPREMULT_TEXTURE_IN_SHADER"),b.defined||m.push("DIFFUSE_SHADED"),m.push("USE_STANDARD_DERIVATIVES")}function yc(m,o,h,g,y,b){let S=h.paint.get("model-opacity"),C=o.context,P=new i.ae(o.context.gl.LEQUAL,i.ae.ReadWrite,o.depthRangeFor3D),O=o.transform,j=m.mesh,X=j.material,re=X.pbrMetallicRoughness,ae=o.style.fog,ue;ue=o.transform.projection.zAxisUnit==="pixels"?[...m.nodeModelMatrix]:i.ad.multiply([],g.zScaleMatrix,m.nodeModelMatrix),i.ad.multiply(ue,g.negCameraPosMatrix,ue);let he=i.ad.invert([],ue);i.ad.transpose(he,he);let fe=h.paint.get("model-emissive-strength").constantOr(0),me=Bl(new Float32Array(m.worldViewProjection),new Float32Array(ue),new Float32Array(he),null,o,S,re.baseColorFactor.toRenderColor(null),X.emissiveFactor,re.metallicFactor,re.roughnessFactor,X,fe,h),Le={defines:[]},Oe=[];Su(Le.defines,Oe,j,o,h.lut);let Ne=o.shadowRenderer;Ne&&(Ne.useNormalOffset=!1);let Je=null;if(ae){let Be=vh(m.nodeModelMatrix,o.transform);if(Je=new Float32Array(Be),O.projection.name!=="globe"){let je=j.aabb.min,at=j.aabb.max,[yt,qe]=ae.getOpacityForBounds(Be,je[0],je[1],at[0],at[1]);Le.overrideFog=yt>=en||qe>=en}}let Ke=$s(o,h.paint.get("model-cutoff-fade-range"));Ke.shouldRenderCutoff&&Le.defines.push("RENDER_CUTOFF");let Pe=o.getOrCreateProgram("model",Le);o.uploadCommonUniforms(C,Pe,null,Je,Ke),o.renderPass!=="shadow"&&Ne&&Ne.setupShadowsFromMatrix(m.nodeModelMatrix,Pe),Pe.draw(o,C.gl.TRIANGLES,P,y,b,j.material.doubleSided?i.af.disabled:i.af.backCCW,me,h.id,j.vertexBuffer,j.indexBuffer,j.segments,h.paint,o.transform.zoom,void 0,Oe)}function Ga(m,o,h,g,y,b,S){let C;C=m.projection.name==="globe"?i.ci(h,m):[...h],i.ad.multiply(C,C,o.matrix);let P=i.ad.multiply([],g,C);if(o.meshes)for(let O of o.meshes){if(O.material.alphaMode!=="BLEND"){S.push({mesh:O,depth:0,modelIndex:y,worldViewProjection:P,nodeModelMatrix:C});continue}let j=i._.transformMat4([],O.centroid,P);j[2]>0&&b.push({mesh:O,depth:j[2],modelIndex:y,worldViewProjection:P,nodeModelMatrix:C})}if(o.children)for(let O of o.children)Ga(m,O,h,g,y,b,S)}function Qo(m,o,h,g){let y=h.shadowRenderer;if(!y)return;let b=y.getShadowPassDepthMode(),S=y.getShadowPassColorMode(),C=y.calculateShadowPassMatrixFromMatrix(o),P=ph(C);h.getOrCreateProgram("modelDepth",{defines:h._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(h,h.context.gl.TRIANGLES,b,i.ag.disabled,S,i.af.backCCW,P,g.id,m.vertexBuffer,m.indexBuffer,m.segments,g.paint,h.transform.zoom,void 0,void 0)}function sm(m,o,h){let g=o.updateZoomBasedPaintProperties(),y=function(b,S,C){let P,O,j,X=b.terrain?b.terrain.exaggeration():0;if(b.terrain&&X>0){let re=b.terrain,ae=re.findDEMTileFor(C);ae&&ae.dem?P=i.ck.create(re,C,ae):X=0}if(X===0&&(S.terrainElevationMin=0,S.terrainElevationMax=0),X===S.validForExaggeration&&(X===0||P&&P._demTile&&P._demTile.tileID===S.validForDEMTile.id&&P._dem._timestamp===S.validForDEMTile.timestamp))return!1;for(let re in S.instancesPerModel){let ae=S.instancesPerModel[re];for(let ue=0;ue<ae.instancedDataArray.length;++ue){let he=(P?X*P.getElevationAt(0|ae.instancedDataArray.float32[16*ue],0|ae.instancedDataArray.float32[16*ue+1],!0,!0):0)+ae.instancesEvaluatedElevation[ue];ae.instancedDataArray.float32[16*ue+6]=he,O=O?Math.min(S.terrainElevationMin,he):he,j=j?Math.max(S.terrainElevationMax,he):he}}return S.terrainElevationMin=O||0,S.terrainElevationMax=j||0,S.validForExaggeration=X,S.validForDEMTile=P&&P._demTile?{id:P._demTile.tileID,timestamp:P._dem._timestamp}:{id:void 0,timestamp:0},!0}(m,o,h);(g||y)&&(o.uploaded=!1,o.upload(m.context))}let Bo={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.b6([0,0,0],[i.a3,i.a3,0])};function Ba(m,o){let h=1<<m.canonical.z,g=o.getFreeCameraOptions().position,y=o.elevation,b=m.canonical.x/h,S=(m.canonical.x+1)/h,C=m.canonical.y/h,P=(m.canonical.y+1)/h,O=o._centerAltitude;if(y){let ae=y.getMinMaxForTile(m);ae&&ae.max>O&&(O=ae.max)}let j=i.at(g.x,b,S)-g.x,X=i.at(g.y,C,P)-g.y,re=i.ax(O,o.center.lat)-g.z;return o._zoomFromMercatorZ(Math.sqrt(j*j+X*X+re*re))}function Ks(m,o,h,g,y,b,S){let C=m.context,P=m.renderPass==="shadow",O=m.shadowRenderer,j=P&&O?O.getShadowPassDepthMode():new i.ae(C.gl.LEQUAL,i.ae.ReadWrite,m.depthRangeFor3D),X=m.isTileAffectedByFog(b);if(h.meshes)for(let re of h.meshes){let ae=["MODEL_POSITION_ON_GPU"],ue=[],he,fe,me;g.instancedDataArray.length>20&&ae.push("INSTANCED_ARRAYS");let Le=$s(m,o.paint.get("model-cutoff-fade-range"));if(Le.shouldRenderCutoff&&ae.push("RENDER_CUTOFF"),P&&O)he=m.getOrCreateProgram("modelDepth",{defines:ae}),fe=ph(S.shadowTileMatrix,S.shadowTileMatrix,Float32Array.from(h.matrix)),me=O.getShadowPassColorMode();else{Su(ae,ue,re,m,o.lut),he=m.getOrCreateProgram("model",{defines:ae,overrideFog:X});let Ne=re.material,Je=Ne.pbrMetallicRoughness,Ke=o.paint.get("model-opacity"),Pe=o.paint.get("model-emissive-strength").constantOr(0);fe=Bl(b.expandedProjMatrix,Float32Array.from(h.matrix),new Float32Array(16),null,m,Ke,Je.baseColorFactor.toRenderColor(null),Ne.emissiveFactor,Je.metallicFactor,Je.roughnessFactor,Ne,Pe,o,y),O&&(S.shadowUniformsInitialized?he.setShadowUniformValues(C,O.getShadowUniformValues()):(O.setupShadows(b.toUnwrapped(),he,"model-tile",b.overscaledZ),S.shadowUniformsInitialized=!0)),me=Le.shouldRenderCutoff||Ke<1||Ne.alphaMode!=="OPAQUE"?i.a.alphaBlended:i.a.unblended}m.uploadCommonUniforms(C,he,b.toUnwrapped(),null,Le);let Oe=re.material.doubleSided?i.af.disabled:i.af.backCCW;if(g.instancedDataArray.length>20)ue.push(g.instancedDataBuffer),he.draw(m,C.gl.TRIANGLES,j,i.ag.disabled,me,Oe,fe,o.id,re.vertexBuffer,re.indexBuffer,re.segments,o.paint,m.transform.zoom,void 0,ue,g.instancedDataArray.length);else{let Ne=P?"u_instance":"u_normal_matrix";for(let Je=0;Je<g.instancedDataArray.length;++Je)fe[Ne]=new Float32Array(g.instancedDataArray.arrayBuffer,64*Je,16),he.draw(m,C.gl.TRIANGLES,j,i.ag.disabled,me,Oe,fe,o.id,re.vertexBuffer,re.indexBuffer,re.segments,o.paint,m.transform.zoom,void 0,ue)}}if(h.children)for(let re of h.children)Ks(m,o,re,g,y,b,S)}let bc=[1,-1,1];function no(m,o,h,g){if(!h.modelManager)return!0;let y=h.modelManager;if(!h.shadowRenderer)return!0;let b=h.shadowRenderer,S=o.aabb,C=!0,P=m.maxHeight;if(P===0){let j=0;for(let X in m.instancesPerModel){let re=y.getModel(X,g);re?j=Math.max(j,Math.max(Math.max(re.aabb.max[0],re.aabb.max[1]),re.aabb.max[2])):C=!1}P=m.maxScale*j*1.41+m.maxVerticalOffset,C&&(m.maxHeight=P)}S.max[2]=P,S.min[2]+=m.terrainElevationMin,S.max[2]+=m.terrainElevationMax,i._.transformMat4(S.min,S.min,o.tileMatrix),i._.transformMat4(S.max,S.max,o.tileMatrix);let O=S.intersects(b.getCurrentCascadeFrustum());return h.currentShadowCascade===0&&(m.isInsideFirstShadowMapFrustum=O===2),O===0}function Ul(m,o){let h=m.uniformValues.u_cutoff_params[0],g=m.uniformValues.u_cutoff_params[1],y=m.uniformValues.u_cutoff_params[2],b=m.uniformValues.u_cutoff_params[3];return g===h||b===y?1:i.at(((o-h)/(g-h)-y)/(b-y),0,1)}function Wa(m,o,h,g){if(o.pitch<20)return 1;let y=o.getWorldToCameraMatrix(),b=i.ad.multiply([],y,m),S=[...h.min,1],C=i.aA.transformMat4([],S,b),P=C,O=C;S[1]=h.max[1],C=i.aA.transformMat4([],S,b),P=C[1]<P[1]?C:P,O=C[1]>O[1]?C:O,S[0]=h.max[0],C=i.aA.transformMat4([],S,b),P=C[1]<P[1]?C:P,O=C[1]>O[1]?C:O,S[1]=h.min[1],C=i.aA.transformMat4([],S,b),P=C[1]<P[1]?C:P,O=C[1]>O[1]?C:O;let j=i.at(g[0],0,1),X=100*o.pixelsPerMeter*i.at(g[1],0,1),re=i.at(g[2],0,1),ae=i._.lerp([],P,O,j),ue=Math.tan(.5*o.fovX),he=-ae[2]*ue;if(X===0)return ae[1]<-Math.abs(he)?re:1;let fe=(-Math.abs(he)-ae[1])/X,me=(Oe,Ne,Je)=>(1-Je)*Oe+Je*Ne,Le=i.at(me(1,re,fe),re,1);return me(1,Le,i.at((o.pitch-20)/20,0,1))}class Os{}class ad{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(o,h,g){{let X=this._storage.get(h.id);if(X)return X.lastUsedFrameIdx=o,X.buf}let y=g.gl,b=y.getBufferParameter(y.ELEMENT_ARRAY_BUFFER,y.BUFFER_SIZE),S=new ArrayBuffer(b),C=new Int16Array(S);y.getBufferSubData(y.ELEMENT_ARRAY_BUFFER,0,new Int16Array(S));let P=new i.cm;for(let X=0;X<b/2;X+=3){let re=C[X],ae=C[X+1],ue=C[X+2];P.emplaceBack(re,ae),P.emplaceBack(ae,ue),P.emplaceBack(ue,re)}let O=g.bindVertexArrayOES.current,j=new Os;return j.buf=new i.I(g,P),j.lastUsedFrameIdx=o,this._storage.set(h.id,j),g.bindVertexArrayOES.set(O),j.buf}update(o){for(let[h,g]of this._storage)o-g.lastUsedFrameIdx>30&&(g.buf.destroy(),this._storage.delete(h))}destroy(){for(let[o,h]of this._storage)h.buf.destroy(),this._storage.delete(o)}}let Xc=i.c7([{type:"Float32",name:"a_offset_xy",components:2}]);class Zc{constructor(o){let h=new i.cn,g=new i.bu;h.emplaceBack(-1,-1),h.emplaceBack(1,-1),h.emplaceBack(1,1),h.emplaceBack(-1,1),g.emplaceBack(0,1,2),g.emplaceBack(0,2,3),this.segments=i.b.simpleSegment(0,0,h.length,g.length),this.vx=o.createVertexBuffer(h,Xc.members),this.idx=o.createIndexBuffer(g)}destroy(){this.vx.destroy(),this.idx.destroy()}}let za={symbol:function(m,o,h,g,y){if(m.renderPass!=="translucent")return;let b=i.ag.disabled,S=m.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(O,j,X,re,ae,ue,he){let fe=j.transform,me=ae==="map",Le=ue==="map";for(let Oe of O){let Ne=re.getTile(Oe),Je=Ne.getBucket(X);if(!Je||!Je.text||!Je.text.segments.get().length)continue;let Ke=i.aD(Je.textSizeData,fe.zoom),Pe=vl(Oe,Je.getProjection(),fe),Be=fe.calculatePixelsToTileUnitsMatrix(Ne),je=Ll(Pe,Ne.tileID.canonical,Le,me,fe,Je.getProjection(),Be),at=Je.hasIconTextFit()&&Je.hasIconData();if(Ke){let yt=Math.pow(2,fe.zoom-Ne.tileID.overscaledZ);Xn(Je,me,Le,he,i.bO,fe,je,Oe,yt,Ke,at)}}}(g,m,h,o,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),y);let C=h.paint.get("icon-opacity").constantOr(1)!==0,P=h.paint.get("text-opacity").constantOr(1)!==0;h.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(C||P)?Vn(m,o,h,g,b,S):(C&&Vn(m,o,h,g,b,S,{onlyIcons:!0}),P&&Vn(m,o,h,g,b,S,{onlyText:!0}),function(O,j,X,re){if(!O.symbolParams.useOcclusionQueries)return;let ae=O.context.gl,ue=O.transform,he=X.paint,fe=he.get("icon-occlusion-opacity").constantOr(0),me=he.get("text-occlusion-opacity").constantOr(0);if(!X.hasInitialOcclusionOpacityProperties||fe===1&&me===1)return;let Le=ue.projection.name==="globe";for(let Oe of re){let Ne=j.getTile(Oe),Je=Ne.getBucket(X);if(!Je||Je.projection.name==="mercator"&&Le||Je.fullyClipped)continue;if(Je.projection.name==="globe"){i.w(`Occlusion not supported for globe mode. Layer: ${X.type}`);continue}let Ke=vl(Oe,Je.getProjection(),ue),Pe=i.ad.fromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,O.symbolParams.depthOffset,1),Be=i.ad.multiply([],Pe,Ke),je=O.symbolParams.visualizeOcclusions!=="none"?1:O.symbolParams.occlusionQueryFrameWindow;for(let at=0;at<Je.symbolInstances.length;at++){let yt=Je.symbolInstances.get(at),qe=O.style.placement.opacities[yt.crossTileID];if(qe&&qe.isHidden()||(O.frameCounter+at)%je!=0)continue;let bt=yt.tileAnchorX,Ct=yt.tileAnchorY,Ht=yt.zOffset,qt;if(O.symbolParams.visualizeOcclusions==="none"){let di=Je.queries.get(at);if(di){if(!di.isFree()){if(!di.isResultAvailable())continue;let pi=di.consumeResult();yt.occlusionState=pi===0?0:1;continue}qt=di}else qt=new xr(O.context),Je.queries.set(at,qt)}let Ut=O.getOrCreateProgram("occlusion"),ft=O.symbolParams.occluderSize,kt=gc(Be,[bt,Ct,Ht],[ue.width,ue.height],[ft,ft],O.symbolParams.visualizeOcclusions==="zPass"?[1,0,0,.8]:[1,.4,.2,.9]);O.terrain&&O.terrain.setupElevationDraw(Ne,Ut,{useDepthForOcclusion:!1,labelPlaneMatrixInv:void 0}),O.symbolParams.visualizeOcclusions==="none"&&qt&&qt.begin();let jt=new i.ae(O.symbolParams.visualizeOcclusions==="zPass"?O.context.gl.ALWAYS:O.context.gl.LEQUAL,i.ae.ReadOnly,O.depthRangeFor3D);Ut.draw(O,ae.TRIANGLES,jt,i.ag.disabled,O.symbolParams.visualizeOcclusions!=="none"?i.a.alphaBlendedNonPremultiplied:i.a.disabled,i.af.disabled,kt,"occlusion",O.occlusionBuffers.vx,O.occlusionBuffers.idx,O.occlusionBuffers.segments),O.symbolParams.visualizeOcclusions==="none"&&qt&&qt.end()}}}(m,o,h,g)),o.map.showCollisionBoxes&&(Ys(m,o,h,g,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),Ys(m,o,h,g,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(m,o,h,g){if(m.renderPass!=="translucent")return;let y=h.paint.get("circle-opacity"),b=h.paint.get("circle-stroke-width"),S=h.paint.get("circle-stroke-opacity"),C=h.layout.get("circle-sort-key").constantOr(1)!==void 0,P=h.paint.get("circle-emissive-strength");if(y.constantOr(1)===0&&(b.constantOr(1)===0||S.constantOr(1)===0))return;let O=m.context,j=O.gl,X=m.transform,re=m.depthModeForSublayer(0,i.ae.ReadOnly),ae=i.ag.disabled,ue=m.colorModeForDrapableLayerRenderPass(P),he=X.projection.name==="globe",fe=[i.aj(X.center.lng),i.ak(X.center.lat)],me=[];for(let Oe=0;Oe<g.length;Oe++){let Ne=g[Oe],Je=o.getTile(Ne),Ke=Je.getBucket(h);if(!Ke||Ke.projection.name!==X.projection.name)continue;let Pe=Ke.programConfigurations.get(h.id),Be=i.bR(h),je=m.isTileAffectedByFog(Ne);he&&Be.push("PROJECTION_GLOBE_VIEW");let at=m.getOrCreateProgram("circle",{config:Pe,defines:Be,overrideFog:je}),yt=Ke.layoutVertexBuffer,qe=Ke.globeExtVertexBuffer,bt=Ke.indexBuffer,Ct=X.projection.createInversionMatrix(X,Ne.canonical),Ht={programConfiguration:Pe,program:at,layoutVertexBuffer:yt,globeExtVertexBuffer:qe,indexBuffer:bt,uniformValues:i.bS(m,Ne,Je,Ct,fe,h),tile:Je};if(C){let qt=Ke.segments.get();for(let Ut of qt)me.push({segments:new i.b([Ut]),sortKey:Ut.sortKey,state:Ht})}else me.push({segments:Ke.segments,sortKey:0,state:Ht})}C&&me.sort((Oe,Ne)=>Oe.sortKey-Ne.sortKey);let Le={useDepthForOcclusion:X.depthOcclusionForSymbolsAndCircles};for(let Oe of me){let{programConfiguration:Ne,program:Je,layoutVertexBuffer:Ke,globeExtVertexBuffer:Pe,indexBuffer:Be,uniformValues:je,tile:at}=Oe.state,yt=Oe.segments;m.terrain&&m.terrain.setupElevationDraw(at,Je,Le),m.uploadCommonUniforms(O,Je,at.tileID.toUnwrapped()),Je.draw(m,j.TRIANGLES,re,ae,ue,i.af.disabled,je,h.id,Ke,Be,yt,h.paint,X.zoom,Ne,[Pe])}},heatmap:function(m,o,h,g){if(h.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){let y=m.context,b=y.gl,S=i.ag.disabled,C=new i.a([b.ONE,b.ONE,b.ONE,b.ONE],i.C.transparent,[!0,!0,!0,!0]);(function(ae,ue,he,fe){let me=ae.gl,Le=ue.width*fe,Oe=ue.height*fe;ae.activeTexture.set(me.TEXTURE1),ae.viewport.set([0,0,Le,Oe]);let Ne=he.heatmapFbo;if(!Ne||Ne&&(Ne.width!==Le||Ne.height!==Oe)){Ne&&Ne.destroy();let Je=me.createTexture();me.bindTexture(me.TEXTURE_2D,Je),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_WRAP_S,me.CLAMP_TO_EDGE),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_WRAP_T,me.CLAMP_TO_EDGE),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_MIN_FILTER,me.LINEAR),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_MAG_FILTER,me.LINEAR),Ne=he.heatmapFbo=ae.createFramebuffer(Le,Oe,!0,null),function(Ke,Pe,Be,je,at,yt){let qe=Ke.gl;qe.texImage2D(qe.TEXTURE_2D,0,Ke.extRenderToTextureHalfFloat?qe.RGBA16F:qe.RGBA,at,yt,0,qe.RGBA,Ke.extRenderToTextureHalfFloat?qe.HALF_FLOAT:qe.UNSIGNED_BYTE,null),je.colorAttachment.set(Be)}(ae,0,Je,Ne,Le,Oe)}else me.bindTexture(me.TEXTURE_2D,Ne.colorAttachment.get()),ae.bindFramebuffer.set(Ne.framebuffer)})(y,m,h,m.transform.projection.name==="globe"?.5:.25),y.clear({color:i.C.transparent});let P=m.transform,O=P.projection.name==="globe",j=O?["PROJECTION_GLOBE_VIEW"]:[],X=O?i.af.frontCCW:i.af.disabled,re=[i.aj(P.center.lng),i.ak(P.center.lat)];for(let ae=0;ae<g.length;ae++){let ue=g[ae];if(o.hasRenderableParent(ue))continue;let he=o.getTile(ue),fe=he.getBucket(h);if(!fe||fe.projection.name!==P.projection.name)continue;let me=m.isTileAffectedByFog(ue),Le=fe.programConfigurations.get(h.id),Oe=m.getOrCreateProgram("heatmap",{config:Le,defines:j,overrideFog:me}),{zoom:Ne}=m.transform;m.terrain&&m.terrain.setupElevationDraw(he,Oe),m.uploadCommonUniforms(y,Oe,ue.toUnwrapped());let Je=P.projection.createInversionMatrix(P,ue.canonical);Oe.draw(m,b.TRIANGLES,i.ae.disabled,S,C,X,ro(m,ue,he,Je,re,Ne,h.paint.get("heatmap-intensity")),h.id,fe.layoutVertexBuffer,fe.indexBuffer,fe.segments,h.paint,m.transform.zoom,Le,O?[fe.globeExtVertexBuffer]:null)}y.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),function(y,b){let S=y.context,C=S.gl,P=b.heatmapFbo;if(!P)return;S.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,P.colorAttachment.get()),S.activeTexture.set(C.TEXTURE1);let O=b.colorRampTexture;O||(O=b.colorRampTexture=new i.T(S,b.colorRamp,C.RGBA)),O.bind(C.LINEAR,C.CLAMP_TO_EDGE),y.getOrCreateProgram("heatmapTexture").draw(y,C.TRIANGLES,i.ae.disabled,i.ag.disabled,y.colorModeForRenderPass(),i.af.disabled,((j,X,re,ae)=>({u_image:0,u_color_ramp:1,u_opacity:X.paint.get("heatmap-opacity")}))(0,b),b.id,y.viewportBuffer,y.quadTriangleIndexBuffer,y.viewportSegments,b.paint,y.transform.zoom)}(m,h))},line:function(m,o,h,g){if(m.renderPass!=="translucent")return;let y=h.paint.get("line-opacity"),b=h.paint.get("line-width");if(y.constantOr(1)===0||b.constantOr(1)===0)return;let S=h.paint.get("line-emissive-strength"),C=h.paint.get("line-occlusion-opacity"),P=m.context,O=P.gl,j=h.layout.get("line-z-offset"),X=!j.isConstant()||!!j.constantOr(0),re=X?new i.ae(m.depthOcclusion?O.GREATER:O.LEQUAL,i.ae.ReadOnly,m.depthRangeFor3D):m.depthModeForSublayer(0,i.ae.ReadOnly),ae=m.colorModeForDrapableLayerRenderPass(S),ue=m.terrain&&m.terrain.renderingToTexture,he=ue?1:i.e.devicePixelRatio,fe=h.paint.get("line-dasharray"),me=fe.constantOr(1),Le=h.layout.get("line-cap"),Oe=fe.constantOr(null),Ne=Le.constantOr(null),Je=h.paint.get("line-pattern"),Ke=Je.constantOr(1),Pe=Je.constantOr(null),Be=h.paint.get("line-opacity").constantOr(1),je=!Ke&&Be!==1||m.depthOcclusion&&C>0&&C<1,at=h.paint.get("line-gradient"),yt=Ke?"linePattern":"line",qe=i.bT(h),bt;if(ue&&m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(je=!1),C!==0&&m.depthOcclusion){let Ht=h.paint._values["line-opacity"];Ht&&Ht.value&&Ht.value.kind==="constant"?bt=Ht.value:i.w(`Occlusion opacity for layer ${h.id} is supported only when line-opacity isn't data-driven.`)}if(X&&(m.forceTerrainMode=!0),!X&&C!==0&&m.terrain&&!ue)return void i.w(`Occlusion opacity for layer ${h.id} is supported on terrain only if the layer has non-zero line-z-offset.`);let Ct=je&&X?m.stencilModeFor3D():i.ag.disabled;for(let Ht of g){let qt=o.getTile(Ht);if(Ke&&!qt.patternsLoaded())continue;let Ut=qt.getBucket(h);if(!Ut)continue;m.prepareDrawTile();let ft=Ut.programConfigurations.get(h.id),kt=m.isTileAffectedByFog(Ht),jt=m.getOrCreateProgram(yt,{config:ft,defines:X?[...qe,"ELEVATED"]:qe,overrideFog:kt});if(Pe&&qt.imageAtlas){let Nt=qt.imageAtlas.patternPositions[Pe.toString()];Nt&&ft.setConstantPatternPositions(Nt)}if(!Ke&&Oe&&Ne&&qt.lineAtlas){let Nt=qt.lineAtlas.getDash(Oe,Ne);Nt&&ft.setConstantPatternPositions(Nt)}let[di,pi]=h.paint.get("line-trim-offset");(Ne==="round"||Ne==="square")&&di!==pi&&(di===0&&(di-=1),pi===1&&(pi+=1));let Ai=ue?Ht.projMatrix:null,mi=Ke?i.bU(m,qt,h,Ai,he,[di,pi]):i.bV(m,qt,h,Ai,Ut.lineClipsArray.length,he,[di,pi]);if(at){let Nt=Ut.gradients[h.id],Li=Nt.texture;if(h.gradientVersion!==Nt.version){let pr=256;if(h.stepInterpolant){let nr=o.getSource().maxzoom,Ir=Ht.canonical.z===nr?Math.ceil(1<<m.transform.maxZoom-Ht.canonical.z):1;pr=i.at(i.bW(Ut.maxLineLength/i.a3*1024*Ir),256,P.maxTextureSize)}Nt.gradient=i.bX({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:pr,image:Nt.gradient||void 0,clips:Ut.lineClipsArray}),Nt.texture?Nt.texture.update(Nt.gradient):Nt.texture=new i.T(P,Nt.gradient,O.RGBA),Nt.version=h.gradientVersion,Li=Nt.texture}P.activeTexture.set(O.TEXTURE1),Li.bind(h.stepInterpolant?O.NEAREST:O.LINEAR,O.CLAMP_TO_EDGE)}me&&(P.activeTexture.set(O.TEXTURE0),qt.lineAtlasTexture&&qt.lineAtlasTexture.bind(O.LINEAR,O.REPEAT),ft.updatePaintBuffers()),Ke&&(P.activeTexture.set(O.TEXTURE0),qt.imageAtlasTexture&&qt.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),ft.updatePaintBuffers()),X&&m.terrain.setupElevationDraw(qt,jt),m.uploadCommonUniforms(P,jt,Ht.toUnwrapped());let Yt=Nt=>{bt!=null&&(bt.value=Be*C),jt.draw(m,O.TRIANGLES,re,Nt,ae,i.af.disabled,mi,h.id,Ut.layoutVertexBuffer,Ut.indexBuffer,Ut.segments,h.paint,m.transform.zoom,ft,[Ut.layoutVertexBuffer2,Ut.patternVertexBuffer,Ut.zOffsetVertexBuffer]),bt!=null&&(bt.value=Be)};if(je&&!X){let Nt=m.stencilModeForClipping(Ht).ref;Nt===0&&ue&&P.clear({stencil:0});let Li={func:O.EQUAL,mask:255};mi.u_alpha_discard_threshold=.8,Yt(new i.ag(Li,Nt,255,O.KEEP,O.KEEP,O.INVERT)),mi.u_alpha_discard_threshold=0,Yt(new i.ag(Li,Nt,255,O.KEEP,O.KEEP,O.KEEP))}else je&&X&&(mi.u_alpha_discard_threshold=.001),Yt(X?Ct:m.stencilModeForClipping(Ht))}je&&(m.resetStencilClippingMasks(),ue&&P.clear({stencil:0})),C===0||m.depthOcclusion||ue||m.layersWithOcclusionOpacity.push(m.currentLayer),X&&(m.forceTerrainMode=!1)},fill:function(m,o,h,g){let y=h.paint.get("fill-color"),b=h.paint.get("fill-opacity");if(b.constantOr(1)===0)return;let S=h.paint.get("fill-emissive-strength"),C=m.colorModeForDrapableLayerRenderPass(S),P=h.paint.get("fill-pattern"),O=m.opaquePassEnabledForLayer()&&!P.constantOr(1)&&y.constantOr(i.C.transparent).a===1&&b.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===O){let j=m.depthModeForSublayer(1,m.renderPass==="opaque"?i.ae.ReadWrite:i.ae.ReadOnly);Ha(m,o,h,g,j,C,!1)}if(m.renderPass==="translucent"&&h.paint.get("fill-antialias")){let j=m.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,i.ae.ReadOnly);Ha(m,o,h,g,j,C,!0)}},"fill-extrusion":function(m,o,h,g){let y=h.paint.get("fill-extrusion-opacity"),b=m.context,S=b.gl,C=m.terrain,P=C&&C.renderingToTexture;if(y===0)return;let O=m.conflationActive&&m.style.isLayerClipped(h,o.getSource()),j=m.style.order.indexOf(h.fqid);if(O&&function(X,re,ae,ue,he){for(let fe of ue){let me=re.getTile(fe).getBucket(ae);me&&(me.updateReplacement(fe,X.replacementSource,he),me.uploadCentroid(X.context))}}(m,o,h,g,j),C||O)for(let X of g){let re=o.getTile(X).getBucket(h);re&&xc(m.context,o,X,re,h,C,O)}if(m.renderPass==="shadow"&&m.shadowRenderer){let X=m.shadowRenderer;if(C&&y<.65&&h._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.Z)return;let re=X.getShadowPassDepthMode(),ae=X.getShadowPassColorMode();hs(m,o,h,g,re,i.ag.disabled,ae,O)}else if(m.renderPass==="translucent"){let X=!h.paint.get("fill-extrusion-pattern").constantOr(1),re=h.paint.get("fill-extrusion-color").constantOr(i.C.white);if(!P&&re.a!==0){let ae=new i.ae(m.context.gl.LEQUAL,i.ae.ReadWrite,m.depthRangeFor3D);y===1&&X?hs(m,o,h,g,ae,i.ag.disabled,i.a.unblended,O):(hs(m,o,h,g,ae,i.ag.disabled,i.a.disabled,O),hs(m,o,h,g,ae,m.stencilModeFor3D(),m.colorModeForRenderPass(),O),m.resetStencilClippingMasks())}if(m.style.enable3dLights()&&X&&(!C&&m.transform.projection.name!=="globe"||P)){let ae=h.paint.get("fill-extrusion-opacity"),ue=h.paint.get("fill-extrusion-ambient-occlusion-intensity"),he=h.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),fe=h.paint.get("fill-extrusion-flood-light-intensity"),me=h.paint.get("fill-extrusion-flood-light-color").toRenderColor(h.lut).toArray01().slice(0,3),Le=ue>0&&he>0,Oe=fe>0,Ne=(Ke,Pe,Be)=>(1-Be)*Ke+Be*Pe,Je=Ke=>{let Pe=m.depthModeForSublayer(1,i.ae.ReadOnly,S.LEQUAL,!0),Be=h.paint.get(Ke?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),je=Ne(.1,3,Be),at=m._showOverdrawInspector;if(!at){let yt=new i.ag({func:S.ALWAYS,mask:255},255,255,S.KEEP,S.KEEP,S.REPLACE),qe=new i.a([S.ONE,S.ONE,S.ONE,S.ONE],i.C.transparent,[!1,!1,!1,!0],S.MIN);Na(m,o,h,g,Pe,yt,qe,i.af.disabled,Ke,"sdf",ae,ue,he,fe,me,je,O,!1)}{let yt=at?i.ag.disabled:new i.ag({func:S.EQUAL,mask:255},255,255,S.KEEP,S.DECR,S.DECR),qe=at?m.colorModeForRenderPass():new i.a([S.ONE_MINUS_DST_ALPHA,S.DST_ALPHA,S.ONE,S.ONE],i.C.transparent,[!0,!0,!0,!0]);Na(m,o,h,g,Pe,yt,qe,i.af.disabled,Ke,"color",ae,ue,he,fe,me,je,O,!1)}};if(P){let Ke=(Pe,Be,je)=>{let at=m.depthModeForSublayer(1,i.ae.ReadOnly,S.LEQUAL,!1),yt=h.paint.get(Pe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),qe=Ne(.1,3,yt);{let bt=new i.a([S.ONE,S.ONE,S.ONE,S.ONE],i.C.transparent,[!1,!1,!1,!0]);Na(m,o,h,g,at,i.ag.disabled,bt,i.af.disabled,Pe,"clear",ae,ue,he,fe,me,qe,O,Be)}{let bt=new i.ag({func:S.ALWAYS,mask:255},255,255,S.KEEP,S.KEEP,S.REPLACE),Ct=new i.a([S.ONE,S.ONE,S.ONE,S.ONE],i.C.transparent,[!1,!1,!1,!0],S.MIN);Na(m,o,h,g,at,bt,Ct,i.af.disabled,Pe,"sdf",ae,ue,he,fe,me,qe,O,Be)}{let bt=Pe?S.ZERO:S.ONE_MINUS_DST_ALPHA,Ct=new i.ag({func:S.EQUAL,mask:255},255,255,S.KEEP,S.DECR,S.DECR),Ht=new i.a([bt,S.DST_ALPHA,S.ONE_MINUS_DST_ALPHA,S.ZERO],i.C.transparent,[!0,!0,!0,!0]);Na(m,o,h,g,at,Ct,Ht,i.af.disabled,Pe,"color",ae,ue,he,fe,me,qe,O,Be)}{let bt=new i.a([S.ONE,S.ONE,S.ONE,Pe?S.ZERO:S.ONE],i.C.transparent,[!1,!1,!1,!0],Pe?S.FUNC_ADD:S.MAX);Na(m,o,h,g,at,i.ag.disabled,bt,i.af.disabled,Pe,"clear",ae,ue,he,fe,me,qe,O,Be,je)}};if(Le||Oe){let Pe;if(m.prepareDrawTile(),C){let Be=C.drapeBufferSize[0],je=C.drapeBufferSize[1];Pe=C.framebufferCopyTexture,Pe&&(!Pe||Pe.size[0]===Be&&Pe.size[1]===je)||(Pe&&Pe.destroy(),Pe=C.framebufferCopyTexture=new i.T(b,new i.i({width:Be,height:je}),S.RGBA)),Pe.bind(S.LINEAR,S.CLAMP_TO_EDGE),S.copyTexImage2D(S.TEXTURE_2D,0,S.RGBA,0,0,Be,je,0)}Le&&Ke(!0,!1,Pe),Oe&&Ke(!1,!0,Pe)}}else Le&&Je(!0),Oe&&Je(!1)}}},hillshade:function(m,o,h,g){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent"||m.style.disableElevatedTerrain)return;let y=m.context,b=m.terrain&&m.terrain.renderingToTexture,[S,C]=m.renderPass!=="translucent"||b?[{},g]:m.stencilConfigForOverlap(g);for(let P of C){let O=o.getTile(P);if(O.needsHillshadePrepare&&m.renderPass==="offscreen")co(m,O,h);else if(m.renderPass==="translucent"){let j=m.depthModeForSublayer(0,i.ae.ReadOnly),X=h.paint.get("hillshade-emissive-strength"),re=m.colorModeForDrapableLayerRenderPass(X),ae=b&&m.terrain?m.terrain.stencilModeForRTTOverlap(P):S[P.overscaledZ];Qf(m,P,O,h,j,ae,re)}}y.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,o,h,g,y,b){if(m.renderPass!=="translucent"||h.paint.get("raster-opacity")===0)return;let S=m.transform.projection.name==="globe",C=h.paint.get("raster-elevation")!==0,P=C&&S;if(m.renderElevatedRasterBackface&&!P)return;let O=m.context,j=O.gl,X=o.getSource(),re=function(Ke,Pe,Be,je){let at=Pe.paint.get("raster-color"),yt=Ke.type==="raster-array",qe=[],bt=Pe.paint.get("raster-resampling"),Ct=Pe.paint.get("raster-color-mix"),Ht=Pe.paint.get("raster-color-range"),qt=[Ct[0],Ct[1],Ct[2],0],Ut=Ct[3],ft=bt==="nearest"?je.NEAREST:je.LINEAR;if(yt&&(qe.push("RASTER_ARRAY"),at||qe.push("RASTER_COLOR"),bt==="linear"&&qe.push("RASTER_ARRAY_LINEAR"),ft=je.NEAREST,!Ht&&Ke.rasterLayers)){let kt=Ke.rasterLayers.find(({id:jt})=>jt===Pe.sourceLayer);kt&&kt.fields&&kt.fields.range&&(Ht=kt.fields.range)}if(Ht=Ht||[0,1],at){qe.push("RASTER_COLOR"),Be.activeTexture.set(je.TEXTURE2),Pe.updateColorRamp(Ht);let kt=Pe.colorRampTexture;kt||(kt=Pe.colorRampTexture=new i.T(Be,Pe.colorRamp,je.RGBA)),kt.bind(je.LINEAR,je.CLAMP_TO_EDGE)}return{mix:qt,range:Ht,offset:Ut,defines:qe,resampling:ft}}(X,h,O,j);if(X instanceof i.bm&&!g.length&&!S)return;let ae=h.paint.get("raster-emissive-strength"),ue=m.colorModeForDrapableLayerRenderPass(ae),he=m.terrain&&m.terrain.renderingToTexture,fe=!m.options.moving,me=h.paint.get("raster-resampling")==="nearest"?j.NEAREST:j.LINEAR;if(X instanceof i.bm&&!g.length&&(X.onNorthPole||X.onSouthPole)){let Ke=C?m.stencilModeFor3D():i.ag.disabled;return void gh(!!X.onNorthPole,null,m,o,h,ae,re,i.af.disabled,Ke)}if(!g.length)return;let[Le,Oe]=X instanceof i.bm||he?[{},g]:m.stencilConfigForOverlap(g),Ne=Oe[Oe.length-1].overscaledZ;P&&re.defines.push("PROJECTION_GLOBE_VIEW"),C&&re.defines.push("RENDER_CUTOFF");let Je=(Ke,Pe,Be)=>{for(let je of Ke){let at=je.toUnwrapped(),yt=o.getTile(je);if(he&&(!yt||!yt.hasData()))continue;O.activeTexture.set(j.TEXTURE0);let qe=ip(yt,X,h,re);if(!qe||!qe.texture)continue;let{texture:bt,mix:Ct,offset:Ht,tileSize:qt,buffer:Ut}=qe,ft,kt;he?(ft=i.ae.disabled,kt=je.projMatrix):C?(ft=new i.ae(j.LEQUAL,i.ae.ReadWrite,m.depthRangeFor3D),kt=S?Float32Array.from(m.transform.expandedFarZProjMatrix):m.transform.calculateProjMatrix(at,fe)):(ft=m.depthModeForSublayer(je.overscaledZ-Ne,h.paint.get("raster-opacity")===1?i.ae.ReadWrite:i.ae.ReadOnly,j.LESS),kt=m.transform.calculateProjMatrix(at,fe));let jt=m.terrain&&he?m.terrain.stencilModeForRTTOverlap(je):Le[je.overscaledZ],di=b?0:h.paint.get("raster-fade-duration");yt.registerFadeDuration(di);let pi=o.findLoadedParent(je,0),Ai=cr(yt,pi,o,m.transform,di),mi,Yt;m.terrain&&m.terrain.prepareDrawTile(),O.activeTexture.set(j.TEXTURE0),bt.bind(me,j.CLAMP_TO_EDGE),O.activeTexture.set(j.TEXTURE1),pi?(pi.texture&&pi.texture.bind(me,j.CLAMP_TO_EDGE),mi=Math.pow(2,pi.tileID.overscaledZ-yt.tileID.overscaledZ),Yt=[yt.tileID.canonical.x*mi%1,yt.tileID.canonical.y*mi%1]):bt.bind(me,j.CLAMP_TO_EDGE),bt.useMipmap&&O.extTextureFilterAnisotropic&&m.transform.pitch>20&&j.texParameterf(j.TEXTURE_2D,O.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,O.extTextureFilterAnisotropicMax);let Nt=m.transform,Li,pr=C?jr(Nt):[0,0,0,0],nr,Ir,Ur,un,ir,tn=0;if(P&&X instanceof i.bm&&X.coordinates.length>3)nr=Float32Array.from(i.bf(i.bg(new i.aO(0,0,0)))),Ir=Float32Array.from(Nt.globeMatrix),Ur=Float32Array.from(i.bb(Nt)),un=[i.aj(Nt.center.lng),i.ak(Nt.center.lat)],Li=X.elevatedGlobePerspectiveTransform,ir=X.elevatedGlobeGridMatrix||new Float32Array(9);else if(P){let or=i.bc(je.canonical);tn=i.bd(or.getCenter().lat),nr=Float32Array.from(i.bf(i.bg(je.canonical))),Ir=Float32Array.from(Nt.globeMatrix),Ur=Float32Array.from(i.bb(Nt)),un=[i.aj(Nt.center.lng),i.ak(Nt.center.lat)],Li=[0,0],ir=Float32Array.from(i.be(je.canonical,or,tn,Nt.worldSize/Nt._pixelsPerMercatorPixel))}else Li=X instanceof i.bm?X.perspectiveTransform:[0,0],nr=new Float32Array(16),Ir=new Float32Array(9),Ur=new Float32Array(16),un=[0,0],ir=new Float32Array(9);let bn=Wc(kt,nr,Ir,Ur,ir,Yt||[0,0],i.a1(m.transform.zoom),un,pr,mi||1,Ai,h,Li,C?h.paint.get("raster-elevation"):0,2,Ct,Ht,re.range,qt,Ut,ae),cn=m.isTileAffectedByFog(je),Pr=m.getOrCreateProgram("raster",{defines:re.defines,overrideFog:cn});if(m.uploadCommonUniforms(O,Pr,at),X instanceof i.bm){let or=X.elevatedGlobeVertexBuffer,Fn=X.elevatedGlobeIndexBuffer;if(he||!S)X.boundsBuffer&&X.boundsSegments&&Pr.draw(m,j.TRIANGLES,ft,i.ag.disabled,ue,i.af.disabled,bn,h.id,X.boundsBuffer,m.quadTriangleIndexBuffer,X.boundsSegments);else if(or&&Fn){let zn=Nt.zoom<=i.b1?X.elevatedGlobeSegments:X.getSegmentsForLongitude(Nt.center.lng);zn&&Pr.draw(m,j.TRIANGLES,ft,i.ag.disabled,ue,Pe,bn,h.id,or,Fn,zn)}}else if(P){ft=new i.ae(j.LEQUAL,i.ae.ReadOnly,m.depthRangeFor3D);let or=m.globeSharedBuffers;if(or){let[Fn,zn,pn]=or.getGridBuffers(tn,!1);Pr.draw(m,j.TRIANGLES,ft,Be||jt,m.colorModeForRenderPass(),Pe,bn,h.id,Fn,zn,pn)}}else{let{tileBoundsBuffer:or,tileBoundsIndexBuffer:Fn,tileBoundsSegments:zn}=m.getTileBoundsBuffers(yt);Pr.draw(m,j.TRIANGLES,ft,jt,ue,i.af.disabled,bn,h.id,or,Fn,zn)}}if(!(X instanceof i.bm)&&P)for(let je of Ke){let at=je.canonical.y===(1<<je.canonical.z)-1;je.canonical.y===0&&gh(!0,je,m,o,h,ae,re,Pe,Be||i.ag.disabled),at&&gh(!1,je,m,o,h,ae,re,Pe===i.af.frontCW?i.af.backCW:i.af.frontCW,Be||i.ag.disabled)}};P?Je(Oe,m.renderElevatedRasterBackface?i.af.backCW:i.af.frontCW,m.stencilModeFor3D()):Je(Oe,i.af.disabled,void 0),m.resetStencilClippingMasks()},"raster-particle":function(m,o,h,g,y,b){m.renderPass==="offscreen"&&function(S,C,P,O){if(!O.length)return;let j=S.context,X=j.gl,re=C.getSource();if(!(re instanceof Mr))return;let ae=Math.ceil(Math.sqrt(P.paint.get("raster-particle-count"))),ue=P.particlePositionRGBAImage;if(!ue||ue.width!==ae){let Oe=function(Ne){let Je=Ne*Ne,Ke=new Uint8Array(4*Je),Pe=function(je){return je|=0,je=Math.imul(2747636419^je,2654435769),je=Math.imul(je^je>>>16,2654435769),((je=Math.imul(je^je>>>16,2654435769))>>>0)/4294967296},Be=1/1.3;for(let je=0;je<Je;je++){let at=Be*(Pe(2*je+0)+Xs),yt=Be*(Pe(2*je+1)+Xs),qe=255*at%1,bt=255*yt%1,Ct=qe,Ht=yt-bt/255,qt=bt;Ke[4*je+0]=255*(at-qe/255),Ke[4*je+1]=255*Ct,Ke[4*je+2]=255*Ht,Ke[4*je+3]=255*qt}return Ke}(ae);ue=P.particlePositionRGBAImage=new i.i({width:ae,height:ae},Oe)}let he=P.particleFramebuffer;he?he.width!==ae&&(he.destroy(),he=P.particleFramebuffer=j.createFramebuffer(ae,ae,!0,null)):he=P.particleFramebuffer=j.createFramebuffer(ae,ae,!0,null);let fe=[];for(let Oe of O){let Ne=C.getTile(Oe);if(!(Ne instanceof i.c3))continue;let Je=$i(Ne,re,P);if(!Je)continue;let Ke=[Ne.tileSize,Ne.tileSize],Pe=P.tileFramebuffer;Pe||(Pe=P.tileFramebuffer=j.createFramebuffer(Ke[0],Ke[1],!0,null));let Be=Ne.rasterParticleState;Be||(Be=Ne.rasterParticleState=new Ri(j,Oe,Ke,ue));let je=Be.update(P.lastInvalidatedAt);Be.particleTextureDimension!==ae&&Be.updateParticleTexture(Oe,ue);let at=Be.targetColorTexture;Be.targetColorTexture=Be.backgroundColorTexture,Be.backgroundColorTexture=at;let yt=Be.particleTexture0;Be.particleTexture0=Be.particleTexture1,Be.particleTexture1=yt,fe.push([Oe,Je,Be,je])}if(fe.length===0)return;let me=i.e.now(),Le=P.previousDrawTimestamp?.001*(me-P.previousDrawTimestamp):.0167;if(P.previousDrawTimestamp=me,P.hasColorMap()){j.activeTexture.set(X.TEXTURE0+2);let Oe=P.colorRampTexture;Oe||(Oe=P.colorRampTexture=new i.T(j,P.colorRamp,X.RGBA)),Oe.bind(X.LINEAR,X.CLAMP_TO_EDGE)}j.bindFramebuffer.set(P.tileFramebuffer.framebuffer),function(Oe,Ne,Je){let Ke=Oe.context,Pe=Ke.gl,Be=Ne.tileFramebuffer;Ke.activeTexture.set(Pe.TEXTURE0);let je={u_texture:0,u_opacity:1.05*(yt=Ne.paint.get("raster-particle-fade-opacity-factor"))/(yt+.05)},at=Oe.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var yt;for(let qe of Je){let[,,bt,Ct]=qe;Be.colorAttachment.set(bt.targetColorTexture.texture),Ke.viewport.set([0,0,Be.width,Be.height]),Ke.clear({color:i.C.transparent}),Ct&&(bt.backgroundColorTexture.bind(Pe.NEAREST,Pe.CLAMP_TO_EDGE),at.draw(Oe,Pe.TRIANGLES,i.ae.disabled,i.ag.disabled,i.a.alphaBlended,i.af.disabled,je,Ne.id,Oe.viewportBuffer,Oe.quadTriangleIndexBuffer,Oe.viewportSegments))}}(S,P,fe),function(Oe,Ne,Je,Ke){let Pe=Oe.context,Be=Pe.gl,je=Je.tileFramebuffer,at=Oe.transform.projection.name==="globe",yt=Je.paint.get("raster-particle-max-speed");for(let qe of Ke){let[bt,Ct,Ht]=qe;Pe.activeTexture.set(Be.TEXTURE0+0),Ct.texture.bind(Be.LINEAR,Be.CLAMP_TO_EDGE),je.colorAttachment.set(Ht.targetColorTexture.texture);let qt=Oe.getOrCreateProgram("rasterParticleDraw",{defines:Ct.defines,overrideFog:!1});Pe.activeTexture.set(Be.TEXTURE0+1);let Ut=Ct.scalarData?[]:[0,1,2,3].map(jt=>i.bZ[jt](bt));Ut.push(bt);let ft=bt.canonical.x,kt=bt.canonical.y;for(let jt of Ut){let di=Ne.getTile(at?jt.wrapped():jt);if(!di)continue;let pi=di.rasterParticleState;if(!pi)continue;let Ai=jt.canonical.x+(1<<jt.canonical.z)*(jt.wrap-bt.wrap),mi=jt.canonical.y;pi.particleTexture0.bind(Be.NEAREST,Be.CLAMP_TO_EDGE);let Yt=id(1,pi.particleTexture0.size[0],[Ai-ft,mi-kt],0,Ct.texture.size,2,yt,Ct.textureOffset,Ct.scale,Ct.offset);qt.draw(Oe,Be.POINTS,i.ae.disabled,i.ag.disabled,i.a.alphaBlended,i.af.disabled,Yt,Je.id,pi.particleIndexBuffer,void 0,pi.particleSegment)}}}(S,C,P,fe),j.bindFramebuffer.set(P.particleFramebuffer.framebuffer),function(Oe,Ne,Je,Ke){let Pe=Oe.context,Be=Pe.gl,je=Ne.paint.get("raster-particle-max-speed"),at=Ke*Ne.paint.get("raster-particle-speed-factor")*.15,yt=function(bt){return Math.pow(bt,6)}(.01+1*Ne.paint.get("raster-particle-reset-rate-factor")),qe=Ne.particleFramebuffer;Pe.viewport.set([0,0,qe.width,qe.height]);for(let bt of Je){let[,Ct,Ht]=bt;Pe.activeTexture.set(Be.TEXTURE0+0),Ct.texture.bind(Be.LINEAR,Be.CLAMP_TO_EDGE),Pe.activeTexture.set(Be.TEXTURE0+1);let qt=Ht.particleTexture0;qt.bind(Be.NEAREST,Be.CLAMP_TO_EDGE);let Ut=qc(1,qt.size[0],0,Ct.texture.size,je,at,yt,Ct.textureOffset,Ct.scale,Ct.offset);qe.colorAttachment.set(Ht.particleTexture1.texture),Pe.clear({color:i.C.transparent}),Oe.getOrCreateProgram("rasterParticleUpdate",{defines:Ct.defines}).draw(Oe,Be.TRIANGLES,i.ae.disabled,i.ag.disabled,i.a.unblended,i.af.disabled,Ut,Ne.id,Oe.viewportBuffer,Oe.quadTriangleIndexBuffer,Oe.viewportSegments)}}(S,P,fe,Le)}(m,o,h,g),m.renderPass==="translucent"&&(function(S,C,P,O,j){let X=S.context,re=X.gl,ae=!S.options.moving,ue=S.transform.projection.name==="globe";if(!O.length)return;let[he,fe]=S.stencilConfigForOverlap(O),me=[];ue&&me.push("PROJECTION_GLOBE_VIEW");let Le=S.stencilModeFor3D();for(let Oe of fe){let Ne=Oe.toUnwrapped(),Je=C.getTile(Oe);if(!Je.rasterParticleState)continue;let Ke=Je.rasterParticleState,Pe=100;Je.registerFadeDuration(Pe);let Be=C.findLoadedParent(Oe,0),je=cr(Je,Be,C,S.transform,Pe),at,yt;S.terrain&&S.terrain.prepareDrawTile(),X.activeTexture.set(re.TEXTURE0),Ke.targetColorTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE),X.activeTexture.set(re.TEXTURE1),Be&&Be.rasterParticleState?(Be.rasterParticleState.targetColorTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE),at=Math.pow(2,Be.tileID.overscaledZ-Je.tileID.overscaledZ),yt=[Je.tileID.canonical.x*at%1,Je.tileID.canonical.y*at%1]):Ke.targetColorTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE);let qe=ue?Float32Array.from(S.transform.expandedFarZProjMatrix):S.transform.calculateProjMatrix(Ne,ae),bt=S.transform,Ct=ds(bt),Ht=i.bc(Oe.canonical),qt=i.bd(Ht.getCenter().lat),Ut,ft,kt,jt,di;ue?(Ut=Float32Array.from(i.bf(i.bg(Oe.canonical))),ft=Float32Array.from(bt.globeMatrix),kt=Float32Array.from(i.bb(bt)),jt=[i.aj(bt.center.lng),i.ak(bt.center.lat)],di=Float32Array.from(i.be(Oe.canonical,Ht,qt,bt.worldSize/bt._pixelsPerMercatorPixel))):(Ut=new Float32Array(16),ft=new Float32Array(9),kt=new Float32Array(16),jt=[0,0],di=new Float32Array(9));let pi=td(qe,Ut,ft,kt,di,yt||[0,0],i.a1(S.transform.zoom),jt,Ct,at||1,je,250),Ai=S.isTileAffectedByFog(Oe),mi=S.getOrCreateProgram("rasterParticle",{defines:me,overrideFog:Ai});if(S.uploadCommonUniforms(X,mi,Ne),ue){let Yt=new i.ae(re.LEQUAL,i.ae.ReadWrite,S.depthRangeFor3D),Nt=0,Li=S.globeSharedBuffers;if(Li){let[pr,nr,Ir]=Li.getGridBuffers(qt,Nt!==0);mi.draw(S,re.TRIANGLES,Yt,Le,i.a.alphaBlended,i.af.backCCW,pi,P.id,pr,nr,Ir)}}else{let Yt=S.depthModeForSublayer(0,i.ae.ReadOnly),Nt=he[Oe.overscaledZ],{tileBoundsBuffer:Li,tileBoundsIndexBuffer:pr,tileBoundsSegments:nr}=S.getTileBoundsBuffers(Je);mi.draw(S,re.TRIANGLES,Yt,Nt,i.a.alphaBlended,i.af.disabled,pi,P.id,Li,pr,nr)}}S.resetStencilClippingMasks()}(m,o,h,g),m.style.map.triggerRepaint())},background:function(m,o,h,g){let y=h.paint.get("background-color"),b=h.paint.get("background-opacity"),S=h.paint.get("background-emissive-strength");if(b===0)return;let C=m.context,P=C.gl,O=m.transform,j=O.tileSize,X=h.paint.get("background-pattern"),re;if(X!==void 0&&(X===null||(re=m.imageManager.getPattern(X.toString(),h.scope,m.style.getLut(h.scope)),!re)))return;let ae=!X&&y.a===1&&b===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==ae)return;let ue=i.ag.disabled,he=m.depthModeForSublayer(0,ae==="opaque"?i.ae.ReadWrite:i.ae.ReadOnly),fe=m.colorModeForDrapableLayerRenderPass(S),me=X?"backgroundPattern":"background",Le,Oe=g;Oe||(Le=m.getBackgroundTiles(),Oe=Object.values(Le).map(Ne=>Ne.tileID)),X&&(C.activeTexture.set(P.TEXTURE0),m.imageManager.bind(m.context,h.scope));for(let Ne of Oe){let Je=m.isTileAffectedByFog(Ne),Ke=m.getOrCreateProgram(me,{overrideFog:Je}),Pe=Ne.toUnwrapped(),Be=g?Ne.projMatrix:m.transform.calculateProjMatrix(Pe);m.prepareDrawTile();let je=o?o.getTile(Ne):Le?Le[Ne.key]:new i.by(Ne,j,O.zoom,m),at=X?wu(Be,S,b,m,0,h.scope,re,{tileID:Ne,tileSize:j}):Ds(Be,S,b,y.toRenderColor(h.lut));m.uploadCommonUniforms(C,Ke,Pe);let{tileBoundsBuffer:yt,tileBoundsIndexBuffer:qe,tileBoundsSegments:bt}=m.getTileBoundsBuffers(je);Ke.draw(m,P.TRIANGLES,he,ue,fe,i.af.disabled,at,h.id,yt,qe,bt)}},sky:function(m,o,h){let g=m._atmosphere?i.a1(m.transform.zoom):1,y=h.paint.get("sky-opacity")*g;if(y===0)return;let b=m.context,S=h.paint.get("sky-type"),C=new i.ae(b.gl.LEQUAL,i.ae.ReadOnly,[0,1]),P=m.frameCounter/1e3%1;S==="atmosphere"?m.renderPass==="offscreen"?h.needsSkyboxCapture(m)&&(function(O,j,X,re){let ae=O.context,ue=ae.gl,he=j.skyboxFbo;if(!he){he=j.skyboxFbo=ae.createFramebuffer(32,32,!0,null),j.skyboxGeometry=new xh(ae),j.skyboxTexture=ae.gl.createTexture(),ue.bindTexture(ue.TEXTURE_CUBE_MAP,j.skyboxTexture),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_WRAP_S,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_WRAP_T,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_MIN_FILTER,ue.LINEAR),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_MAG_FILTER,ue.LINEAR);for(let Oe=0;Oe<6;++Oe)ue.texImage2D(ue.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,0,ue.RGBA,32,32,0,ue.RGBA,ue.UNSIGNED_BYTE,null)}ae.bindFramebuffer.set(he.framebuffer),ae.viewport.set([0,0,32,32]);let fe=j.getCenter(O,!0),me=O.getOrCreateProgram("skyboxCapture"),Le=new Float64Array(16);i.ad.identity(Le),i.ad.rotateY(Le,Le,.5*-Math.PI),Vl(O,j,me,Le,fe,0),i.ad.identity(Le),i.ad.rotateY(Le,Le,.5*Math.PI),Vl(O,j,me,Le,fe,1),i.ad.identity(Le),i.ad.rotateX(Le,Le,.5*-Math.PI),Vl(O,j,me,Le,fe,2),i.ad.identity(Le),i.ad.rotateX(Le,Le,.5*Math.PI),Vl(O,j,me,Le,fe,3),i.ad.identity(Le),Vl(O,j,me,Le,fe,4),i.ad.identity(Le),i.ad.rotateY(Le,Le,Math.PI),Vl(O,j,me,Le,fe,5),ae.viewport.set([0,0,O.width,O.height])}(m,h),h.markSkyboxValid(m)):m.renderPass==="sky"&&function(O,j,X,re,ae){let ue=O.context,he=ue.gl,fe=O.transform,me=O.getOrCreateProgram("skybox");ue.activeTexture.set(he.TEXTURE0),he.bindTexture(he.TEXTURE_CUBE_MAP,j.skyboxTexture);let Le=((Oe,Ne,Je,Ke,Pe)=>({u_matrix:Oe,u_sun_direction:Ne,u_cubemap:0,u_opacity:Ke,u_temporal_offset:Pe}))(fe.skyboxMatrix,j.getCenter(O,!1),0,re,ae);O.uploadCommonUniforms(ue,me),me.draw(O,he.TRIANGLES,X,i.ag.disabled,O.colorModeForRenderPass(),i.af.backCW,Le,"skybox",j.skyboxGeometry.vertexBuffer,j.skyboxGeometry.indexBuffer,j.skyboxGeometry.segment)}(m,h,C,y,P):S==="gradient"&&m.renderPass==="sky"&&function(O,j,X,re,ae){let ue=O.context,he=ue.gl,fe=O.transform,me=O.getOrCreateProgram("skyboxGradient");j.skyboxGeometry||(j.skyboxGeometry=new xh(ue)),ue.activeTexture.set(he.TEXTURE0);let Le=j.colorRampTexture;Le||(Le=j.colorRampTexture=new i.T(ue,j.colorRamp,he.RGBA)),Le.bind(he.LINEAR,he.CLAMP_TO_EDGE);let Oe=((Ne,Je,Ke,Pe,Be)=>({u_matrix:Ne,u_color_ramp:0,u_center_direction:Je,u_radius:i.ab(Ke),u_opacity:Pe,u_temporal_offset:Be}))(fe.skyboxMatrix,j.getCenter(O,!1),j.paint.get("sky-gradient-radius"),re,ae);O.uploadCommonUniforms(ue,me),me.draw(O,he.TRIANGLES,X,i.ag.disabled,O.colorModeForRenderPass(),i.af.backCW,Oe,"skyboxGradient",j.skyboxGeometry.vertexBuffer,j.skyboxGeometry.indexBuffer,j.skyboxGeometry.segment)}(m,h,C,y,P)},debug:function(m,o,h,g,y,b){for(let S=0;S<h.length;S++)if(y){let O=new i.C(g.r*.8,g.g*.8,g.b*.8,1);Ti(m,o,h[S],g,-1,-1,b),Ti(m,o,h[S],g,-1,1,b),Ti(m,o,h[S],g,1,1,b),Ti(m,o,h[S],g,1,-1,b),Ti(m,o,h[S],O,0,0,b)}else Ti(m,o,h[S],g,0,0,b)},custom:function(m,o,h,g){let y=m.context,b=h.implementation;if(!m.transform.projection.unsupportedLayers||!m.transform.projection.unsupportedLayers.includes("custom")||m.terrain&&(m.terrain.renderingToTexture||m.renderPass==="offscreen")&&h.isDraped(o)){if(m.renderPass==="offscreen"){let S=b.prerender;if(S){if(m.setCustomLayerDefaults(),y.setColorMode(m.colorModeForRenderPass()),m.transform.projection.name==="globe"){let C=m.transform.pointMerc;S.call(b,y.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),i.a1(m.transform.zoom),[C.x,C.y],m.transform.pixelsPerMeterRatio)}else S.call(b,y.gl,m.transform.customLayerMatrix());y.setDirty(),m.setBaseState()}}else if(m.renderPass==="translucent"){if(m.terrain&&m.terrain.renderingToTexture){let C=b.renderToTile;if(C){let P=g[0].canonical,O=new i.Y(P.x+g[0].wrap*(1<<P.z),P.y,P.z);y.setDepthMode(i.ae.disabled),y.setStencilMode(i.ag.disabled),y.setColorMode(m.colorModeForRenderPass()),m.setCustomLayerDefaults(),C.call(b,y.gl,O),y.setDirty(),m.setBaseState()}return}m.setCustomLayerDefaults(),y.setColorMode(m.colorModeForRenderPass()),y.setStencilMode(i.ag.disabled);let S=b.renderingMode==="3d"?new i.ae(m.context.gl.LEQUAL,i.ae.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,i.ae.ReadOnly);if(y.setDepthMode(S),m.transform.projection.name==="globe"){let C=m.transform.pointMerc;b.render(y.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),i.a1(m.transform.zoom),[C.x,C.y],m.transform.pixelsPerMeterRatio)}else b.render(y.gl,m.transform.customLayerMatrix());y.setDirty(),m.setBaseState(),y.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(m,o,h,g){if(m.renderPass==="opaque")return;let y=h.paint.get("model-opacity");if(y===0)return;let b=h.paint.get("model-cast-shadows");if(m.renderPass==="shadow"&&(!b||m.terrain&&y<.65&&h._transitionablePaint._values["model-opacity"].value.expression instanceof i.Z))return;let S=m.shadowRenderer,C=h.paint.get("model-receive-shadows");S&&(S.useNormalOffset=!0,C||(S.enabled=!1));let P=()=>{S&&(S.useNormalOffset=!0,C||(S.enabled=!0))},O=o.getSource();if(m.renderPass==="light-beam"&&O.type!=="batched-model")return;if(O.type==="vector"||O.type==="geojson")return function(me,Le,Oe,Ne,Je){let Ke=me.transform;if(Ke.projection.name!=="mercator")return void i.w(`Drawing 3D models for ${Ke.projection.name} projection is not yet implemented`);let Pe=Ke.getFreeCameraOptions().position;if(!me.modelManager)return;let Be=me.modelManager;Oe.modelManager=Be;let je=me.shadowRenderer;if(!Oe._unevaluatedLayout._values.hasOwnProperty("model-id"))return;let at=Oe._unevaluatedLayout._values["model-id"],yt=In({},Oe.layout.get("model-id").parameters),qe=me.style.order.indexOf(Oe.fqid);for(let bt of Ne){let Ct=Le.getTile(bt).getBucket(Oe);if(!Ct||Ct.projection.name!==Ke.projection.name)continue;let Ht=Ct.getModelUris();Ht&&!Ct.modelsRequested&&(Be.addModelsFromBucket(Ht,Je),Ct.modelsRequested=!0);let qt=Ba(bt,Ke);yt.zoom=qt;let Ut=at.possiblyEvaluate(yt);if(sm(me,Ct,bt),Bo.shadowUniformsInitialized=!1,Bo.useSingleShadowCascade=!!je&&je.getMaxCascadeForTile(bt.toUnwrapped())===0,me.renderPass==="shadow"&&je){if(me.currentShadowCascade===1&&Ct.isInsideFirstShadowMapFrustum)continue;let jt=Ke.calculatePosMatrix(bt.toUnwrapped(),Ke.worldSize);if(Bo.tileMatrix.set(jt),Bo.shadowTileMatrix=Float32Array.from(je.calculateShadowPassMatrixFromMatrix(jt)),Bo.aabb.min.fill(0),Bo.aabb.max[0]=Bo.aabb.max[1]=i.a3,Bo.aabb.max[2]=0,no(Ct,Bo,me,Oe.scope))continue}let ft=1<<bt.canonical.z,kt=[((Pe.x-bt.wrap)*ft-bt.canonical.x)*i.a3,(Pe.y*ft-bt.canonical.y)*i.a3,Pe.z*ft*i.a3];me.conflationActive&&Object.keys(Ct.instancesPerModel).length>0&&me.style.isLayerClipped(Oe,Le.getSource())&&Ct.updateReplacement(bt,me.replacementSource,qe)&&(Ct.uploaded=!1,Ct.upload(me.context));for(let jt in Ct.instancesPerModel){let di=Ct.instancesPerModel[jt];di.features.length>0&&(jt=Ut.evaluate(di.features[0].feature,{}));let pi=Be.getModel(jt,Je);if(pi&&pi.uploaded)for(let Ai of pi.nodes)Ks(me,Oe,Ai,di,kt,bt,Bo)}}}(m,o,h,g,O.type==="vector"?h.scope:""),void P();if(!O.loaded())return;if(O.type==="batched-model")return function(me,Le,Oe,Ne){Oe.resetLayerRenderingStats(me);let Je=me.context,Ke=me.transform,Pe=me.style.fog,Be=me.shadowRenderer;if(Ke.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${Ke.projection.name} projection is not yet implemented`);let je=me.transform.getFreeCameraOptions().position,at=i._.scale([],[je.x,je.y,je.z],me.transform.worldSize);i._.negate(at,at);let yt=i.ad.identity([]),qe=i.cg(Ke.center.lat,Ke.zoom),bt=i.ad.fromScaling([],[1,1,1/qe]);i.ad.translate(yt,yt,at);let Ct=Oe.paint.get("model-opacity"),Ht=new i.ae(Je.gl.LEQUAL,i.ae.ReadWrite,me.depthRangeFor3D),qt=new i.ae(Je.gl.LEQUAL,i.ae.ReadOnly,me.depthRangeFor3D),Ut=new i.b6([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),ft=me.renderPass==="shadow",kt=ft&&Be?Be.getCurrentCascadeFrustum():Ke.getFrustum(Ke.scaleZoom(Ke.worldSize)),jt=Oe.paint.get("model-front-cutoff"),di=jt[2]<1,pi=$s(me,Oe.paint.get("model-cutoff-fade-range")),Ai=Oe.getLayerRenderingStats();(function(mi,Yt,Nt,Li){let pr=mi.terrain?mi.terrain.exaggeration():0,nr=mi.transform.zoom;for(let Ir of Li){let Ur=Yt.getTile(Ir).getBucket(Nt);Ur&&(mi.conflationActive&&Ur.updateReplacement(Ir,mi.replacementSource),Ur.evaluateScale(mi,Nt),mi.terrain&&pr>0&&Ur.elevationUpdate(mi.terrain,pr,Ir,Nt.source),Ur.needsReEvaluation(mi,nr,Nt)&&Ur.evaluate(Nt))}})(me,Le,Oe,Ne),function(){let mi,Yt,Nt;di?(mi=Ne.length-1,Yt=-1,Nt=-1):(mi=0,Yt=Ne.length,Nt=1);for(let Li=mi;Li!==Yt;Li+=Nt){let pr=Ne[Li],nr=Le.getTile(pr).getBucket(Oe);if(!nr||!nr.uploaded)continue;let Ir=!1;Be&&(Ir=Be.getMaxCascadeForTile(pr.toUnwrapped())===0);let Ur=Ke.calculatePosMatrix(pr.toUnwrapped(),Ke.worldSize),un=nr.modelTraits,ir=[];for(let tn of nr.getNodesInfo()){if(tn.hiddenByReplacement||!tn.node.meshes)continue;let bn=tn.node,cn=0;me.terrain&&bn.elevation&&(cn=bn.elevation*me.terrain.exaggeration());let Pr=tn.evaluatedScale;if(Pr[0]<=1&&Pr[1]<=1&&Pr[2]<=1&&(()=>{let xt=tn.aabb;return Ut.min=[...xt.min],Ut.max=[...xt.max],Ut.min[2]+=cn,Ut.max[2]+=cn,i._.transformMat4(Ut.min,Ut.min,Ur),i._.transformMat4(Ut.max,Ut.max,Ur),Ut})().intersects(kt)===0)continue;let or=[...Ur],Fn=bn.anchor?bn.anchor[0]:0,zn=bn.anchor?bn.anchor[1]:0;i.ad.translate(or,or,[Fn*(Pr[0]-1),zn*(Pr[1]-1),cn]),i._.exactEquals(Pr,i.cj)||i.ad.scale(or,or,Pr);let pn=i.ad.multiply([],or,bn.matrix),Gt=i.ad.multiply([],Ke.expandedFarZProjMatrix,pn),_i=i.ad.multiply([],Ke.expandedFarZProjMatrix,or),aa=i.aA.transformMat4([],[Fn,zn,cn,1],Gt)[2];bn.hidden=!1;let rn=Ct;ft||(di&&(rn*=Wa(or,Ke,tn.aabb,jt)),rn*=Ul(pi,aa)),rn!==0?ir.push({nodeInfo:tn,depth:aa,opacity:rn,wvpForNode:Gt,wvpForTile:_i,nodeModelMatrix:pn,tileModelMatrix:or}):bn.hidden=!0}ft||ir.sort((tn,bn)=>!di||tn.opacity===1&&bn.opacity===1?tn.depth<bn.depth?-1:1:tn.opacity===1?-1:bn.opacity===1?1:tn.depth>bn.depth?-1:1);for(let tn of ir){let bn=tn.nodeInfo,cn=bn.node,Pr=i.ad.multiply([],bt,tn.tileModelMatrix);i.ad.multiply(Pr,yt,Pr);let or=i.ad.invert([],Pr);i.ad.transpose(or,or),i.ad.scale(or,or,bc),Pr=i.ad.multiply(Pr,Pr,cn.matrix);let Fn=me.renderPass==="light-beam",zn=un&i.cl.HasMapboxMeshFeatures,pn=zn?0:bn.evaluatedRMEA[0][2];for(let Gt=0;Gt<cn.meshes.length;++Gt){let _i=cn.meshes[Gt],aa=Gt===cn.lightMeshIndex,rn=tn.wvpForNode;if(aa){if(!Fn&&!me.terrain&&me.shadowRenderer){me.currentLayer<me.firstLightBeamLayer&&(me.firstLightBeamLayer=me.currentLayer);continue}rn=tn.wvpForTile}else if(Fn)continue;let xt={defines:[]},Tl=[];if(Su(xt.defines,Tl,_i,me,Oe.lut),zn||xt.defines.push("DIFFUSE_SHADED"),Ir&&xt.defines.push("SHADOWS_SINGLE_CASCADE"),Ai&&(ft?Ai.numRenderedVerticesInShadowPass+=_i.vertexArray.length:Ai.numRenderedVerticesInTransparentPass+=_i.vertexArray.length),ft){Qo(_i,tn.nodeModelMatrix,me,Oe);continue}let Vo=null;if(Pe){let Ih=vh(tn.nodeModelMatrix,me.transform);if(Vo=new Float32Array(Ih),Ke.projection.name!=="globe"){let kh=_i.aabb.min,Ou=_i.aabb.max,[tu,Nu]=Pe.getOpacityForBounds(Ih,kh[0],kh[1],Ou[0],Ou[1]);xt.overrideFog=tu>=en||Nu>=en}}let xs=_i.material,bo;xs.occlusionTexture&&xs.occlusionTexture.offsetScale&&(bo=xs.occlusionTexture.offsetScale,xt.defines.push("OCCLUSION_TEXTURE_TRANSFORM")),!ft&&Be&&(Be.useNormalOffset=!!_i.normalBuffer);let Ns=me.getOrCreateProgram("model",xt);!ft&&Be&&Be.setupShadowsFromMatrix(tn.tileModelMatrix,Ns,Be.useNormalOffset),me.uploadCommonUniforms(Je,Ns,null,Vo);let Ac=xs.pbrMetallicRoughness;Ac.metallicFactor=.9,Ac.roughnessFactor=.5;let Sl=Bl(new Float32Array(rn),new Float32Array(Pr),new Float32Array(or),new Float32Array(cn.matrix),me,tn.opacity,Ac.baseColorFactor.toRenderColor(null),xs.emissiveFactor,Ac.metallicFactor,Ac.roughnessFactor,xs,pn,Oe,[0,0,0],bo);!aa&&(bn.hasTranslucentParts||tn.opacity<1)&&Ns.draw(me,Je.gl.TRIANGLES,Ht,i.ag.disabled,i.a.disabled,i.af.backCCW,Sl,Oe.id,_i.vertexBuffer,_i.indexBuffer,_i.segments,Oe.paint,me.transform.zoom,void 0,Tl),Ns.draw(me,Je.gl.TRIANGLES,aa?qt:Ht,i.ag.disabled,aa||tn.opacity<1||bn.hasTranslucentParts?i.a.alphaBlended:i.a.unblended,i.af.backCCW,Sl,Oe.id,_i.vertexBuffer,_i.indexBuffer,_i.segments,Oe.paint,me.transform.zoom,void 0,Tl)}}}}()}(m,o,h,g),void P();let j=O.getModels(),X=[],re=m.transform.getFreeCameraOptions().position,ae=i._.scale([],[re.x,re.y,re.z],m.transform.worldSize);i._.negate(ae,ae);let ue=[],he=[],fe=0;for(let me of j){let Le=h.paint.get("model-rotation").constantOr(null),Oe=h.paint.get("model-scale").constantOr(null),Ne=h.paint.get("model-translation").constantOr(null);me.computeModelMatrix(m,Le,Oe,Ne,!0,!0,!1);let Je=i.ad.identity([]),Ke=i.cg(me.position.lat,m.transform.zoom),Pe=i.ad.fromScaling([],[1,1,1/Ke]);i.ad.translate(Je,Je,ae),X.push({zScaleMatrix:Pe,negCameraPosMatrix:Je});for(let Be of me.nodes)Ga(m.transform,Be,me.matrix,m.transform.expandedFarZProjMatrix,fe,ue,he);fe++}if(ue.sort((me,Le)=>Le.depth-me.depth),m.renderPass!=="shadow"){if(y===1)for(let me of he)yc(me,m,h,X[me.modelIndex],i.ag.disabled,m.colorModeForRenderPass());else{for(let me of he)yc(me,m,h,X[me.modelIndex],i.ag.disabled,i.a.disabled);for(let me of he)yc(me,m,h,X[me.modelIndex],m.stencilModeFor3D(),m.colorModeForRenderPass());m.resetStencilClippingMasks()}for(let me of ue)yc(me,m,h,X[me.modelIndex],i.ag.disabled,m.colorModeForRenderPass());P()}else{for(let me of he)Qo(me.mesh,me.nodeModelMatrix,m,h);for(let me of ue)Qo(me.mesh,me.nodeModelMatrix,m,h);P()}}},lm={model:function(m,o,h){let g=o.getSource();if(!g.loaded())return;if(g.type==="vector"||g.type==="geojson")return void(h.modelManager&&h.modelManager.upload(h,g.type==="vector"?m.scope:""));if(g.type==="batched-model")return;let y=g.getModels();for(let b of y)b.upload(h.context)},raster:function(m,o,h){let g=o.getSource();if(!(g instanceof Mr&&g.loaded()))return;let y=m.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!y)return;let b=m.paint.get("raster-array-band")||g.getInitialBand(y);if(b==null)return;let S=o.getIds().map(C=>o.getTileByID(C));for(let C of S)C.updateNeeded(y,b)&&g.prepareTile(C,y,b)},"raster-particle":function(m,o,h){let g=o.getSource();if(!(g instanceof Mr&&g.loaded()))return;let y=m.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!y)return;let b=m.paint.get("raster-particle-array-band")||g.getInitialBand(y);if(b==null)return;let S=o.getIds().map(C=>o.getTileByID(C));for(let C of S)C.updateNeeded(y,b)&&g.prepareTile(C,y,b)}};class cm{constructor(o,h,g,y){this.context=new Kr(o,h),this.occlusionBuffers=new Zc(this.context),this.transform=g,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=y,this._timeStamp=i.e.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};let b=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(let S of b)this._debugParams.enabledLayers[S]=!0;y.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),y.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),y.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),y.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),y.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(let S of b)y.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],S);this.symbolParams=new Or(y),this.setup(),this.numSublayers=i.bv.maxUnderzooming+i.bv.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.co,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Vc(this),this._wireframeDebugCache=new ad,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[]}updateTerrain(o,h){let g=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(g||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new vo(this,o));let y=this._terrain;this.transform.elevation=g?y:null,y.update(o,this.transform,h),this.transform.elevation&&!y.enabled&&(this.transform.elevation=null)}_updateFog(o){let h=o.fog;if(!h||this.transform.projection.name==="globe"||h.getOpacity(this.transform.pitch)<1||h.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);let[g,y]=h.getFovAdjustedRange(this.transform._fov);if(g>y)return void(this.transform.fogCullDistSq=null);let b=g+.78*(y-g);this.transform.fogCullDistSq=b*b}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(o){o&&!this._terrain&&(this._terrain=new vo(this,this.style)),this._forceTerrainMode=o}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(o,h){if(this.width=o*i.e.devicePixelRatio,this.height=h*i.e.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let g of this.style.order)this.style._mergedLayers[g].resize()}setup(){let o=this.context,h=new i.bt;h.emplaceBack(0,0),h.emplaceBack(i.a3,0),h.emplaceBack(0,i.a3),h.emplaceBack(i.a3,i.a3),this.tileExtentBuffer=o.createVertexBuffer(h,i.br.members),this.tileExtentSegments=i.b.simpleSegment(0,0,4,2);let g=new i.bt;g.emplaceBack(0,0),g.emplaceBack(i.a3,0),g.emplaceBack(0,i.a3),g.emplaceBack(i.a3,i.a3),this.debugBuffer=o.createVertexBuffer(g,i.br.members),this.debugSegments=i.b.simpleSegment(0,0,4,5);let y=new i.bt;y.emplaceBack(-1,-1),y.emplaceBack(1,-1),y.emplaceBack(-1,1),y.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(y,i.br.members),this.viewportSegments=i.b.simpleSegment(0,0,4,2);let b=new i.cp;b.emplaceBack(0,0,0,0),b.emplaceBack(i.a3,0,i.a3,0),b.emplaceBack(0,i.a3,0,i.a3),b.emplaceBack(i.a3,i.a3,i.a3,i.a3),this.mercatorBoundsBuffer=o.createVertexBuffer(b,i.cq.members),this.mercatorBoundsSegments=i.b.simpleSegment(0,0,4,2);let S=new i.bu;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(S);let C=new i.cr;for(let O of[0,1,3,2,0])C.emplaceBack(O);this.debugIndexBuffer=o.createIndexBuffer(C),this.emptyTexture=new i.T(o,new i.i({width:1,height:1},Uint8Array.of(0,0,0,0)),o.gl.RGBA),this.identityMat=i.ad.create();let P=this.context.gl;this.stencilClearMode=new i.ag({func:P.ALWAYS,mask:0},0,255,P.ZERO,P.ZERO,P.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){let o=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,o.TRIANGLES,i.ae.disabled,this.stencilClearMode,i.a.disabled,i.af.disabled,Zi(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(o,h,g){if(!h||this.currentStencilSource===h.id||!o.isTileClipped()||!g||g.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let C=!1;for(let P of g)if(this._tileClippingMaskIDs[P.key]===void 0){C=!0;break}if(!C)return}this.currentStencilSource=h.id;let y=this.context,b=y.gl;this.nextStencilID+g.length>256&&this.clearStencil(),y.setColorMode(i.a.disabled),y.setDepthMode(i.ae.disabled);let S=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(let C of g){let P=h.getTile(C),O=this._tileClippingMaskIDs[C.key]=this.nextStencilID++,{tileBoundsBuffer:j,tileBoundsIndexBuffer:X,tileBoundsSegments:re}=this.getTileBoundsBuffers(P);S.draw(this,b.TRIANGLES,i.ae.disabled,new i.ag({func:b.ALWAYS,mask:0},O,255,b.KEEP,b.KEEP,b.REPLACE),i.a.disabled,i.af.disabled,Zi(C.projMatrix),"$clipping",j,X,re)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let o=this.nextStencilID++,h=this.context.gl;return new i.ag({func:h.NOTEQUAL,mask:255},o,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);let h=this.context.gl;return new i.ag({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(o){let h=this.context.gl,g=o.sort((S,C)=>C.overscaledZ-S.overscaledZ),y=g[g.length-1].overscaledZ,b=g[0].overscaledZ-y+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();let S={};for(let C=0;C<b;C++)S[C+y]=new i.ag({func:h.GEQUAL,mask:255},C+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=b,[S,g]}return[{[y]:i.ag.disabled},g]}colorModeForRenderPass(){let o=this.context.gl;return this._showOverdrawInspector?new i.a([o.CONSTANT_COLOR,o.ONE,o.CONSTANT_COLOR,o.ONE],new i.C(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?i.a.unblended:i.a.alphaBlended}colorModeForDrapableLayerRenderPass(o){let h=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new i.a([h.ONE,h.ONE_MINUS_SRC_ALPHA,h.CONSTANT_ALPHA,h.ONE_MINUS_SRC_ALPHA],new i.C(0,0,0,o===void 0?0:o),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(o,h,g,y=!1){if(this.depthOcclusion)return new i.ae(this.context.gl.GREATER,i.ae.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!y)return i.ae.disabled;let b=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new i.ae(g||this.context.gl.LEQUAL,h,[b,b])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((o,h)=>o+h/this._fpsHistory.length,0))}render(o,h){let g=i.e.now();this._dt=g-this._timeStamp,this._timeStamp=g,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=o.map.repaint,this.style=o,this.options=h;let y=this.style._mergedLayers,b=this.style.order.filter(Be=>{let je=y[Be];return!(je.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[je.type]}),S=b.map(Be=>y[Be]),C=this.style._mergedSourceCaches;this.imageManager=o.imageManager,this.modelManager=o.modelManager,this.symbolFadeChange=o.placement.symbolFadeChange(i.e.now()),this.imageManager.beginFrame();let P=0,O=!1;for(let Be in C){let je=C[Be];je.used&&(je.prepare(this.context),je.getSource().usedInConflation&&++P)}let j=!1;for(let Be of S)Be.isHidden(this.transform.zoom)||(Be.type==="clip"&&(j=!0),this.prepareLayer(Be));let X={},re={},ae={},ue={},he={};for(let Be in C){let je=C[Be];X[Be]=je.getVisibleCoordinates(),re[Be]=X[Be].slice().reverse(),ae[Be]=je.getVisibleCoordinates(!0).reverse(),ue[Be]=je.getShadowCasterCoordinates(),he[Be]=je.sortCoordinatesByDistance(X[Be])}let fe=Be=>{let je=this.style.getLayerSourceCache(Be);return je&&je.used?je.getSource():null};if(P||j){let Be=[],je=[],at=0;for(let yt of S)this.isSourceForClippingOrConflation(yt,fe(yt))&&(Be.push(yt),je.push(at)),at++;if(Be&&(j||Be.length>1)){let yt=[];for(let qe=0;qe<Be.length;qe++){let bt=Be[qe],Ct=je[qe],Ht=this.style.getLayerSourceCache(bt);if(!Ht||!Ht.used||!Ht.getSource().usedInConflation&&bt.type!=="clip")continue;let qt=1/0,Ut=i.cu.None;if(bt.type==="clip"){qt=Ct;for(let ft of bt.layout.get("clip-layer-types"))Ut|=ft==="model"?i.cu.Model:ft==="symbol"?i.cu.Symbol:i.cu.FillExtrusion}yt.push({layer:bt.fqid,cache:Ht,order:qt,clipMask:Ut})}this.replacementSource.setSources(yt),O=!0}}O||this.replacementSource.clear(),this.conflationActive=O,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let Be=0;Be<S.length;Be++){let je=S[Be],at=je.cutoffRange();if(this.longestCutoffRange=Math.max(at,this.longestCutoffRange),at>0){let yt=fe(je);yt&&(this.minCutoffZoom=Math.max(yt.minzoom,this.minCutoffZoom)),je.minzoom&&(this.minCutoffZoom=Math.max(je.minzoom,this.minCutoffZoom))}je.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=Be),this._lastOcclusionLayer=Be)}let me=this.style&&this.style.fog;me?(this._fogVisible=me.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=me.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(ae),this.opaquePassCutoff=0);let Le=this._shadowRenderer;if(Le){Le.updateShadowParameters(this.transform,this.style.directionalLight);for(let Be in C)for(let je of X[Be]){let at={min:0,max:0};this.terrain&&(at=this.terrain.getMinMaxForTile(je)||at),Le.addShadowReceiver(je.toUnwrapped(),at.min,at.max)}}if(this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.cs(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new rp(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!i.ct(this.context.gl))return;this.renderPass="offscreen";for(let Be of S){let je=o.getLayerSourceCache(Be);if(!Be.hasOffscreenPass()||Be.isHidden(this.transform.zoom))continue;let at=je?re[je.id]:void 0;(Be.type==="custom"||Be.type==="raster"||Be.type==="raster-particle"||Be.isSky()||at&&at.length)&&this.renderLayer(this,je,Be,at)}this.depthRangeFor3D=[0,1-(S.length+2)*this.numSublayers*this.depthEpsilon];let Oe=this.terrain;Oe&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&Oe.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,ue)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let Ne=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Je=(()=>{if(h.showOverdrawInspector)return i.C.black;let Be=this.style.fog;if(Be&&this.transform.projection.supportsFog){let je=this.style.getLut(Be.scope);if(!Ne){let at=Be.properties.get("color").toRenderColor(je).toArray01();return new i.C(...at)}if(Ne){let at=Be.properties.get("space-color").toRenderColor(je).toArray01();return new i.C(...at)}}return i.C.transparent})();if(this.context.clear({color:Je,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ne&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=b.length-1;this.currentLayer>=0;this.currentLayer--){let Be=S[this.currentLayer],je=o.getLayerSourceCache(Be);if(Be.isSky())continue;let at=je?(Be.is3D()?he:re)[je.id]:void 0;this._renderTileClippingMasks(Be,je,at),this.renderLayer(this,je,Be,at)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ne&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.a1(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<b.length;this.currentLayer++){let Be=S[this.currentLayer],je=o.getLayerSourceCache(Be);Be.isSky()&&this.renderLayer(this,je,Be,je?re[je.id]:void 0)}function Ke(Be,je){let at;return je&&(at=(Be.type==="symbol"?ae:Be.is3D()?he:re)[je.id]),at}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<b.length;){let Be=S[this.currentLayer];if(Be.type==="raster"){let je=o.getLayerSourceCache(Be);this.renderLayer(this,je,Be,Ke(Be,je))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Pe=0;for(Le&&(Pe=Le.getShadowCastingLayerCount());this.currentLayer<b.length;){let Be=S[this.currentLayer],je=o.getLayerSourceCache(Be);if(Be.isSky())++this.currentLayer;else if(Oe&&this.style.isLayerDraped(Be)){if(Be.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=Oe.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(Be.is3D()||this.terrain||this._renderTileClippingMasks(Be,je,je?X[je.id]:void 0),this.renderLayer(this,je,Be,Ke(Be,je)),!Oe&&Le&&Pe>0&&Be.hasShadowPass()&&--Pe==0&&(Le.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){let at=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=at;this.currentLayer++){let yt=S[this.currentLayer];if(!yt.hasLightBeamPass())continue;let qe=o.getLayerSourceCache(yt);this.renderLayer(this,qe,yt,qe?re[qe.id]:void 0)}this.currentLayer=at,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){let at=this.currentLayer;this.depthOcclusion=!0;for(let yt of this.layersWithOcclusionOpacity){this.currentLayer=yt;let qe=S[this.currentLayer],bt=o.getLayerSourceCache(qe),Ct=bt?re[bt.id]:void 0;qe.is3D()||this.terrain||this._renderTileClippingMasks(qe,bt,bt?X[bt.id]:void 0),this.renderLayer(this,bt,qe,Ct)}this.depthOcclusion=!1,this.currentLayer=at,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let Be=null;S.forEach(je=>{let at=o.getLayerSourceCache(je);at&&!je.isHidden(this.transform.zoom)&&at.getVisibleCoordinates().length&&(!Be||Be.getSource().maxzoom<at.getSource().maxzoom)&&(Be=at)}),Be&&this.options.showTileBoundaries&&za.debug(this,Be,Be.getVisibleCoordinates(),i.C.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&za.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.C(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(Be){let je=Be.transform.padding;Br(Be,Be.transform.height-(je.top||0),3,Ko),Br(Be,je.bottom||0,3,_h),Vr(Be,je.left||0,3,Ls),Vr(Be,Be.transform.width-(je.right||0),3,Kd);let at=Be.transform.centerPoint;(function(yt,qe,bt,Ct){Ao(yt,qe-1,bt-10,2,20,Ct),Ao(yt,qe-10,bt-1,20,2,Ct)})(Be,at.x,Be.transform.height-at.y,vc)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),O||(this.conflationActive=!1)}prepareLayer(o){this.gpuTimingStart(o);let{unsupportedLayers:h}=this.transform.projection,g=!h||!h.includes(o.type);if(lm[o.type]&&(g||this.terrain&&o.type==="custom")){let y=this.style.getLayerSourceCache(o);lm[o.type](o,y,this)}this.gpuTimingEnd()}renderLayer(o,h,g,y){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="sky"||g.type==="custom"||g.type==="model"||g.type==="raster"||g.type==="raster-particle"||y&&y.length)&&(this.id=g.id,this.gpuTimingStart(g),o.transform.projection.unsupportedLayers&&o.transform.projection.unsupportedLayers.includes(g.type)&&(!o.terrain||g.type!=="custom")||g.type==="clip"||za[g.type](o,h,g,y,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;let h=this.context.extTimerQuery,g=this.context.gl,y=this.gpuTimers[o.id];y||(y=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:g.createQuery()}),y.calls++,g.beginQuery(h.TIME_ELAPSED_EXT,y.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){let o=this.context.extTimerQuery,h=this.context.gl,g=h.createQuery();this.deferredRenderGpuTimeQueries.push(g),h.beginQuery(o.TIME_ELAPSED_EXT,g)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){let o=this.gpuTimers;return this.gpuTimers={},o}collectDeferredRenderGpuQueries(){let o=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],o}queryGpuTimers(o){let h={};for(let g in o){let y=o[g],b=this.context.extTimerQuery,S=b.getQueryParameter(y.query,this.context.gl.QUERY_RESULT)/1e6;b.deleteQueryEXT(y.query),h[g]=S}return h}queryGpuTimeDeferredRender(o){if(!this.options.gpuTimingDeferredRender)return 0;let h=this.context.extTimerQuery,g=this.context.gl,y=0;for(let b of o)y+=h.getQueryParameter(b,g.QUERY_RESULT)/1e6,h.deleteQueryEXT(b);return y}translatePosMatrix(o,h,g,y,b){if(!g[0]&&!g[1])return o;let S=b?y==="map"?this.transform.angle:0:y==="viewport"?-this.transform.angle:0;if(S){let O=Math.sin(S),j=Math.cos(S);g=[g[0]*j-g[1]*O,g[0]*O+g[1]*j]}let C=[b?g[0]:i.bB(h,g[0],this.transform.zoom),b?g[1]:i.bB(h,g[1],this.transform.zoom),0],P=new Float32Array(16);return i.ad.translate(P,o,C),P}saveTileTexture(o){let h=o.size[0],g=this._tileTextures[h];g?g.push(o):this._tileTextures[h]=[o]}getTileTexture(o){let h=this._tileTextures[o];return h&&h.length>0?h.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(o,h,g){let y=g===void 0?this.terrain&&this.terrain.renderingToTexture:g,b=[];return this.style&&this.style.enable3dLights()&&(o==="globeRaster"||o==="terrainRaster"?(b.push("LIGHTING_3D_MODE"),b.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):y||b.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||b.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?b.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):b.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(b.push("TERRAIN"),this.linearFloatFilteringSupported()&&b.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&b.push("GLOBE"),!this._fogVisible||y||h!==void 0&&!h||b.push("FOG","FOG_DITHERING"),y&&b.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&b.push("OVERDRAW_INSPECTOR"),b}getOrCreateProgram(o,h){this.cache=this.cache||{};let g=h&&h.defines||[],y=h&&h.config,b=this.currentGlobalDefines(o,h&&h.overrideFog,h&&h.overrideRtt).concat(g),S=Ms.cacheKey(Qh[o],o,b,y);return this.cache[S]||(this.cache[S]=new Ms(this.context,o,Qh[o],y,xl[o],b)),this.cache[S]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(o,h){if(this.style.enable3dLights()){let g=this.style.directionalLight,y=this.style.ambientLight;if(g&&y){let b=((S,C,P)=>{let O=S.properties.get("direction"),j=S.properties.get("color").toRenderColor(P.getLut(S.scope)).toArray01(),X=S.properties.get("intensity"),re=C.properties.get("color").toRenderColor(P.getLut(C.scope)).toArray01(),ae=C.properties.get("intensity"),ue=[O.x,O.y,O.z],he=i.bA(re,ae),fe=i.bA(j,X);return{u_lighting_ambient_color:he,u_lighting_directional_dir:ue,u_lighting_directional_color:fe,u_ground_radiance:ra(ue,fe,he)}})(g,y,this.style);h.setLightsUniformValues(o,b)}}}uploadCommonUniforms(o,h,g,y,b){if(this.uploadCommonLightUniforms(o,h),this.terrain&&this.terrain.renderingToTexture)return;let S=this.style.fog;if(S){let C=S.getOpacity(this.transform.pitch),P=((O,j,X,re,ae,ue,he,fe,me,Le,Oe,Ne)=>{let Je=O.transform,Ke=j.properties.get("color").toRenderColor(O.style.getLut(j.scope)).toArray01();Ke[3]=re;let Pe=O.frameCounter/1e3%1,[Be,je]=j.properties.get("vertical-range");return{u_fog_matrix:X?Je.calculateFogTileMatrix(X):Ne||O.identityMat,u_fog_range:j.getFovAdjustedRange(Je._fov),u_fog_color:Ke,u_fog_horizon_blend:j.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Be,je),je],u_fog_temporal_offset:Pe,u_frustum_tl:ae,u_frustum_tr:ue,u_frustum_br:he,u_frustum_bl:fe,u_globe_pos:me,u_globe_radius:Le,u_viewport:Oe,u_globe_transition:i.a1(Je.zoom),u_is_globe:+(Je.projection.name==="globe")}})(this,S,g,C,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.e.devicePixelRatio,this.transform.height*i.e.devicePixelRatio],y);h.setFogUniformValues(o,P)}b&&h.setCutoffUniformValues(o,b.uniformValues)}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){let o=this.canvasCopy();o&&(this.frameCopies.push(o),this.tileLoaded=!1)}canvasCopy(){let o=this.context.gl,h=o.createTexture();return o.bindTexture(o.TEXTURE_2D,h),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),h}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;let o=this.style&&this.style.fog;return!!o&&o.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){let o=this._backgroundTiles,h=this._backgroundTiles={},g=this.transform.coveringTiles({tileSize:512});for(let y of g)h[y.key]=o[y.key]||new i.by(y,512,this.transform.tileZoom,this);return h}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(o,h){return!(!o.is3D()||o.minzoom&&o.minzoom>this.transform.zoom||(this.style._clipLayerIndices.length||o.sourceLayer!=="building")&&o.type!=="clip"&&(!h||h.type!=="batched-model"))}isTileAffectedByFog(o){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let h=this._cachedTileFogOpacities[o.key];return h||(this._cachedTileFogOpacities[o.key]=h=this.style.fog.getOpacityForTile(o)),h[0]>=en||h[1]>=en}}class Co{constructor(o,h,g,y){this.screenBounds=o,this.cameraPoint=h,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=g,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,y)}static createFromScreenPoints(o,h){let g,y;if(o instanceof i.P||typeof o[0]=="number"){let b=i.P.convert(o);g=[b],y=h.isPointAboveHorizon(b)}else{let b=i.P.convert(o[0]),S=i.P.convert(o[1]);g=[b,S],y=i.cv(b,S).every(C=>h.isPointAboveHorizon(C))}return new Co(g,h.getCameraPoint(),y,h)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(o){return i.cv(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){let h=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],y=i.cv(h,g,0,!1);return this.cameraPoint.y>g.y&&(this.cameraPoint.x>h.x&&this.cameraPoint.x<g.x?y.splice(3,0,this.cameraPoint):this.cameraPoint.x>=g.x?y[2]=this.cameraPoint:this.cameraPoint.x<=h.x&&(y[3]=this.cameraPoint)),i.cw(y,o)}bufferedCameraGeometryGlobe(o){let h=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],y=i.cv(h,g,o),b=this.cameraPoint.clone();switch(3*((b.y>h.y)+(b.y>g.y))+((b.x>h.x)+(b.x>g.x))){case 0:y[0]=b,y[4]=b.clone();break;case 1:y.splice(1,0,b);break;case 2:y[1]=b;break;case 3:y.splice(4,0,b);break;case 5:y.splice(2,0,b);break;case 6:y[3]=b;break;case 7:y.splice(3,0,b);break;case 8:y[2]=b}return y}containsTile(o,h,g,y=0){let b=o.queryPadding/h._pixelsPerMercatorPixel+1,S=g?this._bufferedCameraMercator(b,h):this._bufferedScreenMercator(b,h),C=o.tileID.wrap+(S.unwrapped?y:0),P=S.polygon.map(fe=>i.cx(o.tileTransform,fe,C));if(!i.cy(P,0,0,i.a3,i.a3))return;C=o.tileID.wrap+(this.screenGeometryMercator.unwrapped?y:0);let O=this.screenGeometryMercator.polygon.map(fe=>i.cz(o.tileTransform,fe,C)),j=O.map(fe=>new i.P(fe[0],fe[1])),X=h.getFreeCameraOptions().position||new i.Y(0,0,0),re=i.cz(o.tileTransform,X,C),ae=O.map(fe=>{let me=i._.sub(fe,fe,re);return i._.normalize(me,me),new i.aT(re,me)}),ue=i.bB(o,1,h.zoom)*h._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:j,tilespaceRays:ae,bufferedTilespaceGeometry:P,bufferedTilespaceBounds:(he=i.cA(P),he.min.x=i.at(he.min.x,0,i.a3),he.min.y=i.at(he.min.y,0,i.a3),he.max.x=i.at(he.max.x,0,i.a3),he.max.y=i.at(he.max.y,0,i.a3),he),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:ue};var he}_bufferedScreenMercator(o,h){let g=Qd(o);if(this._screenRaycastCache[g])return this._screenRaycastCache[g];{let y;return y=h.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(o),h):{polygon:this.bufferedScreenGeometry(o).map(b=>h.pointCoordinate3D(b)),unwrapped:!0},this._screenRaycastCache[g]=y,y}}_bufferedCameraMercator(o,h){let g=Qd(o);if(this._cameraRaycastCache[g])return this._cameraRaycastCache[g];{let y;return y=h.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(o),h):{polygon:this.bufferedCameraGeometry(o).map(b=>h.pointCoordinate3D(b)),unwrapped:!0},this._cameraRaycastCache[g]=y,y}}_projectAndResample(o,h){let g=function(b,S){let C=i.ad.multiply([],S.pixelMatrix,S.globeMatrix),P=[0,-i.cD,0,1],O=[0,i.cD,0,1],j=[0,0,0,1];i.aA.transformMat4(P,P,C),i.aA.transformMat4(O,O,C),i.aA.transformMat4(j,j,C);let X=new i.P(P[0]/P[3],P[1]/P[3]),re=new i.P(O[0]/O[3],O[1]/O[3]),ae=i.cB(b,X)&&P[3]<j[3],ue=i.cB(b,re)&&O[3]<j[3];if(!ae&&!ue)return null;let he=function(Pe,Be,je){for(let at=1;at<Pe.length;at++){let yt=wc(Be.pointCoordinate3D(Pe[at-1]).x),qe=wc(Be.pointCoordinate3D(Pe[at]).x);if(je<0){if(yt<qe)return{idx:at,t:-yt/(qe-1-yt)}}else if(qe<yt)return{idx:at,t:(1-yt)/(qe+1-yt)}}return null}(b,S,ae?-1:1);if(!he)return null;let{idx:fe,t:me}=he,Le=fe>1?Jd(b.slice(0,fe),S):[],Oe=fe<b.length?Jd(b.slice(fe),S):[];Le=Le.map(Pe=>new i.P(wc(Pe.x),Pe.y)),Oe=Oe.map(Pe=>new i.P(wc(Pe.x),Pe.y));let Ne=[...Le];Ne.length===0&&Ne.push(Oe[Oe.length-1]);let Je=i.a2(Ne[Ne.length-1].y,(Oe.length===0?Le[0]:Oe[0]).y,me),Ke;return Ke=ae?[new i.P(0,Je),new i.P(0,0),new i.P(1,0),new i.P(1,Je)]:[new i.P(1,Je),new i.P(1,1),new i.P(0,1),new i.P(0,Je)],Ne.push(...Ke),Oe.length===0?Ne.push(Le[0]):Ne.push(...Oe),{polygon:Ne.map(Pe=>new i.Y(Pe.x,Pe.y)),unwrapped:!1}}(o,h);if(g)return g;let y=function(b,S){let C=!1,P=-1/0,O=0;for(let X=0;X<b.length-1;X++)b[X].x>P&&(P=b[X].x,O=X);for(let X=0;X<b.length-1;X++){let re=(O+X)%(b.length-1),ae=b[re],ue=b[re+1];Math.abs(ae.x-ue.x)>.5&&(ae.x<ue.x?(ae.x+=1,re===0&&(b[b.length-1].x+=1)):(ue.x+=1,re+1===b.length-1&&(b[0].x+=1)),C=!0)}let j=i.aj(S.center.lng);return C&&j<Math.abs(j-1)&&b.forEach(X=>{X.x-=1}),{polygon:b,unwrapped:C}}(Jd(o,h).map(b=>new i.P(wc(b.x),b.y)),h);return{polygon:y.polygon.map(b=>new i.Y(b.x,b.y)),unwrapped:y.unwrapped}}}function Jd(m,o){return i.cC(m,h=>{let g=o.pointCoordinate3D(h);h.x=g.x,h.y=g.y},1/256)}function wc(m){return m<0?1+m%1:m%1}function Qd(m){return 100*m|0}function k0(m,o){let h=i.ad.identity([]);return i.ad.scale(h,h,[.5*m.width,.5*-m.height,1]),i.ad.translate(h,h,[1,-1,0]),i.ad.multiply(h,h,m.calculateProjMatrix(o.toUnwrapped())),Float32Array.from(h)}function ef(m,o,h,g,y,b,S,C=!1){let P=m.tilesIn(g,S,C);P.sort(Hl);let O=[];for(let X of P)O.push({wrappedTileID:X.tile.tileID.wrapped().key,queryResults:X.tile.queryRenderedFeatures(o,h,m._state,X,y,b,k0(m.transform,X.tile.tileID),C)});let j=function(X){let re={},ae={};for(let ue of X){let he=ue.queryResults,fe=ue.wrappedTileID,me=ae[fe]=ae[fe]||{};for(let Le in he){let Oe=he[Le],Ne=me[Le]=me[Le]||{},Je=re[Le]=re[Le]||[];for(let Ke of Oe)Ne[Ke.featureIndex]||(Ne[Ke.featureIndex]=!0,Je.push(Ke))}}return re}(O);for(let X in j)j[X].forEach(re=>{let ae=re.feature,ue=ae.layer;ue&&ue.type!=="background"&&ue.type!=="sky"&&ue.type!=="slot"&&(ae.source=ue.source,ue["source-layer"]&&(ae.sourceLayer=ue["source-layer"]),ae.state=ae.id!==void 0?m.getFeatureState(ue["source-layer"],ae.id):{})});return j}function Yc(m,o){let h=m.getRenderableIds().map(b=>m.getTileByID(b)),g=[],y={};for(let b=0;b<h.length;b++){let S=h[b],C=S.tileID.canonical.key;y[C]||(y[C]=!0,S.querySourceFeatures(g,o))}return g}function Hl(m,o){let h=m.tileID,g=o.tileID;return h.overscaledZ-g.overscaledZ||h.canonical.y-g.canonical.y||h.wrap-g.wrap||h.canonical.x-g.canonical.x}class np{constructor(o){this.style=o,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];let o=!1,h=!1;for(let g in this.style._mergedLayers){let y=this.style._mergedLayers[g];if(y.type==="fill-extrusion")this.layers.push({layer:y,visible:o,visibilityChanged:h});else if(y.type==="model"){let b=this.style.getLayerSource(y);b&&b.type==="batched-model"&&this.layers.push({layer:y,visible:o,visibilityChanged:h})}}}onNewFrame(o){this.layersGotHidden=!1;for(let h of this.layers){let g=h.layer,y=!1;g.type==="fill-extrusion"?y=!g.isHidden(o)&&g.paint.get("fill-extrusion-opacity")>0:g.type==="model"&&(y=!g.isHidden(o)&&g.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!y&&h.visible,h.visible=y}}updateZOffset(o,h){this.currentBuildingBuckets=[];for(let y of this.layers){let b=y.layer,S=this.style.getLayerSourceCache(b),C=1;b.type==="fill-extrusion"&&(C=y.visible?b.paint.get("fill-extrusion-vertical-scale"):0);let P=S?S.getTile(h):null;if(!P&&S&&h.canonical.z>S.getSource().minzoom){let O=h.scaledTo(Math.min(S.getSource().maxzoom,h.overscaledZ-1));for(;O.overscaledZ>=S.getSource().minzoom&&(P=S.getTile(O),!P&&O.overscaledZ!==0);)O=O.scaledTo(O.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:P?P.getBucket(b):null,tileID:P?P.tileID:h,verticalScale:C})}o.hasAnyZOffset=!1;let g=!1;for(let y=0;y<o.symbolInstances.length;y++){let b=o.symbolInstances.get(y),S=b.zOffset,C=this._getHeightAtTileOffset(h,b.tileAnchorX,b.tileAnchorY);b.zOffset=C!==Number.NEGATIVE_INFINITY?C:S,g||S===b.zOffset||(g=!0),o.hasAnyZOffset||b.zOffset===0||(o.hasAnyZOffset=!0)}g&&(o.zOffsetBuffersNeedUpload=!0,o.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(o,h,g,y){let b=h,S=g;if(o.canonical.z!==y.canonical.z){let C=y.canonical,P=1/(1<<o.canonical.z-C.z);b=(h+o.canonical.x*i.a3)*P-C.x*i.a3|0,S=(g+o.canonical.y*i.a3)*P-C.y*i.a3|0}return{tileX:b,tileY:S}}_getHeightAtTileOffset(o,h,g){let y,b;for(let S=0;S<this.layers.length;++S){if(this.layers[S].layer.type!=="fill-extrusion")continue;let{bucket:C,tileID:P,verticalScale:O}=this.currentBuildingBuckets[S];if(!C)continue;let{tileX:j,tileY:X}=this._mapCoordToOverlappingTile(o,h,g,P),re=C.getHeightAtTileCoord(j,X);re&&re.height!==void 0&&(re.hidden?y=re.height:b=Math.max(re.height*O,b||0))}if(b!==void 0)return b;for(let S=0;S<this.layers.length;++S){let C=this.layers[S];if(C.layer.type!=="model"||!C.visible)continue;let{bucket:P,tileID:O}=this.currentBuildingBuckets[S];if(!P)continue;let{tileX:j,tileY:X}=this._mapCoordToOverlappingTile(o,h,g,O),re=P.getHeightAtTileCoord(j,X);if(re&&!re.hidden)return re.height===void 0&&y!==void 0?Math.min(re.maxHeight,y)*re.verticalScale:re.height?re.height*re.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Eu(m,o){let h={};for(let g in m)g!=="ref"&&(h[g]=m[g]);return i.cE.forEach(g=>{g in o&&(h[g]=o[g])}),h}function ap(m){m=m.slice();let o=Object.create(null);for(let h=0;h<m.length;h++)o[m[h].id]=m[h];for(let h=0;h<m.length;h++)"ref"in m[h]&&(m[h]=Eu(m[h],o[m[h].ref]));return m}let Rr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function Tc(m,o,h){h.push({command:Rr.addSource,args:[m,o[m]]})}function um(m,o,h){o.push({command:Rr.removeSource,args:[m]}),h[m]=!0}function M0(m,o,h,g){um(m,h,g),Tc(m,o,h)}function D0(m,o,h){let g;for(g in m[h])if(m[h].hasOwnProperty(g)&&g!=="data"&&!x(m[h][g],o[h][g]))return!1;for(g in o[h])if(o[h].hasOwnProperty(g)&&g!=="data"&&!x(m[h][g],o[h][g]))return!1;return!0}function od(m,o,h,g,y,b){let S;for(S in o=o||{},m=m||{})m.hasOwnProperty(S)&&(x(m[S],o[S])||h.push({command:b,args:[g,S,o[S],y]}));for(S in o)o.hasOwnProperty(S)&&!m.hasOwnProperty(S)&&(x(m[S],o[S])||h.push({command:b,args:[g,S,o[S],y]}))}function tf(m){return m.id}function Au(m,o){return m[o.id]=o,m}class sd{constructor(o,h){this.reset(o,h)}reset(o,h){this.points=o||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=i.at(o,0,1);let h=1,g=this._distances[h],y=o*this.paddedLength+this.padding;for(;g<y&&h<this._distances.length;)g=this._distances[++h];let b=h-1,S=this._distances[b],C=g-S,P=C>0?(y-S)/C:0;return this.points[b].mult(1-P).add(this.points[h].mult(P))}}class op{constructor(o,h,g){let y=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(o/g),this.yCellCount=Math.ceil(h/g);for(let S=0;S<this.xCellCount*this.yCellCount;S++)y.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=h,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,h,g,y,b){this._forEachCell(h,g,y,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(y),this.bboxes.push(b)}insertCircle(o,h,g,y){this._forEachCell(h-y,g-y,h+y,g+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(h),this.circles.push(g),this.circles.push(y)}_insertBoxCell(o,h,g,y,b,S){this.boxCells[b].push(S)}_insertCircleCell(o,h,g,y,b,S){this.circleCells[b].push(S)}_query(o,h,g,y,b,S){if(g<0||o>this.width||y<0||h>this.height)return!b&&[];let C=[];if(o<=0&&h<=0&&this.width<=g&&this.height<=y){if(b)return!0;for(let P=0;P<this.boxKeys.length;P++)C.push({key:this.boxKeys[P],x1:this.bboxes[4*P],y1:this.bboxes[4*P+1],x2:this.bboxes[4*P+2],y2:this.bboxes[4*P+3]});for(let P=0;P<this.circleKeys.length;P++){let O=this.circles[3*P],j=this.circles[3*P+1],X=this.circles[3*P+2];C.push({key:this.circleKeys[P],x1:O-X,y1:j-X,x2:O+X,y2:j+X})}return S?C.filter(S):C}return this._forEachCell(o,h,g,y,this._queryCell,C,{hitTest:b,seenUids:{box:{},circle:{}}},S),b?C.length>0:C}_queryCircle(o,h,g,y,b){let S=o-g,C=o+g,P=h-g,O=h+g;if(C<0||S>this.width||O<0||P>this.height)return!y&&[];let j=[];return this._forEachCell(S,P,C,O,this._queryCellCircle,j,{hitTest:y,circle:{x:o,y:h,radius:g},seenUids:{box:{},circle:{}}},b),y?j.length>0:j}query(o,h,g,y,b){return this._query(o,h,g,y,!1,b)}hitTest(o,h,g,y,b){return this._query(o,h,g,y,!0,b)}hitTestCircle(o,h,g,y){return this._queryCircle(o,h,g,!0,y)}_queryCell(o,h,g,y,b,S,C,P){let O=C.seenUids,j=this.boxCells[b];if(j!==null){let re=this.bboxes;for(let ae of j)if(!O.box[ae]){O.box[ae]=!0;let ue=4*ae;if(o<=re[ue+2]&&h<=re[ue+3]&&g>=re[ue+0]&&y>=re[ue+1]&&(!P||P(this.boxKeys[ae]))){if(C.hitTest)return S.push(!0),!0;S.push({key:this.boxKeys[ae],x1:re[ue],y1:re[ue+1],x2:re[ue+2],y2:re[ue+3]})}}}let X=this.circleCells[b];if(X!==null){let re=this.circles;for(let ae of X)if(!O.circle[ae]){O.circle[ae]=!0;let ue=3*ae;if(this._circleAndRectCollide(re[ue],re[ue+1],re[ue+2],o,h,g,y)&&(!P||P(this.circleKeys[ae]))){if(C.hitTest)return S.push(!0),!0;{let he=re[ue],fe=re[ue+1],me=re[ue+2];S.push({key:this.circleKeys[ae],x1:he-me,y1:fe-me,x2:he+me,y2:fe+me})}}}}}_queryCellCircle(o,h,g,y,b,S,C,P){let O=C.circle,j=C.seenUids,X=this.boxCells[b];if(X!==null){let ae=this.bboxes;for(let ue of X)if(!j.box[ue]){j.box[ue]=!0;let he=4*ue;if(this._circleAndRectCollide(O.x,O.y,O.radius,ae[he+0],ae[he+1],ae[he+2],ae[he+3])&&(!P||P(this.boxKeys[ue])))return S.push(!0),!0}}let re=this.circleCells[b];if(re!==null){let ae=this.circles;for(let ue of re)if(!j.circle[ue]){j.circle[ue]=!0;let he=3*ue;if(this._circlesCollide(ae[he],ae[he+1],ae[he+2],O.x,O.y,O.radius)&&(!P||P(this.circleKeys[ue])))return S.push(!0),!0}}}_forEachCell(o,h,g,y,b,S,C,P){let O=this._convertToXCellCoord(o),j=this._convertToYCellCoord(h),X=this._convertToXCellCoord(g),re=this._convertToYCellCoord(y);for(let ae=O;ae<=X;ae++)for(let ue=j;ue<=re;ue++)if(b.call(this,o,h,g,y,this.xCellCount*ue+ae,S,C,P))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,h,g,y,b,S){let C=y-o,P=b-h,O=g+S;return O*O>C*C+P*P}_circleAndRectCollide(o,h,g,y,b,S,C){let P=(S-y)/2,O=Math.abs(o-(y+P));if(O>P+g)return!1;let j=(C-b)/2,X=Math.abs(h-(b+j));if(X>j+g)return!1;if(O<=P||X<=j)return!0;let re=O-P,ae=X-j;return re*re+ae*ae<=g*g}}let bl=100;class sp{constructor(o,h,g=new op(o.width+200,o.height+200,25),y=new op(o.width+200,o.height+200,25)){this.transform=o,this.grid=g,this.ignoredGrid=y,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+bl,this.screenBottomBoundary=o.height+bl,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=h}placeCollisionBox(o,h,g,y,b,S,C,P){let O=g.projectedAnchorX,j=g.projectedAnchorY,X=g.projectedAnchorZ,re=g.elevation,ae=g.tileID,ue=o.getProjection();if(re&&ae){let[Ke,Pe,Be]=ue.upVector(ae.canonical,g.tileAnchorX,g.tileAnchorY),je=ue.upVectorScale(ae.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;O+=Ke*re*je,j+=Pe*re*je,X+=Be*re*je}let he=this.projectAndGetPerspectiveRatio(C,O,j,X,g.tileID,ue.name==="globe"||!!re||this.transform.pitch>0,ue),fe=S*he.perspectiveRatio,me=(g.x1*h+y.x-g.padding)*fe+he.point.x,Le=(g.y1*h+y.y-g.padding)*fe+he.point.y,Oe=(g.x2*h+y.x+g.padding)*fe+he.point.x,Ne=(g.y2*h+y.y+g.padding)*fe+he.point.y,Je=he.perspectiveRatio<=.55||he.occluded;return!this.isInsideGrid(me,Le,Oe,Ne)||!b&&this.grid.hitTest(me,Le,Oe,Ne,P)||Je?{box:[],offscreen:!1,occluded:he.occluded}:{box:[me,Le,Oe,Ne],offscreen:this.isOffscreen(me,Le,Oe,Ne),occluded:!1}}placeCollisionCircles(o,h,g,y,b,S,C,P,O,j,X,re,ae,ue,he){let fe=[],me=this.transform.elevation,Le=o.getProjection(),Oe=me?me.getAtTileOffsetFunc(he,this.transform.center.lat,this.transform.worldSize,Le):null,Ne=new i.P(g.tileAnchorX,g.tileAnchorY),{x:Je,y:Ke,z:Pe}=Le.projectTilePoint(Ne.x,Ne.y,he.canonical);if(Oe){let[Ut,ft,kt]=Oe(Ne);Je+=Ut,Ke+=ft,Pe+=kt}let Be=Le.name==="globe",je=this.projectAndGetPerspectiveRatio(C,Je,Ke,Pe,he,Be||!!me||this.transform.pitch>0,Le),{perspectiveRatio:at}=je,yt=(X?S/at:S*at)/i.bN,qe=eo(Je,Ke,Pe,P),bt=je.signedDistanceFromCamera>0?os(yt,b,g.lineOffsetX*yt,g.lineOffsetY*yt,!1,qe,Ne,g,y,P,{},me&&!X?Oe:null,X&&!!me,Le,he,X):null,Ct=!1,Ht=!1,qt=!0;if(bt&&!je.occluded){let Ut=.5*ae*at+ue,ft=new i.P(-100,-100),kt=new i.P(this.screenRightBoundary,this.screenBottomBoundary),jt=new sd,{first:di,last:pi}=bt,Ai=di.path.length,mi=[];for(let Li=Ai-1;Li>=1;Li--)mi.push(di.path[Li]);for(let Li=1;Li<pi.path.length;Li++)mi.push(pi.path[Li]);let Yt=2.5*Ut;O&&(mi=mi.map(([Li,pr,nr],Ir)=>(Oe&&!Be&&(nr=Oe(Ir<Ai-1?di.tilePath[Ai-1-Ir]:pi.tilePath[Ir-Ai+2])[2]),eo(Li,pr,nr,O))),mi.some(Li=>Li[3]<=0)&&(mi=[]));let Nt=[];if(mi.length>0){let Li=1/0,pr=-1/0,nr=1/0,Ir=-1/0;for(let Ur of mi)Li=Math.min(Li,Ur[0]),nr=Math.min(nr,Ur[1]),pr=Math.max(pr,Ur[0]),Ir=Math.max(Ir,Ur[1]);pr>=ft.x&&Li<=kt.x&&Ir>=ft.y&&nr<=kt.y&&(Nt=[mi.map(Ur=>new i.P(Ur[0],Ur[1]))],(Li<ft.x||pr>kt.x||nr<ft.y||Ir>kt.y)&&(Nt=i.cF(Nt,ft.x,ft.y,kt.x,kt.y)))}for(let Li of Nt){jt.reset(Li,.25*Ut);let pr=0;pr=jt.length<=.5*Ut?1:Math.ceil(jt.paddedLength/Yt)+1;for(let nr=0;nr<pr;nr++){let Ir=nr/Math.max(pr-1,1),Ur=jt.lerp(Ir),un=Ur.x+bl,ir=Ur.y+bl;fe.push(un,ir,Ut,0);let tn=un-Ut,bn=ir-Ut,cn=un+Ut,Pr=ir+Ut;if(qt=qt&&this.isOffscreen(tn,bn,cn,Pr),Ht=Ht||this.isInsideGrid(tn,bn,cn,Pr),!h&&this.grid.hitTestCircle(un,ir,Ut,re)&&(Ct=!0,!j))return{circles:[],offscreen:!1,collisionDetected:Ct,occluded:!1}}}}return{circles:!j&&Ct||!Ht?[]:fe,offscreen:qt,collisionDetected:Ct,occluded:je.occluded}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let h=[],g=1/0,y=1/0,b=-1/0,S=-1/0;for(let j of o){let X=new i.P(j.x+bl,j.y+bl);g=Math.min(g,X.x),y=Math.min(y,X.y),b=Math.max(b,X.x),S=Math.max(S,X.y),h.push(X)}let C=this.grid.query(g,y,b,S).concat(this.ignoredGrid.query(g,y,b,S)),P={},O={};for(let j of C){let X=j.key;if(P[X.bucketInstanceId]===void 0&&(P[X.bucketInstanceId]={}),P[X.bucketInstanceId][X.featureIndex])continue;let re=[new i.P(j.x1,j.y1),new i.P(j.x2,j.y1),new i.P(j.x2,j.y2),new i.P(j.x1,j.y2)];i.cG(h,re)&&(P[X.bucketInstanceId][X.featureIndex]=!0,O[X.bucketInstanceId]===void 0&&(O[X.bucketInstanceId]=[]),O[X.bucketInstanceId].push(X.featureIndex))}return O}insertCollisionBox(o,h,g,y,b){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:y,collisionGroupID:b},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,h,g,y,b){let S=h?this.ignoredGrid:this.grid,C={bucketInstanceId:g,featureIndex:y,collisionGroupID:b};for(let P=0;P<o.length;P+=4)S.insertCircle(C,o[P],o[P+1],o[P+2])}projectAndGetPerspectiveRatio(o,h,g,y,b,S,C){let P=[h,g,y,1],O=!1;y||this.transform.pitch>0?(i.aA.transformMat4(P,P,o),this.fogState&&b&&C.name!=="globe"&&(O=function(re,ae,ue,he,fe,me){let Le=me.calculateFogTileMatrix(fe),Oe=[ae,ue,he];return i._.transformMat4(Oe,Oe,Le),En(re,i._.length(Oe),me.pitch,me._fov)}(this.fogState,h,g,y,b.toUnwrapped(),this.transform)>.9)):ss(P,P,o);let j=P[3];return{point:new i.P((P[0]/j+1)/2*this.transform.width+bl,(-P[1]/j+1)/2*this.transform.height+bl),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(C)/j*.5,1.5),signedDistanceFromCamera:j,occluded:S&&P[2]>j||O}}isOffscreen(o,h,g,y){return g<bl||o>=this.screenRightBoundary||y<bl||h>this.screenBottomBoundary}isInsideGrid(o,h,g,y){return g>=0&&o<this.gridRightBoundary&&y>=0&&h<this.gridBottomBoundary}getViewportMatrix(){let o=i.ad.identity([]);return i.ad.translate(o,o,[-100,-100,0]),o}}class I{constructor(o,h,g,y){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?h:-h))):y&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class L{constructor(o,h,g,y,b,S=!1){this.text=new I(o?o.text:null,h,g,b),this.icon=new I(o?o.icon:null,h,y,b),this.clipped=S}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Y{constructor(o,h,g,y=!1){this.text=o,this.icon=h,this.skipFade=g,this.clipped=y}}class ce{constructor(){this.invProjMatrix=i.ad.create(),this.viewportMatrix=i.ad.create(),this.circles=[]}}class Se{constructor(o,h,g,y,b){this.bucketInstanceId=o,this.featureIndex=h,this.sourceLayerIndex=g,this.bucketIndex=y,this.tileID=b}}class Re{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){let h=++this.maxGroupID;this.collisionGroups[o]={ID:h,predicate:g=>g.collisionGroupID===h}}return this.collisionGroups[o]}}function ze(m,o,h,g,y){let{horizontalAlign:b,verticalAlign:S}=i.bQ(m),C=-(b-.5)*o,P=-(S-.5)*h,O=i.bP(m,g);return new i.P(C+O[0]*y,P+O[1]*y)}function He(m,o,h,g,y){let b=new i.P(m,o);return h&&b._rotate(g?y:-y),b}class Xe{constructor(o,h,g,y,b,S){this.transform=o.clone(),this.projection=o.projection.name,this.collisionIndex=new sp(this.transform,b),this.buildingIndex=S,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new Re(g),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,h,g,y){let b=g.getBucket(h),S=g.latestFeatureIndex;if(!b||!S||h.fqid!==b.layerIds[0])return;let C=b.layers[0].layout,P=g.collisionBoxArray,O=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),j=g.tileSize/i.a3,X=g.tileID.toUnwrapped();this.transform.setProjection(b.projection);let re=(ae=g.tileID,ue=b.getProjection(),he=this.transform,ue.name===this.projection?he.calculateProjMatrix(ae.toUnwrapped()):Zs(he,ue,ae));var ae,ue,he;let fe=C.get("text-pitch-alignment")==="map",me=C.get("text-rotation-alignment")==="map";h.compileFilter();let Le=h.dynamicFilter(),Oe=h.dynamicFilterNeedsFeature(),Ne=this.transform.calculatePixelsToTileUnitsMatrix(g),Je=Rl(re,g.tileID.canonical,fe,me,this.transform,b.getProjection(),Ne),Ke=null;if(fe){let je=cc(re,g.tileID.canonical,fe,me,this.transform,b.getProjection(),Ne);Ke=i.ad.multiply([],this.transform.labelPlaneMatrix,je)}let Pe=null;Le&&g.latestFeatureIndex&&(Pe={unwrappedTileID:X,dynamicFilter:Le,dynamicFilterNeedsFeature:Oe,featureIndex:g.latestFeatureIndex}),this.retainedQueryData[b.bucketInstanceId]=new Se(b.bucketInstanceId,S,b.sourceLayerIndex,b.index,g.tileID);let Be={bucket:b,layout:C,posMatrix:re,textLabelPlaneMatrix:Je,labelToScreenMatrix:Ke,clippingData:Pe,scale:O,textPixelRatio:j,holdingForFade:g.holdingForFade(),collisionBoxArray:P,partiallyEvaluatedTextSize:i.aD(b.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:i.aD(b.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(y)for(let je of b.sortKeyRanges){let{sortKey:at,symbolInstanceStart:yt,symbolInstanceEnd:qe}=je;o.push({sortKey:at,symbolInstanceStart:yt,symbolInstanceEnd:qe,parameters:Be})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:Be})}attemptAnchorPlacement(o,h,g,y,b,S,C,P,O,j,X,re,ae,ue,he,fe,me,Le){let{textOffset0:Oe,textOffset1:Ne,crossTileID:Je}=re,Ke=[Oe,Ne],Pe=ze(o,g,y,Ke,b),Be=this.collisionIndex.placeCollisionBox(ue,b,h,He(Pe.x,Pe.y,S,C,this.transform.angle),X,P,O,j.predicate);if(fe){let je=ue.getSymbolInstanceIconSize(Le,this.transform.zoom,re.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ue,je,fe,He(Pe.x,Pe.y,S,C,this.transform.angle),X,P,O,j.predicate).box.length===0)return}if(Be.box.length>0){let je;return this.prevPlacement&&this.prevPlacement.variableOffsets[Je]&&this.prevPlacement.placements[Je]&&this.prevPlacement.placements[Je].text&&(je=this.prevPlacement.variableOffsets[Je].anchor),this.variableOffsets[Je]={textOffset:Ke,width:g,height:y,anchor:o,textScale:b,prevAnchor:je},this.markUsedJustification(ue,o,re,he),ue.allowVerticalPlacement&&(this.markUsedOrientation(ue,he,re),this.placedOrientations[Je]=he),{shift:Pe,placedGlyphBoxes:Be}}}placeLayerBucketPart(o,h,g,y){let{bucket:b,layout:S,posMatrix:C,textLabelPlaneMatrix:P,labelToScreenMatrix:O,clippingData:j,textPixelRatio:X,holdingForFade:re,collisionBoxArray:ae,partiallyEvaluatedTextSize:ue,partiallyEvaluatedIconSize:he,collisionGroup:fe}=o.parameters,me=S.get("text-optional"),Le=S.get("icon-optional"),Oe=S.get("text-allow-overlap"),Ne=S.get("icon-allow-overlap"),Je=S.get("text-rotation-alignment")==="map",Ke=S.get("text-pitch-alignment")==="map",Pe=S.get("symbol-z-order")==="viewport-y",Be=S.get("symbol-z-elevate");this.transform.setProjection(b.projection);let je=Oe&&(Ne||!b.hasIconData()||Le),at=Ne&&(Oe||!b.hasTextData()||me);!b.collisionArrays&&ae&&b.deserializeCollisionBoxes(ae),g&&y&&b.updateCollisionDebugBuffers(this.transform.zoom,ae);let yt=(qe,bt,Ct)=>{let{crossTileID:Ht,numVerticalGlyphVertices:qt}=qe;if(j){let cn={zoom:this.transform.zoom,pitch:this.transform.pitch},Pr=null;if(j.dynamicFilterNeedsFeature){let or=this.retainedQueryData[b.bucketInstanceId];Pr=j.featureIndex.loadFeature({featureIndex:qe.featureIndex,bucketIndex:or.bucketIndex,sourceLayerIndex:or.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,j.dynamicFilter)(cn,Pr,this.retainedQueryData[b.bucketInstanceId].tileID.canonical,new i.P(qe.tileAnchorX,qe.tileAnchorY),this.transform.calculateDistanceTileData(j.unwrappedTileID)))return this.placements[Ht]=new Y(!1,!1,!1,!0),void h.add(Ht)}if(h.has(Ht))return;if(re)return void(this.placements[Ht]=new Y(!1,!1,!1));let Ut=!1,ft=!1,kt=!0,jt=!1,di=!1,pi=null,Ai={box:null,offscreen:null,occluded:null},mi={box:null,offscreen:null,occluded:null},Yt=null,Nt=null,Li=null,pr=0,nr=0,Ir=0;Ct.textFeatureIndex?pr=Ct.textFeatureIndex:qe.useRuntimeCollisionCircles&&(pr=qe.featureIndex),Ct.verticalTextFeatureIndex&&(nr=Ct.verticalTextFeatureIndex);let Ur=cn=>{cn.tileID=this.retainedQueryData[b.bucketInstanceId].tileID;let Pr=this.transform.elevation;cn.elevation=qe.zOffset+(Pr?Pr.getAtTileOffset(cn.tileID,cn.tileAnchorX,cn.tileAnchorY):0)},un=Ct.textBox;if(un){Ur(un);let cn=or=>{let Fn=i.aE.horizontal;if(b.allowVerticalPlacement&&!or&&this.prevPlacement){let zn=this.prevPlacement.placedOrientations[Ht];zn&&(this.placedOrientations[Ht]=zn,Fn=zn,this.markUsedOrientation(b,Fn,qe))}return Fn},Pr=(or,Fn)=>{if(b.allowVerticalPlacement&&qt>0&&Ct.verticalTextBox){for(let zn of b.writingModes)if(zn===i.aE.vertical?(Ai=Fn(),mi=Ai):Ai=or(),Ai&&Ai.box&&Ai.box.length)break}else Ai=or()};if(S.get("text-variable-anchor")){let or=S.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ht]){let pn=this.prevPlacement.variableOffsets[Ht];or.indexOf(pn.anchor)>0&&(or=or.filter(Gt=>Gt!==pn.anchor),or.unshift(pn.anchor))}let Fn=(pn,Gt,_i)=>{let aa=b.getSymbolInstanceTextSize(ue,qe,this.transform.zoom,bt),rn=(pn.x2-pn.x1)*aa+2*pn.padding,xt=(pn.y2-pn.y1)*aa+2*pn.padding,Tl=qe.hasIconTextFit&&!Ne?Gt:null;Tl&&Ur(Tl);let Vo={box:[],offscreen:!1,occluded:!1},xs=Oe?2*or.length:or.length;for(let bo=0;bo<xs;++bo){let Ns=this.attemptAnchorPlacement(or[bo%or.length],pn,rn,xt,aa,Je,Ke,X,C,fe,bo>=or.length,qe,bt,b,_i,Tl,ue,he);if(Ns&&(Vo=Ns.placedGlyphBoxes,Vo&&Vo.box&&Vo.box.length)){Ut=!0,pi=Ns.shift;break}}return Vo};Pr(()=>Fn(un,Ct.iconBox,i.aE.horizontal),()=>{let pn=Ct.verticalTextBox;return pn&&Ur(pn),b.allowVerticalPlacement&&!(Ai&&Ai.box&&Ai.box.length)&&qt>0&&pn?Fn(pn,Ct.verticalIconBox,i.aE.vertical):{box:null,offscreen:null,occluded:null}}),Ai&&(Ut=Ai.box,kt=Ai.offscreen,jt=Ai.occluded);let zn=cn(!(!Ai||!Ai.box));if(!Ut&&this.prevPlacement){let pn=this.prevPlacement.variableOffsets[Ht];pn&&(this.variableOffsets[Ht]=pn,this.markUsedJustification(b,pn.anchor,qe,zn))}}else{let or=(Fn,zn)=>{let pn=b.getSymbolInstanceTextSize(ue,qe,this.transform.zoom,bt),Gt=this.collisionIndex.placeCollisionBox(b,pn,Fn,new i.P(0,0),Oe,X,C,fe.predicate);return Gt&&Gt.box&&Gt.box.length&&(this.markUsedOrientation(b,zn,qe),this.placedOrientations[Ht]=zn),Gt};Pr(()=>or(un,i.aE.horizontal),()=>{let Fn=Ct.verticalTextBox;return b.allowVerticalPlacement&&qt>0&&Fn?(Ur(Fn),or(Fn,i.aE.vertical)):{box:null,offscreen:null,occluded:null}}),cn(!!(Ai&&Ai.box&&Ai.box.length))}}if(Yt=Ai,Ut=Yt&&Yt.box&&Yt.box.length>0,kt=Yt&&Yt.offscreen,jt=Yt&&Yt.occluded,qe.useRuntimeCollisionCircles){let cn=b.text.placedSymbolArray.get(qe.centerJustifiedTextSymbolIndex>=0?qe.centerJustifiedTextSymbolIndex:qe.verticalPlacedTextSymbolIndex),Pr=i.aF(b.textSizeData,ue,cn),or=S.get("text-padding");Nt=this.collisionIndex.placeCollisionCircles(b,Oe,cn,b.lineVertexArray,b.glyphOffsetArray,Pr,C,P,O,g,Ke,fe.predicate,qe.collisionCircleDiameter*Pr/i.bN,or,this.retainedQueryData[b.bucketInstanceId].tileID),Ut=Oe||Nt.circles.length>0&&!Nt.collisionDetected,kt=kt&&Nt.offscreen,jt=Nt.occluded}if(Ct.iconFeatureIndex&&(Ir=Ct.iconFeatureIndex),Ct.iconBox){let cn=Pr=>{Ur(Pr);let or=qe.hasIconTextFit&&pi?He(pi.x,pi.y,Je,Ke,this.transform.angle):new i.P(0,0),Fn=b.getSymbolInstanceIconSize(he,this.transform.zoom,qe.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(b,Fn,Pr,or,Ne,X,C,fe.predicate)};mi&&mi.box&&mi.box.length&&Ct.verticalIconBox?(Li=cn(Ct.verticalIconBox),ft=Li.box.length>0):(Li=cn(Ct.iconBox),ft=Li.box.length>0),kt=kt&&Li.offscreen,di=Li.occluded}let ir=me||qe.numHorizontalGlyphVertices===0&&qt===0,tn=Le||qe.numIconVertices===0;if(ir||tn?tn?ir||(ft=ft&&Ut):Ut=ft&&Ut:ft=Ut=ft&&Ut,Ut&&Yt&&Yt.box&&this.collisionIndex.insertCollisionBox(Yt.box,S.get("text-ignore-placement"),b.bucketInstanceId,mi&&mi.box&&nr?nr:pr,fe.ID),ft&&Li&&this.collisionIndex.insertCollisionBox(Li.box,S.get("icon-ignore-placement"),b.bucketInstanceId,Ir,fe.ID),Nt&&(Ut&&this.collisionIndex.insertCollisionCircles(Nt.circles,S.get("text-ignore-placement"),b.bucketInstanceId,pr,fe.ID),g)){let cn=b.bucketInstanceId,Pr=this.collisionCircleArrays[cn];Pr===void 0&&(Pr=this.collisionCircleArrays[cn]=new ce);for(let or=0;or<Nt.circles.length;or+=4)Pr.circles.push(Nt.circles[or+0]),Pr.circles.push(Nt.circles[or+1]),Pr.circles.push(Nt.circles[or+2]),Pr.circles.push(Nt.collisionDetected?1:0)}let bn=b.projection.name!=="globe";je=je&&(bn||!jt),at=at&&(bn||!di),this.placements[Ht]=new Y(Ut||je,ft||at,kt||b.justReloaded),h.add(Ht)};if(Be&&this.buildingIndex&&(this.buildingIndex.updateZOffset(b,this.retainedQueryData[b.bucketInstanceId].tileID),b.updateZOffset()),Pe){let qe=b.getSortedSymbolIndexes(this.transform.angle);for(let bt=qe.length-1;bt>=0;--bt){let Ct=qe[bt];yt(b.symbolInstances.get(Ct),Ct,b.collisionArrays[Ct])}b.hasAnyZOffset&&i.w(`${b.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(b.hasAnyZOffset){let qe=b.getSortedIndexesByZOffset();for(let bt=0;bt<qe.length;++bt){let Ct=qe[bt];yt(b.symbolInstances.get(Ct),Ct,b.collisionArrays[Ct])}}else for(let qe=o.symbolInstanceStart;qe<o.symbolInstanceEnd;qe++)yt(b.symbolInstances.get(qe),qe,b.collisionArrays[qe]);if(g&&b.bucketInstanceId in this.collisionCircleArrays){let qe=this.collisionCircleArrays[b.bucketInstanceId];i.ad.invert(qe.invProjMatrix,C),qe.viewportMatrix=this.collisionIndex.getViewportMatrix()}b.justReloaded=!1}markUsedJustification(o,h,g,y){let{leftJustifiedTextSymbolIndex:b,centerJustifiedTextSymbolIndex:S,rightJustifiedTextSymbolIndex:C,verticalPlacedTextSymbolIndex:P,crossTileID:O}=g,j=i.cJ(h),X=y===i.aE.vertical?P:j==="left"?b:j==="center"?S:j==="right"?C:-1;b>=0&&(o.text.placedSymbolArray.get(b).crossTileID=X>=0&&b!==X?0:O),S>=0&&(o.text.placedSymbolArray.get(S).crossTileID=X>=0&&S!==X?0:O),C>=0&&(o.text.placedSymbolArray.get(C).crossTileID=X>=0&&C!==X?0:O),P>=0&&(o.text.placedSymbolArray.get(P).crossTileID=X>=0&&P!==X?0:O)}markUsedOrientation(o,h,g){let y=h===i.aE.horizontal||h===i.aE.horizontalOnly?h:0,b=h===i.aE.vertical?h:0,{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:C,rightJustifiedTextSymbolIndex:P,verticalPlacedTextSymbolIndex:O}=g,j=o.text.placedSymbolArray;S>=0&&(j.get(S).placedOrientation=y),C>=0&&(j.get(C).placedOrientation=y),P>=0&&(j.get(P).placedOrientation=y),O>=0&&(j.get(O).placedOrientation=b)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;let h=this.prevPlacement,g=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;let y=h?h.symbolFadeChange(o):1,b=h?h.opacities:{},S=h?h.variableOffsets:{},C=h?h.placedOrientations:{};for(let P in this.placements){let O=this.placements[P],j=b[P];j?(this.opacities[P]=new L(j,y,O.text,O.icon,null,O.clipped),g=g||O.text!==j.text.placed||O.icon!==j.icon.placed):(this.opacities[P]=new L(null,y,O.text,O.icon,O.skipFade,O.clipped),g=g||O.text||O.icon)}for(let P in b){let O=b[P];if(!this.opacities[P]){let j=new L(O,y,!1,!1);j.isHidden()||(this.opacities[P]=j,g=g||O.text.placed||O.icon.placed)}}for(let P in S)this.variableOffsets[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.variableOffsets[P]=S[P]);for(let P in C)this.placedOrientations[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.placedOrientations[P]=C[P]);g?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:o)}updateLayerOpacities(o,h,g,y){let b=new Set;for(let S of h){let C=S.getBucket(o);C&&S.latestFeatureIndex&&o.fqid===C.layerIds[0]&&(this.updateBucketOpacities(C,b,S.collisionBoxArray,g,y,S.tileID),C.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(C,S.tileID),C.updateZOffset()))}}updateBucketOpacities(o,h,g,y,b,S){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();let C=o.layers[0].layout,P=!!o.layers[0].dynamicFilter(),O=new L(null,0,!1,!1,!0),j=C.get("text-allow-overlap"),X=C.get("icon-allow-overlap"),re=C.get("text-variable-anchor"),ae=C.get("text-rotation-alignment")==="map",ue=C.get("text-pitch-alignment")==="map",he=new L(null,0,j&&(X||!o.hasIconData()||C.get("icon-optional")),X&&(j||!o.hasTextData()||C.get("text-optional")),!0);!o.collisionArrays&&g&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(g);let fe=(Le,Oe,Ne)=>{for(let Je=0;Je<Oe/4;Je++)Le.opacityVertexArray.emplaceBack(Ne)},me=0;b&&o.updateReplacement(S,b);for(let Le=0;Le<o.symbolInstances.length;Le++){let Oe=o.symbolInstances.get(Le),{numHorizontalGlyphVertices:Ne,numVerticalGlyphVertices:Je,crossTileID:Ke,numIconVertices:Pe,tileAnchorX:Be,tileAnchorY:je}=Oe,at=h.has(Ke),yt=this.opacities[Ke];at?yt=O:yt||(yt=he,this.opacities[Ke]=yt),h.add(Ke);let qe=Ne>0||Je>0,bt=Pe>0,Ct=this.placedOrientations[Ke],Ht=Ct===i.aE.vertical,qt=Ct===i.aE.horizontal||Ct===i.aE.horizontalOnly;!qe&&!bt||yt.isHidden()||me++;let Ut=!1;if((qe||bt)&&b)for(let ft of o.activeReplacements){if(ft.order<y||ft.order===1/0||!(ft.clipMask&i.cu.Symbol)||ft.min.x>Be||Be>ft.max.x||ft.min.y>je||je>ft.max.y)continue;let kt=i.cH(Be,je,S.canonical,ft.footprintTileId.canonical);if(Ut=i.cI(kt,ft),Ut)break}if(qe){let ft=Ut?ui:It(yt.text);fe(o.text,Ne,Ht?ui:ft),fe(o.text,Je,qt?ui:ft);let kt=yt.text.isHidden(),{leftJustifiedTextSymbolIndex:jt,centerJustifiedTextSymbolIndex:di,rightJustifiedTextSymbolIndex:pi,verticalPlacedTextSymbolIndex:Ai}=Oe,mi=o.text.placedSymbolArray,Yt=kt||Ht?1:0;jt>=0&&(mi.get(jt).hidden=Yt),di>=0&&(mi.get(di).hidden=Yt),pi>=0&&(mi.get(pi).hidden=Yt),Ai>=0&&(mi.get(Ai).hidden=kt||qt?1:0);let Nt=this.variableOffsets[Ke];Nt&&this.markUsedJustification(o,Nt.anchor,Oe,Ct);let Li=this.placedOrientations[Ke];Li&&(this.markUsedJustification(o,"left",Oe,Li),this.markUsedOrientation(o,Li,Oe))}if(bt){let ft=Ut?ui:It(yt.icon),{placedIconSymbolIndex:kt,verticalPlacedIconSymbolIndex:jt}=Oe,di=o.icon.placedSymbolArray,pi=yt.icon.isHidden()?1:0;kt>=0&&(fe(o.icon,Pe,Ht?ui:ft),di.get(kt).hidden=pi),jt>=0&&(fe(o.icon,Oe.numVerticalIconVertices,qt?ui:ft),di.get(jt).hidden=pi)}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){let ft=o.collisionArrays[Le];if(ft){let kt=new i.P(0,0),jt=!0;if(ft.textBox||ft.verticalTextBox){if(re){let pi=this.variableOffsets[Ke];pi?(kt=ze(pi.anchor,pi.width,pi.height,pi.textOffset,pi.textScale),ae&&kt._rotate(ue?this.transform.angle:-this.transform.angle)):jt=!1}P&&(jt=!yt.clipped),ft.textBox&&tt(o.textCollisionBox.collisionVertexArray,yt.text.placed,!jt||Ht,kt.x,kt.y),ft.verticalTextBox&&tt(o.textCollisionBox.collisionVertexArray,yt.text.placed,!jt||qt,kt.x,kt.y)}let di=jt&&!!(!qt&&ft.verticalIconBox);ft.iconBox&&tt(o.iconCollisionBox.collisionVertexArray,yt.icon.placed,di,Oe.hasIconTextFit?kt.x:0,Oe.hasIconTextFit?kt.y:0),ft.verticalIconBox&&tt(o.iconCollisionBox.collisionVertexArray,yt.icon.placed,!di,Oe.hasIconTextFit?kt.x:0,Oe.hasIconTextFit?kt.y:0)}}}if(o.fullyClipped=me===0,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){let Le=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=Le.invProjMatrix,o.placementViewportMatrix=Le.viewportMatrix,o.collisionCircleArray=Le.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,h){let g=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*g>o}setStale(){this.stale=!0}}function tt(m,o,h,g,y){m.emplaceBack(o?1:0,h?1:0,g||0,y||0),m.emplaceBack(o?1:0,h?1:0,g||0,y||0),m.emplaceBack(o?1:0,h?1:0,g||0,y||0),m.emplaceBack(o?1:0,h?1:0,g||0,y||0)}let St=Math.pow(2,25),rt=Math.pow(2,24),Vt=Math.pow(2,17),Ft=Math.pow(2,16),xi=Math.pow(2,9),ii=Math.pow(2,8),Et=Math.pow(2,1);function It(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;let o=m.placed?1:0,h=Math.floor(127*m.opacity);return h*St+o*rt+h*Vt+o*Ft+h*xi+o*ii+h*Et+o}let ui=0;class vi{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&o.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(o,h,g,y,b){let S=this._bucketParts;for(;this._currentTileIndex<o.length;)if(h.getBucketParts(S,y,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((C,P)=>C.sortKey-P.sortKey));this._currentPartIndex<S.length;){let C=S[this._currentPartIndex];if(h.placeLayerBucketPart(C,this._seenCrossTileIDs,g,C.symbolInstanceStart===0),this._currentPartIndex++,b())return!0}return!1}}class gi{constructor(o,h,g,y,b,S,C,P,O){this.placement=new Xe(o,b,S,C,P,O),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(o,h,g,y){let b=i.e.now(),S=()=>{let C=i.e.now()-b;return!this._forceFullPlacement&&C>2};for(;this._currentPlacementIndex>=0;){let C=h[o[this._currentPlacementIndex]],P=this.placement.collisionIndex.transform.zoom;if(C.type==="symbol"&&(!C.minzoom||C.minzoom<=P)&&(!C.maxzoom||C.maxzoom>P)){let O=C,j=O.layout.get("symbol-z-elevate"),X=this._inProgressLayer=this._inProgressLayer||new vi(O),re=i.al(C.source,C.scope);if(X.continuePlacement(j?y[re]:g[re],this.placement,this._showCollisionBoxes,C,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}let qi=512/i.a3/2;class Hi{constructor(o,h,g){this.tileID=o,this.bucketInstanceId=g,this.index=new i.cK(h.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];let y=o.canonical.x*i.a3,b=o.canonical.y*i.a3;for(let S=0;S<h.length;S++){let{key:C,crossTileID:P,tileAnchorX:O,tileAnchorY:j}=h.get(S),X=Math.floor((y+O)*qi),re=Math.floor((b+j)*qi);this.index.add(X,re),this.keys.push(C),this.crossTileIDs.push(P)}this.index.finish()}findMatches(o,h,g){let y=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z),b=qi/Math.pow(2,h.canonical.z-this.tileID.canonical.z),S=h.canonical.x*i.a3,C=h.canonical.y*i.a3;for(let P=0;P<o.length;P++){let O=o.get(P);if(O.crossTileID)continue;let{key:j,tileAnchorX:X,tileAnchorY:re}=O,ae=Math.floor((S+X)*b),ue=Math.floor((C+re)*b),he=this.index.range(ae-y,ue-y,ae+y,ue+y);for(let fe of he){let me=this.crossTileIDs[fe];if(this.keys[fe]===j&&!g.has(me)){g.add(me),O.crossTileID=me;break}}}}}class Sr{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Gi{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){let h=Math.round((o-this.lng)/360);if(h!==0)for(let g in this.indexes){let y=this.indexes[g],b={};for(let S in y){let C=y[S];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+h),b[C.tileID.key]=C}this.indexes[g]=b}this.lng=o}addBucket(o,h,g){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let b=0;b<h.symbolInstances.length;b++)h.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]=new Set);let y=this.usedCrossTileIDs[o.overscaledZ];for(let b in this.indexes){let S=this.indexes[b];if(Number(b)>o.overscaledZ)for(let C in S){let P=S[C];P.tileID.isChildOf(o)&&P.findMatches(h.symbolInstances,o,y)}else{let C=S[o.scaledTo(Number(b)).key];C&&C.findMatches(h.symbolInstances,o,y)}}for(let b=0;b<h.symbolInstances.length;b++){let S=h.symbolInstances.get(b);S.crossTileID||(S.crossTileID=g.generate(),y.add(S.crossTileID))}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Hi(o,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(o,h){for(let g of h.crossTileIDs)this.usedCrossTileIDs[o].delete(g)}removeStaleBuckets(o){let h=!1;for(let g in this.indexes){let y=this.indexes[g];for(let b in y)o[y[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,y[b]),delete y[b],h=!0)}return h}}class An{constructor(){this.layerIndexes={},this.crossTileIDs=new Sr,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,h,g,y){let b=this.layerIndexes[o.fqid];b===void 0&&(b=this.layerIndexes[o.fqid]=new Gi);let S=!1,C={};y.name!=="globe"&&b.handleWrapJump(g);for(let P of h){let O=P.getBucket(o);O&&o.fqid===O.layerIds[0]&&(O.bucketInstanceId||(O.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(P.tileID,O,this.crossTileIDs)&&(S=!0),C[O.bucketInstanceId]=!0)}return b.removeStaleBuckets(C)&&(S=!0),S}pruneUnusedLayers(o){let h={};o.forEach(g=>{h[g]=!0});for(let g in this.layerIndexes)h[g]||delete this.layerIndexes[g]}}let Mn=new i.N({data:new i.O(i.L.colorTheme.data)}),Jr=(m,o)=>Ei(m,o&&o.filter(h=>h.identifier!=="source.canvas")),on=i.ah(Rr,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),Zn=i.ah(Rr,["setCenter","setZoom","setBearing","setPitch"]),Bn={version:8,layers:[],sources:{}},Wr={duration:300,delay:0};class Dn extends i.E{constructor(o,h={}){super(),this.map=o,this.scope=h.scope||"",this.globalId=null,this.fragments=[],this.importDepth=h.importDepth||0,this.importsCache=h.importsCache||new Map,this.resolvedImports=h.resolvedImports||new Set,this.transition=i.W({},Wr),this._buildingIndex=new np(this),this.crossTileSymbolIndex=new An,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerIndices=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=h.styleChanges||new Te,this.dispatcher=h.dispatcher?h.dispatcher:new i.bw(i.bx(),this),h.imageManager?this.imageManager=h.imageManager:(this.imageManager=new go,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=h.glyphManager?h.glyphManager:new i.cM(o._requestManager,h.localFontFamily?i.cN.all:h.localIdeographFontFamily?i.cN.ideographs:i.cN.none,h.localFontFamily||h.localIdeographFontFamily),h.modelManager?this.modelManager=h.modelManager:(this.modelManager=new La(o._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this._styleColorTheme={lut:null,lutLoading:!1,colorTheme:null},this._styleColorThemeForScope={},this.options=h.configOptions?h.configOptions:new Map,this._configDependentLayers=h.configDependentLayers?h.configDependentLayers:new Set,this._config=h.config,this._initialConfig=h.initialConfig,this.dispatcher.broadcast("setReferrer",i.cO());let g=this;this._rtlTextPluginCallback=Dn.registerForPluginStateChange(y=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},(b,S)=>{if(i.cP(b),S&&S.every(C=>C))for(let C in g._sourceCaches){let P=g._sourceCaches[C],O=P.getSource().type;O!=="vector"&&O!=="geojson"||P.reload()}})}),this.on("data",y=>{if(y.dataType!=="source"||y.sourceDataType!=="metadata")return;let b=this.getOwnSource(y.sourceId);if(b&&b.vectorLayerIds)for(let S in this._layers){let C=this._layers[S];C.source===b.id&&this._validateLayer(C)}})}load(o){return o?(typeof o=="string"?this.loadURL(o):this.loadJSON(o),this):this}_getGlobalId(o){if(!o)return null;if(typeof o=="string"){if(i.cQ(o))return o;let h=i.cR(o);if(!h.startsWith("http"))try{return new URL(h,location.href).toString()}catch{return h}return h}return`json://${i.cS(JSON.stringify(o))}`}_diffStyle(o,h,g){this.globalId=this._getGlobalId(o);let y=(b,S)=>{try{S(null,this.setState(b,g))}catch(C){S(C,!1)}};if(typeof o=="string"){let b=this.map._requestManager.normalizeStyleURL(o),S=this.map._requestManager.transformRequest(b,i.R.Style);i.g(S,(C,P)=>{C?this.fire(new i.d(C)):P&&y(P,h)})}else typeof o=="object"&&y(o,h)}loadURL(o,h={}){this.fire(new i.f("dataloading",{dataType:"style"}));let g=typeof h.validate=="boolean"?h.validate:!i.cQ(o);this.globalId=this._getGlobalId(o),o=this.map._requestManager.normalizeStyleURL(o,h.accessToken),this.resolvedImports.add(o);let y=this.importsCache.get(o);if(y)return this._load(y,g);let b=this.map._requestManager.transformRequest(o,i.R.Style);this._request=i.g(b,(S,C)=>{if(this._request=null,S)this.fire(new i.d(S));else if(C)return this.importsCache.set(o,C),this._load(C,g)})}loadJSON(o,h={}){this.fire(new i.f("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(o),this._request=i.e.frame(()=>{this._request=null,this._load(o,h.validate!==!1)})}loadEmpty(){this.fire(new i.f("dataloading",{dataType:"style"})),this._load(Bn,!1)}_loadImports(o,h,g){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();let y=[];for(let b of o){let S=this._createFragmentStyle(b),C=new Promise(j=>{S.once("style.import.load",j),S.once("error",j)}).then(()=>this.mergeAll());if(y.push(C),this.resolvedImports.has(b.url)){S.loadEmpty();continue}let P=b.data||this.importsCache.get(b.url);P?(S.loadJSON(P,{validate:h}),this._isInternalStyle(P)&&(S.globalId=null)):b.url?S.loadURL(b.url,{validate:h}):S.loadEmpty();let O={style:S,id:b.id,config:b.config};if(g){let j=this.fragments.findIndex(({id:X})=>X===g);this.fragments=this.fragments.slice(0,j).concat(O).concat(this.fragments.slice(j))}else this.fragments.push(O)}return Promise.allSettled(y)}getImportGlobalIds(o=this,h=new Set){for(let g of o.fragments)g.style.globalId&&h.add(g.style.globalId),this.getImportGlobalIds(g.style,h);return[...h.values()]}_createFragmentStyle(o){let h=this.scope?i.al(o.id,this.scope):o.id,g,y=this._initialConfig&&this._initialConfig[h];(o.config||y)&&(g=i.W({},o.config,y));let b=new Dn(this.map,{scope:h,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:g,configOptions:this.options,configDependentLayers:this._configDependentLayers});return b.setEventedParent(this.map,{style:b}),b}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.isRootStyle()}_isInternalStyle(o){return this.isRootStyle()&&(o.fragment||!!o.schema&&o.fragment!==!1)}_load(o,h){let g=o.schema;if(this._isInternalStyle(o)){let S=i.W({},Bn,{imports:[{id:"basemap",data:o,url:""}]});return void this._load(S,h)}if(this.updateConfig(this._config,g),h&&Jr(this,se(o)))return;this._loaded=!0,this.stylesheet=i.cT(o);let y=()=>{for(let O in o.sources)this.addSource(O,o.sources[O],{validate:!1,isInitialLoad:!0});o.sprite?this._loadSprite(o.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(o.glyphs,this.scope);let S=ap(this.stylesheet.layers);if(this._order=S.map(O=>O.id),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){let O=this.stylesheet.lights[0];this.light=new wi(O.properties,O.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new wi(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(let O of S){let j=i.cY(O,this.scope,this._styleColorTheme.lut,this.options);j.isConfigDependent&&this._configDependentLayers.add(j.fqid),j.setEventedParent(this,{layer:{id:j.id}}),this._layers[j.id]=j,this._serializedLayers[j.id]=j.serialize();let X=this.getOwnLayerSourceCache(j),re=!!this.directionalLight&&this.directionalLight.shadowsEnabled();X&&j.canCastShadows()&&re&&(X.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);let C=this.stylesheet.terrain;C&&(this.checkCanvasFingerprintNoise(),this.terrainSetForDrapingOnly()||this._createTerrain(C,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.f("data",{dataType:"style"}));let P=this.isRootStyle();o.imports?this._loadImports(o.imports,h).then(()=>{this._reloadImports(),this.fire(new i.f(P?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new i.f(P?"style.load":"style.import.load")))},b=this.stylesheet["color-theme"];if(this._styleColorTheme.colorTheme=b,b){let S=this._evaluateColorThemeData(b);this._loadColorTheme(S).then(()=>{y()}).catch(C=>{i.w(`Couldn't load color theme from the stylesheet: ${C}`),y()})}else this._styleColorTheme.lut=null,y()}isRootStyle(){return this.importDepth===0}mergeAll(){let o,h,g,y,b,S,C,P,O={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(j=>{if(j.stylesheet){if(j.light!=null&&(o=j.light),j.stylesheet.lights)for(let X of j.stylesheet.lights)X.type==="ambient"&&j.ambientLight!=null&&(h=j.ambientLight),X.type==="directional"&&j.directionalLight!=null&&(g=j.directionalLight);y=this._prioritizeTerrain(y,j.terrain,j.stylesheet.terrain),j.stylesheet.fog&&j.fog!=null&&(b=j.fog),j.stylesheet.camera!=null&&(P=j.stylesheet.camera),j.stylesheet.projection!=null&&(S=j.stylesheet.projection),j.stylesheet.transition!=null&&(C=j.stylesheet.transition),O[j.scope]=j._styleColorTheme}}),this.light=o,this.ambientLight=h,this.directionalLight=g,this.fog=b,this._styleColorThemeForScope=O,y===null?delete this.terrain:this.terrain=y,this.camera=P||{"camera-projection":"perspective"},this.projection=S||{name:"mercator"},this.transition=i.W({},Wr,C),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(o){let h=g=>{for(let y of g.fragments)h(y.style);o(g)};h(this)}_prioritizeTerrain(o,h,g){let y=o&&o.drapeRenderMode===0;return g===null?h&&h.drapeRenderMode===0?h:y?o:null:h!=null&&(!o||y||h&&h.drapeRenderMode===1)?h:o}mergeTerrain(){let o;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(h=>{o=this._prioritizeTerrain(o,h.terrain,h.stylesheet.terrain)}),o===null?delete this.terrain:this.terrain=o}mergeProjection(){let o;this.forEachFragmentStyle(h=>{h.stylesheet.projection!=null&&(o=h.stylesheet.projection)}),this.projection=o||{name:"mercator"}}mergeSources(){let o={},h={},g={};this.forEachFragmentStyle(y=>{for(let b in y._sourceCaches){let S=i.al(b,y.scope);o[S]=y._sourceCaches[b]}for(let b in y._otherSourceCaches){let S=i.al(b,y.scope);h[S]=y._otherSourceCaches[b]}for(let b in y._symbolSourceCaches){let S=i.al(b,y.scope);g[S]=y._symbolSourceCaches[b]}}),this._mergedSourceCaches=o,this._mergedOtherSourceCaches=h,this._mergedSymbolSourceCaches=g}mergeLayers(){let o={},h=[],g={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(S=>{for(let C of S._order){let P=S._layers[C];if(P.type==="slot"){let O=i.cU(C);if(o[O])continue;o[O]=[]}P.slot&&o[P.slot]?o[P.slot].push(P):h.push(P)}}),this._mergedOrder=[],this._clipLayerIndices=[];let y=0,b=(S=[])=>{for(let C of S)if(C.type==="slot"){let P=i.cU(C.id);o[P]&&b(o[P]),this._mergedSlots.push(P)}else{let P=i.al(C.id,C.scope);this._mergedOrder.push(P),g[P]=C,C.is3D()&&(this._has3DLayers=!0),C.type==="circle"&&(this._hasCircleLayers=!0),C.type==="symbol"&&(this._hasSymbolLayers=!0),C.type==="clip"&&this._clipLayerIndices.push(y),y++}};b(h),this._mergedLayers=g,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(o){return this.stylesheet.camera=i.W({},this.stylesheet.camera,o),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(o){return o.data?function(h,g,y){let b=i.W({},g);for(let C of Object.keys(i.L.colorTheme))b[C]===void 0&&(b[C]=i.L.colorTheme[C].default);let S=new i.U(Mn,h,new Map(y));return S.setTransitionOrValue(b,y),S.untransitioned().possiblyEvaluate(new i.X(0))}(this.scope,o,this.options).get("data"):null}_loadColorTheme(o){return this._styleColorTheme.lutLoading=!0,new Promise((h,g)=>{let y="data:image/png;base64,";if(o.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void h();o.startsWith(y)||(o=y+o);let b="mapbox-reserved-lut",S=new Image;S.src=o,S.onerror=()=>{this._styleColorTheme.lutLoading=!1,g(new Error("Failed to load image data"))},S.onload=()=>{this._styleColorTheme.lutLoading=!1;let{width:C,height:P,data:O}=i.e.getImageData(S);if(P>32)return void g(new Error("The height of the image must be less than or equal to 32 pixels."));if(C!==P*P)return void g(new Error("The width of the image must be equal to the height squared."));this.getImage(b)&&this.removeImage(b),this.addImage(b,{data:new i.i({width:C,height:P},O),pixelRatio:1,sdf:!1,version:0});let j=this.imageManager.getImage(b,this.scope);j?(this._styleColorTheme.lut={image:j.data,data:o},h()):g(new Error("Missing LUT image."))}})}getLut(o){let h=this._styleColorThemeForScope[o];return h?h.lut:null}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(o){this._spriteRequest=function(h,g,y){let b,S,C,P=i.e.devicePixelRatio>1?"@2x":"",O=i.g(g.transformRequest(g.normalizeSpriteURL(h,P,".json"),i.R.SpriteJSON),(re,ae)=>{O=null,C||(C=re,b=ae,X())}),j=i.h(g.transformRequest(g.normalizeSpriteURL(h,P,".png"),i.R.SpriteImage),(re,ae)=>{j=null,C||(C=re,S=ae,X())});function X(){if(C)y(C);else if(b&&S){let re=i.e.getImageData(S),ae={};for(let ue in b){let{width:he,height:fe,x:me,y:Le,sdf:Oe,pixelRatio:Ne,stretchX:Je,stretchY:Ke,content:Pe}=b[ue],Be=new i.i({width:he,height:fe});i.i.copy(re,Be,{x:me,y:Le},{x:0,y:0},{width:he,height:fe},null),ae[ue]={data:Be,pixelRatio:Ne,sdf:Oe,stretchX:Je,stretchY:Ke,content:Pe}}y(null,ae)}}return{cancel(){O&&(O.cancel(),O=null),j&&(j.cancel(),j=null)}}}(o,this.map._requestManager,(h,g)=>{if(this._spriteRequest=null,h)this.fire(new i.d(h));else if(g)for(let y in g)this.imageManager.addImage(y,this.scope,g[y]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.f("data",{dataType:"style"}))})}_validateLayer(o){let h=this.getOwnSource(o.source);if(!h)return;let g=o.sourceLayer;g&&(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(g)===-1)&&this.fire(new i.d(new Error(`Source layer "${g}" does not exist on source "${h.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(let o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(let{style:o}of this.fragments)if(!o.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((o,h)=>{let g=this.fragments[h];return g&&g.style&&(o.data=g.style.serialize()),o})}_serializeSources(){let o={};for(let h in this._sourceCaches){let g=this._sourceCaches[h].getSource();o[g.id]||(o[g.id]=g.serialize())}return o}_serializeLayers(o){let h=[];for(let g of o){let y=this._layers[g];y&&y.type!=="custom"&&h.push(y.serialize())}return h}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(let o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(let o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(o){return!!this.terrain&&o.isDraped(this.getLayerSourceCache(o))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(o){let h=this.getOwnLayer(o);if(h)return h;this.fire(new i.d(new Error(`The layer '${o}' does not exist in the map's style.`)))}_checkSource(o){let h=this.getOwnSource(o);if(h)return h;this.fire(new i.d(new Error(`The source '${o}' does not exist in the map's style.`)))}update(o){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(o),this.directionalLight&&this.directionalLight.recalculate(o);let h=this.calculateLightsBrightness();o.brightness=h||0,h!==this._brightness&&(this._brightness=h,this.dispatcher.broadcast("setBrightness",h));let g=this._changes.isDirty(),y=!1;if(this._changes.isDirty()){let S=this._changes.getLayerUpdatesByScope();for(let C in S){let{updatedIds:P,removedIds:O}=S[C];(P||O)&&(this._updateWorkerLayers(C,P,O),y=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(o),this.light&&this.light.updateTransitions(o),this.ambientLight&&this.ambientLight.updateTransitions(o),this.directionalLight&&this.directionalLight.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this._changes.reset()}let b={};for(let S in this._mergedSourceCaches){let C=this._mergedSourceCaches[S];b[S]=C.used,C.used=!1,C.tileCoverLift=0}for(let S of this._mergedOrder){let C=this._mergedLayers[S];if(C.recalculate(o,this._availableImages),!C.isHidden(o.zoom)){let P=this.getLayerSourceCache(C);P&&(P.used=!0,P.tileCoverLift=Math.max(P.tileCoverLift,C.tileCoverLift()))}if(!this._precompileDone&&this._shouldPrecompile)for(let P=C.minzoom||0;P<(C.maxzoom||25.5);P++){let O=this.map.painter;if(O){let j=C.getProgramIds();if(!j)continue;for(let X of j){let re=C.getDefaultProgramParams(X,o.zoom,this._styleColorTheme.lut);re&&(O.style=this,this.fog&&(O._fogVisible=!0,re.overrideFog=!0,O.getOrCreateProgram(X,re)),O._fogVisible=!1,re.overrideFog=!1,O.getOrCreateProgram(X,re),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(re.overrideRtt=!0,O.getOrCreateProgram(X,re)))}}}}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&y&&this.mergeLayers();for(let S in b){let C=this._mergedSourceCaches[S];b[S]!==C.used&&C.getSource().fire(new i.f("data",{sourceDataType:"visibility",dataType:"source",sourceId:C.getSource().id}))}this.light&&this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),g&&this.fire(new i.f("data",{dataType:"style"}))}_updateTilesForChangedImages(){let o=this._changes.getUpdatedImages();if(o.length){for(let h in this._sourceCaches)this._sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],o);this._changes.resetUpdatedImages()}}_updateWorkerLayers(o,h,g){let y=this.getFragmentStyle(o);y&&this.dispatcher.broadcast("updateLayers",{layers:h?y._serializeLayers(h):[],scope:o,removedIds:g||[],options:y.options})}setState(o,h){if(this._checkLoaded(),Jr(this,se(o)))return!1;(o=i.cT(o)).layers=ap(o.layers);let g=function(S,C){if(!S)return[{command:Rr.setStyle,args:[C]}];let P=[];try{if(!x(S.version,C.version))return[{command:Rr.setStyle,args:[C]}];if(x(S.center,C.center)||P.push({command:Rr.setCenter,args:[C.center]}),x(S.zoom,C.zoom)||P.push({command:Rr.setZoom,args:[C.zoom]}),x(S.bearing,C.bearing)||P.push({command:Rr.setBearing,args:[C.bearing]}),x(S.pitch,C.pitch)||P.push({command:Rr.setPitch,args:[C.pitch]}),x(S.sprite,C.sprite)||P.push({command:Rr.setSprite,args:[C.sprite]}),x(S.glyphs,C.glyphs)||P.push({command:Rr.setGlyphs,args:[C.glyphs]}),x(S.imports,C.imports)||function(ae=[],ue=[],he){ue=ue||[];let fe=(ae=ae||[]).map(tf),me=ue.map(tf),Le=ae.reduce(Au,{}),Oe=ue.reduce(Au,{}),Ne=fe.slice(),Je,Ke,Pe,Be;for(Je=0,Ke=0;Je<fe.length;Je++)Pe=fe[Je],Oe.hasOwnProperty(Pe)?Ke++:(he.push({command:Rr.removeImport,args:[Pe]}),Ne.splice(Ne.indexOf(Pe,Ke),1));for(Je=0,Ke=0;Je<me.length;Je++)Pe=me[me.length-1-Je],Ne[Ne.length-1-Je]!==Pe&&(Le.hasOwnProperty(Pe)?(he.push({command:Rr.removeImport,args:[Pe]}),Ne.splice(Ne.lastIndexOf(Pe,Ne.length-Ke),1)):Ke++,Be=Ne[Ne.length-Je],he.push({command:Rr.addImport,args:[Oe[Pe],Be]}),Ne.splice(Ne.length-Je,0,Pe));for(let je of ue){let at=Le[je.id];at&&!x(at,je)&&he.push({command:Rr.updateImport,args:[je.id,je]})}}(S.imports,C.imports,P),x(S.transition,C.transition)||P.push({command:Rr.setTransition,args:[C.transition]}),x(S.light,C.light)||P.push({command:Rr.setLight,args:[C.light]}),x(S.fog,C.fog)||P.push({command:Rr.setFog,args:[C.fog]}),x(S.projection,C.projection)||P.push({command:Rr.setProjection,args:[C.projection]}),x(S.lights,C.lights)||P.push({command:Rr.setLights,args:[C.lights]}),x(S.camera,C.camera)||P.push({command:Rr.setCamera,args:[C.camera]}),!x(S["color-theme"],C["color-theme"]))return[{command:Rr.setStyle,args:[C]}];let O={},j=[];(function(ae,ue,he,fe){let me;for(me in ue=ue||{},ae=ae||{})ae.hasOwnProperty(me)&&(ue.hasOwnProperty(me)||um(me,he,fe));for(me in ue){if(!ue.hasOwnProperty(me))continue;let Le=ue[me];ae.hasOwnProperty(me)?x(ae[me],Le)||(ae[me].type==="geojson"&&Le.type==="geojson"&&D0(ae,ue,me)?he.push({command:Rr.setGeoJSONSourceData,args:[me,Le.data]}):M0(me,ue,he,fe)):Tc(me,ue,he)}})(S.sources,C.sources,j,O);let X=[];S.layers&&S.layers.forEach(ae=>{ae.source&&O[ae.source]?P.push({command:Rr.removeLayer,args:[ae.id]}):X.push(ae)});let re=S.terrain;re&&O[re.source]&&(P.push({command:Rr.setTerrain,args:[void 0]}),re=void 0),P=P.concat(j),x(re,C.terrain)||P.push({command:Rr.setTerrain,args:[C.terrain]}),function(ae,ue,he){ue=ue||[];let fe=(ae=ae||[]).map(tf),me=ue.map(tf),Le=ae.reduce(Au,{}),Oe=ue.reduce(Au,{}),Ne=fe.slice(),Je=Object.create(null),Ke,Pe,Be,je,at,yt,qe;for(Ke=0,Pe=0;Ke<fe.length;Ke++)Be=fe[Ke],Oe.hasOwnProperty(Be)?Pe++:(he.push({command:Rr.removeLayer,args:[Be]}),Ne.splice(Ne.indexOf(Be,Pe),1));for(Ke=0,Pe=0;Ke<me.length;Ke++)Be=me[me.length-1-Ke],Ne[Ne.length-1-Ke]!==Be&&(Le.hasOwnProperty(Be)?(he.push({command:Rr.removeLayer,args:[Be]}),Ne.splice(Ne.lastIndexOf(Be,Ne.length-Pe),1)):Pe++,yt=Ne[Ne.length-Ke],he.push({command:Rr.addLayer,args:[Oe[Be],yt]}),Ne.splice(Ne.length-Ke,0,Be),Je[Be]=!0);for(Ke=0;Ke<me.length;Ke++)if(Be=me[Ke],je=Le[Be],at=Oe[Be],!Je[Be]&&!x(je,at))if(x(je.source,at.source)&&x(je["source-layer"],at["source-layer"])&&x(je.type,at.type)){for(qe in od(je.layout,at.layout,he,Be,null,Rr.setLayoutProperty),od(je.paint,at.paint,he,Be,null,Rr.setPaintProperty),x(je.slot,at.slot)||he.push({command:Rr.setSlot,args:[Be,at.slot]}),x(je.filter,at.filter)||he.push({command:Rr.setFilter,args:[Be,at.filter]}),x(je.minzoom,at.minzoom)&&x(je.maxzoom,at.maxzoom)||he.push({command:Rr.setLayerZoomRange,args:[Be,at.minzoom,at.maxzoom]}),je)je.hasOwnProperty(qe)&&qe!=="layout"&&qe!=="paint"&&qe!=="filter"&&qe!=="metadata"&&qe!=="minzoom"&&qe!=="maxzoom"&&qe!=="slot"&&(qe.indexOf("paint.")===0?od(je[qe],at[qe],he,Be,qe.slice(6),Rr.setPaintProperty):x(je[qe],at[qe])||he.push({command:Rr.setLayerProperty,args:[Be,qe,at[qe]]}));for(qe in at)at.hasOwnProperty(qe)&&!je.hasOwnProperty(qe)&&qe!=="layout"&&qe!=="paint"&&qe!=="filter"&&qe!=="metadata"&&qe!=="minzoom"&&qe!=="maxzoom"&&qe!=="slot"&&(qe.indexOf("paint.")===0?od(je[qe],at[qe],he,Be,qe.slice(6),Rr.setPaintProperty):x(je[qe],at[qe])||he.push({command:Rr.setLayerProperty,args:[Be,qe,at[qe]]}))}else he.push({command:Rr.removeLayer,args:[Be]}),yt=Ne[Ne.lastIndexOf(Be)+1],he.push({command:Rr.addLayer,args:[at,yt]})}(X,C.layers,P)}catch(O){console.warn("Unable to compute style diff:",O),P=[{command:Rr.setStyle,args:[C]}]}return P}(this.serialize(),o).filter(S=>!(S.command in Zn));if(g.length===0)return!1;let y=g.filter(S=>!(S.command in on));if(y.length>0)throw new Error(`Unimplemented: ${y.map(S=>S.command).join(", ")}.`);let b=[];return g.forEach(S=>{b.push(this[S.command].apply(this,S.args))}),h&&Promise.all(b).then(h),this.stylesheet=o,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(o,h){return this.getImage(o)?this.fire(new i.d(new Error("An image with this name already exists."))):(this.imageManager.addImage(o,this.scope,h),this._afterImageUpdated(o),this)}updateImage(o,h){this.imageManager.updateImage(o,this.scope,h)}getImage(o){return this.imageManager.getImage(o,this.scope)}removeImage(o){return this.getImage(o)?(this.imageManager.removeImage(o,this.scope),this._afterImageUpdated(o),this):this.fire(new i.d(new Error("No image with this name exists.")))}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(o),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new i.f("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(o,h,g={}){return this._checkLoaded(),this._validate(Qt,`models.${o}`,h,null,g)||(this.modelManager.addModel(o,h,this.scope),this._changes.setDirty()),this}hasModel(o){return this.modelManager.hasModel(o,this.scope)}removeModel(o){return this.hasModel(o)?(this.modelManager.removeModel(o,this.scope),this):this.fire(new i.d(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(o,h,g={}){if(this._checkLoaded(),this.getOwnSource(o)!==void 0)throw new Error(`There is already a source with ID "${o}".`);if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(le,`sources.${o}`,h,null,g))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);let y=ln(o,h,this.dispatcher,this);y.scope=this.scope,y.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(y.id),source:y.serialize(),sourceId:y.id}));let b=S=>{let C=(S?"symbol:":"other:")+y.id,P=i.al(C,this.scope),O=this._sourceCaches[C]=new i.bv(P,y,S);(S?this._symbolSourceCaches:this._otherSourceCaches)[y.id]=O,O.onAdd(this.map)};b(!1),h.type!=="vector"&&h.type!=="geojson"||b(!0),y.onAdd&&y.onAdd(this.map),g.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(o){this._checkLoaded();let h=this.getOwnSource(o);if(!h)throw new Error("There is no source with this ID");for(let y in this._layers)if(this._layers[y].source===o)return this.fire(new i.d(new Error(`Source "${o}" cannot be removed while layer "${y}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===o)return this.fire(new i.d(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));let g=this.getOwnSourceCaches(o);for(let y of g){let b=i.cU(y.id);delete this._sourceCaches[b],this._changes.discardSourceCacheUpdate(y.id),y.fire(new i.f("data",{sourceDataType:"metadata",dataType:"source",sourceId:y.getSource().id})),y.setEventedParent(null),y.clearTiles()}return delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],this.mergeSources(),h.setEventedParent(null),h.onRemove&&h.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(o,h){this._checkLoaded(),this.getOwnSource(o).setData(h),this._changes.setDirty()}getOwnSource(o){let h=this.getOwnSourceCache(o);return h&&h.getSource()}getOwnSources(){let o=[];for(let h in this._otherSourceCaches){let g=this.getOwnSourceCache(h);g&&o.push(g.getSource())}return o}areTilesLoaded(){let o=this._mergedSourceCaches;for(let h in o){let g=o[h]._tiles;for(let y in g){let b=g[y];if(b.state!=="loaded"&&b.state!=="errored")return!1}}return!0}setLights(o){if(this._checkLoaded(),!o)return delete this.ambientLight,void delete this.directionalLight;let h=this._getTransitionParameters();for(let y of o){if(this._validate(Ze,"lights",y))return;switch(y.type){case"ambient":if(this.ambientLight){let b=this.ambientLight;b.set(y),b.updateTransitions(h)}else this.ambientLight=new nc(y,sr,this.scope,this.options);break;case"directional":if(this.directionalLight){let b=this.directionalLight;b.set(y),b.updateTransitions(h)}else this.directionalLight=new nc(y,Cs,this.scope,this.options)}}let g=new i.X(this.z||0,h);this.ambientLight&&this.ambientLight.recalculate(g),this.directionalLight&&this.directionalLight.recalculate(g),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){let o=this.directionalLight,h=this.ambientLight;if(!o||!h)return;let g=X=>.2126*(X[0]<=.03928?X[0]/12.92:Math.pow((X[0]+.055)/1.055,2.4))+.7152*(X[1]<=.03928?X[1]/12.92:Math.pow((X[1]+.055)/1.055,2.4))+.0722*(X[2]<=.03928?X[2]/12.92:Math.pow((X[2]+.055)/1.055,2.4)),y=o.properties.get("color").toRenderColor(null).toArray01(),b=o.properties.get("intensity"),S=o.properties.get("direction"),C=1-i.ac(S.x,S.y,S.z)[2]/90,P=g(y)*b*C,O=h.properties.get("color").toRenderColor(null).toArray01(),j=h.properties.get("intensity");return(P+g(O)*j)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;let o=[];return this.directionalLight&&o.push(this.directionalLight.get()),this.ambientLight&&o.push(this.ambientLight.get()),o}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(o){if(!o)return this;if(i.cV(o)){let h=i.cW(o),g=this.fragments.find(({id:b})=>b===h);if(!g)throw new Error(`Style import not found: ${o}`);let y=i.cU(o);return g.style.getFragmentStyle(y)}{let h=this.fragments.find(({id:g})=>g===o);if(!h)throw new Error(`Style import not found: ${o}`);return h.style}}getConfigProperty(o,h){let g=this.getFragmentStyle(o);if(!g)return null;let y=i.al(h,g.scope),b=g.options.get(y),S=b?b.value||b.default:null;return S?S.serialize():null}setConfigProperty(o,h,g){let y=this.getFragmentStyle(o);if(!y)return;let b=y.stylesheet.schema;if(!b||!b[h])return;let S=i.y(g);if(S.result!=="success")return void Jr(this,S.value);let C=S.value.expression,P=i.al(h,y.scope),O=y.options.get(P);if(!O)return;let j,{minValue:X,maxValue:re,stepValue:ae,type:ue,values:he}=b[h],fe=i.y(b[h].default);fe.result==="success"&&(j=fe.value.expression),j?(this.options.set(P,Yl(In({},O),{value:C,default:j,minValue:X,maxValue:re,stepValue:ae,type:ue,values:he})),this.updateConfigDependencies()):this.fire(new i.d(new Error(`No schema defined for the config option "${h}" in the "${o}" fragment.`)))}getConfig(o){let h=this.getFragmentStyle(o);if(!h)return null;let g=h.stylesheet.schema;if(!g)return null;let y={};for(let b in g){let S=i.al(b,h.scope),C=h.options.get(S),P=C?C.value||C.default:null;y[b]=P?P.serialize():null}return y}setConfig(o,h){let g=this.getFragmentStyle(o);g&&(g.updateConfig(h,g.stylesheet.schema),this.updateConfigDependencies())}getSchema(o){let h=this.getFragmentStyle(o);return h?h.stylesheet.schema:null}setSchema(o,h){let g=this.getFragmentStyle(o);g&&(g.stylesheet.schema=h,g.updateConfig(g._config,h),this.updateConfigDependencies())}updateConfig(o,h){if(this._config=o,o||h)if(h)for(let g in h){let y,b,S=i.y(h[g].default);if(S.result==="success"&&(y=S.value.expression),o&&o[g]!==void 0){let re=i.y(o[g]);re.result==="success"&&(b=re.value.expression)}let{minValue:C,maxValue:P,stepValue:O,type:j,values:X}=h[g];if(y){let re=i.al(g,this.scope);this.options.set(re,{default:y,value:b,minValue:C,maxValue:P,stepValue:O,type:j,values:X})}else this.fire(new i.d(new Error(`No schema defined for config option "${g}".`)))}else this.fire(new i.d(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(){for(let o of this._configDependentLayers){let h=this.getLayer(o);h&&(h.possiblyEvaluateVisibility(),this._updateLayer(h))}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.forEachFragmentStyle(o=>{if(o._styleColorTheme.colorTheme){let h=o._evaluateColorThemeData(o._styleColorTheme.colorTheme);(!o._styleColorTheme.lut||o._styleColorTheme.lut&&h!==o._styleColorTheme.lut.data)&&o.setColorTheme(o._styleColorTheme.colorTheme)}}),this._changes.setDirty()}addLayer(o,h,g={}){this._checkLoaded();let y=o.id;if(this._layers[y])return void this.fire(new i.d(new Error(`Layer with id "${y}" already exists on this map`)));let b;if(o.type==="custom"){if(Jr(this,i.cX(o)))return;b=i.cY(o,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof o.source=="object"&&(this.addSource(y,o.source),o=i.cT(o),o=i.W(o,{source:y})),this._validate(nt,`layers.${y}`,o,{arrayIndex:-1},g))return;b=i.cY(o,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(b),b.setEventedParent(this,{layer:{id:y}}),this._serializedLayers[b.id]=b.serialize()}b.isConfigDependent&&this._configDependentLayers.add(b.fqid);let S=this._order.length;if(h){let j=this._order.indexOf(h);if(j===-1)return void this.fire(new i.d(new Error(`Layer with id "${h}" does not exist on this map.`)));b.slot===this._layers[h].slot?S=j:i.w(`Layer with id "${h}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(S,0,y),this._layerOrderChanged=!0,this._layers[y]=b;let C=this.getOwnLayerSourceCache(b),P=!!this.directionalLight&&this.directionalLight.shadowsEnabled();C&&b.canCastShadows()&&P&&(C.castsShadows=!0);let O=this._changes.getRemovedLayer(b);if(O&&b.source&&C&&b.type!=="custom"){this._changes.discardLayerRemoval(b);let j=i.al(b.source,b.scope);O.type!==b.type?this._changes.updateSourceCache(j,"clear"):(this._changes.updateSourceCache(j,"reload"),C.pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map),b.scope=this.scope,this.mergeLayers()}moveLayer(o,h){this._checkLoaded();let g=this._checkLayer(o);if(!g||o===h)return;let y=this._order.indexOf(o);this._order.splice(y,1);let b=this._order.length;if(h){let S=this._order.indexOf(h);if(S===-1)return void this.fire(new i.d(new Error(`Layer with id "${h}" does not exist on this map.`)));g.slot===this._layers[h].slot?b=S:i.w(`Layer with id "${h}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(b,0,o),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(o){this._checkLoaded();let h=this._checkLayer(o);if(!h)return;h.setEventedParent(null);let g=this._order.indexOf(o);this._order.splice(g,1),delete this._layers[o],delete this._serializedLayers[o],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(h.fqid),this._changes.removeLayer(h);let y=this.getOwnLayerSourceCache(h);if(y&&y.castsShadows){let b=!1;for(let S in this._layers)if(this._layers[S].source===h.source&&this._layers[S].canCastShadows()){b=!0;break}y.castsShadows=b}h.onRemove&&h.onRemove(this.map),this.mergeLayers()}getOwnLayer(o){return this._layers[o]}hasLayer(o){return o in this._mergedLayers}hasLayerType(o){for(let h in this._layers)if(this._layers[h].type===o)return!0;return!1}setLayerZoomRange(o,h,g){this._checkLoaded();let y=this._checkLayer(o);y&&(y.minzoom===h&&y.maxzoom===g||(h!=null&&(y.minzoom=h),g!=null&&(y.maxzoom=g),this._updateLayer(y)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(o,h){this._checkLoaded();let g=this._checkLayer(o);g&&g.slot!==h&&(g.slot=h,this._updateLayer(g))}setFilter(o,h,g={}){this._checkLoaded();let y=this._checkLayer(o);if(y&&!x(y.filter,h))return h==null?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(dt,`layers.${y.id}.filter`,h,{layerType:y.type},g)||(y.filter=i.cT(h),this._updateLayer(y)))}getFilter(o){let h=this._checkLayer(o);if(h)return i.cT(h.filter)}setLayoutProperty(o,h,g,y={}){this._checkLoaded();let b=this._checkLayer(o);if(b&&!x(b.getLayoutProperty(h),g)){if(g!=null&&(!y||y.validate!==!1)&&Jr(b,ti.call(se,{key:`layers.${o}.layout.${h}`,layerType:b.type,objectKey:h,value:g,styleSpec:i.L,style:{glyphs:!0,sprite:!0}})))return;b.setLayoutProperty(h,g),b.isConfigDependent&&this._configDependentLayers.add(b.fqid),this._updateLayer(b)}}getLayoutProperty(o,h){let g=this._checkLayer(o);if(g)return g.getLayoutProperty(h)}setPaintProperty(o,h,g,y={}){this._checkLoaded();let b=this._checkLayer(o);if(!b||x(b.getPaintProperty(h),g)||g!=null&&(!y||y.validate!==!1)&&Jr(b,Pt.call(se,{key:`layers.${o}.paint.${h}`,layerType:b.type,objectKey:h,value:g,styleSpec:i.L})))return;let S=b.setPaintProperty(h,g);b.isConfigDependent&&this._configDependentLayers.add(b.fqid),S&&this._updateLayer(b),this._changes.updatePaintProperties(b)}getPaintProperty(o,h){let g=this._checkLayer(o);if(g)return g.getPaintProperty(h)}setFeatureState(o,h){this._checkLoaded();let g=o.source,y=o.sourceLayer,b=this._checkSource(g);if(!b)return;let S=b.type;if(S==="geojson"&&y)return void this.fire(new i.d(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(S==="vector"&&!y)return void this.fire(new i.d(new Error("The sourceLayer parameter must be provided for vector source types.")));o.id===void 0&&this.fire(new i.d(new Error("The feature id parameter must be provided.")));let C=this.getOwnSourceCaches(g);for(let P of C)P.setFeatureState(y,o.id,h)}removeFeatureState(o,h){this._checkLoaded();let g=o.source,y=this._checkSource(g);if(!y)return;let b=y.type,S=b==="vector"?o.sourceLayer:void 0;if(b==="vector"&&!S)return void this.fire(new i.d(new Error("The sourceLayer parameter must be provided for vector source types.")));if(h&&typeof o.id!="string"&&typeof o.id!="number")return void this.fire(new i.d(new Error("A feature id is required to remove its specific state property.")));let C=this.getOwnSourceCaches(g);for(let P of C)P.removeFeatureState(S,o.id,h)}getFeatureState(o){this._checkLoaded();let h=o.source,g=o.sourceLayer,y=this._checkSource(h);if(y){if(y.type!=="vector"||g)return o.id===void 0&&this.fire(new i.d(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(h)[0].getFeatureState(g,o.id);this.fire(new i.d(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(o){return this.stylesheet.transition=i.W({},this.stylesheet.transition,o),this.transition=this.stylesheet.transition,this}getTransition(){return i.W({},this.stylesheet.transition)}serialize(){this._checkLoaded();let o=this.getTerrain(),h=o&&this.terrain&&this.terrain.scope===this.scope?o:this.stylesheet.terrain;return i.cZ({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:h,fog:this.stylesheet.fog,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},g=>g!==void 0)}_updateLayer(o){this._changes.updateLayer(o);let h=this.getLayerSourceCache(o),g=i.al(o.source,o.scope),y=this._changes.getUpdatedSourceCaches();o.source&&!y[g]&&h&&h.getSource().type!=="raster"&&(this._changes.updateSourceCache(g,"reload"),h.pause()),o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){let h=C=>this._mergedLayers[C].type==="fill-extrusion"||this._mergedLayers[C].type==="model",g=this.order,y={},b=[];for(let C=g.length-1;C>=0;C--){let P=g[C];if(h(P)){y[P]=C;for(let O of o){let j=O[P];if(j)for(let X of j)b.push(X)}}}b.sort((C,P)=>P.intersectionZ-C.intersectionZ);let S=[];for(let C=g.length-1;C>=0;C--){let P=g[C];if(h(P))for(let O=b.length-1;O>=0;O--){let j=b[O].feature;if(j.layer&&y[j.layer.id]<C)break;S.push(j),b.pop()}else for(let O of o){let j=O[P];if(j)for(let X of j)S.push(X.feature)}}return S}queryRenderedFeatures(o,h,g){h&&h.filter&&this._validate(dt,"queryRenderedFeatures.filter",h.filter,null,h),h.scope=this.scope,h.availableImages=this._availableImages,h.serializedLayers=this._serializedLayers;let y={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new i.d(new Error("parameters.layers must be an Array."))),[];for(let O of h.layers){let j=this._mergedLayers[O];if(!j)return this.fire(new i.d(new Error(`The layer '${O}' does not exist in the map's style and cannot be queried for features.`))),[];y[j.source]=!0}}let b=[],S=h.serializedLayers||{},C=h&&h.layers?h.layers.some(O=>{let j=this.getLayer(O);return j&&j.is3D()}):this.has3DLayers(),P=Co.createFromScreenPoints(o,g);for(let O in this._mergedSourceCaches){let j=this._mergedSourceCaches[O].getSource();if(!j||j.scope!==h.scope)continue;let X=this._mergedSourceCaches[O].getSource().id;h.layers&&!y[X]||b.push(ef(this._mergedSourceCaches[O],this._mergedLayers,S,P,h,g,C,!!this.map._showQueryGeometry))}return this.placement&&b.push(function(O,j,X,re,ae,ue,he){let fe={},me=ue.queryRenderedSymbols(re),Le=[];for(let Oe of Object.keys(me).map(Number))Le.push(he[Oe]);Le.sort(Hl);for(let Oe of Le){let Ne=Oe.featureIndex.lookupSymbolFeatures(me[Oe.bucketInstanceId],j,Oe.bucketIndex,Oe.sourceLayerIndex,ae.filter,ae.layers,ae.availableImages,O);for(let Je in Ne){let Ke=fe[Je]=fe[Je]||[],Pe=Ne[Je];Pe.sort((Be,je)=>{let at=Oe.featureSortOrder;if(at){let yt=at.indexOf(Be.featureIndex);return at.indexOf(je.featureIndex)-yt}return je.featureIndex-Be.featureIndex});for(let Be of Pe)Ke.push(Be)}}for(let Oe in fe)fe[Oe].forEach(Ne=>{let Je=Ne.feature,Ke=X(O[Oe]);if(!Ke)return;let Pe=Ke.getFeatureState(Je.layer["source-layer"],Je.id);Je.source=Je.layer.source,Je.layer["source-layer"]&&(Je.sourceLayer=Je.layer["source-layer"]),Je.state=Pe});return fe}(this._mergedLayers,S,this.getLayerSourceCache.bind(this),P.screenGeometry,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(o,h){h&&h.filter&&this._validate(dt,"querySourceFeatures.filter",h.filter,null,h);let g=this.getOwnSourceCaches(o),y=[];for(let b of g)y=y.concat(Yc(b,h));return y}addSourceType(o,h,g){return Dn.getSourceType(o)?g(new Error(`A source type called "${o}" already exists.`)):(Dn.setSourceType(o,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:h.workerSourceURL},g):g(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(o,h,g={}){this._checkLoaded();let y=this.light.getLight(),b=!1;for(let C in o)if(!x(o[C],y[C])){b=!0;break}if(!b)return;let S=this._getTransitionParameters();this.light.setLight(o,h,g),this.light.updateTransitions(S)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.e.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(o,h=1){if(this._checkLoaded(),!o)return this.terrainSetForDrapingOnly()&&h!==0||delete this.terrain,o===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let g=o,y=o.source==null;if(h===1){if(this.disableElevatedTerrain)return;if(typeof g.source=="object"){let C="terrain-dem-src";this.addSource(C,g.source),g=i.cT(g),g=i.W(g,{source:C})}let b=i.W({},g),S={};if(this.terrain&&y){b.source=this.terrain.get().source;let C=this.terrain?this.getFragmentStyle(this.terrain.scope):null;C&&(S.style=C.serialize())}if(this._validate(ke,"terrain",b,S))return}if(!this.terrain||this.terrain.scope!==this.scope&&!y||this.terrain&&h!==this.terrain.drapeRenderMode){if(!g)return;this._createTerrain(g,h),this.fire(new i.f("data",{dataType:"style"}))}else{let b=this.terrain,S=b.get();for(let C of Object.keys(i.L.terrain))!g.hasOwnProperty(C)&&i.L.terrain[C].default&&(g[C]=i.L.terrain[C].default);for(let C in o)if(!x(o[C],S[C])){b.set(o,this.options),this.stylesheet.terrain=o;let P=this._getTransitionParameters({duration:0});b.updateTransitions(P),this.fire(new i.f("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){let h=this.fog=new Zh(o,this.map.transform,this.scope,this.options);this.stylesheet.fog=h.get();let g=this._getTransitionParameters({duration:0});h.updateTransitions(g)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(let o of this.map._markers)o._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){let h=this.fog;if(!x(h.get(),o)){h.set(o,this.options),this.stylesheet.fog=h.get();let g=this._getTransitionParameters({duration:0});h.updateTransitions(g)}}else this._createFog(o);this._markersNeedUpdate=!0}setColorTheme(o){this._checkLoaded();let h=()=>{for(let y in this._layers)this._layers[y].lut=this._styleColorTheme.lut;for(let y in this._sourceCaches)this._sourceCaches[y].clearTiles()};if(this._styleColorTheme.colorTheme=o,!o)return this._styleColorTheme.lut=null,void h();let g=this._evaluateColorThemeData(o);this._loadColorTheme(g).then(()=>{h()}).catch(y=>{i.w(`Couldn't set color theme: ${y}`)})}_getTransitionParameters(o){return{now:i.e.now(),transition:i.W(this.transition,o)}}updateDrapeFirstLayers(){if(!this.terrain)return;let o=[],h=[];for(let g in this._mergedLayers)this.isLayerDraped(this._mergedLayers[g])?o.push(g):h.push(g);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...h)}_createTerrain(o,h){let g=this.terrain=new dr(o,h,this.scope,this.options);h===1&&(this.stylesheet.terrain=o),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();let y=this._getTransitionParameters({duration:0});g.updateTransitions(y)}_force3DLayerUpdate(){for(let o in this._layers){let h=this._layers[o];h.type==="fill-extrusion"&&this._updateLayer(h)}}_forceSymbolLayerUpdate(){for(let o in this._layers){let h=this._layers[o];h.type==="symbol"&&this._updateLayer(h)}}_validate(o,h,g,y,b={}){if(b&&b.validate===!1)return!1;let S=i.W({},this.serialize());return Jr(this,o.call(se,i.W({key:h,style:S,value:g,styleSpec:i.L},y)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.c_.off("pluginStateChange",this._rtlTextPluginCallback);for(let o in this._mergedLayers)this._mergedLayers[o].setEventedParent(null);for(let o in this._mergedSourceCaches)this._mergedSourceCaches[o].clearTiles(),this._mergedSourceCaches[o].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(o){let h=this.getSourceCaches(o);for(let g of h)g.clearTiles()}clearSources(){for(let o in this._mergedSourceCaches)this._mergedSourceCaches[o].clearTiles()}reloadSource(o){let h=this.getSourceCaches(o);for(let g of h)g.resume(),g.reload()}reloadSources(){for(let o of this.getSources())o.reload&&o.reload()}updateSources(o){let h;this.directionalLight&&(h=dc(this.directionalLight));for(let g in this._mergedSourceCaches)this._mergedSourceCaches[g].update(o,void 0,void 0,h)}_generateCollisionBoxes(){for(let o in this._sourceCaches){let h=this._sourceCaches[o];h.resume(),h.reload()}}_updatePlacement(o,h,g,y,b,S,C=!1){let P=!1,O=!1,j={},X={};for(let ae of this._mergedOrder){let ue=this._mergedLayers[ae];if(ue.type!=="symbol")continue;let he=i.al(ue.source,ue.scope),fe=j[he];if(!fe){let Le=this.getLayerSourceCache(ue);if(!Le)continue;let Oe=Le.getRenderableIds(!0).map(Ne=>Le.getTileByID(Ne));X[he]=Oe.slice(),fe=j[he]=Oe.sort((Ne,Je)=>Je.tileID.overscaledZ-Ne.tileID.overscaledZ||(Ne.tileID.isLessThan(Je.tileID)?-1:1))}let me=this.crossTileSymbolIndex.addLayer(ue,fe,h.center.lng,h.projection);P=P||me}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),C=C||this._layerOrderChanged||y===0,this._layerOrderChanged&&this.fire(new i.f("neworder")),(C||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.e.now(),h.zoom))&&(this.pauseablePlacement=new gi(h,this._mergedOrder,C,g,y,b,this.placement,this.fog&&h.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,j,X),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.e.now()),O=!0),P&&this.pauseablePlacement.placement.setStale()),O||P){this._buildingIndex.onNewFrame(h.zoom);for(let ae=0;ae<this._mergedOrder.length;ae++){let ue=this._mergedLayers[this._mergedOrder[ae]];if(ue.type!=="symbol")continue;let he=this.isLayerClipped(ue)&&this._clipLayerIndices.some(fe=>ae<fe);this.placement.updateLayerOpacities(ue,j[i.al(ue.source,ue.scope)],ae,he?S:null)}}let re=!1;for(let ae of this._mergedOrder){let ue=this._mergedLayers[ae];if(ue.type!=="symbol")continue;let he=j[i.al(ue.source,ue.scope)];for(let fe of he){let me=fe.getBucket(ue);me&&fe.latestFeatureIndex&&ue.fqid===me.layerIds[0]&&(re=me.updateOcclusionOpacities(o.context,o.symbolParams,o._dt)||re)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.e.now())||re,occlusionQueryBasedOpacityChanged:re}}_releaseSymbolFadeTiles(){for(let o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}addImport(o,h){this._checkLoaded();let g=this.stylesheet.imports=this.stylesheet.imports||[];if(g.findIndex(({id:b})=>b===o.id)!==-1)return void this.fire(new i.d(new Error(`Import with id '${o.id}' already exists in the map's style.`)));if(!h)return g.push(o),this._loadImports([o],!0);let y=g.findIndex(({id:b})=>b===h);return y===-1&&this.fire(new i.d(new Error(`Import with id "${h}" does not exist on this map.`))),this.stylesheet.imports=g.slice(0,y).concat(o).concat(g.slice(y)),this._loadImports([o],!0,h)}updateImport(o,h){this._checkLoaded();let g=this.stylesheet.imports||[],y=this.getImportIndex(o);return y===-1?this:typeof h=="string"?(this.setImportUrl(o,h),this):(h.url&&h.url!==g[y].url&&this.setImportUrl(o,h.url),x(h.config,g[y].config)||this.setImportConfig(o,h.config),x(h.data,g[y].data)||this.setImportData(o,h.data),this)}moveImport(o,h){this._checkLoaded();let g=this.stylesheet.imports||[],y=this.getImportIndex(o);if(y===-1)return this;let b=this.getImportIndex(h);if(b===-1)return this;let S=g[y],C=this.fragments[y];return g=g.filter(({id:P})=>P!==o),this.fragments=this.fragments.filter(({id:P})=>P!==o),this.stylesheet.imports=g.slice(0,b).concat(S).concat(g.slice(b)),this.fragments=this.fragments.slice(0,b).concat(C).concat(this.fragments.slice(b)),this.mergeLayers(),this}setImportUrl(o,h){this._checkLoaded();let g=this.stylesheet.imports||[],y=this.getImportIndex(o);if(y===-1)return this;g[y].url=h;let b=this.fragments[y];return b.style=this._createFragmentStyle(g[y]),b.style.on("style.import.load",()=>this.mergeAll()),b.style.loadURL(h),this}setImportData(o,h){this._checkLoaded();let g=this.getImportIndex(o),y=this.stylesheet.imports||[];return g===-1?this:h?(this.fragments[g].style.setState(h),this._reloadImports(),this):(delete y[g].data,this.setImportUrl(o,y[g].url))}setImportConfig(o,h){this._checkLoaded();let g=this.getImportIndex(o),y=this.stylesheet.imports||[];if(g===-1)return this;h?y[g].config=h:delete y[g].config;let b=this.fragments[g],S=b.style.stylesheet&&b.style.stylesheet.schema;return b.config=h,b.style.updateConfig(h,S),this.updateConfigDependencies(),this}removeImport(o){this._checkLoaded();let h=this.stylesheet.imports||[],g=this.getImportIndex(o);g!==-1&&(h.splice(g,1),this.fragments[g].style._remove(),this.fragments.splice(g,1),this._reloadImports())}getImportIndex(o){let h=(this.stylesheet.imports||[]).findIndex(g=>g.id===o);return h===-1&&this.fire(new i.d(new Error(`Import '${o}' does not exist in the map's style and cannot be updated.`))),h}getLayer(o){return this._mergedLayers[o]}getSources(){let o=[];for(let h in this._mergedOtherSourceCaches){let g=this._mergedOtherSourceCaches[h];g&&o.push(g.getSource())}return o}getSource(o,h){let g=this.getSourceCache(o,h);return g&&g.getSource()}getLayerSource(o){let h=this.getLayerSourceCache(o);return h&&h.getSource()}getSourceCache(o,h){let g=i.al(o,h);return this._mergedOtherSourceCaches[g]}getLayerSourceCache(o){let h=i.al(o.source,o.scope);return o.type==="symbol"?this._mergedSymbolSourceCaches[h]:this._mergedOtherSourceCaches[h]}getSourceCaches(o){if(o==null)return Object.values(this._mergedSourceCaches);let h=[];return this._mergedOtherSourceCaches[o]&&h.push(this._mergedOtherSourceCaches[o]),this._mergedSymbolSourceCaches[o]&&h.push(this._mergedSymbolSourceCaches[o]),h}updateSourceCaches(){let o=this._changes.getUpdatedSourceCaches();for(let h in o){let g=o[h];g==="reload"?this.reloadSource(h):g==="clear"&&this.clearSource(h)}}updateLayers(o){let h=this._changes.getUpdatedPaintProperties();for(let g of h){let y=this.getLayer(g);y&&y.updateTransitions(o)}}getImages(o,h,g){this.imageManager.getImages(h.icons,h.scope,g),this._updateTilesForChangedImages();let y=b=>{b&&b.setDependencies(h.tileID.key,h.type,h.icons)};y(this._otherSourceCaches[h.source]),y(this._symbolSourceCaches[h.source])}getGlyphs(o,h,g){this.glyphManager.getGlyphs(h.stacks,h.scope,g)}getResource(o,h,g){return i.c$(h,g)}getOwnSourceCache(o){return this._otherSourceCaches[o]}getOwnLayerSourceCache(o){return o.type==="symbol"?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}getOwnSourceCaches(o){let h=[];return this._otherSourceCaches[o]&&h.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&h.push(this._symbolSourceCaches[o]),h}_isSourceCacheLoaded(o){let h=this.getOwnSourceCaches(o);return h.length===0?(this.fire(new i.d(new Error(`There is no source with ID '${o}'`))),!1):h.every(g=>g.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(o,h){if(this._clipLayerIndices.length===0&&o.type!=="fill-extrusion")return!1;let g=o.type==="fill-extrusion"&&o.sourceLayer==="building",y=0;if(o.is3D()){if(g||h&&h.type==="batched-model")return!0;o.type==="model"&&(y=i.cu.Model)}else o.type==="symbol"&&(y=i.cu.Symbol);for(let b of this._clipLayerIndices){let S=this._mergedLayers[this._mergedOrder[b]];if(!S)continue;let C=[];for(let P of S.layout.get("clip-layer-types"))C.push(P==="model"?i.cu.Model:P==="symbol"?i.cu.Symbol:i.cu.FillExtrusion);for(let P of C)if(y&P)return!0}return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(o=>{o.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}function zo(m,o){let h=!1,g=null,y=()=>{g=null,h&&(m(),g=setTimeout(y,o),h=!1)};return()=>(h=!0,g||y(),g)}Dn.getSourceType=function(m){return ur[m]},Dn.setSourceType=function(m,o){ur[m]=o},Dn.registerForPluginStateChange=i.cL;class ao{constructor(o){this._hashName=o&&encodeURIComponent(o),i.bp(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=zo(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,window.addEventListener("hashchange",this._onHashChange,!1),o.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){let o=this._map;if(!o)return"";let h=yo(o);if(this._hashName){let g=this._hashName,y=!1,b=location.hash.slice(1).split("&").map(S=>{let C=S.split("=")[0];return C===g?(y=!0,`${C}=${h}`):S}).filter(S=>S);return y||b.push(`${g}=${h}`),`#${b.join("&")}`}return`#${h}`}_getCurrentHash(){let o=location.hash.replace("#","");if(this._hashName){let h;return o.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(h=g)}),(h&&h[1]||"").split("/")}return o.split("/")}_onHashChange(){let o=this._map;if(!o)return!1;let h=this._getCurrentHash();if(h.length>=3&&!h.some(g=>isNaN(g))){let g=o.dragRotate.isEnabled()&&o.touchZoomRotate.isEnabled()?+(h[3]||0):o.getBearing();return o.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:g,pitch:+(h[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function yo(m,o){let h=m.getCenter(),g=Math.round(100*m.getZoom())/100,y=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,y),S=Math.round(h.lng*b)/b,C=Math.round(h.lat*b)/b,P=m.getBearing(),O=m.getPitch(),j=o?`/${S}/${C}/${g}`:`${g}/${C}/${S}`;return(P||O)&&(j+="/"+Math.round(10*P)/10),O&&(j+=`/${Math.round(O)}`),j}let yn={linearity:.3,easing:i.d0(0,0,.3,1)},fs=i.W({deceleration:2500,maxSpeed:1400},yn),es=i.W({deceleration:20,maxSpeed:1400},yn),qa=i.W({deceleration:1e3,maxSpeed:360},yn),uo=i.W({deceleration:1e3,maxSpeed:90},yn);class $a{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.e.now(),settings:o})}_drainInertiaBuffer(){let o=this._inertiaBuffer,h=i.e.now();for(;o.length>0&&h-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;let h={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(let{settings:b}of this._inertiaBuffer)h.zoom+=b.zoomDelta||0,h.bearing+=b.bearingDelta||0,h.pitch+=b.pitchDelta||0,b.panDelta&&h.pan._add(b.panDelta),b.around&&(h.around=b.around),b.pinchAround&&(h.pinchAround=b.pinchAround);let g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(h.pan.mag()){let b=ps(h.pan.mag(),g,i.W({},fs,o||{}));y.offset=h.pan.mult(b.amount/h.pan.mag()),y.center=this._map.transform.center,Io(y,b)}if(h.zoom){let b=ps(h.zoom,g,es);y.zoom=this._map.transform.zoom+b.amount,Io(y,b)}if(h.bearing){let b=ps(h.bearing,g,qa);y.bearing=this._map.transform.bearing+i.at(b.amount,-179,179),Io(y,b)}if(h.pitch){let b=ps(h.pitch,g,uo);y.pitch=this._map.transform.pitch+b.amount,Io(y,b)}if(y.zoom||y.bearing){let b=h.pinchAround===void 0?h.around:h.pinchAround;y.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),y.noMoveStart=!0,y}}function Io(m,o){(!m.duration||m.duration<o.duration)&&(m.duration=o.duration,m.easing=o.easing)}function ps(m,o,h){let{maxSpeed:g,linearity:y,deceleration:b}=h,S=i.at(m*y/(o/1e3),-g,g),C=Math.abs(S)/(b*y);return{easing:h.easing,duration:1e3*C,amount:S*(C/2)}}class fn extends i.f{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,g,y={}){let b=de(h.getCanvasContainer(),g),S=h.unproject(b);super(o,i.W({point:b,lngLat:S,originalEvent:g},y)),this._defaultPrevented=!1,this.target=h}}class jo extends i.f{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,g){let y=o==="touchend"?g.changedTouches:g.touches,b=De(h.getCanvasContainer(),y),S=b.map(P=>h.unproject(P)),C=b.reduce((P,O,j,X)=>P.add(O.div(X.length)),new i.P(0,0));super(o,{points:b,point:C,lngLats:S,lngLat:h.unproject(C),originalEvent:g}),this._defaultPrevented=!1}}class Gl extends i.f{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,g){super(o,{originalEvent:g}),this._defaultPrevented=!1}}class Kc{constructor(o,h){this._map=o,this._clickTolerance=h.clickTolerance}reset(){this._mousedownPos=void 0}wheel(o){return this._firePreventable(new Gl(o.type,this._map,o))}mousedown(o,h){return this._mousedownPos=h,this._firePreventable(new fn(o.type,this._map,o))}mouseup(o){this._map.fire(new fn(o.type,this._map,o))}preclick(o){let h=i.W({},o);h.type="preclick",this._map.fire(new fn(h.type,this._map,h))}click(o,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||(this.preclick(o),this._map.fire(new fn(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new fn(o.type,this._map,o))}mouseover(o){this._map.fire(new fn(o.type,this._map,o))}mouseout(o){this._map.fire(new fn(o.type,this._map,o))}touchstart(o){return this._firePreventable(new jo(o.type,this._map,o))}touchmove(o){this._map.fire(new jo(o.type,this._map,o))}touchend(o){this._map.fire(new jo(o.type,this._map,o))}touchcancel(o){this._map.fire(new jo(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Js{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(o){this._map.fire(new fn(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new fn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new fn(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ha{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,h){this.isEnabled()&&o.shiftKey&&o.button===0&&(H(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(o,h){if(!this._active)return;let g=h,y=this._startPos,b=this._lastPos;if(!y||!b||b.equals(g)||!this._box&&g.dist(y)<this._clickTolerance)return;this._lastPos=g,this._box||(this._box=F("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));let S=Math.min(y.x,g.x),C=Math.max(y.x,g.x),P=Math.min(y.y,g.y),O=Math.max(y.y,g.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${S}px,${P}px)`,this._box.style.width=C-S+"px",this._box.style.height=O-P+"px")})}mouseupWindow(o,h){if(!this._active)return;let g=this._startPos,y=h;if(g&&o.button===0){if(this.reset(),ne(),g.x!==y.x||g.y!==y.y)return this._map.fire(new i.f("boxzoomend",{originalEvent:o})),{cameraAnimation:b=>b.fitScreenCoordinates(g,y,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),J(),delete this._startPos,delete this._lastPos}_fireEvent(o,h){return this._map.fire(new i.f(o,{originalEvent:h}))}}function Cu(m,o){let h={};for(let g=0;g<m.length;g++)h[m[g].identifier]=o[g];return h}class lp{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(o,h,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=o.timeStamp),g.length===this.numTouches&&(this.centroid=function(y){let b=new i.P(0,0);for(let S of y)b._add(S);return b.div(y.length)}(h),this.touches=Cu(g,h)))}touchmove(o,h,g){if(this.aborted||!this.centroid)return;let y=Cu(g,h);for(let b in this.touches){let S=y[b];(!S||S.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(o,h,g){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){let y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class yh{constructor(o){this.singleTap=new lp(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(o,h,g){this.singleTap.touchstart(o,h,g)}touchmove(o,h,g){this.singleTap.touchmove(o,h,g)}touchend(o,h,g){let y=this.singleTap.touchend(o,h,g);if(y){let b=o.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(y)<30;if(b&&S||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class Iu{constructor(){this._zoomIn=new yh({numTouches:1,numTaps:2}),this._zoomOut=new yh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,h,g){this._zoomIn.touchstart(o,h,g),this._zoomOut.touchstart(o,h,g)}touchmove(o,h,g){this._zoomIn.touchmove(o,h,g),this._zoomOut.touchmove(o,h,g)}touchend(o,h,g){let y=this._zoomIn.touchend(o,h,g),b=this._zoomOut.touchend(o,h,g);return y?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(y)},{originalEvent:o})}):b?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(b)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}let Sc={0:1,2:2};class ku{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(o,h){return!1}_move(o,h){return{}}mousedown(o,h){if(this._lastPoint)return;let g=Fe(o);this._correctButton(o,g)&&(this._lastPoint=h,this._eventButton=g)}mousemoveWindow(o,h){let g=this._lastPoint;if(g){if(o.preventDefault(),this._eventButton!=null&&function(y,b){let S=Sc[b];return y.buttons===void 0||(y.buttons&S)!==S}(o,this._eventButton))this.reset();else if(this._moved||!(h.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(g,h)}}mouseupWindow(o){this._lastPoint&&Fe(o)===this._eventButton&&(this._moved&&ne(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qs extends ku{mousedown(o,h){super.mousedown(o,h),this._lastPoint&&(this._active=!0)}_correctButton(o,h){return h===0&&!o.ctrlKey}_move(o,h){return{around:h,panDelta:h.sub(o)}}}class Jc extends ku{_correctButton(o,h){return h===0&&o.ctrlKey||h===2}_move(o,h){let g=.8*(h.x-o.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(o){o.preventDefault()}}class el extends ku{_correctButton(o,h){return h===0&&o.ctrlKey||h===2}_move(o,h){let g=-.5*(h.y-o.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(o){o.preventDefault()}}class cp{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=h.clickTolerance||1,this.reset(),i.bp(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(o,h,g){return this._calculateTransform(o,h,g)}touchmove(o,h,g){if(this._active&&!(g.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(g.length===1&&!i.d1())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.cancelable&&o.preventDefault(),this._calculateTransform(o,h,g)}}touchend(o,h,g){this._calculateTransform(o,h,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,h,g){g.length>0&&(this._active=!0);let y=Cu(g,h),b=new i.P(0,0),S=new i.P(0,0),C=0;for(let O in y){let j=y[O],X=this._touches[O];X&&(b._add(j),S._add(j.sub(X)),C++,y[O]=j)}if(this._touches=y,C<this._minTouches||!S.mag())return;let P=S.div(C);return this._sum._add(P),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(C),panDelta:P}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=F("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class bh{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(o){}_move(o,h,g){return{}}touchstart(o,h,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([h[0],h[1]]))}touchmove(o,h,g){let y=this._firstTwoTouches;if(!y)return;o.preventDefault();let[b,S]=y,C=ld(g,h,b),P=ld(g,h,S);if(!C||!P)return;let O=this._aroundCenter?null:C.add(P).div(2);return this._move([C,P],O,o)}touchend(o,h,g){if(!this._firstTwoTouches)return;let[y,b]=this._firstTwoTouches,S=ld(g,h,y),C=ld(g,h,b);S&&C||(this._active&&ne(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ld(m,o,h){for(let g=0;g<m.length;g++)if(m[g].identifier===h)return o[g]}function cd(m,o){return Math.log(m/o)/Math.LN2}class ud extends bh{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,h){let g=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(cd(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:cd(this._distance,g),pinchAround:h}}}function Mu(m,o){return 180*m.angleWith(o)/Math.PI}class Du extends bh{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,h){let g=this._vector;if(this._vector=o[0].sub(o[1]),g&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Mu(this._vector,g),pinchAround:h}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());let h=25/(Math.PI*this._minDiameter)*360,g=this._startVector;if(!g)return!1;let y=Mu(o,g);return Math.abs(y)<h}}function hd(m){return Math.abs(m.y)>Math.abs(m.x)}class hm extends bh{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(o){this._lastPoints=o,hd(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,h,g){let y=this._lastPoints;if(!y)return;let b=o[0].sub(y[0]),S=o[1].sub(y[1]);return this._map._cooperativeGestures&&!i.d1()&&g.touches.length<3||(this._valid=this.gestureBeginsVertically(b,S,g.timeStamp),!this._valid)?void 0:(this._lastPoints=o,this._active=!0,{pitchDelta:(b.y+S.y)/2*-.5})}gestureBeginsVertically(o,h,g){if(this._valid!==void 0)return this._valid;let y=o.mag()>=2,b=h.mag()>=2;if(!y&&!b)return;if(!y||!b)return this._firstMove==null&&(this._firstMove=g),g-this._firstMove<100&&void 0;let S=o.y>0==h.y>0;return hd(o)&&hd(h)&&S}}let rf={panStep:100,bearingStep:15,pitchStep:10};class Qc{constructor(){let o=rf;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let h=0,g=0,y=0,b=0,S=0;switch(o.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:o.shiftKey?g=-1:(o.preventDefault(),b=-1);break;case 39:o.shiftKey?g=1:(o.preventDefault(),b=1);break;case 38:o.shiftKey?y=1:(o.preventDefault(),S=-1);break;case 40:o.shiftKey?y=-1:(o.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(g=0,y=0),{cameraAnimation:C=>{let P=C.getZoom();C.easeTo({duration:300,easeId:"keyboardHandler",easing:dd,zoom:h?Math.round(P)+h*(o.shiftKey?2:1):P,bearing:C.getBearing()+g*this._bearingStep,pitch:C.getPitch()+y*this._pitchStep,offset:[-b*this._panStep,-S*this._panStep],center:C.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function dd(m){return m*(2-m)}let wh=4.000244140625,dm=1/450;class ms{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._handler=h,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=dm,i.bp(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||i.d1()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let h=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY,g=i.e.now(),y=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,h!==0&&h%wh==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(y*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),o.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=o,this._delta-=h,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let h=de(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:h,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let o=this._map.transform;this._type==="wheel"&&o.projection.wrap&&(o._center.lng>=180||o._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);let h=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(this._delta!==0){let O=this._type==="wheel"&&Math.abs(this._delta)>wh?this._wheelZoomRate:this._defaultZoomRate,j=2/(1+Math.exp(-Math.abs(this._delta*O)));this._delta<0&&j!==0&&(j=1/j);let X=h(),re=Math.pow(2,X),ae=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):re;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(ae*j))),this._type==="wheel"&&(this._startZoom=X,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}let g=typeof this._targetZoom=="number"?this._targetZoom:h(),y=this._startZoom,b=this._easing,S,C=!1;if(this._type==="wheel"&&y&&b){let O=Math.min((i.e.now()-this._lastWheelEventTime)/200,1),j=b(O);S=i.a2(y,g,j),O<1?this._frameId||(this._frameId=!0):C=!0}else S=g,C=!0;this._active=!0,C&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let P=S-h();return P*this._lastDelta<0&&(P=0),{noInertia:!0,needsRenderFrame:!C,zoomDelta:P,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let h=i.d2;if(this._prevEase){let g=this._prevEase,y=(i.e.now()-g.start)/g.duration,b=g.easing(y+.01)-g.easing(y),S=.27/Math.sqrt(b*b+1e-4)*.01,C=Math.sqrt(.0729-S*S);h=i.d0(S,C,.25,1)}return this._prevEase={start:i.e.now(),duration:o,easing:h},h}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=F("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class Th{constructor(o,h){this._clickZoom=o,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class fd{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,h){return o.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(o.shiftKey?-1:1),around:g.unproject(h)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pd{constructor(){this._tap=new yh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(o,h,g){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=h[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(o,h,g))}touchmove(o,h,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;let y=h[0],b=y.y-this._swipePoint.y;return this._swipePoint=y,o.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(o,h,g)}touchend(o,h,g){this._tapTime?this._swipePoint&&g.length===0&&this.reset():this._tap.touchend(o,h,g)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Sh{constructor(o,h,g){this._el=o,this._mousePan=h,this._touchPan=g}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class md{constructor(o,h,g){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=h,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class eu{constructor(o,h,g,y){this._el=o,this._touchZoom=h,this._touchRotate=g,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}let Fu=m=>m.zoom||m.drag||m.pitch||m.rotate;class up extends i.f{}class Pu{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,h){let g=i._.sub([],h,o);this.radius=i._.length(g[2]<0?i._.div([],g,this.constants):[g[0],g[1],0])}projectRay(o){i._.div(o,o,this.constants),i._.normalize(o,o),i._.mul(o,o,this.constants);let h=i._.scale([],o,this.radius);if(h[2]>0){let g=i._.scale([],[0,0,1],i._.dot(h,[0,0,1])),y=i._.scale([],i._.normalize([],[h[0],h[1],0]),this.radius),b=i._.add([],h,i._.scale([],i._.sub([],i._.add([],y,g),h),2));h[0]=b[0],h[1]=b[1]}return h}}function Eh(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class nf{constructor(o,h){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new $a(o),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Pu,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(h),i.bp(["handleEvent","handleWindowEvent"],this);let g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(let[y,b,S]of this._listeners){let C=y===document?this.handleWindowEvent:this.handleEvent;y.addEventListener(b,C,S)}}destroy(){for(let[o,h,g]of this._listeners){let y=o===document?this.handleWindowEvent:this.handleEvent;o.removeEventListener(h,y,g)}}_addDefaultHandlers(o){let h=this._map,g=h.getCanvasContainer();this._add("mapEvent",new Kc(h,o));let y=h.boxZoom=new ha(h,o);this._add("boxZoom",y);let b=new Iu,S=new fd;h.doubleClickZoom=new Th(S,b),this._add("tapZoom",b),this._add("clickZoom",S);let C=new pd;this._add("tapDragZoom",C);let P=h.touchPitch=new hm(h);this._add("touchPitch",P);let O=new Jc(o),j=new el(o);h.dragRotate=new md(o,O,j),this._add("mouseRotate",O,["mousePitch"]),this._add("mousePitch",j,["mouseRotate"]);let X=new Qs(o),re=new cp(h,o);h.dragPan=new Sh(g,X,re),this._add("mousePan",X),this._add("touchPan",re,["touchZoom","touchRotate"]);let ae=new Du,ue=new ud;h.touchZoomRotate=new eu(g,ue,ae,C),this._add("touchRotate",ae,["touchPan","touchZoom"]),this._add("touchZoom",ue,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Js(h));let he=h.scrollZoom=new ms(h,this);this._add("scrollZoom",he,["mousePan"]);let fe=h.keyboard=new Qc;this._add("keyboard",fe);for(let me of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[me]&&h[me].enable(o[me])}_add(o,h,g){this._handlers.push({handlerName:o,handler:h,allowed:g}),this._handlersById[o]=h}stop(o){if(!this._updatingCamera){for(let{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[],this._originalZoom=void 0}}isActive(){for(let{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Fu(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(o,h,g){for(let y in o)if(y!==g&&(!h||h.indexOf(y)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){let h=[];for(let g of o)this._el.contains(g.target)&&h.push(g);return h}handleEvent(o,h){this._updatingCamera=!0;let g=o.type==="renderFrame",y=g?void 0:o,b={needsRenderFrame:!1},S={},C={},P=o.touches?this._getMapTouches(o.touches):void 0,O=P?De(this._el,P):g?void 0:de(this._el,o);for(let{handlerName:re,handler:ae,allowed:ue}of this._handlers){if(!ae.isEnabled())continue;let he;this._blockedByActive(C,ue,re)?ae.reset():ae[h||o.type]&&(he=ae[h||o.type](o,O,P),this.mergeHandlerResult(b,S,he,re,y),he&&he.needsRenderFrame&&this._triggerRenderFrame()),(he||ae.isActive())&&(C[re]=ae)}let j={};for(let re in this._previousActiveHandlers)C[re]||(j[re]=y);this._previousActiveHandlers=C,(Object.keys(j).length||Eh(b))&&(this._changes.push([b,S,j]),this._triggerRenderFrame()),(Object.keys(C).length||Eh(b))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:X}=b;X&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],X(this._map))}mergeHandlerResult(o,h,g,y,b){if(!g)return;i.W(o,g);let S={handlerName:y,originalEvent:g.originalEvent||b};g.zoomDelta!==void 0&&(h.zoom=S),g.panDelta!==void 0&&(h.drag=S),g.pitchDelta!==void 0&&(h.pitch=S),g.bearingDelta!==void 0&&(h.rotate=S)}_applyChanges(){let o={},h={},g={};for(let[y,b,S]of this._changes)y.panDelta&&(o.panDelta=(o.panDelta||new i.P(0,0))._add(y.panDelta)),y.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+y.pitchDelta),y.around!==void 0&&(o.around=y.around),y.aroundCoord!==void 0&&(o.aroundCoord=y.aroundCoord),y.pinchAround!==void 0&&(o.pinchAround=y.pinchAround),y.noInertia&&(o.noInertia=y.noInertia),i.W(h,b),i.W(g,S);this._updateMapTransform(o,h,g),this._changes=[]}_updateMapTransform(o,h,g){let y=this._map,b=y.transform,S=Le=>[Le.x,Le.y,Le.z];if((Le=>{let Oe=this._eventsInProgress.drag;return Oe&&!this._handlersById[Oe.handlerName].isActive()})()&&!Eh(o)){let Le=b.zoom;b.cameraElevationReference="sea",this._originalZoom!=null&&b._orthographicProjectionAtLowPitch&&b.projection.name!=="globe"&&b.pitch===0?(b.cameraElevationReference="ground",b.zoom=this._originalZoom):(b.recenterOnTerrain(),b.cameraElevationReference="ground"),Le!==b.zoom&&this._map._update(!0)}if(b._isCameraConstrained&&y._stop(!0),!Eh(o))return void this._fireEvents(h,g,!0);let{panDelta:C,zoomDelta:P,bearingDelta:O,pitchDelta:j,around:X,aroundCoord:re,pinchAround:ae}=o;b._isCameraConstrained&&(P>0&&(P=0),b._isCameraConstrained=!1),ae!==void 0&&(X=ae),(P||(Le=>h[Le]&&!this._eventsInProgress[Le])("drag"))&&X&&(this._dragOrigin=S(b.pointCoordinate3D(X)),this._originalZoom=b.zoom,this._trackingEllipsoid.setup(b._camera.position,this._dragOrigin)),b.cameraElevationReference="sea",y._stop(!0),X=X||y.transform.centerPoint,O&&(b.bearing+=O),j&&(b.pitch+=j),b._updateCameraState();let ue=[0,0,0];if(C)if(b.projection.name==="mercator"){let Le=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(X).dir),Oe=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(X.sub(C)).dir);ue[0]=Oe[0]-Le[0],ue[1]=Oe[1]-Le[1]}else{let Le=b.pointCoordinate(X);if(b.projection.name==="globe"){C=C.rotate(-b.angle);let Oe=b._pixelsPerMercatorPixel/b.worldSize;ue[0]=-C.x*i.d3(i.ay(Le.y))*Oe,ue[1]=-C.y*i.d3(b.center.lat)*Oe}else{let Oe=b.pointCoordinate(X.sub(C));Le&&Oe&&(ue[0]=Oe.x-Le.x,ue[1]=Oe.y-Le.y)}}let he=b.zoom,fe=[0,0,0];if(P){let Le=S(re||b.pointCoordinate3D(X)),Oe={dir:i._.normalize([],i._.sub([],Le,b._camera.position))};if(Oe.dir[2]<0){let Ne=b.zoomDeltaToMovement(Le,P);i._.scale(fe,Oe.dir,Ne)}}let me=i._.add(ue,ue,fe);b._translateCameraConstrained(me),P&&Math.abs(b.zoom-he)>1e-4&&b.recenterOnTerrain(),b.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(h,g,!0)}_fireEvents(o,h,g){let y=Fu(this._eventsInProgress),b=Fu(o),S={};for(let j in o){let{originalEvent:X}=o[j];this._eventsInProgress[j]||(S[`${j}start`]=X),this._eventsInProgress[j]=o[j]}!y&&b&&this._fireEvent("movestart",b.originalEvent);for(let j in S)this._fireEvent(j,S[j]);b&&this._fireEvent("move",b.originalEvent);for(let j in o){let{originalEvent:X}=o[j];this._fireEvent(j,X)}let C={},P;for(let j in this._eventsInProgress){let{handlerName:X,originalEvent:re}=this._eventsInProgress[j];this._handlersById[X].isActive()||(delete this._eventsInProgress[j],P=h[X]||re,C[`${j}end`]=P)}for(let j in C)this._fireEvent(j,C[j]);let O=Fu(this._eventsInProgress);if(g&&(y||b)&&!O){this._updatingCamera=!0;let j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),X=re=>re!==0&&-this._bearingSnap<re&&re<this._bearingSnap;j?(X(j.bearing||this._map.getBearing())&&(j.bearing=0),this._map.easeTo(j,{originalEvent:P})):(this._map.fire(new i.f("moveend",{originalEvent:P})),X(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,h){this._map.fire(new i.f(o,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{this._frameId=void 0,this.handleEvent(new up("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}let gs="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class fm extends i.E{constructor(o,h){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=h.bearingSnap,this._respectPrefersReducedMotion=h.respectPrefersReducedMotion!==!1,i.bp(["_renderFrameCallback"],this)}getCenter(){return new i.aI(this.transform.center.lng,this.transform.center.lat)}setCenter(o,h){return this.jumpTo({center:o},h)}panBy(o,h,g){return o=i.P.convert(o).mult(-1),this.panTo(this.transform.center,i.W({offset:o},h),g)}panTo(o,h,g){return this.easeTo(i.W({center:o},h),g)}getZoom(){return this.transform.zoom}setZoom(o,h){return this.jumpTo({zoom:o},h),this}zoomTo(o,h,g){return this.easeTo(i.W({zoom:o},h),g)}zoomIn(o,h){return this.zoomTo(this.getZoom()+1,o,h),this}zoomOut(o,h){return this.zoomTo(this.getZoom()-1,o,h),this}getBearing(){return this.transform.bearing}setBearing(o,h){return this.jumpTo({bearing:o},h),this}getPadding(){return this.transform.padding}setPadding(o,h){return this.jumpTo({padding:o},h),this}rotateTo(o,h,g){return this.easeTo(i.W({bearing:o},h),g)}resetNorth(o,h){return this.rotateTo(0,i.W({duration:1e3},o),h),this}resetNorthPitch(o,h){return this.easeTo(i.W({bearing:0,pitch:0,duration:1e3},o),h),this}snapToNorth(o,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,h):this}getPitch(){return this.transform.pitch}setPitch(o,h){return this.jumpTo({pitch:o},h),this}cameraForBounds(o,h){o=i.ai.convert(o);let g=h&&h.bearing||0,y=h&&h.pitch||0,b=o.getNorthWest(),S=o.getSouthEast();return this._cameraForBounds(this.transform,b,S,g,y,h)}_extendPadding(o){let h={top:0,right:0,bottom:0,left:0};return o==null?i.W({},h,this.transform.padding):typeof o=="number"?{top:o,bottom:o,right:o,left:o}:i.W({},h,o)}_extendCameraOptions(o){return(o=i.W({offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding=this._extendPadding(o.padding),o}_minimumAABBFrustumDistance(o,h){let g=h.max[0]-h.min[0],y=h.max[1]-h.min[1];return g/y>o.aspect?g/(2*Math.tan(.5*o.fovX)*o.aspect):y/(2*Math.tan(.5*o.fovY)*o.aspect)}_cameraForBoundsOnGlobe(o,h,g,y,b,S){let C=o.clone(),P=this._extendCameraOptions(S);C.bearing=y,C.pitch=b;let O=i.aI.convert(h),j=i.aI.convert(g),X=.5*(O.lat+j.lat),re=.5*(O.lng+j.lng),ae=i.d4(X,re),ue=i._.normalize([],ae),he=i._.normalize([],i._.cross([],ue,[0,1,0])),fe=i._.cross([],he,ue),me=[he[0],he[1],he[2],0,fe[0],fe[1],fe[2],0,ue[0],ue[1],ue[2],0,0,0,0,1],Le=[ae,i.d4(O.lat,O.lng),i.d4(j.lat,O.lng),i.d4(j.lat,j.lng),i.d4(O.lat,j.lng),i.d4(X,O.lng),i.d4(X,j.lng),i.d4(O.lat,re),i.d4(j.lat,re)],Oe=i.b6.fromPoints(Le.map(jt=>[i._.dot(he,jt),i._.dot(fe,jt),i._.dot(ue,jt)])),Ne=i._.transformMat4([],Oe.center,me);i._.squaredLength(Ne)===0&&i._.set(Ne,0,0,1),i._.normalize(Ne,Ne),i._.scale(Ne,Ne,i.cD),C.center=i.d5(Ne);let Je=C.getWorldToCameraMatrix(),Ke=i.ad.invert(new Float64Array(16),Je);Oe=i.b6.applyTransform(Oe,i.ad.multiply([],Je,me));let Pe=this._extendAABB(Oe,C,P,y);if(!Pe)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Oe=Pe,i._.transformMat4(Ne,Ne,Je);let Be=.5*(Oe.max[2]-Oe.min[2]),je=this._minimumAABBFrustumDistance(C,Oe),at=i._.scale([],[0,0,1],Be),yt=i._.add(at,Ne,at),qe=je+(C.pitch===0?0:i._.distance(Ne,yt)),bt=C.globeCenterInViewSpace,Ct=i._.sub([],Ne,[bt[0],bt[1],bt[2]]);i._.normalize(Ct,Ct),i._.scale(Ct,Ct,qe);let Ht=i._.add([],Ne,Ct);i._.transformMat4(Ht,Ht,Ke);let qt=i.d7/i.cD,Ut=i._.length(Ht),ft=i.ax(Math.max(Ut*qt-i.d7,Number.EPSILON),0),kt=Math.min(C.zoomFromMercatorZAdjusted(ft),P.maxZoom);return kt>.5*(i.b1+i.aU)?(C.setProjection({name:"mercator"}),C.zoom=kt,this._cameraForBounds(C,h,g,y,b,S)):{center:C.center,zoom:kt,bearing:y,pitch:b}}_extendAABB(o,h,g,y){let b=.5*((g.padding.left||0)+(g.padding.right||0)),S=.5*((g.padding.top||0)+(g.padding.bottom||0)),C=S,P=b,O=b,j=S,X=h.width-(P+O),re=h.height-(C+j),ae=i._.sub([],o.max,o.min),ue=Math.min(X/ae[0],re/ae[1]),he=Math.min(h.scaleZoom(h.scale*ue),g.maxZoom);if(isNaN(he))return null;let fe=h.scale/h.zoomScale(he),me=new i.b6([o.min[0]-P*fe,o.min[1]-j*fe,o.min[2]],[o.max[0]+O*fe,o.max[1]+C*fe,o.max[2]]),Le=(typeof g.offset.x=="number"&&typeof g.offset.y=="number"?new i.P(g.offset.x,g.offset.y):i.P.convert(g.offset)).rotate(-i.ab(y));return me.center[0]-=Le.x*fe,me.center[1]+=Le.y*fe,me}queryTerrainElevation(o,h){let g=this.transform.elevation;return g?(h=i.W({},{exaggerated:!0},h),g.getAtPoint(i.Y.fromLngLat(o),null,h.exaggerated)):null}_cameraForBounds(o,h,g,y,b,S){if(o.projection.name==="globe")return this._cameraForBoundsOnGlobe(o,h,g,y,b,S);let C=o.clone(),P=this._extendCameraOptions(S);C.bearing=y,C.pitch=b;let O=i.aI.convert(h),j=i.aI.convert(g),X=new i.aI(O.lng,j.lat),re=new i.aI(j.lng,O.lat),ae=C.project(O),ue=C.project(j),he=this.queryTerrainElevation(O),fe=this.queryTerrainElevation(j),me=this.queryTerrainElevation(X),Le=this.queryTerrainElevation(re),Oe=[[ae.x,ae.y,Math.min(he||0,fe||0,me||0,Le||0)],[ue.x,ue.y,Math.max(he||0,fe||0,me||0,Le||0)]],Ne=i.b6.fromPoints(Oe),Je=C.getWorldToCameraMatrix(),Ke=i.ad.invert(new Float64Array(16),Je);Ne=i.b6.applyTransform(Ne,Je);let Pe=this._extendAABB(Ne,C,P,y);if(!Pe)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ne=Pe;let Be=.5*i._.sub([],Ne.max,Ne.min)[2],je=this._minimumAABBFrustumDistance(C,Ne),at=[0,0,1,0];i.aA.transformMat4(at,at,Je),i.aA.normalize(at,at);let yt=i._.scale([],at,je+Be),qe=i._.add([],Ne.center,yt);i._.transformMat4(Ne.center,Ne.center,Ke),i._.transformMat4(qe,qe,Ke);let bt=[Ne.center[0],Ne.center[1],qe[2]*C.pixelsPerMeter];i._.scale(bt,bt,1/C.worldSize);let Ct=i.d6(bt[0]),Ht=i.ay(bt[1]),qt=Math.min(C._zoomFromMercatorZ(bt[2]),P.maxZoom),Ut=new i.aI(Ct,Ht);return C.mercatorFromTransition&&qt<.5*(i.b1+i.aU)?(C.setProjection({name:"globe"}),C.zoom=qt,this._cameraForBounds(C,h,g,y,b,S)):{center:Ut,zoom:qt,bearing:y,pitch:b}}fitBounds(o,h,g){let y=this.cameraForBounds(o,h);return this._fitInternal(y,h,g)}fitScreenCoordinates(o,h,g,y,b){let S=i.P.convert(o),C=i.P.convert(h),P=new i.P(Math.min(S.x,C.x),Math.min(S.y,C.y)),O=new i.P(Math.max(S.x,C.x),Math.max(S.y,C.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(S,C))return this;let j=this.transform.pointLocation3D(P),X=this.transform.pointLocation3D(O),re=this.transform.pointLocation3D(new i.P(P.x,O.y)),ae=this.transform.pointLocation3D(new i.P(O.x,P.y)),ue=[Math.min(j.lng,X.lng,re.lng,ae.lng),Math.min(j.lat,X.lat,re.lat,ae.lat)],he=[Math.max(j.lng,X.lng,re.lng,ae.lng),Math.max(j.lat,X.lat,re.lat,ae.lat)],fe=y&&y.pitch?y.pitch:this.getPitch(),me=this._cameraForBounds(this.transform,ue,he,g,fe,y);return this._fitInternal(me,y,b)}_fitInternal(o,h,g){return o?(h=i.W(o,h)).linear?this.easeTo(h,g):this.flyTo(h,g):this}jumpTo(o,h){this.stop();let g=o.preloadOnly?this.transform.clone():this.transform,y=!1,b=!1,S=!1;return"zoom"in o&&g.zoom!==+o.zoom&&(y=!0,g.zoom=+o.zoom),o.center!==void 0&&(g.center=i.aI.convert(o.center)),"bearing"in o&&g.bearing!==+o.bearing&&(b=!0,g.bearing=+o.bearing),"pitch"in o&&g.pitch!==+o.pitch&&(S=!0,g.pitch=+o.pitch),o.padding==null||g.isPaddingEqual(o.padding)||(g.padding=o.padding),o.preloadOnly?(this._preloadTiles(g),this):(this.fire(new i.f("movestart",h)).fire(new i.f("move",h)),y&&this.fire(new i.f("zoomstart",h)).fire(new i.f("zoom",h)).fire(new i.f("zoomend",h)),b&&this.fire(new i.f("rotatestart",h)).fire(new i.f("rotate",h)).fire(new i.f("rotateend",h)),S&&this.fire(new i.f("pitchstart",h)).fire(new i.f("pitch",h)).fire(new i.f("pitchend",h)),this.fire(new i.f("moveend",h)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(gs),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,h){let g=this.transform;if(!g.projection.supportsFreeCamera)return i.w(gs),this;this.stop();let y=g.zoom,b=g.pitch,S=g.bearing;g.setFreeCameraOptions(o);let C=y!==g.zoom,P=b!==g.pitch,O=S!==g.bearing;return this.fire(new i.f("movestart",h)).fire(new i.f("move",h)),C&&this.fire(new i.f("zoomstart",h)).fire(new i.f("zoom",h)).fire(new i.f("zoomend",h)),O&&this.fire(new i.f("rotatestart",h)).fire(new i.f("rotate",h)).fire(new i.f("rotateend",h)),P&&this.fire(new i.f("pitchstart",h)).fire(new i.f("pitch",h)).fire(new i.f("pitchend",h)),this.fire(new i.f("moveend",h)),this}easeTo(o,h){this._stop(!1,o.easeId),((o=i.W({offset:[0,0],duration:500,easing:i.d2},o)).animate===!1||this._prefersReducedMotion(o))&&(o.duration=0);let g=this.transform,y=this.getZoom(),b=this.getBearing(),S=this.getPitch(),C=this.getPadding(),P="zoom"in o?+o.zoom:y,O="bearing"in o?this._normalizeBearing(o.bearing,b):b,j="pitch"in o?+o.pitch:S,X=this._extendPadding(o.padding),re=i.P.convert(o.offset),ae,ue,he;if(g.projection.name==="globe"){let je=i.Y.fromLngLat(g.center),at=re.rotate(-g.angle);je.x+=at.x/g.worldSize,je.y+=at.y/g.worldSize;let yt=je.toLngLat(),qe=i.aI.convert(o.center||yt);this._normalizeCenter(qe),ae=g.centerPoint.add(at),ue=new i.P(je.x,je.y).mult(g.worldSize),he=new i.P(i.aj(qe.lng),i.ak(qe.lat)).mult(g.worldSize).sub(ue)}else{ae=g.centerPoint.add(re);let je=g.pointLocation(ae),at=i.aI.convert(o.center||je);this._normalizeCenter(at),ue=g.project(je),he=g.project(at).sub(ue)}let fe=g.zoomScale(P-y),me,Le;o.around&&(me=i.aI.convert(o.around),Le=g.locationPoint(me));let Oe=this._zooming||P!==y,Ne=this._rotating||b!==O,Je=this._pitching||j!==S,Ke=!g.isPaddingEqual(X),Pe=je=>at=>{if(Oe&&(je.zoom=i.a2(y,P,at)),Ne&&(je.bearing=i.a2(b,O,at)),Je&&(je.pitch=i.a2(S,j,at)),Ke&&(je.interpolatePadding(C,X,at),ae=je.centerPoint.add(re)),me)je.setLocationAtPoint(me,Le);else{let yt=je.zoomScale(je.zoom-y),qe=P>y?Math.min(2,fe):Math.max(.5,fe),bt=Math.pow(qe,1-at),Ct=je.unproject(ue.add(he.mult(at*bt)).mult(yt));je.setLocationAtPoint(je.renderWorldCopies?Ct.wrap():Ct,ae)}return o.preloadOnly||this._fireMoveEvents(h),je};if(o.preloadOnly){let je=this._emulate(Pe,o.duration,g);return this._preloadTiles(je),this}let Be={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Oe,this._rotating=Ne,this._pitching=Je,this._padding=Ke,this._easeId=o.easeId,this._prepareEase(h,o.noMoveStart,Be),this._ease(Pe(g),je=>{g.cameraElevationReference==="sea"&&g.recenterOnTerrain(),this._afterEase(h,je)},o),this}_prepareEase(o,h,g={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),h||g.moving||this.fire(new i.f("movestart",o)),this._zooming&&!g.zooming&&this.fire(new i.f("zoomstart",o)),this._rotating&&!g.rotating&&this.fire(new i.f("rotatestart",o)),this._pitching&&!g.pitching&&this.fire(new i.f("pitchstart",o))}_fireMoveEvents(o){this.fire(new i.f("move",o)),this._zooming&&this.fire(new i.f("zoom",o)),this._rotating&&this.fire(new i.f("rotate",o)),this._pitching&&this.fire(new i.f("pitch",o))}_afterEase(o,h){if(this._easeId&&h&&this._easeId===h)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";let g=this._zooming,y=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new i.f("zoomend",o)),y&&this.fire(new i.f("rotateend",o)),b&&this.fire(new i.f("pitchend",o)),this.fire(new i.f("moveend",o))}flyTo(o,h){if(this._prefersReducedMotion(o)){let kt=i.ah(o,["center","zoom","bearing","pitch","around","padding"]);return this.jumpTo(kt,h)}this.stop(),o=i.W({offset:[0,0],speed:1.2,curve:1.42,easing:i.d2},o);let g=this.transform,y=this.getZoom(),b=this.getBearing(),S=this.getPitch(),C=this.getPadding(),P="zoom"in o?i.at(+o.zoom,g.minZoom,g.maxZoom):y,O="bearing"in o?this._normalizeBearing(o.bearing,b):b,j="pitch"in o?+o.pitch:S,X=this._extendPadding(o.padding),re=g.zoomScale(P-y),ae=i.P.convert(o.offset),ue=g.centerPoint.add(ae),he=g.pointLocation(ue),fe=i.aI.convert(o.center||he);this._normalizeCenter(fe);let me=g.project(he),Le=g.project(fe).sub(me),Oe=o.curve,Ne=Math.max(g.width,g.height),Je=Ne/re,Ke=Le.mag();if("minZoom"in o){let kt=i.at(Math.min(o.minZoom,y,P),g.minZoom,g.maxZoom),jt=Ne/g.zoomScale(kt-y);Oe=Math.sqrt(jt/Ke*2)}let Pe=Oe*Oe;function Be(kt){let jt=(Je*Je-Ne*Ne+(kt?-1:1)*Pe*Pe*Ke*Ke)/(2*(kt?Je:Ne)*Pe*Ke);return Math.log(Math.sqrt(jt*jt+1)-jt)}function je(kt){return(Math.exp(kt)-Math.exp(-kt))/2}function at(kt){return(Math.exp(kt)+Math.exp(-kt))/2}let yt=Be(0),qe=function(kt){return at(yt)/at(yt+Oe*kt)},bt=function(kt){return Ne*((at(yt)*(je(jt=yt+Oe*kt)/at(jt))-je(yt))/Pe)/Ke;var jt},Ct=(Be(1)-yt)/Oe;if(Math.abs(Ke)<1e-6||!isFinite(Ct)){if(Math.abs(Ne-Je)<1e-6)return this.easeTo(o,h);let kt=Je<Ne?-1:1;Ct=Math.abs(Math.log(Je/Ne))/Oe,bt=function(){return 0},qe=function(jt){return Math.exp(kt*Oe*jt)}}o.duration="duration"in o?+o.duration:1e3*Ct/("screenSpeed"in o?+o.screenSpeed/Oe:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);let Ht=b!==O,qt=j!==S,Ut=!g.isPaddingEqual(X),ft=kt=>jt=>{let di=jt*Ct,pi=1/qe(di);kt.zoom=jt===1?P:y+kt.scaleZoom(pi),Ht&&(kt.bearing=i.a2(b,O,jt)),qt&&(kt.pitch=i.a2(S,j,jt)),Ut&&(kt.interpolatePadding(C,X,jt),ue=kt.centerPoint.add(ae));let Ai=jt===1?fe:kt.unproject(me.add(Le.mult(bt(di))).mult(pi));return kt.setLocationAtPoint(kt.renderWorldCopies?Ai.wrap():Ai,ue),kt._updateCameraOnTerrain(),o.preloadOnly||this._fireMoveEvents(h),kt};if(o.preloadOnly){let kt=this._emulate(ft,o.duration,g);return this._preloadTiles(kt),this}return this._zooming=!0,this._rotating=Ht,this._pitching=qt,this._padding=Ut,this._prepareEase(h,!1),this._ease(ft(g),()=>this._afterEase(h),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(o){}_cancelRenderFrame(o){}_stop(o,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){let g=this._onEaseEnd;this._onEaseEnd=void 0,g.call(this,h)}if(!o){let g=this.handlers;g&&g.stop(!1)}return this}_ease(o,h,g){g.animate===!1||g.duration===0?(o(1),h()):(this._easeStart=i.e.now(),this._easeOptions=g,this._onEaseFrame=o,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){let o=Math.min((i.e.now()-this._easeStart)/this._easeOptions.duration,1),h=this._onEaseFrame;h&&h(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,h){o=i.au(o,-180,180);let g=Math.abs(o-h);return Math.abs(o-360-h)<g&&(o-=360),Math.abs(o+360-h)<g&&(o+=360),o}_normalizeCenter(o){let h=this.transform;if(h.maxBounds||h.projection.name!=="globe"&&!h.renderWorldCopies)return;let g=o.lng-h.center.lng;o.lng+=g>180?-360:g<-180?360:0}_prefersReducedMotion(o){return this._respectPrefersReducedMotion&&i.e.prefersReducedMotion&&!(o&&o.essential)}_emulate(o,h,g){let y=Math.ceil(15*h/1e3),b=[],S=o(g.clone());for(let C=0;C<=y;C++){let P=S(C/y);b.push(P.clone())}return b}_preloadTiles(o,h){}}class hp{constructor(o={}){this.options=o,i.bp(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){let h=this.options&&this.options.compact;return this._map=o,this._container=F("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=F("button","mapboxgl-ctrl-attrib-button",this._container),F("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=F("div","mapboxgl-ctrl-attrib-inner",this._container),h&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),h===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(o,h){let g=this._map._getUIString(`AttributionControl.${h}`);o.removeAttribute("title"),o.firstElementChild&&o.firstElementChild.setAttribute("title",g)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));let h=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.d8.ACCESS_TOKEN}];if(o){let g=h.reduce((y,b,S)=>(b.value&&(y+=`${b.key}=${b.value}${S<h.length-1?"&":""}`),y),"?");o.href=`${i.d8.FEEDBACK_URL}/${g}#${yo(this._map,!0)}`,o.rel="noopener nofollow",this._setElementTitle(o,"MapFeedback")}}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){let y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}let h=this._map.style._mergedSourceCaches;for(let y in h){let b=h[y];if(b.used){let S=b.getSource();S.attribution&&o.indexOf(S.attribution)<0&&o.push(S.attribution)}}o.sort((y,b)=>y.length-b.length),o=o.filter((y,b)=>{for(let S=b+1;S<o.length;S++)if(o[S].indexOf(y)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));let g=o.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,o.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class pm{constructor(){i.bp(["_updateLogo","_updateCompact"],this)}onAdd(o){this._map=o,this._container=F("div","mapboxgl-ctrl");let h=F("a","mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://www.mapbox.com/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&o.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;let o=this._map.style._sourceCaches;if(Object.entries(o).length===0)return!0;for(let h in o){let g=o[h].getSource();if(g.hasOwnProperty("mapbox_logo")&&!g.mapbox_logo)return!1}return!0}_updateCompact(){let o=this._container.children;if(o.length){let h=o[0];this._map.getCanvasContainer().offsetWidth<250?h.classList.add("mapboxgl-compact"):h.classList.remove("mapboxgl-compact")}}}class dp{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){let h=++this._id;return this._queue.push({callback:o,id:h,cancelled:!1}),h}remove(o){let h=this._currentlyRunning,g=h?this._queue.concat(h):this._queue;for(let y of g)if(y.id===o)return void(y.cancelled=!0)}run(o=0){let h=this._currentlyRunning=this._queue;this._queue=[];for(let g of h)if(!g.cancelled&&(g.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Lu(m,o,h){if(m=new i.aI(m.lng,m.lat),o){let g=new i.aI(m.lng-360,m.lat),y=new i.aI(m.lng+360,m.lat),b=360*Math.ceil(Math.abs(m.lng-h.center.lng)/360),S=h.locationPoint(m).distSqr(o),C=o.x<0||o.y<0||o.x>h.width||o.y>h.height;h.locationPoint(g).distSqr(o)<S&&(C||Math.abs(g.lng-h.center.lng)<b)?m=g:h.locationPoint(y).distSqr(o)<S&&(C||Math.abs(y.lng-h.center.lng)<b)&&(m=y)}for(;Math.abs(m.lng-h.center.lng)>180;){let g=h.locationPoint(m);if(g.x>=0&&g.y>=0&&g.x<=h.width&&g.y<=h.height)break;m.lng>h.center.lng?m.lng-=360:m.lng+=360}return m}let fp={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Ah extends i.E{constructor(o,h){if(super(),(o instanceof HTMLElement||h)&&(o=i.W({element:o},h)),i.bp(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=o&&o.occludedOpacity||.2,o&&o.element)this._element=o.element,this._offset=i.P.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=F("div");let b=41,S=27,C=W("svg",{display:"block",height:b*this._scale+"px",width:S*this._scale+"px",viewBox:`0 0 ${S} ${b}`},this._element),P=W("radialGradient",{id:"shadowGradient"},W("defs",{},C));W("stop",{offset:"10%","stop-opacity":.4},P),W("stop",{offset:"100%","stop-opacity":.05},P),W("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},C),W("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},C),W("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},C),W("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},C),this._offset=i.P.convert(o&&o.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",b=>{b.preventDefault()}),this._element.addEventListener("mousedown",b=>{b.preventDefault()});let g=this._element.classList;for(let b in fp)g.remove(`mapboxgl-marker-anchor-${b}`);g.add(`mapboxgl-marker-anchor-${this._anchor}`);let y=o&&o.className?o.className.trim().split(/\s+/):[];g.add(...y),this._popup=null}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),o.on("click",this._onMapClick)),this}remove(){let o=this._map;return o&&(o.off("click",this._onMapClick),o.off("move",this._updateMoving),o.off("moveend",this._update),o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler),o.off("mouseup",this._onUp),o.off("touchend",this._onUp),o.off("mousemove",this._onMove),o.off("touchmove",this._onMove),o.off("remove",this._clearFadeTimer),o._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=i.aI.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){let y=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(38.1-13.5+y)],"bottom-right":[-y,-1*(38.1-13.5+y)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,o._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){let h=o.code,g=o.charCode||o.keyCode;h!=="Space"&&h!=="Enter"&&g!==32&&g!==13||this.togglePopup()}_onMapClick(o){let h=o.originalEvent.target,g=this._element;this._popup&&(h===g||g.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){let o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){let o=this._map,h=this._pos;if(!o||!h)return!1;let g=o.unproject(h),y=o.getFreeCameraOptions();if(!y.position)return!1;let b=y.position.toLngLat();return b.distanceTo(g)<.9*b.distanceTo(this._lngLat)}_evaluateOpacity(){let o=this._map;if(!o)return;let h=this._pos;if(!h||h.x<0||h.x>o.transform.width||h.y<0||h.y>o.transform.height)return void this._clearFadeTimer();let g=o.unproject(h),y;o._showingGlobe()&&i.d9(o.transform,this._lngLat)?y=0:(y=1-o._queryFogOpacity(g),o.transform._terrainEnabled()&&o.getTerrain()&&this._behindTerrain()&&(y*=this._occludedOpacity)),this._element.style.opacity=`${y}`,this._element.style.pointerEvents=y>0?"auto":"none",this._popup&&this._popup._setOpacity(y),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){let o=this._pos;if(!o||!this._map)return;let h=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${o.x}px,${o.y}px)
            ${fp[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${h.x}px,${h.y}px)
        `}_calculateXYTransform(){let o=this._pos,h=this._map,g=this.getPitchAlignment();if(!h||!o||g!=="map")return"";if(!h._showingGlobe()){let P=h.getPitch();return P?`rotateX(${P}deg)`:""}let y=i.b0(i.da(h.transform,this._lngLat)),b=o.sub(i.db(h.transform)),S=Math.abs(b.x)+Math.abs(b.y);if(S===0)return"";let C=y/S;return`rotateX(${-b.y*C}deg) rotateY(${b.x*C}deg)`}_calculateZTransform(){let o=this._pos,h=this._map;if(!h||!o)return"";let g=0,y=this.getRotationAlignment();if(y==="map")if(h._showingGlobe()){let b=h.project(new i.aI(this._lngLat.lng,this._lngLat.lat+.001)),S=h.project(new i.aI(this._lngLat.lng,this._lngLat.lat-.001)).sub(b);g=i.b0(Math.atan2(S.y,S.x))-90}else g=-h.getBearing();else if(y==="horizon"){let b=i.$(4,6,h.getZoom()),S=i.db(h.transform);S.y+=b*h.transform.height;let C=o.sub(S),P=i.b0(Math.atan2(C.y,C.x));g=(P>90?P-270:P+90)*(1-b)}return g+=this._rotation,g?`rotateZ(${g}deg)`:""}_update(o){cancelAnimationFrame(this._updateFrameId);let h=this._map;h&&(h.transform.renderWorldCopies&&(this._lngLat=Lu(this._lngLat,this._pos,h.transform)),this._pos=h.project(this._lngLat),o===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),h._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(h._showingGlobe()||h.getTerrain()||h.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(o){return this._offset=i.P.convert(o),this._update(),this}addClassName(o){return this._element.classList.add(o),this}removeClassName(o){return this._element.classList.remove(o),this}toggleClassName(o){return this._element.classList.toggle(o)}_onMove(o){let h=this._map;if(!h)return;let g=this._pointerdownPos,y=this._positionDelta;if(g&&y){if(!this._isDragging){let b=this._clickTolerance||h._clickTolerance;if(o.point.dist(g)<b)return;this._isDragging=!0}this._pos=o.point.sub(y),this._lngLat=h.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.f("dragstart"))),this.fire(new i.f("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;let o=this._map;o&&(o.off("mousemove",this._onMove),o.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.f("dragend")),this._state="inactive"}_addDragHandler(o){let h=this._map,g=this._pos;h&&g&&this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(g),this._pointerdownPos=o.point,this._state="pending",h.on("mousemove",this._onMove),h.on("touchmove",this._onMove),h.once("mouseup",this._onUp),h.once("touchend",this._onUp))}setDraggable(o){this._draggable=!!o;let h=this._map;return h&&(o?(h.on("mousedown",this._addDragHandler),h.on("touchstart",this._addDragHandler)):(h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(o){return this._occludedOpacity=o||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}let pp={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},mp=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ru(m=new i.P(0,0),o="bottom"){if(typeof m=="number"){let h=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(o){case"top":return new i.P(0,m);case"top-left":return new i.P(h,h);case"top-right":return new i.P(-h,h);case"bottom":return new i.P(0,-m);case"bottom-left":return new i.P(h,-h);case"bottom-right":return new i.P(-h,-h);case"left":return new i.P(m,0);case"right":return new i.P(-m,0)}return new i.P(0,0)}return m instanceof i.P||Array.isArray(m)?i.P.convert(m):i.P.convert(m[o]||[0,0])}class Ch{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;let h=i.b9((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-h)+this._end*h}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,h,g){this._start=this.getValue(h),this._end=o,this._startTime=h,this._endTime=h+g}}let af={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class gd{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}let wl={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1},_s={showCompass:!0,showZoom:!0,visualizePitch:!1};class Ec{constructor(o,h,g=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new Jc({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,g&&(this.mousePitch=new el({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),i.bp(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),h.addEventListener("mousedown",this.mousedown),h.addEventListener("touchstart",this.touchstart,{passive:!1}),h.addEventListener("touchmove",this.touchmove),h.addEventListener("touchend",this.touchend),h.addEventListener("touchcancel",this.reset)}down(o,h){this.mouseRotate.mousedown(o,h),this.mousePitch&&this.mousePitch.mousedown(o,h),H()}move(o,h){let g=this.map,y=this.mouseRotate.mousemoveWindow(o,h),b=y&&y.bearingDelta;if(b&&g.setBearing(g.getBearing()+b),this.mousePitch){let S=this.mousePitch.mousemoveWindow(o,h),C=S&&S.pitchDelta;C&&g.setPitch(g.getPitch()+C)}}off(){let o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart,{passive:!1}),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){J(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(i.W({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),de(this.element,o)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,de(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=De(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=De(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}let Wl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},of={maxWidth:100,unit:"metric"},_d={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"};return{version:i.dt,supported:T,setRTLTextPlugin:i.dv,getRTLTextPluginStatus:i.dw,Map:class extends fm{constructor(m){i.dc.mark(i.dd.create);let o=m;if((m=i.W({},wl,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&i.de(window)&&(m.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new ls(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),m),this._repaint=!!m.repaint,this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._collectResourceTiming=m.collectResourceTiming,this._language=this._parseLanguage(m.language),this._worldview=m.worldview,this._renderTaskQueue=new dp,this._domRenderTaskQueue=new dp,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.df(),this._locale=i.W({},af,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._performanceMetricsCollection=m.performanceMetricsCollection,this._tessellationStep=m.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Ch(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._lastDirtyFrameId=0,this._requestManager=new i.dg(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,this._contextCreateOptions=m.contextCreateOptions?In({},m.contextCreateOptions):{},typeof m.container=="string"){let h=document.getElementById(m.container);if(!h)throw new Error(`Container '${m.container.toString()}' not found.`);this._container=h}else{if(!(m.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),i.bp(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new gd),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new nf(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,(m.style||!m.testMode)&&this.setStyle(m.style||i.d8.DEFAULT_STYLE,{config:m.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),m.hash&&(this._hash=new ao(typeof m.hash=="string"&&m.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){o.center==null&&o.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch});let h=m.bounds;h&&(this.resize(),this.fitBounds(h,i.W({},m.fitBoundsOptions,{duration:0})))}this.resize(),m.attributionControl&&this.addControl(new hp({customAttribution:m.customAttribution})),this._logoControl=new pm,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",h=>{this._update(h.dataType==="style"),this.fire(new i.f(`${h.dataType}data`,h))}),this.on("dataloading",h=>{this.fire(new i.f(`${h.dataType}dataloading`,h))})}_getMapId(){return this._mapId}addControl(m,o){if(o===void 0&&(o=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new i.d(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let h=m.onAdd(this);this._controls.push(m);let g=this._controlPositions[o];return o.indexOf("bottom")!==-1?g.insertBefore(h,g.firstChild):g.appendChild(h),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new i.d(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let o=this._controls.indexOf(m);return o>-1&&this._controls.splice(o,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));let o=!this._moving;return o&&this.fire(new i.f("movestart",m)).fire(new i.f("move",m)),this.fire(new i.f("resize",m)),o&&this.fire(new i.f("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(i.ai.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new i.f("zoomstart")).fire(new i.f("zoom")).fire(new i.f("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new i.f("zoomstart")).fire(new i.f("zoom")).fire(new i.f("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new i.f("pitchstart")).fire(new i.f("pitch")).fire(new i.f("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new i.f("pitchstart")).fire(new i.f("pitch")).fire(new i.f("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(m){return m==="auto"?navigator.language:Array.isArray(m)?m.length===0?void 0:m.map(o=>o==="auto"?navigator.language:o):m}setLanguage(m){let o=this._parseLanguage(m);if(!this.style||o===this._language)return this;this._language=o,this.style.reloadSources();for(let h of this._controls)h._setLanguage&&h._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){return this.style&&m!==this._worldview?(this._worldview=m,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(m){return this._lazyInitEmptyStyle(),m?typeof m=="string"&&(m={name:m}):m=null,this._useExplicitProjection=!!m,this._prioritizeAndUpdateProjection(m,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;let m=this.transform,o=m.projection.name,h;o==="globe"&&m.zoom>=i.aU?(m.setMercatorFromTransition(),h=!0):o==="mercator"&&m.zoom<i.aU&&(m.setProjection({name:"globe"}),h=!0),h&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(m,o){return this._updateProjection(m||o||{name:"mercator"})}_updateProjection(m){let o;return o=m.name==="globe"&&this.transform.zoom>=i.aU?this.transform.setMercatorFromTransition():this.transform.setProjection(m),this.style.applyProjectionUpdate(),o&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(m){return this.transform.locationPoint3D(i.aI.convert(m))}unproject(m){return this.transform.pointLocation3D(i.P.convert(m))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(m,o,h){if(m==="mouseenter"||m==="mouseover"){let g=!1,y=S=>{let C=o.filter(O=>this.getLayer(O)),P=C.length?this.queryRenderedFeatures(S.point,{layers:C}):[];P.length?g||(g=!0,h.call(this,new fn(m,this,S.originalEvent,{features:P}))):g=!1},b=()=>{g=!1};return{layers:new Set(o),listener:h,delegates:{mousemove:y,mouseout:b}}}if(m==="mouseleave"||m==="mouseout"){let g=!1,y=S=>{let C=o.filter(P=>this.getLayer(P));(C.length?this.queryRenderedFeatures(S.point,{layers:C}):[]).length?g=!0:g&&(g=!1,h.call(this,new fn(m,this,S.originalEvent)))},b=S=>{g&&(g=!1,h.call(this,new fn(m,this,S.originalEvent)))};return{layers:new Set(o),listener:h,delegates:{mousemove:y,mouseout:b}}}{let g=y=>{let b=o.filter(C=>this.getLayer(C)),S=b.length?this.queryRenderedFeatures(y.point,{layers:b}):[];S.length&&(y.features=S,h.call(this,y),delete y.features)};return{layers:new Set(o),listener:h,delegates:{[m]:g}}}}on(m,o,h){if(typeof o=="function"||h===void 0)return super.on(m,o);if(Array.isArray(o)||(o=[o]),o){for(let y of o)if(!this._isValidId(y))return this}let g=this._createDelegatedListener(m,o,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(g);for(let y in g.delegates)this.on(y,g.delegates[y]);return this}once(m,o,h){if(typeof o=="function"||h===void 0)return super.once(m,o);if(Array.isArray(o)||(o=[o]),o){for(let y of o)if(!this._isValidId(y))return this}let g=this._createDelegatedListener(m,o,h);for(let y in g.delegates)this.once(y,g.delegates[y]);return this}off(m,o,h){if(typeof o=="function"||h===void 0)return super.off(m,o);let g=new Set(Array.isArray(o)?o:[o]);for(let S of g)if(!this._isValidId(S))return this;let y=(S,C)=>{if(S.size!==C.size)return!1;for(let P of S)if(!C.has(P))return!1;return!0},b=this._delegatedListeners?this._delegatedListeners[m]:void 0;return b&&(S=>{for(let C=0;C<S.length;C++){let P=S[C];if(P.listener===h&&y(P.layers,g)){for(let O in P.delegates)this.off(O,P.delegates[O]);return S.splice(C,1),this}}})(b),this}queryRenderedFeatures(m,o){if(!this.style)return[];if(o!==void 0||m===void 0||m instanceof i.P||Array.isArray(m)||(o=m,m=void 0),m=m||[[0,0],[this.transform.width,this.transform.height]],(o=o||{}).layers&&Array.isArray(o.layers)){for(let h of o.layers)if(!this._isValidId(h))return[]}return this.style.queryRenderedFeatures(m,o,this.transform)}querySourceFeatures(m,o){return this._isValidId(m)?this.style.querySourceFeatures(m,o):[]}isPointOnSurface(m){let{name:o}=this.transform.projection;return o!=="globe"&&o!=="mercator"&&i.w(`${o} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(m))}setStyle(m,o){return o=i.W({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o),this.style&&m&&o.diff!==!1&&o.localFontFamily===this._localFontFamily&&o.localIdeographFontFamily===this._localIdeographFontFamily&&!o.config?(this.style._diffStyle(m,(h,g)=>{h?(i.w(`Unable to perform style diff: ${String(h.message||h.error||h)}. Rebuilding the style from scratch.`),this._updateStyle(m,o)):g&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(m,o))}_getUIString(m){let o=this._locale[m];if(o==null)throw new Error(`Missing UI string '${m}'`);return o}_updateStyle(m,o){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m){let h=i.W({},o);o&&o.config&&(h.initialConfig=o.config,delete h.config),this.style=new Dn(this,h).load(m),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Dn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(m){return m==null?(this.fire(new i.d(new Error("IDs can't be empty."))),!1):!i.cV(m)||(this.fire(new i.d(new Error(`IDs can't contain special symbols: "${m}".`))),!1)}addSource(m,o){return this._isValidId(m)?(this._lazyInitEmptyStyle(),this.style.addSource(m,o),this._update(!0)):this}isSourceLoaded(m){return!!this._isValidId(m)&&!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(m,o,h){this._lazyInitEmptyStyle(),this.style.addSourceType(m,o,h)}removeSource(m){return this._isValidId(m)?(this.style.removeSource(m),this._updateTerrain(),this._update(!0)):this}getSource(m){return this._isValidId(m)?this.style.getOwnSource(m):null}addImage(m,o,{pixelRatio:h=1,sdf:g=!1,stretchX:y,stretchY:b,content:S}={}){if(this._lazyInitEmptyStyle(),o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap){let{width:C,height:P,data:O}=i.e.getImageData(o);this.style.addImage(m,{data:new i.i({width:C,height:P},O),pixelRatio:h,stretchX:y,stretchY:b,content:S,sdf:g,version:0})}else if(o.width===void 0||o.height===void 0)this.fire(new i.d(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{let{width:C,height:P}=o,O=o;this.style.addImage(m,{data:new i.i({width:C,height:P},new Uint8Array(O.data)),pixelRatio:h,stretchX:y,stretchY:b,content:S,sdf:g,version:0,userImage:O}),O.onAdd&&O.onAdd(this,m)}}updateImage(m,o){this._lazyInitEmptyStyle();let h=this.style.getImage(m);if(!h)return void this.fire(new i.d(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let g=o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap?i.e.getImageData(o):o,{width:y,height:b,data:S}=g;if(y===void 0||b===void 0)return void this.fire(new i.d(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(y!==h.data.width||b!==h.data.height)return void this.fire(new i.d(new Error(`The width and height of the updated image (${y}, ${b})
                must be that same as the previous version of the image
                (${h.data.width}, ${h.data.height})`)));let C=!(o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap);h.data.replace(S,C),this.style.updateImage(m,h)}hasImage(m){return m?!!this.style&&!!this.style.getImage(m):(this.fire(new i.d(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,o){i.h(this._requestManager.transformRequest(m,i.R.Image),(h,g)=>{o(h,g instanceof HTMLImageElement?i.e.getImageData(g):g)})}listImages(){return this.style.listImages()}addModel(m,o){this._lazyInitEmptyStyle(),this.style.addModel(m,o)}hasModel(m){return m?this.style.hasModel(m):(this.fire(new i.d(new Error("Missing required model id"))),!1)}removeModel(m){this.style.removeModel(m)}listModels(){return this.style.listModels()}addLayer(m,o){return this._isValidId(m.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(m,o),this._update(!0)):this}getSlot(m){let o=this.getLayer(m);return o&&o.slot||null}setSlot(m,o){return this.style.setSlot(m,o),this.style.mergeLayers(),this._update(!0)}addImport(m,o){return this.style.addImport(m,o),this}updateImport(m,o){return typeof o!="string"&&o.id!==m?(this.removeImport(m),this.addImport(o)):(this.style.updateImport(m,o),this._update(!0))}removeImport(m){return this.style.removeImport(m),this}moveImport(m,o){return this.style.moveImport(m,o),this._update(!0)}moveLayer(m,o){return this._isValidId(m)?(this.style.moveLayer(m,o),this._update(!0)):this}removeLayer(m){return this._isValidId(m)?(this.style.removeLayer(m),this._update(!0)):this}getLayer(m){return this._isValidId(m)?this.style.getOwnLayer(m):null}getSlots(){return this.style.getSlots()}setLayerZoomRange(m,o,h){return this._isValidId(m)?(this.style.setLayerZoomRange(m,o,h),this._update(!0)):this}setFilter(m,o,h={}){return this._isValidId(m)?(this.style.setFilter(m,o,h),this._update(!0)):this}getFilter(m){return this._isValidId(m)?this.style.getFilter(m):null}setPaintProperty(m,o,h,g={}){return this._isValidId(m)?(this.style.setPaintProperty(m,o,h,g),this._update(!0)):this}getPaintProperty(m,o){return this._isValidId(m)?this.style.getPaintProperty(m,o):null}setLayoutProperty(m,o,h,g={}){return this._isValidId(m)?(this.style.setLayoutProperty(m,o,h,g),this._update(!0)):this}getLayoutProperty(m,o){return this._isValidId(m)?this.style.getLayoutProperty(m,o):null}getSchema(m){return this.style.getSchema(m)}setSchema(m,o){return this.style.setSchema(m,o),this._update(!0)}getConfig(m){return this.style.getConfig(m)}setConfig(m,o){return this.style.setConfig(m,o),this._update(!0)}getConfigProperty(m,o){return this.style.getConfigProperty(m,o)}setConfigProperty(m,o,h){return this.style.setConfigProperty(m,o,h),this._update(!0)}setLights(m){if(this._lazyInitEmptyStyle(),m&&m.length===1&&m[0].type==="flat"){let o=m[0];o.properties?this.style.setFlatLight(o.properties,o.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(m),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){let m=this.style.getLights()||[];return m.length===0&&m.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),m}setLight(m,o={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:m}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setColorTheme(m){return this._lazyInitEmptyStyle(),this.style.setColorTheme(m),this._update(!0)}setCamera(m){return this.style.setCamera(m),this._triggerCameraUpdate(m)}_triggerCameraUpdate(m){return this._update(this.transform.setOrthographicProjectionAtLowPitch(m["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.aI.convert(m),this.transform):0}setFeatureState(m,o){return this._isValidId(m.source)?(this.style.setFeatureState(m,o),this._update()):this}removeFeatureState(m,o){return this._isValidId(m.source)?(this.style.removeFeatureState(m,o),this._update()):this}getFeatureState(m){return this._isValidId(m.source)?this.style.getFeatureState(m):null}_updateContainerDimensions(){if(!this._container)return;let m=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300,h,g,y,b=this._container;for(;b&&(!g||!y);){let S=window.getComputedStyle(b).transform;S&&S!=="none"&&(h=S.match(/matrix.*\((.+)\)/)[1].split(", "),h[0]&&h[0]!=="0"&&h[0]!=="1"&&(g=h[0]),h[3]&&h[3]!=="0"&&h[3]!=="1"&&(y=h[3])),b=b.parentElement}this._containerWidth=g?Math.abs(m/g):m,this._containerHeight=y?Math.abs(o/y):o}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){let m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=F("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();let o=this._canvasContainer=F("div","mapboxgl-canvas-container",m);this._canvas=F("canvas","mapboxgl-canvas",o),this._interactive&&(o.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);let h=this._controlContainer=F("div","mapboxgl-control-container",m),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(y=>{g[y]=F("div",`mapboxgl-ctrl-${y}`,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,o){let h=i.e.devicePixelRatio||1;this._canvas.width=h*Math.ceil(m),this._canvas.height=h*Math.ceil(o),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${o}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){let o=this._markers.indexOf(m);o!==-1&&this._markers.splice(o,1)}_addPopup(m){this._popups.push(m)}_removePopup(m){let o=this._popups.indexOf(m);o!==-1&&this._popups.splice(o,1)}_setupPainter(){let m=i.W({},T.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._canvas.getContext("webgl2",m);o?(i.dh(o,!0),this.painter=new cm(o,this._contextCreateOptions,this.transform,this._tp),this.on("data",h=>{h.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.di.testSupport(o)):this.fire(new i.d(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.f("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new i.f("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty&&!this._occlusionOpacityChanged&&this._occlusionCriteriaSatisfied()}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let o;this.fire(new i.f("renderstart")),++this._frameId;let h=this.painter.context.extTimerQuery,g=i.e.now(),y=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(o=y.createQuery(),y.beginQuery(h.TIME_ELAPSED_EXT,o)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this._updateProjectionTransition();let b=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;let O=this.transform.zoom,j=this.transform.pitch,X=i.e.now(),re=new i.X(O,{now:X,fadeDuration:b,pitch:j,transition:this.style.transition});this.style.update(re)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let S=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),S=this._updateAverageElevation(g),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):S=this._updateAverageElevation(g);let C=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,b,this._crossSourceCollisions,this.painter.replacementSource);if(C&&(this._placementDirty=C.needsRerender,this._occlusionOpacityChanged=C.occlusionQueryBasedOpacityChanged),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:b,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.f("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,i.dc.mark(i.dd.load),this.fire(new i.f("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),o){let O=i.e.now()-g;y.endQuery(h.TIME_ELAPSED_EXT),setTimeout(()=>{let j=y.getQueryParameter(o,y.QUERY_RESULT)/1e6;y.deleteQuery(o),this.fire(new i.f("gpu-timing-frame",{cpuTime:O,gpuTime:j}))},50)}if(this.listens("gpu-timing-layer")){let O=this.painter.collectGpuTimers();setTimeout(()=>{let j=this.painter.queryGpuTimers(O);this.fire(new i.f("gpu-timing-layer",{layerTimes:j}))},50)}if(this.listens("gpu-timing-deferred-render")){let O=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{let j=this.painter.queryGpuTimeDeferredRender(O);this.fire(new i.f("gpu-timing-deferred-render",{gpuTime:j}))},50)}let P=this._sourcesDirty||this._styleDirty||this._placementDirty||this._occlusionOpacityChanged||S;if((this._sourcesDirty||this._styleDirty||S||this._occlusionOpacityChanged)&&(this._lastDirtyFrameId=this._frameId),P||this._repaint||!this._occlusionCriteriaSatisfied())this.triggerRepaint();else{let O=!this.isMoving()&&this.loaded();if(O&&(S=this._updateAverageElevation(g,!0)),S)this.triggerRepaint();else if(this._triggerFrame(!1),O&&(this.fire(new i.f("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){let j=this._calculateSpeedIndex();this.fire(new i.f("speedindexcompleted",{speedIndex:j})),this.speedIndexTiming=!1}}this._loaded&&!this._fullyLoaded&&!P&&this._occlusionCriteriaSatisfied()&&(this._fullyLoaded=!0,i.dc.mark(i.dd.fullLoad),this._performanceMetricsCollection&&i.dj(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(m){for(let o of this._markers)m&&!this.getRenderWorldCopies()&&(o._lngLat=o._lngLat.wrap()),o._update();for(let o of this._popups)!m||this.getRenderWorldCopies()||o._trackPointer||(o._lngLat=o._lngLat.wrap()),o._update()}_updateAverageElevation(m,o=!1){let h=y=>(this.transform.averageElevation=y,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&h(0);let g=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(g||(o||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){let y=this.transform.averageElevation,b=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(b)?b=0:this._averageElevationLastSampledAt=m;let S=Math.abs(y-b);if(S>1){if(this._isInitialLoad||g)return this._averageElevation.jumpTo(b),h(b);this._averageElevation.easeTo(b,m,300)}else if(S>1e-4)return this._averageElevation.jumpTo(b),h(b)}return!!this._averageElevation.isEasing(m)&&h(this._averageElevation.getValue(m))}_authenticate(){i.dk(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,m=>{if(m&&(m.message===i.dl||m.status===401)){let o=this.painter.context.gl;i.dh(o,!1),this._logoControl instanceof pm&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.d(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),i.dm(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&i.dn(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){let m=this._isDragging();this.painter.updateTerrain(this.style,m)}_calculateSpeedIndex(){let m=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());let h=this.painter.context.gl,g=h.createFramebuffer();function y(b){h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,b,0);let S=new Uint8Array(h.drawingBufferWidth*h.drawingBufferHeight*4);return h.readPixels(0,0,h.drawingBufferWidth,h.drawingBufferHeight,h.RGBA,h.UNSIGNED_BYTE,S),S}return h.bindFramebuffer(h.FRAMEBUFFER,g),this._canvasPixelComparison(y(m),o.canvasCopies.map(y),o.timeStamps)}_canvasPixelComparison(m,o,h){let g=h[1]-h[0],y=m.length/4;for(let b=0;b<o.length;b++){let S=o[b],C=0;for(let P=0;P<S.length;P+=4)S[P]===m[P]&&S[P+1]===m[P+1]&&S[P+2]===m[P+2]&&S[P+3]===m[P+3]&&(C+=1);g+=(h[b+2]-h[b+1])*(1-C/y)}return g}remove(){this._hash&&this._hash.remove();for(let o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);let m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),i.dp(this.painter.context.gl),i.dq.remove(),i.dr.remove(),this._removed=!0,this.fire(new i.f("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=i.e.frame(o=>{let h=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,h&&this._render(o)}))}_preloadTiles(m){let o=this.style?this.style.getSourceCaches():[];return i.ds(o,(h,g)=>h._preloadTiles(m,g),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(m){this._showParseStatus!==m&&(this._showParseStatus=m,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(m){this._showLayers2DWireframe!==m&&(this._showLayers2DWireframe=m,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(m){this._showLayers3DWireframe!==m&&(this._showLayers3DWireframe=m,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,this._tp.refreshUI(),m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(m){this._showTileAABBs!==m&&(this._showTileAABBs=m,this._tp.refreshUI(),m&&this._update())}_setCacheLimits(m,o){i.du(m,o)}_occlusionCriteriaSatisfied(){let m=this.style&&(this.style.has3DLayers()||this.style.terrain&&!this.style.disableElevatedTerrain);return!(this.style&&this.style.hasSymbolLayers()&&m&&this.painter)||this._frameId-this._lastDirtyFrameId>5+2*this.painter.symbolParams.occlusionQueryFrameWindow}get version(){return i.dt}},NavigationControl:class{constructor(m){this.options=i.W({},_s,m),this._container=F("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(i.bp(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",o=>{this._map&&this._map.zoomIn({},{originalEvent:o})}),F("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",o=>{this._map&&this._map.zoomOut({},{originalEvent:o})}),F("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.bp(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",o=>{let h=this._map;h&&(this.options.visualizePitch?h.resetNorthPitch({},{originalEvent:o}):h.resetNorth({},{originalEvent:o}))}),this._compassIcon=F("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){let m=this._map;if(!m)return;let o=m.getZoom(),h=o===m.getMaxZoom(),g=o===m.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())}_rotateCompassArrow(){let m=this._map;if(!m)return;let o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=o)})}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ec(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){let m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,o){let h=F("button",m,this._container);return h.type="button",h.addEventListener("click",o),h}_setButtonTitle(m,o){if(!this._map)return;let h=this._map._getUIString(`NavigationControl.${o}`);m.setAttribute("aria-label",h),m.firstElementChild&&m.firstElementChild.setAttribute("title",h)}},GeolocateControl:class extends i.E{constructor(m){super();let o=navigator.geolocation;this.options=i.W({geolocation:o},Wl,m),i.bp(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=zo(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=F("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){let o=(h=!!this.options.geolocation)=>{this._supportsGeolocation=h,m(h)};this._supportsGeolocation!==void 0?m(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(h=>o(h.state!=="denied")).catch(()=>o()):o()}_isOutOfMapMaxBounds(m){let o=this._map.getMaxBounds(),h=m.coords;return!!o&&(h.longitude<o.getWest()||h.longitude>o.getEast()||h.latitude<o.getSouth()||h.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new i.f("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.f("geolocate",m)),this._finish()}}_updateCamera(m){let o=new i.aI(m.coords.longitude,m.coords.latitude),h=m.coords.accuracy,g=this._map.getBearing(),y=i.W({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(h),y,{geolocateSource:!0})}_updateMarker(m){if(m){let o=new i.aI(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){let m=this._map.transform,o=i.ax(1,m._center.lat)*m.worldSize,h=Math.ceil(2*this._accuracy*o);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.f("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=F("button","mapboxgl-ctrl-geolocate",this._container),F("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",m===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");let o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{let o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=F("div","mapboxgl-user-location"),this._dotElement.appendChild(F("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(F("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ah({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=F("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ah({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.f("trackuserlocationend")))})}}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:m.absolute===!0&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.f("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.f("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.f("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){let m=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(o=>{o==="granted"&&m()}).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:hp,ScaleControl:class{constructor(m){this.options=i.W({},of,m),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.bp(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){let m=this.options.maxWidth||100,o=this._map,h=o._containerHeight/2,g=o._containerWidth/2-m/2,y=o.unproject([g,h]),b=o.unproject([g+m,h]),S=y.distanceTo(b);if(this.options.unit==="imperial"){let C=3.2808*S;C>5280?this._setScale(m,C/5280,"mile"):this._setScale(m,C,"foot")}else this.options.unit==="nautical"?this._setScale(m,S/1852,"nautical-mile"):S>=1e3?this._setScale(m,S/1e3,"kilometer"):this._setScale(m,S,"meter")}_setScale(m,o,h){this._map._requestDomTask(()=>{let g=function(b){let S=Math.pow(10,`${Math.floor(b)}`.length-1),C=b/S;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(P){let O=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*O)/O}(C),S*C}(o),y=g/o;this._container.innerHTML=this._isNumberFormatSupported&&h!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:h}).format(g):`${g}&nbsp;${_d[h]}`,this._container.style.width=m*y+"px"})}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=F("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m){this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:i.w("Full screen control 'container' must be a DOM element.")),i.bp(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=F("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){let m=this._fullscreenButton=F("button","mapboxgl-ctrl-fullscreen",this._controlContainer);F("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){let m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends i.E{constructor(m){super(),this.options=i.W(Object.create(pp),m),i.bp(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),m._addPopup(this),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new i.f("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);let m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),m._canvasContainer&&m._canvasContainer.classList.remove("mapboxgl-track-pointer"),m._removePopup(this),this._map=void 0),this.fire(new i.f("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=i.aI.convert(m),this._pos=null,this._trackPointer=!1,this._update();let o=this._map;return o&&(o.on("move",this._update),o.off("mousemove",this._onMouseEvent),o._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();let m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){let o=document.createDocumentFragment(),h=document.createElement("body"),g;for(h.innerHTML=m;g=h.firstChild,g;)o.appendChild(g);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let o=this._content;if(o)for(;o.hasChildNodes();)o.firstChild&&o.removeChild(o.firstChild);else o=this._content=F("div","mapboxgl-popup-content",this._container||void 0);if(o.appendChild(m),this.options.closeButton){let h=this._closeButton=F("button","mapboxgl-popup-close-button",o);h.type="button",h.setAttribute("aria-label","Close popup"),h.setAttribute("aria-hidden","true"),h.innerHTML="&#215;",h.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let o;return this._classList.delete(m)?o=!1:(this._classList.add(m),o=!0),this._updateClassList(),o}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;let o=this._map,h=this._container,g=this._pos;if(!o||!h||!g)return"bottom";let y=h.offsetWidth,b=h.offsetHeight,S=g.x<y/2,C=g.x>o.transform.width-y/2;if(g.y+m<b)return S?"top-left":C?"top-right":"top";if(g.y>o.transform.height-b){if(S)return"bottom-left";if(C)return"bottom-right"}return S?"left":C?"right":"bottom"}_updateClassList(){let m=this._container;if(!m)return;let o=[...this._classList];o.push("mapboxgl-popup"),this._anchor&&o.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&o.push("mapboxgl-popup-track-pointer"),m.className=o.join(" ")}_update(m){let o=this._map,h=this._content;if(!o||!this._lngLat&&!this._trackPointer||!h)return;let g=this._container;if(g||(g=this._container=F("div","mapboxgl-popup",o.getContainer()),this._tip=F("div","mapboxgl-popup-tip",g),g.appendChild(h)),this.options.maxWidth&&g.style.maxWidth!==this.options.maxWidth&&(g.style.maxWidth=this.options.maxWidth),o.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Lu(this._lngLat,this._pos,o.transform)),!this._trackPointer||m){let y=this._pos=this._trackPointer&&m?m:o.project(this._lngLat),b=Ru(this.options.offset),S=this._anchor=this._getAnchor(b.y),C=Ru(this.options.offset,S),P=y.add(C).round();o._requestDomTask(()=>{this._container&&S&&(this._container.style.transform=`${fp[S]} translate(${P.x}px,${P.y}px)`)})}if(!this._marker&&o._showingGlobe()){let y=i.d9(o.transform,this._lngLat)?0:1;this._setOpacity(y)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let m=this._container.querySelector(mp);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:Ah,Style:Dn,LngLat:i.aI,LngLatBounds:i.ai,Point:i.P,MercatorCoordinate:i.Y,FreeCameraOptions:sc,Evented:i.E,config:i.d8,prewarm:i.dx,clearPrewarmedResources:i.dy,get accessToken(){return i.d8.ACCESS_TOKEN},set accessToken(m){i.d8.ACCESS_TOKEN=m},get baseApiUrl(){return i.d8.API_URL},set baseApiUrl(m){i.d8.API_URL=m},get workerCount(){return i.dz.workerCount},set workerCount(m){i.dz.workerCount=m},get maxParallelImageRequests(){return i.d8.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){i.d8.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){i.dA(m)},get workerUrl(){return i.dB.workerUrl},set workerUrl(m){i.dB.workerUrl=m},get workerClass(){return i.dB.workerClass},set workerClass(m){i.dB.workerClass=m},get workerParams(){return i.dB.workerParams},set workerParams(m){i.dB.workerParams=m},get dracoUrl(){return i.dC()},set dracoUrl(m){i.dD(m)},get meshoptUrl(){return i.dE()},set meshoptUrl(m){i.dF(m)},setNow:i.e.setNow,restoreNow:i.e.restoreNow}});var f=l;return f})});function Nx(a,n){n===void 0&&(n={});var l=p7();l.p(a);var c=m7(a,n,2,4);return _7(c,n),g7(c,c.length-4,l.d()),c}function y4(a,n){return u7((x7(a),a.subarray(2,-4)),n)}var n7,Ml,Dl,Jg,Rx,Ox,w2,m4,g4,_4,T2,x4,a7,d4,S2,Hd,ia,Wh,$f,ia,ia,ia,ia,Qg,ia,o7,s7,l7,c7,v2,ih,y2,A2,v4,u7,Gd,Yg,b2,E2,f4,Kg,Lx,p4,h7,d7,f7,p7,m7,g7,_7,x7,b4=bS(()=>{"use strict";try{n7=GD("worker_threads").Worker}catch{}Ml=Uint8Array,Dl=Uint16Array,Jg=Uint32Array,Rx=new Ml([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ox=new Ml([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),w2=new Ml([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),m4=function(a,n){for(var l=new Dl(31),c=0;c<31;++c)l[c]=n+=1<<a[c-1];for(var f=new Jg(l[30]),c=1;c<30;++c)for(var i=l[c];i<l[c+1];++i)f[i]=i-l[c]<<5|c;return[l,f]},g4=m4(Rx,2),_4=g4[0],T2=g4[1];_4[28]=258,T2[258]=28;x4=m4(Ox,0),a7=x4[0],d4=x4[1],S2=new Dl(32768);for(ia=0;ia<32768;++ia)Hd=(ia&43690)>>>1|(ia&21845)<<1,Hd=(Hd&52428)>>>2|(Hd&13107)<<2,Hd=(Hd&61680)>>>4|(Hd&3855)<<4,S2[ia]=((Hd&65280)>>>8|(Hd&255)<<8)>>>1;Wh=function(a,n,l){for(var c=a.length,f=0,i=new Dl(n);f<c;++f)++i[a[f]-1];var x=new Dl(n);for(f=0;f<n;++f)x[f]=x[f-1]+i[f-1]<<1;var T;if(l){T=new Dl(1<<n);var A=15-n;for(f=0;f<c;++f)if(a[f])for(var M=f<<4|a[f],F=n-a[f],W=x[a[f]-1]++<<F,V=W|(1<<F)-1;W<=V;++W)T[S2[W]>>>A]=M}else for(T=new Dl(c),f=0;f<c;++f)T[f]=S2[x[a[f]-1]++]>>>15-a[f];return T},$f=new Ml(288);for(ia=0;ia<144;++ia)$f[ia]=8;for(ia=144;ia<256;++ia)$f[ia]=9;for(ia=256;ia<280;++ia)$f[ia]=7;for(ia=280;ia<288;++ia)$f[ia]=8;Qg=new Ml(32);for(ia=0;ia<32;++ia)Qg[ia]=5;o7=Wh($f,9,0),s7=Wh($f,9,1),l7=Wh(Qg,5,0),c7=Wh(Qg,5,1),v2=function(a){for(var n=a[0],l=1;l<a.length;++l)a[l]>n&&(n=a[l]);return n},ih=function(a,n,l){var c=n/8>>0;return(a[c]|a[c+1]<<8)>>>(n&7)&l},y2=function(a,n){var l=n/8>>0;return(a[l]|a[l+1]<<8|a[l+2]<<16)>>>(n&7)},A2=function(a){return(a/8>>0)+(a&7&&1)},v4=function(a,n,l){(n==null||n<0)&&(n=0),(l==null||l>a.length)&&(l=a.length);var c=new(a instanceof Dl?Dl:a instanceof Jg?Jg:Ml)(l-n);return c.set(a.subarray(n,l)),c},u7=function(a,n,l){var c=a.length,f=!n||l,i=!l||l.i;l||(l={}),n||(n=new Ml(c*3));var x=function(Ue){var gt=n.length;if(Ue>gt){var mt=new Ml(Math.max(gt*2,Ue));mt.set(n),n=mt}},T=l.f||0,A=l.p||0,M=l.b||0,F=l.l,W=l.d,V=l.m,R=l.n,te=c*8;do{if(!F){l.f=T=ih(a,A,1);var H=ih(a,A+1,3);if(A+=3,H)if(H==1)F=s7,W=c7,V=9,R=5;else if(H==2){var de=ih(a,A,31)+257,De=ih(a,A+10,15)+4,Fe=de+ih(a,A+5,31)+1;A+=14;for(var et=new Ml(Fe),Te=new Ml(19),ge=0;ge<De;++ge)Te[w2[ge]]=ih(a,A+ge*3,7);A+=De*3;var Ve=v2(Te),Ae=(1<<Ve)-1;if(!i&&A+Fe*(Ve+7)>te)break;for(var _e=Wh(Te,Ve,1),ge=0;ge<Fe;){var xe=_e[ih(a,A,Ae)];A+=xe&15;var J=xe>>>4;if(J<16)et[ge++]=J;else{var Qe=0,Ce=0;for(J==16?(Ce=3+ih(a,A,3),A+=2,Qe=et[ge-1]):J==17?(Ce=3+ih(a,A,7),A+=3):J==18&&(Ce=11+ih(a,A,127),A+=7);Ce--;)et[ge++]=Qe}}var Ye=et.subarray(0,de),ut=et.subarray(de);V=v2(Ye),R=v2(ut),F=Wh(Ye,V,1),W=Wh(ut,R,1)}else throw"invalid block type";else{var J=A2(A)+4,K=a[J-4]|a[J-3]<<8,ne=J+K;if(ne>c){if(i)throw"unexpected EOF";break}f&&x(M+K),n.set(a.subarray(J,ne),M),l.b=M+=K,l.p=A=ne*8;continue}if(A>te)throw"unexpected EOF"}f&&x(M+131072);for(var st=(1<<V)-1,pt=(1<<R)-1,Tt=V+R+18;i||A+Tt<te;){var Qe=F[y2(a,A)&st],ht=Qe>>>4;if(A+=Qe&15,A>te)throw"unexpected EOF";if(!Qe)throw"invalid length/literal";if(ht<256)n[M++]=ht;else if(ht==256){F=null;break}else{var Wt=ht-254;if(ht>264){var ge=ht-257,ie=Rx[ge];Wt=ih(a,A,(1<<ie)-1)+_4[ge],A+=ie}var ye=W[y2(a,A)&pt],pe=ye>>>4;if(!ye)throw"invalid distance";A+=ye&15;var ut=a7[pe];if(pe>3){var ie=Ox[pe];ut+=y2(a,A)&(1<<ie)-1,A+=ie}if(A>te)throw"unexpected EOF";f&&x(M+131072);for(var Ie=M+Wt;M<Ie;M+=4)n[M]=n[M-ut],n[M+1]=n[M+1-ut],n[M+2]=n[M+2-ut],n[M+3]=n[M+3-ut];M=Ie}}l.l=F,l.p=A,l.b=M,F&&(T=1,l.m=V,l.d=W,l.n=R)}while(!T);return M==n.length?n:v4(n,0,M)},Gd=function(a,n,l){l<<=n&7;var c=n/8>>0;a[c]|=l,a[c+1]|=l>>>8},Yg=function(a,n,l){l<<=n&7;var c=n/8>>0;a[c]|=l,a[c+1]|=l>>>8,a[c+2]|=l>>>16},b2=function(a,n){for(var l=[],c=0;c<a.length;++c)a[c]&&l.push({s:c,f:a[c]});var f=l.length,i=l.slice();if(!f)return[new Ml(0),0];if(f==1){var x=new Ml(l[0].s+1);return x[l[0].s]=1,[x,1]}l.sort(function(Fe,et){return Fe.f-et.f}),l.push({s:-1,f:25001});var T=l[0],A=l[1],M=0,F=1,W=2;for(l[0]={s:-1,f:T.f+A.f,l:T,r:A};F!=f-1;)T=l[l[M].f<l[W].f?M++:W++],A=l[M!=F&&l[M].f<l[W].f?M++:W++],l[F++]={s:-1,f:T.f+A.f,l:T,r:A};for(var V=i[0].s,c=1;c<f;++c)i[c].s>V&&(V=i[c].s);var R=new Dl(V+1),te=E2(l[F-1],R,0);if(te>n){var c=0,H=0,J=te-n,K=1<<J;for(i.sort(function(et,Te){return R[Te.s]-R[et.s]||et.f-Te.f});c<f;++c){var ne=i[c].s;if(R[ne]>n)H+=K-(1<<te-R[ne]),R[ne]=n;else break}for(H>>>=J;H>0;){var de=i[c].s;R[de]<n?H-=1<<n-R[de]++-1:++c}for(;c>=0&&H;--c){var De=i[c].s;R[De]==n&&(--R[De],++H)}te=n}return[new Ml(R),te]},E2=function(a,n,l){return a.s==-1?Math.max(E2(a.l,n,l+1),E2(a.r,n,l+1)):n[a.s]=l},f4=function(a){for(var n=a.length;n&&!a[--n];);for(var l=new Dl(++n),c=0,f=a[0],i=1,x=function(A){l[c++]=A},T=1;T<=n;++T)if(a[T]==f&&T!=n)++i;else{if(!f&&i>2){for(;i>138;i-=138)x(32754);i>2&&(x(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(x(f),--i;i>6;i-=6)x(8304);i>2&&(x(i-3<<5|8208),i=0)}for(;i--;)x(f);i=1,f=a[T]}return[l.subarray(0,c),n]},Kg=function(a,n){for(var l=0,c=0;c<n.length;++c)l+=a[c]*n[c];return l},Lx=function(a,n,l){var c=l.length,f=A2(n+2);a[f]=c&255,a[f+1]=c>>>8,a[f+2]=a[f]^255,a[f+3]=a[f+1]^255;for(var i=0;i<c;++i)a[f+i+4]=l[i];return(f+4+c)*8},p4=function(a,n,l,c,f,i,x,T,A,M,F){Gd(n,F++,l),++f[256];for(var W=b2(f,15),V=W[0],R=W[1],te=b2(i,15),H=te[0],J=te[1],K=f4(V),ne=K[0],de=K[1],De=f4(H),Fe=De[0],et=De[1],Te=new Dl(19),ge=0;ge<ne.length;++ge)Te[ne[ge]&31]++;for(var ge=0;ge<Fe.length;++ge)Te[Fe[ge]&31]++;for(var Ve=b2(Te,7),Ae=Ve[0],_e=Ve[1],xe=19;xe>4&&!Ae[w2[xe-1]];--xe);var Qe=M+5<<3,Ce=Kg(f,$f)+Kg(i,Qg)+x,Ye=Kg(f,V)+Kg(i,H)+x+14+3*xe+Kg(Te,Ae)+(2*Te[16]+3*Te[17]+7*Te[18]);if(Qe<=Ce&&Qe<=Ye)return Lx(n,F,a.subarray(A,A+M));var ut,st,pt,Tt;if(Gd(n,F,1+(Ye<Ce)),F+=2,Ye<Ce){ut=Wh(V,R,0),st=V,pt=Wh(H,J,0),Tt=H;var ht=Wh(Ae,_e,0);Gd(n,F,de-257),Gd(n,F+5,et-1),Gd(n,F+10,xe-4),F+=14;for(var ge=0;ge<xe;++ge)Gd(n,F+3*ge,Ae[w2[ge]]);F+=3*xe;for(var Wt=[ne,Fe],ie=0;ie<2;++ie)for(var ye=Wt[ie],ge=0;ge<ye.length;++ge){var pe=ye[ge]&31;Gd(n,F,ht[pe]),F+=Ae[pe],pe>15&&(Gd(n,F,ye[ge]>>>5&127),F+=ye[ge]>>>12)}}else ut=o7,st=$f,pt=l7,Tt=Qg;for(var ge=0;ge<T;++ge)if(c[ge]>255){var pe=c[ge]>>>18&31;Yg(n,F,ut[pe+257]),F+=st[pe+257],pe>7&&(Gd(n,F,c[ge]>>>23&31),F+=Rx[pe]);var Ie=c[ge]&31;Yg(n,F,pt[Ie]),F+=Tt[Ie],Ie>3&&(Yg(n,F,c[ge]>>>5&8191),F+=Ox[Ie])}else Yg(n,F,ut[c[ge]]),F+=st[c[ge]];return Yg(n,F,ut[256]),F+st[256]},h7=new Jg([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),d7=new Ml(0),f7=function(a,n,l,c,f,i){var x=a.length,T=new Ml(c+x+5*(1+Math.floor(x/7e3))+f),A=T.subarray(c,T.length-f),M=0;if(!n||x<8)for(var F=0;F<=x;F+=65535){var W=F+65535;W<x?M=Lx(A,M,a.subarray(F,W)):(A[F]=i,M=Lx(A,M,a.subarray(F,x)))}else{for(var V=h7[n-1],R=V>>>13,te=V&8191,H=(1<<l)-1,J=new Dl(32768),K=new Dl(H+1),ne=Math.ceil(l/3),de=2*ne,De=function(Pi){return(a[Pi]^a[Pi+1]<<ne^a[Pi+2]<<de)&H},Fe=new Jg(25e3),et=new Dl(288),Te=new Dl(32),ge=0,Ve=0,F=0,Ae=0,_e=0,xe=0;F<x;++F){var Qe=De(F),Ce=F&32767,Ye=K[Qe];if(J[Ce]=Ye,K[Qe]=Ce,_e<=F){var ut=x-F;if((ge>7e3||Ae>24576)&&ut>423){M=p4(a,A,0,Fe,et,Te,Ve,Ae,xe,F-xe,M),Ae=ge=Ve=0,xe=F;for(var st=0;st<286;++st)et[st]=0;for(var st=0;st<30;++st)Te[st]=0}var pt=2,Tt=0,ht=te,Wt=Ce-Ye&32767;if(ut>2&&Qe==De(F-Wt))for(var ie=Math.min(R,ut)-1,ye=Math.min(32767,F),pe=Math.min(258,ut);Wt<=ye&&--ht&&Ce!=Ye;){if(a[F+pt]==a[F+pt-Wt]){for(var Ie=0;Ie<pe&&a[F+Ie]==a[F+Ie-Wt];++Ie);if(Ie>pt){if(pt=Ie,Tt=Wt,Ie>ie)break;for(var Ue=Math.min(Wt,Ie-2),gt=0,st=0;st<Ue;++st){var mt=F-Wt+st+32768&32767,wt=J[mt],Lt=mt-wt+32768&32767;Lt>gt&&(gt=Lt,Ye=mt)}}}Ce=Ye,Ye=J[Ce],Wt+=Ce-Ye+32768&32767}if(Tt){Fe[Ae++]=268435456|T2[pt]<<18|d4[Tt];var fi=T2[pt]&31,yi=d4[Tt]&31;Ve+=Rx[fi]+Ox[yi],++et[257+fi],++Te[yi],_e=F+pt,++ge}else Fe[Ae++]=a[F],++et[a[F]]}}M=p4(a,A,i,Fe,et,Te,Ve,Ae,xe,F-xe,M),i||(M=Lx(A,M,d7))}return v4(T,0,c+A2(M)+f)},p7=function(){var a=1,n=0;return{p:function(l){for(var c=a,f=n,i=l.length,x=0;x!=i;){for(var T=Math.min(x+5552,i);x<T;++x)c+=l[x],f+=c;c%=65521,f%=65521}a=c,n=f},d:function(){return(a>>>8<<16|(n&255)<<8|n>>>8)+((a&255)<<23)*2}}},m7=function(a,n,l,c,f){return f7(a,n.level==null?6:n.level,n.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(a.length)))*1.5):12+n.mem,l,c,!f)},g7=function(a,n,l){for(;l;++n)a[n]=l,l>>>=8},_7=function(a,n){var l=n.level,c=l==0?0:l<6?1:l==9?3:2;a[0]=120,a[1]=c<<6|(c?32-2*c:1)},x7=function(a){if((a[0]&15)!=8||a[0]>>>4>7||(a[0]<<8|a[1])%31)throw"invalid zlib data";if(a[1]&32)throw"invalid zlib data: preset dictionaries not supported"}});var V2={};WD(V2,{AcroForm:()=>P7,AcroFormAppearance:()=>rr,AcroFormButton:()=>ns,AcroFormCheckBox:()=>r_,AcroFormChoiceField:()=>tm,AcroFormComboBox:()=>rm,AcroFormEditBox:()=>t_,AcroFormListBox:()=>im,AcroFormPasswordField:()=>n_,AcroFormPushButton:()=>i_,AcroFormRadioButton:()=>nm,AcroFormTextField:()=>Kf,GState:()=>a_,ShadingPattern:()=>Zf,TilingPattern:()=>em,default:()=>j2,jsPDF:()=>Lr});function C2(){zr.console&&typeof zr.console.log=="function"&&zr.console.log.apply(zr.console,arguments)}function I2(a,n,l){var c=new XMLHttpRequest;c.open("GET",a),c.responseType="blob",c.onload=function(){Qp(c.response,n,l)},c.onerror=function(){Pa.error("could not download file")},c.send()}function w4(a){var n=new XMLHttpRequest;n.open("HEAD",a,!1);try{n.send()}catch{}return n.status>=200&&n.status<=299}function Bx(a){try{a.dispatchEvent(new MouseEvent("click"))}catch{var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(n)}}function z4(a){var n;a=a||"",this.ok=!1,a.charAt(0)=="#"&&(a=a.substr(1,6)),a={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[a=(a=a.replace(/ /g,"")).toLowerCase()]||a;for(var l=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(T){return[parseInt(T[1]),parseInt(T[2]),parseInt(T[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(T){return[parseInt(T[1],16),parseInt(T[2],16),parseInt(T[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(T){return[parseInt(T[1]+T[1],16),parseInt(T[2]+T[2],16),parseInt(T[3]+T[3],16)]}}],c=0;c<l.length;c++){var f=l[c].re,i=l[c].process,x=f.exec(a);x&&(n=i(x),this.r=n[0],this.g=n[1],this.b=n[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var T=this.r.toString(16),A=this.g.toString(16),M=this.b.toString(16);return T.length==1&&(T="0"+T),A.length==1&&(A="0"+A),M.length==1&&(M="0"+M),"#"+T+A+M}}function k2(a,n){var l=a[0],c=a[1],f=a[2],i=a[3];l=ll(l,c,f,i,n[0],7,-680876936),i=ll(i,l,c,f,n[1],12,-389564586),f=ll(f,i,l,c,n[2],17,606105819),c=ll(c,f,i,l,n[3],22,-1044525330),l=ll(l,c,f,i,n[4],7,-176418897),i=ll(i,l,c,f,n[5],12,1200080426),f=ll(f,i,l,c,n[6],17,-1473231341),c=ll(c,f,i,l,n[7],22,-45705983),l=ll(l,c,f,i,n[8],7,1770035416),i=ll(i,l,c,f,n[9],12,-1958414417),f=ll(f,i,l,c,n[10],17,-42063),c=ll(c,f,i,l,n[11],22,-1990404162),l=ll(l,c,f,i,n[12],7,1804603682),i=ll(i,l,c,f,n[13],12,-40341101),f=ll(f,i,l,c,n[14],17,-1502002290),l=cl(l,c=ll(c,f,i,l,n[15],22,1236535329),f,i,n[1],5,-165796510),i=cl(i,l,c,f,n[6],9,-1069501632),f=cl(f,i,l,c,n[11],14,643717713),c=cl(c,f,i,l,n[0],20,-373897302),l=cl(l,c,f,i,n[5],5,-701558691),i=cl(i,l,c,f,n[10],9,38016083),f=cl(f,i,l,c,n[15],14,-660478335),c=cl(c,f,i,l,n[4],20,-405537848),l=cl(l,c,f,i,n[9],5,568446438),i=cl(i,l,c,f,n[14],9,-1019803690),f=cl(f,i,l,c,n[3],14,-187363961),c=cl(c,f,i,l,n[8],20,1163531501),l=cl(l,c,f,i,n[13],5,-1444681467),i=cl(i,l,c,f,n[2],9,-51403784),f=cl(f,i,l,c,n[7],14,1735328473),l=ul(l,c=cl(c,f,i,l,n[12],20,-1926607734),f,i,n[5],4,-378558),i=ul(i,l,c,f,n[8],11,-2022574463),f=ul(f,i,l,c,n[11],16,1839030562),c=ul(c,f,i,l,n[14],23,-35309556),l=ul(l,c,f,i,n[1],4,-1530992060),i=ul(i,l,c,f,n[4],11,1272893353),f=ul(f,i,l,c,n[7],16,-155497632),c=ul(c,f,i,l,n[10],23,-1094730640),l=ul(l,c,f,i,n[13],4,681279174),i=ul(i,l,c,f,n[0],11,-358537222),f=ul(f,i,l,c,n[3],16,-722521979),c=ul(c,f,i,l,n[6],23,76029189),l=ul(l,c,f,i,n[9],4,-640364487),i=ul(i,l,c,f,n[12],11,-421815835),f=ul(f,i,l,c,n[15],16,530742520),l=hl(l,c=ul(c,f,i,l,n[2],23,-995338651),f,i,n[0],6,-198630844),i=hl(i,l,c,f,n[7],10,1126891415),f=hl(f,i,l,c,n[14],15,-1416354905),c=hl(c,f,i,l,n[5],21,-57434055),l=hl(l,c,f,i,n[12],6,1700485571),i=hl(i,l,c,f,n[3],10,-1894986606),f=hl(f,i,l,c,n[10],15,-1051523),c=hl(c,f,i,l,n[1],21,-2054922799),l=hl(l,c,f,i,n[8],6,1873313359),i=hl(i,l,c,f,n[15],10,-30611744),f=hl(f,i,l,c,n[6],15,-1560198380),c=hl(c,f,i,l,n[13],21,1309151649),l=hl(l,c,f,i,n[4],6,-145523070),i=hl(i,l,c,f,n[11],10,-1120210379),f=hl(f,i,l,c,n[2],15,718787259),c=hl(c,f,i,l,n[9],21,-343485551),a[0]=Yf(l,a[0]),a[1]=Yf(c,a[1]),a[2]=Yf(f,a[2]),a[3]=Yf(i,a[3])}function Hx(a,n,l,c,f,i){return n=Yf(Yf(n,a),Yf(c,i)),Yf(n<<f|n>>>32-f,l)}function ll(a,n,l,c,f,i,x){return Hx(n&l|~n&c,a,n,f,i,x)}function cl(a,n,l,c,f,i,x){return Hx(n&c|l&~c,a,n,f,i,x)}function ul(a,n,l,c,f,i,x){return Hx(n^l^c,a,n,f,i,x)}function hl(a,n,l,c,f,i,x){return Hx(l^(n|~c),a,n,f,i,x)}function j4(a){var n,l=a.length,c=[1732584193,-271733879,-1732584194,271733878];for(n=64;n<=a.length;n+=64)k2(c,v7(a.substring(n-64,n)));a=a.substring(n-64);var f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<a.length;n++)f[n>>2]|=a.charCodeAt(n)<<(n%4<<3);if(f[n>>2]|=128<<(n%4<<3),n>55)for(k2(c,f),n=0;n<16;n++)f[n]=0;return f[14]=8*l,k2(c,f),c}function v7(a){var n,l=[];for(n=0;n<64;n+=4)l[n>>2]=a.charCodeAt(n)+(a.charCodeAt(n+1)<<8)+(a.charCodeAt(n+2)<<16)+(a.charCodeAt(n+3)<<24);return l}function y7(a){for(var n="",l=0;l<4;l++)n+=T4[a>>8*l+4&15]+T4[a>>8*l&15];return n}function b7(a){return String.fromCharCode((255&a)>>0,(65280&a)>>8,(16711680&a)>>16,(4278190080&a)>>24)}function L2(a){return j4(a).map(b7).join("")}function Yf(a,n){if(w7){var l=(65535&a)+(65535&n);return(a>>16)+(n>>16)+(l>>16)<<16|65535&l}return a+n&4294967295}function R2(a,n){var l,c,f,i;if(a!==l){for(var x=(f=a,i=1+(256/a.length>>0),new Array(i+1).join(f)),T=[],A=0;A<256;A++)T[A]=A;var M=0;for(A=0;A<256;A++){var F=T[A];M=(M+F+x.charCodeAt(A))%256,T[A]=T[M],T[M]=F}l=a,c=T}else T=c;var W=n.length,V=0,R=0,te="";for(A=0;A<W;A++)R=(R+(F=T[V=(V+1)%256]))%256,T[V]=T[R],T[R]=F,x=T[(T[V]+T[R])%256],te+=String.fromCharCode(n.charCodeAt(A)^x);return te}function A0(a,n,l,c){this.v=1,this.r=2;var f=192;a.forEach(function(T){if(S4.perm!==void 0)throw new Error("Invalid permission: "+T);f+=S4[T]}),this.padding="(\xBFN^Nu\x8AAd\0NV\xFF\xFA\b..\0\xB6\xD0h>\x80/\f\xA9\xFEdSiz";var i=(n+this.padding).substr(0,32),x=(l+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,x),this.P=-(1+(255^f)),this.encryptionKey=L2(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(c)).substr(0,5),this.U=R2(this.encryptionKey,this.padding)}function C0(a){if(/[^\u0000-\u00ff]/.test(a))throw new Error("Invalid PDF Name Object: "+a+", Only accept ASCII characters.");for(var n="",l=a.length,c=0;c<l;c++){var f=a.charCodeAt(c);f<33||f===35||f===37||f===40||f===41||f===47||f===60||f===62||f===91||f===93||f===123||f===125||f>126?n+="#"+("0"+f.toString(16)).slice(-2):n+=a[c]}return n}function E4(a){if((0,Ia.default)(a)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var n={};this.subscribe=function(l,c,f){if(f=f||!1,typeof l!="string"||typeof c!="function"||typeof f!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");n.hasOwnProperty(l)||(n[l]={});var i=Math.random().toString(35);return n[l][i]=[c,!!f],i},this.unsubscribe=function(l){for(var c in n)if(n[c][l])return delete n[c][l],Object.keys(n[c]).length===0&&delete n[c],!0;return!1},this.publish=function(l){if(n.hasOwnProperty(l)){var c=Array.prototype.slice.call(arguments,1),f=[];for(var i in n[l]){var x=n[l][i];try{x[0].apply(a,c)}catch(T){zr.console&&Pa.error("jsPDF PubSub Error",T.message,T)}x[1]&&f.push(i)}f.length&&f.forEach(this.unsubscribe)}},this.getTopics=function(){return n}}function a_(a){if(!(this instanceof a_))return new a_(a);var n="opacity,stroke-opacity".split(",");for(var l in a)a.hasOwnProperty(l)&&n.indexOf(l)>=0&&(this[l]=a[l]);this.id="",this.objectNumber=-1}function V4(a,n){this.gState=a,this.matrix=n,this.id="",this.objectNumber=-1}function Zf(a,n,l,c,f){if(!(this instanceof Zf))return new Zf(a,n,l,c,f);this.type=a==="axial"?2:3,this.coords=n,this.colors=l,V4.call(this,c,f)}function em(a,n,l,c,f){if(!(this instanceof em))return new em(a,n,l,c,f);this.boundingBox=a,this.xStep=n,this.yStep=l,this.stream="",this.cloneIndex=0,V4.call(this,c,f)}function Lr(a){var n,l=typeof arguments[0]=="string"?arguments[0]:"p",c=arguments[1],f=arguments[2],i=arguments[3],x=[],T=1,A=16,M="S",F=null;(0,Ia.default)(a=a||{})==="object"&&(l=a.orientation,c=a.unit||c,f=a.format||f,i=a.compress||a.compressPdf||i,(F=a.encryption||null)!==null&&(F.userPassword=F.userPassword||"",F.ownerPassword=F.ownerPassword||"",F.userPermissions=F.userPermissions||[]),T=typeof a.userUnit=="number"?Math.abs(a.userUnit):1,a.precision!==void 0&&(n=a.precision),a.floatPrecision!==void 0&&(A=a.floatPrecision),M=a.defaultPathOperation||"S"),x=a.filters||(i===!0?["FlateEncode"]:x),c=c||"mm",l=(""+(l||"P")).toLowerCase();var W=a.putOnlyUsedFonts||!1,V={},R={internal:{},__private__:{}};R.__private__.PubSub=E4;var te="1.3",H=R.__private__.getPdfVersion=function(){return te};R.__private__.setPdfVersion=function(U){te=U};var J={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};R.__private__.getPageFormats=function(){return J};var K=R.__private__.getPageFormat=function(U){return J[U]};f=f||"a4";var ne={COMPAT:"compat",ADVANCED:"advanced"},de=ne.COMPAT;function De(){this.saveGraphicsState(),lt(new Ki(Ri,0,0,-Ri,0,ks()*Ri).toString()+" cm"),this.setFontSize(this.getFontSize()/Ri),M="n",de=ne.ADVANCED}function Fe(){this.restoreGraphicsState(),M="S",de=ne.COMPAT}var et=R.__private__.combineFontStyleAndFontWeight=function(U,Ee){if(U=="bold"&&Ee=="normal"||U=="bold"&&Ee==400||U=="normal"&&Ee=="italic"||U=="bold"&&Ee=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Ee&&(U=Ee==400||Ee==="normal"?U==="italic"?"italic":"normal":Ee!=700&&Ee!=="bold"||U!=="normal"?(Ee==700?"bold":Ee)+""+U:"bold"),U};R.advancedAPI=function(U){var Ee=de===ne.COMPAT;return Ee&&De.call(this),typeof U!="function"||(U(this),Ee&&Fe.call(this)),this},R.compatAPI=function(U){var Ee=de===ne.ADVANCED;return Ee&&Fe.call(this),typeof U!="function"||(U(this),Ee&&De.call(this)),this},R.isAdvancedAPI=function(){return de===ne.ADVANCED};var Te,ge=function(U){if(de!==ne.ADVANCED)throw new Error(U+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Ve=R.roundToPrecision=R.__private__.roundToPrecision=function(U,Ee){var ct=n||Ee;if(isNaN(U)||isNaN(ct))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return U.toFixed(ct).replace(/0+$/,"")};Te=R.hpf=R.__private__.hpf=typeof A=="number"?function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.hpf");return Ve(U,A)}:A==="smart"?function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.hpf");return Ve(U,U>-1&&U<1?16:5)}:function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.hpf");return Ve(U,16)};var Ae=R.f2=R.__private__.f2=function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.f2");return Ve(U,2)},_e=R.__private__.f3=function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.f3");return Ve(U,3)},xe=R.scale=R.__private__.scale=function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.scale");return de===ne.COMPAT?U*Ri:de===ne.ADVANCED?U:void 0},Qe=function(U){return de===ne.COMPAT?ks()-U:de===ne.ADVANCED?U:void 0},Ce=function(U){return xe(Qe(U))};R.__private__.setPrecision=R.setPrecision=function(U){typeof parseInt(U,10)=="number"&&(n=parseInt(U,10))};var Ye,ut="00000000000000000000000000000000",st=R.__private__.getFileId=function(){return ut},pt=R.__private__.setFileId=function(U){return ut=U!==void 0&&/^[a-fA-F0-9]{32}$/.test(U)?U.toUpperCase():ut.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),F!==null&&(Ua=new A0(F.userPermissions,F.userPassword,F.ownerPassword,ut)),ut};R.setFileId=function(U){return pt(U),this},R.getFileId=function(){return st()};var Tt=R.__private__.convertDateToPDFDate=function(U){var Ee=U.getTimezoneOffset(),ct=Ee<0?"+":"-",vt=Math.floor(Math.abs(Ee/60)),Rt=Math.abs(Ee%60),si=[ct,pe(vt),"'",pe(Rt),"'"].join("");return["D:",U.getFullYear(),pe(U.getMonth()+1),pe(U.getDate()),pe(U.getHours()),pe(U.getMinutes()),pe(U.getSeconds()),si].join("")},ht=R.__private__.convertPDFDateToDate=function(U){var Ee=parseInt(U.substr(2,4),10),ct=parseInt(U.substr(6,2),10)-1,vt=parseInt(U.substr(8,2),10),Rt=parseInt(U.substr(10,2),10),si=parseInt(U.substr(12,2),10),Mi=parseInt(U.substr(14,2),10);return new Date(Ee,ct,vt,Rt,si,Mi,0)},Wt=R.__private__.setCreationDate=function(U){var Ee;if(U===void 0&&(U=new Date),U instanceof Date)Ee=Tt(U);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(U))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Ee=U}return Ye=Ee},ie=R.__private__.getCreationDate=function(U){var Ee=Ye;return U==="jsDate"&&(Ee=ht(Ye)),Ee};R.setCreationDate=function(U){return Wt(U),this},R.getCreationDate=function(U){return ie(U)};var ye,pe=R.__private__.padd2=function(U){return("0"+parseInt(U)).slice(-2)},Ie=R.__private__.padd2Hex=function(U){return("00"+(U=U.toString())).substr(U.length)},Ue=0,gt=[],mt=[],wt=0,Lt=[],fi=[],yi=!1,Fi=mt,Pi=function(){Ue=0,wt=0,mt=[],gt=[],Lt=[],G=$n(),Q=$n()};R.__private__.setCustomOutputDestination=function(U){yi=!0,Fi=U};var $t=function(U){yi||(Fi=U)};R.__private__.resetCustomOutputDestination=function(){yi=!1,Fi=mt};var lt=R.__private__.out=function(U){return U=U.toString(),wt+=U.length+1,Fi.push(U),Fi},Bt=R.__private__.write=function(U){return lt(arguments.length===1?U.toString():Array.prototype.join.call(arguments," "))},ni=R.__private__.getArrayBuffer=function(U){for(var Ee=U.length,ct=new ArrayBuffer(Ee),vt=new Uint8Array(ct);Ee--;)vt[Ee]=U.charCodeAt(Ee);return ct},bi=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];R.__private__.getStandardFonts=function(){return bi};var ki=a.fontSize||16;R.__private__.setFontSize=R.setFontSize=function(U){return ki=de===ne.ADVANCED?U/Ri:U,this};var Ni,Bi=R.__private__.getFontSize=R.getFontSize=function(){return de===ne.COMPAT?ki:ki*Ri},tr=a.R2L||!1;R.__private__.setR2L=R.setR2L=function(U){return tr=U,this},R.__private__.getR2L=R.getR2L=function(){return tr};var ar,vr=R.__private__.setZoomMode=function(U){var Ee=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(U))Ni=U;else if(isNaN(U)){if(Ee.indexOf(U)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+U+'" is not recognized.');Ni=U}else Ni=parseInt(U,10)};R.__private__.getZoomMode=function(){return Ni};var kr,qr=R.__private__.setPageMode=function(U){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(U)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+U+'" is not recognized.');ar=U};R.__private__.getPageMode=function(){return ar};var Kr=R.__private__.setLayoutMode=function(U){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(U)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+U+'" is not recognized.');kr=U};R.__private__.getLayoutMode=function(){return kr},R.__private__.setDisplayMode=R.setDisplayMode=function(U,Ee,ct){return vr(U),Kr(Ee),qr(ct),this};var xr={title:"",subject:"",author:"",keywords:"",creator:""};R.__private__.getDocumentProperty=function(U){if(Object.keys(xr).indexOf(U)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return xr[U]},R.__private__.getDocumentProperties=function(){return xr},R.__private__.setDocumentProperties=R.setProperties=R.setDocumentProperties=function(U){for(var Ee in xr)xr.hasOwnProperty(Ee)&&U[Ee]&&(xr[Ee]=U[Ee]);return this},R.__private__.setDocumentProperty=function(U,Ee){if(Object.keys(xr).indexOf(U)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return xr[U]=Ee};var Or,Ri,La,Di,go,fr={},Sn={},_o=[],$r={},so={},Rn={},Ja={},xo=null,vn=0,Ar=[],dn=new E4(R),as=a.hotfixes||[],kn={},lo={},ka=[],Ki=function U(Ee,ct,vt,Rt,si,Mi){if(!(this instanceof U))return new U(Ee,ct,vt,Rt,si,Mi);isNaN(Ee)&&(Ee=1),isNaN(ct)&&(ct=0),isNaN(vt)&&(vt=0),isNaN(Rt)&&(Rt=1),isNaN(si)&&(si=0),isNaN(Mi)&&(Mi=0),this._matrix=[Ee,ct,vt,Rt,si,Mi]};Object.defineProperty(Ki.prototype,"sx",{get:function(){return this._matrix[0]},set:function(U){this._matrix[0]=U}}),Object.defineProperty(Ki.prototype,"shy",{get:function(){return this._matrix[1]},set:function(U){this._matrix[1]=U}}),Object.defineProperty(Ki.prototype,"shx",{get:function(){return this._matrix[2]},set:function(U){this._matrix[2]=U}}),Object.defineProperty(Ki.prototype,"sy",{get:function(){return this._matrix[3]},set:function(U){this._matrix[3]=U}}),Object.defineProperty(Ki.prototype,"tx",{get:function(){return this._matrix[4]},set:function(U){this._matrix[4]=U}}),Object.defineProperty(Ki.prototype,"ty",{get:function(){return this._matrix[5]},set:function(U){this._matrix[5]=U}}),Object.defineProperty(Ki.prototype,"a",{get:function(){return this._matrix[0]},set:function(U){this._matrix[0]=U}}),Object.defineProperty(Ki.prototype,"b",{get:function(){return this._matrix[1]},set:function(U){this._matrix[1]=U}}),Object.defineProperty(Ki.prototype,"c",{get:function(){return this._matrix[2]},set:function(U){this._matrix[2]=U}}),Object.defineProperty(Ki.prototype,"d",{get:function(){return this._matrix[3]},set:function(U){this._matrix[3]=U}}),Object.defineProperty(Ki.prototype,"e",{get:function(){return this._matrix[4]},set:function(U){this._matrix[4]=U}}),Object.defineProperty(Ki.prototype,"f",{get:function(){return this._matrix[5]},set:function(U){this._matrix[5]=U}}),Object.defineProperty(Ki.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Ki.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Ki.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Ki.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Ki.prototype.join=function(U){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(Te).join(U)},Ki.prototype.multiply=function(U){var Ee=U.sx*this.sx+U.shy*this.shx,ct=U.sx*this.shy+U.shy*this.sy,vt=U.shx*this.sx+U.sy*this.shx,Rt=U.shx*this.shy+U.sy*this.sy,si=U.tx*this.sx+U.ty*this.shx+this.tx,Mi=U.tx*this.shy+U.ty*this.sy+this.ty;return new Ki(Ee,ct,vt,Rt,si,Mi)},Ki.prototype.decompose=function(){var U=this.sx,Ee=this.shy,ct=this.shx,vt=this.sy,Rt=this.tx,si=this.ty,Mi=Math.sqrt(U*U+Ee*Ee),Zi=(U/=Mi)*ct+(Ee/=Mi)*vt;ct-=U*Zi,vt-=Ee*Zi;var cr=Math.sqrt(ct*ct+vt*vt);return Zi/=cr,U*(vt/=cr)<Ee*(ct/=cr)&&(U=-U,Ee=-Ee,Zi=-Zi,Mi=-Mi),{scale:new Ki(Mi,0,0,cr,0,0),translate:new Ki(1,0,0,1,Rt,si),rotate:new Ki(U,Ee,-Ee,U,0,0),skew:new Ki(1,0,Zi,1,0,0)}},Ki.prototype.toString=function(U){return this.join(" ")},Ki.prototype.inversed=function(){var U=this.sx,Ee=this.shy,ct=this.shx,vt=this.sy,Rt=this.tx,si=this.ty,Mi=1/(U*vt-Ee*ct),Zi=vt*Mi,cr=-Ee*Mi,Mr=-ct*Mi,ur=U*Mi;return new Ki(Zi,cr,Mr,ur,-Zi*Rt-Mr*si,-cr*Rt-ur*si)},Ki.prototype.applyToPoint=function(U){var Ee=U.x*this.sx+U.y*this.shx+this.tx,ct=U.x*this.shy+U.y*this.sy+this.ty;return new Nn(Ee,ct)},Ki.prototype.applyToRectangle=function(U){var Ee=this.applyToPoint(U),ct=this.applyToPoint(new Nn(U.x+U.w,U.y+U.h));return new ls(Ee.x,Ee.y,ct.x-Ee.x,ct.y-Ee.y)},Ki.prototype.clone=function(){var U=this.sx,Ee=this.shy,ct=this.shx,vt=this.sy,Rt=this.tx,si=this.ty;return new Ki(U,Ee,ct,vt,Rt,si)},R.Matrix=Ki;var Ro=R.matrixMult=function(U,Ee){return Ee.multiply(U)},Qa=new Ki(1,0,0,1,0,0);R.unitMatrix=R.identityMatrix=Qa;var Va=function(U,Ee){if(!so[U]){var ct=(Ee instanceof Zf?"Sh":"P")+(Object.keys($r).length+1).toString(10);Ee.id=ct,so[U]=ct,$r[ct]=Ee,dn.publish("addPattern",Ee)}};R.ShadingPattern=Zf,R.TilingPattern=em,R.addShadingPattern=function(U,Ee){return ge("addShadingPattern()"),Va(U,Ee),this},R.beginTilingPattern=function(U){ge("beginTilingPattern()"),$s(U.boundingBox[0],U.boundingBox[1],U.boundingBox[2]-U.boundingBox[0],U.boundingBox[3]-U.boundingBox[1],U.matrix)},R.endTilingPattern=function(U,Ee){ge("endTilingPattern()"),Ee.stream=fi[ye].join(`
`),Va(U,Ee),dn.publish("endTilingPattern",Ee),ka.pop().restore()};var ca=R.__private__.newObject=function(){var U=$n();return ee(U,!0),U},$n=R.__private__.newObjectDeferred=function(){return Ue++,gt[Ue]=function(){return wt},Ue},ee=function(U,Ee){return Ee=typeof Ee=="boolean"&&Ee,gt[U]=wt,Ee&&lt(U+" 0 obj"),U},z=R.__private__.newAdditionalObject=function(){var U={objId:$n(),content:""};return Lt.push(U),U},G=$n(),Q=$n(),se=R.__private__.decodeColorString=function(U){var Ee=U.split(" ");if(Ee.length!==2||Ee[1]!=="g"&&Ee[1]!=="G")Ee.length===5&&(Ee[4]==="k"||Ee[4]==="K")&&(Ee=[(1-Ee[0])*(1-Ee[3]),(1-Ee[1])*(1-Ee[3]),(1-Ee[2])*(1-Ee[3]),"r"]);else{var ct=parseFloat(Ee[0]);Ee=[ct,ct,ct,"r"]}for(var vt="#",Rt=0;Rt<3;Rt++)vt+=("0"+Math.floor(255*parseFloat(Ee[Rt])).toString(16)).slice(-2);return vt},le=R.__private__.encodeColorString=function(U){var Ee;typeof U=="string"&&(U={ch1:U});var ct=U.ch1,vt=U.ch2,Rt=U.ch3,si=U.ch4,Mi=U.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ct=="string"&&ct.charAt(0)!=="#"){var Zi=new z4(ct);if(Zi.ok)ct=Zi.toHex();else if(!/^\d*\.?\d*$/.test(ct))throw new Error('Invalid color "'+ct+'" passed to jsPDF.encodeColorString.')}if(typeof ct=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ct)&&(ct="#"+ct[1]+ct[1]+ct[2]+ct[2]+ct[3]+ct[3]),typeof ct=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ct)){var cr=parseInt(ct.substr(1),16);ct=cr>>16&255,vt=cr>>8&255,Rt=255&cr}if(vt===void 0||si===void 0&&ct===vt&&vt===Rt)if(typeof ct=="string")Ee=ct+" "+Mi[0];else switch(U.precision){case 2:Ee=Ae(ct/255)+" "+Mi[0];break;case 3:default:Ee=_e(ct/255)+" "+Mi[0]}else if(si===void 0||(0,Ia.default)(si)==="object"){if(si&&!isNaN(si.a)&&si.a===0)return Ee=["1.","1.","1.",Mi[1]].join(" ");if(typeof ct=="string")Ee=[ct,vt,Rt,Mi[1]].join(" ");else switch(U.precision){case 2:Ee=[Ae(ct/255),Ae(vt/255),Ae(Rt/255),Mi[1]].join(" ");break;default:case 3:Ee=[_e(ct/255),_e(vt/255),_e(Rt/255),Mi[1]].join(" ")}}else if(typeof ct=="string")Ee=[ct,vt,Rt,si,Mi[2]].join(" ");else switch(U.precision){case 2:Ee=[Ae(ct),Ae(vt),Ae(Rt),Ae(si),Mi[2]].join(" ");break;case 3:default:Ee=[_e(ct),_e(vt),_e(Rt),_e(si),Mi[2]].join(" ")}return Ee},Me=R.__private__.getFilters=function(){return x},Ze=R.__private__.putStream=function(U){var Ee=(U=U||{}).data||"",ct=U.filters||Me(),vt=U.alreadyAppliedFilters||[],Rt=U.addLength1||!1,si=Ee.length,Mi=U.objectId,Zi=function(vo){return vo};if(F!==null&&Mi===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");F!==null&&(Zi=Ua.encryptor(Mi,0));var cr={};ct===!0&&(ct=["FlateEncode"]);var Mr=U.additionalKeyValues||[],ur=(cr=Lr.API.processDataByFilters!==void 0?Lr.API.processDataByFilters(Ee,ct):{data:Ee,reverseChain:[]}).reverseChain+(Array.isArray(vt)?vt.join(" "):vt.toString());if(cr.data.length!==0&&(Mr.push({key:"Length",value:cr.data.length}),Rt===!0&&Mr.push({key:"Length1",value:si})),ur.length!=0)if(ur.split("/").length-1==1)Mr.push({key:"Filter",value:ur});else{Mr.push({key:"Filter",value:"["+ur+"]"});for(var ln=0;ln<Mr.length;ln+=1)if(Mr[ln].key==="DecodeParms"){for(var ua=[],Ma=0;Ma<cr.reverseChain.split("/").length-1;Ma+=1)ua.push("null");ua.push(Mr[ln].value),Mr[ln].value="["+ua.join(" ")+"]"}}lt("<<");for(var Ra=0;Ra<Mr.length;Ra++)lt("/"+Mr[Ra].key+" "+Mr[Ra].value);lt(">>"),cr.data.length!==0&&(lt("stream"),lt(Zi(cr.data)),lt("endstream"))},ke=R.__private__.putPage=function(U){var Ee=U.number,ct=U.data,vt=U.objId,Rt=U.contentsObjId;ee(vt,!0),lt("<</Type /Page"),lt("/Parent "+U.rootDictionaryObjId+" 0 R"),lt("/Resources "+U.resourceDictionaryObjId+" 0 R"),lt("/MediaBox ["+parseFloat(Te(U.mediaBox.bottomLeftX))+" "+parseFloat(Te(U.mediaBox.bottomLeftY))+" "+Te(U.mediaBox.topRightX)+" "+Te(U.mediaBox.topRightY)+"]"),U.cropBox!==null&&lt("/CropBox ["+Te(U.cropBox.bottomLeftX)+" "+Te(U.cropBox.bottomLeftY)+" "+Te(U.cropBox.topRightX)+" "+Te(U.cropBox.topRightY)+"]"),U.bleedBox!==null&&lt("/BleedBox ["+Te(U.bleedBox.bottomLeftX)+" "+Te(U.bleedBox.bottomLeftY)+" "+Te(U.bleedBox.topRightX)+" "+Te(U.bleedBox.topRightY)+"]"),U.trimBox!==null&&lt("/TrimBox ["+Te(U.trimBox.bottomLeftX)+" "+Te(U.trimBox.bottomLeftY)+" "+Te(U.trimBox.topRightX)+" "+Te(U.trimBox.topRightY)+"]"),U.artBox!==null&&lt("/ArtBox ["+Te(U.artBox.bottomLeftX)+" "+Te(U.artBox.bottomLeftY)+" "+Te(U.artBox.topRightX)+" "+Te(U.artBox.topRightY)+"]"),typeof U.userUnit=="number"&&U.userUnit!==1&&lt("/UserUnit "+U.userUnit),dn.publish("putPage",{objId:vt,pageContext:Ar[Ee],pageNumber:Ee,page:ct}),lt("/Contents "+Rt+" 0 R"),lt(">>"),lt("endobj");var si=ct.join(`
`);return de===ne.ADVANCED&&(si+=`
Q`),ee(Rt,!0),Ze({data:si,filters:Me(),objectId:Rt}),lt("endobj"),vt},We=R.__private__.putPages=function(){var U,Ee,ct=[];for(U=1;U<=vn;U++)Ar[U].objId=$n(),Ar[U].contentsObjId=$n();for(U=1;U<=vn;U++)ct.push(ke({number:U,data:fi[U],objId:Ar[U].objId,contentsObjId:Ar[U].contentsObjId,mediaBox:Ar[U].mediaBox,cropBox:Ar[U].cropBox,bleedBox:Ar[U].bleedBox,trimBox:Ar[U].trimBox,artBox:Ar[U].artBox,userUnit:Ar[U].userUnit,rootDictionaryObjId:G,resourceDictionaryObjId:Q}));ee(G,!0),lt("<</Type /Pages");var vt="/Kids [";for(Ee=0;Ee<vn;Ee++)vt+=ct[Ee]+" 0 R ";lt(vt+"]"),lt("/Count "+vn),lt(">>"),lt("endobj"),dn.publish("postPutPages")},nt=function(U){dn.publish("putFont",{font:U,out:lt,newObject:ca,putStream:Ze}),U.isAlreadyPutted!==!0&&(U.objectNumber=ca(),lt("<<"),lt("/Type /Font"),lt("/BaseFont /"+C0(U.postScriptName)),lt("/Subtype /Type1"),typeof U.encoding=="string"&&lt("/Encoding /"+U.encoding),lt("/FirstChar 32"),lt("/LastChar 255"),lt(">>"),lt("endobj"))},dt=function(){for(var U in fr)fr.hasOwnProperty(U)&&(W===!1||W===!0&&V.hasOwnProperty(U))&&nt(fr[U])},Pt=function(U){U.objectNumber=ca();var Ee=[];Ee.push({key:"Type",value:"/XObject"}),Ee.push({key:"Subtype",value:"/Form"}),Ee.push({key:"BBox",value:"["+[Te(U.x),Te(U.y),Te(U.x+U.width),Te(U.y+U.height)].join(" ")+"]"}),Ee.push({key:"Matrix",value:"["+U.matrix.toString()+"]"});var ct=U.pages[1].join(`
`);Ze({data:ct,additionalKeyValues:Ee,objectId:U.objectNumber}),lt("endobj")},ti=function(){for(var U in kn)kn.hasOwnProperty(U)&&Pt(kn[U])},Qt=function(U,Ee){var ct,vt=[],Rt=1/(Ee-1);for(ct=0;ct<1;ct+=Rt)vt.push(ct);if(vt.push(1),U[0].offset!=0){var si={offset:0,color:U[0].color};U.unshift(si)}if(U[U.length-1].offset!=1){var Mi={offset:1,color:U[U.length-1].color};U.push(Mi)}for(var Zi="",cr=0,Mr=0;Mr<vt.length;Mr++){for(ct=vt[Mr];ct>U[cr+1].offset;)cr++;var ur=U[cr].offset,ln=(ct-ur)/(U[cr+1].offset-ur),ua=U[cr].color,Ma=U[cr+1].color;Zi+=Ie(Math.round((1-ln)*ua[0]+ln*Ma[0]).toString(16))+Ie(Math.round((1-ln)*ua[1]+ln*Ma[1]).toString(16))+Ie(Math.round((1-ln)*ua[2]+ln*Ma[2]).toString(16))}return Zi.trim()},oi=function(U,Ee){Ee||(Ee=21);var ct=ca(),vt=Qt(U.colors,Ee),Rt=[];Rt.push({key:"FunctionType",value:"0"}),Rt.push({key:"Domain",value:"[0.0 1.0]"}),Rt.push({key:"Size",value:"["+Ee+"]"}),Rt.push({key:"BitsPerSample",value:"8"}),Rt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Rt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ze({data:vt,additionalKeyValues:Rt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ct}),lt("endobj"),U.objectNumber=ca(),lt("<< /ShadingType "+U.type),lt("/ColorSpace /DeviceRGB");var si="/Coords ["+Te(parseFloat(U.coords[0]))+" "+Te(parseFloat(U.coords[1]))+" ";U.type===2?si+=Te(parseFloat(U.coords[2]))+" "+Te(parseFloat(U.coords[3])):si+=Te(parseFloat(U.coords[2]))+" "+Te(parseFloat(U.coords[3]))+" "+Te(parseFloat(U.coords[4]))+" "+Te(parseFloat(U.coords[5])),lt(si+="]"),U.matrix&&lt("/Matrix ["+U.matrix.toString()+"]"),lt("/Function "+ct+" 0 R"),lt("/Extend [true true]"),lt(">>"),lt("endobj")},Ei=function(U,Ee){var ct=$n(),vt=ca();Ee.push({resourcesOid:ct,objectOid:vt}),U.objectNumber=vt;var Rt=[];Rt.push({key:"Type",value:"/Pattern"}),Rt.push({key:"PatternType",value:"1"}),Rt.push({key:"PaintType",value:"1"}),Rt.push({key:"TilingType",value:"1"}),Rt.push({key:"BBox",value:"["+U.boundingBox.map(Te).join(" ")+"]"}),Rt.push({key:"XStep",value:Te(U.xStep)}),Rt.push({key:"YStep",value:Te(U.yStep)}),Rt.push({key:"Resources",value:ct+" 0 R"}),U.matrix&&Rt.push({key:"Matrix",value:"["+U.matrix.toString()+"]"}),Ze({data:U.stream,additionalKeyValues:Rt,objectId:U.objectNumber}),lt("endobj")},Wi=function(U){var Ee;for(Ee in $r)$r.hasOwnProperty(Ee)&&($r[Ee]instanceof Zf?oi($r[Ee]):$r[Ee]instanceof em&&Ei($r[Ee],U))},wi=function(U){for(var Ee in U.objectNumber=ca(),lt("<<"),U)switch(Ee){case"opacity":lt("/ca "+Ae(U[Ee]));break;case"stroke-opacity":lt("/CA "+Ae(U[Ee]))}lt(">>"),lt("endobj")},wr=function(){var U;for(U in Rn)Rn.hasOwnProperty(U)&&wi(Rn[U])},dr=function(){for(var U in lt("/XObject <<"),kn)kn.hasOwnProperty(U)&&kn[U].objectNumber>=0&&lt("/"+U+" "+kn[U].objectNumber+" 0 R");dn.publish("putXobjectDict"),lt(">>")},yr=function(){Ua.oid=ca(),lt("<<"),lt("/Filter /Standard"),lt("/V "+Ua.v),lt("/R "+Ua.r),lt("/U <"+Ua.toHexString(Ua.U)+">"),lt("/O <"+Ua.toHexString(Ua.O)+">"),lt("/P "+Ua.P),lt(">>"),lt("endobj")},xn=function(){for(var U in lt("/Font <<"),fr)fr.hasOwnProperty(U)&&(W===!1||W===!0&&V.hasOwnProperty(U))&&lt("/"+U+" "+fr[U].objectNumber+" 0 R");lt(">>")},en=function(){if(Object.keys($r).length>0){for(var U in lt("/Shading <<"),$r)$r.hasOwnProperty(U)&&$r[U]instanceof Zf&&$r[U].objectNumber>=0&&lt("/"+U+" "+$r[U].objectNumber+" 0 R");dn.publish("putShadingPatternDict"),lt(">>")}},En=function(U){if(Object.keys($r).length>0){for(var Ee in lt("/Pattern <<"),$r)$r.hasOwnProperty(Ee)&&$r[Ee]instanceof R.TilingPattern&&$r[Ee].objectNumber>=0&&$r[Ee].objectNumber<U&&lt("/"+Ee+" "+$r[Ee].objectNumber+" 0 R");dn.publish("putTilingPatternDict"),lt(">>")}},On=function(){if(Object.keys(Rn).length>0){var U;for(U in lt("/ExtGState <<"),Rn)Rn.hasOwnProperty(U)&&Rn[U].objectNumber>=0&&lt("/"+U+" "+Rn[U].objectNumber+" 0 R");dn.publish("putGStateDict"),lt(">>")}},sn=function(U){ee(U.resourcesOid,!0),lt("<<"),lt("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),xn(),en(),En(U.objectOid),On(),dr(),lt(">>"),lt("endobj")},Fl=function(){var U=[];dt(),wr(),ti(),Wi(U),dn.publish("putResources"),U.forEach(sn),sn({resourcesOid:Q,objectOid:Number.MAX_SAFE_INTEGER}),dn.publish("postPutResources")},oh=function(){dn.publish("putAdditionalObjects");for(var U=0;U<Lt.length;U++){var Ee=Lt[U];ee(Ee.objId,!0),lt(Ee.content),lt("endobj")}dn.publish("postPutAdditionalObjects")},Zh=function(U){Sn[U.fontName]=Sn[U.fontName]||{},Sn[U.fontName][U.fontStyle]=U.id},nc=function(U,Ee,ct,vt,Rt){var si={id:"F"+(Object.keys(fr).length+1).toString(10),postScriptName:U,fontName:Ee,fontStyle:ct,encoding:vt,isStandardFont:Rt||!1,metadata:{}};return dn.publish("addFont",{font:si,instance:this}),fr[si.id]=si,Zh(si),si.id},sr=function(U){for(var Ee=0,ct=bi.length;Ee<ct;Ee++){var vt=nc.call(this,U[Ee][0],U[Ee][1],U[Ee][2],bi[Ee][3],!0);W===!1&&(V[vt]=!0);var Rt=U[Ee][0].split("-");Zh({id:vt,fontName:Rt[0],fontStyle:Rt[1]||""})}dn.publish("addFonts",{fonts:fr,dictionary:Sn})},Cs=function(U){return U.foo=function(){try{return U.apply(this,arguments)}catch(vt){var Ee=vt.stack||"";~Ee.indexOf(" at ")&&(Ee=Ee.split(" at ")[1]);var ct="Error in function "+Ee.split(`
`)[0].split("<")[0]+": "+vt.message;if(!zr.console)throw new Error(ct);zr.console.error(ct,vt),zr.alert&&alert(ct)}},U.foo.bar=U,U.foo},Is=function(U,Ee){var ct,vt,Rt,si,Mi,Zi,cr,Mr,ur;if(Rt=(Ee=Ee||{}).sourceEncoding||"Unicode",Mi=Ee.outputEncoding,(Ee.autoencode||Mi)&&fr[Or].metadata&&fr[Or].metadata[Rt]&&fr[Or].metadata[Rt].encoding&&(si=fr[Or].metadata[Rt].encoding,!Mi&&fr[Or].encoding&&(Mi=fr[Or].encoding),!Mi&&si.codePages&&(Mi=si.codePages[0]),typeof Mi=="string"&&(Mi=si[Mi]),Mi)){for(cr=!1,Zi=[],ct=0,vt=U.length;ct<vt;ct++)(Mr=Mi[U.charCodeAt(ct)])?Zi.push(String.fromCharCode(Mr)):Zi.push(U[ct]),Zi[ct].charCodeAt(0)>>8&&(cr=!0);U=Zi.join("")}for(ct=U.length;cr===void 0&&ct!==0;)U.charCodeAt(ct-1)>>8&&(cr=!0),ct--;if(!cr)return U;for(Zi=Ee.noBOM?[]:[254,255],ct=0,vt=U.length;ct<vt;ct++){if((ur=(Mr=U.charCodeAt(ct))>>8)>>8)throw new Error("Character at position "+ct+" of string '"+U+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Zi.push(ur),Zi.push(Mr-(ur<<8))}return String.fromCharCode.apply(void 0,Zi)},Oo=R.__private__.pdfEscape=R.pdfEscape=function(U,Ee){return Is(U,Ee).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},fu=R.__private__.beginPage=function(U){fi[++vn]=[],Ar[vn]={objId:0,contentsObjId:0,userUnit:Number(T),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(U[0]),topRightY:Number(U[1])}},lh(vn),$t(fi[ye])},sh=function(U,Ee){var ct,vt,Rt;switch(l=Ee||l,typeof U=="string"&&(ct=K(U.toLowerCase()),Array.isArray(ct)&&(vt=ct[0],Rt=ct[1])),Array.isArray(U)&&(vt=U[0]*Ri,Rt=U[1]*Ri),isNaN(vt)&&(vt=f[0],Rt=f[1]),(vt>14400||Rt>14400)&&(Pa.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),vt=Math.min(14400,vt),Rt=Math.min(14400,Rt)),f=[vt,Rt],l.substr(0,1)){case"l":Rt>vt&&(f=[Rt,vt]);break;case"p":vt>Rt&&(f=[Rt,vt])}fu(f),lr(lc),lt(os),pl!==0&&lt(pl+" J"),ss!==0&&lt(ss+" j"),dn.publish("addPage",{pageNumber:vn})},Yh=function(U){U>0&&U<=vn&&(fi.splice(U,1),Ar.splice(U,1),vn--,ye>vn&&(ye=vn),this.setPage(ye))},lh=function(U){U>0&&U<=vn&&(ye=U)},Kh=R.__private__.getNumberOfPages=R.getNumberOfPages=function(){return fi.length-1},ch=function(U,Ee,ct){var vt,Rt=void 0;return ct=ct||{},U=U!==void 0?U:fr[Or].fontName,Ee=Ee!==void 0?Ee:fr[Or].fontStyle,vt=U.toLowerCase(),Sn[vt]!==void 0&&Sn[vt][Ee]!==void 0?Rt=Sn[vt][Ee]:Sn[U]!==void 0&&Sn[U][Ee]!==void 0?Rt=Sn[U][Ee]:ct.disableWarning===!1&&Pa.warn("Unable to look up font label for font '"+U+"', '"+Ee+"'. Refer to getFontList() for available fonts."),Rt||ct.noFallback||(Rt=Sn.times[Ee])==null&&(Rt=Sn.times.normal),Rt},Jh=R.__private__.putInfo=function(){var U=ca(),Ee=function(vt){return vt};for(var ct in F!==null&&(Ee=Ua.encryptor(U,0)),lt("<<"),lt("/Producer ("+Oo(Ee("jsPDF "+Lr.version))+")"),xr)xr.hasOwnProperty(ct)&&xr[ct]&&lt("/"+ct.substr(0,1).toUpperCase()+ct.substr(1)+" ("+Oo(Ee(xr[ct]))+")");lt("/CreationDate ("+Oo(Ee(Ye))+")"),lt(">>"),lt("endobj")},pu=R.__private__.putCatalog=function(U){var Ee=(U=U||{}).rootDictionaryObjId||G;switch(ca(),lt("<<"),lt("/Type /Catalog"),lt("/Pages "+Ee+" 0 R"),Ni||(Ni="fullwidth"),Ni){case"fullwidth":lt("/OpenAction [3 0 R /FitH null]");break;case"fullheight":lt("/OpenAction [3 0 R /FitV null]");break;case"fullpage":lt("/OpenAction [3 0 R /Fit]");break;case"original":lt("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ct=""+Ni;ct.substr(ct.length-1)==="%"&&(Ni=parseInt(Ni)/100),typeof Ni=="number"&&lt("/OpenAction [3 0 R /XYZ null null "+Ae(Ni)+"]")}switch(kr||(kr="continuous"),kr){case"continuous":lt("/PageLayout /OneColumn");break;case"single":lt("/PageLayout /SinglePage");break;case"two":case"twoleft":lt("/PageLayout /TwoColumnLeft");break;case"tworight":lt("/PageLayout /TwoColumnRight")}ar&&lt("/PageMode /"+ar),dn.publish("putCatalog"),lt(">>"),lt("endobj")},Wd=R.__private__.putTrailer=function(){lt("trailer"),lt("<<"),lt("/Size "+(Ue+1)),lt("/Root "+Ue+" 0 R"),lt("/Info "+(Ue-1)+" 0 R"),F!==null&&lt("/Encrypt "+Ua.oid+" 0 R"),lt("/ID [ <"+ut+"> <"+ut+"> ]"),lt(">>")},Oc=R.__private__.putHeader=function(){lt("%PDF-"+te),lt("%\xBA\xDF\xAC\xE0")},uh=R.__private__.putXRef=function(){var U="0000000000";lt("xref"),lt("0 "+(Ue+1)),lt("0000000000 65535 f ");for(var Ee=1;Ee<=Ue;Ee++)typeof gt[Ee]=="function"?lt((U+gt[Ee]()).slice(-10)+" 00000 n "):gt[Ee]!==void 0?lt((U+gt[Ee]).slice(-10)+" 00000 n "):lt("0000000000 00000 n ")},qs=R.__private__.buildDocument=function(){Pi(),$t(mt),dn.publish("buildDocument"),Oc(),We(),oh(),Fl(),F!==null&&yr(),Jh(),pu();var U=wt;return uh(),Wd(),lt("startxref"),lt(""+U),lt("%%EOF"),$t(fi[ye]),mt.join(`
`)},mu=R.__private__.getBlob=function(U){return new Blob([ni(U)],{type:"application/pdf"})},gu=R.output=R.__private__.output=Cs(function(U,Ee){switch(typeof(Ee=Ee||{})=="string"?Ee={filename:Ee}:Ee.filename=Ee.filename||"generated.pdf",U){case void 0:return qs();case"save":R.save(Ee.filename);break;case"arraybuffer":return ni(qs());case"blob":return mu(qs());case"bloburi":case"bloburl":if(zr.URL!==void 0&&typeof zr.URL.createObjectURL=="function")return zr.URL&&zr.URL.createObjectURL(mu(qs()))||void 0;Pa.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ct="",vt=qs();try{ct=P2(vt)}catch{ct=P2(unescape(encodeURIComponent(vt)))}return"data:application/pdf;filename="+Ee.filename+";base64,"+ct;case"pdfobjectnewwindow":if(Object.prototype.toString.call(zr)==="[object Window]"){var Rt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",si=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Ee.pdfObjectUrl&&(Rt=Ee.pdfObjectUrl,si="");var Mi='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Rt+'"'+si+'></script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Ee)+");</script></body></html>",Zi=zr.open();return Zi!==null&&Zi.document.write(Mi),Zi}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(zr)==="[object Window]"){var cr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Ee.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Ee.filename+'" width="500px" height="400px" /></body></html>',Mr=zr.open();if(Mr!==null){Mr.document.write(cr);var ur=this;Mr.document.documentElement.querySelector("#pdfViewer").onload=function(){Mr.document.title=Ee.filename,Mr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ur.output("bloburl"))}}return Mr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(zr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var ln='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Ee)+'"></iframe></body></html>',ua=zr.open();if(ua!==null&&(ua.document.write(ln),ua.document.title=Ee.filename),ua||typeof safari>"u")return ua;break;case"datauri":case"dataurl":return zr.document.location.href=this.output("datauristring",Ee);default:return null}}),Qh=function(U){return Array.isArray(as)===!0&&as.indexOf(U)>-1};switch(c){case"pt":Ri=1;break;case"mm":Ri=72/25.4;break;case"cm":Ri=72/2.54;break;case"in":Ri=72;break;case"px":Ri=Qh("px_scaling")==1?.75:96/72;break;case"pc":case"em":Ri=12;break;case"ex":Ri=6;break;default:if(typeof c!="number")throw new Error("Invalid unit: "+c);Ri=c}var Ua=null;Wt(),pt();var Cr=function(U){return F!==null?Ua.encryptor(U,0):function(Ee){return Ee}},qd=R.__private__.getPageInfo=R.getPageInfo=function(U){if(isNaN(U)||U%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ar[U].objId,pageNumber:U,pageContext:Ar[U]}},Nr=R.__private__.getPageInfoByObjId=function(U){if(isNaN(U)||U%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Ee in Ar)if(Ar[Ee].objId===U)break;return qd(Ee)},Qf=R.__private__.getCurrentPageInfo=R.getCurrentPageInfo=function(){return{objId:Ar[ye].objId,pageNumber:ye,pageContext:Ar[ye]}};R.addPage=function(){return sh.apply(this,arguments),this},R.setPage=function(){return lh.apply(this,arguments),$t.call(this,fi[ye]),this},R.insertPage=function(U){return this.addPage(),this.movePage(ye,U),this},R.movePage=function(U,Ee){var ct,vt;if(U>Ee){ct=fi[U],vt=Ar[U];for(var Rt=U;Rt>Ee;Rt--)fi[Rt]=fi[Rt-1],Ar[Rt]=Ar[Rt-1];fi[Ee]=ct,Ar[Ee]=vt,this.setPage(Ee)}else if(U<Ee){ct=fi[U],vt=Ar[U];for(var si=U;si<Ee;si++)fi[si]=fi[si+1],Ar[si]=Ar[si+1];fi[Ee]=ct,Ar[Ee]=vt,this.setPage(Ee)}return this},R.deletePage=function(){return Yh.apply(this,arguments),this},R.__private__.text=R.text=function(U,Ee,ct,vt,Rt){var si,Mi,Zi,cr,Mr,ur,ln,ua,Ma,Ra=(vt=vt||{}).scope||this;if(typeof U=="number"&&typeof Ee=="number"&&(typeof ct=="string"||Array.isArray(ct))){var vo=ct;ct=Ee,Ee=U,U=vo}if(arguments[3]instanceof Ki?(ge("The transform parameter of text() with a Matrix value"),Ma=Rt):(Zi=arguments[4],cr=arguments[5],(0,Ia.default)(ln=arguments[3])==="object"&&ln!==null||(typeof Zi=="string"&&(cr=Zi,Zi=null),typeof ln=="string"&&(cr=ln,ln=null),typeof ln=="number"&&(Zi=ln,ln=null),vt={flags:ln,angle:Zi,align:cr})),isNaN(Ee)||isNaN(ct)||U==null)throw new Error("Invalid arguments passed to jsPDF.text");if(U.length===0)return Ra;var ra="",cs=!1,us=typeof vt.lineHeightFactor=="number"?vt.lineHeightFactor:sc,Ms=Ra.internal.scaleFactor;function xu(Xn){return Xn=Xn.split("	").join(Array(vt.TabLen||9).join(" ")),Oo(Xn,ln)}function Uc(Xn){for(var Vn,na=Xn.concat(),Ha=[],hs=na.length;hs--;)typeof(Vn=na.shift())=="string"?Ha.push(Vn):Array.isArray(Xn)&&(Vn.length===1||Vn[1]===void 0&&Vn[2]===void 0)?Ha.push(Vn[0]):Ha.push([Vn[0],Vn[1],Vn[2]]);return Ha}function Nl(Xn,Vn){var na;if(typeof Xn=="string")na=Vn(Xn)[0];else if(Array.isArray(Xn)){for(var Ha,hs,Na=Xn.concat(),xc=[],jl=Na.length;jl--;)typeof(Ha=Na.shift())=="string"?xc.push(Vn(Ha)[0]):Array.isArray(Ha)&&typeof Ha[0]=="string"&&(hs=Vn(Ha[0],Ha[1],Ha[2]),xc.push([hs[0],hs[1],hs[2]]));na=xc}return na}var ml=!1,vu=!0;if(typeof U=="string")ml=!0;else if(Array.isArray(U)){var yu=U.concat();Mi=[];for(var Hc,Zo=yu.length;Zo--;)(typeof(Hc=yu.shift())!="string"||Array.isArray(Hc)&&typeof Hc[0]!="string")&&(vu=!1);ml=vu}if(ml===!1)throw new Error('Type of text must be string or Array. "'+U+'" is not recognized.');typeof U=="string"&&(U=U.match(/[\r?\n]/)?U.split(/\r\n|\r|\n/g):[U]);var fc=ki/Ra.internal.scaleFactor,Gc=fc*(us-1);switch(vt.baseline){case"bottom":ct-=Gc;break;case"top":ct+=fc-Gc;break;case"hanging":ct+=fc-2*Gc;break;case"middle":ct+=fc/2-Gc}if((ur=vt.maxWidth||0)>0&&(typeof U=="string"?U=Ra.splitTextToSize(U,ur):Object.prototype.toString.call(U)==="[object Array]"&&(U=U.reduce(function(Xn,Vn){return Xn.concat(Ra.splitTextToSize(Vn,ur))},[]))),si={text:U,x:Ee,y:ct,options:vt,mutex:{pdfEscape:Oo,activeFontKey:Or,fonts:fr,activeFontSize:ki}},dn.publish("preProcessText",si),U=si.text,Zi=(vt=si.options).angle,!(Ma instanceof Ki)&&Zi&&typeof Zi=="number"){Zi*=Math.PI/180,vt.rotationDirection===0&&(Zi=-Zi),de===ne.ADVANCED&&(Zi=-Zi);var pc=Math.cos(Zi),mc=Math.sin(Zi);Ma=new Ki(pc,mc,-mc,pc,0,0)}else Zi&&Zi instanceof Ki&&(Ma=Zi);de!==ne.ADVANCED||Ma||(Ma=Qa),(Mr=vt.charSpace||Ol)!==void 0&&(ra+=Te(xe(Mr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ua=vt.horizontalScale)!==void 0&&(ra+=Te(100*ua)+` Tz
`),vt.lang;var ro=-1,Zd=vt.renderingMode!==void 0?vt.renderingMode:vt.stroke,bu=Ra.internal.getCurrentPageInfo().pageContext;switch(Zd){case 0:case!1:case"fill":ro=0;break;case 1:case!0:case"stroke":ro=1;break;case 2:case"fillThenStroke":ro=2;break;case 3:case"invisible":ro=3;break;case 4:case"fillAndAddForClipping":ro=4;break;case 5:case"strokeAndAddPathForClipping":ro=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ro=6;break;case 7:case"addToPathForClipping":ro=7}var Wc=bu.usedRenderingMode!==void 0?bu.usedRenderingMode:-1;ro!==-1?ra+=ro+` Tr
`:Wc!==-1&&(ra+=`0 Tr
`),ro!==-1&&(bu.usedRenderingMode=ro),cr=vt.align||"left";var Yo,Xs=ki*us,td=Ra.internal.pageSize.getWidth(),id=fr[Or];Mr=vt.charSpace||Ol,ur=vt.maxWidth||0,ln=Object.assign({autoencode:!0,noBOM:!0},vt.flags);var qc=[];if(Object.prototype.toString.call(U)==="[object Array]"){var Oa;Mi=Uc(U),cr!=="left"&&(Yo=Mi.map(function(Xn){return Ra.getStringUnitWidth(Xn,{font:id,charSpace:Mr,fontSize:ki,doKerning:!1})*ki/Ms}));var No,gl=0;if(cr==="right"){Ee-=Yo[0],U=[],Zo=Mi.length;for(var _l=0;_l<Zo;_l++)_l===0?(No=eo(Ee),Oa=ya(ct)):(No=xe(gl-Yo[_l]),Oa=-Xs),U.push([Mi[_l],No,Oa]),gl=Yo[_l]}else if(cr==="center"){Ee-=Yo[0]/2,U=[],Zo=Mi.length;for(var Ds=0;Ds<Zo;Ds++)Ds===0?(No=eo(Ee),Oa=ya(ct)):(No=xe((gl-Yo[Ds])/2),Oa=-Xs),U.push([Mi[Ds],No,Oa]),gl=Yo[Ds]}else if(cr==="left"){U=[],Zo=Mi.length;for(var wu=0;wu<Zo;wu++)U.push(Mi[wu])}else{if(cr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');U=[],Zo=Mi.length,ur=ur!==0?ur:td;for(var Fs=0;Fs<Zo;Fs++)Oa=Fs===0?ya(ct):-Xs,No=Fs===0?eo(Ee):0,Fs<Zo-1?qc.push(Te(xe((ur-Yo[Fs])/(Mi[Fs].split(" ").length-1)))):qc.push(0),U.push([Mi[Fs],No,Oa])}}var Bl=typeof vt.R2L=="boolean"?vt.R2L:tr;Bl===!0&&(U=Nl(U,function(Xn,Vn,na){return[Xn.split("").reverse().join(""),Vn,na]})),si={text:U,x:Ee,y:ct,options:vt,mutex:{pdfEscape:Oo,activeFontKey:Or,fonts:fr,activeFontSize:ki}},dn.publish("postProcessText",si),U=si.text,cs=si.mutex.isHex||!1;var ph=fr[Or].encoding;ph!=="WinAnsiEncoding"&&ph!=="StandardEncoding"||(U=Nl(U,function(Xn,Vn,na){return[xu(Xn),Vn,na]})),Mi=Uc(U),U=[];for(var gc,xl,Zs,Tu=0,vl=1,zl=Array.isArray(Mi[0])?vl:Tu,Ys="",yl=function(Xn,Vn,na){var Ha="";return na instanceof Ki?(na=typeof vt.angle=="number"?Ro(na,new Ki(1,0,0,1,Xn,Vn)):Ro(new Ki(1,0,0,1,Xn,Vn),na),de===ne.ADVANCED&&(na=Ro(new Ki(1,0,0,-1,0,0),na)),Ha=na.join(" ")+` Tm
`):Ha=Te(Xn)+" "+Te(Vn)+` Td
`,Ha},Ps=0;Ps<Mi.length;Ps++){switch(Ys="",zl){case vl:Zs=(cs?"<":"(")+Mi[Ps][0]+(cs?">":")"),gc=parseFloat(Mi[Ps][1]),xl=parseFloat(Mi[Ps][2]);break;case Tu:Zs=(cs?"<":"(")+Mi[Ps]+(cs?">":")"),gc=eo(Ee),xl=ya(ct)}qc!==void 0&&qc[Ps]!==void 0&&(Ys=qc[Ps]+` Tw
`),Ps===0?U.push(Ys+yl(gc,xl,Ma)+Zs):zl===Tu?U.push(Ys+Zs):zl===vl&&U.push(Ys+yl(gc,xl,Ma)+Zs)}U=zl===Tu?U.join(` Tj
T* `):U.join(` Tj
`),U+=` Tj
`;var _c=`BT
/`;return _c+=Or+" "+ki+` Tf
`,_c+=Te(ki*us)+` TL
`,_c+=uc+`
`,_c+=ra,_c+=U,lt(_c+="ET"),V[Or]=!0,Ra};var ed=R.__private__.clip=R.clip=function(U){return lt(U==="evenodd"?"W*":"W"),this};R.clipEvenOdd=function(){return ed("evenodd")},R.__private__.discardPath=R.discardPath=function(){return lt("n"),this};var co=R.__private__.isValidStyle=function(U){var Ee=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(U)!==-1&&(Ee=!0),Ee};R.__private__.setDefaultPathOperation=R.setDefaultPathOperation=function(U){return co(U)&&(M=U),this};var hh=R.__private__.getStyle=R.getStyle=function(U){var Ee=M;switch(U){case"D":case"S":Ee="S";break;case"F":Ee="f";break;case"FD":case"DF":Ee="B";break;case"f":case"f*":case"B":case"B*":Ee=U}return Ee},Nc=R.close=function(){return lt("h"),this};R.stroke=function(){return lt("S"),this},R.fill=function(U){return Pl("f",U),this},R.fillEvenOdd=function(U){return Pl("f*",U),this},R.fillStroke=function(U){return Pl("B",U),this},R.fillStrokeEvenOdd=function(U){return Pl("B*",U),this};var Pl=function(U,Ee){(0,Ia.default)(Ee)==="object"?hi(Ee,U):lt(U)},Bc=function(U){U===null||de===ne.ADVANCED&&U===void 0||(U=hh(U),lt(U))};function ac(U,Ee,ct,vt,Rt){var si=new em(Ee||this.boundingBox,ct||this.xStep,vt||this.yStep,this.gState,Rt||this.matrix);si.stream=this.stream;var Mi=U+"$$"+this.cloneIndex+++"$$";return Va(Mi,si),si}var hi=function(U,Ee){var ct=so[U.key],vt=$r[ct];if(vt instanceof Zf)lt("q"),lt($d(Ee)),vt.gState&&R.setGState(vt.gState),lt(U.matrix.toString()+" cm"),lt("/"+ct+" sh"),lt("Q");else if(vt instanceof em){var Rt=new Ki(1,0,0,-1,0,ks());U.matrix&&(Rt=Rt.multiply(U.matrix||Qa),ct=ac.call(vt,U.key,U.boundingBox,U.xStep,U.yStep,Rt).id),lt("q"),lt("/Pattern cs"),lt("/"+ct+" scn"),vt.gState&&R.setGState(vt.gState),lt(Ee),lt("Q")}},$d=function(U){switch(U){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},oc=R.moveTo=function(U,Ee){return lt(Te(xe(U))+" "+Te(Ce(Ee))+" m"),this},Tr=R.lineTo=function(U,Ee){return lt(Te(xe(U))+" "+Te(Ce(Ee))+" l"),this},va=R.curveTo=function(U,Ee,ct,vt,Rt,si){return lt([Te(xe(U)),Te(Ce(Ee)),Te(xe(ct)),Te(Ce(vt)),Te(xe(Rt)),Te(Ce(si)),"c"].join(" ")),this};R.__private__.line=R.line=function(U,Ee,ct,vt,Rt){if(isNaN(U)||isNaN(Ee)||isNaN(ct)||isNaN(vt)||!co(Rt))throw new Error("Invalid arguments passed to jsPDF.line");return de===ne.COMPAT?this.lines([[ct-U,vt-Ee]],U,Ee,[1,1],Rt||"S"):this.lines([[ct-U,vt-Ee]],U,Ee,[1,1]).stroke()},R.__private__.lines=R.lines=function(U,Ee,ct,vt,Rt,si){var Mi,Zi,cr,Mr,ur,ln,ua,Ma,Ra,vo,ra,cs;if(typeof U=="number"&&(cs=ct,ct=Ee,Ee=U,U=cs),vt=vt||[1,1],si=si||!1,isNaN(Ee)||isNaN(ct)||!Array.isArray(U)||!Array.isArray(vt)||!co(Rt)||typeof si!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(oc(Ee,ct),Mi=vt[0],Zi=vt[1],Mr=U.length,vo=Ee,ra=ct,cr=0;cr<Mr;cr++)(ur=U[cr]).length===2?(vo=ur[0]*Mi+vo,ra=ur[1]*Zi+ra,Tr(vo,ra)):(ln=ur[0]*Mi+vo,ua=ur[1]*Zi+ra,Ma=ur[2]*Mi+vo,Ra=ur[3]*Zi+ra,vo=ur[4]*Mi+vo,ra=ur[5]*Zi+ra,va(ln,ua,Ma,Ra,vo,ra));return si&&Nc(),Bc(Rt),this},R.path=function(U){for(var Ee=0;Ee<U.length;Ee++){var ct=U[Ee],vt=ct.c;switch(ct.op){case"m":oc(vt[0],vt[1]);break;case"l":Tr(vt[0],vt[1]);break;case"c":va.apply(this,vt);break;case"h":Nc()}}return this},R.__private__.rect=R.rect=function(U,Ee,ct,vt,Rt){if(isNaN(U)||isNaN(Ee)||isNaN(ct)||isNaN(vt)||!co(Rt))throw new Error("Invalid arguments passed to jsPDF.rect");return de===ne.COMPAT&&(vt=-vt),lt([Te(xe(U)),Te(Ce(Ee)),Te(xe(ct)),Te(xe(vt)),"re"].join(" ")),Bc(Rt),this},R.__private__.triangle=R.triangle=function(U,Ee,ct,vt,Rt,si,Mi){if(isNaN(U)||isNaN(Ee)||isNaN(ct)||isNaN(vt)||isNaN(Rt)||isNaN(si)||!co(Mi))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ct-U,vt-Ee],[Rt-ct,si-vt],[U-Rt,Ee-si]],U,Ee,[1,1],Mi,!0),this},R.__private__.roundedRect=R.roundedRect=function(U,Ee,ct,vt,Rt,si,Mi){if(isNaN(U)||isNaN(Ee)||isNaN(ct)||isNaN(vt)||isNaN(Rt)||isNaN(si)||!co(Mi))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Zi=4/3*(Math.SQRT2-1);return Rt=Math.min(Rt,.5*ct),si=Math.min(si,.5*vt),this.lines([[ct-2*Rt,0],[Rt*Zi,0,Rt,si-si*Zi,Rt,si],[0,vt-2*si],[0,si*Zi,-Rt*Zi,si,-Rt,si],[2*Rt-ct,0],[-Rt*Zi,0,-Rt,-si*Zi,-Rt,-si],[0,2*si-vt],[0,-si*Zi,Rt*Zi,-si,Rt,-si]],U+Rt,Ee,[1,1],Mi,!0),this},R.__private__.ellipse=R.ellipse=function(U,Ee,ct,vt,Rt){if(isNaN(U)||isNaN(Ee)||isNaN(ct)||isNaN(vt)||!co(Rt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var si=4/3*(Math.SQRT2-1)*ct,Mi=4/3*(Math.SQRT2-1)*vt;return oc(U+ct,Ee),va(U+ct,Ee-Mi,U+si,Ee-vt,U,Ee-vt),va(U-si,Ee-vt,U-ct,Ee-Mi,U-ct,Ee),va(U-ct,Ee+Mi,U-si,Ee+vt,U,Ee+vt),va(U+si,Ee+vt,U+ct,Ee+Mi,U+ct,Ee),Bc(Rt),this},R.__private__.circle=R.circle=function(U,Ee,ct,vt){if(isNaN(U)||isNaN(Ee)||isNaN(ct)||!co(vt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(U,Ee,ct,ct,vt)},R.setFont=function(U,Ee,ct){return ct&&(Ee=et(Ee,ct)),Or=ch(U,Ee,{disableWarning:!1}),this};var Xd=R.__private__.getFont=R.getFont=function(){return fr[ch.apply(R,arguments)]};R.__private__.getFontList=R.getFontList=function(){var U,Ee,ct={};for(U in Sn)if(Sn.hasOwnProperty(U))for(Ee in ct[U]=[],Sn[U])Sn[U].hasOwnProperty(Ee)&&ct[U].push(Ee);return ct},R.addFont=function(U,Ee,ct,vt,Rt){var si=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&si.indexOf(arguments[3])!==-1?Rt=arguments[3]:arguments[3]&&si.indexOf(arguments[3])==-1&&(ct=et(ct,vt)),Rt=Rt||"Identity-H",nc.call(this,U,Ee,ct,Rt)};var sc,lc=a.lineWidth||.200025,dl=R.__private__.getLineWidth=R.getLineWidth=function(){return lc},lr=R.__private__.setLineWidth=R.setLineWidth=function(U){return lc=U,lt(Te(xe(U))+" w"),this};R.__private__.setLineDash=Lr.API.setLineDash=Lr.API.setLineDashPattern=function(U,Ee){if(U=U||[],Ee=Ee||0,isNaN(Ee)||!Array.isArray(U))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return U=U.map(function(ct){return Te(xe(ct))}).join(" "),Ee=Te(xe(Ee)),lt("["+U+"] "+Ee+" d"),this};var Ll=R.__private__.getLineHeight=R.getLineHeight=function(){return ki*sc};R.__private__.getLineHeight=R.getLineHeight=function(){return ki*sc};var Rl=R.__private__.setLineHeightFactor=R.setLineHeightFactor=function(U){return typeof(U=U||1.15)=="number"&&(sc=U),this},cc=R.__private__.getLineHeightFactor=R.getLineHeightFactor=function(){return sc};Rl(a.lineHeight);var eo=R.__private__.getHorizontalCoordinate=function(U){return xe(U)},ya=R.__private__.getVerticalCoordinate=function(U){return de===ne.ADVANCED?U:Ar[ye].mediaBox.topRightY-Ar[ye].mediaBox.bottomLeftY-xe(U)},ep=R.__private__.getHorizontalCoordinateString=R.getHorizontalCoordinateString=function(U){return Te(eo(U))},fl=R.__private__.getVerticalCoordinateString=R.getVerticalCoordinateString=function(U){return Te(ya(U))},os=a.strokeColor||"0 G";R.__private__.getStrokeColor=R.getDrawColor=function(){return se(os)},R.__private__.setStrokeColor=R.setDrawColor=function(U,Ee,ct,vt){return os=le({ch1:U,ch2:Ee,ch3:ct,ch4:vt,pdfColorType:"draw",precision:2}),lt(os),this};var _u=a.fillColor||"0 g";R.__private__.getFillColor=R.getFillColor=function(){return se(_u)},R.__private__.setFillColor=R.setFillColor=function(U,Ee,ct,vt){return _u=le({ch1:U,ch2:Ee,ch3:ct,ch4:vt,pdfColorType:"fill",precision:2}),lt(_u),this};var uc=a.textColor||"0 g",dh=R.__private__.getTextColor=R.getTextColor=function(){return se(uc)};R.__private__.setTextColor=R.setTextColor=function(U,Ee,ct,vt){return uc=le({ch1:U,ch2:Ee,ch3:ct,ch4:vt,pdfColorType:"text",precision:3}),this};var Ol=a.charSpace,zc=R.__private__.getCharSpace=R.getCharSpace=function(){return parseFloat(Ol||0)};R.__private__.setCharSpace=R.setCharSpace=function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ol=U,this};var pl=0;R.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},R.__private__.setLineCap=R.setLineCap=function(U){var Ee=R.CapJoinStyles[U];if(Ee===void 0)throw new Error("Line cap style of '"+U+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return pl=Ee,lt(Ee+" J"),this};var ss=0;R.__private__.setLineJoin=R.setLineJoin=function(U){var Ee=R.CapJoinStyles[U];if(Ee===void 0)throw new Error("Line join style of '"+U+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ss=Ee,lt(Ee+" j"),this},R.__private__.setLineMiterLimit=R.__private__.setMiterLimit=R.setLineMiterLimit=R.setMiterLimit=function(U){if(U=U||0,isNaN(U))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return lt(Te(xe(U))+" M"),this},R.GState=a_,R.setGState=function(U){(U=typeof U=="string"?Rn[Ja[U]]:fh(null,U)).equals(xo)||(lt("/"+U.id+" gs"),xo=U)};var fh=function(U,Ee){if(!U||!Ja[U]){var ct=!1;for(var vt in Rn)if(Rn.hasOwnProperty(vt)&&Rn[vt].equals(Ee)){ct=!0;break}if(ct)Ee=Rn[vt];else{var Rt="GS"+(Object.keys(Rn).length+1).toString(10);Rn[Rt]=Ee,Ee.id=Rt}return U&&(Ja[U]=Ee.id),dn.publish("addGState",Ee),Ee}};R.addGState=function(U,Ee){return fh(U,Ee),this},R.saveGraphicsState=function(){return lt("q"),_o.push({key:Or,size:ki,color:uc}),this},R.restoreGraphicsState=function(){lt("Q");var U=_o.pop();return Or=U.key,ki=U.size,uc=U.color,xo=null,this},R.setCurrentTransformationMatrix=function(U){return lt(U.toString()+" cm"),this},R.comment=function(U){return lt("#"+U),this};var Nn=function(U,Ee){var ct=U||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ct},set:function(si){isNaN(si)||(ct=parseFloat(si))}});var vt=Ee||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return vt},set:function(si){isNaN(si)||(vt=parseFloat(si))}});var Rt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Rt},set:function(si){Rt=si.toString()}}),this},ls=function(U,Ee,ct,vt){Nn.call(this,U,Ee),this.type="rect";var Rt=ct||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Rt},set:function(Mi){isNaN(Mi)||(Rt=parseFloat(Mi))}});var si=vt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return si},set:function(Mi){isNaN(Mi)||(si=parseFloat(Mi))}}),this},to=function(){this.page=vn,this.currentPage=ye,this.pages=fi.slice(0),this.pagesContext=Ar.slice(0),this.x=La,this.y=Di,this.matrix=go,this.width=hc(ye),this.height=ks(ye),this.outputDestination=Fi,this.id="",this.objectNumber=-1};to.prototype.restore=function(){vn=this.page,ye=this.currentPage,Ar=this.pagesContext,fi=this.pages,La=this.x,Di=this.y,go=this.matrix,Vc(ye,this.width),dc(ye,this.height),Fi=this.outputDestination};var $s=function(U,Ee,ct,vt,Rt){ka.push(new to),vn=ye=0,fi=[],La=U,Di=Ee,go=Rt,fu([ct,vt])},io=function(U){if(lo[U])ka.pop().restore();else{var Ee=new to,ct="Xo"+(Object.keys(kn).length+1).toString(10);Ee.id=ct,lo[U]=ct,kn[ct]=Ee,dn.publish("addFormObject",Ee),ka.pop().restore()}};for(var jc in R.beginFormObject=function(U,Ee,ct,vt,Rt){return $s(U,Ee,ct,vt,Rt),this},R.endFormObject=function(U){return io(U),this},R.doFormObject=function(U,Ee){var ct=kn[lo[U]];return lt("q"),lt(Ee.toString()+" cm"),lt("/"+ct.id+" Do"),lt("Q"),this},R.getFormObject=function(U){var Ee=kn[lo[U]];return{x:Ee.x,y:Ee.y,width:Ee.width,height:Ee.height,matrix:Ee.matrix}},R.save=function(U,Ee){return U=U||"generated.pdf",(Ee=Ee||{}).returnPromise=Ee.returnPromise||!1,Ee.returnPromise===!1?(Qp(mu(qs()),U),typeof Qp.unload=="function"&&zr.setTimeout&&setTimeout(Qp.unload,911),this):new Promise(function(ct,vt){try{var Rt=Qp(mu(qs()),U);typeof Qp.unload=="function"&&zr.setTimeout&&setTimeout(Qp.unload,911),ct(Rt)}catch(si){vt(si.message)}})},Lr.API)Lr.API.hasOwnProperty(jc)&&(jc==="events"&&Lr.API.events.length?function(U,Ee){var ct,vt,Rt;for(Rt=Ee.length-1;Rt!==-1;Rt--)ct=Ee[Rt][0],vt=Ee[Rt][1],U.subscribe.apply(U,[ct].concat(typeof vt=="function"?[vt]:vt))}(dn,Lr.API.events):R[jc]=Lr.API[jc]);var hc=R.getPageWidth=function(U){return(Ar[U=U||ye].mediaBox.topRightX-Ar[U].mediaBox.bottomLeftX)/Ri},Vc=R.setPageWidth=function(U,Ee){Ar[U].mediaBox.topRightX=Ee*Ri+Ar[U].mediaBox.bottomLeftX},ks=R.getPageHeight=function(U){return(Ar[U=U||ye].mediaBox.topRightY-Ar[U].mediaBox.bottomLeftY)/Ri},dc=R.setPageHeight=function(U,Ee){Ar[U].mediaBox.topRightY=Ee*Ri+Ar[U].mediaBox.bottomLeftY};return R.internal={pdfEscape:Oo,getStyle:hh,getFont:Xd,getFontSize:Bi,getCharSpace:zc,getTextColor:dh,getLineHeight:Ll,getLineHeightFactor:cc,getLineWidth:dl,write:Bt,getHorizontalCoordinate:eo,getVerticalCoordinate:ya,getCoordinateString:ep,getVerticalCoordinateString:fl,collections:{},newObject:ca,newAdditionalObject:z,newObjectDeferred:$n,newObjectDeferredBegin:ee,getFilters:Me,putStream:Ze,events:dn,scaleFactor:Ri,pageSize:{getWidth:function(){return hc(ye)},setWidth:function(U){Vc(ye,U)},getHeight:function(){return ks(ye)},setHeight:function(U){dc(ye,U)}},encryptionOptions:F,encryption:Ua,getEncryptor:Cr,output:gu,getNumberOfPages:Kh,pages:fi,out:lt,f2:Ae,f3:_e,getPageInfo:qd,getPageInfoByObjId:Nr,getCurrentPageInfo:Qf,getPDFVersion:H,Point:Nn,Rectangle:ls,Matrix:Ki,hasHotfix:Qh},Object.defineProperty(R.internal.pageSize,"width",{get:function(){return hc(ye)},set:function(U){Vc(ye,U)},enumerable:!0,configurable:!0}),Object.defineProperty(R.internal.pageSize,"height",{get:function(){return ks(ye)},set:function(U){dc(ye,U)},enumerable:!0,configurable:!0}),sr.call(R,bi),Or="F1",sh(f,l),dn.publish("initialized"),R}function W4(a){return a.reduce(function(n,l,c){return n[l]=c,n},{})}function B2(a){var n=a.family.replace(/"|'/g,"").toLowerCase(),l=function(i){return q4[i=i||"normal"]?i:"normal"}(a.style),c=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(a.weight),f=function(i){return typeof N2[i=i||"normal"]=="number"?i:"normal"}(a.stretch);return{family:n,style:l,weight:c,stretch:f,src:a.src||[],ref:a.ref||{name:n,style:[f,l,c].join(" ")}}}function C4(a,n,l,c){var f;for(f=l;f>=0&&f<n.length;f+=c)if(a[n[f]])return a[n[f]];for(f=l;f>=0&&f<n.length;f-=c)if(a[n[f]])return a[n[f]]}function k4(a){return[a.stretch,a.style,a.weight,a.family].join(" ")}function O7(a,n,l){for(var c=(l=l||{}).defaultFontFamily||"times",f=Object.assign({},R7,l.genericFontFamilies||{}),i=null,x=null,T=0;T<n.length;++T)if(f[(i=B2(n[T])).family]&&(i.family=f[i.family]),a.hasOwnProperty(i.family)){x=a[i.family];break}if(!(x=x||a[c]))throw new Error("Could not find a font-family for the rule '"+k4(i)+"' and default family '"+c+"'.");if(x=function(A,M){if(M[A])return M[A];var F=N2[A],W=F<=N2.normal?-1:1,V=C4(M,$4,F,W);if(!V)throw new Error("Could not find a matching font-stretch value for "+A);return V}(i.stretch,x),x=function(A,M){if(M[A])return M[A];for(var F=q4[A],W=0;W<F.length;++W)if(M[F[W]])return M[F[W]];throw new Error("Could not find a matching font-style for "+A)}(i.style,x),!(x=function(A,M){if(M[A])return M[A];if(A===400&&M[500])return M[500];if(A===500&&M[400])return M[400];var F=L7[A],W=C4(M,X4,F,A<400?-1:1);if(!W)throw new Error("Could not find a matching font-weight for value "+A);return W}(i.weight,x)))throw new Error("Failed to resolve a font for the rule '"+k4(i)+"'.");return x}function M4(a){return a.trimLeft()}function N7(a,n){for(var l=0;l<a.length;){if(a.charAt(l)===n)return[a.substring(0,l),a.substring(l+1)];l+=1}return null}function B7(a){var n=a.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return n===null?null:[n[0],a.substring(n[0].length)]}function j7(a){var n=0;if(a[n++]!==71||a[n++]!==73||a[n++]!==70||a[n++]!==56||(a[n++]+1&253)!=56||a[n++]!==97)throw new Error("Invalid GIF 87a/89a header.");var l=a[n++]|a[n++]<<8,c=a[n++]|a[n++]<<8,f=a[n++],i=f>>7,x=1<<(7&f)+1;a[n++],a[n++];var T=null,A=null;i&&(T=n,A=x,n+=3*x);var M=!0,F=[],W=0,V=null,R=0,te=null;for(this.width=l,this.height=c;M&&n<a.length;)switch(a[n++]){case 33:switch(a[n++]){case 255:if(a[n]!==11||a[n+1]==78&&a[n+2]==69&&a[n+3]==84&&a[n+4]==83&&a[n+5]==67&&a[n+6]==65&&a[n+7]==80&&a[n+8]==69&&a[n+9]==50&&a[n+10]==46&&a[n+11]==48&&a[n+12]==3&&a[n+13]==1&&a[n+16]==0)n+=14,te=a[n++]|a[n++]<<8,n++;else for(n+=12;;){if(!((_e=a[n++])>=0))throw Error("Invalid block size");if(_e===0)break;n+=_e}break;case 249:if(a[n++]!==4||a[n+4]!==0)throw new Error("Invalid graphics extension block.");var H=a[n++];W=a[n++]|a[n++]<<8,V=a[n++],!(1&H)&&(V=null),R=H>>2&7,n++;break;case 254:for(;;){if(!((_e=a[n++])>=0))throw Error("Invalid block size");if(_e===0)break;n+=_e}break;default:throw new Error("Unknown graphic control label: 0x"+a[n-1].toString(16))}break;case 44:var J=a[n++]|a[n++]<<8,K=a[n++]|a[n++]<<8,ne=a[n++]|a[n++]<<8,de=a[n++]|a[n++]<<8,De=a[n++],Fe=De>>6&1,et=1<<(7&De)+1,Te=T,ge=A,Ve=!1;De>>7&&(Ve=!0,Te=n,ge=et,n+=3*et);var Ae=n;for(n++;;){var _e;if(!((_e=a[n++])>=0))throw Error("Invalid block size");if(_e===0)break;n+=_e}F.push({x:J,y:K,width:ne,height:de,has_local_palette:Ve,palette_offset:Te,palette_size:ge,data_offset:Ae,data_length:n-Ae,transparent_index:V,interlaced:!!Fe,delay:W,disposal:R});break;case 59:M=!1;break;default:throw new Error("Unknown gif block: 0x"+a[n-1].toString(16))}this.numFrames=function(){return F.length},this.loopCount=function(){return te},this.frameInfo=function(xe){if(xe<0||xe>=F.length)throw new Error("Frame index out of range.");return F[xe]},this.decodeAndBlitFrameBGRA=function(xe,Qe){var Ce=this.frameInfo(xe),Ye=Ce.width*Ce.height,ut=new Uint8Array(Ye);O4(a,Ce.data_offset,ut,Ye);var st=Ce.palette_offset,pt=Ce.transparent_index;pt===null&&(pt=256);var Tt=Ce.width,ht=l-Tt,Wt=Tt,ie=4*(Ce.y*l+Ce.x),ye=4*((Ce.y+Ce.height)*l+Ce.x),pe=ie,Ie=4*ht;Ce.interlaced===!0&&(Ie+=4*l*7);for(var Ue=8,gt=0,mt=ut.length;gt<mt;++gt){var wt=ut[gt];if(Wt===0&&(Wt=Tt,(pe+=Ie)>=ye&&(Ie=4*ht+4*l*(Ue-1),pe=ie+(Tt+ht)*(Ue<<1),Ue>>=1)),wt===pt)pe+=4;else{var Lt=a[st+3*wt],fi=a[st+3*wt+1],yi=a[st+3*wt+2];Qe[pe++]=yi,Qe[pe++]=fi,Qe[pe++]=Lt,Qe[pe++]=255}--Wt}},this.decodeAndBlitFrameRGBA=function(xe,Qe){var Ce=this.frameInfo(xe),Ye=Ce.width*Ce.height,ut=new Uint8Array(Ye);O4(a,Ce.data_offset,ut,Ye);var st=Ce.palette_offset,pt=Ce.transparent_index;pt===null&&(pt=256);var Tt=Ce.width,ht=l-Tt,Wt=Tt,ie=4*(Ce.y*l+Ce.x),ye=4*((Ce.y+Ce.height)*l+Ce.x),pe=ie,Ie=4*ht;Ce.interlaced===!0&&(Ie+=4*l*7);for(var Ue=8,gt=0,mt=ut.length;gt<mt;++gt){var wt=ut[gt];if(Wt===0&&(Wt=Tt,(pe+=Ie)>=ye&&(Ie=4*ht+4*l*(Ue-1),pe=ie+(Tt+ht)*(Ue<<1),Ue>>=1)),wt===pt)pe+=4;else{var Lt=a[st+3*wt],fi=a[st+3*wt+1],yi=a[st+3*wt+2];Qe[pe++]=Lt,Qe[pe++]=fi,Qe[pe++]=yi,Qe[pe++]=255}--Wt}}}function O4(a,n,l,c){for(var f=a[n++],i=1<<f,x=i+1,T=x+1,A=f+1,M=(1<<A)-1,F=0,W=0,V=0,R=a[n++],te=new Int32Array(4096),H=null;;){for(;F<16&&R!==0;)W|=a[n++]<<F,F+=8,R===1?R=a[n++]:--R;if(F<A)break;var J=W&M;if(W>>=A,F-=A,J!==i){if(J===x)break;for(var K=J<T?J:H,ne=0,de=K;de>i;)de=te[de]>>8,++ne;var De=de;if(V+ne+(K!==J?1:0)>c)return void Pa.log("Warning, gif stream longer than expected.");l[V++]=De;var Fe=V+=ne;for(K!==J&&(l[V++]=De),de=K;ne--;)de=te[de],l[--Fe]=255&de,de>>=8;H!==null&&T<4096&&(te[T++]=H<<8|De,T>=M+1&&A<12&&(++A,M=M<<1|1)),H=J}else T=x+1,M=(1<<(A=f+1))-1,H=null}return V!==c&&Pa.log("Warning, gif stream shorter than expected."),l}function F2(a){var n,l,c,f,i,x=Math.floor,T=new Array(64),A=new Array(64),M=new Array(64),F=new Array(64),W=new Array(65535),V=new Array(65535),R=new Array(64),te=new Array(64),H=[],J=0,K=7,ne=new Array(64),de=new Array(64),De=new Array(64),Fe=new Array(256),et=new Array(2048),Te=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],ge=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],Ve=[0,1,2,3,4,5,6,7,8,9,10,11],Ae=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],_e=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],xe=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Qe=[0,1,2,3,4,5,6,7,8,9,10,11],Ce=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Ye=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ut(ie,ye){for(var pe=0,Ie=0,Ue=new Array,gt=1;gt<=16;gt++){for(var mt=1;mt<=ie[gt];mt++)Ue[ye[Ie]]=[],Ue[ye[Ie]][0]=pe,Ue[ye[Ie]][1]=gt,Ie++,pe++;pe*=2}return Ue}function st(ie){for(var ye=ie[0],pe=ie[1]-1;pe>=0;)ye&1<<pe&&(J|=1<<K),pe--,--K<0&&(J==255?(pt(255),pt(0)):pt(J),K=7,J=0)}function pt(ie){H.push(ie)}function Tt(ie){pt(ie>>8&255),pt(255&ie)}function ht(ie,ye,pe,Ie,Ue){for(var gt,mt=Ue[0],wt=Ue[240],Lt=function(bi,ki){var Ni,Bi,tr,ar,vr,kr,qr,Kr,xr,Or,Ri=0;for(xr=0;xr<8;++xr){Ni=bi[Ri],Bi=bi[Ri+1],tr=bi[Ri+2],ar=bi[Ri+3],vr=bi[Ri+4],kr=bi[Ri+5],qr=bi[Ri+6];var La=Ni+(Kr=bi[Ri+7]),Di=Ni-Kr,go=Bi+qr,fr=Bi-qr,Sn=tr+kr,_o=tr-kr,$r=ar+vr,so=ar-vr,Rn=La+$r,Ja=La-$r,xo=go+Sn,vn=go-Sn;bi[Ri]=Rn+xo,bi[Ri+4]=Rn-xo;var Ar=.707106781*(vn+Ja);bi[Ri+2]=Ja+Ar,bi[Ri+6]=Ja-Ar;var dn=.382683433*((Rn=so+_o)-(vn=fr+Di)),as=.5411961*Rn+dn,kn=1.306562965*vn+dn,lo=.707106781*(xo=_o+fr),ka=Di+lo,Ki=Di-lo;bi[Ri+5]=Ki+as,bi[Ri+3]=Ki-as,bi[Ri+1]=ka+kn,bi[Ri+7]=ka-kn,Ri+=8}for(Ri=0,xr=0;xr<8;++xr){Ni=bi[Ri],Bi=bi[Ri+8],tr=bi[Ri+16],ar=bi[Ri+24],vr=bi[Ri+32],kr=bi[Ri+40],qr=bi[Ri+48];var Ro=Ni+(Kr=bi[Ri+56]),Qa=Ni-Kr,Va=Bi+qr,ca=Bi-qr,$n=tr+kr,ee=tr-kr,z=ar+vr,G=ar-vr,Q=Ro+z,se=Ro-z,le=Va+$n,Me=Va-$n;bi[Ri]=Q+le,bi[Ri+32]=Q-le;var Ze=.707106781*(Me+se);bi[Ri+16]=se+Ze,bi[Ri+48]=se-Ze;var ke=.382683433*((Q=G+ee)-(Me=ca+Qa)),We=.5411961*Q+ke,nt=1.306562965*Me+ke,dt=.707106781*(le=ee+ca),Pt=Qa+dt,ti=Qa-dt;bi[Ri+40]=ti+We,bi[Ri+24]=ti-We,bi[Ri+8]=Pt+nt,bi[Ri+56]=Pt-nt,Ri++}for(xr=0;xr<64;++xr)Or=bi[xr]*ki[xr],R[xr]=Or>0?Or+.5|0:Or-.5|0;return R}(ie,ye),fi=0;fi<64;++fi)te[Te[fi]]=Lt[fi];var yi=te[0]-pe;pe=te[0],yi==0?st(Ie[0]):(st(Ie[V[gt=32767+yi]]),st(W[gt]));for(var Fi=63;Fi>0&&te[Fi]==0;)Fi--;if(Fi==0)return st(mt),pe;for(var Pi,$t=1;$t<=Fi;){for(var lt=$t;te[$t]==0&&$t<=Fi;)++$t;var Bt=$t-lt;if(Bt>=16){Pi=Bt>>4;for(var ni=1;ni<=Pi;++ni)st(wt);Bt&=15}gt=32767+te[$t],st(Ue[(Bt<<4)+V[gt]]),st(W[gt]),$t++}return Fi!=63&&st(mt),pe}function Wt(ie){ie=Math.min(Math.max(ie,1),100),i!=ie&&(function(ye){for(var pe=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Ie=0;Ie<64;Ie++){var Ue=x((pe[Ie]*ye+50)/100);Ue=Math.min(Math.max(Ue,1),255),T[Te[Ie]]=Ue}for(var gt=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],mt=0;mt<64;mt++){var wt=x((gt[mt]*ye+50)/100);wt=Math.min(Math.max(wt,1),255),A[Te[mt]]=wt}for(var Lt=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],fi=0,yi=0;yi<8;yi++)for(var Fi=0;Fi<8;Fi++)M[fi]=1/(T[Te[fi]]*Lt[yi]*Lt[Fi]*8),F[fi]=1/(A[Te[fi]]*Lt[yi]*Lt[Fi]*8),fi++}(ie<50?Math.floor(5e3/ie):Math.floor(200-2*ie)),i=ie)}this.encode=function(ie,ye){ye&&Wt(ye),H=new Array,J=0,K=7,Tt(65496),Tt(65504),Tt(16),pt(74),pt(70),pt(73),pt(70),pt(0),pt(1),pt(1),pt(0),Tt(1),Tt(1),pt(0),pt(0),function(){Tt(65499),Tt(132),pt(0);for(var Bi=0;Bi<64;Bi++)pt(T[Bi]);pt(1);for(var tr=0;tr<64;tr++)pt(A[tr])}(),function(Bi,tr){Tt(65472),Tt(17),pt(8),Tt(tr),Tt(Bi),pt(3),pt(1),pt(17),pt(0),pt(2),pt(17),pt(1),pt(3),pt(17),pt(1)}(ie.width,ie.height),function(){Tt(65476),Tt(418),pt(0);for(var Bi=0;Bi<16;Bi++)pt(ge[Bi+1]);for(var tr=0;tr<=11;tr++)pt(Ve[tr]);pt(16);for(var ar=0;ar<16;ar++)pt(Ae[ar+1]);for(var vr=0;vr<=161;vr++)pt(_e[vr]);pt(1);for(var kr=0;kr<16;kr++)pt(xe[kr+1]);for(var qr=0;qr<=11;qr++)pt(Qe[qr]);pt(17);for(var Kr=0;Kr<16;Kr++)pt(Ce[Kr+1]);for(var xr=0;xr<=161;xr++)pt(Ye[xr])}(),Tt(65498),Tt(12),pt(3),pt(1),pt(0),pt(2),pt(17),pt(3),pt(17),pt(0),pt(63),pt(0);var pe=0,Ie=0,Ue=0;J=0,K=7,this.encode.displayName="_encode_";for(var gt,mt,wt,Lt,fi,yi,Fi,Pi,$t,lt=ie.data,Bt=ie.width,ni=ie.height,bi=4*Bt,ki=0;ki<ni;){for(gt=0;gt<bi;){for(fi=bi*ki+gt,Fi=-1,Pi=0,$t=0;$t<64;$t++)yi=fi+(Pi=$t>>3)*bi+(Fi=4*(7&$t)),ki+Pi>=ni&&(yi-=bi*(ki+1+Pi-ni)),gt+Fi>=bi&&(yi-=gt+Fi-bi+4),mt=lt[yi++],wt=lt[yi++],Lt=lt[yi++],ne[$t]=(et[mt]+et[wt+256>>0]+et[Lt+512>>0]>>16)-128,de[$t]=(et[mt+768>>0]+et[wt+1024>>0]+et[Lt+1280>>0]>>16)-128,De[$t]=(et[mt+1280>>0]+et[wt+1536>>0]+et[Lt+1792>>0]>>16)-128;pe=ht(ne,M,pe,n,c),Ie=ht(de,F,Ie,l,f),Ue=ht(De,F,Ue,l,f),gt+=32}ki+=8}if(K>=0){var Ni=[];Ni[1]=K+1,Ni[0]=(1<<K+1)-1,st(Ni)}return Tt(65497),new Uint8Array(H)},a=a||50,function(){for(var ie=String.fromCharCode,ye=0;ye<256;ye++)Fe[ye]=ie(ye)}(),n=ut(ge,Ve),l=ut(xe,Qe),c=ut(Ae,_e),f=ut(Ce,Ye),function(){for(var ie=1,ye=2,pe=1;pe<=15;pe++){for(var Ie=ie;Ie<ye;Ie++)V[32767+Ie]=pe,W[32767+Ie]=[],W[32767+Ie][1]=pe,W[32767+Ie][0]=Ie;for(var Ue=-(ye-1);Ue<=-ie;Ue++)V[32767+Ue]=pe,W[32767+Ue]=[],W[32767+Ue][1]=pe,W[32767+Ue][0]=ye-1+Ue;ie<<=1,ye<<=1}}(),function(){for(var ie=0;ie<256;ie++)et[ie]=19595*ie,et[ie+256>>0]=38470*ie,et[ie+512>>0]=7471*ie+32768,et[ie+768>>0]=-11059*ie,et[ie+1024>>0]=-21709*ie,et[ie+1280>>0]=32768*ie+8421375,et[ie+1536>>0]=-27439*ie,et[ie+1792>>0]=-5329*ie}(),Wt(a)}function rh(a,n){if(this.pos=0,this.buffer=a,this.datav=new DataView(a.buffer),this.is_with_alpha=!!n,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function N4(a){function n(ge){if(!ge)throw Error("assert :P")}function l(ge,Ve,Ae){for(var _e=0;4>_e;_e++)if(ge[Ve+_e]!=Ae.charCodeAt(_e))return!0;return!1}function c(ge,Ve,Ae,_e,xe){for(var Qe=0;Qe<xe;Qe++)ge[Ve+Qe]=Ae[_e+Qe]}function f(ge,Ve,Ae,_e){for(var xe=0;xe<_e;xe++)ge[Ve+xe]=Ae}function i(ge){return new Int32Array(ge)}function x(ge,Ve){for(var Ae=[],_e=0;_e<ge;_e++)Ae.push(new Ve);return Ae}function T(ge,Ve){var Ae=[];return function _e(xe,Qe,Ce){for(var Ye=Ce[Qe],ut=0;ut<Ye&&(xe.push(Ce.length>Qe+1?[]:new Ve),!(Ce.length<Qe+1));ut++)_e(xe[ut],Qe+1,Ce)}(Ae,0,ge),Ae}var A=function(){var ge=this;function Ve(I,L){for(var Y=1<<L-1>>>0;I&Y;)Y>>>=1;return Y?(I&Y-1)+Y:I}function Ae(I,L,Y,ce,Se){n(!(ce%Y));do I[L+(ce-=Y)]=Se;while(0<ce)}function _e(I,L,Y,ce,Se){if(n(2328>=Se),512>=Se)var Re=i(512);else if((Re=i(Se))==null)return 0;return function(ze,He,Xe,tt,St,rt){var Vt,Ft,xi=He,ii=1<<Xe,Et=i(16),It=i(16);for(n(St!=0),n(tt!=null),n(ze!=null),n(0<Xe),Ft=0;Ft<St;++Ft){if(15<tt[Ft])return 0;++Et[tt[Ft]]}if(Et[0]==St)return 0;for(It[1]=0,Vt=1;15>Vt;++Vt){if(Et[Vt]>1<<Vt)return 0;It[Vt+1]=It[Vt]+Et[Vt]}for(Ft=0;Ft<St;++Ft)Vt=tt[Ft],0<tt[Ft]&&(rt[It[Vt]++]=Ft);if(It[15]==1)return(tt=new xe).g=0,tt.value=rt[0],Ae(ze,xi,1,ii,tt),ii;var ui,vi=-1,gi=ii-1,qi=0,Hi=1,Sr=1,Gi=1<<Xe;for(Ft=0,Vt=1,St=2;Vt<=Xe;++Vt,St<<=1){if(Hi+=Sr<<=1,0>(Sr-=Et[Vt]))return 0;for(;0<Et[Vt];--Et[Vt])(tt=new xe).g=Vt,tt.value=rt[Ft++],Ae(ze,xi+qi,St,Gi,tt),qi=Ve(qi,Vt)}for(Vt=Xe+1,St=2;15>=Vt;++Vt,St<<=1){if(Hi+=Sr<<=1,0>(Sr-=Et[Vt]))return 0;for(;0<Et[Vt];--Et[Vt]){if(tt=new xe,(qi&gi)!=vi){for(xi+=Gi,ui=1<<(vi=Vt)-Xe;15>vi&&!(0>=(ui-=Et[vi]));)++vi,ui<<=1;ii+=Gi=1<<(ui=vi-Xe),ze[He+(vi=qi&gi)].g=ui+Xe,ze[He+vi].value=xi-He-vi}tt.g=Vt-Xe,tt.value=rt[Ft++],Ae(ze,xi+(qi>>Xe),St,Gi,tt),qi=Ve(qi,Vt)}}return Hi!=2*It[15]-1?0:ii}(I,L,Y,ce,Se,Re)}function xe(){this.value=this.g=0}function Qe(){this.value=this.g=0}function Ce(){this.G=x(5,xe),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=x(Zo,Qe)}function Ye(I,L,Y,ce){n(I!=null),n(L!=null),n(2147483648>ce),I.Ca=254,I.I=0,I.b=-8,I.Ka=0,I.oa=L,I.pa=Y,I.Jd=L,I.Yc=Y+ce,I.Zc=4<=ce?Y+ce-4+1:Y,gt(I)}function ut(I,L){for(var Y=0;0<L--;)Y|=wt(I,128)<<L;return Y}function st(I,L){var Y=ut(I,L);return mt(I)?-Y:Y}function pt(I,L,Y,ce){var Se,Re=0;for(n(I!=null),n(L!=null),n(4294967288>ce),I.Sb=ce,I.Ra=0,I.u=0,I.h=0,4<ce&&(ce=4),Se=0;Se<ce;++Se)Re+=L[Y+Se]<<8*Se;I.Ra=Re,I.bb=ce,I.oa=L,I.pa=Y}function Tt(I){for(;8<=I.u&&I.bb<I.Sb;)I.Ra>>>=8,I.Ra+=I.oa[I.pa+I.bb]<<pc-8>>>0,++I.bb,I.u-=8;pe(I)&&(I.h=1,I.u=0)}function ht(I,L){if(n(0<=L),!I.h&&L<=Gc){var Y=ye(I)&fc[L];return I.u+=L,Tt(I),Y}return I.h=1,I.u=0}function Wt(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function ie(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function ye(I){return I.Ra>>>(I.u&pc-1)>>>0}function pe(I){return n(I.bb<=I.Sb),I.h||I.bb==I.Sb&&I.u>pc}function Ie(I,L){I.u=L,I.h=pe(I)}function Ue(I){I.u>=mc&&(n(I.u>=mc),Tt(I))}function gt(I){n(I!=null&&I.oa!=null),I.pa<I.Zc?(I.I=(I.oa[I.pa++]|I.I<<8)>>>0,I.b+=8):(n(I!=null&&I.oa!=null),I.pa<I.Yc?(I.b+=8,I.I=I.oa[I.pa++]|I.I<<8):I.Ka?I.b=0:(I.I<<=8,I.b+=8,I.Ka=1))}function mt(I){return ut(I,1)}function wt(I,L){var Y=I.Ca;0>I.b&&gt(I);var ce=I.b,Se=Y*L>>>8,Re=(I.I>>>ce>Se)+0;for(Re?(Y-=Se,I.I-=Se+1<<ce>>>0):Y=Se+1,ce=Y,Se=0;256<=ce;)Se+=8,ce>>=8;return ce=7^Se+ro[ce],I.b-=ce,I.Ca=(Y<<ce)-1,Re}function Lt(I,L,Y){I[L+0]=Y>>24&255,I[L+1]=Y>>16&255,I[L+2]=Y>>8&255,I[L+3]=Y>>0&255}function fi(I,L){return I[L+0]<<0|I[L+1]<<8}function yi(I,L){return fi(I,L)|I[L+2]<<16}function Fi(I,L){return fi(I,L)|fi(I,L+2)<<16}function Pi(I,L){var Y=1<<L;return n(I!=null),n(0<L),I.X=i(Y),I.X==null?0:(I.Mb=32-L,I.Xa=L,1)}function $t(I,L){n(I!=null),n(L!=null),n(I.Xa==L.Xa),c(L.X,0,I.X,0,1<<L.Xa)}function lt(){this.X=[],this.Xa=this.Mb=0}function Bt(I,L,Y,ce){n(Y!=null),n(ce!=null);var Se=Y[0],Re=ce[0];return Se==0&&(Se=(I*Re+L/2)/L),Re==0&&(Re=(L*Se+I/2)/I),0>=Se||0>=Re?0:(Y[0]=Se,ce[0]=Re,1)}function ni(I,L){return I+(1<<L)-1>>>L}function bi(I,L){return((4278255360&I)+(4278255360&L)>>>0&4278255360)+((16711935&I)+(16711935&L)>>>0&16711935)>>>0}function ki(I,L){ge[L]=function(Y,ce,Se,Re,ze,He,Xe){var tt;for(tt=0;tt<ze;++tt){var St=ge[I](He[Xe+tt-1],Se,Re+tt);He[Xe+tt]=bi(Y[ce+tt],St)}}}function Ni(){this.ud=this.hd=this.jd=0}function Bi(I,L){return((4278124286&(I^L))>>>1)+(I&L)>>>0}function tr(I){return 0<=I&&256>I?I:0>I?0:255<I?255:void 0}function ar(I,L){return tr(I+(I-L+.5>>1))}function vr(I,L,Y){return Math.abs(L-Y)-Math.abs(I-Y)}function kr(I,L,Y,ce,Se,Re,ze){for(ce=Re[ze-1],Y=0;Y<Se;++Y)Re[ze+Y]=ce=bi(I[L+Y],ce)}function qr(I,L,Y,ce,Se){var Re;for(Re=0;Re<Y;++Re){var ze=I[L+Re],He=ze>>8&255,Xe=16711935&(Xe=(Xe=16711935&ze)+((He<<16)+He));ce[Se+Re]=(4278255360&ze)+Xe>>>0}}function Kr(I,L){L.jd=I>>0&255,L.hd=I>>8&255,L.ud=I>>16&255}function xr(I,L,Y,ce,Se,Re){var ze;for(ze=0;ze<ce;++ze){var He=L[Y+ze],Xe=He>>>8,tt=He,St=255&(St=(St=He>>>16)+((I.jd<<24>>24)*(Xe<<24>>24)>>>5));tt=255&(tt=(tt=tt+((I.hd<<24>>24)*(Xe<<24>>24)>>>5))+((I.ud<<24>>24)*(St<<24>>24)>>>5)),Se[Re+ze]=(4278255360&He)+(St<<16)+tt}}function Or(I,L,Y,ce,Se){ge[L]=function(Re,ze,He,Xe,tt,St,rt,Vt,Ft){for(Xe=rt;Xe<Vt;++Xe)for(rt=0;rt<Ft;++rt)tt[St++]=Se(He[ce(Re[ze++])])},ge[I]=function(Re,ze,He,Xe,tt,St,rt){var Vt=8>>Re.b,Ft=Re.Ea,xi=Re.K[0],ii=Re.w;if(8>Vt)for(Re=(1<<Re.b)-1,ii=(1<<Vt)-1;ze<He;++ze){var Et,It=0;for(Et=0;Et<Ft;++Et)Et&Re||(It=ce(Xe[tt++])),St[rt++]=Se(xi[It&ii]),It>>=Vt}else ge["VP8LMapColor"+Y](Xe,tt,xi,ii,St,rt,ze,He,Ft)}}function Ri(I,L,Y,ce,Se){for(Y=L+Y;L<Y;){var Re=I[L++];ce[Se++]=Re>>16&255,ce[Se++]=Re>>8&255,ce[Se++]=Re>>0&255}}function La(I,L,Y,ce,Se){for(Y=L+Y;L<Y;){var Re=I[L++];ce[Se++]=Re>>16&255,ce[Se++]=Re>>8&255,ce[Se++]=Re>>0&255,ce[Se++]=Re>>24&255}}function Di(I,L,Y,ce,Se){for(Y=L+Y;L<Y;){var Re=(ze=I[L++])>>16&240|ze>>12&15,ze=ze>>0&240|ze>>28&15;ce[Se++]=Re,ce[Se++]=ze}}function go(I,L,Y,ce,Se){for(Y=L+Y;L<Y;){var Re=(ze=I[L++])>>16&248|ze>>13&7,ze=ze>>5&224|ze>>3&31;ce[Se++]=Re,ce[Se++]=ze}}function fr(I,L,Y,ce,Se){for(Y=L+Y;L<Y;){var Re=I[L++];ce[Se++]=Re>>0&255,ce[Se++]=Re>>8&255,ce[Se++]=Re>>16&255}}function Sn(I,L,Y,ce,Se,Re){if(Re==0)for(Y=L+Y;L<Y;)Lt(ce,((Re=I[L++])[0]>>24|Re[1]>>8&65280|Re[2]<<8&16711680|Re[3]<<24)>>>0),Se+=32;else c(ce,Se,I,L,Y)}function _o(I,L){ge[L][0]=ge[I+"0"],ge[L][1]=ge[I+"1"],ge[L][2]=ge[I+"2"],ge[L][3]=ge[I+"3"],ge[L][4]=ge[I+"4"],ge[L][5]=ge[I+"5"],ge[L][6]=ge[I+"6"],ge[L][7]=ge[I+"7"],ge[L][8]=ge[I+"8"],ge[L][9]=ge[I+"9"],ge[L][10]=ge[I+"10"],ge[L][11]=ge[I+"11"],ge[L][12]=ge[I+"12"],ge[L][13]=ge[I+"13"],ge[L][14]=ge[I+"0"],ge[L][15]=ge[I+"0"]}function $r(I){return I==Ao||I==$c||I==Fr||I==Rs}function so(){this.eb=[],this.size=this.A=this.fb=0}function Rn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Ja(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new so,this.f.kb=new Rn,this.sd=null}function xo(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function vn(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Ar(I){return alert("todo:WebPSamplerProcessPlane"),I.T}function dn(I,L){var Y=I.T,ce=L.ba.f.RGBA,Se=ce.eb,Re=ce.fb+I.ka*ce.A,ze=za[L.ba.S],He=I.y,Xe=I.O,tt=I.f,St=I.N,rt=I.ea,Vt=I.W,Ft=L.cc,xi=L.dc,ii=L.Mc,Et=L.Nc,It=I.ka,ui=I.ka+I.T,vi=I.U,gi=vi+1>>1;for(It==0?ze(He,Xe,null,null,tt,St,rt,Vt,tt,St,rt,Vt,Se,Re,null,null,vi):(ze(L.ec,L.fc,He,Xe,Ft,xi,ii,Et,tt,St,rt,Vt,Se,Re-ce.A,Se,Re,vi),++Y);It+2<ui;It+=2)Ft=tt,xi=St,ii=rt,Et=Vt,St+=I.Rc,Vt+=I.Rc,Re+=2*ce.A,ze(He,(Xe+=2*I.fa)-I.fa,He,Xe,Ft,xi,ii,Et,tt,St,rt,Vt,Se,Re-ce.A,Se,Re,vi);return Xe+=I.fa,I.j+ui<I.o?(c(L.ec,L.fc,He,Xe,vi),c(L.cc,L.dc,tt,St,gi),c(L.Mc,L.Nc,rt,Vt,gi),Y--):1&ui||ze(He,Xe,null,null,tt,St,rt,Vt,tt,St,rt,Vt,Se,Re+ce.A,null,null,vi),Y}function as(I,L,Y){var ce=I.F,Se=[I.J];if(ce!=null){var Re=I.U,ze=L.ba.S,He=ze==Ti||ze==Fr;L=L.ba.f.RGBA;var Xe=[0],tt=I.ka;Xe[0]=I.T,I.Kb&&(tt==0?--Xe[0]:(--tt,Se[0]-=I.width),I.j+I.ka+I.T==I.o&&(Xe[0]=I.o-I.j-tt));var St=L.eb;tt=L.fb+tt*L.A,I=jl(ce,Se[0],I.width,Re,Xe,St,tt+(He?0:3),L.A),n(Y==Xe),I&&$r(ze)&&Na(St,tt,He,Re,Xe,L.A)}return 0}function kn(I){var L=I.ma,Y=L.ba.S,ce=11>Y,Se=Y==Ls||Y==vc||Y==Ti||Y==Br||Y==12||$r(Y);if(L.memory=null,L.Ib=null,L.Jb=null,L.Nd=null,!vu(L.Oa,I,Se?11:12))return 0;if(Se&&$r(Y)&&Mi(),I.da)alert("todo:use_scaling");else{if(ce){if(L.Ib=Ar,I.Kb){if(Y=I.U+1>>1,L.memory=i(I.U+2*Y),L.memory==null)return 0;L.ec=L.memory,L.fc=0,L.cc=L.ec,L.dc=L.fc+I.U,L.Mc=L.cc,L.Nc=L.dc+Y,L.Ib=dn,Mi()}}else alert("todo:EmitYUV");Se&&(L.Jb=as,ce&&Rt())}if(ce&&!Rr){for(I=0;256>I;++I)Tc[I]=89858*(I-128)+Yc>>ef,D0[I]=-22014*(I-128)+Yc,M0[I]=-45773*(I-128),um[I]=113618*(I-128)+Yc>>ef;for(I=Hl;I<np;++I)L=76283*(I-16)+Yc>>ef,od[I-Hl]=us(L,255),tf[I-Hl]=us(L+8>>4,15);Rr=1}return 1}function lo(I){var L=I.ma,Y=I.U,ce=I.T;return n(!(1&I.ka)),0>=Y||0>=ce?0:(Y=L.Ib(I,L),L.Jb!=null&&L.Jb(I,L,Y),L.Dc+=Y,1)}function ka(I){I.ma.memory=null}function Ki(I,L,Y,ce){return ht(I,8)!=47?0:(L[0]=ht(I,14)+1,Y[0]=ht(I,14)+1,ce[0]=ht(I,1),ht(I,3)!=0?0:!I.h)}function Ro(I,L){if(4>I)return I+1;var Y=I-2>>1;return(2+(1&I)<<Y)+ht(L,Y)+1}function Qa(I,L){return 120<L?L-120:1<=(Y=((Y=nd[L-1])>>4)*I+(8-(15&Y)))?Y:1;var Y}function Va(I,L,Y){var ce=ye(Y),Se=I[L+=255&ce].g-8;return 0<Se&&(Ie(Y,Y.u+8),ce=ye(Y),L+=I[L].value,L+=ce&(1<<Se)-1),Ie(Y,Y.u+I[L].g),I[L].value}function ca(I,L,Y){return Y.g+=I.g,Y.value+=I.value<<L>>>0,n(8>=Y.g),I.g}function $n(I,L,Y){var ce=I.xc;return n((L=ce==0?0:I.vc[I.md*(Y>>ce)+(L>>ce)])<I.Wb),I.Ya[L]}function ee(I,L,Y,ce){var Se=I.ab,Re=I.c*L,ze=I.C;L=ze+L;var He=Y,Xe=ce;for(ce=I.Ta,Y=I.Ua;0<Se--;){var tt=I.gc[Se],St=ze,rt=L,Vt=He,Ft=Xe,xi=(Xe=ce,He=Y,tt.Ea);switch(n(St<rt),n(rt<=tt.nc),tt.hc){case 2:Wc(Vt,Ft,(rt-St)*xi,Xe,He);break;case 0:var ii=St,Et=rt,It=Xe,ui=He,vi=(Gi=tt).Ea;ii==0&&(Zd(Vt,Ft,null,null,1,It,ui),kr(Vt,Ft+1,0,0,vi-1,It,ui+1),Ft+=vi,ui+=vi,++ii);for(var gi=1<<Gi.b,qi=gi-1,Hi=ni(vi,Gi.b),Sr=Gi.K,Gi=Gi.w+(ii>>Gi.b)*Hi;ii<Et;){var An=Sr,Mn=Gi,Jr=1;for(bu(Vt,Ft,It,ui-vi,1,It,ui);Jr<vi;){var on=(Jr&~qi)+gi;on>vi&&(on=vi),(0,qc[An[Mn++]>>8&15])(Vt,Ft+ +Jr,It,ui+Jr-vi,on-Jr,It,ui+Jr),Jr=on}Ft+=vi,ui+=vi,++ii&qi||(Gi+=Hi)}rt!=tt.nc&&c(Xe,He-xi,Xe,He+(rt-St-1)*xi,xi);break;case 1:for(xi=Vt,Et=Ft,vi=(Vt=tt.Ea)-(ui=Vt&~(It=(Ft=1<<tt.b)-1)),ii=ni(Vt,tt.b),gi=tt.K,tt=tt.w+(St>>tt.b)*ii;St<rt;){for(qi=gi,Hi=tt,Sr=new Ni,Gi=Et+ui,An=Et+Vt;Et<Gi;)Kr(qi[Hi++],Sr),Oa(Sr,xi,Et,Ft,Xe,He),Et+=Ft,He+=Ft;Et<An&&(Kr(qi[Hi++],Sr),Oa(Sr,xi,Et,vi,Xe,He),Et+=vi,He+=vi),++St&It||(tt+=ii)}break;case 3:if(Vt==Xe&&Ft==He&&0<tt.b){for(Et=Xe,Vt=xi=He+(rt-St)*xi-(ui=(rt-St)*ni(tt.Ea,tt.b)),Ft=Xe,It=He,ii=[],ui=(vi=ui)-1;0<=ui;--ui)ii[ui]=Ft[It+ui];for(ui=vi-1;0<=ui;--ui)Et[Vt+ui]=ii[ui];Yo(tt,St,rt,Xe,xi,Xe,He)}else Yo(tt,St,rt,Vt,Ft,Xe,He)}He=ce,Xe=Y}Xe!=Y&&c(ce,Y,He,Xe,Re)}function z(I,L){var Y=I.V,ce=I.Ba+I.c*I.C,Se=L-I.C;if(n(L<=I.l.o),n(16>=Se),0<Se){var Re=I.l,ze=I.Ta,He=I.Ua,Xe=Re.width;if(ee(I,Se,Y,ce),Se=He=[He],n((Y=I.C)<(ce=L)),n(Re.v<Re.va),ce>Re.o&&(ce=Re.o),Y<Re.j){var tt=Re.j-Y;Y=Re.j,Se[0]+=tt*Xe}if(Y>=ce?Y=0:(Se[0]+=4*Re.v,Re.ka=Y-Re.j,Re.U=Re.va-Re.v,Re.T=ce-Y,Y=1),Y){if(He=He[0],11>(Y=I.ca).S){var St=Y.f.RGBA,rt=(ce=Y.S,Se=Re.U,Re=Re.T,tt=St.eb,St.A),Vt=Re;for(St=St.fb+I.Ma*St.A;0<Vt--;){var Ft=ze,xi=He,ii=Se,Et=tt,It=St;switch(ce){case _h:No(Ft,xi,ii,Et,It);break;case Ls:gl(Ft,xi,ii,Et,It);break;case Ao:gl(Ft,xi,ii,Et,It),Na(Et,It,0,ii,1,0);break;case Kd:wu(Ft,xi,ii,Et,It);break;case vc:Sn(Ft,xi,ii,Et,It,1);break;case $c:Sn(Ft,xi,ii,Et,It,1),Na(Et,It,0,ii,1,0);break;case Ti:Sn(Ft,xi,ii,Et,It,0);break;case Fr:Sn(Ft,xi,ii,Et,It,0),Na(Et,It,1,ii,1,0);break;case Br:_l(Ft,xi,ii,Et,It);break;case Rs:_l(Ft,xi,ii,Et,It),xc(Et,It,ii,1,0);break;case Vr:Ds(Ft,xi,ii,Et,It);break;default:n(0)}He+=Xe,St+=rt}I.Ma+=Re}else alert("todo:EmitRescaledRowsYUVA");n(I.Ma<=Y.height)}}I.C=L,n(I.C<=I.i)}function G(I){var L;if(0<I.ua)return 0;for(L=0;L<I.Wb;++L){var Y=I.Ya[L].G,ce=I.Ya[L].H;if(0<Y[1][ce[1]+0].g||0<Y[2][ce[2]+0].g||0<Y[3][ce[3]+0].g)return 0}return 1}function Q(I,L,Y,ce,Se,Re){if(I.Z!=0){var ze=I.qd,He=I.rd;for(n(Zc[I.Z]!=null);L<Y;++L)Zc[I.Z](ze,He,ce,Se,ce,Se,Re),ze=ce,He=Se,Se+=Re;I.qd=ze,I.rd=He}}function se(I,L){var Y=I.l.ma,ce=Y.Z==0||Y.Z==1?I.l.j:I.C;if(ce=I.C<ce?ce:I.C,n(L<=I.l.o),L>ce){var Se=I.l.width,Re=Y.ca,ze=Y.tb+Se*ce,He=I.V,Xe=I.Ba+I.c*ce,tt=I.gc;n(I.ab==1),n(tt[0].hc==3),td(tt[0],ce,L,He,Xe,Re,ze),Q(Y,ce,L,Re,ze,Se)}I.C=I.Ma=L}function le(I,L,Y,ce,Se,Re,ze){var He=I.$/ce,Xe=I.$%ce,tt=I.m,St=I.s,rt=Y+I.$,Vt=rt;Se=Y+ce*Se;var Ft=Y+ce*Re,xi=280+St.ua,ii=I.Pb?He:16777216,Et=0<St.ua?St.Wa:null,It=St.wc,ui=rt<Ft?$n(St,Xe,He):null;n(I.C<Re),n(Ft<=Se);var vi=!1;e:for(;;){for(;vi||rt<Ft;){var gi=0;if(He>=ii){var qi=rt-Y;n((ii=I).Pb),ii.wd=ii.m,ii.xd=qi,0<ii.s.ua&&$t(ii.s.Wa,ii.s.vb),ii=He+vh}if(Xe&It||(ui=$n(St,Xe,He)),n(ui!=null),ui.Qb&&(L[rt]=ui.qb,vi=!0),!vi)if(Ue(tt),ui.jc){gi=tt,qi=L;var Hi=rt,Sr=ui.pd[ye(gi)&Zo-1];n(ui.jc),256>Sr.g?(Ie(gi,gi.u+Sr.g),qi[Hi]=Sr.value,gi=0):(Ie(gi,gi.u+Sr.g-256),n(256<=Sr.value),gi=Sr.value),gi==0&&(vi=!0)}else gi=Va(ui.G[0],ui.H[0],tt);if(tt.h)break;if(vi||256>gi){if(!vi)if(ui.nd)L[rt]=(ui.qb|gi<<8)>>>0;else{if(Ue(tt),vi=Va(ui.G[1],ui.H[1],tt),Ue(tt),qi=Va(ui.G[2],ui.H[2],tt),Hi=Va(ui.G[3],ui.H[3],tt),tt.h)break;L[rt]=(Hi<<24|vi<<16|gi<<8|qi)>>>0}if(vi=!1,++rt,++Xe>=ce&&(Xe=0,++He,ze!=null&&He<=Re&&!(He%16)&&ze(I,He),Et!=null))for(;Vt<rt;)gi=L[Vt++],Et.X[(506832829*gi&4294967295)>>>Et.Mb]=gi}else if(280>gi){if(gi=Ro(gi-256,tt),qi=Va(ui.G[4],ui.H[4],tt),Ue(tt),qi=Qa(ce,qi=Ro(qi,tt)),tt.h)break;if(rt-Y<qi||Se-rt<gi)break e;for(Hi=0;Hi<gi;++Hi)L[rt+Hi]=L[rt+Hi-qi];for(rt+=gi,Xe+=gi;Xe>=ce;)Xe-=ce,++He,ze!=null&&He<=Re&&!(He%16)&&ze(I,He);if(n(rt<=Se),Xe&It&&(ui=$n(St,Xe,He)),Et!=null)for(;Vt<rt;)gi=L[Vt++],Et.X[(506832829*gi&4294967295)>>>Et.Mb]=gi}else{if(!(gi<xi))break e;for(vi=gi-280,n(Et!=null);Vt<rt;)gi=L[Vt++],Et.X[(506832829*gi&4294967295)>>>Et.Mb]=gi;gi=rt,n(!(vi>>>(qi=Et).Xa)),L[gi]=qi.X[vi],vi=!0}vi||n(tt.h==pe(tt))}if(I.Pb&&tt.h&&rt<Se)n(I.m.h),I.a=5,I.m=I.wd,I.$=I.xd,0<I.s.ua&&$t(I.s.vb,I.s.Wa);else{if(tt.h)break e;ze?.(I,He>Re?Re:He),I.a=0,I.$=rt-Y}return 1}return I.a=3,0}function Me(I){n(I!=null),I.vc=null,I.yc=null,I.Ya=null;var L=I.Wa;L!=null&&(L.X=null),I.vb=null,n(I!=null)}function Ze(){var I=new io;return I==null?null:(I.a=0,I.xb=Xc,_o("Predictor","VP8LPredictors"),_o("Predictor","VP8LPredictors_C"),_o("PredictorAdd","VP8LPredictorsAdd"),_o("PredictorAdd","VP8LPredictorsAdd_C"),Wc=qr,Oa=xr,No=Ri,gl=La,_l=Di,Ds=go,wu=fr,ge.VP8LMapColor32b=Xs,ge.VP8LMapColor8b=id,I)}function ke(I,L,Y,ce,Se){var Re=1,ze=[I],He=[L],Xe=ce.m,tt=ce.s,St=null,rt=0;e:for(;;){if(Y)for(;Re&&ht(Xe,1);){var Vt=ze,Ft=He,xi=ce,ii=1,Et=xi.m,It=xi.gc[xi.ab],ui=ht(Et,2);if(xi.Oc&1<<ui)Re=0;else{switch(xi.Oc|=1<<ui,It.hc=ui,It.Ea=Vt[0],It.nc=Ft[0],It.K=[null],++xi.ab,n(4>=xi.ab),ui){case 0:case 1:It.b=ht(Et,3)+2,ii=ke(ni(It.Ea,It.b),ni(It.nc,It.b),0,xi,It.K),It.K=It.K[0];break;case 3:var vi,gi=ht(Et,8)+1,qi=16<gi?0:4<gi?1:2<gi?2:3;if(Vt[0]=ni(It.Ea,qi),It.b=qi,vi=ii=ke(gi,1,0,xi,It.K)){var Hi,Sr=gi,Gi=It,An=1<<(8>>Gi.b),Mn=i(An);if(Mn==null)vi=0;else{var Jr=Gi.K[0],on=Gi.w;for(Mn[0]=Gi.K[0][0],Hi=1;Hi<1*Sr;++Hi)Mn[Hi]=bi(Jr[on+Hi],Mn[Hi-1]);for(;Hi<4*An;++Hi)Mn[Hi]=0;Gi.K[0]=null,Gi.K[0]=Mn,vi=1}}ii=vi;break;case 2:break;default:n(0)}Re=ii}}if(ze=ze[0],He=He[0],Re&&ht(Xe,1)&&!(Re=1<=(rt=ht(Xe,4))&&11>=rt)){ce.a=3;break e}var Zn;if(Zn=Re)t:{var Bn,Wr,Dn,zo=ce,ao=ze,yo=He,yn=rt,fs=Y,es=zo.m,qa=zo.s,uo=[null],$a=1,Io=0,ps=rp[yn];i:for(;;){if(fs&&ht(es,1)){var fn=ht(es,3)+2,jo=ni(ao,fn),Gl=ni(yo,fn),Kc=jo*Gl;if(!ke(jo,Gl,0,zo,uo))break i;for(uo=uo[0],qa.xc=fn,Bn=0;Bn<Kc;++Bn){var Js=uo[Bn]>>8&65535;uo[Bn]=Js,Js>=$a&&($a=Js+1)}}if(es.h)break i;for(Wr=0;5>Wr;++Wr){var ha=Jo[Wr];!Wr&&0<yn&&(ha+=1<<yn),Io<ha&&(Io=ha)}var Cu=x($a*ps,xe),lp=$a,yh=x(lp,Ce);if(yh==null)var Iu=null;else n(65536>=lp),Iu=yh;var Sc=i(Io);if(Iu==null||Sc==null||Cu==null){zo.a=1;break i}var ku=Cu;for(Bn=Dn=0;Bn<$a;++Bn){var Qs=Iu[Bn],Jc=Qs.G,el=Qs.H,cp=0,bh=1,ld=0;for(Wr=0;5>Wr;++Wr){ha=Jo[Wr],Jc[Wr]=ku,el[Wr]=Dn,!Wr&&0<yn&&(ha+=1<<yn);n:{var cd,ud=ha,Mu=zo,Du=Sc,hd=ku,hm=Dn,rf=0,Qc=Mu.m,dd=ht(Qc,1);if(f(Du,0,0,ud),dd){var wh=ht(Qc,1)+1,dm=ht(Qc,1),ms=ht(Qc,dm==0?1:8);Du[ms]=1,wh==2&&(Du[ms=ht(Qc,8)]=1);var Th=1}else{var fd=i(19),pd=ht(Qc,4)+4;if(19<pd){Mu.a=3;var Sh=0;break n}for(cd=0;cd<pd;++cd)fd[I0[cd]]=ht(Qc,3);var md=void 0,eu=void 0,Fu=Mu,up=fd,Pu=ud,Eh=Du,nf=0,gs=Fu.m,fm=8,hp=x(128,xe);r:for(;_e(hp,0,7,up,19);){if(ht(gs,1)){var pm=2+2*ht(gs,3);if((md=2+ht(gs,pm))>Pu)break r}else md=Pu;for(eu=0;eu<Pu&&md--;){Ue(gs);var dp=hp[0+(127&ye(gs))];Ie(gs,gs.u+dp.g);var Lu=dp.value;if(16>Lu)Eh[eu++]=Lu,Lu!=0&&(fm=Lu);else{var fp=Lu==16,Ah=Lu-16,pp=Vl[Ah],mp=ht(gs,xh[Ah])+pp;if(eu+mp>Pu)break r;for(var Ru=fp?fm:0;0<mp--;)Eh[eu++]=Ru}}nf=1;break r}nf||(Fu.a=3),Th=nf}(Th=Th&&!Qc.h)&&(rf=_e(hd,hm,8,Du,ud)),Th&&rf!=0?Sh=rf:(Mu.a=3,Sh=0)}if(Sh==0)break i;if(bh&&ba[Wr]==1&&(bh=ku[Dn].g==0),cp+=ku[Dn].g,Dn+=Sh,3>=Wr){var Ch,af=Sc[0];for(Ch=1;Ch<ha;++Ch)Sc[Ch]>af&&(af=Sc[Ch]);ld+=af}}if(Qs.nd=bh,Qs.Qb=0,bh&&(Qs.qb=(Jc[3][el[3]+0].value<<24|Jc[1][el[1]+0].value<<16|Jc[2][el[2]+0].value)>>>0,cp==0&&256>Jc[0][el[0]+0].value&&(Qs.Qb=1,Qs.qb+=Jc[0][el[0]+0].value<<8)),Qs.jc=!Qs.Qb&&6>ld,Qs.jc){var gd,wl=Qs;for(gd=0;gd<Zo;++gd){var _s=gd,Ec=wl.pd[_s],Wl=wl.G[0][wl.H[0]+_s];256<=Wl.value?(Ec.g=Wl.g+256,Ec.value=Wl.value):(Ec.g=0,Ec.value=0,_s>>=ca(Wl,8,Ec),_s>>=ca(wl.G[1][wl.H[1]+_s],16,Ec),_s>>=ca(wl.G[2][wl.H[2]+_s],0,Ec),ca(wl.G[3][wl.H[3]+_s],24,Ec))}}}qa.vc=uo,qa.Wb=$a,qa.Ya=Iu,qa.yc=Cu,Zn=1;break t}Zn=0}if(!(Re=Zn)){ce.a=3;break e}if(0<rt){if(tt.ua=1<<rt,!Pi(tt.Wa,rt)){ce.a=1,Re=0;break e}}else tt.ua=0;var of=ce,_d=ze,F0=He,m=of.s,o=m.xc;if(of.c=_d,of.i=F0,m.md=ni(_d,o),m.wc=o==0?-1:(1<<o)-1,Y){ce.xb=ad;break e}if((St=i(ze*He))==null){ce.a=1,Re=0;break e}Re=(Re=le(ce,St,0,ze,He,He,null))&&!Xe.h;break e}return Re?(Se!=null?Se[0]=St:(n(St==null),n(Y)),ce.$=0,Y||Me(tt)):Me(tt),Re}function We(I,L){var Y=I.c*I.i,ce=Y+L+16*L;return n(I.c<=L),I.V=i(ce),I.V==null?(I.Ta=null,I.Ua=0,I.a=1,0):(I.Ta=I.V,I.Ua=I.Ba+Y+L,1)}function nt(I,L){var Y=I.C,ce=L-Y,Se=I.V,Re=I.Ba+I.c*Y;for(n(L<=I.l.o);0<ce;){var ze=16<ce?16:ce,He=I.l.ma,Xe=I.l.width,tt=Xe*ze,St=He.ca,rt=He.tb+Xe*Y,Vt=I.Ta,Ft=I.Ua;ee(I,ze,Se,Re),tp(Vt,Ft,St,rt,tt),Q(He,Y,Y+ze,St,rt,Xe),ce-=ze,Se+=ze*I.c,Y+=ze}n(Y==L),I.C=I.Ma=L}function dt(){this.ub=this.yd=this.td=this.Rb=0}function Pt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ti(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Qt(){this.Yb=function(){var I=[];return function L(Y,ce,Se){for(var Re=Se[ce],ze=0;ze<Re&&(Y.push(Se.length>ce+1?[]:0),!(Se.length<ce+1));ze++)L(Y[ze],ce+1,Se)}(I,0,[3,11]),I}()}function oi(){this.jb=i(3),this.Wc=T([4,8],Qt),this.Xc=T([4,17],Qt)}function Ei(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Wi(){this.ld=this.La=this.dd=this.tc=0}function wi(){this.Na=this.la=0}function wr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function dr(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function yr(){this.uc=this.M=this.Nb=0,this.wa=Array(new Wi),this.Y=0,this.ya=Array(new dr),this.aa=0,this.l=new En}function xn(){this.y=i(16),this.f=i(8),this.ea=i(8)}function en(){this.cb=this.a=0,this.sc="",this.m=new Wt,this.Od=new dt,this.Kc=new Pt,this.ed=new Ei,this.Qa=new ti,this.Ic=this.$c=this.Aa=0,this.D=new yr,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=x(8,Wt),this.ia=0,this.pb=x(4,wr),this.Pa=new oi,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new xn),this.Hd=0,this.rb=Array(new wi),this.sb=0,this.wa=Array(new Wi),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new dr),this.L=this.aa=0,this.gd=T([4,2],Wi),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function En(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function On(){var I=new en;return I!=null&&(I.a=0,I.sc="OK",I.cb=0,I.Xb=0,Ga||(Ga=Zh)),I}function sn(I,L,Y){return I.a==0&&(I.a=L,I.sc=Y,I.cb=0),0}function Fl(I,L,Y){return 3<=Y&&I[L+0]==157&&I[L+1]==1&&I[L+2]==42}function oh(I,L){if(I==null)return 0;if(I.a=0,I.sc="OK",L==null)return sn(I,2,"null VP8Io passed to VP8GetHeaders()");var Y=L.data,ce=L.w,Se=L.ha;if(4>Se)return sn(I,7,"Truncated header.");var Re=Y[ce+0]|Y[ce+1]<<8|Y[ce+2]<<16,ze=I.Od;if(ze.Rb=!(1&Re),ze.td=Re>>1&7,ze.yd=Re>>4&1,ze.ub=Re>>5,3<ze.td)return sn(I,3,"Incorrect keyframe parameters.");if(!ze.yd)return sn(I,4,"Frame not displayable.");ce+=3,Se-=3;var He=I.Kc;if(ze.Rb){if(7>Se)return sn(I,7,"cannot parse picture header");if(!Fl(Y,ce,Se))return sn(I,3,"Bad code word");He.c=16383&(Y[ce+4]<<8|Y[ce+3]),He.Td=Y[ce+4]>>6,He.i=16383&(Y[ce+6]<<8|Y[ce+5]),He.Ud=Y[ce+6]>>6,ce+=7,Se-=7,I.za=He.c+15>>4,I.Ub=He.i+15>>4,L.width=He.c,L.height=He.i,L.Da=0,L.j=0,L.v=0,L.va=L.width,L.o=L.height,L.da=0,L.ib=L.width,L.hb=L.height,L.U=L.width,L.T=L.height,f((Re=I.Pa).jb,0,255,Re.jb.length),n((Re=I.Qa)!=null),Re.Cb=0,Re.Bb=0,Re.Fb=1,f(Re.Zb,0,0,Re.Zb.length),f(Re.Lb,0,0,Re.Lb)}if(ze.ub>Se)return sn(I,7,"bad partition length");Ye(Re=I.m,Y,ce,ze.ub),ce+=ze.ub,Se-=ze.ub,ze.Rb&&(He.Ld=mt(Re),He.Kd=mt(Re)),He=I.Qa;var Xe,tt=I.Pa;if(n(Re!=null),n(He!=null),He.Cb=mt(Re),He.Cb){if(He.Bb=mt(Re),mt(Re)){for(He.Fb=mt(Re),Xe=0;4>Xe;++Xe)He.Zb[Xe]=mt(Re)?st(Re,7):0;for(Xe=0;4>Xe;++Xe)He.Lb[Xe]=mt(Re)?st(Re,6):0}if(He.Bb)for(Xe=0;3>Xe;++Xe)tt.jb[Xe]=mt(Re)?ut(Re,8):255}else He.Bb=0;if(Re.Ka)return sn(I,3,"cannot parse segment header");if((He=I.ed).zd=mt(Re),He.Tb=ut(Re,6),He.wb=ut(Re,3),He.Pc=mt(Re),He.Pc&&mt(Re)){for(tt=0;4>tt;++tt)mt(Re)&&(He.vd[tt]=st(Re,6));for(tt=0;4>tt;++tt)mt(Re)&&(He.od[tt]=st(Re,6))}if(I.L=He.Tb==0?0:He.zd?1:2,Re.Ka)return sn(I,3,"cannot parse filter header");var St=Se;if(Se=Xe=ce,ce=Xe+St,He=St,I.Xb=(1<<ut(I.m,2))-1,St<3*(tt=I.Xb))Y=7;else{for(Xe+=3*tt,He-=3*tt,St=0;St<tt;++St){var rt=Y[Se+0]|Y[Se+1]<<8|Y[Se+2]<<16;rt>He&&(rt=He),Ye(I.Jc[+St],Y,Xe,rt),Xe+=rt,He-=rt,Se+=3}Ye(I.Jc[+tt],Y,Xe,He),Y=Xe<ce?0:5}if(Y!=0)return sn(I,Y,"cannot parse partitions");for(Y=ut(Xe=I.m,7),Se=mt(Xe)?st(Xe,4):0,ce=mt(Xe)?st(Xe,4):0,He=mt(Xe)?st(Xe,4):0,tt=mt(Xe)?st(Xe,4):0,Xe=mt(Xe)?st(Xe,4):0,St=I.Qa,rt=0;4>rt;++rt){if(St.Cb){var Vt=St.Zb[rt];St.Fb||(Vt+=Y)}else{if(0<rt){I.pb[rt]=I.pb[0];continue}Vt=Y}var Ft=I.pb[rt];Ft.Sc[0]=Su[us(Vt+Se,127)],Ft.Sc[1]=yc[us(Vt+0,127)],Ft.Eb[0]=2*Su[us(Vt+ce,127)],Ft.Eb[1]=101581*yc[us(Vt+He,127)]>>16,8>Ft.Eb[1]&&(Ft.Eb[1]=8),Ft.Qc[0]=Su[us(Vt+tt,117)],Ft.Qc[1]=yc[us(Vt+Xe,127)],Ft.lc=Vt+Xe}if(!ze.Rb)return sn(I,4,"Not a key frame.");for(mt(Re),ze=I.Pa,Y=0;4>Y;++Y){for(Se=0;8>Se;++Se)for(ce=0;3>ce;++ce)for(He=0;11>He;++He)tt=wt(Re,bc[Y][Se][ce][He])?ut(Re,8):Ba[Y][Se][ce][He],ze.Wc[Y][Se].Yb[ce][He]=tt;for(Se=0;17>Se;++Se)ze.Xc[Y][Se]=ze.Wc[Y][no[Se]]}return I.kc=mt(Re),I.kc&&(I.Bd=ut(Re,8)),I.cb=1}function Zh(I,L,Y,ce,Se,Re,ze){var He=L[Se].Yb[Y];for(Y=0;16>Se;++Se){if(!wt(I,He[Y+0]))return Se;for(;!wt(I,He[Y+1]);)if(He=L[++Se].Yb[0],Y=0,Se==16)return 16;var Xe=L[Se+1].Yb;if(wt(I,He[Y+2])){var tt=I,St=0;if(wt(tt,(Vt=He)[(rt=Y)+3]))if(wt(tt,Vt[rt+6])){for(He=0,rt=2*(St=wt(tt,Vt[rt+8]))+(Vt=wt(tt,Vt[rt+9+St])),St=0,Vt=Qo[rt];Vt[He];++He)St+=St+wt(tt,Vt[He]);St+=3+(8<<rt)}else wt(tt,Vt[rt+7])?(St=7+2*wt(tt,165),St+=wt(tt,145)):St=5+wt(tt,159);else St=wt(tt,Vt[rt+4])?3+wt(tt,Vt[rt+5]):2;He=Xe[2]}else St=1,He=Xe[1];Xe=ze+sm[Se],0>(tt=I).b&&gt(tt);var rt,Vt=tt.b,Ft=(rt=tt.Ca>>1)-(tt.I>>Vt)>>31;--tt.b,tt.Ca+=Ft,tt.Ca|=1,tt.I-=(rt+1&Ft)<<Vt,Re[Xe]=((St^Ft)-Ft)*ce[(0<Se)+0]}return 16}function nc(I){var L=I.rb[I.sb-1];L.la=0,L.Na=0,f(I.zc,0,0,I.zc.length),I.ja=0}function sr(I,L){if(I==null)return 0;if(L==null)return sn(I,2,"NULL VP8Io parameter in VP8Decode().");if(!I.cb&&!oh(I,L))return 0;if(n(I.cb),L.ac==null||L.ac(L)){L.ob&&(I.L=0);var Y=sd[I.L];if(I.L==2?(I.yb=0,I.zb=0):(I.yb=L.v-Y>>4,I.zb=L.j-Y>>4,0>I.yb&&(I.yb=0),0>I.zb&&(I.zb=0)),I.Va=L.o+15+Y>>4,I.Hb=L.va+15+Y>>4,I.Hb>I.za&&(I.Hb=I.za),I.Va>I.Ub&&(I.Va=I.Ub),0<I.L){var ce=I.ed;for(Y=0;4>Y;++Y){var Se;if(I.Qa.Cb){var Re=I.Qa.Lb[Y];I.Qa.Fb||(Re+=ce.Tb)}else Re=ce.Tb;for(Se=0;1>=Se;++Se){var ze=I.gd[Y][Se],He=Re;if(ce.Pc&&(He+=ce.vd[0],Se&&(He+=ce.od[0])),0<(He=0>He?0:63<He?63:He)){var Xe=He;0<ce.wb&&(Xe=4<ce.wb?Xe>>2:Xe>>1)>9-ce.wb&&(Xe=9-ce.wb),1>Xe&&(Xe=1),ze.dd=Xe,ze.tc=2*He+Xe,ze.ld=40<=He?2:15<=He?1:0}else ze.tc=0;ze.La=Se}}}Y=0}else sn(I,6,"Frame setup failed"),Y=I.a;if(Y=Y==0){if(Y){I.$c=0,0<I.Aa||(I.Ic=bl);e:{Y=I.Ic,ce=4*(Xe=I.za);var tt=32*Xe,St=Xe+1,rt=0<I.L?Xe*(0<I.Aa?2:1):0,Vt=(I.Aa==2?2:1)*Xe;if((ze=ce+832+(Se=3*(16*Y+sd[I.L])/2*tt)+(Re=I.Fa!=null&&0<I.Fa.length?I.Kc.c*I.Kc.i:0))!=ze)Y=0;else{if(ze>I.Vb){if(I.Vb=0,I.Ec=i(ze),I.Fc=0,I.Ec==null){Y=sn(I,1,"no memory during frame initialization.");break e}I.Vb=ze}ze=I.Ec,He=I.Fc,I.Ac=ze,I.Bc=He,He+=ce,I.Gd=x(tt,xn),I.Hd=0,I.rb=x(St+1,wi),I.sb=1,I.wa=rt?x(rt,Wi):null,I.Y=0,I.D.Nb=0,I.D.wa=I.wa,I.D.Y=I.Y,0<I.Aa&&(I.D.Y+=Xe),n(!0),I.oc=ze,I.pc=He,He+=832,I.ya=x(Vt,dr),I.aa=0,I.D.ya=I.ya,I.D.aa=I.aa,I.Aa==2&&(I.D.aa+=Xe),I.R=16*Xe,I.B=8*Xe,Xe=(tt=sd[I.L])*I.R,tt=tt/2*I.B,I.sa=ze,I.ta=He+Xe,I.qa=I.sa,I.ra=I.ta+16*Y*I.R+tt,I.Ha=I.qa,I.Ia=I.ra+8*Y*I.B+tt,I.$c=0,He+=Se,I.mb=Re?ze:null,I.nb=Re?He:null,n(He+Re<=I.Fc+I.Vb),nc(I),f(I.Ac,I.Bc,0,ce),Y=1}}if(Y){if(L.ka=0,L.y=I.sa,L.O=I.ta,L.f=I.qa,L.N=I.ra,L.ea=I.Ha,L.Vd=I.Ia,L.fa=I.R,L.Rc=I.B,L.F=null,L.J=0,!jr){for(Y=-255;255>=Y;++Y)rd[255+Y]=0>Y?-Y:Y;for(Y=-1020;1020>=Y;++Y)Yd[1020+Y]=-128>Y?-128:127<Y?127:Y;for(Y=-112;112>=Y;++Y)mh[112+Y]=-16>Y?-16:15<Y?15:Y;for(Y=-255;510>=Y;++Y)gh[255+Y]=0>Y?0:255<Y?255:Y;jr=1}Fs=Jh,Bl=Yh,gc=lh,xl=Kh,Zs=ch,ph=sh,Tu=_u,vl=uc,zl=zc,Ys=pl,yl=dh,Ps=Ol,_c=ss,Xn=fh,Vn=cc,na=eo,Ha=ya,hs=ep,Wa[0]=co,Wa[1]=Wd,Wa[2]=Qf,Wa[3]=ed,Wa[4]=hh,Wa[5]=Pl,Wa[6]=Nc,Wa[7]=Bc,Wa[8]=hi,Wa[9]=ac,Ul[0]=Qh,Ul[1]=uh,Ul[2]=qs,Ul[3]=mu,Ul[4]=Ua,Ul[5]=Cr,Ul[6]=qd,Os[0]=va,Os[1]=Oc,Os[2]=$d,Os[3]=oc,Os[4]=sc,Os[5]=Xd,Os[6]=lc,Y=1}else Y=0}Y&&(Y=function(Ft,xi){for(Ft.M=0;Ft.M<Ft.Va;++Ft.M){var ii,Et=Ft.Jc[Ft.M&Ft.Xb],It=Ft.m,ui=Ft;for(ii=0;ii<ui.za;++ii){var vi=It,gi=ui,qi=gi.Ac,Hi=gi.Bc+4*ii,Sr=gi.zc,Gi=gi.ya[gi.aa+ii];if(gi.Qa.Bb?Gi.$b=wt(vi,gi.Pa.jb[0])?2+wt(vi,gi.Pa.jb[2]):wt(vi,gi.Pa.jb[1]):Gi.$b=0,gi.kc&&(Gi.Ad=wt(vi,gi.Bd)),Gi.Za=!wt(vi,145)+0,Gi.Za){var An=Gi.Ob,Mn=0;for(gi=0;4>gi;++gi){var Jr,on=Sr[0+gi];for(Jr=0;4>Jr;++Jr){on=Ks[qi[Hi+Jr]][on];for(var Zn=Bo[wt(vi,on[0])];0<Zn;)Zn=Bo[2*Zn+wt(vi,on[Zn])];on=-Zn,qi[Hi+Jr]=on}c(An,Mn,qi,Hi,4),Mn+=4,Sr[0+gi]=on}}else on=wt(vi,156)?wt(vi,128)?1:3:wt(vi,163)?2:0,Gi.Ob[0]=on,f(qi,Hi,on,4),f(Sr,0,on,4);Gi.Dd=wt(vi,142)?wt(vi,114)?wt(vi,183)?1:3:2:0}if(ui.m.Ka)return sn(Ft,7,"Premature end-of-partition0 encountered.");for(;Ft.ja<Ft.za;++Ft.ja){if(ui=Et,vi=(It=Ft).rb[It.sb-1],qi=It.rb[It.sb+It.ja],ii=It.ya[It.aa+It.ja],Hi=It.kc?ii.Ad:0)vi.la=qi.la=0,ii.Za||(vi.Na=qi.Na=0),ii.Hc=0,ii.Gc=0,ii.ia=0;else{var Bn,Wr;if(vi=qi,qi=ui,Hi=It.Pa.Xc,Sr=It.ya[It.aa+It.ja],Gi=It.pb[Sr.$b],gi=Sr.ad,An=0,Mn=It.rb[It.sb-1],on=Jr=0,f(gi,An,0,384),Sr.Za)var Dn=0,zo=Hi[3];else{Zn=i(16);var ao=vi.Na+Mn.Na;if(ao=Ga(qi,Hi[1],ao,Gi.Eb,0,Zn,0),vi.Na=Mn.Na=(0<ao)+0,1<ao)Fs(Zn,0,gi,An);else{var yo=Zn[0]+3>>3;for(Zn=0;256>Zn;Zn+=16)gi[An+Zn]=yo}Dn=1,zo=Hi[0]}var yn=15&vi.la,fs=15&Mn.la;for(Zn=0;4>Zn;++Zn){var es=1&fs;for(yo=Wr=0;4>yo;++yo)yn=yn>>1|(es=(ao=Ga(qi,zo,ao=es+(1&yn),Gi.Sc,Dn,gi,An))>Dn)<<7,Wr=Wr<<2|(3<ao?3:1<ao?2:gi[An+0]!=0),An+=16;yn>>=4,fs=fs>>1|es<<7,Jr=(Jr<<8|Wr)>>>0}for(zo=yn,Dn=fs>>4,Bn=0;4>Bn;Bn+=2){for(Wr=0,yn=vi.la>>4+Bn,fs=Mn.la>>4+Bn,Zn=0;2>Zn;++Zn){for(es=1&fs,yo=0;2>yo;++yo)ao=es+(1&yn),yn=yn>>1|(es=0<(ao=Ga(qi,Hi[2],ao,Gi.Qc,0,gi,An)))<<3,Wr=Wr<<2|(3<ao?3:1<ao?2:gi[An+0]!=0),An+=16;yn>>=2,fs=fs>>1|es<<5}on|=Wr<<4*Bn,zo|=yn<<4<<Bn,Dn|=(240&fs)<<Bn}vi.la=zo,Mn.la=Dn,Sr.Hc=Jr,Sr.Gc=on,Sr.ia=43690&on?0:Gi.ia,Hi=!(Jr|on)}if(0<It.L&&(It.wa[It.Y+It.ja]=It.gd[ii.$b][ii.Za],It.wa[It.Y+It.ja].La|=!Hi),ui.Ka)return sn(Ft,7,"Premature end-of-file encountered.")}if(nc(Ft),It=xi,ui=1,ii=(Et=Ft).D,vi=0<Et.L&&Et.M>=Et.zb&&Et.M<=Et.Va,Et.Aa==0)e:{if(ii.M=Et.M,ii.uc=vi,Nl(Et,ii),ui=1,ii=(Wr=Et.D).Nb,vi=(on=sd[Et.L])*Et.R,qi=on/2*Et.B,Zn=16*ii*Et.R,yo=8*ii*Et.B,Hi=Et.sa,Sr=Et.ta-vi+Zn,Gi=Et.qa,gi=Et.ra-qi+yo,An=Et.Ha,Mn=Et.Ia-qi+yo,fs=(yn=Wr.M)==0,Jr=yn>=Et.Va-1,Et.Aa==2&&Nl(Et,Wr),Wr.uc)for(es=(ao=Et).D.M,n(ao.D.uc),Wr=ao.yb;Wr<ao.Hb;++Wr){Dn=Wr,zo=es;var qa=(uo=(ha=ao).D).Nb;Bn=ha.R;var uo=uo.wa[uo.Y+Dn],$a=ha.sa,Io=ha.ta+16*qa*Bn+16*Dn,ps=uo.dd,fn=uo.tc;if(fn!=0)if(n(3<=fn),ha.L==1)0<Dn&&na($a,Io,Bn,fn+4),uo.La&&hs($a,Io,Bn,fn),0<zo&&Vn($a,Io,Bn,fn+4),uo.La&&Ha($a,Io,Bn,fn);else{var jo=ha.B,Gl=ha.qa,Kc=ha.ra+8*qa*jo+8*Dn,Js=ha.Ha,ha=ha.Ia+8*qa*jo+8*Dn;qa=uo.ld,0<Dn&&(vl($a,Io,Bn,fn+4,ps,qa),Ys(Gl,Kc,Js,ha,jo,fn+4,ps,qa)),uo.La&&(Ps($a,Io,Bn,fn,ps,qa),Xn(Gl,Kc,Js,ha,jo,fn,ps,qa)),0<zo&&(Tu($a,Io,Bn,fn+4,ps,qa),zl(Gl,Kc,Js,ha,jo,fn+4,ps,qa)),uo.La&&(yl($a,Io,Bn,fn,ps,qa),_c(Gl,Kc,Js,ha,jo,fn,ps,qa))}}if(Et.ia&&alert("todo:DitherRow"),It.put!=null){if(Wr=16*yn,yn=16*(yn+1),fs?(It.y=Et.sa,It.O=Et.ta+Zn,It.f=Et.qa,It.N=Et.ra+yo,It.ea=Et.Ha,It.W=Et.Ia+yo):(Wr-=on,It.y=Hi,It.O=Sr,It.f=Gi,It.N=gi,It.ea=An,It.W=Mn),Jr||(yn-=on),yn>It.o&&(yn=It.o),It.F=null,It.J=null,Et.Fa!=null&&0<Et.Fa.length&&Wr<yn&&(It.J=dc(Et,It,Wr,yn-Wr),It.F=Et.mb,It.F==null&&It.F.length==0)){ui=sn(Et,3,"Could not decode alpha data.");break e}Wr<It.j&&(on=It.j-Wr,Wr=It.j,n(!(1&on)),It.O+=Et.R*on,It.N+=Et.B*(on>>1),It.W+=Et.B*(on>>1),It.F!=null&&(It.J+=It.width*on)),Wr<yn&&(It.O+=It.v,It.N+=It.v>>1,It.W+=It.v>>1,It.F!=null&&(It.J+=It.v),It.ka=Wr-It.j,It.U=It.va-It.v,It.T=yn-Wr,ui=It.put(It))}ii+1!=Et.Ic||Jr||(c(Et.sa,Et.ta-vi,Hi,Sr+16*Et.R,vi),c(Et.qa,Et.ra-qi,Gi,gi+8*Et.B,qi),c(Et.Ha,Et.Ia-qi,An,Mn+8*Et.B,qi))}if(!ui)return sn(Ft,6,"Output aborted.")}return 1}(I,L)),L.bc!=null&&L.bc(L),Y&=1}return Y?(I.cb=0,Y):0}function Cs(I,L,Y,ce,Se){Se=I[L+Y+32*ce]+(Se>>3),I[L+Y+32*ce]=-256&Se?0>Se?0:255:Se}function Is(I,L,Y,ce,Se,Re){Cs(I,L,0,Y,ce+Se),Cs(I,L,1,Y,ce+Re),Cs(I,L,2,Y,ce-Re),Cs(I,L,3,Y,ce-Se)}function Oo(I){return(20091*I>>16)+I}function fu(I,L,Y,ce){var Se,Re=0,ze=i(16);for(Se=0;4>Se;++Se){var He=I[L+0]+I[L+8],Xe=I[L+0]-I[L+8],tt=(35468*I[L+4]>>16)-Oo(I[L+12]),St=Oo(I[L+4])+(35468*I[L+12]>>16);ze[Re+0]=He+St,ze[Re+1]=Xe+tt,ze[Re+2]=Xe-tt,ze[Re+3]=He-St,Re+=4,L++}for(Se=Re=0;4>Se;++Se)He=(I=ze[Re+0]+4)+ze[Re+8],Xe=I-ze[Re+8],tt=(35468*ze[Re+4]>>16)-Oo(ze[Re+12]),Cs(Y,ce,0,0,He+(St=Oo(ze[Re+4])+(35468*ze[Re+12]>>16))),Cs(Y,ce,1,0,Xe+tt),Cs(Y,ce,2,0,Xe-tt),Cs(Y,ce,3,0,He-St),Re++,ce+=32}function sh(I,L,Y,ce){var Se=I[L+0]+4,Re=35468*I[L+4]>>16,ze=Oo(I[L+4]),He=35468*I[L+1]>>16;Is(Y,ce,0,Se+ze,I=Oo(I[L+1]),He),Is(Y,ce,1,Se+Re,I,He),Is(Y,ce,2,Se-Re,I,He),Is(Y,ce,3,Se-ze,I,He)}function Yh(I,L,Y,ce,Se){fu(I,L,Y,ce),Se&&fu(I,L+16,Y,ce+4)}function lh(I,L,Y,ce){Bl(I,L+0,Y,ce,1),Bl(I,L+32,Y,ce+128,1)}function Kh(I,L,Y,ce){var Se;for(I=I[L+0]+4,Se=0;4>Se;++Se)for(L=0;4>L;++L)Cs(Y,ce,L,Se,I)}function ch(I,L,Y,ce){I[L+0]&&xl(I,L+0,Y,ce),I[L+16]&&xl(I,L+16,Y,ce+4),I[L+32]&&xl(I,L+32,Y,ce+128),I[L+48]&&xl(I,L+48,Y,ce+128+4)}function Jh(I,L,Y,ce){var Se,Re=i(16);for(Se=0;4>Se;++Se){var ze=I[L+0+Se]+I[L+12+Se],He=I[L+4+Se]+I[L+8+Se],Xe=I[L+4+Se]-I[L+8+Se],tt=I[L+0+Se]-I[L+12+Se];Re[0+Se]=ze+He,Re[8+Se]=ze-He,Re[4+Se]=tt+Xe,Re[12+Se]=tt-Xe}for(Se=0;4>Se;++Se)ze=(I=Re[0+4*Se]+3)+Re[3+4*Se],He=Re[1+4*Se]+Re[2+4*Se],Xe=Re[1+4*Se]-Re[2+4*Se],tt=I-Re[3+4*Se],Y[ce+0]=ze+He>>3,Y[ce+16]=tt+Xe>>3,Y[ce+32]=ze-He>>3,Y[ce+48]=tt-Xe>>3,ce+=64}function pu(I,L,Y){var ce,Se=L-32,Re=ds,ze=255-I[Se-1];for(ce=0;ce<Y;++ce){var He,Xe=Re,tt=ze+I[L-1];for(He=0;He<Y;++He)I[L+He]=Xe[tt+I[Se+He]];L+=32}}function Wd(I,L){pu(I,L,4)}function Oc(I,L){pu(I,L,8)}function uh(I,L){pu(I,L,16)}function qs(I,L){var Y;for(Y=0;16>Y;++Y)c(I,L+32*Y,I,L-32,16)}function mu(I,L){var Y;for(Y=16;0<Y;--Y)f(I,L,I[L-1],16),L+=32}function gu(I,L,Y){var ce;for(ce=0;16>ce;++ce)f(L,Y+32*ce,I,16)}function Qh(I,L){var Y,ce=16;for(Y=0;16>Y;++Y)ce+=I[L-1+32*Y]+I[L+Y-32];gu(ce>>5,I,L)}function Ua(I,L){var Y,ce=8;for(Y=0;16>Y;++Y)ce+=I[L-1+32*Y];gu(ce>>4,I,L)}function Cr(I,L){var Y,ce=8;for(Y=0;16>Y;++Y)ce+=I[L+Y-32];gu(ce>>4,I,L)}function qd(I,L){gu(128,I,L)}function Nr(I,L,Y){return I+2*L+Y+2>>2}function Qf(I,L){var Y,ce=L-32;for(ce=new Uint8Array([Nr(I[ce-1],I[ce+0],I[ce+1]),Nr(I[ce+0],I[ce+1],I[ce+2]),Nr(I[ce+1],I[ce+2],I[ce+3]),Nr(I[ce+2],I[ce+3],I[ce+4])]),Y=0;4>Y;++Y)c(I,L+32*Y,ce,0,ce.length)}function ed(I,L){var Y=I[L-1],ce=I[L-1+32],Se=I[L-1+64],Re=I[L-1+96];Lt(I,L+0,16843009*Nr(I[L-1-32],Y,ce)),Lt(I,L+32,16843009*Nr(Y,ce,Se)),Lt(I,L+64,16843009*Nr(ce,Se,Re)),Lt(I,L+96,16843009*Nr(Se,Re,Re))}function co(I,L){var Y,ce=4;for(Y=0;4>Y;++Y)ce+=I[L+Y-32]+I[L-1+32*Y];for(ce>>=3,Y=0;4>Y;++Y)f(I,L+32*Y,ce,4)}function hh(I,L){var Y=I[L-1+0],ce=I[L-1+32],Se=I[L-1+64],Re=I[L-1-32],ze=I[L+0-32],He=I[L+1-32],Xe=I[L+2-32],tt=I[L+3-32];I[L+0+96]=Nr(ce,Se,I[L-1+96]),I[L+1+96]=I[L+0+64]=Nr(Y,ce,Se),I[L+2+96]=I[L+1+64]=I[L+0+32]=Nr(Re,Y,ce),I[L+3+96]=I[L+2+64]=I[L+1+32]=I[L+0+0]=Nr(ze,Re,Y),I[L+3+64]=I[L+2+32]=I[L+1+0]=Nr(He,ze,Re),I[L+3+32]=I[L+2+0]=Nr(Xe,He,ze),I[L+3+0]=Nr(tt,Xe,He)}function Nc(I,L){var Y=I[L+1-32],ce=I[L+2-32],Se=I[L+3-32],Re=I[L+4-32],ze=I[L+5-32],He=I[L+6-32],Xe=I[L+7-32];I[L+0+0]=Nr(I[L+0-32],Y,ce),I[L+1+0]=I[L+0+32]=Nr(Y,ce,Se),I[L+2+0]=I[L+1+32]=I[L+0+64]=Nr(ce,Se,Re),I[L+3+0]=I[L+2+32]=I[L+1+64]=I[L+0+96]=Nr(Se,Re,ze),I[L+3+32]=I[L+2+64]=I[L+1+96]=Nr(Re,ze,He),I[L+3+64]=I[L+2+96]=Nr(ze,He,Xe),I[L+3+96]=Nr(He,Xe,Xe)}function Pl(I,L){var Y=I[L-1+0],ce=I[L-1+32],Se=I[L-1+64],Re=I[L-1-32],ze=I[L+0-32],He=I[L+1-32],Xe=I[L+2-32],tt=I[L+3-32];I[L+0+0]=I[L+1+64]=Re+ze+1>>1,I[L+1+0]=I[L+2+64]=ze+He+1>>1,I[L+2+0]=I[L+3+64]=He+Xe+1>>1,I[L+3+0]=Xe+tt+1>>1,I[L+0+96]=Nr(Se,ce,Y),I[L+0+64]=Nr(ce,Y,Re),I[L+0+32]=I[L+1+96]=Nr(Y,Re,ze),I[L+1+32]=I[L+2+96]=Nr(Re,ze,He),I[L+2+32]=I[L+3+96]=Nr(ze,He,Xe),I[L+3+32]=Nr(He,Xe,tt)}function Bc(I,L){var Y=I[L+0-32],ce=I[L+1-32],Se=I[L+2-32],Re=I[L+3-32],ze=I[L+4-32],He=I[L+5-32],Xe=I[L+6-32],tt=I[L+7-32];I[L+0+0]=Y+ce+1>>1,I[L+1+0]=I[L+0+64]=ce+Se+1>>1,I[L+2+0]=I[L+1+64]=Se+Re+1>>1,I[L+3+0]=I[L+2+64]=Re+ze+1>>1,I[L+0+32]=Nr(Y,ce,Se),I[L+1+32]=I[L+0+96]=Nr(ce,Se,Re),I[L+2+32]=I[L+1+96]=Nr(Se,Re,ze),I[L+3+32]=I[L+2+96]=Nr(Re,ze,He),I[L+3+64]=Nr(ze,He,Xe),I[L+3+96]=Nr(He,Xe,tt)}function ac(I,L){var Y=I[L-1+0],ce=I[L-1+32],Se=I[L-1+64],Re=I[L-1+96];I[L+0+0]=Y+ce+1>>1,I[L+2+0]=I[L+0+32]=ce+Se+1>>1,I[L+2+32]=I[L+0+64]=Se+Re+1>>1,I[L+1+0]=Nr(Y,ce,Se),I[L+3+0]=I[L+1+32]=Nr(ce,Se,Re),I[L+3+32]=I[L+1+64]=Nr(Se,Re,Re),I[L+3+64]=I[L+2+64]=I[L+0+96]=I[L+1+96]=I[L+2+96]=I[L+3+96]=Re}function hi(I,L){var Y=I[L-1+0],ce=I[L-1+32],Se=I[L-1+64],Re=I[L-1+96],ze=I[L-1-32],He=I[L+0-32],Xe=I[L+1-32],tt=I[L+2-32];I[L+0+0]=I[L+2+32]=Y+ze+1>>1,I[L+0+32]=I[L+2+64]=ce+Y+1>>1,I[L+0+64]=I[L+2+96]=Se+ce+1>>1,I[L+0+96]=Re+Se+1>>1,I[L+3+0]=Nr(He,Xe,tt),I[L+2+0]=Nr(ze,He,Xe),I[L+1+0]=I[L+3+32]=Nr(Y,ze,He),I[L+1+32]=I[L+3+64]=Nr(ce,Y,ze),I[L+1+64]=I[L+3+96]=Nr(Se,ce,Y),I[L+1+96]=Nr(Re,Se,ce)}function $d(I,L){var Y;for(Y=0;8>Y;++Y)c(I,L+32*Y,I,L-32,8)}function oc(I,L){var Y;for(Y=0;8>Y;++Y)f(I,L,I[L-1],8),L+=32}function Tr(I,L,Y){var ce;for(ce=0;8>ce;++ce)f(L,Y+32*ce,I,8)}function va(I,L){var Y,ce=8;for(Y=0;8>Y;++Y)ce+=I[L+Y-32]+I[L-1+32*Y];Tr(ce>>4,I,L)}function Xd(I,L){var Y,ce=4;for(Y=0;8>Y;++Y)ce+=I[L+Y-32];Tr(ce>>3,I,L)}function sc(I,L){var Y,ce=4;for(Y=0;8>Y;++Y)ce+=I[L-1+32*Y];Tr(ce>>3,I,L)}function lc(I,L){Tr(128,I,L)}function dl(I,L,Y){var ce=I[L-Y],Se=I[L+0],Re=3*(Se-ce)+ip[1020+I[L-2*Y]-I[L+Y]],ze=$i[112+(Re+4>>3)];I[L-Y]=ds[255+ce+$i[112+(Re+3>>3)]],I[L+0]=ds[255+Se-ze]}function lr(I,L,Y,ce){var Se=I[L+0],Re=I[L+Y];return Ko[255+I[L-2*Y]-I[L-Y]]>ce||Ko[255+Re-Se]>ce}function Ll(I,L,Y,ce){return 4*Ko[255+I[L-Y]-I[L+0]]+Ko[255+I[L-2*Y]-I[L+Y]]<=ce}function Rl(I,L,Y,ce,Se){var Re=I[L-3*Y],ze=I[L-2*Y],He=I[L-Y],Xe=I[L+0],tt=I[L+Y],St=I[L+2*Y],rt=I[L+3*Y];return 4*Ko[255+He-Xe]+Ko[255+ze-tt]>ce?0:Ko[255+I[L-4*Y]-Re]<=Se&&Ko[255+Re-ze]<=Se&&Ko[255+ze-He]<=Se&&Ko[255+rt-St]<=Se&&Ko[255+St-tt]<=Se&&Ko[255+tt-Xe]<=Se}function cc(I,L,Y,ce){var Se=2*ce+1;for(ce=0;16>ce;++ce)Ll(I,L+ce,Y,Se)&&dl(I,L+ce,Y)}function eo(I,L,Y,ce){var Se=2*ce+1;for(ce=0;16>ce;++ce)Ll(I,L+ce*Y,1,Se)&&dl(I,L+ce*Y,1)}function ya(I,L,Y,ce){var Se;for(Se=3;0<Se;--Se)cc(I,L+=4*Y,Y,ce)}function ep(I,L,Y,ce){var Se;for(Se=3;0<Se;--Se)eo(I,L+=4,Y,ce)}function fl(I,L,Y,ce,Se,Re,ze,He){for(Re=2*Re+1;0<Se--;){if(Rl(I,L,Y,Re,ze))if(lr(I,L,Y,He))dl(I,L,Y);else{var Xe=I,tt=L,St=Y,rt=Xe[tt-2*St],Vt=Xe[tt-St],Ft=Xe[tt+0],xi=Xe[tt+St],ii=Xe[tt+2*St],Et=27*(ui=ip[1020+3*(Ft-Vt)+ip[1020+rt-xi]])+63>>7,It=18*ui+63>>7,ui=9*ui+63>>7;Xe[tt-3*St]=ds[255+Xe[tt-3*St]+ui],Xe[tt-2*St]=ds[255+rt+It],Xe[tt-St]=ds[255+Vt+Et],Xe[tt+0]=ds[255+Ft-Et],Xe[tt+St]=ds[255+xi-It],Xe[tt+2*St]=ds[255+ii-ui]}L+=ce}}function os(I,L,Y,ce,Se,Re,ze,He){for(Re=2*Re+1;0<Se--;){if(Rl(I,L,Y,Re,ze))if(lr(I,L,Y,He))dl(I,L,Y);else{var Xe=I,tt=L,St=Y,rt=Xe[tt-St],Vt=Xe[tt+0],Ft=Xe[tt+St],xi=$i[112+((ii=3*(Vt-rt))+4>>3)],ii=$i[112+(ii+3>>3)],Et=xi+1>>1;Xe[tt-2*St]=ds[255+Xe[tt-2*St]+Et],Xe[tt-St]=ds[255+rt+ii],Xe[tt+0]=ds[255+Vt-xi],Xe[tt+St]=ds[255+Ft-Et]}L+=ce}}function _u(I,L,Y,ce,Se,Re){fl(I,L,Y,1,16,ce,Se,Re)}function uc(I,L,Y,ce,Se,Re){fl(I,L,1,Y,16,ce,Se,Re)}function dh(I,L,Y,ce,Se,Re){var ze;for(ze=3;0<ze;--ze)os(I,L+=4*Y,Y,1,16,ce,Se,Re)}function Ol(I,L,Y,ce,Se,Re){var ze;for(ze=3;0<ze;--ze)os(I,L+=4,1,Y,16,ce,Se,Re)}function zc(I,L,Y,ce,Se,Re,ze,He){fl(I,L,Se,1,8,Re,ze,He),fl(Y,ce,Se,1,8,Re,ze,He)}function pl(I,L,Y,ce,Se,Re,ze,He){fl(I,L,1,Se,8,Re,ze,He),fl(Y,ce,1,Se,8,Re,ze,He)}function ss(I,L,Y,ce,Se,Re,ze,He){os(I,L+4*Se,Se,1,8,Re,ze,He),os(Y,ce+4*Se,Se,1,8,Re,ze,He)}function fh(I,L,Y,ce,Se,Re,ze,He){os(I,L+4,1,Se,8,Re,ze,He),os(Y,ce+4,1,Se,8,Re,ze,He)}function Nn(){this.ba=new Ja,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new vn,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ls(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function to(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function $s(){this.ua=0,this.Wa=new lt,this.vb=new lt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new Ce,this.yc=new xe}function io(){this.xb=this.a=0,this.l=new En,this.ca=new Ja,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new ie,this.Pb=0,this.wd=new ie,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new $s,this.ab=0,this.gc=x(4,to),this.Oc=0}function jc(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new En,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function hc(I,L,Y,ce,Se,Re,ze){for(I=I==null?0:I[L+0],L=0;L<ze;++L)Se[Re+L]=I+Y[ce+L]&255,I=Se[Re+L]}function Vc(I,L,Y,ce,Se,Re,ze){var He;if(I==null)hc(null,null,Y,ce,Se,Re,ze);else for(He=0;He<ze;++He)Se[Re+He]=I[L+He]+Y[ce+He]&255}function ks(I,L,Y,ce,Se,Re,ze){if(I==null)hc(null,null,Y,ce,Se,Re,ze);else{var He,Xe=I[L+0],tt=Xe,St=Xe;for(He=0;He<ze;++He)tt=St+(Xe=I[L+He])-tt,St=Y[ce+He]+(-256&tt?0>tt?0:255:tt)&255,tt=Xe,Se[Re+He]=St}}function dc(I,L,Y,ce){var Se=L.width,Re=L.o;if(n(I!=null&&L!=null),0>Y||0>=ce||Y+ce>Re)return null;if(!I.Cc){if(I.ga==null){var ze;if(I.ga=new jc,(ze=I.ga==null)||(ze=L.width*L.o,n(I.Gb.length==0),I.Gb=i(ze),I.Uc=0,I.Gb==null?ze=0:(I.mb=I.Gb,I.nb=I.Uc,I.rc=null,ze=1),ze=!ze),!ze){ze=I.ga;var He=I.Fa,Xe=I.P,tt=I.qc,St=I.mb,rt=I.nb,Vt=Xe+1,Ft=tt-1,xi=ze.l;if(n(He!=null&&St!=null&&L!=null),Zc[0]=null,Zc[1]=hc,Zc[2]=Vc,Zc[3]=ks,ze.ca=St,ze.tb=rt,ze.c=L.width,ze.i=L.height,n(0<ze.c&&0<ze.i),1>=tt)L=0;else if(ze.$a=He[Xe+0]>>0&3,ze.Z=He[Xe+0]>>2&3,ze.Lc=He[Xe+0]>>4&3,Xe=He[Xe+0]>>6&3,0>ze.$a||1<ze.$a||4<=ze.Z||1<ze.Lc||Xe)L=0;else if(xi.put=lo,xi.ac=kn,xi.bc=ka,xi.ma=ze,xi.width=L.width,xi.height=L.height,xi.Da=L.Da,xi.v=L.v,xi.va=L.va,xi.j=L.j,xi.o=L.o,ze.$a)e:{n(ze.$a==1),L=Ze();t:for(;;){if(L==null){L=0;break e}if(n(ze!=null),ze.mc=L,L.c=ze.c,L.i=ze.i,L.l=ze.l,L.l.ma=ze,L.l.width=ze.c,L.l.height=ze.i,L.a=0,pt(L.m,He,Vt,Ft),!ke(ze.c,ze.i,1,L,null)||(L.ab==1&&L.gc[0].hc==3&&G(L.s)?(ze.ic=1,He=L.c*L.i,L.Ta=null,L.Ua=0,L.V=i(He),L.Ba=0,L.V==null?(L.a=1,L=0):L=1):(ze.ic=0,L=We(L,ze.c)),!L))break t;L=1;break e}ze.mc=null,L=0}else L=Ft>=ze.c*ze.i;ze=!L}if(ze)return null;I.ga.Lc!=1?I.Ga=0:ce=Re-Y}n(I.ga!=null),n(Y+ce<=Re);e:{if(L=(He=I.ga).c,Re=He.l.o,He.$a==0){if(Vt=I.rc,Ft=I.Vc,xi=I.Fa,Xe=I.P+1+Y*L,tt=I.mb,St=I.nb+Y*L,n(Xe<=I.P+I.qc),He.Z!=0)for(n(Zc[He.Z]!=null),ze=0;ze<ce;++ze)Zc[He.Z](Vt,Ft,xi,Xe,tt,St,L),Vt=tt,Ft=St,St+=L,Xe+=L;else for(ze=0;ze<ce;++ze)c(tt,St,xi,Xe,L),Vt=tt,Ft=St,St+=L,Xe+=L;I.rc=Vt,I.Vc=Ft}else{if(n(He.mc!=null),L=Y+ce,n((ze=He.mc)!=null),n(L<=ze.i),ze.C>=L)L=1;else if(He.ic||Rt(),He.ic){He=ze.V,Vt=ze.Ba,Ft=ze.c;var ii=ze.i,Et=(xi=1,Xe=ze.$/Ft,tt=ze.$%Ft,St=ze.m,rt=ze.s,ze.$),It=Ft*ii,ui=Ft*L,vi=rt.wc,gi=Et<ui?$n(rt,tt,Xe):null;n(Et<=It),n(L<=ii),n(G(rt));t:for(;;){for(;!St.h&&Et<ui;){if(tt&vi||(gi=$n(rt,tt,Xe)),n(gi!=null),Ue(St),256>(ii=Va(gi.G[0],gi.H[0],St)))He[Vt+Et]=ii,++Et,++tt>=Ft&&(tt=0,++Xe<=L&&!(Xe%16)&&se(ze,Xe));else{if(!(280>ii)){xi=0;break t}ii=Ro(ii-256,St);var qi,Hi=Va(gi.G[4],gi.H[4],St);if(Ue(St),!(Et>=(Hi=Qa(Ft,Hi=Ro(Hi,St)))&&It-Et>=ii)){xi=0;break t}for(qi=0;qi<ii;++qi)He[Vt+Et+qi]=He[Vt+Et+qi-Hi];for(Et+=ii,tt+=ii;tt>=Ft;)tt-=Ft,++Xe<=L&&!(Xe%16)&&se(ze,Xe);Et<ui&&tt&vi&&(gi=$n(rt,tt,Xe))}n(St.h==pe(St))}se(ze,Xe>L?L:Xe);break t}!xi||St.h&&Et<It?(xi=0,ze.a=St.h?5:3):ze.$=Et,L=xi}else L=le(ze,ze.V,ze.Ba,ze.c,ze.i,L,nt);if(!L){ce=0;break e}}Y+ce>=Re&&(I.Cc=1),ce=1}if(!ce)return null;if(I.Cc&&((ce=I.ga)!=null&&(ce.mc=null),I.ga=null,0<I.Ga))return alert("todo:WebPDequantizeLevels"),null}return I.nb+Y*Se}function U(I,L,Y,ce,Se,Re){for(;0<Se--;){var ze,He=I,Xe=L+(Y?1:0),tt=I,St=L+(Y?0:3);for(ze=0;ze<ce;++ze){var rt=tt[St+4*ze];rt!=255&&(rt*=32897,He[Xe+4*ze+0]=He[Xe+4*ze+0]*rt>>23,He[Xe+4*ze+1]=He[Xe+4*ze+1]*rt>>23,He[Xe+4*ze+2]=He[Xe+4*ze+2]*rt>>23)}L+=Re}}function Ee(I,L,Y,ce,Se){for(;0<ce--;){var Re;for(Re=0;Re<Y;++Re){var ze=I[L+2*Re+0],He=15&(tt=I[L+2*Re+1]),Xe=4369*He,tt=(240&tt|tt>>4)*Xe>>16;I[L+2*Re+0]=(240&ze|ze>>4)*Xe>>16&240|(15&ze|ze<<4)*Xe>>16>>4&15,I[L+2*Re+1]=240&tt|He}L+=Se}}function ct(I,L,Y,ce,Se,Re,ze,He){var Xe,tt,St=255;for(tt=0;tt<Se;++tt){for(Xe=0;Xe<ce;++Xe){var rt=I[L+Xe];Re[ze+4*Xe]=rt,St&=rt}L+=Y,ze+=He}return St!=255}function vt(I,L,Y,ce,Se){var Re;for(Re=0;Re<Se;++Re)Y[ce+Re]=I[L+Re]>>8}function Rt(){Na=U,xc=Ee,jl=ct,tp=vt}function si(I,L,Y){ge[I]=function(ce,Se,Re,ze,He,Xe,tt,St,rt,Vt,Ft,xi,ii,Et,It,ui,vi){var gi,qi=vi-1>>1,Hi=He[Xe+0]|tt[St+0]<<16,Sr=rt[Vt+0]|Ft[xi+0]<<16;n(ce!=null);var Gi=3*Hi+Sr+131074>>2;for(L(ce[Se+0],255&Gi,Gi>>16,ii,Et),Re!=null&&(Gi=3*Sr+Hi+131074>>2,L(Re[ze+0],255&Gi,Gi>>16,It,ui)),gi=1;gi<=qi;++gi){var An=He[Xe+gi]|tt[St+gi]<<16,Mn=rt[Vt+gi]|Ft[xi+gi]<<16,Jr=Hi+An+Sr+Mn+524296,on=Jr+2*(An+Sr)>>3;Gi=on+Hi>>1,Hi=(Jr=Jr+2*(Hi+Mn)>>3)+An>>1,L(ce[Se+2*gi-1],255&Gi,Gi>>16,ii,Et+(2*gi-1)*Y),L(ce[Se+2*gi-0],255&Hi,Hi>>16,ii,Et+(2*gi-0)*Y),Re!=null&&(Gi=Jr+Sr>>1,Hi=on+Mn>>1,L(Re[ze+2*gi-1],255&Gi,Gi>>16,It,ui+(2*gi-1)*Y),L(Re[ze+2*gi+0],255&Hi,Hi>>16,It,ui+(2*gi+0)*Y)),Hi=An,Sr=Mn}1&vi||(Gi=3*Hi+Sr+131074>>2,L(ce[Se+vi-1],255&Gi,Gi>>16,ii,Et+(vi-1)*Y),Re!=null&&(Gi=3*Sr+Hi+131074>>2,L(Re[ze+vi-1],255&Gi,Gi>>16,It,ui+(vi-1)*Y)))}}function Mi(){za[_h]=lm,za[Ls]=Co,za[Kd]=cm,za[vc]=Jd,za[Ti]=wc,za[Br]=Qd,za[Vr]=k0,za[Ao]=Co,za[$c]=Jd,za[Fr]=wc,za[Rs]=Qd}function Zi(I){return I&~ap?0>I?0:255:I>>Eu}function cr(I,L){return Zi((19077*I>>8)+(26149*L>>8)-14234)}function Mr(I,L,Y){return Zi((19077*I>>8)-(6419*L>>8)-(13320*Y>>8)+8708)}function ur(I,L){return Zi((19077*I>>8)+(33050*L>>8)-17685)}function ln(I,L,Y,ce,Se){ce[Se+0]=cr(I,Y),ce[Se+1]=Mr(I,L,Y),ce[Se+2]=ur(I,L)}function ua(I,L,Y,ce,Se){ce[Se+0]=ur(I,L),ce[Se+1]=Mr(I,L,Y),ce[Se+2]=cr(I,Y)}function Ma(I,L,Y,ce,Se){var Re=Mr(I,L,Y);L=Re<<3&224|ur(I,L)>>3,ce[Se+0]=248&cr(I,Y)|Re>>5,ce[Se+1]=L}function Ra(I,L,Y,ce,Se){var Re=240&ur(I,L)|15;ce[Se+0]=240&cr(I,Y)|Mr(I,L,Y)>>4,ce[Se+1]=Re}function vo(I,L,Y,ce,Se){ce[Se+0]=255,ln(I,L,Y,ce,Se+1)}function ra(I,L,Y,ce,Se){ua(I,L,Y,ce,Se),ce[Se+3]=255}function cs(I,L,Y,ce,Se){ln(I,L,Y,ce,Se),ce[Se+3]=255}function us(I,L){return 0>I?0:I>L?L:I}function Ms(I,L,Y){ge[I]=function(ce,Se,Re,ze,He,Xe,tt,St,rt){for(var Vt=St+(-2&rt)*Y;St!=Vt;)L(ce[Se+0],Re[ze+0],He[Xe+0],tt,St),L(ce[Se+1],Re[ze+0],He[Xe+0],tt,St+Y),Se+=2,++ze,++Xe,St+=2*Y;1&rt&&L(ce[Se+0],Re[ze+0],He[Xe+0],tt,St)}}function xu(I,L,Y){return Y==0?I==0?L==0?6:5:L==0?4:0:Y}function Uc(I,L,Y,ce,Se){switch(I>>>30){case 3:Bl(L,Y,ce,Se,0);break;case 2:ph(L,Y,ce,Se);break;case 1:xl(L,Y,ce,Se)}}function Nl(I,L){var Y,ce,Se=L.M,Re=L.Nb,ze=I.oc,He=I.pc+40,Xe=I.oc,tt=I.pc+584,St=I.oc,rt=I.pc+600;for(Y=0;16>Y;++Y)ze[He+32*Y-1]=129;for(Y=0;8>Y;++Y)Xe[tt+32*Y-1]=129,St[rt+32*Y-1]=129;for(0<Se?ze[He-1-32]=Xe[tt-1-32]=St[rt-1-32]=129:(f(ze,He-32-1,127,21),f(Xe,tt-32-1,127,9),f(St,rt-32-1,127,9)),ce=0;ce<I.za;++ce){var Vt=L.ya[L.aa+ce];if(0<ce){for(Y=-1;16>Y;++Y)c(ze,He+32*Y-4,ze,He+32*Y+12,4);for(Y=-1;8>Y;++Y)c(Xe,tt+32*Y-4,Xe,tt+32*Y+4,4),c(St,rt+32*Y-4,St,rt+32*Y+4,4)}var Ft=I.Gd,xi=I.Hd+ce,ii=Vt.ad,Et=Vt.Hc;if(0<Se&&(c(ze,He-32,Ft[xi].y,0,16),c(Xe,tt-32,Ft[xi].f,0,8),c(St,rt-32,Ft[xi].ea,0,8)),Vt.Za){var It=ze,ui=He-32+16;for(0<Se&&(ce>=I.za-1?f(It,ui,Ft[xi].y[15],4):c(It,ui,Ft[xi+1].y,0,4)),Y=0;4>Y;Y++)It[ui+128+Y]=It[ui+256+Y]=It[ui+384+Y]=It[ui+0+Y];for(Y=0;16>Y;++Y,Et<<=2)It=ze,ui=He+Au[Y],Wa[Vt.Ob[Y]](It,ui),Uc(Et,ii,16*+Y,It,ui)}else if(It=xu(ce,Se,Vt.Ob[0]),Ul[It](ze,He),Et!=0)for(Y=0;16>Y;++Y,Et<<=2)Uc(Et,ii,16*+Y,ze,He+Au[Y]);for(Y=Vt.Gc,It=xu(ce,Se,Vt.Dd),Os[It](Xe,tt),Os[It](St,rt),Et=ii,It=Xe,ui=tt,255&(Vt=Y>>0)&&(170&Vt?gc(Et,256,It,ui):Zs(Et,256,It,ui)),Vt=St,Et=rt,255&(Y>>=8)&&(170&Y?gc(ii,320,Vt,Et):Zs(ii,320,Vt,Et)),Se<I.Ub-1&&(c(Ft[xi].y,0,ze,He+480,16),c(Ft[xi].f,0,Xe,tt+224,8),c(Ft[xi].ea,0,St,rt+224,8)),Y=8*Re*I.B,Ft=I.sa,xi=I.ta+16*ce+16*Re*I.R,ii=I.qa,Vt=I.ra+8*ce+Y,Et=I.Ha,It=I.Ia+8*ce+Y,Y=0;16>Y;++Y)c(Ft,xi+Y*I.R,ze,He+32*Y,16);for(Y=0;8>Y;++Y)c(ii,Vt+Y*I.B,Xe,tt+32*Y,8),c(Et,It+Y*I.B,St,rt+32*Y,8)}}function ml(I,L,Y,ce,Se,Re,ze,He,Xe){var tt=[0],St=[0],rt=0,Vt=Xe!=null?Xe.kd:0,Ft=Xe??new ls;if(I==null||12>Y)return 7;Ft.data=I,Ft.w=L,Ft.ha=Y,L=[L],Y=[Y],Ft.gb=[Ft.gb];e:{var xi=L,ii=Y,Et=Ft.gb;if(n(I!=null),n(ii!=null),n(Et!=null),Et[0]=0,12<=ii[0]&&!l(I,xi[0],"RIFF")){if(l(I,xi[0]+8,"WEBP")){Et=3;break e}var It=Fi(I,xi[0]+4);if(12>It||4294967286<It){Et=3;break e}if(Vt&&It>ii[0]-8){Et=7;break e}Et[0]=It,xi[0]+=12,ii[0]-=12}Et=0}if(Et!=0)return Et;for(It=0<Ft.gb[0],Y=Y[0];;){e:{var ui=I;ii=L,Et=Y;var vi=tt,gi=St,qi=xi=[0];if((Gi=rt=[rt])[0]=0,8>Et[0])Et=7;else{if(!l(ui,ii[0],"VP8X")){if(Fi(ui,ii[0]+4)!=10){Et=3;break e}if(18>Et[0]){Et=7;break e}var Hi=Fi(ui,ii[0]+8),Sr=1+yi(ui,ii[0]+12);if(2147483648<=Sr*(ui=1+yi(ui,ii[0]+15))){Et=3;break e}qi!=null&&(qi[0]=Hi),vi!=null&&(vi[0]=Sr),gi!=null&&(gi[0]=ui),ii[0]+=18,Et[0]-=18,Gi[0]=1}Et=0}}if(rt=rt[0],xi=xi[0],Et!=0)return Et;if(ii=!!(2&xi),!It&&rt)return 3;if(Re!=null&&(Re[0]=!!(16&xi)),ze!=null&&(ze[0]=ii),He!=null&&(He[0]=0),ze=tt[0],xi=St[0],rt&&ii&&Xe==null){Et=0;break}if(4>Y){Et=7;break}if(It&&rt||!It&&!rt&&!l(I,L[0],"ALPH")){Y=[Y],Ft.na=[Ft.na],Ft.P=[Ft.P],Ft.Sa=[Ft.Sa];e:{Hi=I,Et=L,It=Y;var Gi=Ft.gb;vi=Ft.na,gi=Ft.P,qi=Ft.Sa,Sr=22,n(Hi!=null),n(It!=null),ui=Et[0];var An=It[0];for(n(vi!=null),n(qi!=null),vi[0]=null,gi[0]=null,qi[0]=0;;){if(Et[0]=ui,It[0]=An,8>An){Et=7;break e}var Mn=Fi(Hi,ui+4);if(4294967286<Mn){Et=3;break e}var Jr=8+Mn+1&-2;if(Sr+=Jr,0<Gi&&Sr>Gi){Et=3;break e}if(!l(Hi,ui,"VP8 ")||!l(Hi,ui,"VP8L")){Et=0;break e}if(An[0]<Jr){Et=7;break e}l(Hi,ui,"ALPH")||(vi[0]=Hi,gi[0]=ui+8,qi[0]=Mn),ui+=Jr,An-=Jr}}if(Y=Y[0],Ft.na=Ft.na[0],Ft.P=Ft.P[0],Ft.Sa=Ft.Sa[0],Et!=0)break}Y=[Y],Ft.Ja=[Ft.Ja],Ft.xa=[Ft.xa];e:if(Gi=I,Et=L,It=Y,vi=Ft.gb[0],gi=Ft.Ja,qi=Ft.xa,Hi=Et[0],ui=!l(Gi,Hi,"VP8 "),Sr=!l(Gi,Hi,"VP8L"),n(Gi!=null),n(It!=null),n(gi!=null),n(qi!=null),8>It[0])Et=7;else{if(ui||Sr){if(Gi=Fi(Gi,Hi+4),12<=vi&&Gi>vi-12){Et=3;break e}if(Vt&&Gi>It[0]-8){Et=7;break e}gi[0]=Gi,Et[0]+=8,It[0]-=8,qi[0]=Sr}else qi[0]=5<=It[0]&&Gi[Hi+0]==47&&!(Gi[Hi+4]>>5),gi[0]=It[0];Et=0}if(Y=Y[0],Ft.Ja=Ft.Ja[0],Ft.xa=Ft.xa[0],L=L[0],Et!=0)break;if(4294967286<Ft.Ja)return 3;if(He==null||ii||(He[0]=Ft.xa?2:1),ze=[ze],xi=[xi],Ft.xa){if(5>Y){Et=7;break}He=ze,Vt=xi,ii=Re,I==null||5>Y?I=0:5<=Y&&I[L+0]==47&&!(I[L+4]>>5)?(It=[0],Gi=[0],vi=[0],pt(gi=new ie,I,L,Y),Ki(gi,It,Gi,vi)?(He!=null&&(He[0]=It[0]),Vt!=null&&(Vt[0]=Gi[0]),ii!=null&&(ii[0]=vi[0]),I=1):I=0):I=0}else{if(10>Y){Et=7;break}He=xi,I==null||10>Y||!Fl(I,L+3,Y-3)?I=0:(Vt=I[L+0]|I[L+1]<<8|I[L+2]<<16,ii=16383&(I[L+7]<<8|I[L+6]),I=16383&(I[L+9]<<8|I[L+8]),1&Vt||3<(Vt>>1&7)||!(Vt>>4&1)||Vt>>5>=Ft.Ja||!ii||!I?I=0:(ze&&(ze[0]=ii),He&&(He[0]=I),I=1))}if(!I||(ze=ze[0],xi=xi[0],rt&&(tt[0]!=ze||St[0]!=xi)))return 3;Xe!=null&&(Xe[0]=Ft,Xe.offset=L-Xe.w,n(4294967286>L-Xe.w),n(Xe.offset==Xe.ha-Y));break}return Et==0||Et==7&&rt&&Xe==null?(Re!=null&&(Re[0]|=Ft.na!=null&&0<Ft.na.length),ce!=null&&(ce[0]=ze),Se!=null&&(Se[0]=xi),0):Et}function vu(I,L,Y){var ce=L.width,Se=L.height,Re=0,ze=0,He=ce,Xe=Se;if(L.Da=I!=null&&0<I.Da,L.Da&&(He=I.cd,Xe=I.bd,Re=I.v,ze=I.j,11>Y||(Re&=-2,ze&=-2),0>Re||0>ze||0>=He||0>=Xe||Re+He>ce||ze+Xe>Se))return 0;if(L.v=Re,L.j=ze,L.va=Re+He,L.o=ze+Xe,L.U=He,L.T=Xe,L.da=I!=null&&0<I.da,L.da){if(!Bt(He,Xe,Y=[I.ib],Re=[I.hb]))return 0;L.ib=Y[0],L.hb=Re[0]}return L.ob=I!=null&&I.ob,L.Kb=I==null||!I.Sd,L.da&&(L.ob=L.ib<3*ce/4&&L.hb<3*Se/4,L.Kb=0),1}function yu(I){if(I==null)return 2;if(11>I.S){var L=I.f.RGBA;L.fb+=(I.height-1)*L.A,L.A=-L.A}else L=I.f.kb,I=I.height,L.O+=(I-1)*L.fa,L.fa=-L.fa,L.N+=(I-1>>1)*L.Ab,L.Ab=-L.Ab,L.W+=(I-1>>1)*L.Db,L.Db=-L.Db,L.F!=null&&(L.J+=(I-1)*L.lb,L.lb=-L.lb);return 0}function Hc(I,L,Y,ce){if(ce==null||0>=I||0>=L)return 2;if(Y!=null){if(Y.Da){var Se=Y.cd,Re=Y.bd,ze=-2&Y.v,He=-2&Y.j;if(0>ze||0>He||0>=Se||0>=Re||ze+Se>I||He+Re>L)return 2;I=Se,L=Re}if(Y.da){if(!Bt(I,L,Se=[Y.ib],Re=[Y.hb]))return 2;I=Se[0],L=Re[0]}}ce.width=I,ce.height=L;e:{var Xe=ce.width,tt=ce.height;if(I=ce.S,0>=Xe||0>=tt||!(I>=_h&&13>I))I=2;else{if(0>=ce.Rd&&ce.sd==null){ze=Re=Se=L=0;var St=(He=Xe*sp[I])*tt;if(11>I||(Re=(tt+1)/2*(L=(Xe+1)/2),I==12&&(ze=(Se=Xe)*tt)),(tt=i(St+2*Re+ze))==null){I=1;break e}ce.sd=tt,11>I?((Xe=ce.f.RGBA).eb=tt,Xe.fb=0,Xe.A=He,Xe.size=St):((Xe=ce.f.kb).y=tt,Xe.O=0,Xe.fa=He,Xe.Fd=St,Xe.f=tt,Xe.N=0+St,Xe.Ab=L,Xe.Cd=Re,Xe.ea=tt,Xe.W=0+St+Re,Xe.Db=L,Xe.Ed=Re,I==12&&(Xe.F=tt,Xe.J=0+St+2*Re),Xe.Tc=ze,Xe.lb=Se)}if(L=1,Se=ce.S,Re=ce.width,ze=ce.height,Se>=_h&&13>Se)if(11>Se)I=ce.f.RGBA,L&=(He=Math.abs(I.A))*(ze-1)+Re<=I.size,L&=He>=Re*sp[Se],L&=I.eb!=null;else{I=ce.f.kb,He=(Re+1)/2,St=(ze+1)/2,Xe=Math.abs(I.fa),tt=Math.abs(I.Ab);var rt=Math.abs(I.Db),Vt=Math.abs(I.lb),Ft=Vt*(ze-1)+Re;L&=Xe*(ze-1)+Re<=I.Fd,L&=tt*(St-1)+He<=I.Cd,L=(L&=rt*(St-1)+He<=I.Ed)&Xe>=Re&tt>=He&rt>=He,L&=I.y!=null,L&=I.f!=null,L&=I.ea!=null,Se==12&&(L&=Vt>=Re,L&=Ft<=I.Tc,L&=I.F!=null)}else L=0;I=L?0:2}}return I!=0||Y!=null&&Y.fd&&(I=yu(ce)),I}var Zo=64,fc=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Gc=24,pc=32,mc=8,ro=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ki("Predictor0","PredictorAdd0"),ge.Predictor0=function(){return 4278190080},ge.Predictor1=function(I){return I},ge.Predictor2=function(I,L,Y){return L[Y+0]},ge.Predictor3=function(I,L,Y){return L[Y+1]},ge.Predictor4=function(I,L,Y){return L[Y-1]},ge.Predictor5=function(I,L,Y){return Bi(Bi(I,L[Y+1]),L[Y+0])},ge.Predictor6=function(I,L,Y){return Bi(I,L[Y-1])},ge.Predictor7=function(I,L,Y){return Bi(I,L[Y+0])},ge.Predictor8=function(I,L,Y){return Bi(L[Y-1],L[Y+0])},ge.Predictor9=function(I,L,Y){return Bi(L[Y+0],L[Y+1])},ge.Predictor10=function(I,L,Y){return Bi(Bi(I,L[Y-1]),Bi(L[Y+0],L[Y+1]))},ge.Predictor11=function(I,L,Y){var ce=L[Y+0];return 0>=vr(ce>>24&255,I>>24&255,(L=L[Y-1])>>24&255)+vr(ce>>16&255,I>>16&255,L>>16&255)+vr(ce>>8&255,I>>8&255,L>>8&255)+vr(255&ce,255&I,255&L)?ce:I},ge.Predictor12=function(I,L,Y){var ce=L[Y+0];return(tr((I>>24&255)+(ce>>24&255)-((L=L[Y-1])>>24&255))<<24|tr((I>>16&255)+(ce>>16&255)-(L>>16&255))<<16|tr((I>>8&255)+(ce>>8&255)-(L>>8&255))<<8|tr((255&I)+(255&ce)-(255&L)))>>>0},ge.Predictor13=function(I,L,Y){var ce=L[Y-1];return(ar((I=Bi(I,L[Y+0]))>>24&255,ce>>24&255)<<24|ar(I>>16&255,ce>>16&255)<<16|ar(I>>8&255,ce>>8&255)<<8|ar(I>>0&255,ce>>0&255))>>>0};var Zd=ge.PredictorAdd0;ge.PredictorAdd1=kr,ki("Predictor2","PredictorAdd2"),ki("Predictor3","PredictorAdd3"),ki("Predictor4","PredictorAdd4"),ki("Predictor5","PredictorAdd5"),ki("Predictor6","PredictorAdd6"),ki("Predictor7","PredictorAdd7"),ki("Predictor8","PredictorAdd8"),ki("Predictor9","PredictorAdd9"),ki("Predictor10","PredictorAdd10"),ki("Predictor11","PredictorAdd11"),ki("Predictor12","PredictorAdd12"),ki("Predictor13","PredictorAdd13");var bu=ge.PredictorAdd2;Or("ColorIndexInverseTransform","MapARGB","32b",function(I){return I>>8&255},function(I){return I}),Or("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(I){return I},function(I){return I>>8&255});var Wc,Yo=ge.ColorIndexInverseTransform,Xs=ge.MapARGB,td=ge.VP8LColorIndexInverseTransformAlpha,id=ge.MapAlpha,qc=ge.VP8LPredictorsAdd=[];qc.length=16,(ge.VP8LPredictors=[]).length=16,(ge.VP8LPredictorsAdd_C=[]).length=16,(ge.VP8LPredictors_C=[]).length=16;var Oa,No,gl,_l,Ds,wu,Fs,Bl,ph,gc,xl,Zs,Tu,vl,zl,Ys,yl,Ps,_c,Xn,Vn,na,Ha,hs,Na,xc,jl,tp,rd=i(511),Yd=i(2041),mh=i(225),gh=i(767),jr=0,ip=Yd,$i=mh,ds=gh,Ko=rd,_h=0,Ls=1,Kd=2,vc=3,Ti=4,Br=5,Vr=6,Ao=7,$c=8,Fr=9,Rs=10,xh=[2,3,7],Vl=[3,3,11],Jo=[280,256,256,256,40],ba=[0,1,1,1,0],I0=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],nd=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],rp=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],vh=8,Su=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],yc=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ga=null,Qo=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],sm=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Bo=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Ba=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Ks=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],bc=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],no=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ul=[],Wa=[],Os=[],ad=1,Xc=2,Zc=[],za=[];si("UpsampleRgbLinePair",ln,3),si("UpsampleBgrLinePair",ua,3),si("UpsampleRgbaLinePair",cs,4),si("UpsampleBgraLinePair",ra,4),si("UpsampleArgbLinePair",vo,4),si("UpsampleRgba4444LinePair",Ra,2),si("UpsampleRgb565LinePair",Ma,2);var lm=ge.UpsampleRgbLinePair,cm=ge.UpsampleBgrLinePair,Co=ge.UpsampleRgbaLinePair,Jd=ge.UpsampleBgraLinePair,wc=ge.UpsampleArgbLinePair,Qd=ge.UpsampleRgba4444LinePair,k0=ge.UpsampleRgb565LinePair,ef=16,Yc=1<<ef-1,Hl=-227,np=482,Eu=6,ap=(256<<Eu)-1,Rr=0,Tc=i(256),um=i(256),M0=i(256),D0=i(256),od=i(np-Hl),tf=i(np-Hl);Ms("YuvToRgbRow",ln,3),Ms("YuvToBgrRow",ua,3),Ms("YuvToRgbaRow",cs,4),Ms("YuvToBgraRow",ra,4),Ms("YuvToArgbRow",vo,4),Ms("YuvToRgba4444Row",Ra,2),Ms("YuvToRgb565Row",Ma,2);var Au=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],sd=[0,2,8],op=[8,7,6,4,4,2,2,2,1,1,1,1],bl=1;this.WebPDecodeRGBA=function(I,L,Y,ce,Se){var Re=Ls,ze=new Nn,He=new Ja;ze.ba=He,He.S=Re,He.width=[He.width],He.height=[He.height];var Xe=He.width,tt=He.height,St=new xo;if(St==null||I==null)var rt=2;else n(St!=null),rt=ml(I,L,Y,St.width,St.height,St.Pd,St.Qd,St.format,null);if(rt!=0?Xe=0:(Xe!=null&&(Xe[0]=St.width[0]),tt!=null&&(tt[0]=St.height[0]),Xe=1),Xe){He.width=He.width[0],He.height=He.height[0],ce!=null&&(ce[0]=He.width),Se!=null&&(Se[0]=He.height);e:{if(ce=new En,(Se=new ls).data=I,Se.w=L,Se.ha=Y,Se.kd=1,L=[0],n(Se!=null),((I=ml(Se.data,Se.w,Se.ha,null,null,null,L,null,Se))==0||I==7)&&L[0]&&(I=4),(L=I)==0){if(n(ze!=null),ce.data=Se.data,ce.w=Se.w+Se.offset,ce.ha=Se.ha-Se.offset,ce.put=lo,ce.ac=kn,ce.bc=ka,ce.ma=ze,Se.xa){if((I=Ze())==null){ze=1;break e}if(function(Vt,Ft){var xi=[0],ii=[0],Et=[0];t:for(;;){if(Vt==null)return 0;if(Ft==null)return Vt.a=2,0;if(Vt.l=Ft,Vt.a=0,pt(Vt.m,Ft.data,Ft.w,Ft.ha),!Ki(Vt.m,xi,ii,Et)){Vt.a=3;break t}if(Vt.xb=Xc,Ft.width=xi[0],Ft.height=ii[0],!ke(xi[0],ii[0],1,Vt,null))break t;return 1}return n(Vt.a!=0),0}(I,ce)){if(ce=(L=Hc(ce.width,ce.height,ze.Oa,ze.ba))==0){t:{ce=I;i:for(;;){if(ce==null){ce=0;break t}if(n(ce.s.yc!=null),n(ce.s.Ya!=null),n(0<ce.s.Wb),n((Y=ce.l)!=null),n((Se=Y.ma)!=null),ce.xb!=0){if(ce.ca=Se.ba,ce.tb=Se.tb,n(ce.ca!=null),!vu(Se.Oa,Y,vc)){ce.a=2;break i}if(!We(ce,Y.width)||Y.da)break i;if((Y.da||$r(ce.ca.S))&&Rt(),11>ce.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ce.ca.f.kb.F!=null&&Rt()),ce.Pb&&0<ce.s.ua&&ce.s.vb.X==null&&!Pi(ce.s.vb,ce.s.Wa.Xa)){ce.a=1;break i}ce.xb=0}if(!le(ce,ce.V,ce.Ba,ce.c,ce.i,Y.o,z))break i;Se.Dc=ce.Ma,ce=1;break t}n(ce.a!=0),ce=0}ce=!ce}ce&&(L=I.a)}else L=I.a}else{if((I=new On)==null){ze=1;break e}if(I.Fa=Se.na,I.P=Se.P,I.qc=Se.Sa,oh(I,ce)){if((L=Hc(ce.width,ce.height,ze.Oa,ze.ba))==0){if(I.Aa=0,Y=ze.Oa,n((Se=I)!=null),Y!=null){if(0<(Xe=0>(Xe=Y.Md)?0:100<Xe?255:255*Xe/100)){for(tt=St=0;4>tt;++tt)12>(rt=Se.pb[tt]).lc&&(rt.ia=Xe*op[0>rt.lc?0:rt.lc]>>3),St|=rt.ia;St&&(alert("todo:VP8InitRandom"),Se.ia=1)}Se.Ga=Y.Id,100<Se.Ga?Se.Ga=100:0>Se.Ga&&(Se.Ga=0)}sr(I,ce)||(L=I.a)}}else L=I.a}L==0&&ze.Oa!=null&&ze.Oa.fd&&(L=yu(ze.ba))}ze=L}Re=ze!=0?null:11>Re?He.f.RGBA.eb:He.f.kb.y}else Re=null;return Re};var sp=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function M(ge,Ve){for(var Ae="",_e=0;_e<4;_e++)Ae+=String.fromCharCode(ge[Ve++]);return Ae}function F(ge,Ve){return(ge[Ve+0]<<0|ge[Ve+1]<<8|ge[Ve+2]<<16)>>>0}function W(ge,Ve){return(ge[Ve+0]<<0|ge[Ve+1]<<8|ge[Ve+2]<<16|ge[Ve+3]<<24)>>>0}new A;var V=[0],R=[0],te=[],H=new A,J=a,K=function(ge,Ve){var Ae={},_e=0,xe=!1,Qe=0,Ce=0;if(Ae.frames=[],!function(ye,pe,Ie,Ue){for(var gt=0;gt<Ue;gt++)if(ye[pe+gt]!=Ie.charCodeAt(gt))return!0;return!1}(ge,Ve,"RIFF",4)){var Ye,ut;for(W(ge,Ve+=4),Ve+=8;Ve<ge.length;){var st=M(ge,Ve),pt=W(ge,Ve+=4);Ve+=4;var Tt=pt+(1&pt);switch(st){case"VP8 ":case"VP8L":Ae.frames[_e]===void 0&&(Ae.frames[_e]={}),(ie=Ae.frames[_e]).src_off=xe?Ce:Ve-8,ie.src_size=Qe+pt+8,_e++,xe&&(xe=!1,Qe=0,Ce=0);break;case"VP8X":(ie=Ae.header={}).feature_flags=ge[Ve];var ht=Ve+4;ie.canvas_width=1+F(ge,ht),ht+=3,ie.canvas_height=1+F(ge,ht),ht+=3;break;case"ALPH":xe=!0,Qe=Tt+8,Ce=Ve-8;break;case"ANIM":(ie=Ae.header).bgcolor=W(ge,Ve),ht=Ve+4,ie.loop_count=(Ye=ge)[(ut=ht)+0]<<0|Ye[ut+1]<<8,ht+=2;break;case"ANMF":var Wt,ie;(ie=Ae.frames[_e]={}).offset_x=2*F(ge,Ve),Ve+=3,ie.offset_y=2*F(ge,Ve),Ve+=3,ie.width=1+F(ge,Ve),Ve+=3,ie.height=1+F(ge,Ve),Ve+=3,ie.duration=F(ge,Ve),Ve+=3,Wt=ge[Ve++],ie.dispose=1&Wt,ie.blend=Wt>>1&1}st!="ANMF"&&(Ve+=Tt)}return Ae}}(J,0);K.response=J,K.rgbaoutput=!0,K.dataurl=!1;var ne=K.header?K.header:null,de=K.frames?K.frames:null;if(ne){ne.loop_counter=ne.loop_count,V=[ne.canvas_height],R=[ne.canvas_width];for(var De=0;De<de.length&&de[De].blend!=0;De++);}var Fe=de[0],et=H.WebPDecodeRGBA(J,Fe.src_off,Fe.src_size,R,V);Fe.rgba=et,Fe.imgwidth=R[0],Fe.imgheight=V[0];for(var Te=0;Te<R[0]*V[0]*4;Te++)te[Te]=et[Te];return this.width=R,this.height=V,this.data=te,this}var Ia,zr,Pa,e_,P2,Qp,T4,w7,S4,Eo,z2,am,S0,Qr,Xf,rc,A4,qh,T7,S7,E7,Fo,Po,Lo,A7,C7,O2,zx,I7,k7,M7,D7,U4,M2,$h,H4,G4,nh,tm,im,rm,t_,ns,i_,nm,Ux,r_,Kf,n_,rr,F7,P7,q4,$4,N2,X4,L7,R7,I4,jx,D4,F4,D2,E0,Vx,P4,L4,R4,z7,ah,Jf,V7,U7,Xh,H7,B4,Z4,G7,W7,q7,$7,X7,Z7,Y7,Y4,K7,J7,Q7,ej,tj,j2,Gx=bS(()=>{"use strict";Ia=Fy(qD());b4();zr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();Pa={log:C2,warn:function(a){zr.console&&(typeof zr.console.warn=="function"?zr.console.warn.apply(zr.console,arguments):C2.call(null,arguments))},error:function(a){zr.console&&(typeof zr.console.error=="function"?zr.console.error.apply(zr.console,arguments):C2(a))}};Qp=zr.saveAs||((typeof window>"u"?"undefined":(0,Ia.default)(window))!=="object"||window!==zr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(a,n,l){var c=zr.URL||zr.webkitURL,f=document.createElement("a");n=n||a.name||"download",f.download=n,f.rel="noopener",typeof a=="string"?(f.href=a,f.origin!==location.origin?w4(f.href)?I2(a,n,l):Bx(f,f.target="_blank"):Bx(f)):(f.href=c.createObjectURL(a),setTimeout(function(){c.revokeObjectURL(f.href)},4e4),setTimeout(function(){Bx(f)},0))}:"msSaveOrOpenBlob"in navigator?function(a,n,l){if(n=n||a.name||"download",typeof a=="string")if(w4(a))I2(a,n,l);else{var c=document.createElement("a");c.href=a,c.target="_blank",setTimeout(function(){Bx(c)})}else navigator.msSaveOrOpenBlob(function(f,i){return i===void 0?i={autoBom:!1}:(0,Ia.default)(i)!=="object"&&(Pa.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(f.type)?new Blob(["\uFEFF",f],{type:f.type}):f}(a,l),n)}:function(a,n,l,c){if((c=c||open("","_blank"))&&(c.document.title=c.document.body.innerText="downloading..."),typeof a=="string")return I2(a,n,l);var f=a.type==="application/octet-stream",i=/constructor/i.test(zr.HTMLElement)||zr.safari,x=/CriOS\/[\d]+/.test(navigator.userAgent);if((x||f&&i)&&(typeof FileReader>"u"?"undefined":(0,Ia.default)(FileReader))==="object"){var T=new FileReader;T.onloadend=function(){var F=T.result;F=x?F:F.replace(/^data:[^;]*;/,"data:attachment/file;"),c?c.location.href=F:location=F,c=null},T.readAsDataURL(a)}else{var A=zr.URL||zr.webkitURL,M=A.createObjectURL(a);c?c.location=M:location.href=M,c=null,setTimeout(function(){A.revokeObjectURL(M)},4e4)}});e_=zr.atob.bind(zr),P2=zr.btoa.bind(zr);T4="0123456789abcdef".split("");w7=function(a){for(var n=0;n<a.length;n++)a[n]=y7(a[n]);return a.join("")}(j4("hello"))!="5d41402abc4b2a76b9719d911017c592";S4={print:4,modify:8,copy:16,"annot-forms":32};A0.prototype.lsbFirstWord=function(a){return String.fromCharCode(a>>0&255,a>>8&255,a>>16&255,a>>24&255)},A0.prototype.toHexString=function(a){return a.split("").map(function(n){return("0"+(255&n.charCodeAt(0)).toString(16)).slice(-2)}).join("")},A0.prototype.hexToBytes=function(a){for(var n=[],l=0;l<a.length;l+=2)n.push(String.fromCharCode(parseInt(a.substr(l,2),16)));return n.join("")},A0.prototype.processOwnerPassword=function(a,n){return R2(L2(n).substr(0,5),a)},A0.prototype.encryptor=function(a,n){var l=L2(this.encryptionKey+String.fromCharCode(255&a,a>>8&255,a>>16&255,255&n,n>>8&255)).substr(0,10);return function(c){return R2(l,c)}},a_.prototype.equals=function(a){var n,l="id,objectNumber,equals";if(!a||(0,Ia.default)(a)!==(0,Ia.default)(this))return!1;var c=0;for(n in this)if(!(l.indexOf(n)>=0)){if(this.hasOwnProperty(n)&&!a.hasOwnProperty(n)||this[n]!==a[n])return!1;c++}for(n in a)a.hasOwnProperty(n)&&l.indexOf(n)<0&&c--;return c===0},Lr.API={events:[]},Lr.version="2.5.1";Eo=Lr.API,z2=1,am=function(a){return a.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},S0=function(a){return a.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Qr=function(a){return a.toFixed(2)},Xf=function(a){return a.toFixed(5)};Eo.__acroform__={};rc=function(a,n){a.prototype=Object.create(n.prototype),a.prototype.constructor=a},A4=function(a){return a*z2},qh=function(a){var n=new H4,l=rr.internal.getHeight(a)||0,c=rr.internal.getWidth(a)||0;return n.BBox=[0,0,Number(Qr(c)),Number(Qr(l))],n},T7=Eo.__acroform__.setBit=function(a,n){if(a=a||0,n=n||0,isNaN(a)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return a|=1<<n},S7=Eo.__acroform__.clearBit=function(a,n){if(a=a||0,n=n||0,isNaN(a)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return a&=~(1<<n)},E7=Eo.__acroform__.getBit=function(a,n){if(isNaN(a)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return a&1<<n?1:0},Fo=Eo.__acroform__.getBitForPdf=function(a,n){if(isNaN(a)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return E7(a,n-1)},Po=Eo.__acroform__.setBitForPdf=function(a,n){if(isNaN(a)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return T7(a,n-1)},Lo=Eo.__acroform__.clearBitForPdf=function(a,n){if(isNaN(a)||isNaN(n))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return S7(a,n-1)},A7=Eo.__acroform__.calculateCoordinates=function(a,n){var l=n.internal.getHorizontalCoordinate,c=n.internal.getVerticalCoordinate,f=a[0],i=a[1],x=a[2],T=a[3],A={};return A.lowerLeft_X=l(f)||0,A.lowerLeft_Y=c(i+T)||0,A.upperRight_X=l(f+x)||0,A.upperRight_Y=c(i)||0,[Number(Qr(A.lowerLeft_X)),Number(Qr(A.lowerLeft_Y)),Number(Qr(A.upperRight_X)),Number(Qr(A.upperRight_Y))]},C7=function(a){if(a.appearanceStreamContent)return a.appearanceStreamContent;if(a.V||a.DV){var n=[],l=a._V||a.DV,c=O2(a,l),f=a.scope.internal.getFont(a.fontName,a.fontStyle).id;n.push("/Tx BMC"),n.push("q"),n.push("BT"),n.push(a.scope.__private__.encodeColorString(a.color)),n.push("/"+f+" "+Qr(c.fontSize)+" Tf"),n.push("1 0 0 1 0 0 Tm"),n.push(c.text),n.push("ET"),n.push("Q"),n.push("EMC");var i=qh(a);return i.scope=a.scope,i.stream=n.join(`
`),i}},O2=function(a,n){var l=a.fontSize===0?a.maxFontSize:a.fontSize,c={text:"",fontSize:""},f=(n=(n=n.substr(0,1)=="("?n.substr(1):n).substr(n.length-1)==")"?n.substr(0,n.length-1):n).split(" ");f=a.multiline?f.map(function(_e){return _e.split(`
`)}):f.map(function(_e){return[_e]});var i=l,x=rr.internal.getHeight(a)||0;x=x<0?-x:x;var T=rr.internal.getWidth(a)||0;T=T<0?-T:T;var A=function(_e,xe,Qe){if(_e+1<f.length){var Ce=xe+" "+f[_e+1][0];return zx(Ce,a,Qe).width<=T-4}return!1};i++;e:for(;i>0;){n="",i--;var M,F,W=zx("3",a,i).height,V=a.multiline?x-i:(x-W)/2,R=V+=2,te=0,H=0,J=0;if(i<=0){n=`(...) Tj
`,n+="% Width of Text: "+zx(n,a,i=12).width+", FieldWidth:"+T+`
`;break}for(var K="",ne=0,de=0;de<f.length;de++)if(f.hasOwnProperty(de)){var De=!1;if(f[de].length!==1&&J!==f[de].length-1){if((W+2)*(ne+2)+2>x)continue e;K+=f[de][J],De=!0,H=de,de--}else{K=(K+=f[de][J]+" ").substr(K.length-1)==" "?K.substr(0,K.length-1):K;var Fe=parseInt(de),et=A(Fe,K,i),Te=de>=f.length-1;if(et&&!Te){K+=" ",J=0;continue}if(et||Te){if(Te)H=Fe;else if(a.multiline&&(W+2)*(ne+2)+2>x)continue e}else{if(!a.multiline||(W+2)*(ne+2)+2>x)continue e;H=Fe}}for(var ge="",Ve=te;Ve<=H;Ve++){var Ae=f[Ve];if(a.multiline){if(Ve===H){ge+=Ae[J]+" ",J=(J+1)%Ae.length;continue}if(Ve===te){ge+=Ae[Ae.length-1]+" ";continue}}ge+=Ae[0]+" "}switch(ge=ge.substr(ge.length-1)==" "?ge.substr(0,ge.length-1):ge,F=zx(ge,a,i).width,a.textAlign){case"right":M=T-F-2;break;case"center":M=(T-F)/2;break;case"left":default:M=2}n+=Qr(M)+" "+Qr(R)+` Td
`,n+="("+am(ge)+`) Tj
`,n+=-Qr(M)+` 0 Td
`,R=-(i+2),F=0,te=De?H:H+1,ne++,K=""}break}return c.text=n,c.fontSize=i,c},zx=function(a,n,l){var c=n.scope.internal.getFont(n.fontName,n.fontStyle),f=n.scope.getStringUnitWidth(a,{font:c,fontSize:parseFloat(l),charSpace:0})*parseFloat(l);return{height:n.scope.getStringUnitWidth("3",{font:c,fontSize:parseFloat(l),charSpace:0})*parseFloat(l)*1.5,width:f}},I7={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},k7=function(a,n){var l={type:"reference",object:a};n.internal.getPageInfo(a.page).pageContext.annotations.find(function(c){return c.type===l.type&&c.object===l.object})===void 0&&n.internal.getPageInfo(a.page).pageContext.annotations.push(l)},M7=function(a,n){for(var l in a)if(a.hasOwnProperty(l)){var c=l,f=a[l];n.internal.newObjectDeferredBegin(f.objId,!0),(0,Ia.default)(f)==="object"&&typeof f.putStream=="function"&&f.putStream(),delete a[c]}},D7=function(a,n){if(n.scope=a,a.internal!==void 0&&(a.internal.acroformPlugin===void 0||a.internal.acroformPlugin.isInitialized===!1)){if(nh.FieldNum=0,a.internal.acroformPlugin=JSON.parse(JSON.stringify(I7)),a.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");z2=a.internal.scaleFactor,a.internal.acroformPlugin.acroFormDictionaryRoot=new G4,a.internal.acroformPlugin.acroFormDictionaryRoot.scope=a,a.internal.acroformPlugin.acroFormDictionaryRoot._eventID=a.internal.events.subscribe("postPutResources",function(){(function(l){l.internal.events.unsubscribe(l.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete l.internal.acroformPlugin.acroFormDictionaryRoot._eventID,l.internal.acroformPlugin.printedOut=!0})(a)}),a.internal.events.subscribe("buildDocument",function(){(function(l){l.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var c=l.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var f in c)if(c.hasOwnProperty(f)){var i=c[f];i.objId=void 0,i.hasAnnotation&&k7(i,l)}})(a)}),a.internal.events.subscribe("putCatalog",function(){(function(l){if(l.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");l.internal.write("/AcroForm "+l.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(a)}),a.internal.events.subscribe("postPutPages",function(l){(function(c,f){var i=!c;for(var x in c||(f.internal.newObjectDeferredBegin(f.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),f.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),c=c||f.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(c.hasOwnProperty(x)){var T=c[x],A=[],M=T.Rect;if(T.Rect&&(T.Rect=A7(T.Rect,f)),f.internal.newObjectDeferredBegin(T.objId,!0),T.DA=rr.createDefaultAppearanceStream(T),(0,Ia.default)(T)==="object"&&typeof T.getKeyValueListForStream=="function"&&(A=T.getKeyValueListForStream()),T.Rect=M,T.hasAppearanceStream&&!T.appearanceStreamContent){var F=C7(T);A.push({key:"AP",value:"<</N "+F+">>"}),f.internal.acroformPlugin.xForms.push(F)}if(T.appearanceStreamContent){var W="";for(var V in T.appearanceStreamContent)if(T.appearanceStreamContent.hasOwnProperty(V)){var R=T.appearanceStreamContent[V];if(W+="/"+V+" ",W+="<<",Object.keys(R).length>=1||Array.isArray(R)){for(var x in R)if(R.hasOwnProperty(x)){var te=R[x];typeof te=="function"&&(te=te.call(f,T)),W+="/"+x+" "+te+" ",f.internal.acroformPlugin.xForms.indexOf(te)>=0||f.internal.acroformPlugin.xForms.push(te)}}else typeof(te=R)=="function"&&(te=te.call(f,T)),W+="/"+x+" "+te,f.internal.acroformPlugin.xForms.indexOf(te)>=0||f.internal.acroformPlugin.xForms.push(te);W+=">>"}A.push({key:"AP",value:`<<
`+W+">>"})}f.internal.putStream({additionalKeyValues:A,objectId:T.objId}),f.internal.out("endobj")}i&&M7(f.internal.acroformPlugin.xForms,f)})(l,a)}),a.internal.acroformPlugin.isInitialized=!0}},U4=Eo.__acroform__.arrayToPdfArray=function(a,n,l){var c=function(x){return x};if(Array.isArray(a)){for(var f="[",i=0;i<a.length;i++)switch(i!==0&&(f+=" "),(0,Ia.default)(a[i])){case"boolean":case"number":case"object":f+=a[i].toString();break;case"string":a[i].substr(0,1)!=="/"?(n!==void 0&&l&&(c=l.internal.getEncryptor(n)),f+="("+am(c(a[i].toString()))+")"):f+=a[i].toString()}return f+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},M2=function(a,n,l){var c=function(f){return f};return n!==void 0&&l&&(c=l.internal.getEncryptor(n)),(a=a||"").toString(),a="("+am(c(a))+")"},$h=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(a){this._objId=a}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};$h.prototype.toString=function(){return this.objId+" 0 R"},$h.prototype.putStream=function(){var a=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:a,objectId:this.objId}),this.scope.internal.out("endobj")},$h.prototype.getKeyValueListForStream=function(){var a=[],n=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var l in n)if(Object.getOwnPropertyDescriptor(this,n[l]).configurable===!1){var c=n[l],f=this[c];f&&(Array.isArray(f)?a.push({key:c,value:U4(f,this.objId,this.scope)}):f instanceof $h?(f.scope=this.scope,a.push({key:c,value:f.objId+" 0 R"})):typeof f!="function"&&a.push({key:c,value:f}))}return a};H4=function(){$h.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var a,n=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return n},set:function(l){n=l}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(l){a=l.trim()},get:function(){return a||null}})};rc(H4,$h);G4=function(){$h.call(this);var a,n=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return n.length>0?n:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return n}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(a){var l=function(c){return c};return this.scope&&(l=this.scope.internal.getEncryptor(this.objId)),"("+am(l(a))+")"}},set:function(l){a=l}})};rc(G4,$h);nh=function a(){$h.call(this);var n=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return n},set:function(K){if(isNaN(K))throw new Error('Invalid value "'+K+'" for attribute F supplied.');n=K}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Fo(n,3)},set:function(K){K?this.F=Po(n,3):this.F=Lo(n,3)}});var l=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return l},set:function(K){if(isNaN(K))throw new Error('Invalid value "'+K+'" for attribute Ff supplied.');l=K}});var c=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(c.length!==0)return c},set:function(K){c=K!==void 0?K:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!c||isNaN(c[0])?0:c[0]},set:function(K){c[0]=K}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!c||isNaN(c[1])?0:c[1]},set:function(K){c[1]=K}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!c||isNaN(c[2])?0:c[2]},set:function(K){c[2]=K}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!c||isNaN(c[3])?0:c[3]},set:function(K){c[3]=K}});var f="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return f},set:function(K){switch(K){case"/Btn":case"/Tx":case"/Ch":case"/Sig":f=K;break;default:throw new Error('Invalid value "'+K+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof Ux)return;i="FieldObject"+a.FieldNum++}var K=function(ne){return ne};return this.scope&&(K=this.scope.internal.getEncryptor(this.objId)),"("+am(K(i))+")"},set:function(K){i=K.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(K){i=K}});var x="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return x},set:function(K){x=K}});var T="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return T},set:function(K){T=K}});var A=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return A},set:function(K){A=K}});var M=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return M===void 0?50/z2:M},set:function(K){M=K}});var F="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return F},set:function(K){F=K}});var W="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!W||this instanceof Ux||this instanceof Kf))return M2(W,this.objId,this.scope)},set:function(K){K=K.toString(),W=K}});var V=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(V)return this instanceof ns?V:M2(V,this.objId,this.scope)},set:function(K){K=K.toString(),V=this instanceof ns?K:K.substr(0,1)==="("?S0(K.substr(1,K.length-2)):S0(K)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ns?S0(V.substr(1,V.length-1)):V},set:function(K){K=K.toString(),V=this instanceof ns?"/"+K:K}});var R=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(R)return R},set:function(K){this.V=K}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(R)return this instanceof ns?R:M2(R,this.objId,this.scope)},set:function(K){K=K.toString(),R=this instanceof ns?K:K.substr(0,1)==="("?S0(K.substr(1,K.length-2)):S0(K)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ns?S0(R.substr(1,R.length-1)):R},set:function(K){K=K.toString(),R=this instanceof ns?"/"+K:K}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var te,H=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return H},set:function(K){K=!!K,H=K}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(te)return te},set:function(K){te=K}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Fo(this.Ff,1)},set:function(K){K?this.Ff=Po(this.Ff,1):this.Ff=Lo(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Fo(this.Ff,2)},set:function(K){K?this.Ff=Po(this.Ff,2):this.Ff=Lo(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Fo(this.Ff,3)},set:function(K){K?this.Ff=Po(this.Ff,3):this.Ff=Lo(this.Ff,3)}});var J=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(J!==null)return J},set:function(K){if([0,1,2].indexOf(K)===-1)throw new Error('Invalid value "'+K+'" for attribute Q supplied.');J=K}}),Object.defineProperty(this,"textAlign",{get:function(){var K;switch(J){case 0:default:K="left";break;case 1:K="center";break;case 2:K="right"}return K},configurable:!0,enumerable:!0,set:function(K){switch(K){case"right":case 2:J=2;break;case"center":case 1:J=1;break;case"left":case 0:default:J=0}}})};rc(nh,$h);tm=function(){nh.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var a=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return a},set:function(l){a=l}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return a},set:function(l){a=l}});var n=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return U4(n,this.objId,this.scope)},set:function(l){var c,f;f=[],typeof(c=l)=="string"&&(f=function(i,x,T){T||(T=1);for(var A,M=[];A=x.exec(i);)M.push(A[T]);return M}(c,/\((.*?)\)/g)),n=f}}),this.getOptions=function(){return n},this.setOptions=function(l){n=l,this.sort&&n.sort()},this.addOption=function(l){l=(l=l||"").toString(),n.push(l),this.sort&&n.sort()},this.removeOption=function(l,c){for(c=c||!1,l=(l=l||"").toString();n.indexOf(l)!==-1&&(n.splice(n.indexOf(l),1),c!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Fo(this.Ff,18)},set:function(l){l?this.Ff=Po(this.Ff,18):this.Ff=Lo(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Fo(this.Ff,19)},set:function(l){this.combo===!0&&(l?this.Ff=Po(this.Ff,19):this.Ff=Lo(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Fo(this.Ff,20)},set:function(l){l?(this.Ff=Po(this.Ff,20),n.sort()):this.Ff=Lo(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Fo(this.Ff,22)},set:function(l){l?this.Ff=Po(this.Ff,22):this.Ff=Lo(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Fo(this.Ff,23)},set:function(l){l?this.Ff=Po(this.Ff,23):this.Ff=Lo(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Fo(this.Ff,27)},set:function(l){l?this.Ff=Po(this.Ff,27):this.Ff=Lo(this.Ff,27)}}),this.hasAppearanceStream=!1};rc(tm,nh);im=function(){tm.call(this),this.fontName="helvetica",this.combo=!1};rc(im,tm);rm=function(){im.call(this),this.combo=!0};rc(rm,im);t_=function(){rm.call(this),this.edit=!0};rc(t_,rm);ns=function(){nh.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Fo(this.Ff,15)},set:function(l){l?this.Ff=Po(this.Ff,15):this.Ff=Lo(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Fo(this.Ff,16)},set:function(l){l?this.Ff=Po(this.Ff,16):this.Ff=Lo(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Fo(this.Ff,17)},set:function(l){l?this.Ff=Po(this.Ff,17):this.Ff=Lo(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Fo(this.Ff,26)},set:function(l){l?this.Ff=Po(this.Ff,26):this.Ff=Lo(this.Ff,26)}});var a,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var l=function(i){return i};if(this.scope&&(l=this.scope.internal.getEncryptor(this.objId)),Object.keys(n).length!==0){var c,f=[];for(c in f.push("<<"),n)f.push("/"+c+" ("+am(l(n[c]))+")");return f.push(">>"),f.join(`
`)}},set:function(l){(0,Ia.default)(l)==="object"&&(n=l)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(l){typeof l=="string"&&(n.CA=l)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return a},set:function(l){a=l}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return a.substr(1,a.length-1)},set:function(l){a="/"+l}})};rc(ns,nh);i_=function(){ns.call(this),this.pushButton=!0};rc(i_,ns);nm=function(){ns.call(this),this.radio=!0,this.pushButton=!1;var a=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return a},set:function(n){a=n!==void 0?n:[]}})};rc(nm,ns);Ux=function(){var a,n;nh.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return a},set:function(f){a=f}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return n},set:function(f){n=f}});var l,c={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var f=function(T){return T};this.scope&&(f=this.scope.internal.getEncryptor(this.objId));var i,x=[];for(i in x.push("<<"),c)x.push("/"+i+" ("+am(f(c[i]))+")");return x.push(">>"),x.join(`
`)},set:function(f){(0,Ia.default)(f)==="object"&&(c=f)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return c.CA||""},set:function(f){typeof f=="string"&&(c.CA=f)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return l},set:function(f){l=f}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return l.substr(1,l.length-1)},set:function(f){l="/"+f}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=rr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};rc(Ux,nh),nm.prototype.setAppearance=function(a){if(!("createAppearanceStream"in a)||!("getCA"in a))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var n in this.Kids)if(this.Kids.hasOwnProperty(n)){var l=this.Kids[n];l.appearanceStreamContent=a.createAppearanceStream(l.optionName),l.caption=a.getCA()}},nm.prototype.createOption=function(a){var n=new Ux;return n.Parent=this,n.optionName=a,this.Kids.push(n),F7.call(this.scope,n),n};r_=function(){ns.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=rr.CheckBox.createAppearanceStream()};rc(r_,ns);Kf=function(){nh.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Fo(this.Ff,13)},set:function(n){n?this.Ff=Po(this.Ff,13):this.Ff=Lo(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Fo(this.Ff,21)},set:function(n){n?this.Ff=Po(this.Ff,21):this.Ff=Lo(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Fo(this.Ff,23)},set:function(n){n?this.Ff=Po(this.Ff,23):this.Ff=Lo(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Fo(this.Ff,24)},set:function(n){n?this.Ff=Po(this.Ff,24):this.Ff=Lo(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Fo(this.Ff,25)},set:function(n){n?this.Ff=Po(this.Ff,25):this.Ff=Lo(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Fo(this.Ff,26)},set:function(n){n?this.Ff=Po(this.Ff,26):this.Ff=Lo(this.Ff,26)}});var a=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return a},set:function(n){a=n}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return a},set:function(n){Number.isInteger(n)&&(a=n)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};rc(Kf,nh);n_=function(){Kf.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Fo(this.Ff,14)},set:function(a){a?this.Ff=Po(this.Ff,14):this.Ff=Lo(this.Ff,14)}}),this.password=!0};rc(n_,Kf);rr={CheckBox:{createAppearanceStream:function(){return{N:{On:rr.CheckBox.YesNormal},D:{On:rr.CheckBox.YesPushDown,Off:rr.CheckBox.OffPushDown}}},YesPushDown:function(a){var n=qh(a);n.scope=a.scope;var l=[],c=a.scope.internal.getFont(a.fontName,a.fontStyle).id,f=a.scope.__private__.encodeColorString(a.color),i=O2(a,a.caption);return l.push("0.749023 g"),l.push("0 0 "+Qr(rr.internal.getWidth(a))+" "+Qr(rr.internal.getHeight(a))+" re"),l.push("f"),l.push("BMC"),l.push("q"),l.push("0 0 1 rg"),l.push("/"+c+" "+Qr(i.fontSize)+" Tf "+f),l.push("BT"),l.push(i.text),l.push("ET"),l.push("Q"),l.push("EMC"),n.stream=l.join(`
`),n},YesNormal:function(a){var n=qh(a);n.scope=a.scope;var l=a.scope.internal.getFont(a.fontName,a.fontStyle).id,c=a.scope.__private__.encodeColorString(a.color),f=[],i=rr.internal.getHeight(a),x=rr.internal.getWidth(a),T=O2(a,a.caption);return f.push("1 g"),f.push("0 0 "+Qr(x)+" "+Qr(i)+" re"),f.push("f"),f.push("q"),f.push("0 0 1 rg"),f.push("0 0 "+Qr(x-1)+" "+Qr(i-1)+" re"),f.push("W"),f.push("n"),f.push("0 g"),f.push("BT"),f.push("/"+l+" "+Qr(T.fontSize)+" Tf "+c),f.push(T.text),f.push("ET"),f.push("Q"),n.stream=f.join(`
`),n},OffPushDown:function(a){var n=qh(a);n.scope=a.scope;var l=[];return l.push("0.749023 g"),l.push("0 0 "+Qr(rr.internal.getWidth(a))+" "+Qr(rr.internal.getHeight(a))+" re"),l.push("f"),n.stream=l.join(`
`),n}},RadioButton:{Circle:{createAppearanceStream:function(a){var n={D:{Off:rr.RadioButton.Circle.OffPushDown},N:{}};return n.N[a]=rr.RadioButton.Circle.YesNormal,n.D[a]=rr.RadioButton.Circle.YesPushDown,n},getCA:function(){return"l"},YesNormal:function(a){var n=qh(a);n.scope=a.scope;var l=[],c=rr.internal.getWidth(a)<=rr.internal.getHeight(a)?rr.internal.getWidth(a)/4:rr.internal.getHeight(a)/4;c=Number((.9*c).toFixed(5));var f=rr.internal.Bezier_C,i=Number((c*f).toFixed(5));return l.push("q"),l.push("1 0 0 1 "+Xf(rr.internal.getWidth(a)/2)+" "+Xf(rr.internal.getHeight(a)/2)+" cm"),l.push(c+" 0 m"),l.push(c+" "+i+" "+i+" "+c+" 0 "+c+" c"),l.push("-"+i+" "+c+" -"+c+" "+i+" -"+c+" 0 c"),l.push("-"+c+" -"+i+" -"+i+" -"+c+" 0 -"+c+" c"),l.push(i+" -"+c+" "+c+" -"+i+" "+c+" 0 c"),l.push("f"),l.push("Q"),n.stream=l.join(`
`),n},YesPushDown:function(a){var n=qh(a);n.scope=a.scope;var l=[],c=rr.internal.getWidth(a)<=rr.internal.getHeight(a)?rr.internal.getWidth(a)/4:rr.internal.getHeight(a)/4;c=Number((.9*c).toFixed(5));var f=Number((2*c).toFixed(5)),i=Number((f*rr.internal.Bezier_C).toFixed(5)),x=Number((c*rr.internal.Bezier_C).toFixed(5));return l.push("0.749023 g"),l.push("q"),l.push("1 0 0 1 "+Xf(rr.internal.getWidth(a)/2)+" "+Xf(rr.internal.getHeight(a)/2)+" cm"),l.push(f+" 0 m"),l.push(f+" "+i+" "+i+" "+f+" 0 "+f+" c"),l.push("-"+i+" "+f+" -"+f+" "+i+" -"+f+" 0 c"),l.push("-"+f+" -"+i+" -"+i+" -"+f+" 0 -"+f+" c"),l.push(i+" -"+f+" "+f+" -"+i+" "+f+" 0 c"),l.push("f"),l.push("Q"),l.push("0 g"),l.push("q"),l.push("1 0 0 1 "+Xf(rr.internal.getWidth(a)/2)+" "+Xf(rr.internal.getHeight(a)/2)+" cm"),l.push(c+" 0 m"),l.push(c+" "+x+" "+x+" "+c+" 0 "+c+" c"),l.push("-"+x+" "+c+" -"+c+" "+x+" -"+c+" 0 c"),l.push("-"+c+" -"+x+" -"+x+" -"+c+" 0 -"+c+" c"),l.push(x+" -"+c+" "+c+" -"+x+" "+c+" 0 c"),l.push("f"),l.push("Q"),n.stream=l.join(`
`),n},OffPushDown:function(a){var n=qh(a);n.scope=a.scope;var l=[],c=rr.internal.getWidth(a)<=rr.internal.getHeight(a)?rr.internal.getWidth(a)/4:rr.internal.getHeight(a)/4;c=Number((.9*c).toFixed(5));var f=Number((2*c).toFixed(5)),i=Number((f*rr.internal.Bezier_C).toFixed(5));return l.push("0.749023 g"),l.push("q"),l.push("1 0 0 1 "+Xf(rr.internal.getWidth(a)/2)+" "+Xf(rr.internal.getHeight(a)/2)+" cm"),l.push(f+" 0 m"),l.push(f+" "+i+" "+i+" "+f+" 0 "+f+" c"),l.push("-"+i+" "+f+" -"+f+" "+i+" -"+f+" 0 c"),l.push("-"+f+" -"+i+" -"+i+" -"+f+" 0 -"+f+" c"),l.push(i+" -"+f+" "+f+" -"+i+" "+f+" 0 c"),l.push("f"),l.push("Q"),n.stream=l.join(`
`),n}},Cross:{createAppearanceStream:function(a){var n={D:{Off:rr.RadioButton.Cross.OffPushDown},N:{}};return n.N[a]=rr.RadioButton.Cross.YesNormal,n.D[a]=rr.RadioButton.Cross.YesPushDown,n},getCA:function(){return"8"},YesNormal:function(a){var n=qh(a);n.scope=a.scope;var l=[],c=rr.internal.calculateCross(a);return l.push("q"),l.push("1 1 "+Qr(rr.internal.getWidth(a)-2)+" "+Qr(rr.internal.getHeight(a)-2)+" re"),l.push("W"),l.push("n"),l.push(Qr(c.x1.x)+" "+Qr(c.x1.y)+" m"),l.push(Qr(c.x2.x)+" "+Qr(c.x2.y)+" l"),l.push(Qr(c.x4.x)+" "+Qr(c.x4.y)+" m"),l.push(Qr(c.x3.x)+" "+Qr(c.x3.y)+" l"),l.push("s"),l.push("Q"),n.stream=l.join(`
`),n},YesPushDown:function(a){var n=qh(a);n.scope=a.scope;var l=rr.internal.calculateCross(a),c=[];return c.push("0.749023 g"),c.push("0 0 "+Qr(rr.internal.getWidth(a))+" "+Qr(rr.internal.getHeight(a))+" re"),c.push("f"),c.push("q"),c.push("1 1 "+Qr(rr.internal.getWidth(a)-2)+" "+Qr(rr.internal.getHeight(a)-2)+" re"),c.push("W"),c.push("n"),c.push(Qr(l.x1.x)+" "+Qr(l.x1.y)+" m"),c.push(Qr(l.x2.x)+" "+Qr(l.x2.y)+" l"),c.push(Qr(l.x4.x)+" "+Qr(l.x4.y)+" m"),c.push(Qr(l.x3.x)+" "+Qr(l.x3.y)+" l"),c.push("s"),c.push("Q"),n.stream=c.join(`
`),n},OffPushDown:function(a){var n=qh(a);n.scope=a.scope;var l=[];return l.push("0.749023 g"),l.push("0 0 "+Qr(rr.internal.getWidth(a))+" "+Qr(rr.internal.getHeight(a))+" re"),l.push("f"),n.stream=l.join(`
`),n}}},createDefaultAppearanceStream:function(a){var n=a.scope.internal.getFont(a.fontName,a.fontStyle).id,l=a.scope.__private__.encodeColorString(a.color);return"/"+n+" "+a.fontSize+" Tf "+l}};rr.internal={Bezier_C:.551915024494,calculateCross:function(a){var n=rr.internal.getWidth(a),l=rr.internal.getHeight(a),c=Math.min(n,l);return{x1:{x:(n-c)/2,y:(l-c)/2+c},x2:{x:(n-c)/2+c,y:(l-c)/2},x3:{x:(n-c)/2,y:(l-c)/2},x4:{x:(n-c)/2+c,y:(l-c)/2+c}}}},rr.internal.getWidth=function(a){var n=0;return(0,Ia.default)(a)==="object"&&(n=A4(a.Rect[2])),n},rr.internal.getHeight=function(a){var n=0;return(0,Ia.default)(a)==="object"&&(n=A4(a.Rect[3])),n};F7=Eo.addField=function(a){if(D7(this,a),!(a instanceof nh))throw new Error("Invalid argument passed to jsPDF.addField.");var n;return(n=a).scope.internal.acroformPlugin.printedOut&&(n.scope.internal.acroformPlugin.printedOut=!1,n.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),n.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(n),a.page=a.scope.internal.getCurrentPageInfo().pageNumber,this};Eo.AcroFormChoiceField=tm,Eo.AcroFormListBox=im,Eo.AcroFormComboBox=rm,Eo.AcroFormEditBox=t_,Eo.AcroFormButton=ns,Eo.AcroFormPushButton=i_,Eo.AcroFormRadioButton=nm,Eo.AcroFormCheckBox=r_,Eo.AcroFormTextField=Kf,Eo.AcroFormPasswordField=n_,Eo.AcroFormAppearance=rr,Eo.AcroForm={ChoiceField:tm,ListBox:im,ComboBox:rm,EditBox:t_,Button:ns,PushButton:i_,RadioButton:nm,CheckBox:r_,TextField:Kf,PasswordField:n_,Appearance:rr},Lr.AcroForm={ChoiceField:tm,ListBox:im,ComboBox:rm,EditBox:t_,Button:ns,PushButton:i_,RadioButton:nm,CheckBox:r_,TextField:Kf,PasswordField:n_,Appearance:rr};P7=Lr.AcroForm;(function(a){a.__addimage__={};var n="UNKNOWN",l={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},c=a.__addimage__.getImageFileTypeByImageData=function(_e,xe){var Qe,Ce,Ye,ut,st,pt=n;if((xe=xe||n)==="RGBA"||_e.data!==void 0&&_e.data instanceof Uint8ClampedArray&&"height"in _e&&"width"in _e)return"RGBA";if(et(_e))for(st in l)for(Ye=l[st],Qe=0;Qe<Ye.length;Qe+=1){for(ut=!0,Ce=0;Ce<Ye[Qe].length;Ce+=1)if(Ye[Qe][Ce]!==void 0&&Ye[Qe][Ce]!==_e[Ce]){ut=!1;break}if(ut===!0){pt=st;break}}else for(st in l)for(Ye=l[st],Qe=0;Qe<Ye.length;Qe+=1){for(ut=!0,Ce=0;Ce<Ye[Qe].length;Ce+=1)if(Ye[Qe][Ce]!==void 0&&Ye[Qe][Ce]!==_e.charCodeAt(Ce)){ut=!1;break}if(ut===!0){pt=st;break}}return pt===n&&xe!==n&&(pt=xe),pt},f=function _e(xe){for(var Qe=this.internal.write,Ce=this.internal.putStream,Ye=(0,this.internal.getFilters)();Ye.indexOf("FlateEncode")!==-1;)Ye.splice(Ye.indexOf("FlateEncode"),1);xe.objectId=this.internal.newObject();var ut=[];if(ut.push({key:"Type",value:"/XObject"}),ut.push({key:"Subtype",value:"/Image"}),ut.push({key:"Width",value:xe.width}),ut.push({key:"Height",value:xe.height}),xe.colorSpace===J.INDEXED?ut.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(xe.palette.length/3-1)+" "+("sMask"in xe&&xe.sMask!==void 0?xe.objectId+2:xe.objectId+1)+" 0 R]"}):(ut.push({key:"ColorSpace",value:"/"+xe.colorSpace}),xe.colorSpace===J.DEVICE_CMYK&&ut.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ut.push({key:"BitsPerComponent",value:xe.bitsPerComponent}),"decodeParameters"in xe&&xe.decodeParameters!==void 0&&ut.push({key:"DecodeParms",value:"<<"+xe.decodeParameters+">>"}),"transparency"in xe&&Array.isArray(xe.transparency)){for(var st="",pt=0,Tt=xe.transparency.length;pt<Tt;pt++)st+=xe.transparency[pt]+" "+xe.transparency[pt]+" ";ut.push({key:"Mask",value:"["+st+"]"})}xe.sMask!==void 0&&ut.push({key:"SMask",value:xe.objectId+1+" 0 R"});var ht=xe.filter!==void 0?["/"+xe.filter]:void 0;if(Ce({data:xe.data,additionalKeyValues:ut,alreadyAppliedFilters:ht,objectId:xe.objectId}),Qe("endobj"),"sMask"in xe&&xe.sMask!==void 0){var Wt="/Predictor "+xe.predictor+" /Colors 1 /BitsPerComponent "+xe.bitsPerComponent+" /Columns "+xe.width,ie={width:xe.width,height:xe.height,colorSpace:"DeviceGray",bitsPerComponent:xe.bitsPerComponent,decodeParameters:Wt,data:xe.sMask};"filter"in xe&&(ie.filter=xe.filter),_e.call(this,ie)}if(xe.colorSpace===J.INDEXED){var ye=this.internal.newObject();Ce({data:ge(new Uint8Array(xe.palette)),objectId:ye}),Qe("endobj")}},i=function(){var _e=this.internal.collections.addImage_images;for(var xe in _e)f.call(this,_e[xe])},x=function(){var _e,xe=this.internal.collections.addImage_images,Qe=this.internal.write;for(var Ce in xe)Qe("/I"+(_e=xe[Ce]).index,_e.objectId,"0","R")},T=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",x))},A=function(){var _e=this.internal.collections.addImage_images;return T.call(this),_e},M=function(){return Object.keys(this.internal.collections.addImage_images).length},F=function(_e){return typeof a["process"+_e.toUpperCase()]=="function"},W=function(_e){return(0,Ia.default)(_e)==="object"&&_e.nodeType===1},V=function(_e,xe){if(_e.nodeName==="IMG"&&_e.hasAttribute("src")){var Qe=""+_e.getAttribute("src");if(Qe.indexOf("data:image/")===0)return e_(unescape(Qe).split("base64,").pop());var Ce=a.loadFile(Qe,!0);if(Ce!==void 0)return Ce}if(_e.nodeName==="CANVAS"){if(_e.width===0||_e.height===0)throw new Error("Given canvas must have data. Canvas width: "+_e.width+", height: "+_e.height);var Ye;switch(xe){case"PNG":Ye="image/png";break;case"WEBP":Ye="image/webp";break;case"JPEG":case"JPG":default:Ye="image/jpeg"}return e_(_e.toDataURL(Ye,1).split("base64,").pop())}},R=function(_e){var xe=this.internal.collections.addImage_images;if(xe){for(var Qe in xe)if(_e===xe[Qe].alias)return xe[Qe]}},te=function(_e,xe,Qe){return _e||xe||(_e=-96,xe=-96),_e<0&&(_e=-1*Qe.width*72/_e/this.internal.scaleFactor),xe<0&&(xe=-1*Qe.height*72/xe/this.internal.scaleFactor),_e===0&&(_e=xe*Qe.width/Qe.height),xe===0&&(xe=_e*Qe.height/Qe.width),[_e,xe]},H=function(_e,xe,Qe,Ce,Ye,ut){var st=te.call(this,Qe,Ce,Ye),pt=this.internal.getCoordinateString,Tt=this.internal.getVerticalCoordinateString,ht=A.call(this);if(Qe=st[0],Ce=st[1],ht[Ye.index]=Ye,ut){ut*=Math.PI/180;var Wt=Math.cos(ut),ie=Math.sin(ut),ye=function(Ie){return Ie.toFixed(4)},pe=[ye(Wt),ye(ie),ye(-1*ie),ye(Wt),0,0,"cm"]}this.internal.write("q"),ut?(this.internal.write([1,"0","0",1,pt(_e),Tt(xe+Ce),"cm"].join(" ")),this.internal.write(pe.join(" ")),this.internal.write([pt(Qe),"0","0",pt(Ce),"0","0","cm"].join(" "))):this.internal.write([pt(Qe),"0","0",pt(Ce),pt(_e),Tt(xe+Ce),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Ye.index+" Do"),this.internal.write("Q")},J=a.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};a.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var K=a.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},ne=a.__addimage__.sHashCode=function(_e){var xe,Qe,Ce=0;if(typeof _e=="string")for(Qe=_e.length,xe=0;xe<Qe;xe++)Ce=(Ce<<5)-Ce+_e.charCodeAt(xe),Ce|=0;else if(et(_e))for(Qe=_e.byteLength/2,xe=0;xe<Qe;xe++)Ce=(Ce<<5)-Ce+_e[xe],Ce|=0;return Ce},de=a.__addimage__.validateStringAsBase64=function(_e){(_e=_e||"").toString().trim();var xe=!0;return _e.length===0&&(xe=!1),_e.length%4!=0&&(xe=!1),/^[A-Za-z0-9+/]+$/.test(_e.substr(0,_e.length-2))===!1&&(xe=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(_e.substr(-2))===!1&&(xe=!1),xe},De=a.__addimage__.extractImageFromDataUrl=function(_e){var xe=(_e=_e||"").split("base64,"),Qe=null;if(xe.length===2){var Ce=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(xe[0]);Array.isArray(Ce)&&(Qe={mimeType:Ce[1],charset:Ce[2],data:xe[1]})}return Qe},Fe=a.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};a.__addimage__.isArrayBuffer=function(_e){return Fe()&&_e instanceof ArrayBuffer};var et=a.__addimage__.isArrayBufferView=function(_e){return Fe()&&typeof Uint32Array<"u"&&(_e instanceof Int8Array||_e instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&_e instanceof Uint8ClampedArray||_e instanceof Int16Array||_e instanceof Uint16Array||_e instanceof Int32Array||_e instanceof Uint32Array||_e instanceof Float32Array||_e instanceof Float64Array)},Te=a.__addimage__.binaryStringToUint8Array=function(_e){for(var xe=_e.length,Qe=new Uint8Array(xe),Ce=0;Ce<xe;Ce++)Qe[Ce]=_e.charCodeAt(Ce);return Qe},ge=a.__addimage__.arrayBufferToBinaryString=function(_e){for(var xe="",Qe=et(_e)?_e:new Uint8Array(_e),Ce=0;Ce<Qe.length;Ce+=8192)xe+=String.fromCharCode.apply(null,Qe.subarray(Ce,Ce+8192));return xe};a.addImage=function(){var _e,xe,Qe,Ce,Ye,ut,st,pt,Tt;if(typeof arguments[1]=="number"?(xe=n,Qe=arguments[1],Ce=arguments[2],Ye=arguments[3],ut=arguments[4],st=arguments[5],pt=arguments[6],Tt=arguments[7]):(xe=arguments[1],Qe=arguments[2],Ce=arguments[3],Ye=arguments[4],ut=arguments[5],st=arguments[6],pt=arguments[7],Tt=arguments[8]),(0,Ia.default)(_e=arguments[0])==="object"&&!W(_e)&&"imageData"in _e){var ht=_e;_e=ht.imageData,xe=ht.format||xe||n,Qe=ht.x||Qe||0,Ce=ht.y||Ce||0,Ye=ht.w||ht.width||Ye,ut=ht.h||ht.height||ut,st=ht.alias||st,pt=ht.compression||pt,Tt=ht.rotation||ht.angle||Tt}var Wt=this.internal.getFilters();if(pt===void 0&&Wt.indexOf("FlateEncode")!==-1&&(pt="SLOW"),isNaN(Qe)||isNaN(Ce))throw new Error("Invalid coordinates passed to jsPDF.addImage");T.call(this);var ie=Ve.call(this,_e,xe,st,pt);return H.call(this,Qe,Ce,Ye,ut,ie,Tt),this};var Ve=function(_e,xe,Qe,Ce){var Ye,ut,st;if(typeof _e=="string"&&c(_e)===n){_e=unescape(_e);var pt=Ae(_e,!1);(pt!==""||(pt=a.loadFile(_e,!0))!==void 0)&&(_e=pt)}if(W(_e)&&(_e=V(_e,xe)),xe=c(_e,xe),!F(xe))throw new Error("addImage does not support files of type '"+xe+"', please ensure that a plugin for '"+xe+"' support is added.");if(((st=Qe)==null||st.length===0)&&(Qe=function(Tt){return typeof Tt=="string"||et(Tt)?ne(Tt):et(Tt.data)?ne(Tt.data):null}(_e)),(Ye=R.call(this,Qe))||(Fe()&&(_e instanceof Uint8Array||xe==="RGBA"||(ut=_e,_e=Te(_e))),Ye=this["process"+xe.toUpperCase()](_e,M.call(this),Qe,function(Tt){return Tt&&typeof Tt=="string"&&(Tt=Tt.toUpperCase()),Tt in a.image_compression?Tt:K.NONE}(Ce),ut)),!Ye)throw new Error("An unknown error occurred whilst processing the image.");return Ye},Ae=a.__addimage__.convertBase64ToBinaryString=function(_e,xe){var Qe;xe=typeof xe!="boolean"||xe;var Ce,Ye="";if(typeof _e=="string"){Ce=(Qe=De(_e))!==null?Qe.data:_e;try{Ye=e_(Ce)}catch(ut){if(xe)throw de(Ce)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ut.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Ye};a.getImageProperties=function(_e){var xe,Qe,Ce="";if(W(_e)&&(_e=V(_e)),typeof _e=="string"&&c(_e)===n&&((Ce=Ae(_e,!1))===""&&(Ce=a.loadFile(_e)||""),_e=Ce),Qe=c(_e),!F(Qe))throw new Error("addImage does not support files of type '"+Qe+"', please ensure that a plugin for '"+Qe+"' support is added.");if(!Fe()||_e instanceof Uint8Array||(_e=Te(_e)),!(xe=this["process"+Qe.toUpperCase()](_e)))throw new Error("An unknown error occurred whilst processing the image");return xe.fileType=Qe,xe}})(Lr.API),function(a){var n=function(l){if(l!==void 0&&l!="")return!0};Lr.API.events.push(["addPage",function(l){this.internal.getPageInfo(l.pageNumber).pageContext.annotations=[]}]),a.events.push(["putPage",function(l){for(var c,f,i,x=this.internal.getCoordinateString,T=this.internal.getVerticalCoordinateString,A=this.internal.getPageInfoByObjId(l.objId),M=l.pageContext.annotations,F=!1,W=0;W<M.length&&!F;W++)switch((c=M[W]).type){case"link":(n(c.options.url)||n(c.options.pageNumber))&&(F=!0);break;case"reference":case"text":case"freetext":F=!0}if(F!=0){this.internal.write("/Annots [");for(var V=0;V<M.length;V++){c=M[V];var R=this.internal.pdfEscape,te=this.internal.getEncryptor(l.objId);switch(c.type){case"reference":this.internal.write(" "+c.object.objId+" 0 R ");break;case"text":var H=this.internal.newAdditionalObject(),J=this.internal.newAdditionalObject(),K=this.internal.getEncryptor(H.objId),ne=c.title||"Note";i="<</Type /Annot /Subtype /Text "+(f="/Rect ["+x(c.bounds.x)+" "+T(c.bounds.y+c.bounds.h)+" "+x(c.bounds.x+c.bounds.w)+" "+T(c.bounds.y)+"] ")+"/Contents ("+R(K(c.contents))+")",i+=" /Popup "+J.objId+" 0 R",i+=" /P "+A.objId+" 0 R",i+=" /T ("+R(K(ne))+") >>",H.content=i;var de=H.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(f="/Rect ["+x(c.bounds.x+30)+" "+T(c.bounds.y+c.bounds.h)+" "+x(c.bounds.x+c.bounds.w+30)+" "+T(c.bounds.y)+"] ")+" /Parent "+de,c.open&&(i+=" /Open true"),i+=" >>",J.content=i,this.internal.write(H.objId,"0 R",J.objId,"0 R");break;case"freetext":f="/Rect ["+x(c.bounds.x)+" "+T(c.bounds.y)+" "+x(c.bounds.x+c.bounds.w)+" "+T(c.bounds.y+c.bounds.h)+"] ";var De=c.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+f+"/Contents ("+R(te(c.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+De+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(c.options.name){var Fe=this.annotations._nameMap[c.options.name];c.options.pageNumber=Fe.page,c.options.top=Fe.y}else c.options.top||(c.options.top=0);if(f="/Rect ["+c.finalBounds.x+" "+c.finalBounds.y+" "+c.finalBounds.w+" "+c.finalBounds.h+"] ",i="",c.options.url)i="<</Type /Annot /Subtype /Link "+f+"/Border [0 0 0] /A <</S /URI /URI ("+R(te(c.options.url))+") >>";else if(c.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+f+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(c.options.pageNumber).objId+" 0 R",c.options.magFactor=c.options.magFactor||"XYZ",c.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+c.options.top+"]";break;case"FitV":c.options.left=c.options.left||0,i+=" /FitV "+c.options.left+"]";break;case"XYZ":default:var et=T(c.options.top);c.options.left=c.options.left||0,c.options.zoom===void 0&&(c.options.zoom=0),i+=" /XYZ "+c.options.left+" "+et+" "+c.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),a.createAnnotation=function(l){var c=this.internal.getCurrentPageInfo();switch(l.type){case"link":this.link(l.bounds.x,l.bounds.y,l.bounds.w,l.bounds.h,l);break;case"text":case"freetext":c.pageContext.annotations.push(l)}},a.link=function(l,c,f,i,x){var T=this.internal.getCurrentPageInfo(),A=this.internal.getCoordinateString,M=this.internal.getVerticalCoordinateString;T.pageContext.annotations.push({finalBounds:{x:A(l),y:M(c),w:A(l+f),h:M(c+i)},options:x,type:"link"})},a.textWithLink=function(l,c,f,i){var x,T,A=this.getTextWidth(l),M=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){T=i.maxWidth;var F=this.splitTextToSize(l,T).length;x=Math.ceil(M*F)}else T=A,x=M;return this.text(l,c,f,i),f+=.2*M,i.align==="center"&&(c-=A/2),i.align==="right"&&(c-=A),this.link(c,f-M,T,x,i),A},a.getTextWidth=function(l){var c=this.internal.getFontSize();return this.getStringUnitWidth(l)*c/this.internal.scaleFactor}}(Lr.API),function(a){var n={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},l={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},c={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},f=[1570,1571,1573,1575];a.__arabicParser__={};var i=a.__arabicParser__.isInArabicSubstitutionA=function(H){return n[H.charCodeAt(0)]!==void 0},x=a.__arabicParser__.isArabicLetter=function(H){return typeof H=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(H)},T=a.__arabicParser__.isArabicEndLetter=function(H){return x(H)&&i(H)&&n[H.charCodeAt(0)].length<=2},A=a.__arabicParser__.isArabicAlfLetter=function(H){return x(H)&&f.indexOf(H.charCodeAt(0))>=0};a.__arabicParser__.arabicLetterHasIsolatedForm=function(H){return x(H)&&i(H)&&n[H.charCodeAt(0)].length>=1};var M=a.__arabicParser__.arabicLetterHasFinalForm=function(H){return x(H)&&i(H)&&n[H.charCodeAt(0)].length>=2};a.__arabicParser__.arabicLetterHasInitialForm=function(H){return x(H)&&i(H)&&n[H.charCodeAt(0)].length>=3};var F=a.__arabicParser__.arabicLetterHasMedialForm=function(H){return x(H)&&i(H)&&n[H.charCodeAt(0)].length==4},W=a.__arabicParser__.resolveLigatures=function(H){var J=0,K=l,ne="",de=0;for(J=0;J<H.length;J+=1)K[H.charCodeAt(J)]!==void 0?(de++,typeof(K=K[H.charCodeAt(J)])=="number"&&(ne+=String.fromCharCode(K),K=l,de=0),J===H.length-1&&(K=l,ne+=H.charAt(J-(de-1)),J-=de-1,de=0)):(K=l,ne+=H.charAt(J-de),J-=de,de=0);return ne};a.__arabicParser__.isArabicDiacritic=function(H){return H!==void 0&&c[H.charCodeAt(0)]!==void 0};var V=a.__arabicParser__.getCorrectForm=function(H,J,K){return x(H)?i(H)===!1?-1:!M(H)||!x(J)&&!x(K)||!x(K)&&T(J)||T(H)&&!x(J)||T(H)&&A(J)||T(H)&&T(J)?0:F(H)&&x(J)&&!T(J)&&x(K)&&M(K)?3:T(H)||!x(K)?1:2:-1},R=function(H){var J=0,K=0,ne=0,de="",De="",Fe="",et=(H=H||"").split("\\s+"),Te=[];for(J=0;J<et.length;J+=1){for(Te.push(""),K=0;K<et[J].length;K+=1)de=et[J][K],De=et[J][K-1],Fe=et[J][K+1],x(de)?(ne=V(de,De,Fe),Te[J]+=ne!==-1?String.fromCharCode(n[de.charCodeAt(0)][ne]):de):Te[J]+=de;Te[J]=W(Te[J])}return Te.join(" ")},te=a.__arabicParser__.processArabic=a.processArabic=function(){var H,J=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,K=[];if(Array.isArray(J)){var ne=0;for(K=[],ne=0;ne<J.length;ne+=1)Array.isArray(J[ne])?K.push([R(J[ne][0]),J[ne][1],J[ne][2]]):K.push([R(J[ne])]);H=K}else H=R(J);return typeof arguments[0]=="string"?H:(arguments[0].text=H,arguments[0])};a.events.push(["preProcessText",te])}(Lr.API),Lr.API.autoPrint=function(a){var n;switch((a=a||{}).variant=a.variant||"non-conform",a.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){n=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+n+" 0 R")})}return this},function(a){var n=function(){var l=void 0;Object.defineProperty(this,"pdf",{get:function(){return l},set:function(T){l=T}});var c=150;Object.defineProperty(this,"width",{get:function(){return c},set:function(T){c=isNaN(T)||Number.isInteger(T)===!1||T<0?150:T,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=c+1)}});var f=300;Object.defineProperty(this,"height",{get:function(){return f},set:function(T){f=isNaN(T)||Number.isInteger(T)===!1||T<0?300:T,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=f+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(T){i=T}});var x={};Object.defineProperty(this,"style",{get:function(){return x},set:function(T){x=T}}),Object.defineProperty(this,"parentNode",{})};n.prototype.getContext=function(l,c){var f;if((l=l||"2d")!=="2d")return null;for(f in c)this.pdf.context2d.hasOwnProperty(f)&&(this.pdf.context2d[f]=c[f]);return this.pdf.context2d._canvas=this,this.pdf.context2d},n.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},a.events.push(["initialized",function(){this.canvas=new n,this.canvas.pdf=this}])}(Lr.API),function(a){var n={left:0,top:0,bottom:0,right:0},l=!1,c=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},n),this.internal.__cell__.margins.width=this.getPageWidth(),f.call(this))},f=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var A=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return A},set:function(H){A=H}});var M=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return M},set:function(H){M=H}});var F=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return F},set:function(H){F=H}});var W=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return W},set:function(H){W=H}});var V=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return V},set:function(H){V=H}});var R=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return R},set:function(H){R=H}});var te=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return te},set:function(H){te=H}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},a.setHeaderFunction=function(A){return c.call(this),this.internal.__cell__.headerFunction=typeof A=="function"?A:void 0,this},a.getTextDimensions=function(A,M){c.call(this);var F=(M=M||{}).fontSize||this.getFontSize(),W=M.font||this.getFont(),V=M.scaleFactor||this.internal.scaleFactor,R=0,te=0,H=0,J=this;if(!Array.isArray(A)&&typeof A!="string"){if(typeof A!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");A=String(A)}var K=M.maxWidth;K>0?typeof A=="string"?A=this.splitTextToSize(A,K):Object.prototype.toString.call(A)==="[object Array]"&&(A=A.reduce(function(de,De){return de.concat(J.splitTextToSize(De,K))},[])):A=Array.isArray(A)?A:[A];for(var ne=0;ne<A.length;ne++)R<(H=this.getStringUnitWidth(A[ne],{font:W})*F)&&(R=H);return R!==0&&(te=A.length),{w:R/=V,h:Math.max((te*F*this.getLineHeightFactor()-F*(this.getLineHeightFactor()-1))/V,0)}},a.cellAddPage=function(){c.call(this),this.addPage();var A=this.internal.__cell__.margins||n;return this.internal.__cell__.lastCell=new i(A.left,A.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var x=a.cell=function(){var A;A=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),c.call(this);var M=this.internal.__cell__.lastCell,F=this.internal.__cell__.padding,W=this.internal.__cell__.margins||n,V=this.internal.__cell__.tableHeaderRow,R=this.internal.__cell__.printHeaders;return M.lineNumber!==void 0&&(M.lineNumber===A.lineNumber?(A.x=(M.x||0)+(M.width||0),A.y=M.y||0):M.y+M.height+A.height+W.bottom>this.getPageHeight()?(this.cellAddPage(),A.y=W.top,R&&V&&(this.printHeaderRow(A.lineNumber,!0),A.y+=V[0].height)):A.y=M.y+M.height||A.y),A.text[0]!==void 0&&(this.rect(A.x,A.y,A.width,A.height,l===!0?"FD":void 0),A.align==="right"?this.text(A.text,A.x+A.width-F,A.y+F,{align:"right",baseline:"top"}):A.align==="center"?this.text(A.text,A.x+A.width/2,A.y+F,{align:"center",baseline:"top",maxWidth:A.width-F-F}):this.text(A.text,A.x+F,A.y+F,{align:"left",baseline:"top",maxWidth:A.width-F-F})),this.internal.__cell__.lastCell=A,this};a.table=function(A,M,F,W,V){if(c.call(this),!F)throw new Error("No data for PDF table.");var R,te,H,J,K=[],ne=[],de=[],De={},Fe={},et=[],Te=[],ge=(V=V||{}).autoSize||!1,Ve=V.printHeaders!==!1,Ae=V.css&&V.css["font-size"]!==void 0?16*V.css["font-size"]:V.fontSize||12,_e=V.margins||Object.assign({width:this.getPageWidth()},n),xe=typeof V.padding=="number"?V.padding:3,Qe=V.headerBackgroundColor||"#c8c8c8",Ce=V.headerTextColor||"#000";if(f.call(this),this.internal.__cell__.printHeaders=Ve,this.internal.__cell__.margins=_e,this.internal.__cell__.table_font_size=Ae,this.internal.__cell__.padding=xe,this.internal.__cell__.headerBackgroundColor=Qe,this.internal.__cell__.headerTextColor=Ce,this.setFontSize(Ae),W==null)ne=K=Object.keys(F[0]),de=K.map(function(){return"left"});else if(Array.isArray(W)&&(0,Ia.default)(W[0])==="object")for(K=W.map(function(ht){return ht.name}),ne=W.map(function(ht){return ht.prompt||ht.name||""}),de=W.map(function(ht){return ht.align||"left"}),R=0;R<W.length;R+=1)Fe[W[R].name]=W[R].width*(19.049976/25.4);else Array.isArray(W)&&typeof W[0]=="string"&&(ne=K=W,de=K.map(function(){return"left"}));if(ge||Array.isArray(W)&&typeof W[0]=="string")for(R=0;R<K.length;R+=1){for(De[J=K[R]]=F.map(function(ht){return ht[J]}),this.setFont(void 0,"bold"),et.push(this.getTextDimensions(ne[R],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),te=De[J],this.setFont(void 0,"normal"),H=0;H<te.length;H+=1)et.push(this.getTextDimensions(te[H],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);Fe[J]=Math.max.apply(null,et)+xe+xe,et=[]}if(Ve){var Ye={};for(R=0;R<K.length;R+=1)Ye[K[R]]={},Ye[K[R]].text=ne[R],Ye[K[R]].align=de[R];var ut=T.call(this,Ye,Fe);Te=K.map(function(ht){return new i(A,M,Fe[ht],ut,Ye[ht].text,void 0,Ye[ht].align)}),this.setTableHeaderRow(Te),this.printHeaderRow(1,!1)}var st=W.reduce(function(ht,Wt){return ht[Wt.name]=Wt.align,ht},{});for(R=0;R<F.length;R+=1){"rowStart"in V&&V.rowStart instanceof Function&&V.rowStart({row:R,data:F[R]},this);var pt=T.call(this,F[R],Fe);for(H=0;H<K.length;H+=1){var Tt=F[R][K[H]];"cellStart"in V&&V.cellStart instanceof Function&&V.cellStart({row:R,col:H,data:Tt},this),x.call(this,new i(A,M,Fe[K[H]],pt,Tt,R+2,st[K[H]]))}}return this.internal.__cell__.table_x=A,this.internal.__cell__.table_y=M,this};var T=function(A,M){var F=this.internal.__cell__.padding,W=this.internal.__cell__.table_font_size,V=this.internal.scaleFactor;return Object.keys(A).map(function(R){var te=A[R];return this.splitTextToSize(te.hasOwnProperty("text")?te.text:te,M[R]-F-F)},this).map(function(R){return this.getLineHeightFactor()*R.length*W/V+F+F},this).reduce(function(R,te){return Math.max(R,te)},0)};a.setTableHeaderRow=function(A){c.call(this),this.internal.__cell__.tableHeaderRow=A},a.printHeaderRow=function(A,M){if(c.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var F;if(l=!0,typeof this.internal.__cell__.headerFunction=="function"){var W=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(W[0],W[1],W[2],W[3],void 0,-1)}this.setFont(void 0,"bold");for(var V=[],R=0;R<this.internal.__cell__.tableHeaderRow.length;R+=1){F=this.internal.__cell__.tableHeaderRow[R].clone(),M&&(F.y=this.internal.__cell__.margins.top||0,V.push(F)),F.lineNumber=A;var te=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),x.call(this,F),this.setTextColor(te)}V.length>0&&this.setTableHeaderRow(V),this.setFont(void 0,"normal"),l=!1}}(Lr.API);q4={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},$4=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],N2=W4($4),X4=[100,200,300,400,500,600,700,800,900],L7=W4(X4);R7={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},I4={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};D2=["times"];(function(a){var n,l,c,f,i,x,T,A,M,F=function(ie){return ie=ie||{},this.isStrokeTransparent=ie.isStrokeTransparent||!1,this.strokeOpacity=ie.strokeOpacity||1,this.strokeStyle=ie.strokeStyle||"#000000",this.fillStyle=ie.fillStyle||"#000000",this.isFillTransparent=ie.isFillTransparent||!1,this.fillOpacity=ie.fillOpacity||1,this.font=ie.font||"10px sans-serif",this.textBaseline=ie.textBaseline||"alphabetic",this.textAlign=ie.textAlign||"left",this.lineWidth=ie.lineWidth||1,this.lineJoin=ie.lineJoin||"miter",this.lineCap=ie.lineCap||"butt",this.path=ie.path||[],this.transform=ie.transform!==void 0?ie.transform.clone():new A,this.globalCompositeOperation=ie.globalCompositeOperation||"normal",this.globalAlpha=ie.globalAlpha||1,this.clip_path=ie.clip_path||[],this.currentPoint=ie.currentPoint||new x,this.miterLimit=ie.miterLimit||10,this.lastPoint=ie.lastPoint||new x,this.lineDashOffset=ie.lineDashOffset||0,this.lineDash=ie.lineDash||[],this.margin=ie.margin||[0,0,0,0],this.prevPageLastElemOffset=ie.prevPageLastElemOffset||0,this.ignoreClearRect=typeof ie.ignoreClearRect!="boolean"||ie.ignoreClearRect,this};a.events.push(["initialized",function(){this.context2d=new W(this),n=this.internal.f2,l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,f=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,x=this.internal.Point,T=this.internal.Rectangle,A=this.internal.Matrix,M=new F}]);var W=function(ie){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var ye=ie;Object.defineProperty(this,"pdf",{get:function(){return ye}});var pe=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return pe},set:function($t){pe=!!$t}});var Ie=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Ie},set:function($t){Ie=!!$t}});var Ue=0;Object.defineProperty(this,"posX",{get:function(){return Ue},set:function($t){isNaN($t)||(Ue=$t)}});var gt=0;Object.defineProperty(this,"posY",{get:function(){return gt},set:function($t){isNaN($t)||(gt=$t)}}),Object.defineProperty(this,"margin",{get:function(){return M.margin},set:function($t){var lt;typeof $t=="number"?lt=[$t,$t,$t,$t]:((lt=new Array(4))[0]=$t[0],lt[1]=$t.length>=2?$t[1]:lt[0],lt[2]=$t.length>=3?$t[2]:lt[0],lt[3]=$t.length>=4?$t[3]:lt[1]),M.margin=lt}});var mt=!1;Object.defineProperty(this,"autoPaging",{get:function(){return mt},set:function($t){mt=$t}});var wt=0;Object.defineProperty(this,"lastBreak",{get:function(){return wt},set:function($t){wt=$t}});var Lt=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Lt},set:function($t){Lt=$t}}),Object.defineProperty(this,"ctx",{get:function(){return M},set:function($t){$t instanceof F&&(M=$t)}}),Object.defineProperty(this,"path",{get:function(){return M.path},set:function($t){M.path=$t}});var fi=[];Object.defineProperty(this,"ctxStack",{get:function(){return fi},set:function($t){fi=$t}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function($t){var lt;lt=V($t),this.ctx.fillStyle=lt.style,this.ctx.isFillTransparent=lt.a===0,this.ctx.fillOpacity=lt.a,this.pdf.setFillColor(lt.r,lt.g,lt.b,{a:lt.a}),this.pdf.setTextColor(lt.r,lt.g,lt.b,{a:lt.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function($t){var lt=V($t);this.ctx.strokeStyle=lt.style,this.ctx.isStrokeTransparent=lt.a===0,this.ctx.strokeOpacity=lt.a,lt.a===0?this.pdf.setDrawColor(255,255,255):(lt.a,this.pdf.setDrawColor(lt.r,lt.g,lt.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function($t){["butt","round","square"].indexOf($t)!==-1&&(this.ctx.lineCap=$t,this.pdf.setLineCap($t))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function($t){isNaN($t)||(this.ctx.lineWidth=$t,this.pdf.setLineWidth($t))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function($t){["bevel","round","miter"].indexOf($t)!==-1&&(this.ctx.lineJoin=$t,this.pdf.setLineJoin($t))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function($t){isNaN($t)||(this.ctx.miterLimit=$t,this.pdf.setMiterLimit($t))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function($t){this.ctx.textBaseline=$t}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function($t){["right","end","center","left","start"].indexOf($t)!==-1&&(this.ctx.textAlign=$t)}});var yi=null;function Fi($t,lt){if(yi===null){var Bt=function(ni){var bi=[];return Object.keys(ni).forEach(function(ki){ni[ki].forEach(function(Ni){var Bi=null;switch(Ni){case"bold":Bi={family:ki,weight:"bold"};break;case"italic":Bi={family:ki,style:"italic"};break;case"bolditalic":Bi={family:ki,weight:"bold",style:"italic"};break;case"":case"normal":Bi={family:ki}}Bi!==null&&(Bi.ref={name:ki,style:Ni},bi.push(Bi))})}),bi}($t.getFontList());yi=function(ni){for(var bi={},ki=0;ki<ni.length;++ki){var Ni=B2(ni[ki]),Bi=Ni.family,tr=Ni.stretch,ar=Ni.style,vr=Ni.weight;bi[Bi]=bi[Bi]||{},bi[Bi][tr]=bi[Bi][tr]||{},bi[Bi][tr][ar]=bi[Bi][tr][ar]||{},bi[Bi][tr][ar][vr]=Ni}return bi}(Bt.concat(lt))}return yi}var Pi=null;Object.defineProperty(this,"fontFaces",{get:function(){return Pi},set:function($t){yi=null,Pi=$t}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function($t){var lt;if(this.ctx.font=$t,(lt=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec($t))!==null){var Bt=lt[1],ni=(lt[2],lt[3]),bi=lt[4],ki=(lt[5],lt[6]),Ni=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(bi)[2];bi=Math.floor(Ni==="px"?parseFloat(bi)*this.pdf.internal.scaleFactor:Ni==="em"?parseFloat(bi)*this.pdf.getFontSize():parseFloat(bi)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(bi);var Bi=function(xr){var Or,Ri,La=[],Di=xr.trim();if(Di==="")return D2;if(Di in I4)return[I4[Di]];for(;Di!=="";){switch(Ri=null,Or=(Di=M4(Di)).charAt(0)){case'"':case"'":Ri=N7(Di.substring(1),Or);break;default:Ri=B7(Di)}if(Ri===null||(La.push(Ri[0]),(Di=M4(Ri[1]))!==""&&Di.charAt(0)!==","))return D2;Di=Di.replace(/^,/,"")}return La}(ki);if(this.fontFaces){var tr=O7(Fi(this.pdf,this.fontFaces),Bi.map(function(xr){return{family:xr,stretch:"normal",weight:ni,style:Bt}}));this.pdf.setFont(tr.ref.name,tr.ref.style)}else{var ar="";(ni==="bold"||parseInt(ni,10)>=700||Bt==="bold")&&(ar="bold"),Bt==="italic"&&(ar+="italic"),ar.length===0&&(ar="normal");for(var vr="",kr={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},qr=0;qr<Bi.length;qr++){if(this.pdf.internal.getFont(Bi[qr],ar,{noFallback:!0,disableWarning:!0})!==void 0){vr=Bi[qr];break}if(ar==="bolditalic"&&this.pdf.internal.getFont(Bi[qr],"bold",{noFallback:!0,disableWarning:!0})!==void 0)vr=Bi[qr],ar="bold";else if(this.pdf.internal.getFont(Bi[qr],"normal",{noFallback:!0,disableWarning:!0})!==void 0){vr=Bi[qr],ar="normal";break}}if(vr===""){for(var Kr=0;Kr<Bi.length;Kr++)if(kr[Bi[Kr]]){vr=kr[Bi[Kr]];break}}vr=vr===""?"Times":vr,this.pdf.setFont(vr,ar)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function($t){this.ctx.globalCompositeOperation=$t}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function($t){this.ctx.globalAlpha=$t}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function($t){this.ctx.lineDashOffset=$t,Wt.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function($t){this.ctx.lineDash=$t,Wt.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function($t){this.ctx.ignoreClearRect=!!$t}})};W.prototype.setLineDash=function(ie){this.lineDash=ie},W.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},W.prototype.fill=function(){De.call(this,"fill",!1)},W.prototype.stroke=function(){De.call(this,"stroke",!1)},W.prototype.beginPath=function(){this.path=[{type:"begin"}]},W.prototype.moveTo=function(ie,ye){if(isNaN(ie)||isNaN(ye))throw Pa.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var pe=this.ctx.transform.applyToPoint(new x(ie,ye));this.path.push({type:"mt",x:pe.x,y:pe.y}),this.ctx.lastPoint=new x(ie,ye)},W.prototype.closePath=function(){var ie=new x(0,0),ye=0;for(ye=this.path.length-1;ye!==-1;ye--)if(this.path[ye].type==="begin"&&(0,Ia.default)(this.path[ye+1])==="object"&&typeof this.path[ye+1].x=="number"){ie=new x(this.path[ye+1].x,this.path[ye+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new x(ie.x,ie.y)},W.prototype.lineTo=function(ie,ye){if(isNaN(ie)||isNaN(ye))throw Pa.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var pe=this.ctx.transform.applyToPoint(new x(ie,ye));this.path.push({type:"lt",x:pe.x,y:pe.y}),this.ctx.lastPoint=new x(pe.x,pe.y)},W.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),De.call(this,null,!0)},W.prototype.quadraticCurveTo=function(ie,ye,pe,Ie){if(isNaN(pe)||isNaN(Ie)||isNaN(ie)||isNaN(ye))throw Pa.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Ue=this.ctx.transform.applyToPoint(new x(pe,Ie)),gt=this.ctx.transform.applyToPoint(new x(ie,ye));this.path.push({type:"qct",x1:gt.x,y1:gt.y,x:Ue.x,y:Ue.y}),this.ctx.lastPoint=new x(Ue.x,Ue.y)},W.prototype.bezierCurveTo=function(ie,ye,pe,Ie,Ue,gt){if(isNaN(Ue)||isNaN(gt)||isNaN(ie)||isNaN(ye)||isNaN(pe)||isNaN(Ie))throw Pa.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var mt=this.ctx.transform.applyToPoint(new x(Ue,gt)),wt=this.ctx.transform.applyToPoint(new x(ie,ye)),Lt=this.ctx.transform.applyToPoint(new x(pe,Ie));this.path.push({type:"bct",x1:wt.x,y1:wt.y,x2:Lt.x,y2:Lt.y,x:mt.x,y:mt.y}),this.ctx.lastPoint=new x(mt.x,mt.y)},W.prototype.arc=function(ie,ye,pe,Ie,Ue,gt){if(isNaN(ie)||isNaN(ye)||isNaN(pe)||isNaN(Ie)||isNaN(Ue))throw Pa.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(gt=!!gt,!this.ctx.transform.isIdentity){var mt=this.ctx.transform.applyToPoint(new x(ie,ye));ie=mt.x,ye=mt.y;var wt=this.ctx.transform.applyToPoint(new x(0,pe)),Lt=this.ctx.transform.applyToPoint(new x(0,0));pe=Math.sqrt(Math.pow(wt.x-Lt.x,2)+Math.pow(wt.y-Lt.y,2))}Math.abs(Ue-Ie)>=2*Math.PI&&(Ie=0,Ue=2*Math.PI),this.path.push({type:"arc",x:ie,y:ye,radius:pe,startAngle:Ie,endAngle:Ue,counterclockwise:gt})},W.prototype.arcTo=function(ie,ye,pe,Ie,Ue){throw new Error("arcTo not implemented.")},W.prototype.rect=function(ie,ye,pe,Ie){if(isNaN(ie)||isNaN(ye)||isNaN(pe)||isNaN(Ie))throw Pa.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(ie,ye),this.lineTo(ie+pe,ye),this.lineTo(ie+pe,ye+Ie),this.lineTo(ie,ye+Ie),this.lineTo(ie,ye),this.lineTo(ie+pe,ye),this.lineTo(ie,ye)},W.prototype.fillRect=function(ie,ye,pe,Ie){if(isNaN(ie)||isNaN(ye)||isNaN(pe)||isNaN(Ie))throw Pa.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!R.call(this)){var Ue={};this.lineCap!=="butt"&&(Ue.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Ue.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(ie,ye,pe,Ie),this.fill(),Ue.hasOwnProperty("lineCap")&&(this.lineCap=Ue.lineCap),Ue.hasOwnProperty("lineJoin")&&(this.lineJoin=Ue.lineJoin)}},W.prototype.strokeRect=function(ie,ye,pe,Ie){if(isNaN(ie)||isNaN(ye)||isNaN(pe)||isNaN(Ie))throw Pa.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");te.call(this)||(this.beginPath(),this.rect(ie,ye,pe,Ie),this.stroke())},W.prototype.clearRect=function(ie,ye,pe,Ie){if(isNaN(ie)||isNaN(ye)||isNaN(pe)||isNaN(Ie))throw Pa.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(ie,ye,pe,Ie))},W.prototype.save=function(ie){ie=typeof ie!="boolean"||ie;for(var ye=this.pdf.internal.getCurrentPageInfo().pageNumber,pe=0;pe<this.pdf.internal.getNumberOfPages();pe++)this.pdf.setPage(pe+1),this.pdf.internal.out("q");if(this.pdf.setPage(ye),ie){this.ctx.fontSize=this.pdf.internal.getFontSize();var Ie=new F(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Ie}},W.prototype.restore=function(ie){ie=typeof ie!="boolean"||ie;for(var ye=this.pdf.internal.getCurrentPageInfo().pageNumber,pe=0;pe<this.pdf.internal.getNumberOfPages();pe++)this.pdf.setPage(pe+1),this.pdf.internal.out("Q");this.pdf.setPage(ye),ie&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},W.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var V=function(ie){var ye,pe,Ie,Ue;if(ie.isCanvasGradient===!0&&(ie=ie.getColor()),!ie)return{r:0,g:0,b:0,a:0,style:ie};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(ie))ye=0,pe=0,Ie=0,Ue=0;else{var gt=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(ie);if(gt!==null)ye=parseInt(gt[1]),pe=parseInt(gt[2]),Ie=parseInt(gt[3]),Ue=1;else if((gt=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(ie))!==null)ye=parseInt(gt[1]),pe=parseInt(gt[2]),Ie=parseInt(gt[3]),Ue=parseFloat(gt[4]);else{if(Ue=1,typeof ie=="string"&&ie.charAt(0)!=="#"){var mt=new z4(ie);ie=mt.ok?mt.toHex():"#000000"}ie.length===4?(ye=ie.substring(1,2),ye+=ye,pe=ie.substring(2,3),pe+=pe,Ie=ie.substring(3,4),Ie+=Ie):(ye=ie.substring(1,3),pe=ie.substring(3,5),Ie=ie.substring(5,7)),ye=parseInt(ye,16),pe=parseInt(pe,16),Ie=parseInt(Ie,16)}}return{r:ye,g:pe,b:Ie,a:Ue,style:ie}},R=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},te=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};W.prototype.fillText=function(ie,ye,pe,Ie){if(isNaN(ye)||isNaN(pe)||typeof ie!="string")throw Pa.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Ie=isNaN(Ie)?void 0:Ie,!R.call(this)){var Ue=pt(this.ctx.transform.rotation),gt=this.ctx.transform.scaleX;xe.call(this,{text:ie,x:ye,y:pe,scale:gt,angle:Ue,align:this.textAlign,maxWidth:Ie})}},W.prototype.strokeText=function(ie,ye,pe,Ie){if(isNaN(ye)||isNaN(pe)||typeof ie!="string")throw Pa.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!te.call(this)){Ie=isNaN(Ie)?void 0:Ie;var Ue=pt(this.ctx.transform.rotation),gt=this.ctx.transform.scaleX;xe.call(this,{text:ie,x:ye,y:pe,scale:gt,renderingMode:"stroke",angle:Ue,align:this.textAlign,maxWidth:Ie})}},W.prototype.measureText=function(ie){if(typeof ie!="string")throw Pa.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var ye=this.pdf,pe=this.pdf.internal.scaleFactor,Ie=ye.internal.getFontSize(),Ue=ye.getStringUnitWidth(ie)*Ie/ye.internal.scaleFactor,gt=function(mt){var wt=(mt=mt||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return wt}}),this};return new gt({width:Ue*=Math.round(96*pe/72*1e4)/1e4})},W.prototype.scale=function(ie,ye){if(isNaN(ie)||isNaN(ye))throw Pa.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var pe=new A(ie,0,0,ye,0,0);this.ctx.transform=this.ctx.transform.multiply(pe)},W.prototype.rotate=function(ie){if(isNaN(ie))throw Pa.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var ye=new A(Math.cos(ie),Math.sin(ie),-Math.sin(ie),Math.cos(ie),0,0);this.ctx.transform=this.ctx.transform.multiply(ye)},W.prototype.translate=function(ie,ye){if(isNaN(ie)||isNaN(ye))throw Pa.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var pe=new A(1,0,0,1,ie,ye);this.ctx.transform=this.ctx.transform.multiply(pe)},W.prototype.transform=function(ie,ye,pe,Ie,Ue,gt){if(isNaN(ie)||isNaN(ye)||isNaN(pe)||isNaN(Ie)||isNaN(Ue)||isNaN(gt))throw Pa.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var mt=new A(ie,ye,pe,Ie,Ue,gt);this.ctx.transform=this.ctx.transform.multiply(mt)},W.prototype.setTransform=function(ie,ye,pe,Ie,Ue,gt){ie=isNaN(ie)?1:ie,ye=isNaN(ye)?0:ye,pe=isNaN(pe)?0:pe,Ie=isNaN(Ie)?1:Ie,Ue=isNaN(Ue)?0:Ue,gt=isNaN(gt)?0:gt,this.ctx.transform=new A(ie,ye,pe,Ie,Ue,gt)};var H=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};W.prototype.drawImage=function(ie,ye,pe,Ie,Ue,gt,mt,wt,Lt){var fi=this.pdf.getImageProperties(ie),yi=1,Fi=1,Pi=1,$t=1;Ie!==void 0&&wt!==void 0&&(Pi=wt/Ie,$t=Lt/Ue,yi=fi.width/Ie*wt/Ie,Fi=fi.height/Ue*Lt/Ue),gt===void 0&&(gt=ye,mt=pe,ye=0,pe=0),Ie!==void 0&&wt===void 0&&(wt=Ie,Lt=Ue),Ie===void 0&&wt===void 0&&(wt=fi.width,Lt=fi.height);for(var lt,Bt=this.ctx.transform.decompose(),ni=pt(Bt.rotate.shx),bi=new A,ki=(bi=(bi=(bi=bi.multiply(Bt.translate)).multiply(Bt.skew)).multiply(Bt.scale)).applyToRectangle(new T(gt-ye*Pi,mt-pe*$t,Ie*yi,Ue*Fi)),Ni=J.call(this,ki),Bi=[],tr=0;tr<Ni.length;tr+=1)Bi.indexOf(Ni[tr])===-1&&Bi.push(Ni[tr]);if(de(Bi),this.autoPaging)for(var ar=Bi[0],vr=Bi[Bi.length-1],kr=ar;kr<vr+1;kr++){this.pdf.setPage(kr);var qr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Kr=kr===1?this.posY+this.margin[0]:this.margin[0],xr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Or=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ri=kr===1?0:xr+(kr-2)*Or;if(this.ctx.clip_path.length!==0){var La=this.path;lt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ne(lt,this.posX+this.margin[3],-Ri+Kr+this.ctx.prevPageLastElemOffset),Fe.call(this,"fill",!0),this.path=La}var Di=JSON.parse(JSON.stringify(ki));Di=ne([Di],this.posX+this.margin[3],-Ri+Kr+this.ctx.prevPageLastElemOffset)[0];var go=(kr>ar||kr<vr)&&H.call(this);go&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],qr,Or,null).clip().discardPath()),this.pdf.addImage(ie,"JPEG",Di.x,Di.y,Di.w,Di.h,null,null,ni),go&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(ie,"JPEG",ki.x,ki.y,ki.w,ki.h,null,null,ni)};var J=function(ie,ye,pe){var Ie=[];ye=ye||this.pdf.internal.pageSize.width,pe=pe||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Ue=this.posY+this.ctx.prevPageLastElemOffset;switch(ie.type){default:case"mt":case"lt":Ie.push(Math.floor((ie.y+Ue)/pe)+1);break;case"arc":Ie.push(Math.floor((ie.y+Ue-ie.radius)/pe)+1),Ie.push(Math.floor((ie.y+Ue+ie.radius)/pe)+1);break;case"qct":var gt=Tt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,ie.x1,ie.y1,ie.x,ie.y);Ie.push(Math.floor((gt.y+Ue)/pe)+1),Ie.push(Math.floor((gt.y+gt.h+Ue)/pe)+1);break;case"bct":var mt=ht(this.ctx.lastPoint.x,this.ctx.lastPoint.y,ie.x1,ie.y1,ie.x2,ie.y2,ie.x,ie.y);Ie.push(Math.floor((mt.y+Ue)/pe)+1),Ie.push(Math.floor((mt.y+mt.h+Ue)/pe)+1);break;case"rect":Ie.push(Math.floor((ie.y+Ue)/pe)+1),Ie.push(Math.floor((ie.y+ie.h+Ue)/pe)+1)}for(var wt=0;wt<Ie.length;wt+=1)for(;this.pdf.internal.getNumberOfPages()<Ie[wt];)K.call(this);return Ie},K=function(){var ie=this.fillStyle,ye=this.strokeStyle,pe=this.font,Ie=this.lineCap,Ue=this.lineWidth,gt=this.lineJoin;this.pdf.addPage(),this.fillStyle=ie,this.strokeStyle=ye,this.font=pe,this.lineCap=Ie,this.lineWidth=Ue,this.lineJoin=gt},ne=function(ie,ye,pe){for(var Ie=0;Ie<ie.length;Ie++)switch(ie[Ie].type){case"bct":ie[Ie].x2+=ye,ie[Ie].y2+=pe;case"qct":ie[Ie].x1+=ye,ie[Ie].y1+=pe;case"mt":case"lt":case"arc":default:ie[Ie].x+=ye,ie[Ie].y+=pe}return ie},de=function(ie){return ie.sort(function(ye,pe){return ye-pe})},De=function(ie,ye){for(var pe,Ie,Ue=this.fillStyle,gt=this.strokeStyle,mt=this.lineCap,wt=this.lineWidth,Lt=Math.abs(wt*this.ctx.transform.scaleX),fi=this.lineJoin,yi=JSON.parse(JSON.stringify(this.path)),Fi=JSON.parse(JSON.stringify(this.path)),Pi=[],$t=0;$t<Fi.length;$t++)if(Fi[$t].x!==void 0)for(var lt=J.call(this,Fi[$t]),Bt=0;Bt<lt.length;Bt+=1)Pi.indexOf(lt[Bt])===-1&&Pi.push(lt[Bt]);for(var ni=0;ni<Pi.length;ni++)for(;this.pdf.internal.getNumberOfPages()<Pi[ni];)K.call(this);if(de(Pi),this.autoPaging)for(var bi=Pi[0],ki=Pi[Pi.length-1],Ni=bi;Ni<ki+1;Ni++){this.pdf.setPage(Ni),this.fillStyle=Ue,this.strokeStyle=gt,this.lineCap=mt,this.lineWidth=Lt,this.lineJoin=fi;var Bi=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],tr=Ni===1?this.posY+this.margin[0]:this.margin[0],ar=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],vr=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],kr=Ni===1?0:ar+(Ni-2)*vr;if(this.ctx.clip_path.length!==0){var qr=this.path;pe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ne(pe,this.posX+this.margin[3],-kr+tr+this.ctx.prevPageLastElemOffset),Fe.call(this,ie,!0),this.path=qr}if(Ie=JSON.parse(JSON.stringify(yi)),this.path=ne(Ie,this.posX+this.margin[3],-kr+tr+this.ctx.prevPageLastElemOffset),ye===!1||Ni===0){var Kr=(Ni>bi||Ni<ki)&&H.call(this);Kr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Bi,vr,null).clip().discardPath()),Fe.call(this,ie,ye),Kr&&this.pdf.restoreGraphicsState()}this.lineWidth=wt}else this.lineWidth=Lt,Fe.call(this,ie,ye),this.lineWidth=wt;this.path=yi},Fe=function(ie,ye){if((ie!=="stroke"||ye||!te.call(this))&&(ie==="stroke"||ye||!R.call(this))){for(var pe,Ie,Ue=[],gt=this.path,mt=0;mt<gt.length;mt++){var wt=gt[mt];switch(wt.type){case"begin":Ue.push({begin:!0});break;case"close":Ue.push({close:!0});break;case"mt":Ue.push({start:wt,deltas:[],abs:[]});break;case"lt":var Lt=Ue.length;if(gt[mt-1]&&!isNaN(gt[mt-1].x)&&(pe=[wt.x-gt[mt-1].x,wt.y-gt[mt-1].y],Lt>0)){for(;Lt>=0;Lt--)if(Ue[Lt-1].close!==!0&&Ue[Lt-1].begin!==!0){Ue[Lt-1].deltas.push(pe),Ue[Lt-1].abs.push(wt);break}}break;case"bct":pe=[wt.x1-gt[mt-1].x,wt.y1-gt[mt-1].y,wt.x2-gt[mt-1].x,wt.y2-gt[mt-1].y,wt.x-gt[mt-1].x,wt.y-gt[mt-1].y],Ue[Ue.length-1].deltas.push(pe);break;case"qct":var fi=gt[mt-1].x+2/3*(wt.x1-gt[mt-1].x),yi=gt[mt-1].y+2/3*(wt.y1-gt[mt-1].y),Fi=wt.x+2/3*(wt.x1-wt.x),Pi=wt.y+2/3*(wt.y1-wt.y),$t=wt.x,lt=wt.y;pe=[fi-gt[mt-1].x,yi-gt[mt-1].y,Fi-gt[mt-1].x,Pi-gt[mt-1].y,$t-gt[mt-1].x,lt-gt[mt-1].y],Ue[Ue.length-1].deltas.push(pe);break;case"arc":Ue.push({deltas:[],abs:[],arc:!0}),Array.isArray(Ue[Ue.length-1].abs)&&Ue[Ue.length-1].abs.push(wt)}}Ie=ye?null:ie==="stroke"?"stroke":"fill";for(var Bt=!1,ni=0;ni<Ue.length;ni++)if(Ue[ni].arc)for(var bi=Ue[ni].abs,ki=0;ki<bi.length;ki++){var Ni=bi[ki];Ni.type==="arc"?ge.call(this,Ni.x,Ni.y,Ni.radius,Ni.startAngle,Ni.endAngle,Ni.counterclockwise,void 0,ye,!Bt):Qe.call(this,Ni.x,Ni.y),Bt=!0}else if(Ue[ni].close===!0)this.pdf.internal.out("h"),Bt=!1;else if(Ue[ni].begin!==!0){var Bi=Ue[ni].start.x,tr=Ue[ni].start.y;Ce.call(this,Ue[ni].deltas,Bi,tr),Bt=!0}Ie&&Ve.call(this,Ie),ye&&Ae.call(this)}},et=function(ie){var ye=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,pe=ye*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return ie-pe;case"top":return ie+ye-pe;case"hanging":return ie+ye-2*pe;case"middle":return ie+ye/2-pe;case"ideographic":return ie;case"alphabetic":default:return ie}},Te=function(ie){return ie+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};W.prototype.createLinearGradient=function(){var ie=function(){};return ie.colorStops=[],ie.addColorStop=function(ye,pe){this.colorStops.push([ye,pe])},ie.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},ie.isCanvasGradient=!0,ie},W.prototype.createPattern=function(){return this.createLinearGradient()},W.prototype.createRadialGradient=function(){return this.createLinearGradient()};var ge=function(ie,ye,pe,Ie,Ue,gt,mt,wt,Lt){for(var fi=ut.call(this,pe,Ie,Ue,gt),yi=0;yi<fi.length;yi++){var Fi=fi[yi];yi===0&&(Lt?_e.call(this,Fi.x1+ie,Fi.y1+ye):Qe.call(this,Fi.x1+ie,Fi.y1+ye)),Ye.call(this,ie,ye,Fi.x2,Fi.y2,Fi.x3,Fi.y3,Fi.x4,Fi.y4)}wt?Ae.call(this):Ve.call(this,mt)},Ve=function(ie){switch(ie){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Ae=function(){this.pdf.clip(),this.pdf.discardPath()},_e=function(ie,ye){this.pdf.internal.out(l(ie)+" "+c(ye)+" m")},xe=function(ie){var ye;switch(ie.align){case"right":case"end":ye="right";break;case"center":ye="center";break;case"left":case"start":default:ye="left"}var pe=this.pdf.getTextDimensions(ie.text),Ie=et.call(this,ie.y),Ue=Te.call(this,Ie)-pe.h,gt=this.ctx.transform.applyToPoint(new x(ie.x,Ie)),mt=this.ctx.transform.decompose(),wt=new A;wt=(wt=(wt=wt.multiply(mt.translate)).multiply(mt.skew)).multiply(mt.scale);for(var Lt,fi,yi,Fi=this.ctx.transform.applyToRectangle(new T(ie.x,Ie,pe.w,pe.h)),Pi=wt.applyToRectangle(new T(ie.x,Ue,pe.w,pe.h)),$t=J.call(this,Pi),lt=[],Bt=0;Bt<$t.length;Bt+=1)lt.indexOf($t[Bt])===-1&&lt.push($t[Bt]);if(de(lt),this.autoPaging)for(var ni=lt[0],bi=lt[lt.length-1],ki=ni;ki<bi+1;ki++){this.pdf.setPage(ki);var Ni=ki===1?this.posY+this.margin[0]:this.margin[0],Bi=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],tr=this.pdf.internal.pageSize.height-this.margin[2],ar=tr-this.margin[0],vr=this.pdf.internal.pageSize.width-this.margin[1],kr=vr-this.margin[3],qr=ki===1?0:Bi+(ki-2)*ar;if(this.ctx.clip_path.length!==0){var Kr=this.path;Lt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ne(Lt,this.posX+this.margin[3],-1*qr+Ni),Fe.call(this,"fill",!0),this.path=Kr}var xr=ne([JSON.parse(JSON.stringify(Pi))],this.posX+this.margin[3],-qr+Ni+this.ctx.prevPageLastElemOffset)[0];ie.scale>=.01&&(fi=this.pdf.internal.getFontSize(),this.pdf.setFontSize(fi*ie.scale),yi=this.lineWidth,this.lineWidth=yi*ie.scale);var Or=this.autoPaging!=="text";if(Or||xr.y+xr.h<=tr){if(Or||xr.y>=Ni&&xr.x<=vr){var Ri=Or?ie.text:this.pdf.splitTextToSize(ie.text,ie.maxWidth||vr-xr.x)[0],La=ne([JSON.parse(JSON.stringify(Fi))],this.posX+this.margin[3],-qr+Ni+this.ctx.prevPageLastElemOffset)[0],Di=Or&&(ki>ni||ki<bi)&&H.call(this);Di&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],kr,ar,null).clip().discardPath()),this.pdf.text(Ri,La.x,La.y,{angle:ie.angle,align:ye,renderingMode:ie.renderingMode}),Di&&this.pdf.restoreGraphicsState()}}else xr.y<tr&&(this.ctx.prevPageLastElemOffset+=tr-xr.y);ie.scale>=.01&&(this.pdf.setFontSize(fi),this.lineWidth=yi)}else ie.scale>=.01&&(fi=this.pdf.internal.getFontSize(),this.pdf.setFontSize(fi*ie.scale),yi=this.lineWidth,this.lineWidth=yi*ie.scale),this.pdf.text(ie.text,gt.x+this.posX,gt.y+this.posY,{angle:ie.angle,align:ye,renderingMode:ie.renderingMode,maxWidth:ie.maxWidth}),ie.scale>=.01&&(this.pdf.setFontSize(fi),this.lineWidth=yi)},Qe=function(ie,ye,pe,Ie){pe=pe||0,Ie=Ie||0,this.pdf.internal.out(l(ie+pe)+" "+c(ye+Ie)+" l")},Ce=function(ie,ye,pe){return this.pdf.lines(ie,ye,pe,null,null)},Ye=function(ie,ye,pe,Ie,Ue,gt,mt,wt){this.pdf.internal.out([n(f(pe+ie)),n(i(Ie+ye)),n(f(Ue+ie)),n(i(gt+ye)),n(f(mt+ie)),n(i(wt+ye)),"c"].join(" "))},ut=function(ie,ye,pe,Ie){for(var Ue=2*Math.PI,gt=Math.PI/2;ye>pe;)ye-=Ue;var mt=Math.abs(pe-ye);mt<Ue&&Ie&&(mt=Ue-mt);for(var wt=[],Lt=Ie?-1:1,fi=ye;mt>1e-5;){var yi=fi+Lt*Math.min(mt,gt);wt.push(st.call(this,ie,fi,yi)),mt-=Math.abs(yi-fi),fi=yi}return wt},st=function(ie,ye,pe){var Ie=(pe-ye)/2,Ue=ie*Math.cos(Ie),gt=ie*Math.sin(Ie),mt=Ue,wt=-gt,Lt=mt*mt+wt*wt,fi=Lt+mt*Ue+wt*gt,yi=4/3*(Math.sqrt(2*Lt*fi)-fi)/(mt*gt-wt*Ue),Fi=mt-yi*wt,Pi=wt+yi*mt,$t=Fi,lt=-Pi,Bt=Ie+ye,ni=Math.cos(Bt),bi=Math.sin(Bt);return{x1:ie*Math.cos(ye),y1:ie*Math.sin(ye),x2:Fi*ni-Pi*bi,y2:Fi*bi+Pi*ni,x3:$t*ni-lt*bi,y3:$t*bi+lt*ni,x4:ie*Math.cos(pe),y4:ie*Math.sin(pe)}},pt=function(ie){return 180*ie/Math.PI},Tt=function(ie,ye,pe,Ie,Ue,gt){var mt=ie+.5*(pe-ie),wt=ye+.5*(Ie-ye),Lt=Ue+.5*(pe-Ue),fi=gt+.5*(Ie-gt),yi=Math.min(ie,Ue,mt,Lt),Fi=Math.max(ie,Ue,mt,Lt),Pi=Math.min(ye,gt,wt,fi),$t=Math.max(ye,gt,wt,fi);return new T(yi,Pi,Fi-yi,$t-Pi)},ht=function(ie,ye,pe,Ie,Ue,gt,mt,wt){var Lt,fi,yi,Fi,Pi,$t,lt,Bt,ni,bi,ki,Ni,Bi,tr,ar=pe-ie,vr=Ie-ye,kr=Ue-pe,qr=gt-Ie,Kr=mt-Ue,xr=wt-gt;for(fi=0;fi<41;fi++)ni=(lt=(yi=ie+(Lt=fi/40)*ar)+Lt*((Pi=pe+Lt*kr)-yi))+Lt*(Pi+Lt*(Ue+Lt*Kr-Pi)-lt),bi=(Bt=(Fi=ye+Lt*vr)+Lt*(($t=Ie+Lt*qr)-Fi))+Lt*($t+Lt*(gt+Lt*xr-$t)-Bt),fi==0?(ki=ni,Ni=bi,Bi=ni,tr=bi):(ki=Math.min(ki,ni),Ni=Math.min(Ni,bi),Bi=Math.max(Bi,ni),tr=Math.max(tr,bi));return new T(Math.round(ki),Math.round(Ni),Math.round(Bi-ki),Math.round(tr-Ni))},Wt=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var ie,ye,pe=(ie=this.ctx.lineDash,ye=this.ctx.lineDashOffset,JSON.stringify({lineDash:ie,lineDashOffset:ye}));this.prevLineDash!==pe&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=pe)}}})(Lr.API),function(a){var n=function(i){var x,T,A,M,F,W,V,R,te,H;for(/[^\x00-\xFF]/.test(i),T=[],A=0,M=(i+=x="\0\0\0\0".slice(i.length%4||4)).length;M>A;A+=4)(F=(i.charCodeAt(A)<<24)+(i.charCodeAt(A+1)<<16)+(i.charCodeAt(A+2)<<8)+i.charCodeAt(A+3))!==0?(W=(F=((F=((F=((F=(F-(H=F%85))/85)-(te=F%85))/85)-(R=F%85))/85)-(V=F%85))/85)%85,T.push(W+33,V+33,R+33,te+33,H+33)):T.push(122);return function(J,K){for(var ne=K;ne>0;ne--)J.pop()}(T,x.length),String.fromCharCode.apply(String,T)+"~>"},l=function(i){var x,T,A,M,F,W=String,V="length",R=255,te="charCodeAt",H="slice",J="replace";for(i[H](-2),i=i[H](0,-2)[J](/\s/g,"")[J]("z","!!!!!"),A=[],M=0,F=(i+=x="uuuuu"[H](i[V]%5||5))[V];F>M;M+=5)T=52200625*(i[te](M)-33)+614125*(i[te](M+1)-33)+7225*(i[te](M+2)-33)+85*(i[te](M+3)-33)+(i[te](M+4)-33),A.push(R&T>>24,R&T>>16,R&T>>8,R&T);return function(K,ne){for(var de=ne;de>0;de--)K.pop()}(A,x[V]),W.fromCharCode.apply(W,A)},c=function(i){var x=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),x.test(i)===!1)return"";for(var T="",A=0;A<i.length;A+=2)T+=String.fromCharCode("0x"+(i[A]+i[A+1]));return T},f=function(i){for(var x=new Uint8Array(i.length),T=i.length;T--;)x[T]=i.charCodeAt(T);return i=(x=Nx(x)).reduce(function(A,M){return A+String.fromCharCode(M)},"")};a.processDataByFilters=function(i,x){var T=0,A=i||"",M=[];for(typeof(x=x||[])=="string"&&(x=[x]),T=0;T<x.length;T+=1)switch(x[T]){case"ASCII85Decode":case"/ASCII85Decode":A=l(A),M.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":A=n(A),M.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":A=c(A),M.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":A=A.split("").map(function(F){return("0"+F.charCodeAt().toString(16)).slice(-2)}).join("")+">",M.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":A=f(A),M.push("/FlateDecode");break;default:throw new Error('The filter: "'+x[T]+'" is not implemented')}return{data:A,reverseChain:M.reverse().join(" ")}}}(Lr.API),function(a){a.loadFile=function(n,l,c){return function(f,i,x){i=i!==!1,x=typeof x=="function"?x:function(){};var T=void 0;try{T=function(A,M,F){var W=new XMLHttpRequest,V=0,R=function(te){var H=te.length,J=[],K=String.fromCharCode;for(V=0;V<H;V+=1)J.push(K(255&te.charCodeAt(V)));return J.join("")};if(W.open("GET",A,!M),W.overrideMimeType("text/plain; charset=x-user-defined"),M===!1&&(W.onload=function(){W.status===200?F(R(this.responseText)):F(void 0)}),W.send(null),M&&W.status===200)return R(W.responseText)}(f,i,x)}catch{}return T}(n,l,c)},a.loadImageFile=a.loadFile}(Lr.API),function(a){function n(){return(zr.html2canvas?Promise.resolve(zr.html2canvas):import("./chunk-PEIFQPD4.mjs")).catch(function(x){return Promise.reject(new Error("Could not load html2canvas: "+x))}).then(function(x){return x.default?x.default:x})}function l(){return(zr.DOMPurify?Promise.resolve(zr.DOMPurify):import("./chunk-NFRCOBVO.mjs")).catch(function(x){return Promise.reject(new Error("Could not load dompurify: "+x))}).then(function(x){return x.default?x.default:x})}var c=function(x){var T=(0,Ia.default)(x);return T==="undefined"?"undefined":T==="string"||x instanceof String?"string":T==="number"||x instanceof Number?"number":T==="function"||x instanceof Function?"function":x&&x.constructor===Array?"array":x&&x.nodeType===1?"element":T==="object"?"object":"unknown"},f=function(x,T){var A=document.createElement(x);for(var M in T.className&&(A.className=T.className),T.innerHTML&&T.dompurify&&(A.innerHTML=T.dompurify.sanitize(T.innerHTML)),T.style)A.style[M]=T.style[M];return A},i=function x(T){var A=Object.assign(x.convert(Promise.resolve()),JSON.parse(JSON.stringify(x.template))),M=x.convert(Promise.resolve(),A);return M=(M=M.setProgress(1,x,1,[x])).set(T)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(x,T){return x.__proto__=T||i.prototype,x},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(x,T){return this.then(function(){switch(T=T||function(A){switch(c(A)){case"string":return"string";case"element":return A.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(x)){case"string":return this.then(l).then(function(A){return this.set({src:f("div",{innerHTML:x,dompurify:A})})});case"element":return this.set({src:x});case"canvas":return this.set({canvas:x});case"img":return this.set({img:x});default:return this.error("Unknown source type.")}})},i.prototype.to=function(x){switch(x){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var x={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},T=function A(M,F){for(var W=M.nodeType===3?document.createTextNode(M.nodeValue):M.cloneNode(!1),V=M.firstChild;V;V=V.nextSibling)F!==!0&&V.nodeType===1&&V.nodeName==="SCRIPT"||W.appendChild(A(V,F));return M.nodeType===1&&(M.nodeName==="CANVAS"?(W.width=M.width,W.height=M.height,W.getContext("2d").drawImage(M,0,0)):M.nodeName!=="TEXTAREA"&&M.nodeName!=="SELECT"||(W.value=M.value),W.addEventListener("load",function(){W.scrollTop=M.scrollTop,W.scrollLeft=M.scrollLeft},!0)),W}(this.prop.src,this.opt.html2canvas.javascriptEnabled);T.tagName==="BODY"&&(x.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=f("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=f("div",{className:"html2pdf__container",style:x}),this.prop.container.appendChild(T),this.prop.container.firstChild.appendChild(f("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var x=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(x).then(n).then(function(T){var A=Object.assign({},this.opt.html2canvas);return delete A.onrendered,T(this.prop.container,A)}).then(function(T){(this.opt.html2canvas.onrendered||function(){})(T),this.prop.canvas=T,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var x=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(x).then(n).then(function(T){var A=this.opt.jsPDF,M=this.opt.fontFaces,F=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,W=Object.assign({async:!0,allowTaint:!0,scale:F,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete W.onrendered,A.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,A.context2d.posX=this.opt.x,A.context2d.posY=this.opt.y,A.context2d.margin=this.opt.margin,A.context2d.fontFaces=M,M)for(var V=0;V<M.length;++V){var R=M[V],te=R.src.find(function(H){return H.format==="truetype"});te&&A.addFont(te.url,R.ref.name,R.ref.style)}return W.windowHeight=W.windowHeight||0,W.windowHeight=W.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):W.windowHeight,A.context2d.save(!0),T(this.prop.container,W)}).then(function(T){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(T),this.prop.canvas=T,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var x=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=x})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(x,T,A){return(A=A||"pdf").toLowerCase()==="img"||A.toLowerCase()==="image"?this.outputImg(x,T):this.outputPdf(x,T)},i.prototype.outputPdf=function(x,T){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(x,T)})},i.prototype.outputImg=function(x){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(x){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+x+'" is not supported.'}})},i.prototype.save=function(x){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(x?{filename:x}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(x){if(c(x)!=="object")return this;var T=Object.keys(x||{}).map(function(A){if(A in i.template.prop)return function(){this.prop[A]=x[A]};switch(A){case"margin":return this.setMargin.bind(this,x.margin);case"jsPDF":return function(){return this.opt.jsPDF=x.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,x.pageSize);default:return function(){this.opt[A]=x[A]}}},this);return this.then(function(){return this.thenList(T)})},i.prototype.get=function(x,T){return this.then(function(){var A=x in i.template.prop?this.prop[x]:this.opt[x];return T?T(A):A})},i.prototype.setMargin=function(x){return this.then(function(){switch(c(x)){case"number":x=[x,x,x,x];case"array":if(x.length===2&&(x=[x[0],x[1],x[0],x[1]]),x.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=x}).then(this.setPageSize)},i.prototype.setPageSize=function(x){function T(A,M){return Math.floor(A*M/72*96)}return this.then(function(){(x=x||Lr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(x.inner={width:x.width-this.opt.margin[1]-this.opt.margin[3],height:x.height-this.opt.margin[0]-this.opt.margin[2]},x.inner.px={width:T(x.inner.width,x.k),height:T(x.inner.height,x.k)},x.inner.ratio=x.inner.height/x.inner.width),this.prop.pageSize=x})},i.prototype.setProgress=function(x,T,A,M){return x!=null&&(this.progress.val=x),T!=null&&(this.progress.state=T),A!=null&&(this.progress.n=A),M!=null&&(this.progress.stack=M),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(x,T,A,M){return this.setProgress(x?this.progress.val+x:null,T||null,A?this.progress.n+A:null,M?this.progress.stack.concat(M):null)},i.prototype.then=function(x,T){var A=this;return this.thenCore(x,T,function(M,F){return A.updateProgress(null,null,1,[M]),Promise.prototype.then.call(this,function(W){return A.updateProgress(null,M),W}).then(M,F).then(function(W){return A.updateProgress(1),W})})},i.prototype.thenCore=function(x,T,A){A=A||Promise.prototype.then,x&&(x=x.bind(this)),T&&(T=T.bind(this));var M=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),F=A.call(M,x,T);return i.convert(F,this.__proto__)},i.prototype.thenExternal=function(x,T){return Promise.prototype.then.call(this,x,T)},i.prototype.thenList=function(x){var T=this;return x.forEach(function(A){T=T.thenCore(A)}),T},i.prototype.catch=function(x){x&&(x=x.bind(this));var T=Promise.prototype.catch.call(this,x);return i.convert(T,this)},i.prototype.catchExternal=function(x){return Promise.prototype.catch.call(this,x)},i.prototype.error=function(x){return this.then(function(){throw new Error(x)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,Lr.getPageSize=function(x,T,A){if((0,Ia.default)(x)==="object"){var M=x;x=M.orientation,T=M.unit||T,A=M.format||A}T=T||"mm",A=A||"a4",x=(""+(x||"P")).toLowerCase();var F,W=(""+A).toLowerCase(),V={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(T){case"pt":F=1;break;case"mm":F=72/25.4;break;case"cm":F=72/2.54;break;case"in":F=72;break;case"px":F=.75;break;case"pc":case"em":F=12;break;case"ex":F=6;break;default:throw"Invalid unit: "+T}var R,te=0,H=0;if(V.hasOwnProperty(W))te=V[W][1]/F,H=V[W][0]/F;else try{te=A[1],H=A[0]}catch{throw new Error("Invalid format: "+A)}if(x==="p"||x==="portrait")x="p",H>te&&(R=H,H=te,te=R);else{if(x!=="l"&&x!=="landscape")throw"Invalid orientation: "+x;x="l",te>H&&(R=H,H=te,te=R)}return{width:H,height:te,unit:T,k:F,orientation:x}},a.html=function(x,T){(T=T||{}).callback=T.callback||function(){},T.html2canvas=T.html2canvas||{},T.html2canvas.canvas=T.html2canvas.canvas||this.canvas,T.jsPDF=T.jsPDF||this,T.fontFaces=T.fontFaces?T.fontFaces.map(B2):null;var A=new i(T);return T.worker?A:A.from(x).doCallback()}}(Lr.API),Lr.API.addJS=function(a){return F4=a,this.internal.events.subscribe("postPutResources",function(){jx=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(jx+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),D4=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+F4+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){jx!==void 0&&D4!==void 0&&this.internal.out("/Names <</JavaScript "+jx+" 0 R>>")}),this},function(a){var n;a.events.push(["postPutResources",function(){var l=this,c=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var f=l.outline.render().split(/\r\n/),i=0;i<f.length;i++){var x=f[i],T=c.exec(x);if(T!=null){var A=T[1];l.internal.newObjectDeferredBegin(A,!1)}l.internal.write(x)}if(this.outline.createNamedDestinations){var M=this.internal.pages.length,F=[];for(i=0;i<M;i++){var W=l.internal.newObject();F.push(W);var V=l.internal.getPageInfo(i+1);l.internal.write("<< /D["+V.objId+" 0 R /XYZ null null null]>> endobj")}var R=l.internal.newObject();for(l.internal.write("<< /Names [ "),i=0;i<F.length;i++)l.internal.write("(page_"+(i+1)+")"+F[i]+" 0 R");l.internal.write(" ] >>","endobj"),n=l.internal.newObject(),l.internal.write("<< /Dests "+R+" 0 R"),l.internal.write(">>","endobj")}}]),a.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+n+" 0 R"))}]),a.events.push(["initialized",function(){var l=this;l.outline={createNamedDestinations:!1,root:{children:[]}},l.outline.add=function(c,f,i){var x={title:f,options:i,children:[]};return c==null&&(c=this.root),c.children.push(x),x},l.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=l,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},l.outline.genIds_r=function(c){c.id=l.internal.newObjectDeferred();for(var f=0;f<c.children.length;f++)this.genIds_r(c.children[f])},l.outline.renderRoot=function(c){this.objStart(c),this.line("/Type /Outlines"),c.children.length>0&&(this.line("/First "+this.makeRef(c.children[0])),this.line("/Last "+this.makeRef(c.children[c.children.length-1]))),this.line("/Count "+this.count_r({count:0},c)),this.objEnd()},l.outline.renderItems=function(c){for(var f=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<c.children.length;i++){var x=c.children[i];this.objStart(x),this.line("/Title "+this.makeString(x.title)),this.line("/Parent "+this.makeRef(c)),i>0&&this.line("/Prev "+this.makeRef(c.children[i-1])),i<c.children.length-1&&this.line("/Next "+this.makeRef(c.children[i+1])),x.children.length>0&&(this.line("/First "+this.makeRef(x.children[0])),this.line("/Last "+this.makeRef(x.children[x.children.length-1])));var T=this.count=this.count_r({count:0},x);if(T>0&&this.line("/Count "+T),x.options&&x.options.pageNumber){var A=l.internal.getPageInfo(x.options.pageNumber);this.line("/Dest ["+A.objId+" 0 R /XYZ 0 "+f(0)+" 0]")}this.objEnd()}for(var M=0;M<c.children.length;M++)this.renderItems(c.children[M])},l.outline.line=function(c){this.ctx.val+=c+`\r
`},l.outline.makeRef=function(c){return c.id+" 0 R"},l.outline.makeString=function(c){return"("+l.internal.pdfEscape(c)+")"},l.outline.objStart=function(c){this.ctx.val+=`\r
`+c.id+` 0 obj\r
<<\r
`},l.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},l.outline.count_r=function(c,f){for(var i=0;i<f.children.length;i++)c.count++,this.count_r(c,f.children[i]);return c.count}}])}(Lr.API),function(a){var n=[192,193,194,195,196,197,198,199];a.processJPEG=function(l,c,f,i,x,T){var A,M=this.decode.DCT_DECODE,F=null;if(typeof l=="string"||this.__addimage__.isArrayBuffer(l)||this.__addimage__.isArrayBufferView(l)){switch(l=x||l,l=this.__addimage__.isArrayBuffer(l)?new Uint8Array(l):l,(A=function(W){for(var V,R=256*W.charCodeAt(4)+W.charCodeAt(5),te=W.length,H={width:0,height:0,numcomponents:1},J=4;J<te;J+=2){if(J+=R,n.indexOf(W.charCodeAt(J+1))!==-1){V=256*W.charCodeAt(J+5)+W.charCodeAt(J+6),H={width:256*W.charCodeAt(J+7)+W.charCodeAt(J+8),height:V,numcomponents:W.charCodeAt(J+9)};break}R=256*W.charCodeAt(J+2)+W.charCodeAt(J+3)}return H}(l=this.__addimage__.isArrayBufferView(l)?this.__addimage__.arrayBufferToBinaryString(l):l)).numcomponents){case 1:T=this.color_spaces.DEVICE_GRAY;break;case 4:T=this.color_spaces.DEVICE_CMYK;break;case 3:T=this.color_spaces.DEVICE_RGB}F={data:l,width:A.width,height:A.height,colorSpace:T,bitsPerComponent:8,filter:M,index:c,alias:f}}return F}}(Lr.API);z7=function(){var a,n,l;function c(i){var x,T,A,M,F,W,V,R,te,H,J,K,ne,de;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},W=null;;){switch(x=this.readUInt32(),te=(function(){var De,Fe;for(Fe=[],De=0;De<4;++De)Fe.push(String.fromCharCode(this.data[this.pos++]));return Fe}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(x);break;case"fcTL":W&&this.animation.frames.push(W),this.pos+=4,W={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},F=this.readUInt16(),M=this.readUInt16()||100,W.delay=1e3*F/M,W.disposeOp=this.data[this.pos++],W.blendOp=this.data[this.pos++],W.data=[];break;case"IDAT":case"fdAT":for(te==="fdAT"&&(this.pos+=4,x-=4),i=W?.data||this.imgData,K=0;0<=x?K<x:K>x;0<=x?++K:--K)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(A=this.palette.length/3,this.transparency.indexed=this.read(x),this.transparency.indexed.length>A)throw new Error("More transparent colors than palette size");if((H=A-this.transparency.indexed.length)>0)for(ne=0;0<=H?ne<H:ne>H;0<=H?++ne:--ne)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(x)[0];break;case 2:this.transparency.rgb=this.read(x)}break;case"tEXt":V=(J=this.read(x)).indexOf(0),R=String.fromCharCode.apply(String,J.slice(0,V)),this.text[R]=String.fromCharCode.apply(String,J.slice(V+1));break;case"IEND":return W&&this.animation.frames.push(W),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(de=this.colorType)===4||de===6,T=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*T,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=x}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}c.prototype.read=function(i){var x,T;for(T=[],x=0;0<=i?x<i:x>i;0<=i?++x:--x)T.push(this.data[this.pos++]);return T},c.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},c.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},c.prototype.decodePixels=function(i){var x=this.pixelBitlength/8,T=new Uint8Array(this.width*this.height*x),A=0,M=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function F(W,V,R,te){var H,J,K,ne,de,De,Fe,et,Te,ge,Ve,Ae,_e,xe,Qe,Ce,Ye,ut,st,pt,Tt,ht=Math.ceil((M.width-W)/R),Wt=Math.ceil((M.height-V)/te),ie=M.width==ht&&M.height==Wt;for(xe=x*ht,Ae=ie?T:new Uint8Array(xe*Wt),De=i.length,_e=0,J=0;_e<Wt&&A<De;){switch(i[A++]){case 0:for(ne=Ye=0;Ye<xe;ne=Ye+=1)Ae[J++]=i[A++];break;case 1:for(ne=ut=0;ut<xe;ne=ut+=1)H=i[A++],de=ne<x?0:Ae[J-x],Ae[J++]=(H+de)%256;break;case 2:for(ne=st=0;st<xe;ne=st+=1)H=i[A++],K=(ne-ne%x)/x,Qe=_e&&Ae[(_e-1)*xe+K*x+ne%x],Ae[J++]=(Qe+H)%256;break;case 3:for(ne=pt=0;pt<xe;ne=pt+=1)H=i[A++],K=(ne-ne%x)/x,de=ne<x?0:Ae[J-x],Qe=_e&&Ae[(_e-1)*xe+K*x+ne%x],Ae[J++]=(H+Math.floor((de+Qe)/2))%256;break;case 4:for(ne=Tt=0;Tt<xe;ne=Tt+=1)H=i[A++],K=(ne-ne%x)/x,de=ne<x?0:Ae[J-x],_e===0?Qe=Ce=0:(Qe=Ae[(_e-1)*xe+K*x+ne%x],Ce=K&&Ae[(_e-1)*xe+(K-1)*x+ne%x]),Fe=de+Qe-Ce,et=Math.abs(Fe-de),ge=Math.abs(Fe-Qe),Ve=Math.abs(Fe-Ce),Te=et<=ge&&et<=Ve?de:ge<=Ve?Qe:Ce,Ae[J++]=(H+Te)%256;break;default:throw new Error("Invalid filter algorithm: "+i[A-1])}if(!ie){var ye=((V+_e*te)*M.width+W)*x,pe=_e*xe;for(ne=0;ne<ht;ne+=1){for(var Ie=0;Ie<x;Ie+=1)T[ye++]=Ae[pe++];ye+=(R-1)*x}}_e++}}return i=y4(i),M.interlaceMethod==1?(F(0,0,8,8),F(4,0,8,8),F(0,4,4,8),F(2,0,4,4),F(0,2,2,4),F(1,0,2,2),F(0,1,1,2)):F(0,0,1,1),T},c.prototype.decodePalette=function(){var i,x,T,A,M,F,W,V,R;for(T=this.palette,F=this.transparency.indexed||[],M=new Uint8Array((F.length||0)+T.length),A=0,i=0,x=W=0,V=T.length;W<V;x=W+=3)M[A++]=T[x],M[A++]=T[x+1],M[A++]=T[x+2],M[A++]=(R=F[i++])!=null?R:255;return M},c.prototype.copyToImageData=function(i,x){var T,A,M,F,W,V,R,te,H,J,K;if(A=this.colors,H=null,T=this.hasAlphaChannel,this.palette.length&&(H=(K=this._decodedPalette)!=null?K:this._decodedPalette=this.decodePalette(),A=4,T=!0),te=(M=i.data||i).length,W=H||x,F=V=0,A===1)for(;F<te;)R=H?4*x[F/4]:V,J=W[R++],M[F++]=J,M[F++]=J,M[F++]=J,M[F++]=T?W[R++]:255,V=R;else for(;F<te;)R=H?4*x[F/4]:V,M[F++]=W[R++],M[F++]=W[R++],M[F++]=W[R++],M[F++]=T?W[R++]:255,V=R},c.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var f=function(){if(Object.prototype.toString.call(zr)==="[object Window]"){try{n=zr.document.createElement("canvas"),l=n.getContext("2d")}catch{return!1}return!0}return!1};return f(),a=function(i){var x;if(f()===!0)return l.width=i.width,l.height=i.height,l.clearRect(0,0,i.width,i.height),l.putImageData(i,0,0),(x=new Image).src=n.toDataURL(),x;throw new Error("This method requires a Browser with Canvas-capability.")},c.prototype.decodeFrames=function(i){var x,T,A,M,F,W,V,R;if(this.animation){for(R=[],T=F=0,W=(V=this.animation.frames).length;F<W;T=++F)x=V[T],A=i.createImageData(x.width,x.height),M=this.decodePixels(new Uint8Array(x.data)),this.copyToImageData(A,M),x.imageData=A,R.push(x.image=a(A));return R}},c.prototype.renderFrame=function(i,x){var T,A,M;return T=(A=this.animation.frames)[x],M=A[x-1],x===0&&i.clearRect(0,0,this.width,this.height),M?.disposeOp===1?i.clearRect(M.xOffset,M.yOffset,M.width,M.height):M?.disposeOp===2&&i.putImageData(M.imageData,M.xOffset,M.yOffset),T.blendOp===0&&i.clearRect(T.xOffset,T.yOffset,T.width,T.height),i.drawImage(T.image,T.xOffset,T.yOffset)},c.prototype.animate=function(i){var x,T,A,M,F,W,V=this;return T=0,W=this.animation,M=W.numFrames,A=W.frames,F=W.numPlays,(x=function(){var R,te;if(R=T++%M,te=A[R],V.renderFrame(i,R),M>1&&T/M<F)return V.animation._timeout=setTimeout(x,te.delay)})()},c.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},c.prototype.render=function(i){var x,T;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,x=i.getContext("2d"),this.animation?(this.decodeFrames(x),this.animate(x)):(T=x.createImageData(this.width,this.height),this.copyToImageData(T,this.decodePixels()),x.putImageData(T,0,0))},c}();(function(a){var n=function(){return typeof Nx=="function"},l=function(V,R,te,H){var J=4,K=x;switch(H){case a.image_compression.FAST:J=1,K=i;break;case a.image_compression.MEDIUM:J=6,K=T;break;case a.image_compression.SLOW:J=9,K=A}V=c(V,R,te,K);var ne=Nx(V,{level:J});return a.__addimage__.arrayBufferToBinaryString(ne)},c=function(V,R,te,H){for(var J,K,ne,de=V.length/R,De=new Uint8Array(V.length+de),Fe=F(),et=0;et<de;et+=1){if(ne=et*R,J=V.subarray(ne,ne+R),H)De.set(H(J,te,K),ne+et);else{for(var Te,ge=Fe.length,Ve=[];Te<ge;Te+=1)Ve[Te]=Fe[Te](J,te,K);var Ae=W(Ve.concat());De.set(Ve[Ae],ne+et)}K=J}return De},f=function(V){var R=Array.apply([],V);return R.unshift(0),R},i=function(V,R){var te,H=[],J=V.length;H[0]=1;for(var K=0;K<J;K+=1)te=V[K-R]||0,H[K+1]=V[K]-te+256&255;return H},x=function(V,R,te){var H,J=[],K=V.length;J[0]=2;for(var ne=0;ne<K;ne+=1)H=te&&te[ne]||0,J[ne+1]=V[ne]-H+256&255;return J},T=function(V,R,te){var H,J,K=[],ne=V.length;K[0]=3;for(var de=0;de<ne;de+=1)H=V[de-R]||0,J=te&&te[de]||0,K[de+1]=V[de]+256-(H+J>>>1)&255;return K},A=function(V,R,te){var H,J,K,ne,de=[],De=V.length;de[0]=4;for(var Fe=0;Fe<De;Fe+=1)H=V[Fe-R]||0,J=te&&te[Fe]||0,K=te&&te[Fe-R]||0,ne=M(H,J,K),de[Fe+1]=V[Fe]-ne+256&255;return de},M=function(V,R,te){if(V===R&&R===te)return V;var H=Math.abs(R-te),J=Math.abs(V-te),K=Math.abs(V+R-te-te);return H<=J&&H<=K?V:J<=K?R:te},F=function(){return[f,i,x,T,A]},W=function(V){var R=V.map(function(te){return te.reduce(function(H,J){return H+Math.abs(J)},0)});return R.indexOf(Math.min.apply(null,R))};a.processPNG=function(V,R,te,H){var J,K,ne,de,De,Fe,et,Te,ge,Ve,Ae,_e,xe,Qe,Ce,Ye=this.decode.FLATE_DECODE,ut="";if(this.__addimage__.isArrayBuffer(V)&&(V=new Uint8Array(V)),this.__addimage__.isArrayBufferView(V)){if(V=(ne=new z7(V)).imgData,K=ne.bits,J=ne.colorSpace,De=ne.colors,[4,6].indexOf(ne.colorType)!==-1){if(ne.bits===8){ge=(Te=ne.pixelBitlength==32?new Uint32Array(ne.decodePixels().buffer):ne.pixelBitlength==16?new Uint16Array(ne.decodePixels().buffer):new Uint8Array(ne.decodePixels().buffer)).length,Ae=new Uint8Array(ge*ne.colors),Ve=new Uint8Array(ge);var st,pt=ne.pixelBitlength-ne.bits;for(Qe=0,Ce=0;Qe<ge;Qe++){for(xe=Te[Qe],st=0;st<pt;)Ae[Ce++]=xe>>>st&255,st+=ne.bits;Ve[Qe]=xe>>>st&255}}if(ne.bits===16){ge=(Te=new Uint32Array(ne.decodePixels().buffer)).length,Ae=new Uint8Array(ge*(32/ne.pixelBitlength)*ne.colors),Ve=new Uint8Array(ge*(32/ne.pixelBitlength)),_e=ne.colors>1,Qe=0,Ce=0;for(var Tt=0;Qe<ge;)xe=Te[Qe++],Ae[Ce++]=xe>>>0&255,_e&&(Ae[Ce++]=xe>>>16&255,xe=Te[Qe++],Ae[Ce++]=xe>>>0&255),Ve[Tt++]=xe>>>16&255;K=8}H!==a.image_compression.NONE&&n()?(V=l(Ae,ne.width*ne.colors,ne.colors,H),et=l(Ve,ne.width,1,H)):(V=Ae,et=Ve,Ye=void 0)}if(ne.colorType===3&&(J=this.color_spaces.INDEXED,Fe=ne.palette,ne.transparency.indexed)){var ht=ne.transparency.indexed,Wt=0;for(Qe=0,ge=ht.length;Qe<ge;++Qe)Wt+=ht[Qe];if((Wt/=255)===ge-1&&ht.indexOf(0)!==-1)de=[ht.indexOf(0)];else if(Wt!==ge){for(Te=ne.decodePixels(),Ve=new Uint8Array(Te.length),Qe=0,ge=Te.length;Qe<ge;Qe++)Ve[Qe]=ht[Te[Qe]];et=l(Ve,ne.width,1)}}var ie=function(ye){var pe;switch(ye){case a.image_compression.FAST:pe=11;break;case a.image_compression.MEDIUM:pe=13;break;case a.image_compression.SLOW:pe=14;break;default:pe=12}return pe}(H);return Ye===this.decode.FLATE_DECODE&&(ut="/Predictor "+ie+" "),ut+="/Colors "+De+" /BitsPerComponent "+K+" /Columns "+ne.width,(this.__addimage__.isArrayBuffer(V)||this.__addimage__.isArrayBufferView(V))&&(V=this.__addimage__.arrayBufferToBinaryString(V)),(et&&this.__addimage__.isArrayBuffer(et)||this.__addimage__.isArrayBufferView(et))&&(et=this.__addimage__.arrayBufferToBinaryString(et)),{alias:te,data:V,index:R,filter:Ye,decodeParameters:ut,transparency:de,palette:Fe,sMask:et,predictor:ie,width:ne.width,height:ne.height,bitsPerComponent:K,colorSpace:J}}}})(Lr.API),function(a){a.processGIF89A=function(n,l,c,f){var i=new j7(n),x=i.width,T=i.height,A=[];i.decodeAndBlitFrameRGBA(0,A);var M={data:A,width:x,height:T},F=new F2(100).encode(M,100);return a.processJPEG.call(this,F,l,c,f)},a.processGIF87A=a.processGIF89A}(Lr.API),rh.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var a=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(a);for(var n=0;n<a;n++){var l=this.datav.getUint8(this.pos++,!0),c=this.datav.getUint8(this.pos++,!0),f=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[n]={red:f,green:c,blue:l,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},rh.prototype.parseBGR=function(){this.pos=this.offset;try{var a="bit"+this.bitPP,n=this.width*this.height*4;this.data=new Uint8Array(n),this[a]()}catch(l){Pa.log("bit decode error:"+l)}},rh.prototype.bit1=function(){var a,n=Math.ceil(this.width/8),l=n%4;for(a=this.height-1;a>=0;a--){for(var c=this.bottom_up?a:this.height-1-a,f=0;f<n;f++)for(var i=this.datav.getUint8(this.pos++,!0),x=c*this.width*4+8*f*4,T=0;T<8&&8*f+T<this.width;T++){var A=this.palette[i>>7-T&1];this.data[x+4*T]=A.blue,this.data[x+4*T+1]=A.green,this.data[x+4*T+2]=A.red,this.data[x+4*T+3]=255}l!==0&&(this.pos+=4-l)}},rh.prototype.bit4=function(){for(var a=Math.ceil(this.width/2),n=a%4,l=this.height-1;l>=0;l--){for(var c=this.bottom_up?l:this.height-1-l,f=0;f<a;f++){var i=this.datav.getUint8(this.pos++,!0),x=c*this.width*4+2*f*4,T=i>>4,A=15&i,M=this.palette[T];if(this.data[x]=M.blue,this.data[x+1]=M.green,this.data[x+2]=M.red,this.data[x+3]=255,2*f+1>=this.width)break;M=this.palette[A],this.data[x+4]=M.blue,this.data[x+4+1]=M.green,this.data[x+4+2]=M.red,this.data[x+4+3]=255}n!==0&&(this.pos+=4-n)}},rh.prototype.bit8=function(){for(var a=this.width%4,n=this.height-1;n>=0;n--){for(var l=this.bottom_up?n:this.height-1-n,c=0;c<this.width;c++){var f=this.datav.getUint8(this.pos++,!0),i=l*this.width*4+4*c;if(f<this.palette.length){var x=this.palette[f];this.data[i]=x.red,this.data[i+1]=x.green,this.data[i+2]=x.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}a!==0&&(this.pos+=4-a)}},rh.prototype.bit15=function(){for(var a=this.width%3,n=parseInt("11111",2),l=this.height-1;l>=0;l--){for(var c=this.bottom_up?l:this.height-1-l,f=0;f<this.width;f++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var x=(i&n)/n*255|0,T=(i>>5&n)/n*255|0,A=(i>>10&n)/n*255|0,M=i>>15?255:0,F=c*this.width*4+4*f;this.data[F]=A,this.data[F+1]=T,this.data[F+2]=x,this.data[F+3]=M}this.pos+=a}},rh.prototype.bit16=function(){for(var a=this.width%3,n=parseInt("11111",2),l=parseInt("111111",2),c=this.height-1;c>=0;c--){for(var f=this.bottom_up?c:this.height-1-c,i=0;i<this.width;i++){var x=this.datav.getUint16(this.pos,!0);this.pos+=2;var T=(x&n)/n*255|0,A=(x>>5&l)/l*255|0,M=(x>>11)/n*255|0,F=f*this.width*4+4*i;this.data[F]=M,this.data[F+1]=A,this.data[F+2]=T,this.data[F+3]=255}this.pos+=a}},rh.prototype.bit24=function(){for(var a=this.height-1;a>=0;a--){for(var n=this.bottom_up?a:this.height-1-a,l=0;l<this.width;l++){var c=this.datav.getUint8(this.pos++,!0),f=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),x=n*this.width*4+4*l;this.data[x]=i,this.data[x+1]=f,this.data[x+2]=c,this.data[x+3]=255}this.pos+=this.width%4}},rh.prototype.bit32=function(){for(var a=this.height-1;a>=0;a--)for(var n=this.bottom_up?a:this.height-1-a,l=0;l<this.width;l++){var c=this.datav.getUint8(this.pos++,!0),f=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),x=this.datav.getUint8(this.pos++,!0),T=n*this.width*4+4*l;this.data[T]=i,this.data[T+1]=f,this.data[T+2]=c,this.data[T+3]=x}},rh.prototype.getData=function(){return this.data},function(a){a.processBMP=function(n,l,c,f){var i=new rh(n,!1),x=i.width,T=i.height,A={data:i.getData(),width:x,height:T},M=new F2(100).encode(A,100);return a.processJPEG.call(this,M,l,c,f)}}(Lr.API),N4.prototype.getData=function(){return this.data},function(a){a.processWEBP=function(n,l,c,f){var i=new N4(n,!1),x=i.width,T=i.height,A={data:i.getData(),width:x,height:T},M=new F2(100).encode(A,100);return a.processJPEG.call(this,M,l,c,f)}}(Lr.API),Lr.API.processRGBA=function(a,n,l){for(var c=a.data,f=c.length,i=new Uint8Array(f/4*3),x=new Uint8Array(f/4),T=0,A=0,M=0;M<f;M+=4){var F=c[M],W=c[M+1],V=c[M+2],R=c[M+3];i[T++]=F,i[T++]=W,i[T++]=V,x[A++]=R}var te=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(x),data:te,index:n,alias:l,colorSpace:"DeviceRGB",bitsPerComponent:8,width:a.width,height:a.height}},Lr.API.setLanguage=function(a){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[a]!==void 0&&(this.internal.languageSettings.languageCode=a,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},E0=Lr.API,Vx=E0.getCharWidthsArray=function(a,n){var l,c,f=(n=n||{}).font||this.internal.getFont(),i=n.fontSize||this.internal.getFontSize(),x=n.charSpace||this.internal.getCharSpace(),T=n.widths?n.widths:f.metadata.Unicode.widths,A=T.fof?T.fof:1,M=n.kerning?n.kerning:f.metadata.Unicode.kerning,F=M.fof?M.fof:1,W=n.doKerning!==!1,V=0,R=a.length,te=0,H=T[0]||A,J=[];for(l=0;l<R;l++)c=a.charCodeAt(l),typeof f.metadata.widthOfString=="function"?J.push((f.metadata.widthOfGlyph(f.metadata.characterToGlyph(c))+x*(1e3/i)||0)/1e3):(V=W&&(0,Ia.default)(M[c])==="object"&&!isNaN(parseInt(M[c][te],10))?M[c][te]/F:0,J.push((T[c]||H)/A+V)),te=c;return J},P4=E0.getStringUnitWidth=function(a,n){var l=(n=n||{}).fontSize||this.internal.getFontSize(),c=n.font||this.internal.getFont(),f=n.charSpace||this.internal.getCharSpace();return E0.processArabic&&(a=E0.processArabic(a)),typeof c.metadata.widthOfString=="function"?c.metadata.widthOfString(a,l,f)/l:Vx.apply(this,arguments).reduce(function(i,x){return i+x},0)},L4=function(a,n,l,c){for(var f=[],i=0,x=a.length,T=0;i!==x&&T+n[i]<l;)T+=n[i],i++;f.push(a.slice(0,i));var A=i;for(T=0;i!==x;)T+n[i]>c&&(f.push(a.slice(A,i)),T=0,A=i),T+=n[i],i++;return A!==i&&f.push(a.slice(A,i)),f},R4=function(a,n,l){l||(l={});var c,f,i,x,T,A,M,F=[],W=[F],V=l.textIndent||0,R=0,te=0,H=a.split(" "),J=Vx.apply(this,[" ",l])[0];if(A=l.lineIndent===-1?H[0].length+2:l.lineIndent||0){var K=Array(A).join(" "),ne=[];H.map(function(De){(De=De.split(/\s*\n/)).length>1?ne=ne.concat(De.map(function(Fe,et){return(et&&Fe.length?`
`:"")+Fe})):ne.push(De[0])}),H=ne,A=P4.apply(this,[K,l])}for(i=0,x=H.length;i<x;i++){var de=0;if(c=H[i],A&&c[0]==`
`&&(c=c.substr(1),de=1),V+R+(te=(f=Vx.apply(this,[c,l])).reduce(function(De,Fe){return De+Fe},0))>n||de){if(te>n){for(T=L4.apply(this,[c,f,n-(V+R),n]),F.push(T.shift()),F=[T.pop()];T.length;)W.push([T.shift()]);te=f.slice(c.length-(F[0]?F[0].length:0)).reduce(function(De,Fe){return De+Fe},0)}else F=[c];W.push(F),V=te+A,R=J}else F.push(c),V+=R+te,R=J}return M=A?function(De,Fe){return(Fe?K:"")+De.join(" ")}:function(De){return De.join(" ")},W.map(M)},E0.splitTextToSize=function(a,n,l){var c,f=(l=l||{}).fontSize||this.internal.getFontSize(),i=(function(F){if(F.widths&&F.kerning)return{widths:F.widths,kerning:F.kerning};var W=this.internal.getFont(F.fontName,F.fontStyle);return W.metadata.Unicode?{widths:W.metadata.Unicode.widths||{0:1},kerning:W.metadata.Unicode.kerning||{}}:{font:W.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,l);c=Array.isArray(a)?a:String(a).split(/\r?\n/);var x=1*this.internal.scaleFactor*n/f;i.textIndent=l.textIndent?1*l.textIndent*this.internal.scaleFactor/f:0,i.lineIndent=l.lineIndent;var T,A,M=[];for(T=0,A=c.length;T<A;T++)M=M.concat(R4.apply(this,[c[T],x,i]));return M},function(a){a.__fontmetrics__=a.__fontmetrics__||{};for(var n="klmnopqrstuvwxyz",l={},c={},f=0;f<n.length;f++)l[n[f]]="0123456789abcdef"[f],c["0123456789abcdef"[f]]=n[f];var i=function(W){return"0x"+parseInt(W,10).toString(16)},x=a.__fontmetrics__.compress=function(W){var V,R,te,H,J=["{"];for(var K in W){if(V=W[K],isNaN(parseInt(K,10))?R="'"+K+"'":(K=parseInt(K,10),R=(R=i(K).slice(2)).slice(0,-1)+c[R.slice(-1)]),typeof V=="number")V<0?(te=i(V).slice(3),H="-"):(te=i(V).slice(2),H=""),te=H+te.slice(0,-1)+c[te.slice(-1)];else{if((0,Ia.default)(V)!=="object")throw new Error("Don't know what to do with value type "+(0,Ia.default)(V)+".");te=x(V)}J.push(R+te)}return J.push("}"),J.join("")},T=a.__fontmetrics__.uncompress=function(W){if(typeof W!="string")throw new Error("Invalid argument passed to uncompress.");for(var V,R,te,H,J={},K=1,ne=J,de=[],De="",Fe="",et=W.length-1,Te=1;Te<et;Te+=1)(H=W[Te])=="'"?V?(te=V.join(""),V=void 0):V=[]:V?V.push(H):H=="{"?(de.push([ne,te]),ne={},te=void 0):H=="}"?((R=de.pop())[0][R[1]]=ne,te=void 0,ne=R[0]):H=="-"?K=-1:te===void 0?l.hasOwnProperty(H)?(De+=l[H],te=parseInt(De,16)*K,K=1,De=""):De+=H:l.hasOwnProperty(H)?(Fe+=l[H],ne[te]=parseInt(Fe,16)*K,K=1,te=void 0,Fe=""):Fe+=H;return J},A={codePages:["WinAnsiEncoding"],WinAnsiEncoding:T("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},M={Unicode:{Courier:A,"Courier-Bold":A,"Courier-BoldOblique":A,"Courier-Oblique":A,Helvetica:A,"Helvetica-Bold":A,"Helvetica-BoldOblique":A,"Helvetica-Oblique":A,"Times-Roman":A,"Times-Bold":A,"Times-BoldItalic":A,"Times-Italic":A}},F={Unicode:{"Courier-Oblique":T("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":T("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":T("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:T("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":T("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":T("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:T("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:T("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":T("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:T("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":T("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":T("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":T("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":T("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};a.events.push(["addFont",function(W){var V=W.font,R=F.Unicode[V.postScriptName];R&&(V.metadata.Unicode={},V.metadata.Unicode.widths=R.widths,V.metadata.Unicode.kerning=R.kerning);var te=M.Unicode[V.postScriptName];te&&(V.metadata.Unicode.encoding=te,V.encoding=te.codePages[0])}])}(Lr.API),function(a){var n=function(l){for(var c=l.length,f=new Uint8Array(c),i=0;i<c;i++)f[i]=l.charCodeAt(i);return f};a.API.events.push(["addFont",function(l){var c=void 0,f=l.font,i=l.instance;if(!f.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+f.postScriptName+"').");if(typeof(c=i.existsFileInVFS(f.postScriptName)===!1?i.loadFile(f.postScriptName):i.getFileFromVFS(f.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+f.postScriptName+"').");(function(x,T){T=/^\x00\x01\x00\x00/.test(T)?n(T):n(e_(T)),x.metadata=a.API.TTFFont.open(T),x.metadata.Unicode=x.metadata.Unicode||{encoding:{},kerning:{},widths:[]},x.metadata.glyIdsUsed=[0]})(f,c)}}])}(Lr),function(a){function n(){return(zr.canvg?Promise.resolve(zr.canvg):import("./chunk-EBGJXE4G.mjs")).catch(function(l){return Promise.reject(new Error("Could not load canvg: "+l))}).then(function(l){return l.default?l.default:l})}Lr.API.addSvgAsImage=function(l,c,f,i,x,T,A,M){if(isNaN(c)||isNaN(f))throw Pa.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(x))throw Pa.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var F=document.createElement("canvas");F.width=i,F.height=x;var W=F.getContext("2d");W.fillStyle="#fff",W.fillRect(0,0,F.width,F.height);var V={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},R=this;return n().then(function(te){return te.fromString(W,l,V)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(te){return te.render(V)}).then(function(){R.addImage(F.toDataURL("image/jpeg",1),c,f,i,x,A,M)})}}(),Lr.API.putTotalPages=function(a){var n,l=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(n=new RegExp(a,"g"),l=this.internal.getNumberOfPages()):(n=new RegExp(this.pdfEscape16(a,this.internal.getFont()),"g"),l=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var c=1;c<=this.internal.getNumberOfPages();c++)for(var f=0;f<this.internal.pages[c].length;f++)this.internal.pages[c][f]=this.internal.pages[c][f].replace(n,l);return this},Lr.API.viewerPreferences=function(a,n){var l;a=a||{},n=n||!1;var c,f,i,x={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},T=Object.keys(x),A=[],M=0,F=0,W=0;function V(te,H){var J,K=!1;for(J=0;J<te.length;J+=1)te[J]===H&&(K=!0);return K}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(x)),this.internal.viewerpreferences.isSubscribed=!1),l=this.internal.viewerpreferences.configuration,a==="reset"||n===!0){var R=T.length;for(W=0;W<R;W+=1)l[T[W]].value=l[T[W]].defaultValue,l[T[W]].explicitSet=!1}if((0,Ia.default)(a)==="object"){for(f in a)if(i=a[f],V(T,f)&&i!==void 0){if(l[f].type==="boolean"&&typeof i=="boolean")l[f].value=i;else if(l[f].type==="name"&&V(l[f].valueSet,i))l[f].value=i;else if(l[f].type==="integer"&&Number.isInteger(i))l[f].value=i;else if(l[f].type==="array"){for(M=0;M<i.length;M+=1)if(c=!0,i[M].length===1&&typeof i[M][0]=="number")A.push(String(i[M]-1));else if(i[M].length>1){for(F=0;F<i[M].length;F+=1)typeof i[M][F]!="number"&&(c=!1);c===!0&&A.push([i[M][0]-1,i[M][1]-1].join(" "))}l[f].value="["+A.join(" ")+"]"}else l[f].value=l[f].defaultValue;l[f].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var te,H=[];for(te in l)l[te].explicitSet===!0&&(l[te].type==="name"?H.push("/"+te+" /"+l[te].value):H.push("/"+te+" "+l[te].value));H.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+H.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=l,this},function(a){var n=function(){var c='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',f=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(c)),x=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),T=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),A=unescape(encodeURIComponent("</x:xmpmeta>")),M=i.length+x.length+T.length+f.length+A.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+M+" >>"),this.internal.write("stream"),this.internal.write(f+i+x+T+A),this.internal.write("endstream"),this.internal.write("endobj")},l=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};a.addMetadata=function(c,f){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:c,namespaceuri:f||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",l),this.internal.events.subscribe("postPutResources",n)),this}}(Lr.API),function(a){var n=a.API,l=n.pdfEscape16=function(i,x){for(var T,A=x.metadata.Unicode.widths,M=["","0","00","000","0000"],F=[""],W=0,V=i.length;W<V;++W){if(T=x.metadata.characterToGlyph(i.charCodeAt(W)),x.metadata.glyIdsUsed.push(T),x.metadata.toUnicode[T]=i.charCodeAt(W),A.indexOf(T)==-1&&(A.push(T),A.push([parseInt(x.metadata.widthOfGlyph(T),10)])),T=="0")return F.join("");T=T.toString(16),F.push(M[4-T.length],T)}return F.join("")},c=function(i){var x,T,A,M,F,W,V;for(F=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,A=[],W=0,V=(T=Object.keys(i).sort(function(R,te){return R-te})).length;W<V;W++)x=T[W],A.length>=100&&(F+=`
`+A.length+` beginbfchar
`+A.join(`
`)+`
endbfchar`,A=[]),i[x]!==void 0&&i[x]!==null&&typeof i[x].toString=="function"&&(M=("0000"+i[x].toString(16)).slice(-4),x=("0000"+(+x).toString(16)).slice(-4),A.push("<"+x+"><"+M+">"));return A.length&&(F+=`
`+A.length+` beginbfchar
`+A.join(`
`)+`
endbfchar
`),F+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};n.events.push(["putFont",function(i){(function(x){var T=x.font,A=x.out,M=x.newObject,F=x.putStream;if(T.metadata instanceof a.API.TTFFont&&T.encoding==="Identity-H"){for(var W=T.metadata.Unicode.widths,V=T.metadata.subset.encode(T.metadata.glyIdsUsed,1),R="",te=0;te<V.length;te++)R+=String.fromCharCode(V[te]);var H=M();F({data:R,addLength1:!0,objectId:H}),A("endobj");var J=M();F({data:c(T.metadata.toUnicode),addLength1:!0,objectId:J}),A("endobj");var K=M();A("<<"),A("/Type /FontDescriptor"),A("/FontName /"+C0(T.fontName)),A("/FontFile2 "+H+" 0 R"),A("/FontBBox "+a.API.PDFObject.convert(T.metadata.bbox)),A("/Flags "+T.metadata.flags),A("/StemV "+T.metadata.stemV),A("/ItalicAngle "+T.metadata.italicAngle),A("/Ascent "+T.metadata.ascender),A("/Descent "+T.metadata.decender),A("/CapHeight "+T.metadata.capHeight),A(">>"),A("endobj");var ne=M();A("<<"),A("/Type /Font"),A("/BaseFont /"+C0(T.fontName)),A("/FontDescriptor "+K+" 0 R"),A("/W "+a.API.PDFObject.convert(W)),A("/CIDToGIDMap /Identity"),A("/DW 1000"),A("/Subtype /CIDFontType2"),A("/CIDSystemInfo"),A("<<"),A("/Supplement 0"),A("/Registry (Adobe)"),A("/Ordering ("+T.encoding+")"),A(">>"),A(">>"),A("endobj"),T.objectNumber=M(),A("<<"),A("/Type /Font"),A("/Subtype /Type0"),A("/ToUnicode "+J+" 0 R"),A("/BaseFont /"+C0(T.fontName)),A("/Encoding /"+T.encoding),A("/DescendantFonts ["+ne+" 0 R]"),A(">>"),A("endobj"),T.isAlreadyPutted=!0}})(i)}]),n.events.push(["putFont",function(i){(function(x){var T=x.font,A=x.out,M=x.newObject,F=x.putStream;if(T.metadata instanceof a.API.TTFFont&&T.encoding==="WinAnsiEncoding"){for(var W=T.metadata.rawData,V="",R=0;R<W.length;R++)V+=String.fromCharCode(W[R]);var te=M();F({data:V,addLength1:!0,objectId:te}),A("endobj");var H=M();F({data:c(T.metadata.toUnicode),addLength1:!0,objectId:H}),A("endobj");var J=M();A("<<"),A("/Descent "+T.metadata.decender),A("/CapHeight "+T.metadata.capHeight),A("/StemV "+T.metadata.stemV),A("/Type /FontDescriptor"),A("/FontFile2 "+te+" 0 R"),A("/Flags 96"),A("/FontBBox "+a.API.PDFObject.convert(T.metadata.bbox)),A("/FontName /"+C0(T.fontName)),A("/ItalicAngle "+T.metadata.italicAngle),A("/Ascent "+T.metadata.ascender),A(">>"),A("endobj"),T.objectNumber=M();for(var K=0;K<T.metadata.hmtx.widths.length;K++)T.metadata.hmtx.widths[K]=parseInt(T.metadata.hmtx.widths[K]*(1e3/T.metadata.head.unitsPerEm));A("<</Subtype/TrueType/Type/Font/ToUnicode "+H+" 0 R/BaseFont/"+C0(T.fontName)+"/FontDescriptor "+J+" 0 R/Encoding/"+T.encoding+" /FirstChar 29 /LastChar 255 /Widths "+a.API.PDFObject.convert(T.metadata.hmtx.widths)+">>"),A("endobj"),T.isAlreadyPutted=!0}})(i)}]);var f=function(i){var x,T=i.text||"",A=i.x,M=i.y,F=i.options||{},W=i.mutex||{},V=W.pdfEscape,R=W.activeFontKey,te=W.fonts,H=R,J="",K=0,ne="",de=te[H].encoding;if(te[H].encoding!=="Identity-H")return{text:T,x:A,y:M,options:F,mutex:W};for(ne=T,H=R,Array.isArray(T)&&(ne=T[0]),K=0;K<ne.length;K+=1)te[H].metadata.hasOwnProperty("cmap")&&(x=te[H].metadata.cmap.unicode.codeMap[ne[K].charCodeAt(0)]),x||ne[K].charCodeAt(0)<256&&te[H].metadata.hasOwnProperty("Unicode")?J+=ne[K]:J+="";var De="";return parseInt(H.slice(1))<14||de==="WinAnsiEncoding"?De=V(J,H).split("").map(function(Fe){return Fe.charCodeAt(0).toString(16)}).join(""):de==="Identity-H"&&(De=l(J,te[H])),W.isHex=!0,{text:De,x:A,y:M,options:F,mutex:W}};n.events.push(["postProcessText",function(i){var x=i.text||"",T=[],A={text:x,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(x)){var M=0;for(M=0;M<x.length;M+=1)Array.isArray(x[M])&&x[M].length===3?T.push([f(Object.assign({},A,{text:x[M][0]})).text,x[M][1],x[M][2]]):T.push(f(Object.assign({},A,{text:x[M]})).text);i.text=T}else i.text=f(Object.assign({},A,{text:x})).text}])}(Lr),function(a){var n=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};a.existsFileInVFS=function(l){return n.call(this),this.internal.vFS[l]!==void 0},a.addFileToVFS=function(l,c){return n.call(this),this.internal.vFS[l]=c,this},a.getFileFromVFS=function(l){return n.call(this),this.internal.vFS[l]!==void 0?this.internal.vFS[l]:null}}(Lr.API),function(a){a.__bidiEngine__=a.prototype.__bidiEngine__=function(c){var f,i,x,T,A,M,F,W=n,V=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],R=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],te={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},H={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},J=["(",")","(","<",">","<","[","]","[","{","}","{","\xAB","\xBB","\xAB","\u2039","\u203A","\u2039","\u2045","\u2046","\u2045","\u207D","\u207E","\u207D","\u208D","\u208E","\u208D","\u2264","\u2265","\u2264","\u2329","\u232A","\u2329","\uFE59","\uFE5A","\uFE59","\uFE5B","\uFE5C","\uFE5B","\uFE5D","\uFE5E","\uFE5D","\uFE64","\uFE65","\uFE64"],K=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),ne=!1,de=0;this.__bidiEngine__={};var De=function(_e){var xe=_e.charCodeAt(),Qe=xe>>8,Ce=H[Qe];return Ce!==void 0?W[256*Ce+(255&xe)]:Qe===252||Qe===253?"AL":K.test(Qe)?"L":Qe===8?"R":"N"},Fe=function(_e){for(var xe,Qe=0;Qe<_e.length;Qe++){if((xe=De(_e.charAt(Qe)))==="L")return!1;if(xe==="R")return!0}return!1},et=function(_e,xe,Qe,Ce){var Ye,ut,st,pt,Tt=xe[Ce];switch(Tt){case"L":case"R":ne=!1;break;case"N":case"AN":break;case"EN":ne&&(Tt="AN");break;case"AL":ne=!0,Tt="R";break;case"WS":Tt="N";break;case"CS":Ce<1||Ce+1>=xe.length||(Ye=Qe[Ce-1])!=="EN"&&Ye!=="AN"||(ut=xe[Ce+1])!=="EN"&&ut!=="AN"?Tt="N":ne&&(ut="AN"),Tt=ut===Ye?ut:"N";break;case"ES":Tt=(Ye=Ce>0?Qe[Ce-1]:"B")==="EN"&&Ce+1<xe.length&&xe[Ce+1]==="EN"?"EN":"N";break;case"ET":if(Ce>0&&Qe[Ce-1]==="EN"){Tt="EN";break}if(ne){Tt="N";break}for(st=Ce+1,pt=xe.length;st<pt&&xe[st]==="ET";)st++;Tt=st<pt&&xe[st]==="EN"?"EN":"N";break;case"NSM":if(x&&!T){for(pt=xe.length,st=Ce+1;st<pt&&xe[st]==="NSM";)st++;if(st<pt){var ht=_e[Ce],Wt=ht>=1425&&ht<=2303||ht===64286;if(Ye=xe[st],Wt&&(Ye==="R"||Ye==="AL")){Tt="R";break}}}Tt=Ce<1||(Ye=xe[Ce-1])==="B"?"N":Qe[Ce-1];break;case"B":ne=!1,f=!0,Tt=de;break;case"S":i=!0,Tt="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":ne=!1;break;case"BN":Tt="N"}return Tt},Te=function(_e,xe,Qe){var Ce=_e.split("");return Qe&&ge(Ce,Qe,{hiLevel:de}),Ce.reverse(),xe&&xe.reverse(),Ce.join("")},ge=function(_e,xe,Qe){var Ce,Ye,ut,st,pt,Tt=-1,ht=_e.length,Wt=0,ie=[],ye=de?R:V,pe=[];for(ne=!1,f=!1,i=!1,Ye=0;Ye<ht;Ye++)pe[Ye]=De(_e[Ye]);for(ut=0;ut<ht;ut++){if(pt=Wt,ie[ut]=et(_e,pe,ie,ut),Ce=240&(Wt=ye[pt][te[ie[ut]]]),Wt&=15,xe[ut]=st=ye[Wt][5],Ce>0)if(Ce===16){for(Ye=Tt;Ye<ut;Ye++)xe[Ye]=1;Tt=-1}else Tt=-1;if(ye[Wt][6])Tt===-1&&(Tt=ut);else if(Tt>-1){for(Ye=Tt;Ye<ut;Ye++)xe[Ye]=st;Tt=-1}pe[ut]==="B"&&(xe[ut]=0),Qe.hiLevel|=st}i&&function(Ie,Ue,gt){for(var mt=0;mt<gt;mt++)if(Ie[mt]==="S"){Ue[mt]=de;for(var wt=mt-1;wt>=0&&Ie[wt]==="WS";wt--)Ue[wt]=de}}(pe,xe,ht)},Ve=function(_e,xe,Qe,Ce,Ye){if(!(Ye.hiLevel<_e)){if(_e===1&&de===1&&!f)return xe.reverse(),void(Qe&&Qe.reverse());for(var ut,st,pt,Tt,ht=xe.length,Wt=0;Wt<ht;){if(Ce[Wt]>=_e){for(pt=Wt+1;pt<ht&&Ce[pt]>=_e;)pt++;for(Tt=Wt,st=pt-1;Tt<st;Tt++,st--)ut=xe[Tt],xe[Tt]=xe[st],xe[st]=ut,Qe&&(ut=Qe[Tt],Qe[Tt]=Qe[st],Qe[st]=ut);Wt=pt}Wt++}}},Ae=function(_e,xe,Qe){var Ce=_e.split(""),Ye={hiLevel:de};return Qe||(Qe=[]),ge(Ce,Qe,Ye),function(ut,st,pt){if(pt.hiLevel!==0&&F)for(var Tt,ht=0;ht<ut.length;ht++)st[ht]===1&&(Tt=J.indexOf(ut[ht]))>=0&&(ut[ht]=J[Tt+1])}(Ce,Qe,Ye),Ve(2,Ce,xe,Qe,Ye),Ve(1,Ce,xe,Qe,Ye),Ce.join("")};return this.__bidiEngine__.doBidiReorder=function(_e,xe,Qe){if(function(Ye,ut){if(ut)for(var st=0;st<Ye.length;st++)ut[st]=st;T===void 0&&(T=Fe(Ye)),M===void 0&&(M=Fe(Ye))}(_e,xe),x||!A||M)if(x&&A&&T^M)de=T?1:0,_e=Te(_e,xe,Qe);else if(!x&&A&&M)de=T?1:0,_e=Ae(_e,xe,Qe),_e=Te(_e,xe);else if(!x||T||A||M){if(x&&!A&&T^M)_e=Te(_e,xe),T?(de=0,_e=Ae(_e,xe,Qe)):(de=1,_e=Ae(_e,xe,Qe),_e=Te(_e,xe));else if(x&&T&&!A&&M)de=1,_e=Ae(_e,xe,Qe),_e=Te(_e,xe);else if(!x&&!A&&T^M){var Ce=F;T?(de=1,_e=Ae(_e,xe,Qe),de=0,F=!1,_e=Ae(_e,xe,Qe),F=Ce):(de=0,_e=Ae(_e,xe,Qe),_e=Te(_e,xe),de=1,F=!1,_e=Ae(_e,xe,Qe),F=Ce,_e=Te(_e,xe))}}else de=0,_e=Ae(_e,xe,Qe);else de=T?1:0,_e=Ae(_e,xe,Qe);return _e},this.__bidiEngine__.setOptions=function(_e){_e&&(x=_e.isInputVisual,A=_e.isOutputVisual,T=_e.isInputRtl,M=_e.isOutputRtl,F=_e.isSymmetricSwapping)},this.__bidiEngine__.setOptions(c),this.__bidiEngine__};var n=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],l=new a.__bidiEngine__({isInputVisual:!0});a.API.events.push(["postProcessText",function(c){var f=c.text,i=(c.x,c.y,c.options||{}),x=(c.mutex,i.lang,[]);if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,l.setOptions(i),Object.prototype.toString.call(f)==="[object Array]"){var T=0;for(x=[],T=0;T<f.length;T+=1)Object.prototype.toString.call(f[T])==="[object Array]"?x.push([l.doBidiReorder(f[T][0]),f[T][1],f[T][2]]):x.push([l.doBidiReorder(f[T])]);c.text=x}else c.text=l.doBidiReorder(f);l.setOptions({isInputVisual:!0})}])}(Lr),Lr.API.TTFFont=function(){function a(n){var l;if(this.rawData=n,l=this.contents=new Jf(n),this.contents.pos=4,l.readString(4)==="ttcf")throw new Error("TTCF not supported.");l.pos=0,this.parse(),this.subset=new tj(this),this.registerTTF()}return a.open=function(n){return new a(n)},a.prototype.parse=function(){return this.directory=new V7(this.contents),this.head=new H7(this),this.name=new X7(this),this.cmap=new Z4(this),this.toUnicode={},this.hhea=new G7(this),this.maxp=new Z7(this),this.hmtx=new Y7(this),this.post=new q7(this),this.os2=new W7(this),this.loca=new ej(this),this.glyf=new K7(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},a.prototype.registerTTF=function(){var n,l,c,f,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var x,T,A,M;for(M=[],x=0,T=(A=this.bbox).length;x<T;x++)n=A[x],M.push(Math.round(n*this.scaleFactor));return M}).call(this),this.stemV=0,this.post.exists?(c=255&(f=this.post.italic_angle),32768&(l=f>>16)&&(l=-(1+(65535^l))),this.italicAngle=+(l+"."+c)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},a.prototype.characterToGlyph=function(n){var l;return((l=this.cmap.unicode)!=null?l.codeMap[n]:void 0)||0},a.prototype.widthOfGlyph=function(n){var l;return l=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(n).advance*l},a.prototype.widthOfString=function(n,l,c){var f,i,x,T;for(x=0,i=0,T=(n=""+n).length;0<=T?i<T:i>T;i=0<=T?++i:--i)f=n.charCodeAt(i),x+=this.widthOfGlyph(this.characterToGlyph(f))+c*(1e3/l)||0;return x*(l/1e3)},a.prototype.lineHeight=function(n,l){var c;return l==null&&(l=!1),c=l?this.lineGap:0,(this.ascender+c-this.decender)/1e3*n},a}();Jf=function(){function a(n){this.data=n??[],this.pos=0,this.length=this.data.length}return a.prototype.readByte=function(){return this.data[this.pos++]},a.prototype.writeByte=function(n){return this.data[this.pos++]=n},a.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},a.prototype.writeUInt32=function(n){return this.writeByte(n>>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},a.prototype.readInt32=function(){var n;return(n=this.readUInt32())>=2147483648?n-4294967296:n},a.prototype.writeInt32=function(n){return n<0&&(n+=4294967296),this.writeUInt32(n)},a.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},a.prototype.writeUInt16=function(n){return this.writeByte(n>>8&255),this.writeByte(255&n)},a.prototype.readInt16=function(){var n;return(n=this.readUInt16())>=32768?n-65536:n},a.prototype.writeInt16=function(n){return n<0&&(n+=65536),this.writeUInt16(n)},a.prototype.readString=function(n){var l,c;for(c=[],l=0;0<=n?l<n:l>n;l=0<=n?++l:--l)c[l]=String.fromCharCode(this.readByte());return c.join("")},a.prototype.writeString=function(n){var l,c,f;for(f=[],l=0,c=n.length;0<=c?l<c:l>c;l=0<=c?++l:--l)f.push(this.writeByte(n.charCodeAt(l)));return f},a.prototype.readShort=function(){return this.readInt16()},a.prototype.writeShort=function(n){return this.writeInt16(n)},a.prototype.readLongLong=function(){var n,l,c,f,i,x,T,A;return n=this.readByte(),l=this.readByte(),c=this.readByte(),f=this.readByte(),i=this.readByte(),x=this.readByte(),T=this.readByte(),A=this.readByte(),128&n?-1*(72057594037927940*(255^n)+281474976710656*(255^l)+1099511627776*(255^c)+4294967296*(255^f)+16777216*(255^i)+65536*(255^x)+256*(255^T)+(255^A)+1):72057594037927940*n+281474976710656*l+1099511627776*c+4294967296*f+16777216*i+65536*x+256*T+A},a.prototype.writeLongLong=function(n){var l,c;return l=Math.floor(n/4294967296),c=4294967295&n,this.writeByte(l>>24&255),this.writeByte(l>>16&255),this.writeByte(l>>8&255),this.writeByte(255&l),this.writeByte(c>>24&255),this.writeByte(c>>16&255),this.writeByte(c>>8&255),this.writeByte(255&c)},a.prototype.readInt=function(){return this.readInt32()},a.prototype.writeInt=function(n){return this.writeInt32(n)},a.prototype.read=function(n){var l,c;for(l=[],c=0;0<=n?c<n:c>n;c=0<=n?++c:--c)l.push(this.readByte());return l},a.prototype.write=function(n){var l,c,f,i;for(i=[],c=0,f=n.length;c<f;c++)l=n[c],i.push(this.writeByte(l));return i},a}(),V7=function(){var a;function n(l){var c,f,i;for(this.scalarType=l.readInt(),this.tableCount=l.readShort(),this.searchRange=l.readShort(),this.entrySelector=l.readShort(),this.rangeShift=l.readShort(),this.tables={},f=0,i=this.tableCount;0<=i?f<i:f>i;f=0<=i?++f:--f)c={tag:l.readString(4),checksum:l.readInt(),offset:l.readInt(),length:l.readInt()},this.tables[c.tag]=c}return n.prototype.encode=function(l){var c,f,i,x,T,A,M,F,W,V,R,te,H;for(H in R=Object.keys(l).length,A=Math.log(2),W=16*Math.floor(Math.log(R)/A),x=Math.floor(W/A),F=16*R-W,(f=new Jf).writeInt(this.scalarType),f.writeShort(R),f.writeShort(W),f.writeShort(x),f.writeShort(F),i=16*R,M=f.pos+i,T=null,te=[],l)for(V=l[H],f.writeString(H),f.writeInt(a(V)),f.writeInt(M),f.writeInt(V.length),te=te.concat(V),H==="head"&&(T=M),M+=V.length;M%4;)te.push(0),M++;return f.write(te),c=2981146554-a(f.data),f.pos=T+8,f.writeUInt32(c),f.data},a=function(l){var c,f,i,x;for(l=Y4.call(l);l.length%4;)l.push(0);for(i=new Jf(l),f=0,c=0,x=l.length;c<x;c=c+=4)f+=i.readUInt32();return 4294967295&f},n}(),U7={}.hasOwnProperty,Xh=function(a,n){for(var l in n)U7.call(n,l)&&(a[l]=n[l]);function c(){this.constructor=a}return c.prototype=n.prototype,a.prototype=new c,a.__super__=n.prototype,a};ah=function(){function a(n){var l;this.file=n,l=this.file.directory.tables[this.tag],this.exists=!!l,l&&(this.offset=l.offset,this.length=l.length,this.parse(this.file.contents))}return a.prototype.parse=function(){},a.prototype.encode=function(){},a.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},a}();H7=function(a){function n(){return n.__super__.constructor.apply(this,arguments)}return Xh(n,ah),n.prototype.tag="head",n.prototype.parse=function(l){return l.pos=this.offset,this.version=l.readInt(),this.revision=l.readInt(),this.checkSumAdjustment=l.readInt(),this.magicNumber=l.readInt(),this.flags=l.readShort(),this.unitsPerEm=l.readShort(),this.created=l.readLongLong(),this.modified=l.readLongLong(),this.xMin=l.readShort(),this.yMin=l.readShort(),this.xMax=l.readShort(),this.yMax=l.readShort(),this.macStyle=l.readShort(),this.lowestRecPPEM=l.readShort(),this.fontDirectionHint=l.readShort(),this.indexToLocFormat=l.readShort(),this.glyphDataFormat=l.readShort()},n.prototype.encode=function(l){var c;return(c=new Jf).writeInt(this.version),c.writeInt(this.revision),c.writeInt(this.checkSumAdjustment),c.writeInt(this.magicNumber),c.writeShort(this.flags),c.writeShort(this.unitsPerEm),c.writeLongLong(this.created),c.writeLongLong(this.modified),c.writeShort(this.xMin),c.writeShort(this.yMin),c.writeShort(this.xMax),c.writeShort(this.yMax),c.writeShort(this.macStyle),c.writeShort(this.lowestRecPPEM),c.writeShort(this.fontDirectionHint),c.writeShort(l),c.writeShort(this.glyphDataFormat),c.data},n}(),B4=function(){function a(n,l){var c,f,i,x,T,A,M,F,W,V,R,te,H,J,K,ne,de;switch(this.platformID=n.readUInt16(),this.encodingID=n.readShort(),this.offset=l+n.readInt(),W=n.pos,n.pos=this.offset,this.format=n.readUInt16(),this.length=n.readUInt16(),this.language=n.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(A=0;A<256;++A)this.codeMap[A]=n.readByte();break;case 4:for(R=n.readUInt16(),V=R/2,n.pos+=6,i=function(){var De,Fe;for(Fe=[],A=De=0;0<=V?De<V:De>V;A=0<=V?++De:--De)Fe.push(n.readUInt16());return Fe}(),n.pos+=2,H=function(){var De,Fe;for(Fe=[],A=De=0;0<=V?De<V:De>V;A=0<=V?++De:--De)Fe.push(n.readUInt16());return Fe}(),M=function(){var De,Fe;for(Fe=[],A=De=0;0<=V?De<V:De>V;A=0<=V?++De:--De)Fe.push(n.readUInt16());return Fe}(),F=function(){var De,Fe;for(Fe=[],A=De=0;0<=V?De<V:De>V;A=0<=V?++De:--De)Fe.push(n.readUInt16());return Fe}(),f=(this.length-n.pos+this.offset)/2,T=function(){var De,Fe;for(Fe=[],A=De=0;0<=f?De<f:De>f;A=0<=f?++De:--De)Fe.push(n.readUInt16());return Fe}(),A=K=0,de=i.length;K<de;A=++K)for(J=i[A],c=ne=te=H[A];te<=J?ne<=J:ne>=J;c=te<=J?++ne:--ne)F[A]===0?x=c+M[A]:(x=T[F[A]/2+(c-te)-(V-A)]||0)!==0&&(x+=M[A]),this.codeMap[c]=65535&x}n.pos=W}return a.encode=function(n,l){var c,f,i,x,T,A,M,F,W,V,R,te,H,J,K,ne,de,De,Fe,et,Te,ge,Ve,Ae,_e,xe,Qe,Ce,Ye,ut,st,pt,Tt,ht,Wt,ie,ye,pe,Ie,Ue,gt,mt,wt,Lt,fi,yi;switch(Ce=new Jf,x=Object.keys(n).sort(function(Fi,Pi){return Fi-Pi}),l){case"macroman":for(H=0,J=function(){var Fi=[];for(te=0;te<256;++te)Fi.push(0);return Fi}(),ne={0:0},i={},Ye=0,Tt=x.length;Ye<Tt;Ye++)ne[wt=n[f=x[Ye]]]==null&&(ne[wt]=++H),i[f]={old:n[f],new:ne[n[f]]},J[f]=ne[n[f]];return Ce.writeUInt16(1),Ce.writeUInt16(0),Ce.writeUInt32(12),Ce.writeUInt16(0),Ce.writeUInt16(262),Ce.writeUInt16(0),Ce.write(J),{charMap:i,subtable:Ce.data,maxGlyphID:H+1};case"unicode":for(xe=[],W=[],de=0,ne={},c={},K=M=null,ut=0,ht=x.length;ut<ht;ut++)ne[Fe=n[f=x[ut]]]==null&&(ne[Fe]=++de),c[f]={old:Fe,new:ne[Fe]},T=ne[Fe]-f,K!=null&&T===M||(K&&W.push(K),xe.push(f),M=T),K=f;for(K&&W.push(K),W.push(65535),xe.push(65535),Ae=2*(Ve=xe.length),ge=2*Math.pow(Math.log(Ve)/Math.LN2,2),V=Math.log(ge/2)/Math.LN2,Te=2*Ve-ge,A=[],et=[],R=[],te=st=0,Wt=xe.length;st<Wt;te=++st){if(_e=xe[te],F=W[te],_e===65535){A.push(0),et.push(0);break}if(_e-(Qe=c[_e].new)>=32768)for(A.push(0),et.push(2*(R.length+Ve-te)),f=pt=_e;_e<=F?pt<=F:pt>=F;f=_e<=F?++pt:--pt)R.push(c[f].new);else A.push(Qe-_e),et.push(0)}for(Ce.writeUInt16(3),Ce.writeUInt16(1),Ce.writeUInt32(12),Ce.writeUInt16(4),Ce.writeUInt16(16+8*Ve+2*R.length),Ce.writeUInt16(0),Ce.writeUInt16(Ae),Ce.writeUInt16(ge),Ce.writeUInt16(V),Ce.writeUInt16(Te),gt=0,ie=W.length;gt<ie;gt++)f=W[gt],Ce.writeUInt16(f);for(Ce.writeUInt16(0),mt=0,ye=xe.length;mt<ye;mt++)f=xe[mt],Ce.writeUInt16(f);for(Lt=0,pe=A.length;Lt<pe;Lt++)T=A[Lt],Ce.writeUInt16(T);for(fi=0,Ie=et.length;fi<Ie;fi++)De=et[fi],Ce.writeUInt16(De);for(yi=0,Ue=R.length;yi<Ue;yi++)H=R[yi],Ce.writeUInt16(H);return{charMap:c,subtable:Ce.data,maxGlyphID:de+1}}},a}(),Z4=function(a){function n(){return n.__super__.constructor.apply(this,arguments)}return Xh(n,ah),n.prototype.tag="cmap",n.prototype.parse=function(l){var c,f,i;for(l.pos=this.offset,this.version=l.readUInt16(),i=l.readUInt16(),this.tables=[],this.unicode=null,f=0;0<=i?f<i:f>i;f=0<=i?++f:--f)c=new B4(l,this.offset),this.tables.push(c),c.isUnicode&&this.unicode==null&&(this.unicode=c);return!0},n.encode=function(l,c){var f,i;return c==null&&(c="macroman"),f=B4.encode(l,c),(i=new Jf).writeUInt16(0),i.writeUInt16(1),f.table=i.data.concat(f.subtable),f},n}(),G7=function(a){function n(){return n.__super__.constructor.apply(this,arguments)}return Xh(n,ah),n.prototype.tag="hhea",n.prototype.parse=function(l){return l.pos=this.offset,this.version=l.readInt(),this.ascender=l.readShort(),this.decender=l.readShort(),this.lineGap=l.readShort(),this.advanceWidthMax=l.readShort(),this.minLeftSideBearing=l.readShort(),this.minRightSideBearing=l.readShort(),this.xMaxExtent=l.readShort(),this.caretSlopeRise=l.readShort(),this.caretSlopeRun=l.readShort(),this.caretOffset=l.readShort(),l.pos+=8,this.metricDataFormat=l.readShort(),this.numberOfMetrics=l.readUInt16()},n}(),W7=function(a){function n(){return n.__super__.constructor.apply(this,arguments)}return Xh(n,ah),n.prototype.tag="OS/2",n.prototype.parse=function(l){if(l.pos=this.offset,this.version=l.readUInt16(),this.averageCharWidth=l.readShort(),this.weightClass=l.readUInt16(),this.widthClass=l.readUInt16(),this.type=l.readShort(),this.ySubscriptXSize=l.readShort(),this.ySubscriptYSize=l.readShort(),this.ySubscriptXOffset=l.readShort(),this.ySubscriptYOffset=l.readShort(),this.ySuperscriptXSize=l.readShort(),this.ySuperscriptYSize=l.readShort(),this.ySuperscriptXOffset=l.readShort(),this.ySuperscriptYOffset=l.readShort(),this.yStrikeoutSize=l.readShort(),this.yStrikeoutPosition=l.readShort(),this.familyClass=l.readShort(),this.panose=function(){var c,f;for(f=[],c=0;c<10;++c)f.push(l.readByte());return f}(),this.charRange=function(){var c,f;for(f=[],c=0;c<4;++c)f.push(l.readInt());return f}(),this.vendorID=l.readString(4),this.selection=l.readShort(),this.firstCharIndex=l.readShort(),this.lastCharIndex=l.readShort(),this.version>0&&(this.ascent=l.readShort(),this.descent=l.readShort(),this.lineGap=l.readShort(),this.winAscent=l.readShort(),this.winDescent=l.readShort(),this.codePageRange=function(){var c,f;for(f=[],c=0;c<2;c=++c)f.push(l.readInt());return f}(),this.version>1))return this.xHeight=l.readShort(),this.capHeight=l.readShort(),this.defaultChar=l.readShort(),this.breakChar=l.readShort(),this.maxContext=l.readShort()},n}(),q7=function(a){function n(){return n.__super__.constructor.apply(this,arguments)}return Xh(n,ah),n.prototype.tag="post",n.prototype.parse=function(l){var c,f,i;switch(l.pos=this.offset,this.format=l.readInt(),this.italicAngle=l.readInt(),this.underlinePosition=l.readShort(),this.underlineThickness=l.readShort(),this.isFixedPitch=l.readInt(),this.minMemType42=l.readInt(),this.maxMemType42=l.readInt(),this.minMemType1=l.readInt(),this.maxMemType1=l.readInt(),this.format){case 65536:break;case 131072:var x;for(f=l.readUInt16(),this.glyphNameIndex=[],x=0;0<=f?x<f:x>f;x=0<=f?++x:--x)this.glyphNameIndex.push(l.readUInt16());for(this.names=[],i=[];l.pos<this.offset+this.length;)c=l.readByte(),i.push(this.names.push(l.readString(c)));return i;case 151552:return f=l.readUInt16(),this.offsets=l.read(f);case 196608:break;case 262144:return this.map=(function(){var T,A,M;for(M=[],x=T=0,A=this.file.maxp.numGlyphs;0<=A?T<A:T>A;x=0<=A?++T:--T)M.push(l.readUInt32());return M}).call(this)}},n}(),$7=function(a,n){this.raw=a,this.length=a.length,this.platformID=n.platformID,this.encodingID=n.encodingID,this.languageID=n.languageID},X7=function(a){function n(){return n.__super__.constructor.apply(this,arguments)}return Xh(n,ah),n.prototype.tag="name",n.prototype.parse=function(l){var c,f,i,x,T,A,M,F,W,V,R;for(l.pos=this.offset,l.readShort(),c=l.readShort(),A=l.readShort(),f=[],x=0;0<=c?x<c:x>c;x=0<=c?++x:--x)f.push({platformID:l.readShort(),encodingID:l.readShort(),languageID:l.readShort(),nameID:l.readShort(),length:l.readShort(),offset:this.offset+A+l.readShort()});for(M={},x=W=0,V=f.length;W<V;x=++W)i=f[x],l.pos=i.offset,F=l.readString(i.length),T=new $7(F,i),M[R=i.nameID]==null&&(M[R]=[]),M[i.nameID].push(T);this.strings=M,this.copyright=M[0],this.fontFamily=M[1],this.fontSubfamily=M[2],this.uniqueSubfamily=M[3],this.fontName=M[4],this.version=M[5];try{this.postscriptName=M[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=M[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=M[7],this.manufacturer=M[8],this.designer=M[9],this.description=M[10],this.vendorUrl=M[11],this.designerUrl=M[12],this.license=M[13],this.licenseUrl=M[14],this.preferredFamily=M[15],this.preferredSubfamily=M[17],this.compatibleFull=M[18],this.sampleText=M[19]},n}(),Z7=function(a){function n(){return n.__super__.constructor.apply(this,arguments)}return Xh(n,ah),n.prototype.tag="maxp",n.prototype.parse=function(l){return l.pos=this.offset,this.version=l.readInt(),this.numGlyphs=l.readUInt16(),this.maxPoints=l.readUInt16(),this.maxContours=l.readUInt16(),this.maxCompositePoints=l.readUInt16(),this.maxComponentContours=l.readUInt16(),this.maxZones=l.readUInt16(),this.maxTwilightPoints=l.readUInt16(),this.maxStorage=l.readUInt16(),this.maxFunctionDefs=l.readUInt16(),this.maxInstructionDefs=l.readUInt16(),this.maxStackElements=l.readUInt16(),this.maxSizeOfInstructions=l.readUInt16(),this.maxComponentElements=l.readUInt16(),this.maxComponentDepth=l.readUInt16()},n}(),Y7=function(a){function n(){return n.__super__.constructor.apply(this,arguments)}return Xh(n,ah),n.prototype.tag="hmtx",n.prototype.parse=function(l){var c,f,i,x,T,A,M;for(l.pos=this.offset,this.metrics=[],c=0,A=this.file.hhea.numberOfMetrics;0<=A?c<A:c>A;c=0<=A?++c:--c)this.metrics.push({advance:l.readUInt16(),lsb:l.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var F,W;for(W=[],c=F=0;0<=i?F<i:F>i;c=0<=i?++F:--F)W.push(l.readInt16());return W}(),this.widths=(function(){var F,W,V,R;for(R=[],F=0,W=(V=this.metrics).length;F<W;F++)x=V[F],R.push(x.advance);return R}).call(this),f=this.widths[this.widths.length-1],M=[],c=T=0;0<=i?T<i:T>i;c=0<=i?++T:--T)M.push(this.widths.push(f));return M},n.prototype.forGlyph=function(l){return l in this.metrics?this.metrics[l]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[l-this.metrics.length]}},n}(),Y4=[].slice,K7=function(a){function n(){return n.__super__.constructor.apply(this,arguments)}return Xh(n,ah),n.prototype.tag="glyf",n.prototype.parse=function(){return this.cache={}},n.prototype.glyphFor=function(l){var c,f,i,x,T,A,M,F,W,V;return l in this.cache?this.cache[l]:(x=this.file.loca,c=this.file.contents,f=x.indexOf(l),(i=x.lengthOf(l))===0?this.cache[l]=null:(c.pos=this.offset+f,T=(A=new Jf(c.read(i))).readShort(),F=A.readShort(),V=A.readShort(),M=A.readShort(),W=A.readShort(),this.cache[l]=T===-1?new Q7(A,F,V,M,W):new J7(A,T,F,V,M,W),this.cache[l]))},n.prototype.encode=function(l,c,f){var i,x,T,A,M;for(T=[],x=[],A=0,M=c.length;A<M;A++)i=l[c[A]],x.push(T.length),i&&(T=T.concat(i.encode(f)));return x.push(T.length),{table:T,offsets:x}},n}(),J7=function(){function a(n,l,c,f,i,x){this.raw=n,this.numberOfContours=l,this.xMin=c,this.yMin=f,this.xMax=i,this.yMax=x,this.compound=!1}return a.prototype.encode=function(){return this.raw.data},a}(),Q7=function(){function a(n,l,c,f,i){var x,T;for(this.raw=n,this.xMin=l,this.yMin=c,this.xMax=f,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],x=this.raw;T=x.readShort(),this.glyphOffsets.push(x.pos),this.glyphIDs.push(x.readUInt16()),32&T;)x.pos+=1&T?4:2,128&T?x.pos+=8:64&T?x.pos+=4:8&T&&(x.pos+=2)}return a.prototype.encode=function(){var n,l,c;for(l=new Jf(Y4.call(this.raw.data)),n=0,c=this.glyphIDs.length;n<c;++n)l.pos=this.glyphOffsets[n];return l.data},a}(),ej=function(a){function n(){return n.__super__.constructor.apply(this,arguments)}return Xh(n,ah),n.prototype.tag="loca",n.prototype.parse=function(l){var c,f;return l.pos=this.offset,c=this.file.head.indexToLocFormat,this.offsets=c===0?(function(){var i,x;for(x=[],f=0,i=this.length;f<i;f+=2)x.push(2*l.readUInt16());return x}).call(this):(function(){var i,x;for(x=[],f=0,i=this.length;f<i;f+=4)x.push(l.readUInt32());return x}).call(this)},n.prototype.indexOf=function(l){return this.offsets[l]},n.prototype.lengthOf=function(l){return this.offsets[l+1]-this.offsets[l]},n.prototype.encode=function(l,c){for(var f=new Uint32Array(this.offsets.length),i=0,x=0,T=0;T<f.length;++T)if(f[T]=i,x<c.length&&c[x]==T){++x,f[T]=i;var A=this.offsets[T],M=this.offsets[T+1]-A;M>0&&(i+=M)}for(var F=new Array(4*f.length),W=0;W<f.length;++W)F[4*W+3]=255&f[W],F[4*W+2]=(65280&f[W])>>8,F[4*W+1]=(16711680&f[W])>>16,F[4*W]=(4278190080&f[W])>>24;return F},n}(),tj=function(){function a(n){this.font=n,this.subset={},this.unicodes={},this.next=33}return a.prototype.generateCmap=function(){var n,l,c,f,i;for(l in f=this.font.cmap.tables[0].codeMap,n={},i=this.subset)c=i[l],n[l]=f[c];return n},a.prototype.glyphsFor=function(n){var l,c,f,i,x,T,A;for(f={},x=0,T=n.length;x<T;x++)f[i=n[x]]=this.font.glyf.glyphFor(i);for(i in l=[],f)(c=f[i])!=null&&c.compound&&l.push.apply(l,c.glyphIDs);if(l.length>0)for(i in A=this.glyphsFor(l))c=A[i],f[i]=c;return f},a.prototype.encode=function(n,l){var c,f,i,x,T,A,M,F,W,V,R,te,H,J,K;for(f in c=Z4.encode(this.generateCmap(),"unicode"),x=this.glyphsFor(n),R={0:0},K=c.charMap)R[(A=K[f]).old]=A.new;for(te in V=c.maxGlyphID,x)te in R||(R[te]=V++);return F=function(ne){var de,De;for(de in De={},ne)De[ne[de]]=de;return De}(R),W=Object.keys(F).sort(function(ne,de){return ne-de}),H=function(){var ne,de,De;for(De=[],ne=0,de=W.length;ne<de;ne++)T=W[ne],De.push(F[T]);return De}(),i=this.font.glyf.encode(x,H,R),M=this.font.loca.encode(i.offsets,H),J={cmap:this.font.cmap.raw(),glyf:i.table,loca:M,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(l)},this.font.os2.exists&&(J["OS/2"]=this.font.os2.raw()),this.font.directory.encode(J)},a}();Lr.API.PDFObject=function(){var a;function n(){}return a=function(l,c){return(Array(c+1).join("0")+l).slice(-c)},n.convert=function(l){var c,f,i,x;if(Array.isArray(l))return"["+function(){var T,A,M;for(M=[],T=0,A=l.length;T<A;T++)c=l[T],M.push(n.convert(c));return M}().join(" ")+"]";if(typeof l=="string")return"/"+l;if(l?.isString)return"("+l+")";if(l instanceof Date)return"(D:"+a(l.getUTCFullYear(),4)+a(l.getUTCMonth(),2)+a(l.getUTCDate(),2)+a(l.getUTCHours(),2)+a(l.getUTCMinutes(),2)+a(l.getUTCSeconds(),2)+"Z)";if({}.toString.call(l)==="[object Object]"){for(f in i=["<<"],l)x=l[f],i.push("/"+f+" "+n.convert(x));return i.push(">>"),i.join(`
`)}return""+l},n}();j2=Lr});var K4=wS((om,U2)=>{"use strict";(function(n,l){if(typeof om=="object"&&typeof U2=="object")U2.exports=l(function(){try{return Gx(),TS(V2)}catch{}}());else if(typeof define=="function"&&define.amd)define(["jspdf"],l);else{var c=l(typeof om=="object"?function(){try{return Gx(),TS(V2)}catch{}}():n.jspdf);for(var f in c)(typeof om=="object"?om:n)[f]=c[f]}})(typeof globalThis<"u"?globalThis:typeof om<"u"?om:typeof window<"u"?window:typeof self<"u"?self:global,function(a){return function(){"use strict";var n={172:function(i,x){var T=this&&this.__extends||function(){var F=function(W,V){return F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,te){R.__proto__=te}||function(R,te){for(var H in te)Object.prototype.hasOwnProperty.call(te,H)&&(R[H]=te[H])},F(W,V)};return function(W,V){if(typeof V!="function"&&V!==null)throw new TypeError("Class extends value "+String(V)+" is not a constructor or null");F(W,V);function R(){this.constructor=W}W.prototype=V===null?Object.create(V):(R.prototype=V.prototype,new R)}}();Object.defineProperty(x,"__esModule",{value:!0}),x.CellHookData=x.HookData=void 0;var A=function(){function F(W,V,R){this.table=V,this.pageNumber=V.pageNumber,this.pageCount=this.pageNumber,this.settings=V.settings,this.cursor=R,this.doc=W.getDocument()}return F}();x.HookData=A;var M=function(F){T(W,F);function W(V,R,te,H,J,K){var ne=F.call(this,V,R,K)||this;return ne.cell=te,ne.row=H,ne.column=J,ne.section=H.section,ne}return W}(A);x.CellHookData=M},340:function(i,x,T){Object.defineProperty(x,"__esModule",{value:!0});var A=T(4),M=T(136),F=T(744),W=T(776),V=T(664),R=T(972);function te(H){H.API.autoTable=function(){for(var J=[],K=0;K<arguments.length;K++)J[K]=arguments[K];var ne;J.length===1?ne=J[0]:(console.error("Use of deprecated autoTable initiation"),ne=J[2]||{},ne.columns=J[0],ne.body=J[1]);var de=(0,W.parseInput)(this,ne),De=(0,R.createTable)(this,de);return(0,V.drawTable)(this,De),this},H.API.lastAutoTable=!1,H.API.previousAutoTable=!1,H.API.autoTable.previous=!1,H.API.autoTableText=function(J,K,ne,de){(0,M.default)(J,K,ne,de,this)},H.API.autoTableSetDefaults=function(J){return F.DocHandler.setDefaults(J,this),this},H.autoTableSetDefaults=function(J,K){F.DocHandler.setDefaults(J,K)},H.API.autoTableHtmlToJson=function(J,K){var ne;if(K===void 0&&(K=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var de=new F.DocHandler(this),De=(0,A.parseHtml)(de,J,window,K,!1),Fe=De.head,et=De.body,Te=((ne=Fe[0])===null||ne===void 0?void 0:ne.map(function(ge){return ge.content}))||[];return{columns:Te,rows:et,data:et}},H.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var J=this.lastAutoTable;return J&&J.finalY?J.finalY:0},H.API.autoTableAddPageContent=function(J){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),H.API.autoTable.globalDefaults||(H.API.autoTable.globalDefaults={}),H.API.autoTable.globalDefaults.addPageContent=J,this},H.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}x.default=te},136:function(i,x){Object.defineProperty(x,"__esModule",{value:!0});function T(A,M,F,W,V){W=W||{};var R=1.15,te=V.internal.scaleFactor,H=V.internal.getFontSize()/te,J=V.getLineHeightFactor?V.getLineHeightFactor():R,K=H*J,ne=/\r\n|\r|\n/g,de="",De=1;if((W.valign==="middle"||W.valign==="bottom"||W.halign==="center"||W.halign==="right")&&(de=typeof A=="string"?A.split(ne):A,De=de.length||1),F+=H*(2-R),W.valign==="middle"?F-=De/2*K:W.valign==="bottom"&&(F-=De*K),W.halign==="center"||W.halign==="right"){var Fe=H;if(W.halign==="center"&&(Fe*=.5),de&&De>=1){for(var et=0;et<de.length;et++)V.text(de[et],M-V.getStringUnitWidth(de[et])*Fe,F),F+=K;return V}M-=V.getStringUnitWidth(A)*Fe}return W.halign==="justify"?V.text(A,M,F,{maxWidth:W.maxWidth||100,align:"justify"}):V.text(A,M,F),V}x.default=T},420:function(i,x){Object.defineProperty(x,"__esModule",{value:!0}),x.getPageAvailableWidth=x.parseSpacing=x.getFillStyle=x.addTableBorder=x.getStringWidth=void 0;function T(V,R,te){te.applyStyles(R,!0);var H=Array.isArray(V)?V:[V],J=H.map(function(K){return te.getTextWidth(K)}).reduce(function(K,ne){return Math.max(K,ne)},0);return J}x.getStringWidth=T;function A(V,R,te,H){var J=R.settings.tableLineWidth,K=R.settings.tableLineColor;V.applyStyles({lineWidth:J,lineColor:K});var ne=M(J,!1);ne&&V.rect(te.x,te.y,R.getWidth(V.pageSize().width),H.y-te.y,ne)}x.addTableBorder=A;function M(V,R){var te=V>0,H=R||R===0;return te&&H?"DF":te?"S":H?"F":null}x.getFillStyle=M;function F(V,R){var te,H,J,K;if(V=V||R,Array.isArray(V)){if(V.length>=4)return{top:V[0],right:V[1],bottom:V[2],left:V[3]};if(V.length===3)return{top:V[0],right:V[1],bottom:V[2],left:V[1]};if(V.length===2)return{top:V[0],right:V[1],bottom:V[0],left:V[1]};V.length===1?V=V[0]:V=R}return typeof V=="object"?(typeof V.vertical=="number"&&(V.top=V.vertical,V.bottom=V.vertical),typeof V.horizontal=="number"&&(V.right=V.horizontal,V.left=V.horizontal),{left:(te=V.left)!==null&&te!==void 0?te:R,top:(H=V.top)!==null&&H!==void 0?H:R,right:(J=V.right)!==null&&J!==void 0?J:R,bottom:(K=V.bottom)!==null&&K!==void 0?K:R}):(typeof V!="number"&&(V=R),{top:V,right:V,bottom:V,left:V})}x.parseSpacing=F;function W(V,R){var te=F(R.settings.margin,0);return V.pageSize().width-(te.left+te.right)}x.getPageAvailableWidth=W},796:function(i,x){var T=this&&this.__extends||function(){var W=function(V,R){return W=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(te,H){te.__proto__=H}||function(te,H){for(var J in H)Object.prototype.hasOwnProperty.call(H,J)&&(te[J]=H[J])},W(V,R)};return function(V,R){if(typeof R!="function"&&R!==null)throw new TypeError("Class extends value "+String(R)+" is not a constructor or null");W(V,R);function te(){this.constructor=V}V.prototype=R===null?Object.create(R):(te.prototype=R.prototype,new te)}}();Object.defineProperty(x,"__esModule",{value:!0}),x.getTheme=x.defaultStyles=x.HtmlRowInput=void 0;var A=function(W){T(V,W);function V(R){var te=W.call(this)||this;return te._element=R,te}return V}(Array);x.HtmlRowInput=A;function M(W){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/W,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}x.defaultStyles=M;function F(W){var V={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return V[W]}x.getTheme=F},903:function(i,x,T){Object.defineProperty(x,"__esModule",{value:!0}),x.parseCss=void 0;var A=T(420);function M(te,H,J,K,ne){var de={},De=1.3333333333333333,Fe=W(H,function(st){return ne.getComputedStyle(st).backgroundColor});Fe!=null&&(de.fillColor=Fe);var et=W(H,function(st){return ne.getComputedStyle(st).color});et!=null&&(de.textColor=et);var Te=R(K,J);Te&&(de.cellPadding=Te);var ge="borderTopColor",Ve=De*J,Ae=K.borderTopWidth;if(K.borderBottomWidth===Ae&&K.borderRightWidth===Ae&&K.borderLeftWidth===Ae){var _e=(parseFloat(Ae)||0)/Ve;_e&&(de.lineWidth=_e)}else de.lineWidth={top:(parseFloat(K.borderTopWidth)||0)/Ve,right:(parseFloat(K.borderRightWidth)||0)/Ve,bottom:(parseFloat(K.borderBottomWidth)||0)/Ve,left:(parseFloat(K.borderLeftWidth)||0)/Ve},de.lineWidth.top||(de.lineWidth.right?ge="borderRightColor":de.lineWidth.bottom?ge="borderBottomColor":de.lineWidth.left&&(ge="borderLeftColor"));console.log(de.lineWidth);var xe=W(H,function(st){return ne.getComputedStyle(st)[ge]});xe!=null&&(de.lineColor=xe);var Qe=["left","right","center","justify"];Qe.indexOf(K.textAlign)!==-1&&(de.halign=K.textAlign),Qe=["middle","bottom","top"],Qe.indexOf(K.verticalAlign)!==-1&&(de.valign=K.verticalAlign);var Ce=parseInt(K.fontSize||"");isNaN(Ce)||(de.fontSize=Ce/De);var Ye=F(K);Ye&&(de.fontStyle=Ye);var ut=(K.fontFamily||"").toLowerCase();return te.indexOf(ut)!==-1&&(de.font=ut),de}x.parseCss=M;function F(te){var H="";return(te.fontWeight==="bold"||te.fontWeight==="bolder"||parseInt(te.fontWeight)>=700)&&(H="bold"),(te.fontStyle==="italic"||te.fontStyle==="oblique")&&(H+="italic"),H}function W(te,H){var J=V(te,H);if(!J)return null;var K=J.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!K||!Array.isArray(K))return null;var ne=[parseInt(K[1]),parseInt(K[2]),parseInt(K[3])],de=parseInt(K[4]);return de===0||isNaN(ne[0])||isNaN(ne[1])||isNaN(ne[2])?null:ne}function V(te,H){var J=H(te);return J==="rgba(0, 0, 0, 0)"||J==="transparent"||J==="initial"||J==="inherit"?te.parentElement==null?null:V(te.parentElement,H):J}function R(te,H){var J=[te.paddingTop,te.paddingRight,te.paddingBottom,te.paddingLeft],K=96/(72/H),ne=(parseInt(te.lineHeight)-parseInt(te.fontSize))/H/2,de=J.map(function(Fe){return parseInt(Fe||"0")/K}),De=(0,A.parseSpacing)(de,0);return ne>De.top&&(De.top=ne),ne>De.bottom&&(De.bottom=ne),De}},744:function(i,x){Object.defineProperty(x,"__esModule",{value:!0}),x.DocHandler=void 0;var T={},A=function(){function M(F){this.jsPDFDocument=F,this.userStyles={textColor:F.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:F.internal.getFontSize(),fontStyle:F.internal.getFont().fontStyle,font:F.internal.getFont().fontName,lineWidth:F.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:F.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return M.setDefaults=function(F,W){W===void 0&&(W=null),W?W.__autoTableDocumentDefaults=F:T=F},M.unifyColor=function(F){return Array.isArray(F)?F:typeof F=="number"?[F,F,F]:typeof F=="string"?[F]:null},M.prototype.applyStyles=function(F,W){var V,R,te;W===void 0&&(W=!1),F.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(F.fontStyle);var H=this.jsPDFDocument.internal.getFont(),J=H.fontStyle,K=H.fontName;if(F.font&&(K=F.font),F.fontStyle){J=F.fontStyle;var ne=this.getFontList()[K];ne&&ne.indexOf(J)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(ne[0]),J=ne[0])}if(this.jsPDFDocument.setFont(K,J),F.fontSize&&this.jsPDFDocument.setFontSize(F.fontSize),!W){var de=M.unifyColor(F.fillColor);de&&(V=this.jsPDFDocument).setFillColor.apply(V,de),de=M.unifyColor(F.textColor),de&&(R=this.jsPDFDocument).setTextColor.apply(R,de),de=M.unifyColor(F.lineColor),de&&(te=this.jsPDFDocument).setDrawColor.apply(te,de),typeof F.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(F.lineWidth)}},M.prototype.splitTextToSize=function(F,W,V){return this.jsPDFDocument.splitTextToSize(F,W,V)},M.prototype.rect=function(F,W,V,R,te){return this.jsPDFDocument.rect(F,W,V,R,te)},M.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},M.prototype.getTextWidth=function(F){return this.jsPDFDocument.getTextWidth(F)},M.prototype.getDocument=function(){return this.jsPDFDocument},M.prototype.setPage=function(F){this.jsPDFDocument.setPage(F)},M.prototype.addPage=function(){return this.jsPDFDocument.addPage()},M.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},M.prototype.getGlobalOptions=function(){return T||{}},M.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},M.prototype.pageSize=function(){var F=this.jsPDFDocument.internal.pageSize;return F.width==null&&(F={width:F.getWidth(),height:F.getHeight()}),F},M.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},M.prototype.getLineHeightFactor=function(){var F=this.jsPDFDocument;return F.getLineHeightFactor?F.getLineHeightFactor():1.15},M.prototype.getLineHeight=function(F){return F/this.scaleFactor()*this.getLineHeightFactor()},M.prototype.pageNumber=function(){var F=this.jsPDFDocument.internal.getCurrentPageInfo();return F?F.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},M}();x.DocHandler=A},4:function(i,x,T){Object.defineProperty(x,"__esModule",{value:!0}),x.parseHtml=void 0;var A=T(903),M=T(796);function F(R,te,H,J,K){var ne,de;J===void 0&&(J=!1),K===void 0&&(K=!1);var De;typeof te=="string"?De=H.document.querySelector(te):De=te;var Fe=Object.keys(R.getFontList()),et=R.scaleFactor(),Te=[],ge=[],Ve=[];if(!De)return console.error("Html table could not be found with input: ",te),{head:Te,body:ge,foot:Ve};for(var Ae=0;Ae<De.rows.length;Ae++){var _e=De.rows[Ae],xe=(de=(ne=_e?.parentElement)===null||ne===void 0?void 0:ne.tagName)===null||de===void 0?void 0:de.toLowerCase(),Qe=W(Fe,et,H,_e,J,K);Qe&&(xe==="thead"?Te.push(Qe):xe==="tfoot"?Ve.push(Qe):ge.push(Qe))}return{head:Te,body:ge,foot:Ve}}x.parseHtml=F;function W(R,te,H,J,K,ne){for(var de=new M.HtmlRowInput(J),De=0;De<J.cells.length;De++){var Fe=J.cells[De],et=H.getComputedStyle(Fe);if(K||et.display!=="none"){var Te=void 0;ne&&(Te=(0,A.parseCss)(R,Fe,te,et,H)),de.push({rowSpan:Fe.rowSpan,colSpan:Fe.colSpan,styles:Te,_element:Fe,content:V(Fe)})}}var ge=H.getComputedStyle(J);if(de.length>0&&(K||ge.display!=="none"))return de}function V(R){var te=R.cloneNode(!0);return te.innerHTML=te.innerHTML.replace(/\n/g,"").replace(/ +/g," "),te.innerHTML=te.innerHTML.split(/<br.*?>/).map(function(H){return H.trim()}).join(`
`),te.innerText||te.textContent||""}},776:function(i,x,T){Object.defineProperty(x,"__esModule",{value:!0}),x.parseInput=void 0;var A=T(4),M=T(356),F=T(420),W=T(744),V=T(792);function R(De,Fe){var et=new W.DocHandler(De),Te=et.getDocumentOptions(),ge=et.getGlobalOptions();(0,V.default)(et,ge,Te,Fe);var Ve=(0,M.assign)({},ge,Te,Fe),Ae;typeof window<"u"&&(Ae=window);var _e=te(ge,Te,Fe),xe=H(ge,Te,Fe),Qe=J(et,Ve),Ce=ne(et,Ve,Ae);return{id:Fe.tableId,content:Ce,hooks:xe,styles:_e,settings:Qe}}x.parseInput=R;function te(De,Fe,et){for(var Te={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},ge=function(xe){if(xe==="columnStyles"){var Qe=De[xe],Ce=Fe[xe],Ye=et[xe];Te.columnStyles=(0,M.assign)({},Qe,Ce,Ye)}else{var ut=[De,Fe,et],st=ut.map(function(pt){return pt[xe]||{}});Te[xe]=(0,M.assign)({},st[0],st[1],st[2])}},Ve=0,Ae=Object.keys(Te);Ve<Ae.length;Ve++){var _e=Ae[Ve];ge(_e)}return Te}function H(De,Fe,et){for(var Te=[De,Fe,et],ge={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},Ve=0,Ae=Te;Ve<Ae.length;Ve++){var _e=Ae[Ve];_e.didParseCell&&ge.didParseCell.push(_e.didParseCell),_e.willDrawCell&&ge.willDrawCell.push(_e.willDrawCell),_e.didDrawCell&&ge.didDrawCell.push(_e.didDrawCell),_e.willDrawPage&&ge.willDrawPage.push(_e.willDrawPage),_e.didDrawPage&&ge.didDrawPage.push(_e.didDrawPage)}return ge}function J(De,Fe){var et,Te,ge,Ve,Ae,_e,xe,Qe,Ce,Ye,ut,st,pt=(0,F.parseSpacing)(Fe.margin,40/De.scaleFactor()),Tt=(et=K(De,Fe.startY))!==null&&et!==void 0?et:pt.top,ht;Fe.showFoot===!0?ht="everyPage":Fe.showFoot===!1?ht="never":ht=(Te=Fe.showFoot)!==null&&Te!==void 0?Te:"everyPage";var Wt;Fe.showHead===!0?Wt="everyPage":Fe.showHead===!1?Wt="never":Wt=(ge=Fe.showHead)!==null&&ge!==void 0?ge:"everyPage";var ie=(Ve=Fe.useCss)!==null&&Ve!==void 0?Ve:!1,ye=Fe.theme||(ie?"plain":"striped"),pe=!!Fe.horizontalPageBreak,Ie=(Ae=Fe.horizontalPageBreakRepeat)!==null&&Ae!==void 0?Ae:null;return{includeHiddenHtml:(_e=Fe.includeHiddenHtml)!==null&&_e!==void 0?_e:!1,useCss:ie,theme:ye,startY:Tt,margin:pt,pageBreak:(xe=Fe.pageBreak)!==null&&xe!==void 0?xe:"auto",rowPageBreak:(Qe=Fe.rowPageBreak)!==null&&Qe!==void 0?Qe:"auto",tableWidth:(Ce=Fe.tableWidth)!==null&&Ce!==void 0?Ce:"auto",showHead:Wt,showFoot:ht,tableLineWidth:(Ye=Fe.tableLineWidth)!==null&&Ye!==void 0?Ye:0,tableLineColor:(ut=Fe.tableLineColor)!==null&&ut!==void 0?ut:200,horizontalPageBreak:pe,horizontalPageBreakRepeat:Ie,horizontalPageBreakBehaviour:(st=Fe.horizontalPageBreakBehaviour)!==null&&st!==void 0?st:"afterAllRows"}}function K(De,Fe){var et=De.getLastAutoTable(),Te=De.scaleFactor(),ge=De.pageNumber(),Ve=!1;if(et&&et.startPageNumber){var Ae=et.startPageNumber+et.pageNumber-1;Ve=Ae===ge}return typeof Fe=="number"?Fe:(Fe==null||Fe===!1)&&Ve&&et?.finalY!=null?et.finalY+20/Te:null}function ne(De,Fe,et){var Te=Fe.head||[],ge=Fe.body||[],Ve=Fe.foot||[];if(Fe.html){var Ae=Fe.includeHiddenHtml;if(et){var _e=(0,A.parseHtml)(De,Fe.html,et,Ae,Fe.useCss)||{};Te=_e.head||Te,ge=_e.body||Te,Ve=_e.foot||Te}else console.error("Cannot parse html in non browser environment")}var xe=Fe.columns||de(Te,ge,Ve);return{columns:xe,head:Te,body:ge,foot:Ve}}function de(De,Fe,et){var Te=De[0]||Fe[0]||et[0]||[],ge=[];return Object.keys(Te).filter(function(Ve){return Ve!=="_element"}).forEach(function(Ve){var Ae=1,_e;Array.isArray(Te)?_e=Te[parseInt(Ve)]:_e=Te[Ve],typeof _e=="object"&&!Array.isArray(_e)&&(Ae=_e?.colSpan||1);for(var xe=0;xe<Ae;xe++){var Qe=void 0;Array.isArray(Te)?Qe=ge.length:Qe=Ve+(xe>0?"_".concat(xe):"");var Ce={dataKey:Qe};ge.push(Ce)}}),ge}},792:function(i,x){Object.defineProperty(x,"__esModule",{value:!0});function T(M,F,W,V){for(var R=function(K){K&&typeof K!="object"&&console.error("The options parameter should be of type object, is: "+typeof K),typeof K.extendWidth<"u"&&(K.tableWidth=K.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof K.margins<"u"&&(typeof K.margin>"u"&&(K.margin=K.margins),console.error("Use of deprecated option: margins, use margin instead.")),K.startY&&typeof K.startY!="number"&&(console.error("Invalid value for startY option",K.startY),delete K.startY),!K.didDrawPage&&(K.afterPageContent||K.beforePageContent||K.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),K.didDrawPage=function(Ve){M.applyStyles(M.userStyles),K.beforePageContent&&K.beforePageContent(Ve),M.applyStyles(M.userStyles),K.afterPageContent&&K.afterPageContent(Ve),M.applyStyles(M.userStyles),K.afterPageAdd&&Ve.pageNumber>1&&Ve.afterPageAdd(Ve),M.applyStyles(M.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(Ve){K[Ve]&&console.error('The "'.concat(Ve,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(Ve){var Ae=Ve[0],_e=Ve[1];K[_e]&&(console.error("Use of deprecated option ".concat(_e,". Use ").concat(Ae," instead")),K[Ae]=K[_e])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(Ve){var Ae=typeof Ve=="string"?Ve:Ve[0],_e=typeof Ve=="string"?Ve:Ve[1];typeof K[Ae]<"u"&&(typeof K.styles[_e]>"u"&&(K.styles[_e]=K[Ae]),console.error("Use of deprecated option: "+Ae+", use the style "+_e+" instead."))});for(var ne=0,de=["styles","bodyStyles","headStyles","footStyles"];ne<de.length;ne++){var De=de[ne];A(K[De]||{})}for(var Fe=K.columnStyles||{},et=0,Te=Object.keys(Fe);et<Te.length;et++){var ge=Te[et];A(Fe[ge]||{})}},te=0,H=[F,W,V];te<H.length;te++){var J=H[te];R(J)}}x.default=T;function A(M){M.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),M.minCellHeight||(M.minCellHeight=M.rowHeight)):M.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),M.cellWidth||(M.cellWidth=M.columnWidth))}},260:function(i,x,T){Object.defineProperty(x,"__esModule",{value:!0}),x.Column=x.Cell=x.Row=x.Table=void 0;var A=T(796),M=T(172),F=T(420),W=function(){function H(J,K){this.pageNumber=1,this.pageCount=1,this.id=J.id,this.settings=J.settings,this.styles=J.styles,this.hooks=J.hooks,this.columns=K.columns,this.head=K.head,this.body=K.body,this.foot=K.foot}return H.prototype.getHeadHeight=function(J){return this.head.reduce(function(K,ne){return K+ne.getMaxCellHeight(J)},0)},H.prototype.getFootHeight=function(J){return this.foot.reduce(function(K,ne){return K+ne.getMaxCellHeight(J)},0)},H.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},H.prototype.callCellHooks=function(J,K,ne,de,De,Fe){for(var et=0,Te=K;et<Te.length;et++){var ge=Te[et],Ve=new M.CellHookData(J,this,ne,de,De,Fe),Ae=ge(Ve)===!1;if(ne.text=Array.isArray(ne.text)?ne.text:[ne.text],Ae)return!1}return!0},H.prototype.callEndPageHooks=function(J,K){J.applyStyles(J.userStyles);for(var ne=0,de=this.hooks.didDrawPage;ne<de.length;ne++){var De=de[ne];De(new M.HookData(J,this,K))}},H.prototype.callWillDrawPageHooks=function(J,K){for(var ne=0,de=this.hooks.willDrawPage;ne<de.length;ne++){var De=de[ne];De(new M.HookData(J,this,K))}},H.prototype.getWidth=function(J){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var K=this.columns.reduce(function(de,De){return de+De.wrappedWidth},0);return K}else{var ne=this.settings.margin;return J-ne.left-ne.right}},H}();x.Table=W;var V=function(){function H(J,K,ne,de,De){De===void 0&&(De=!1),this.height=0,this.raw=J,J instanceof A.HtmlRowInput&&(this.raw=J._element,this.element=J._element),this.index=K,this.section=ne,this.cells=de,this.spansMultiplePages=De}return H.prototype.getMaxCellHeight=function(J){var K=this;return J.reduce(function(ne,de){var De;return Math.max(ne,((De=K.cells[de.index])===null||De===void 0?void 0:De.height)||0)},0)},H.prototype.hasRowSpan=function(J){var K=this;return J.filter(function(ne){var de=K.cells[ne.index];return de?de.rowSpan>1:!1}).length>0},H.prototype.canEntireRowFit=function(J,K){return this.getMaxCellHeight(K)<=J},H.prototype.getMinimumRowHeight=function(J,K){var ne=this;return J.reduce(function(de,De){var Fe=ne.cells[De.index];if(!Fe)return 0;var et=K.getLineHeight(Fe.styles.fontSize),Te=Fe.padding("vertical"),ge=Te+et;return ge>de?ge:de},0)},H}();x.Row=V;var R=function(){function H(J,K,ne){var de,De;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=K,this.section=ne,this.raw=J;var Fe=J;J!=null&&typeof J=="object"&&!Array.isArray(J)?(this.rowSpan=J.rowSpan||1,this.colSpan=J.colSpan||1,Fe=(De=(de=J.content)!==null&&de!==void 0?de:J.title)!==null&&De!==void 0?De:J,J._element&&(this.raw=J._element)):(this.rowSpan=1,this.colSpan=1);var et=Fe!=null?""+Fe:"",Te=/\r\n|\r|\n/g;this.text=et.split(Te)}return H.prototype.getTextPos=function(){var J;if(this.styles.valign==="top")J=this.y+this.padding("top");else if(this.styles.valign==="bottom")J=this.y+this.height-this.padding("bottom");else{var K=this.height-this.padding("vertical");J=this.y+K/2+this.padding("top")}var ne;if(this.styles.halign==="right")ne=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var de=this.width-this.padding("horizontal");ne=this.x+de/2+this.padding("left")}else ne=this.x+this.padding("left");return{x:ne,y:J}},H.prototype.getContentHeight=function(J,K){K===void 0&&(K=1.15);var ne=Array.isArray(this.text)?this.text.length:1,de=this.styles.fontSize/J*K,De=ne*de+this.padding("vertical");return Math.max(De,this.styles.minCellHeight)},H.prototype.padding=function(J){var K=(0,F.parseSpacing)(this.styles.cellPadding,0);return J==="vertical"?K.top+K.bottom:J==="horizontal"?K.left+K.right:K[J]},H}();x.Cell=R;var te=function(){function H(J,K,ne){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=J,this.raw=K,this.index=ne}return H.prototype.getMaxCustomCellWidth=function(J){for(var K=0,ne=0,de=J.allRows();ne<de.length;ne++){var De=de[ne],Fe=De.cells[this.index];Fe&&typeof Fe.styles.cellWidth=="number"&&(K=Math.max(K,Fe.styles.cellWidth))}return K},H}();x.Column=te},356:function(i,x){Object.defineProperty(x,"__esModule",{value:!0}),x.assign=void 0;function T(A,M,F,W,V){if(A==null)throw new TypeError("Cannot convert undefined or null to object");for(var R=Object(A),te=1;te<arguments.length;te++){var H=arguments[te];if(H!=null)for(var J in H)Object.prototype.hasOwnProperty.call(H,J)&&(R[J]=H[J])}return R}x.assign=T},972:function(i,x,T){Object.defineProperty(x,"__esModule",{value:!0}),x.createTable=void 0;var A=T(744),M=T(260),F=T(324),W=T(796),V=T(356);function R(De,Fe){var et=new A.DocHandler(De),Te=te(Fe,et.scaleFactor()),ge=new M.Table(Fe,Te);return(0,F.calculateWidths)(et,ge),et.applyStyles(et.userStyles),ge}x.createTable=R;function te(De,Fe){var et=De.content,Te=ne(et.columns);if(et.head.length===0){var ge=J(Te,"head");ge&&et.head.push(ge)}if(et.foot.length===0){var ge=J(Te,"foot");ge&&et.foot.push(ge)}var Ve=De.settings.theme,Ae=De.styles;return{columns:Te,head:H("head",et.head,Te,Ae,Ve,Fe),body:H("body",et.body,Te,Ae,Ve,Fe),foot:H("foot",et.foot,Te,Ae,Ve,Fe)}}function H(De,Fe,et,Te,ge,Ve){var Ae={},_e=Fe.map(function(xe,Qe){for(var Ce=0,Ye={},ut=0,st=0,pt=0,Tt=et;pt<Tt.length;pt++){var ht=Tt[pt];if(Ae[ht.index]==null||Ae[ht.index].left===0)if(st===0){var Wt=void 0;Array.isArray(xe)?Wt=xe[ht.index-ut-Ce]:Wt=xe[ht.dataKey];var ie={};typeof Wt=="object"&&!Array.isArray(Wt)&&(ie=Wt?.styles||{});var ye=de(De,ht,Qe,ge,Te,Ve,ie),pe=new M.Cell(Wt,ye,De);Ye[ht.dataKey]=pe,Ye[ht.index]=pe,st=pe.colSpan-1,Ae[ht.index]={left:pe.rowSpan-1,times:st}}else st--,ut++;else Ae[ht.index].left--,st=Ae[ht.index].times,Ce++}return new M.Row(xe,Qe,De,Ye)});return _e}function J(De,Fe){var et={};return De.forEach(function(Te){if(Te.raw!=null){var ge=K(Fe,Te.raw);ge!=null&&(et[Te.dataKey]=ge)}}),Object.keys(et).length>0?et:null}function K(De,Fe){if(De==="head"){if(typeof Fe=="object")return Fe.header||Fe.title||null;if(typeof Fe=="string"||typeof Fe=="number")return Fe}else if(De==="foot"&&typeof Fe=="object")return Fe.footer;return null}function ne(De){return De.map(function(Fe,et){var Te,ge,Ve;return typeof Fe=="object"?Ve=(ge=(Te=Fe.dataKey)!==null&&Te!==void 0?Te:Fe.key)!==null&&ge!==void 0?ge:et:Ve=et,new M.Column(Ve,Fe,et)})}function de(De,Fe,et,Te,ge,Ve,Ae){var _e=(0,W.getTheme)(Te),xe;De==="head"?xe=ge.headStyles:De==="body"?xe=ge.bodyStyles:De==="foot"&&(xe=ge.footStyles);var Qe=(0,V.assign)({},_e.table,_e[De],ge.styles,xe),Ce=ge.columnStyles[Fe.dataKey]||ge.columnStyles[Fe.index]||{},Ye=De==="body"?Ce:{},ut=De==="body"&&et%2===0?(0,V.assign)({},_e.alternateRow,ge.alternateRowStyles):{},st=(0,W.defaultStyles)(Ve),pt=(0,V.assign)({},st,Qe,ut,Ye);return(0,V.assign)(pt,Ae)}},664:function(i,x,T){Object.defineProperty(x,"__esModule",{value:!0}),x.addPage=x.drawTable=void 0;var A=T(420),M=T(260),F=T(744),W=T(356),V=T(136),R=T(224);function te(Ce,Ye){var ut=Ye.settings,st=ut.startY,pt=ut.margin,Tt={x:pt.left,y:st},ht=Ye.getHeadHeight(Ye.columns)+Ye.getFootHeight(Ye.columns),Wt=st+pt.bottom+ht;if(ut.pageBreak==="avoid"){var ie=Ye.body,ye=ie.reduce(function(Ue,gt){return Ue+gt.height},0);Wt+=ye}var pe=new F.DocHandler(Ce);(ut.pageBreak==="always"||ut.startY!=null&&Wt>pe.pageSize().height)&&(Qe(pe),Tt.y=pt.top),Ye.callWillDrawPageHooks(pe,Tt);var Ie=(0,W.assign)({},Tt);Ye.startPageNumber=pe.pageNumber(),ut.horizontalPageBreak?H(pe,Ye,Ie,Tt):(pe.applyStyles(pe.userStyles),(ut.showHead==="firstPage"||ut.showHead==="everyPage")&&Ye.head.forEach(function(Ue){return ge(pe,Ye,Ue,Tt,Ye.columns)}),pe.applyStyles(pe.userStyles),Ye.body.forEach(function(Ue,gt){var mt=gt===Ye.body.length-1;Te(pe,Ye,Ue,mt,Ie,Tt,Ye.columns)}),pe.applyStyles(pe.userStyles),(ut.showFoot==="lastPage"||ut.showFoot==="everyPage")&&Ye.foot.forEach(function(Ue){return ge(pe,Ye,Ue,Tt,Ye.columns)})),(0,A.addTableBorder)(pe,Ye,Ie,Tt),Ye.callEndPageHooks(pe,Tt),Ye.finalY=Tt.y,Ce.lastAutoTable=Ye,Ce.previousAutoTable=Ye,Ce.autoTable&&(Ce.autoTable.previous=Ye),pe.applyStyles(pe.userStyles)}x.drawTable=te;function H(Ce,Ye,ut,st){var pt=(0,R.calculateAllColumnsCanFitInPage)(Ce,Ye),Tt=Ye.settings;if(Tt.horizontalPageBreakBehaviour==="afterAllRows")pt.forEach(function(ye,pe){Ce.applyStyles(Ce.userStyles),pe>0?xe(Ce,Ye,ut,st,ye.columns,!0):J(Ce,Ye,st,ye.columns),K(Ce,Ye,ut,st,ye.columns),de(Ce,Ye,st,ye.columns)});else for(var ht=-1,Wt=pt[0],ie=function(){var ye=ht;if(Wt){Ce.applyStyles(Ce.userStyles);var pe=Wt.columns;ht>=0?xe(Ce,Ye,ut,st,pe,!0):J(Ce,Ye,st,pe),ye=ne(Ce,Ye,ht+1,st,pe),de(Ce,Ye,st,pe)}var Ie=ye-ht;pt.slice(1).forEach(function(Ue){Ce.applyStyles(Ce.userStyles),xe(Ce,Ye,ut,st,Ue.columns,!0),ne(Ce,Ye,ht+1,st,Ue.columns,Ie),de(Ce,Ye,st,Ue.columns)}),ht=ye};ht<Ye.body.length-1;)ie()}function J(Ce,Ye,ut,st){var pt=Ye.settings;Ce.applyStyles(Ce.userStyles),(pt.showHead==="firstPage"||pt.showHead==="everyPage")&&Ye.head.forEach(function(Tt){return ge(Ce,Ye,Tt,ut,st)})}function K(Ce,Ye,ut,st,pt){Ce.applyStyles(Ce.userStyles),Ye.body.forEach(function(Tt,ht){var Wt=ht===Ye.body.length-1;Te(Ce,Ye,Tt,Wt,ut,st,pt)})}function ne(Ce,Ye,ut,st,pt,Tt){Ce.applyStyles(Ce.userStyles),Tt=Tt??Ye.body.length;var ht=Math.min(ut+Tt,Ye.body.length),Wt=-1;return Ye.body.slice(ut,ht).forEach(function(ie,ye){var pe=ut+ye===Ye.body.length-1,Ie=_e(Ce,Ye,pe,st);ie.canEntireRowFit(Ie,pt)&&(ge(Ce,Ye,ie,st,pt),Wt=ut+ye)}),Wt}function de(Ce,Ye,ut,st){var pt=Ye.settings;Ce.applyStyles(Ce.userStyles),(pt.showFoot==="lastPage"||pt.showFoot==="everyPage")&&Ye.foot.forEach(function(Tt){return ge(Ce,Ye,Tt,ut,st)})}function De(Ce,Ye,ut){var st=ut.getLineHeight(Ce.styles.fontSize),pt=Ce.padding("vertical"),Tt=Math.floor((Ye-pt)/st);return Math.max(0,Tt)}function Fe(Ce,Ye,ut,st){var pt={};Ce.spansMultiplePages=!0,Ce.height=0;for(var Tt=0,ht=0,Wt=ut.columns;ht<Wt.length;ht++){var ie=Wt[ht],ye=Ce.cells[ie.index];if(ye){Array.isArray(ye.text)||(ye.text=[ye.text]);var pe=new M.Cell(ye.raw,ye.styles,ye.section);pe=(0,W.assign)(pe,ye),pe.text=[];var Ie=De(ye,Ye,st);ye.text.length>Ie&&(pe.text=ye.text.splice(Ie,ye.text.length));var Ue=st.scaleFactor(),gt=st.getLineHeightFactor();ye.contentHeight=ye.getContentHeight(Ue,gt),ye.contentHeight>=Ye&&(ye.contentHeight=Ye,pe.styles.minCellHeight-=Ye),ye.contentHeight>Ce.height&&(Ce.height=ye.contentHeight),pe.contentHeight=pe.getContentHeight(Ue,gt),pe.contentHeight>Tt&&(Tt=pe.contentHeight),pt[ie.index]=pe}}var mt=new M.Row(Ce.raw,-1,Ce.section,pt,!0);mt.height=Tt;for(var wt=0,Lt=ut.columns;wt<Lt.length;wt++){var ie=Lt[wt],pe=mt.cells[ie.index];pe&&(pe.height=mt.height);var ye=Ce.cells[ie.index];ye&&(ye.height=Ce.height)}return mt}function et(Ce,Ye,ut,st){var pt=Ce.pageSize().height,Tt=st.settings.margin,ht=Tt.top+Tt.bottom,Wt=pt-ht;Ye.section==="body"&&(Wt-=st.getHeadHeight(st.columns)+st.getFootHeight(st.columns));var ie=Ye.getMinimumRowHeight(st.columns,Ce),ye=ie<ut;if(ie>Wt)return console.error("Will not be able to print row ".concat(Ye.index," correctly since it's minimum height is larger than page height")),!0;if(!ye)return!1;var pe=Ye.hasRowSpan(st.columns),Ie=Ye.getMaxCellHeight(st.columns)>Wt;return Ie?(pe&&console.error("The content of row ".concat(Ye.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(pe||st.settings.rowPageBreak==="avoid")}function Te(Ce,Ye,ut,st,pt,Tt,ht){var Wt=_e(Ce,Ye,st,Tt);if(ut.canEntireRowFit(Wt,ht))ge(Ce,Ye,ut,Tt,ht);else if(et(Ce,ut,Wt,Ye)){var ie=Fe(ut,Wt,Ye,Ce);ge(Ce,Ye,ut,Tt,ht),xe(Ce,Ye,pt,Tt,ht),Te(Ce,Ye,ie,st,pt,Tt,ht)}else xe(Ce,Ye,pt,Tt,ht),Te(Ce,Ye,ut,st,pt,Tt,ht)}function ge(Ce,Ye,ut,st,pt){st.x=Ye.settings.margin.left;for(var Tt=0,ht=pt;Tt<ht.length;Tt++){var Wt=ht[Tt],ie=ut.cells[Wt.index];if(!ie){st.x+=Wt.width;continue}Ce.applyStyles(ie.styles),ie.x=st.x,ie.y=st.y;var ye=Ye.callCellHooks(Ce,Ye.hooks.willDrawCell,ie,ut,Wt,st);if(ye===!1){st.x+=Wt.width;continue}Ve(Ce,ie,st);var pe=ie.getTextPos();(0,V.default)(ie.text,pe.x,pe.y,{halign:ie.styles.halign,valign:ie.styles.valign,maxWidth:Math.ceil(ie.width-ie.padding("left")-ie.padding("right"))},Ce.getDocument()),Ye.callCellHooks(Ce,Ye.hooks.didDrawCell,ie,ut,Wt,st),st.x+=Wt.width}st.y+=ut.height}function Ve(Ce,Ye,ut){var st=Ye.styles;if(Ce.getDocument().setFillColor(Ce.getDocument().getFillColor()),typeof st.lineWidth=="number"){var pt=(0,A.getFillStyle)(st.lineWidth,st.fillColor);pt&&Ce.rect(Ye.x,ut.y,Ye.width,Ye.height,pt)}else typeof st.lineWidth=="object"&&(st.fillColor&&Ce.rect(Ye.x,ut.y,Ye.width,Ye.height,"F"),Ae(Ce,Ye,ut,st.lineWidth))}function Ae(Ce,Ye,ut,st){var pt,Tt,ht,Wt;st.top&&(pt=ut.x,Tt=ut.y,ht=ut.x+Ye.width,Wt=ut.y,st.right&&(ht+=.5*st.right),st.left&&(pt-=.5*st.left),ie(st.top,pt,Tt,ht,Wt)),st.bottom&&(pt=ut.x,Tt=ut.y+Ye.height,ht=ut.x+Ye.width,Wt=ut.y+Ye.height,st.right&&(ht+=.5*st.right),st.left&&(pt-=.5*st.left),ie(st.bottom,pt,Tt,ht,Wt)),st.left&&(pt=ut.x,Tt=ut.y,ht=ut.x,Wt=ut.y+Ye.height,st.top&&(Tt-=.5*st.top),st.bottom&&(Wt+=.5*st.bottom),ie(st.left,pt,Tt,ht,Wt)),st.right&&(pt=ut.x+Ye.width,Tt=ut.y,ht=ut.x+Ye.width,Wt=ut.y+Ye.height,st.top&&(Tt-=.5*st.top),st.bottom&&(Wt+=.5*st.bottom),ie(st.right,pt,Tt,ht,Wt));function ie(ye,pe,Ie,Ue,gt){Ce.getDocument().setLineWidth(ye),Ce.getDocument().line(pe,Ie,Ue,gt,"S")}}function _e(Ce,Ye,ut,st){var pt=Ye.settings.margin.bottom,Tt=Ye.settings.showFoot;return(Tt==="everyPage"||Tt==="lastPage"&&ut)&&(pt+=Ye.getFootHeight(Ye.columns)),Ce.pageSize().height-st.y-pt}function xe(Ce,Ye,ut,st,pt,Tt){pt===void 0&&(pt=[]),Tt===void 0&&(Tt=!1),Ce.applyStyles(Ce.userStyles),Ye.settings.showFoot==="everyPage"&&!Tt&&Ye.foot.forEach(function(Wt){return ge(Ce,Ye,Wt,st,pt)}),Ye.callEndPageHooks(Ce,st);var ht=Ye.settings.margin;(0,A.addTableBorder)(Ce,Ye,ut,st),Qe(Ce),Ye.pageNumber++,Ye.pageCount++,st.x=ht.left,st.y=ht.top,ut.y=ht.top,Ye.callWillDrawPageHooks(Ce,st),Ye.settings.showHead==="everyPage"&&(Ye.head.forEach(function(Wt){return ge(Ce,Ye,Wt,st,pt)}),Ce.applyStyles(Ce.userStyles))}x.addPage=xe;function Qe(Ce){var Ye=Ce.pageNumber();Ce.setPage(Ye+1);var ut=Ce.pageNumber();return ut===Ye?(Ce.addPage(),!0):!1}},224:function(i,x,T){Object.defineProperty(x,"__esModule",{value:!0}),x.calculateAllColumnsCanFitInPage=void 0;var A=T(420);function M(W,V,R){var te;R===void 0&&(R={});var H=(0,A.getPageAvailableWidth)(W,V),J=new Map,K=[],ne=[],de=[];V.settings.horizontalPageBreakRepeat,Array.isArray(V.settings.horizontalPageBreakRepeat)?de=V.settings.horizontalPageBreakRepeat:(typeof V.settings.horizontalPageBreakRepeat=="string"||typeof V.settings.horizontalPageBreakRepeat=="number")&&(de=[V.settings.horizontalPageBreakRepeat]),de.forEach(function(Te){var ge=V.columns.find(function(Ve){return Ve.dataKey===Te||Ve.index===Te});ge&&!J.has(ge.index)&&(J.set(ge.index,!0),K.push(ge.index),ne.push(V.columns[ge.index]),H-=ge.wrappedWidth)});for(var De=!0,Fe=(te=R?.start)!==null&&te!==void 0?te:0;Fe<V.columns.length;){if(J.has(Fe)){Fe++;continue}var et=V.columns[Fe].wrappedWidth;if(De||H>=et)De=!1,K.push(Fe),ne.push(V.columns[Fe]),H-=et;else break;Fe++}return{colIndexes:K,columns:ne,lastIndex:Fe-1}}function F(W,V){for(var R=[],te=0;te<V.columns.length;te++){var H=M(W,V,{start:te});H.columns.length&&(R.push(H),te=H.lastIndex)}return R}x.calculateAllColumnsCanFitInPage=F},324:function(i,x,T){Object.defineProperty(x,"__esModule",{value:!0}),x.ellipsize=x.resizeColumns=x.calculateWidths=void 0;var A=T(420);function M(K,ne){F(K,ne);var de=[],De=0;ne.columns.forEach(function(et){var Te=et.getMaxCustomCellWidth(ne);Te?et.width=Te:(et.width=et.wrappedWidth,de.push(et)),De+=et.width});var Fe=ne.getWidth(K.pageSize().width)-De;Fe&&(Fe=W(de,Fe,function(et){return Math.max(et.minReadableWidth,et.minWidth)})),Fe&&(Fe=W(de,Fe,function(et){return et.minWidth})),Fe=Math.abs(Fe),!ne.settings.horizontalPageBreak&&Fe>.1/K.scaleFactor()&&(Fe=Fe<1?Fe:Math.round(Fe),console.warn("Of the table content, ".concat(Fe," units width could not fit page"))),R(ne),te(ne,K),V(ne)}x.calculateWidths=M;function F(K,ne){var de=K.scaleFactor(),De=ne.settings.horizontalPageBreak,Fe=(0,A.getPageAvailableWidth)(K,ne);ne.allRows().forEach(function(et){for(var Te=0,ge=ne.columns;Te<ge.length;Te++){var Ve=ge[Te],Ae=et.cells[Ve.index];if(Ae){var _e=ne.hooks.didParseCell;ne.callCellHooks(K,_e,Ae,et,Ve,null);var xe=Ae.padding("horizontal");Ae.contentWidth=(0,A.getStringWidth)(Ae.text,Ae.styles,K)+xe;var Qe=(0,A.getStringWidth)(Ae.text.join(" ").split(/\s+/),Ae.styles,K);if(Ae.minReadableWidth=Qe+Ae.padding("horizontal"),typeof Ae.styles.cellWidth=="number")Ae.minWidth=Ae.styles.cellWidth,Ae.wrappedWidth=Ae.styles.cellWidth;else if(Ae.styles.cellWidth==="wrap"||De===!0)Ae.contentWidth>Fe?(Ae.minWidth=Fe,Ae.wrappedWidth=Fe):(Ae.minWidth=Ae.contentWidth,Ae.wrappedWidth=Ae.contentWidth);else{var Ce=10/de;Ae.minWidth=Ae.styles.minCellWidth||Ce,Ae.wrappedWidth=Ae.contentWidth,Ae.minWidth>Ae.wrappedWidth&&(Ae.wrappedWidth=Ae.minWidth)}}}}),ne.allRows().forEach(function(et){for(var Te=0,ge=ne.columns;Te<ge.length;Te++){var Ve=ge[Te],Ae=et.cells[Ve.index];if(Ae&&Ae.colSpan===1)Ve.wrappedWidth=Math.max(Ve.wrappedWidth,Ae.wrappedWidth),Ve.minWidth=Math.max(Ve.minWidth,Ae.minWidth),Ve.minReadableWidth=Math.max(Ve.minReadableWidth,Ae.minReadableWidth);else{var _e=ne.styles.columnStyles[Ve.dataKey]||ne.styles.columnStyles[Ve.index]||{},xe=_e.cellWidth||_e.minCellWidth;xe&&typeof xe=="number"&&(Ve.minWidth=xe,Ve.wrappedWidth=xe)}Ae&&(Ae.colSpan>1&&!Ve.minWidth&&(Ve.minWidth=Ae.minWidth),Ae.colSpan>1&&!Ve.wrappedWidth&&(Ve.wrappedWidth=Ae.minWidth))}})}function W(K,ne,de){for(var De=ne,Fe=K.reduce(function(Ce,Ye){return Ce+Ye.wrappedWidth},0),et=0;et<K.length;et++){var Te=K[et],ge=Te.wrappedWidth/Fe,Ve=De*ge,Ae=Te.width+Ve,_e=de(Te),xe=Ae<_e?_e:Ae;ne-=xe-Te.width,Te.width=xe}if(ne=Math.round(ne*1e10)/1e10,ne){var Qe=K.filter(function(Ce){return ne<0?Ce.width>de(Ce):!0});Qe.length&&(ne=W(Qe,ne,de))}return ne}x.resizeColumns=W;function V(K){for(var ne={},de=1,De=K.allRows(),Fe=0;Fe<De.length;Fe++)for(var et=De[Fe],Te=0,ge=K.columns;Te<ge.length;Te++){var Ve=ge[Te],Ae=ne[Ve.index];if(de>1)de--,delete et.cells[Ve.index];else if(Ae)Ae.cell.height+=et.height,de=Ae.cell.colSpan,delete et.cells[Ve.index],Ae.left--,Ae.left<=1&&delete ne[Ve.index];else{var _e=et.cells[Ve.index];if(!_e)continue;if(_e.height=et.height,_e.rowSpan>1){var xe=De.length-Fe,Qe=_e.rowSpan>xe?xe:_e.rowSpan;ne[Ve.index]={cell:_e,left:Qe,row:et}}}}}function R(K){for(var ne=K.allRows(),de=0;de<ne.length;de++)for(var De=ne[de],Fe=null,et=0,Te=0,ge=0;ge<K.columns.length;ge++){var Ve=K.columns[ge];if(Te-=1,Te>1&&K.columns[ge+1])et+=Ve.width,delete De.cells[Ve.index];else if(Fe){var Ae=Fe;delete De.cells[Ve.index],Fe=null,Ae.width=Ve.width+et}else{var Ae=De.cells[Ve.index];if(!Ae)continue;if(Te=Ae.colSpan,et=0,Ae.colSpan>1){Fe=Ae,et+=Ve.width;continue}Ae.width=Ve.width+et}}}function te(K,ne){for(var de={count:0,height:0},De=0,Fe=K.allRows();De<Fe.length;De++){for(var et=Fe[De],Te=0,ge=K.columns;Te<ge.length;Te++){var Ve=ge[Te],Ae=et.cells[Ve.index];if(Ae){ne.applyStyles(Ae.styles,!0);var _e=Ae.width-Ae.padding("horizontal");if(Ae.styles.overflow==="linebreak")Ae.text=ne.splitTextToSize(Ae.text,_e+1/ne.scaleFactor(),{fontSize:Ae.styles.fontSize});else if(Ae.styles.overflow==="ellipsize")Ae.text=H(Ae.text,_e,Ae.styles,ne,"...");else if(Ae.styles.overflow==="hidden")Ae.text=H(Ae.text,_e,Ae.styles,ne,"");else if(typeof Ae.styles.overflow=="function"){var xe=Ae.styles.overflow(Ae.text,_e);typeof xe=="string"?Ae.text=[xe]:Ae.text=xe}Ae.contentHeight=Ae.getContentHeight(ne.scaleFactor(),ne.getLineHeightFactor());var Qe=Ae.contentHeight/Ae.rowSpan;Ae.rowSpan>1&&de.count*de.height<Qe*Ae.rowSpan?de={height:Qe,count:Ae.rowSpan}:de&&de.count>0&&de.height>Qe&&(Qe=de.height),Qe>et.height&&(et.height=Qe)}}de.count--}}function H(K,ne,de,De,Fe){return K.map(function(et){return J(et,ne,de,De,Fe)})}x.ellipsize=H;function J(K,ne,de,De,Fe){var et=1e4*De.scaleFactor();if(ne=Math.ceil(ne*et)/et,ne>=(0,A.getStringWidth)(K,de,De))return K;for(;ne<(0,A.getStringWidth)(K+Fe,de,De)&&!(K.length<=1);)K=K.substring(0,K.length-1);return K.trim()+Fe}},964:function(i){if(typeof a>"u"){var x=new Error("Cannot find module 'undefined'");throw x.code="MODULE_NOT_FOUND",x}i.exports=a}},l={};function c(i){var x=l[i];if(x!==void 0)return x.exports;var T=l[i]={exports:{}};return n[i].call(T.exports,T,T.exports,c),T.exports}var f={};return function(){var i=f;Object.defineProperty(i,"__esModule",{value:!0}),i.Cell=i.Column=i.Row=i.Table=i.CellHookData=i.__drawTable=i.__createTable=i.applyPlugin=void 0;var x=c(340),T=c(776),A=c(664),M=c(972),F=c(260);Object.defineProperty(i,"Table",{enumerable:!0,get:function(){return F.Table}});var W=c(172);Object.defineProperty(i,"CellHookData",{enumerable:!0,get:function(){return W.CellHookData}});var V=c(260);Object.defineProperty(i,"Cell",{enumerable:!0,get:function(){return V.Cell}}),Object.defineProperty(i,"Column",{enumerable:!0,get:function(){return V.Column}}),Object.defineProperty(i,"Row",{enumerable:!0,get:function(){return V.Row}});function R(ne){(0,x.default)(ne)}i.applyPlugin=R;function te(ne,de){var De=(0,T.parseInput)(ne,de),Fe=(0,M.createTable)(ne,De);(0,A.drawTable)(ne,Fe)}function H(ne,de){var De=(0,T.parseInput)(ne,de);return(0,M.createTable)(ne,De)}i.__createTable=H;function J(ne,de){(0,A.drawTable)(ne,de)}i.__drawTable=J;try{var K=c(964);K.jsPDF&&(K=K.jsPDF),R(K)}catch{}i.default=te}(),f}()})});var aE=(()=>{let n=class n{constructor(){this.title="pruebaProgramcionYDisenoBasica"}};n.\u0275fac=function(f){return new(f||n)},n.\u0275cmp=wa({type:n,selectors:[["app-root"]],standalone:!0,features:[Aa],decls:1,vars:0,template:function(f,i){f&1&&an(0,"router-outlet")},dependencies:[rE]});let a=n;return a})();var Hy;try{Hy=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Hy=!1}var Ya=(()=>{let n=class n{constructor(c){this._platformId=c,this.isBrowser=this._platformId?XS(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||Hy)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}};n.\u0275fac=function(f){return new(f||n)(Tn(LS))},n.\u0275prov=fa({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();var $m,oE=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function Gy(){if($m)return $m;if(typeof document!="object"||!document)return $m=new Set(oE),$m;let a=document.createElement("input");return $m=new Set(oE.filter(n=>(a.setAttribute("type",n),a.type===n))),$m}var yg;function $D(){if(yg==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>yg=!0}))}finally{yg=yg||!1}return yg}function Lf(a){return $D()?a:!!a.capture}var Uy;function XD(){if(Uy==null){let a=typeof document<"u"?document.head:null;Uy=!!(a&&(a.createShadowRoot||a.attachShadow))}return Uy}function sE(a){if(XD()){let n=a.getRootNode?a.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&n instanceof ShadowRoot)return n}return null}function Ld(a){return a.composedPath?a.composedPath()[0]:a.target}function lE(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function Op(a){return a!=null&&`${a}`!="false"}function Wy(a){return Array.isArray(a)?a:[a]}function jh(a){return a instanceof Ln?a.nativeElement:a}var ZD=(()=>{let n=class n{create(c){return typeof MutationObserver>"u"?null:new MutationObserver(c)}};n.\u0275fac=function(f){return new(f||n)},n.\u0275prov=fa({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();var cE=(()=>{let n=class n{};n.\u0275fac=function(f){return new(f||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Un({providers:[ZD]});let a=n;return a})();var uE=new Set,Np,YD=(()=>{let n=class n{constructor(c,f){this._platform=c,this._nonce=f,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):JD}matchMedia(c){return(this._platform.WEBKIT||this._platform.BLINK)&&KD(c,this._nonce),this._matchMedia(c)}};n.\u0275fac=function(f){return new(f||n)(Tn(Ya),Tn(RS,8))},n.\u0275prov=fa({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();function KD(a,n){if(!uE.has(a))try{Np||(Np=document.createElement("style"),n&&Np.setAttribute("nonce",n),Np.setAttribute("type","text/css"),document.head.appendChild(Np)),Np.sheet&&(Np.sheet.insertRule(`@media ${a} {body{ }}`,0),uE.add(a))}catch(l){console.error(l)}}function JD(a){return{matches:a==="all"||a==="",media:a,addListener:()=>{},removeListener:()=>{}}}var dE=(()=>{let n=class n{constructor(c,f){this._mediaMatcher=c,this._zone=f,this._queries=new Map,this._destroySubject=new Mo}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(c){return hE(Wy(c)).some(i=>this._registerQuery(i).mql.matches)}observe(c){let i=hE(Wy(c)).map(T=>this._registerQuery(T).observable),x=CS(i);return x=IS(x.pipe(FS(1)),x.pipe(m1(1),Py(0))),x.pipe(Hm(T=>{let A={matches:!1,breakpoints:{}};return T.forEach(({matches:M,query:F})=>{A.matches=A.matches||M,A.breakpoints[F]=M}),A}))}_registerQuery(c){if(this._queries.has(c))return this._queries.get(c);let f=this._mediaMatcher.matchMedia(c),x={observable:new _g(T=>{let A=M=>this._zone.run(()=>T.next(M));return f.addListener(A),()=>{f.removeListener(A)}}).pipe(Oy(f),Hm(({matches:T})=>({query:c,matches:T})),Kl(this._destroySubject)),mql:f};return this._queries.set(c,x),x}};n.\u0275fac=function(f){return new(f||n)(Tn(YD),Tn(Wn))},n.\u0275prov=fa({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();function hE(a){return a.map(n=>n.split(",")).reduce((n,l)=>n.concat(l)).map(n=>n.trim())}function $y(a){return a.buttons===0||a.detail===0}function Xy(a){let n=a.touches&&a.touches[0]||a.changedTouches&&a.changedTouches[0];return!!n&&n.identifier===-1&&(n.radiusX==null||n.radiusX===1)&&(n.radiusY==null||n.radiusY===1)}var QD=new Hn("cdk-input-modality-detector-options"),eF={ignoreKeys:[18,17,224,91,16]},mE=650,Xm=Lf({passive:!0,capture:!0}),tF=(()=>{let n=class n{get mostRecentModality(){return this._modality.value}constructor(c,f,i,x){this._platform=c,this._mostRecentTarget=null,this._modality=new d1(null),this._lastTouchMs=0,this._onKeydown=T=>{this._options?.ignoreKeys?.some(A=>A===T.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Ld(T))},this._onMousedown=T=>{Date.now()-this._lastTouchMs<mE||(this._modality.next($y(T)?"keyboard":"mouse"),this._mostRecentTarget=Ld(T))},this._onTouchstart=T=>{if(Xy(T)){this._modality.next("keyboard");return}this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Ld(T)},this._options=In(In({},eF),x),this.modalityDetected=this._modality.pipe(m1(1)),this.modalityChanged=this.modalityDetected.pipe(Ly()),c.isBrowser&&f.runOutsideAngular(()=>{i.addEventListener("keydown",this._onKeydown,Xm),i.addEventListener("mousedown",this._onMousedown,Xm),i.addEventListener("touchstart",this._onTouchstart,Xm)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Xm),document.removeEventListener("mousedown",this._onMousedown,Xm),document.removeEventListener("touchstart",this._onTouchstart,Xm))}};n.\u0275fac=function(f){return new(f||n)(Tn(Ya),Tn(Wn),Tn(is),Tn(QD,8))},n.\u0275prov=fa({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();var b1=function(a){return a[a.IMMEDIATE=0]="IMMEDIATE",a[a.EVENTUAL=1]="EVENTUAL",a}(b1||{}),iF=new Hn("cdk-focus-monitor-default-options"),y1=Lf({passive:!0,capture:!0}),gE=(()=>{let n=class n{constructor(c,f,i,x,T){this._ngZone=c,this._platform=f,this._inputModalityDetector=i,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Mo,this._rootNodeFocusAndBlurListener=A=>{let M=Ld(A);for(let F=M;F;F=F.parentElement)A.type==="focus"?this._onFocus(A,F):this._onBlur(A,F)},this._document=x,this._detectionMode=T?.detectionMode||b1.IMMEDIATE}monitor(c,f=!1){let i=jh(c);if(!this._platform.isBrowser||i.nodeType!==1)return Fp();let x=sE(i)||this._getDocument(),T=this._elementInfo.get(i);if(T)return f&&(T.checkChildren=!0),T.subject;let A={checkChildren:f,subject:new Mo,rootNode:x};return this._elementInfo.set(i,A),this._registerGlobalListeners(A),A.subject}stopMonitoring(c){let f=jh(c),i=this._elementInfo.get(f);i&&(i.subject.complete(),this._setClasses(f),this._elementInfo.delete(f),this._removeGlobalListeners(i))}focusVia(c,f,i){let x=jh(c),T=this._getDocument().activeElement;x===T?this._getClosestElementsInfo(x).forEach(([A,M])=>this._originChanged(A,f,M)):(this._setOrigin(f),typeof x.focus=="function"&&x.focus(i))}ngOnDestroy(){this._elementInfo.forEach((c,f)=>this.stopMonitoring(f))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(c){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(c)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:c&&this._isLastInteractionFromInputLabel(c)?"mouse":"program"}_shouldBeAttributedToTouch(c){return this._detectionMode===b1.EVENTUAL||!!c?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(c,f){c.classList.toggle("cdk-focused",!!f),c.classList.toggle("cdk-touch-focused",f==="touch"),c.classList.toggle("cdk-keyboard-focused",f==="keyboard"),c.classList.toggle("cdk-mouse-focused",f==="mouse"),c.classList.toggle("cdk-program-focused",f==="program")}_setOrigin(c,f=!1){this._ngZone.runOutsideAngular(()=>{if(this._origin=c,this._originFromTouchInteraction=c==="touch"&&f,this._detectionMode===b1.IMMEDIATE){clearTimeout(this._originTimeoutId);let i=this._originFromTouchInteraction?mE:1;this._originTimeoutId=setTimeout(()=>this._origin=null,i)}})}_onFocus(c,f){let i=this._elementInfo.get(f),x=Ld(c);!i||!i.checkChildren&&f!==x||this._originChanged(f,this._getFocusOrigin(x),i)}_onBlur(c,f){let i=this._elementInfo.get(f);!i||i.checkChildren&&c.relatedTarget instanceof Node&&f.contains(c.relatedTarget)||(this._setClasses(f),this._emitOrigin(i,null))}_emitOrigin(c,f){c.subject.observers.length&&this._ngZone.run(()=>c.subject.next(f))}_registerGlobalListeners(c){if(!this._platform.isBrowser)return;let f=c.rootNode,i=this._rootNodeFocusListenerCount.get(f)||0;i||this._ngZone.runOutsideAngular(()=>{f.addEventListener("focus",this._rootNodeFocusAndBlurListener,y1),f.addEventListener("blur",this._rootNodeFocusAndBlurListener,y1)}),this._rootNodeFocusListenerCount.set(f,i+1),++this._monitoredElementCount===1&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Kl(this._stopInputModalityDetector)).subscribe(x=>{this._setOrigin(x,!0)}))}_removeGlobalListeners(c){let f=c.rootNode;if(this._rootNodeFocusListenerCount.has(f)){let i=this._rootNodeFocusListenerCount.get(f);i>1?this._rootNodeFocusListenerCount.set(f,i-1):(f.removeEventListener("focus",this._rootNodeFocusAndBlurListener,y1),f.removeEventListener("blur",this._rootNodeFocusAndBlurListener,y1),this._rootNodeFocusListenerCount.delete(f))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(c,f,i){this._setClasses(c,f),this._emitOrigin(i,f),this._lastFocusOrigin=f}_getClosestElementsInfo(c){let f=[];return this._elementInfo.forEach((i,x)=>{(x===c||i.checkChildren&&x.contains(c))&&f.push([x,i])}),f}_isLastInteractionFromInputLabel(c){let{_mostRecentTarget:f,mostRecentModality:i}=this._inputModalityDetector;if(i!=="mouse"||!f||f===c||c.nodeName!=="INPUT"&&c.nodeName!=="TEXTAREA"||c.disabled)return!1;let x=c.labels;if(x){for(let T=0;T<x.length;T++)if(x[T].contains(f))return!0}return!1}};n.\u0275fac=function(f){return new(f||n)(Tn(Wn),Tn(Ya),Tn(tF),Tn(is,8),Tn(iF,8))},n.\u0275prov=fa({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();var Bp=function(a){return a[a.NONE=0]="NONE",a[a.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",a[a.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",a}(Bp||{}),fE="cdk-high-contrast-black-on-white",pE="cdk-high-contrast-white-on-black",qy="cdk-high-contrast-active",_E=(()=>{let n=class n{constructor(c,f){this._platform=c,this._document=f,this._breakpointSubscription=Qn(dE).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return Bp.NONE;let c=this._document.createElement("div");c.style.backgroundColor="rgb(1,2,3)",c.style.position="absolute",this._document.body.appendChild(c);let f=this._document.defaultView||window,i=f&&f.getComputedStyle?f.getComputedStyle(c):null,x=(i&&i.backgroundColor||"").replace(/ /g,"");switch(c.remove(),x){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return Bp.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return Bp.BLACK_ON_WHITE}return Bp.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let c=this._document.body.classList;c.remove(qy,fE,pE),this._hasCheckedHighContrastMode=!0;let f=this.getHighContrastMode();f===Bp.BLACK_ON_WHITE?c.add(qy,fE):f===Bp.WHITE_ON_BLACK&&c.add(qy,pE)}}};n.\u0275fac=function(f){return new(f||n)(Tn(Ya),Tn(is))},n.\u0275prov=fa({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();var nF=new Hn("cdk-dir-doc",{providedIn:"root",factory:aF});function aF(){return Qn(is)}var oF=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function sF(a){let n=a?.toLowerCase()||"";return n==="auto"&&typeof navigator<"u"&&navigator?.language?oF.test(navigator.language)?"rtl":"ltr":n==="rtl"?"rtl":"ltr"}var w1=(()=>{let n=class n{constructor(c){if(this.value="ltr",this.change=new lu,c){let f=c.body?c.body.dir:null,i=c.documentElement?c.documentElement.dir:null;this.value=sF(f||i||"ltr")}}ngOnDestroy(){this.change.complete()}};n.\u0275fac=function(f){return new(f||n)(Tn(nF,8))},n.\u0275prov=fa({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();var Zm=(()=>{let n=class n{};n.\u0275fac=function(f){return new(f||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Un({});let a=n;return a})();function uF(){return!0}var hF=new Hn("mat-sanity-checks",{providedIn:"root",factory:uF}),Wo=(()=>{let n=class n{constructor(c,f,i){this._sanityChecks=f,this._document=i,this._hasDoneGlobalChecks=!1,c._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(c){return lE()?!1:typeof this._sanityChecks=="boolean"?this._sanityChecks:!!this._sanityChecks[c]}};n.\u0275fac=function(f){return new(f||n)(Tn(_E),Tn(hF,8),Tn(is))},n.\u0275mod=Gn({type:n}),n.\u0275inj=Un({imports:[Zm,Zm]});let a=n;return a})();var S1=class{constructor(n,l,c,f,i){this._defaultMatcher=n,this.ngControl=l,this._parentFormGroup=c,this._parentForm=f,this._stateChanges=i,this.errorState=!1}updateErrorState(){let n=this.errorState,l=this._parentFormGroup||this._parentForm,c=this.matcher||this._defaultMatcher,f=this.ngControl?this.ngControl.control:null,i=c?.isErrorState(f,l)??!1;i!==n&&(this.errorState=i,this._stateChanges.next())}};var CE=(()=>{let n=class n{isErrorState(c,f){return!!(c&&c.invalid&&(c.touched||f&&f.submitted))}};n.\u0275fac=function(f){return new(f||n)},n.\u0275prov=fa({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();var cu=function(a){return a[a.FADING_IN=0]="FADING_IN",a[a.VISIBLE=1]="VISIBLE",a[a.FADING_OUT=2]="FADING_OUT",a[a.HIDDEN=3]="HIDDEN",a}(cu||{}),Ky=class{constructor(n,l,c,f=!1){this._renderer=n,this.element=l,this.config=c,this._animationForciblyDisabledThroughCss=f,this.state=cu.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}},vE=Lf({passive:!0,capture:!0}),Jy=class{constructor(){this._events=new Map,this._delegateEventHandler=n=>{let l=Ld(n);l&&this._events.get(n.type)?.forEach((c,f)=>{(f===l||f.contains(l))&&c.forEach(i=>i.handleEvent(n))})}}addHandler(n,l,c,f){let i=this._events.get(l);if(i){let x=i.get(c);x?x.add(f):i.set(c,new Set([f]))}else this._events.set(l,new Map([[c,new Set([f])]])),n.runOutsideAngular(()=>{document.addEventListener(l,this._delegateEventHandler,vE)})}removeHandler(n,l,c){let f=this._events.get(n);if(!f)return;let i=f.get(l);i&&(i.delete(c),i.size===0&&f.delete(l),f.size===0&&(this._events.delete(n),document.removeEventListener(n,this._delegateEventHandler,vE)))}},yE={enterDuration:225,exitDuration:150},dF=800,bE=Lf({passive:!0,capture:!0}),wE=["mousedown","touchstart"],TE=["mouseup","mouseleave","touchend","touchcancel"],bg=class bg{constructor(n,l,c,f){this._target=n,this._ngZone=l,this._platform=f,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,f.isBrowser&&(this._containerElement=jh(c))}fadeInRipple(n,l,c={}){let f=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),i=In(In({},yE),c.animation);c.centered&&(n=f.left+f.width/2,l=f.top+f.height/2);let x=c.radius||fF(n,l,f),T=n-f.left,A=l-f.top,M=i.enterDuration,F=document.createElement("div");F.classList.add("mat-ripple-element"),F.style.left=`${T-x}px`,F.style.top=`${A-x}px`,F.style.height=`${x*2}px`,F.style.width=`${x*2}px`,c.color!=null&&(F.style.backgroundColor=c.color),F.style.transitionDuration=`${M}ms`,this._containerElement.appendChild(F);let W=window.getComputedStyle(F),V=W.transitionProperty,R=W.transitionDuration,te=V==="none"||R==="0s"||R==="0s, 0s"||f.width===0&&f.height===0,H=new Ky(this,F,c,te);F.style.transform="scale3d(1, 1, 1)",H.state=cu.FADING_IN,c.persistent||(this._mostRecentTransientRipple=H);let J=null;return!te&&(M||i.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let K=()=>{J&&(J.fallbackTimer=null),clearTimeout(de),this._finishRippleTransition(H)},ne=()=>this._destroyRipple(H),de=setTimeout(ne,M+100);F.addEventListener("transitionend",K),F.addEventListener("transitioncancel",ne),J={onTransitionEnd:K,onTransitionCancel:ne,fallbackTimer:de}}),this._activeRipples.set(H,J),(te||!M)&&this._finishRippleTransition(H),H}fadeOutRipple(n){if(n.state===cu.FADING_OUT||n.state===cu.HIDDEN)return;let l=n.element,c=In(In({},yE),n.config.animation);l.style.transitionDuration=`${c.exitDuration}ms`,l.style.opacity="0",n.state=cu.FADING_OUT,(n._animationForciblyDisabledThroughCss||!c.exitDuration)&&this._finishRippleTransition(n)}fadeOutAll(){this._getActiveRipples().forEach(n=>n.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(n=>{n.config.persistent||n.fadeOut()})}setupTriggerEvents(n){let l=jh(n);!this._platform.isBrowser||!l||l===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=l,wE.forEach(c=>{bg._eventManager.addHandler(this._ngZone,c,l,this)}))}handleEvent(n){n.type==="mousedown"?this._onMousedown(n):n.type==="touchstart"?this._onTouchStart(n):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{TE.forEach(l=>{this._triggerElement.addEventListener(l,this,bE)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(n){n.state===cu.FADING_IN?this._startFadeOutTransition(n):n.state===cu.FADING_OUT&&this._destroyRipple(n)}_startFadeOutTransition(n){let l=n===this._mostRecentTransientRipple,{persistent:c}=n.config;n.state=cu.VISIBLE,!c&&(!l||!this._isPointerDown)&&n.fadeOut()}_destroyRipple(n){let l=this._activeRipples.get(n)??null;this._activeRipples.delete(n),this._activeRipples.size||(this._containerRect=null),n===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),n.state=cu.HIDDEN,l!==null&&(n.element.removeEventListener("transitionend",l.onTransitionEnd),n.element.removeEventListener("transitioncancel",l.onTransitionCancel),l.fallbackTimer!==null&&clearTimeout(l.fallbackTimer)),n.element.remove()}_onMousedown(n){let l=$y(n),c=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+dF;!this._target.rippleDisabled&&!l&&!c&&(this._isPointerDown=!0,this.fadeInRipple(n.clientX,n.clientY,this._target.rippleConfig))}_onTouchStart(n){if(!this._target.rippleDisabled&&!Xy(n)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let l=n.changedTouches;if(l)for(let c=0;c<l.length;c++)this.fadeInRipple(l[c].clientX,l[c].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(n=>{let l=n.state===cu.VISIBLE||n.config.terminateOnPointerUp&&n.state===cu.FADING_IN;!n.config.persistent&&l&&n.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let n=this._triggerElement;n&&(wE.forEach(l=>bg._eventManager.removeHandler(l,n,this)),this._pointerUpEventsRegistered&&(TE.forEach(l=>n.removeEventListener(l,this,bE)),this._pointerUpEventsRegistered=!1))}};bg._eventManager=new Jy;var Qy=bg;function fF(a,n,l){let c=Math.max(Math.abs(a-l.left),Math.abs(a-l.right)),f=Math.max(Math.abs(n-l.top),Math.abs(n-l.bottom));return Math.sqrt(c*c+f*f)}var IE=new Hn("mat-ripple-global-options"),pF=(()=>{let n=class n{get disabled(){return this._disabled}set disabled(c){c&&this.fadeOutAllNonPersistent(),this._disabled=c,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(c){this._trigger=c,this._setupTriggerEventsIfEnabled()}constructor(c,f,i,x,T){this._elementRef=c,this._animationMode=T,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=x||{},this._rippleRenderer=new Qy(this,f,c,i)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:In(In(In({},this._globalOptions.animation),this._animationMode==="NoopAnimations"?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(c,f=0,i){return typeof c=="number"?this._rippleRenderer.fadeInRipple(c,f,In(In({},this.rippleConfig),i)):this._rippleRenderer.fadeInRipple(0,0,In(In({},this.rippleConfig),c))}};n.\u0275fac=function(f){return new(f||n)(Ci(Ln),Ci(Wn),Ci(Ya),Ci(IE,8),Ci(Id,8))},n.\u0275dir=_r({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(f,i){f&2&&Za("mat-ripple-unbounded",i.unbounded)},inputs:{color:[0,"matRippleColor","color"],unbounded:[0,"matRippleUnbounded","unbounded"],centered:[0,"matRippleCentered","centered"],radius:[0,"matRippleRadius","radius"],animation:[0,"matRippleAnimation","animation"],disabled:[0,"matRippleDisabled","disabled"],trigger:[0,"matRippleTrigger","trigger"]},exportAs:["matRipple"],standalone:!0});let a=n;return a})(),kE=(()=>{let n=class n{};n.\u0275fac=function(f){return new(f||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Un({imports:[Wo,Wo]});let a=n;return a})();var SE={capture:!0},EE=["focus","mousedown","mouseenter","touchstart"],Zy="mat-ripple-loader-uninitialized",Yy="mat-ripple-loader-class-name",AE="mat-ripple-loader-centered",T1="mat-ripple-loader-disabled",ME=(()=>{let n=class n{constructor(){this._document=Qn(is,{optional:!0}),this._animationMode=Qn(Id,{optional:!0}),this._globalRippleOptions=Qn(IE,{optional:!0}),this._platform=Qn(Ya),this._ngZone=Qn(Wn),this._hosts=new Map,this._onInteraction=c=>{let f=Ld(c);if(f instanceof HTMLElement){let i=f.closest(`[${Zy}="${this._globalRippleOptions?.namespace??""}"]`);i&&this._createRipple(i)}},this._ngZone.runOutsideAngular(()=>{for(let c of EE)this._document?.addEventListener(c,this._onInteraction,SE)})}ngOnDestroy(){let c=this._hosts.keys();for(let f of c)this.destroyRipple(f);for(let f of EE)this._document?.removeEventListener(f,this._onInteraction,SE)}configureRipple(c,f){c.setAttribute(Zy,this._globalRippleOptions?.namespace??""),(f.className||!c.hasAttribute(Yy))&&c.setAttribute(Yy,f.className||""),f.centered&&c.setAttribute(AE,""),f.disabled&&c.setAttribute(T1,"")}getRipple(c){return this._hosts.get(c)||this._createRipple(c)}setDisabled(c,f){let i=this._hosts.get(c);if(i){i.disabled=f;return}f?c.setAttribute(T1,""):c.removeAttribute(T1)}_createRipple(c){if(!this._document)return;let f=this._hosts.get(c);if(f)return f;c.querySelector(".mat-ripple")?.remove();let i=this._document.createElement("span");i.classList.add("mat-ripple",c.getAttribute(Yy)),c.append(i);let x=new pF(new Ln(i),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return x._isInitialized=!0,x.trigger=c,x.centered=c.hasAttribute(AE),x.disabled=c.hasAttribute(T1),this.attachRipple(c,x),x}attachRipple(c,f){c.removeAttribute(Zy),this._hosts.set(c,f)}destroyRipple(c){let f=this._hosts.get(c);f&&(f.ngOnDestroy(),this._hosts.delete(c))}};n.\u0275fac=function(f){return new(f||n)},n.\u0275prov=fa({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();var gF=["mat-button",""],_F=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],xF=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"];var vF=new Hn("MAT_BUTTON_CONFIG");var yF=[{attribute:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{attribute:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{attribute:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{attribute:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{attribute:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab-base","mat-mdc-fab"]},{attribute:"mat-mini-fab",mdcClasses:["mdc-fab","mat-mdc-fab-base","mdc-fab--mini","mat-mdc-mini-fab"]},{attribute:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],bF=(()=>{let n=class n{get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(c){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,c)}get disableRipple(){return this._disableRipple}set disableRipple(c){this._disableRipple=c,this._updateRippleDisabled()}get disabled(){return this._disabled}set disabled(c){this._disabled=c,this._updateRippleDisabled()}constructor(c,f,i,x){this._elementRef=c,this._platform=f,this._ngZone=i,this._animationMode=x,this._focusMonitor=Qn(gE),this._rippleLoader=Qn(ME),this._isFab=!1,this._disableRipple=!1,this._disabled=!1;let T=Qn(vF,{optional:!0}),A=c.nativeElement,M=A.classList;this.disabledInteractive=T?.disabledInteractive??!1,this.color=T?.color??null,this._rippleLoader?.configureRipple(A,{className:"mat-mdc-button-ripple"});for(let{attribute:F,mdcClasses:W}of yF)A.hasAttribute(F)&&M.add(...W)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(c="program",f){c?this._focusMonitor.focusVia(this._elementRef.nativeElement,c,f):this._elementRef.nativeElement.focus(f)}_getAriaDisabled(){return this.ariaDisabled!=null?this.ariaDisabled:this.disabled&&this.disabledInteractive?!0:null}_getDisabledAttribute(){return this.disabledInteractive||!this.disabled?null:!0}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}};n.\u0275fac=function(f){x1()},n.\u0275dir=_r({type:n,inputs:{color:"color",disableRipple:[2,"disableRipple","disableRipple",ws],disabled:[2,"disabled","disabled",ws],ariaDisabled:[2,"aria-disabled","ariaDisabled",ws],disabledInteractive:[2,"disabledInteractive","disabledInteractive",ws]},features:[Al]});let a=n;return a})();var Rf=(()=>{let n=class n extends bF{constructor(c,f,i,x){super(c,f,i,x)}};n.\u0275fac=function(f){return new(f||n)(Ci(Ln),Ci(Ya),Ci(Wn),Ci(Id,8))},n.\u0275cmp=wa({type:n,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:14,hostBindings:function(f,i){f&2&&(Mc("disabled",i._getDisabledAttribute())("aria-disabled",i._getAriaDisabled()),vg(i.color?"mat-"+i.color:""),Za("mat-mdc-button-disabled",i.disabled)("mat-mdc-button-disabled-interactive",i.disabledInteractive)("_mat-animation-noopable",i._animationMode==="NoopAnimations")("mat-unthemed",!i.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[ea,Aa],attrs:gF,ngContentSelectors:xF,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(f,i){f&1&&(Ql(_F),an(0,"span",0),pa(1),Qi(2,"span",1),pa(3,1),ji(),pa(4,2),an(5,"span",2)(6,"span",3)),f&2&&Za("mdc-button__ripple",!i._isFab)("mdc-fab__ripple",i._isFab)},styles:['.mat-mdc-button-base{text-decoration:none}.mdc-button{-webkit-user-select:none;user-select:none;position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0);padding:0 8px}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__label{position:relative}.mat-mdc-button{padding:0 var(--mat-text-button-horizontal-padding, 8px);height:var(--mdc-text-button-container-height);font-family:var(--mdc-text-button-label-text-font);font-size:var(--mdc-text-button-label-text-size);letter-spacing:var(--mdc-text-button-label-text-tracking);text-transform:var(--mdc-text-button-label-text-transform);font-weight:var(--mdc-text-button-label-text-weight)}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-text-button-with-icon-horizontal-padding, 8px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-text-button-ripple-color)}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-state-layer-color)}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-disabled-state-layer-color)}.mat-mdc-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-hover-state-layer-opacity)}.mat-mdc-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-focus-state-layer-opacity)}.mat-mdc-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-pressed-state-layer-opacity)}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-text-button-touch-target-display)}.mat-mdc-button,.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape)}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color)}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-unelevated-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 var(--mat-filled-button-horizontal-padding, 16px);height:var(--mdc-filled-button-container-height);font-family:var(--mdc-filled-button-label-text-font);font-size:var(--mdc-filled-button-label-text-size);letter-spacing:var(--mdc-filled-button-label-text-tracking);text-transform:var(--mdc-filled-button-label-text-transform);font-weight:var(--mdc-filled-button-label-text-weight)}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-filled-button-ripple-color)}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-state-layer-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-disabled-state-layer-color)}.mat-mdc-unelevated-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-hover-state-layer-opacity)}.mat-mdc-unelevated-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-focus-state-layer-opacity)}.mat-mdc-unelevated-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-pressed-state-layer-opacity)}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-filled-button-touch-target-display)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color);background-color:var(--mdc-filled-button-container-color)}.mat-mdc-unelevated-button,.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape)}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-filled-button-disabled-label-text-color);background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 var(--mat-protected-button-horizontal-padding, 16px);box-shadow:var(--mdc-protected-button-container-elevation-shadow);height:var(--mdc-protected-button-container-height);font-family:var(--mdc-protected-button-label-text-font);font-size:var(--mdc-protected-button-label-text-size);letter-spacing:var(--mdc-protected-button-label-text-tracking);text-transform:var(--mdc-protected-button-label-text-transform);font-weight:var(--mdc-protected-button-label-text-weight)}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-protected-button-ripple-color)}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-state-layer-color)}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-disabled-state-layer-color)}.mat-mdc-raised-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-hover-state-layer-opacity)}.mat-mdc-raised-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-focus-state-layer-opacity)}.mat-mdc-raised-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-pressed-state-layer-opacity)}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-protected-button-touch-target-display)}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color);background-color:var(--mdc-protected-button-container-color)}.mat-mdc-raised-button,.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape)}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation-shadow)}.mat-mdc-raised-button:focus{box-shadow:var(--mdc-protected-button-focus-container-elevation-shadow)}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mdc-protected-button-pressed-container-elevation-shadow)}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-protected-button-disabled-label-text-color);background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation-shadow)}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 var(--mat-outlined-button-horizontal-padding, 15px);height:var(--mdc-outlined-button-container-height);font-family:var(--mdc-outlined-button-label-text-font);font-size:var(--mdc-outlined-button-label-text-size);letter-spacing:var(--mdc-outlined-button-label-text-tracking);text-transform:var(--mdc-outlined-button-label-text-transform);font-weight:var(--mdc-outlined-button-label-text-weight);border-radius:var(--mdc-outlined-button-container-shape);border-width:var(--mdc-outlined-button-outline-width)}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-outlined-button-ripple-color)}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-state-layer-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-disabled-state-layer-color)}.mat-mdc-outlined-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-hover-state-layer-opacity)}.mat-mdc-outlined-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-focus-state-layer-opacity)}.mat-mdc-outlined-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-pressed-state-layer-opacity)}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-outlined-button-touch-target-display)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color);border-color:var(--mdc-outlined-button-outline-color)}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-outlined-button-disabled-label-text-color);border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button .mdc-button__ripple{border-width:var(--mdc-outlined-button-outline-width);border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-button .mat-icon,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-unelevated-button .mat-icon,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-raised-button .mat-icon,.mat-mdc-outlined-button .mdc-button__label,.mat-mdc-outlined-button .mat-icon{z-index:1;position:relative}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px)*-1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0});let a=n;return a})();var Of=(()=>{let n=class n{};n.\u0275fac=function(f){return new(f||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Un({imports:[Wo,kE,Wo]});let a=n;return a})();var A1=(()=>{let n=class n{};n.\u0275fac=function(f){return new(f||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Un({imports:[Wo,Wo]});let a=n;return a})();var wF=["*",[["mat-toolbar-row"]]],TF=["*","mat-toolbar-row"],SF=(()=>{let n=class n{};n.\u0275fac=function(f){return new(f||n)},n.\u0275dir=_r({type:n,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"],standalone:!0});let a=n;return a})(),DE=(()=>{let n=class n{constructor(c,f,i){this._elementRef=c,this._platform=f,this._document=i}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){this._toolbarRows.length}};n.\u0275fac=function(f){return new(f||n)(Ci(Ln),Ci(Ya),Ci(is))},n.\u0275cmp=wa({type:n,selectors:[["mat-toolbar"]],contentQueries:function(f,i,x){if(f&1&&zs(x,SF,5),f&2){let T;Ta(T=Sa())&&(i._toolbarRows=T)}},hostAttrs:[1,"mat-toolbar"],hostVars:6,hostBindings:function(f,i){f&2&&(vg(i.color?"mat-"+i.color:""),Za("mat-toolbar-multiple-rows",i._toolbarRows.length>0)("mat-toolbar-single-row",i._toolbarRows.length===0))},inputs:{color:"color"},exportAs:["matToolbar"],standalone:!0,features:[Aa],ngContentSelectors:TF,decls:2,vars:0,template:function(f,i){f&1&&(Ql(wF),pa(0),pa(1,1))},styles:[".mat-toolbar{background:var(--mat-toolbar-container-background-color);color:var(--mat-toolbar-container-text-color)}.mat-toolbar,.mat-toolbar h1,.mat-toolbar h2,.mat-toolbar h3,.mat-toolbar h4,.mat-toolbar h5,.mat-toolbar h6{font-family:var(--mat-toolbar-title-text-font);font-size:var(--mat-toolbar-title-text-size);line-height:var(--mat-toolbar-title-text-line-height);font-weight:var(--mat-toolbar-title-text-weight);letter-spacing:var(--mat-toolbar-title-text-tracking);margin:0}.cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-form-field-underline,.mat-toolbar .mat-form-field-ripple,.mat-toolbar .mat-focused .mat-form-field-ripple{background-color:currentColor}.mat-toolbar .mat-form-field-label,.mat-toolbar .mat-focused .mat-form-field-label,.mat-toolbar .mat-select-value,.mat-toolbar .mat-select-arrow,.mat-toolbar .mat-form-field.mat-focused .mat-select-arrow{color:inherit}.mat-toolbar .mat-input-element{caret-color:currentColor}.mat-toolbar .mat-mdc-button-base.mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color:var(--mat-toolbar-container-text-color);--mdc-outlined-button-label-text-color:var(--mat-toolbar-container-text-color)}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap;height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-row,.mat-toolbar-single-row{height:var(--mat-toolbar-mobile-height)}}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%;min-height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-multiple-rows{min-height:var(--mat-toolbar-mobile-height)}}"],encapsulation:2,changeDetection:0});let a=n;return a})();var C1=(()=>{let n=class n{};n.\u0275fac=function(f){return new(f||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Un({imports:[Wo,Wo]});let a=n;return a})();var FE=Lf({passive:!0}),PE=(()=>{let n=class n{constructor(c,f){this._platform=c,this._ngZone=f,this._monitoredElements=new Map}monitor(c){if(!this._platform.isBrowser)return ES;let f=jh(c),i=this._monitoredElements.get(f);if(i)return i.subject;let x=new Mo,T="cdk-text-field-autofilled",A=M=>{M.animationName==="cdk-text-field-autofill-start"&&!f.classList.contains(T)?(f.classList.add(T),this._ngZone.run(()=>x.next({target:M.target,isAutofilled:!0}))):M.animationName==="cdk-text-field-autofill-end"&&f.classList.contains(T)&&(f.classList.remove(T),this._ngZone.run(()=>x.next({target:M.target,isAutofilled:!1})))};return this._ngZone.runOutsideAngular(()=>{f.addEventListener("animationstart",A,FE),f.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(f,{subject:x,unlisten:()=>{f.removeEventListener("animationstart",A,FE)}}),x}stopMonitoring(c){let f=jh(c),i=this._monitoredElements.get(f);i&&(i.unlisten(),i.subject.complete(),f.classList.remove("cdk-text-field-autofill-monitored"),f.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(f))}ngOnDestroy(){this._monitoredElements.forEach((c,f)=>this.stopMonitoring(f))}};n.\u0275fac=function(f){return new(f||n)(Tn(Ya),Tn(Wn))},n.\u0275prov=fa({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();var LE=(()=>{let n=class n{};n.\u0275fac=function(f){return new(f||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Un({});let a=n;return a})();var UE=(()=>{let n=class n{constructor(c,f){this._renderer=c,this._elementRef=f,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(c,f){this._renderer.setProperty(this._elementRef.nativeElement,c,f)}registerOnTouched(c){this.onTouched=c}registerOnChange(c){this.onChange=c}setDisabledState(c){this.setProperty("disabled",c)}};n.\u0275fac=function(f){return new(f||n)(Ci(Ny),Ci(Ln))},n.\u0275dir=_r({type:n});let a=n;return a})(),IF=(()=>{let n=class n extends UE{};n.\u0275fac=(()=>{let c;return function(i){return(c||(c=al(n)))(i||n)}})(),n.\u0275dir=_r({type:n,features:[ea]});let a=n;return a})(),HE=new Hn("");var kF={provide:HE,useExisting:Pf(()=>e0),multi:!0};function MF(){let a=jy()?jy().getUserAgent():"";return/android (\d+)/.test(a.toLowerCase())}var DF=new Hn(""),e0=(()=>{let n=class n extends UE{constructor(c,f,i){super(c,f),this._compositionMode=i,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!MF())}writeValue(c){let f=c??"";this.setProperty("value",f)}_handleInput(c){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(c)}_compositionStart(){this._composing=!0}_compositionEnd(c){this._composing=!1,this._compositionMode&&this.onChange(c)}};n.\u0275fac=function(f){return new(f||n)(Ci(Ny),Ci(Ln),Ci(DF,8))},n.\u0275dir=_r({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(f,i){f&1&&bs("input",function(T){return i._handleInput(T.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(T){return i._compositionEnd(T.target.value)})},features:[Ea([kF]),ea]});let a=n;return a})();function Nf(a){return a==null||(typeof a=="string"||Array.isArray(a))&&a.length===0}function GE(a){return a!=null&&typeof a.length=="number"}var t0=new Hn(""),ob=new Hn(""),FF=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,mo=class{static min(n){return PF(n)}static max(n){return LF(n)}static required(n){return RF(n)}static requiredTrue(n){return OF(n)}static email(n){return WE(n)}static minLength(n){return qE(n)}static maxLength(n){return $E(n)}static pattern(n){return NF(n)}static nullValidator(n){return M1(n)}static compose(n){return QE(n)}static composeAsync(n){return eA(n)}};function PF(a){return n=>{if(Nf(n.value)||Nf(a))return null;let l=parseFloat(n.value);return!isNaN(l)&&l<a?{min:{min:a,actual:n.value}}:null}}function LF(a){return n=>{if(Nf(n.value)||Nf(a))return null;let l=parseFloat(n.value);return!isNaN(l)&&l>a?{max:{max:a,actual:n.value}}:null}}function RF(a){return Nf(a.value)?{required:!0}:null}function OF(a){return a.value===!0?null:{required:!0}}function WE(a){return Nf(a.value)||FF.test(a.value)?null:{email:!0}}function qE(a){return n=>Nf(n.value)||!GE(n.value)?null:n.value.length<a?{minlength:{requiredLength:a,actualLength:n.value.length}}:null}function $E(a){return n=>GE(n.value)&&n.value.length>a?{maxlength:{requiredLength:a,actualLength:n.value.length}}:null}function NF(a){if(!a)return M1;let n,l;return typeof a=="string"?(l="",a.charAt(0)!=="^"&&(l+="^"),l+=a,a.charAt(a.length-1)!=="$"&&(l+="$"),n=new RegExp(l)):(l=a.toString(),n=a),c=>{if(Nf(c.value))return null;let f=c.value;return n.test(f)?null:{pattern:{requiredPattern:l,actualValue:f}}}}function M1(a){return null}function XE(a){return a!=null}function ZE(a){return GS(a)?AS(a):a}function YE(a){let n={};return a.forEach(l=>{n=l!=null?In(In({},n),l):n}),Object.keys(n).length===0?null:n}function KE(a,n){return n.map(l=>l(a))}function BF(a){return!a.validate}function JE(a){return a.map(n=>BF(n)?n:l=>n.validate(l))}function QE(a){if(!a)return null;let n=a.filter(XE);return n.length==0?null:function(l){return YE(KE(l,n))}}function sb(a){return a!=null?QE(JE(a)):null}function eA(a){if(!a)return null;let n=a.filter(XE);return n.length==0?null:function(l){let c=KE(l,n).map(ZE);return kS(c).pipe(Hm(YE))}}function lb(a){return a!=null?eA(JE(a)):null}function RE(a,n){return a===null?[n]:Array.isArray(a)?[...a,n]:[a,n]}function tA(a){return a._rawValidators}function iA(a){return a._rawAsyncValidators}function eb(a){return a?Array.isArray(a)?a:[a]:[]}function D1(a,n){return Array.isArray(a)?a.includes(n):a===n}function OE(a,n){let l=eb(n);return eb(a).forEach(f=>{D1(l,f)||l.push(f)}),l}function NE(a,n){return eb(n).filter(l=>!D1(a,l))}var F1=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=sb(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=lb(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n=void 0){this.control&&this.control.reset(n)}hasError(n,l){return this.control?this.control.hasError(n,l):!1}getError(n,l){return this.control?this.control.getError(n,l):null}},Bf=class extends F1{get formDirective(){return null}get path(){return null}},zp=class extends F1{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},P1=class{constructor(n){this._cd=n}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},zF={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},TV=Yl(In({},zF),{"[class.ng-submitted]":"isSubmitted"}),N1=(()=>{let n=class n extends P1{constructor(c){super(c)}};n.\u0275fac=function(f){return new(f||n)(Ci(zp,2))},n.\u0275dir=_r({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(f,i){f&2&&Za("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[ea]});let a=n;return a})(),B1=(()=>{let n=class n extends P1{constructor(c){super(c)}};n.\u0275fac=function(f){return new(f||n)(Ci(Bf,10))},n.\u0275dir=_r({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(f,i){f&2&&Za("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[ea]});let a=n;return a})();var wg="VALID",I1="INVALID",Ym="PENDING",Tg="DISABLED",zf=class{},L1=class extends zf{constructor(n,l){super(),this.value=n,this.source=l}},Eg=class extends zf{constructor(n,l){super(),this.pristine=n,this.source=l}},Ag=class extends zf{constructor(n,l){super(),this.touched=n,this.source=l}},Km=class extends zf{constructor(n,l){super(),this.status=n,this.source=l}},tb=class extends zf{constructor(n){super(),this.source=n}},ib=class extends zf{constructor(n){super(),this.source=n}};function cb(a){return(z1(a)?a.validators:a)||null}function jF(a){return Array.isArray(a)?sb(a):a||null}function ub(a,n){return(z1(n)?n.asyncValidators:a)||null}function VF(a){return Array.isArray(a)?lb(a):a||null}function z1(a){return a!=null&&!Array.isArray(a)&&typeof a=="object"}function rA(a,n,l){let c=a.controls;if(!(n?Object.keys(c):c).length)throw new Gm(1e3,"");if(!c[l])throw new Gm(1001,"")}function nA(a,n,l){a._forEachChild((c,f)=>{if(l[f]===void 0)throw new Gm(1002,"")})}var Jm=class{constructor(n,l){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=Fd(()=>this.statusReactive()),this.statusReactive=kd(void 0),this._pristine=Fd(()=>this.pristineReactive()),this.pristineReactive=kd(!0),this._touched=Fd(()=>this.touchedReactive()),this.touchedReactive=kd(!1),this._events=new Mo,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(l)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get status(){return Pd(this.statusReactive)}set status(n){Pd(()=>this.statusReactive.set(n))}get valid(){return this.status===wg}get invalid(){return this.status===I1}get pending(){return this.status==Ym}get disabled(){return this.status===Tg}get enabled(){return this.status!==Tg}get pristine(){return Pd(this.pristineReactive)}set pristine(n){Pd(()=>this.pristineReactive.set(n))}get dirty(){return!this.pristine}get touched(){return Pd(this.touchedReactive)}set touched(n){Pd(()=>this.touchedReactive.set(n))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(OE(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(OE(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(NE(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(NE(n,this._rawAsyncValidators))}hasValidator(n){return D1(this._rawValidators,n)}hasAsyncValidator(n){return D1(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){let l=this.touched===!1;this.touched=!0;let c=n.sourceControl??this;this._parent&&!n.onlySelf&&this._parent.markAsTouched(Yl(In({},n),{sourceControl:c})),l&&n.emitEvent!==!1&&this._events.next(new Ag(!0,c))}markAllAsTouched(n={}){this.markAsTouched({onlySelf:!0,emitEvent:n.emitEvent,sourceControl:this}),this._forEachChild(l=>l.markAllAsTouched(n))}markAsUntouched(n={}){let l=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let c=n.sourceControl??this;this._forEachChild(f=>{f.markAsUntouched({onlySelf:!0,emitEvent:n.emitEvent,sourceControl:c})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n,c),l&&n.emitEvent!==!1&&this._events.next(new Ag(!1,c))}markAsDirty(n={}){let l=this.pristine===!0;this.pristine=!1;let c=n.sourceControl??this;this._parent&&!n.onlySelf&&this._parent.markAsDirty(Yl(In({},n),{sourceControl:c})),l&&n.emitEvent!==!1&&this._events.next(new Eg(!1,c))}markAsPristine(n={}){let l=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let c=n.sourceControl??this;this._forEachChild(f=>{f.markAsPristine({onlySelf:!0,emitEvent:n.emitEvent})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n,c),l&&n.emitEvent!==!1&&this._events.next(new Eg(!0,c))}markAsPending(n={}){this.status=Ym;let l=n.sourceControl??this;n.emitEvent!==!1&&(this._events.next(new Km(this.status,l)),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.markAsPending(Yl(In({},n),{sourceControl:l}))}disable(n={}){let l=this._parentMarkedDirty(n.onlySelf);this.status=Tg,this.errors=null,this._forEachChild(f=>{f.disable(Yl(In({},n),{onlySelf:!0}))}),this._updateValue();let c=n.sourceControl??this;n.emitEvent!==!1&&(this._events.next(new L1(this.value,c)),this._events.next(new Km(this.status,c)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Yl(In({},n),{skipPristineCheck:l}),this),this._onDisabledChange.forEach(f=>f(!0))}enable(n={}){let l=this._parentMarkedDirty(n.onlySelf);this.status=wg,this._forEachChild(c=>{c.enable(Yl(In({},n),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors(Yl(In({},n),{skipPristineCheck:l}),this),this._onDisabledChange.forEach(c=>c(!1))}_updateAncestors(n,l){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine({},l),this._parent._updateTouched({},l))}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let c=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===wg||this.status===Ym)&&this._runAsyncValidator(c,n.emitEvent)}let l=n.sourceControl??this;n.emitEvent!==!1&&(this._events.next(new L1(this.value,l)),this._events.next(new Km(this.status,l)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(Yl(In({},n),{sourceControl:l}))}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(l=>l._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Tg:wg}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n,l){if(this.asyncValidator){this.status=Ym,this._hasOwnPendingAsyncValidator={emitEvent:l!==!1};let c=ZE(this.asyncValidator(this));this._asyncValidationSubscription=c.subscribe(f=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(f,{emitEvent:l,shouldHaveEmitted:n})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let n=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,n}return!1}setErrors(n,l={}){this.errors=n,this._updateControlsErrors(l.emitEvent!==!1,this,l.shouldHaveEmitted)}get(n){let l=n;return l==null||(Array.isArray(l)||(l=l.split(".")),l.length===0)?null:l.reduce((c,f)=>c&&c._find(f),this)}getError(n,l){let c=l?this.get(l):this;return c&&c.errors?c.errors[n]:null}hasError(n,l){return!!this.getError(n,l)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n,l,c){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),(n||c)&&this._events.next(new Km(this.status,l)),this._parent&&this._parent._updateControlsErrors(n,l,c)}_initObservables(){this.valueChanges=new lu,this.statusChanges=new lu}_calculateStatus(){return this._allControlsDisabled()?Tg:this.errors?I1:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ym)?Ym:this._anyControlsHaveStatus(I1)?I1:wg}_anyControlsHaveStatus(n){return this._anyControls(l=>l.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n,l){let c=!this._anyControlsDirty(),f=this.pristine!==c;this.pristine=c,this._parent&&!n.onlySelf&&this._parent._updatePristine(n,l),f&&this._events.next(new Eg(this.pristine,l))}_updateTouched(n={},l){this.touched=this._anyControlsTouched(),this._events.next(new Ag(this.touched,l)),this._parent&&!n.onlySelf&&this._parent._updateTouched(n,l)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){z1(n)&&n.updateOn!=null&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){let l=this._parent&&this._parent.dirty;return!n&&!!l&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=jF(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=VF(this._rawAsyncValidators)}},Qm=class extends Jm{constructor(n,l,c){super(cb(l),ub(c,l)),this.controls=n,this._initObservables(),this._setUpdateStrategy(l),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,l){return this.controls[n]?this.controls[n]:(this.controls[n]=l,l.setParent(this),l._registerOnCollectionChange(this._onCollectionChange),l)}addControl(n,l,c={}){this.registerControl(n,l),this.updateValueAndValidity({emitEvent:c.emitEvent}),this._onCollectionChange()}removeControl(n,l={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:l.emitEvent}),this._onCollectionChange()}setControl(n,l,c={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],l&&this.registerControl(n,l),this.updateValueAndValidity({emitEvent:c.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,l={}){nA(this,!0,n),Object.keys(n).forEach(c=>{rA(this,!0,c),this.controls[c].setValue(n[c],{onlySelf:!0,emitEvent:l.emitEvent})}),this.updateValueAndValidity(l)}patchValue(n,l={}){n!=null&&(Object.keys(n).forEach(c=>{let f=this.controls[c];f&&f.patchValue(n[c],{onlySelf:!0,emitEvent:l.emitEvent})}),this.updateValueAndValidity(l))}reset(n={},l={}){this._forEachChild((c,f)=>{c.reset(n?n[f]:null,{onlySelf:!0,emitEvent:l.emitEvent})}),this._updatePristine(l,this),this._updateTouched(l,this),this.updateValueAndValidity(l)}getRawValue(){return this._reduceChildren({},(n,l,c)=>(n[c]=l.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(l,c)=>c._syncPendingControls()?!0:l);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(l=>{let c=this.controls[l];c&&n(c,l)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(let[l,c]of Object.entries(this.controls))if(this.contains(l)&&n(c))return!0;return!1}_reduceValue(){let n={};return this._reduceChildren(n,(l,c,f)=>((c.enabled||this.disabled)&&(l[f]=c.value),l))}_reduceChildren(n,l){let c=n;return this._forEachChild((f,i)=>{c=l(c,f,i)}),c}_allControlsDisabled(){for(let n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}};var rb=class extends Qm{};var hb=new Hn("CallSetDisabledState",{providedIn:"root",factory:()=>db}),db="always";function UF(a,n){return[...n.path,a]}function nb(a,n,l=db){fb(a,n),n.valueAccessor.writeValue(a.value),(a.disabled||l==="always")&&n.valueAccessor.setDisabledState?.(a.disabled),GF(a,n),qF(a,n),WF(a,n),HF(a,n)}function BE(a,n,l=!0){let c=()=>{};n.valueAccessor&&(n.valueAccessor.registerOnChange(c),n.valueAccessor.registerOnTouched(c)),O1(a,n),a&&(n._invokeOnDestroyCallbacks(),a._registerOnCollectionChange(()=>{}))}function R1(a,n){a.forEach(l=>{l.registerOnValidatorChange&&l.registerOnValidatorChange(n)})}function HF(a,n){if(n.valueAccessor.setDisabledState){let l=c=>{n.valueAccessor.setDisabledState(c)};a.registerOnDisabledChange(l),n._registerOnDestroy(()=>{a._unregisterOnDisabledChange(l)})}}function fb(a,n){let l=tA(a);n.validator!==null?a.setValidators(RE(l,n.validator)):typeof l=="function"&&a.setValidators([l]);let c=iA(a);n.asyncValidator!==null?a.setAsyncValidators(RE(c,n.asyncValidator)):typeof c=="function"&&a.setAsyncValidators([c]);let f=()=>a.updateValueAndValidity();R1(n._rawValidators,f),R1(n._rawAsyncValidators,f)}function O1(a,n){let l=!1;if(a!==null){if(n.validator!==null){let f=tA(a);if(Array.isArray(f)&&f.length>0){let i=f.filter(x=>x!==n.validator);i.length!==f.length&&(l=!0,a.setValidators(i))}}if(n.asyncValidator!==null){let f=iA(a);if(Array.isArray(f)&&f.length>0){let i=f.filter(x=>x!==n.asyncValidator);i.length!==f.length&&(l=!0,a.setAsyncValidators(i))}}}let c=()=>{};return R1(n._rawValidators,c),R1(n._rawAsyncValidators,c),l}function GF(a,n){n.valueAccessor.registerOnChange(l=>{a._pendingValue=l,a._pendingChange=!0,a._pendingDirty=!0,a.updateOn==="change"&&aA(a,n)})}function WF(a,n){n.valueAccessor.registerOnTouched(()=>{a._pendingTouched=!0,a.updateOn==="blur"&&a._pendingChange&&aA(a,n),a.updateOn!=="submit"&&a.markAsTouched()})}function aA(a,n){a._pendingDirty&&a.markAsDirty(),a.setValue(a._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(a._pendingValue),a._pendingChange=!1}function qF(a,n){let l=(c,f)=>{n.valueAccessor.writeValue(c),f&&n.viewToModelUpdate(c)};a.registerOnChange(l),n._registerOnDestroy(()=>{a._unregisterOnChange(l)})}function oA(a,n){a==null,fb(a,n)}function $F(a,n){return O1(a,n)}function XF(a,n){if(!a.hasOwnProperty("model"))return!1;let l=a.model;return l.isFirstChange()?!0:!Object.is(n,l.currentValue)}function ZF(a){return Object.getPrototypeOf(a.constructor)===IF}function sA(a,n){a._syncPendingControls(),n.forEach(l=>{let c=l.control;c.updateOn==="submit"&&c._pendingChange&&(l.viewToModelUpdate(c._pendingValue),c._pendingChange=!1)})}function YF(a,n){if(!n)return null;Array.isArray(n);let l,c,f;return n.forEach(i=>{i.constructor===e0?l=i:ZF(i)?c=i:f=i}),f||c||l||null}function KF(a,n){let l=a.indexOf(n);l>-1&&a.splice(l,1)}var JF={provide:Bf,useExisting:Pf(()=>pb)},Sg=Promise.resolve(),pb=(()=>{let n=class n extends Bf{get submitted(){return Pd(this.submittedReactive)}constructor(c,f,i){super(),this.callSetDisabledState=i,this._submitted=Fd(()=>this.submittedReactive()),this.submittedReactive=kd(!1),this._directives=new Set,this.ngSubmit=new lu,this.form=new Qm({},sb(c),lb(f))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(c){Sg.then(()=>{let f=this._findContainer(c.path);c.control=f.registerControl(c.name,c.control),nb(c.control,c,this.callSetDisabledState),c.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(c)})}getControl(c){return this.form.get(c.path)}removeControl(c){Sg.then(()=>{let f=this._findContainer(c.path);f&&f.removeControl(c.name),this._directives.delete(c)})}addFormGroup(c){Sg.then(()=>{let f=this._findContainer(c.path),i=new Qm({});oA(i,c),f.registerControl(c.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(c){Sg.then(()=>{let f=this._findContainer(c.path);f&&f.removeControl(c.name)})}getFormGroup(c){return this.form.get(c.path)}updateModel(c,f){Sg.then(()=>{this.form.get(c.path).setValue(f)})}setValue(c){this.control.setValue(c)}onSubmit(c){return this.submittedReactive.set(!0),sA(this.form,this._directives),this.ngSubmit.emit(c),c?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(c=void 0){this.form.reset(c),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(c){return c.pop(),c.length?this.form.get(c):this.form}};n.\u0275fac=function(f){return new(f||n)(Ci(t0,10),Ci(ob,10),Ci(hb,8))},n.\u0275dir=_r({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(f,i){f&1&&bs("submit",function(T){return i.onSubmit(T)})("reset",function(){return i.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Ea([JF]),ea]});let a=n;return a})();function zE(a,n){let l=a.indexOf(n);l>-1&&a.splice(l,1)}function jE(a){return typeof a=="object"&&a!==null&&Object.keys(a).length===2&&"value"in a&&"disabled"in a}var k1=class extends Jm{constructor(n=null,l,c){super(cb(l),ub(c,l)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(l),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),z1(l)&&(l.nonNullable||l.initialValueIsDefault)&&(jE(n)?this.defaultValue=n.value:this.defaultValue=n)}setValue(n,l={}){this.value=this._pendingValue=n,this._onChange.length&&l.emitModelToViewChange!==!1&&this._onChange.forEach(c=>c(this.value,l.emitViewToModelChange!==!1)),this.updateValueAndValidity(l)}patchValue(n,l={}){this.setValue(n,l)}reset(n=this.defaultValue,l={}){this._applyFormState(n),this.markAsPristine(l),this.markAsUntouched(l),this.setValue(this.value,l),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){zE(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){zE(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(n){jE(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}};var QF=a=>a instanceof k1;var j1=(()=>{let n=class n{};n.\u0275fac=function(f){return new(f||n)},n.\u0275dir=_r({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let a=n;return a})();var lA=new Hn("");var eP={provide:Bf,useExisting:Pf(()=>jp)},jp=(()=>{let n=class n extends Bf{get submitted(){return Pd(this._submittedReactive)}set submitted(c){this._submittedReactive.set(c)}constructor(c,f,i){super(),this.callSetDisabledState=i,this._submitted=Fd(()=>this._submittedReactive()),this._submittedReactive=kd(!1),this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new lu,this._setValidators(c),this._setAsyncValidators(f)}ngOnChanges(c){this._checkFormPresent(),c.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(O1(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(c){let f=this.form.get(c.path);return nb(f,c,this.callSetDisabledState),f.updateValueAndValidity({emitEvent:!1}),this.directives.push(c),f}getControl(c){return this.form.get(c.path)}removeControl(c){BE(c.control||null,c,!1),KF(this.directives,c)}addFormGroup(c){this._setUpFormContainer(c)}removeFormGroup(c){this._cleanUpFormContainer(c)}getFormGroup(c){return this.form.get(c.path)}addFormArray(c){this._setUpFormContainer(c)}removeFormArray(c){this._cleanUpFormContainer(c)}getFormArray(c){return this.form.get(c.path)}updateModel(c,f){this.form.get(c.path).setValue(f)}onSubmit(c){return this._submittedReactive.set(!0),sA(this.form,this.directives),this.ngSubmit.emit(c),this.form._events.next(new tb(this.control)),c?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(c=void 0){this.form.reset(c),this._submittedReactive.set(!1),this.form._events.next(new ib(this.form))}_updateDomValue(){this.directives.forEach(c=>{let f=c.control,i=this.form.get(c.path);f!==i&&(BE(f||null,c),QF(i)&&(nb(i,c,this.callSetDisabledState),c.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(c){let f=this.form.get(c.path);oA(f,c),f.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(c){if(this.form){let f=this.form.get(c.path);f&&$F(f,c)&&f.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){fb(this.form,this),this._oldForm&&O1(this._oldForm,this)}_checkFormPresent(){this.form}};n.\u0275fac=function(f){return new(f||n)(Ci(t0,10),Ci(ob,10),Ci(hb,8))},n.\u0275dir=_r({type:n,selectors:[["","formGroup",""]],hostBindings:function(f,i){f&1&&bs("submit",function(T){return i.onSubmit(T)})("reset",function(){return i.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Ea([eP]),ea,su]});let a=n;return a})();var tP={provide:zp,useExisting:Pf(()=>Cg)},Cg=(()=>{let n=class n extends zp{set isDisabled(c){}constructor(c,f,i,x,T){super(),this._ngModelWarningConfig=T,this._added=!1,this.name=null,this.update=new lu,this._ngModelWarningSent=!1,this._parent=c,this._setValidators(f),this._setAsyncValidators(i),this.valueAccessor=YF(this,x)}ngOnChanges(c){this._added||this._setUpControl(),XF(c,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(c){this.viewModel=c,this.update.emit(c)}get path(){return UF(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};n._ngModelWarningSentOnce=!1,n.\u0275fac=function(f){return new(f||n)(Ci(Bf,13),Ci(t0,10),Ci(ob,10),Ci(HE,10),Ci(lA,8))},n.\u0275dir=_r({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[Ea([tP]),ea,su]});let a=n;return a})();function cA(a){return typeof a=="number"?a:parseInt(a,10)}var mb=(()=>{let n=class n{constructor(){this._validator=M1}ngOnChanges(c){if(this.inputName in c){let f=this.normalizeInput(c[this.inputName].currentValue);this._enabled=this.enabled(f),this._validator=this._enabled?this.createValidator(f):M1,this._onChange&&this._onChange()}}validate(c){return this._validator(c)}registerOnValidatorChange(c){this._onChange=c}enabled(c){return c!=null}};n.\u0275fac=function(f){return new(f||n)},n.\u0275dir=_r({type:n,features:[su]});let a=n;return a})();var iP={provide:t0,useExisting:Pf(()=>gb),multi:!0},gb=(()=>{let n=class n extends mb{constructor(){super(...arguments),this.inputName="email",this.normalizeInput=ws,this.createValidator=c=>WE}enabled(c){return c}};n.\u0275fac=(()=>{let c;return function(i){return(c||(c=al(n)))(i||n)}})(),n.\u0275dir=_r({type:n,selectors:[["","email","","formControlName",""],["","email","","formControl",""],["","email","","ngModel",""]],inputs:{email:"email"},features:[Ea([iP]),ea]});let a=n;return a})(),rP={provide:t0,useExisting:Pf(()=>_b),multi:!0},_b=(()=>{let n=class n extends mb{constructor(){super(...arguments),this.inputName="minlength",this.normalizeInput=c=>cA(c),this.createValidator=c=>qE(c)}};n.\u0275fac=(()=>{let c;return function(i){return(c||(c=al(n)))(i||n)}})(),n.\u0275dir=_r({type:n,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(f,i){f&2&&Mc("minlength",i._enabled?i.minlength:null)},inputs:{minlength:"minlength"},features:[Ea([rP]),ea]});let a=n;return a})(),nP={provide:t0,useExisting:Pf(()=>xb),multi:!0},xb=(()=>{let n=class n extends mb{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=c=>cA(c),this.createValidator=c=>$E(c)}};n.\u0275fac=(()=>{let c;return function(i){return(c||(c=al(n)))(i||n)}})(),n.\u0275dir=_r({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(f,i){f&2&&Mc("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},features:[Ea([nP]),ea]});let a=n;return a})();var aP=(()=>{let n=class n{};n.\u0275fac=function(f){return new(f||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Un({});let a=n;return a})(),ab=class extends Jm{constructor(n,l,c){super(cb(l),ub(c,l)),this.controls=n,this._initObservables(),this._setUpdateStrategy(l),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(n){return this.controls[this._adjustIndex(n)]}push(n,l={}){this.controls.push(n),this._registerControl(n),this.updateValueAndValidity({emitEvent:l.emitEvent}),this._onCollectionChange()}insert(n,l,c={}){this.controls.splice(n,0,l),this._registerControl(l),this.updateValueAndValidity({emitEvent:c.emitEvent})}removeAt(n,l={}){let c=this._adjustIndex(n);c<0&&(c=0),this.controls[c]&&this.controls[c]._registerOnCollectionChange(()=>{}),this.controls.splice(c,1),this.updateValueAndValidity({emitEvent:l.emitEvent})}setControl(n,l,c={}){let f=this._adjustIndex(n);f<0&&(f=0),this.controls[f]&&this.controls[f]._registerOnCollectionChange(()=>{}),this.controls.splice(f,1),l&&(this.controls.splice(f,0,l),this._registerControl(l)),this.updateValueAndValidity({emitEvent:c.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(n,l={}){nA(this,!1,n),n.forEach((c,f)=>{rA(this,!1,f),this.at(f).setValue(c,{onlySelf:!0,emitEvent:l.emitEvent})}),this.updateValueAndValidity(l)}patchValue(n,l={}){n!=null&&(n.forEach((c,f)=>{this.at(f)&&this.at(f).patchValue(c,{onlySelf:!0,emitEvent:l.emitEvent})}),this.updateValueAndValidity(l))}reset(n=[],l={}){this._forEachChild((c,f)=>{c.reset(n[f],{onlySelf:!0,emitEvent:l.emitEvent})}),this._updatePristine(l,this),this._updateTouched(l,this),this.updateValueAndValidity(l)}getRawValue(){return this.controls.map(n=>n.getRawValue())}clear(n={}){this.controls.length<1||(this._forEachChild(l=>l._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:n.emitEvent}))}_adjustIndex(n){return n<0?n+this.length:n}_syncPendingControls(){let n=this.controls.reduce((l,c)=>c._syncPendingControls()?!0:l,!1);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){this.controls.forEach((l,c)=>{n(l,c)})}_updateValue(){this.value=this.controls.filter(n=>n.enabled||this.disabled).map(n=>n.value)}_anyControls(n){return this.controls.some(l=>l.enabled&&n(l))}_setUpControls(){this._forEachChild(n=>this._registerControl(n))}_allControlsDisabled(){for(let n of this.controls)if(n.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(n){n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)}_find(n){return this.at(n)??null}};function VE(a){return!!a&&(a.asyncValidators!==void 0||a.validators!==void 0||a.updateOn!==void 0)}var V1=(()=>{let n=class n{constructor(){this.useNonNullable=!1}get nonNullable(){let c=new n;return c.useNonNullable=!0,c}group(c,f=null){let i=this._reduceControls(c),x={};return VE(f)?x=f:f!==null&&(x.validators=f.validator,x.asyncValidators=f.asyncValidator),new Qm(i,x)}record(c,f=null){let i=this._reduceControls(c);return new rb(i,f)}control(c,f,i){let x={};return this.useNonNullable?(VE(f)?x=f:(x.validators=f,x.asyncValidators=i),new k1(c,Yl(In({},x),{nonNullable:!0}))):new k1(c,f,i)}array(c,f,i){let x=c.map(T=>this._createControl(T));return new ab(x,f,i)}_reduceControls(c){let f={};return Object.keys(c).forEach(i=>{f[i]=this._createControl(c[i])}),f}_createControl(c){if(c instanceof k1)return c;if(c instanceof Jm)return c;if(Array.isArray(c)){let f=c[0],i=c.length>1?c[1]:null,x=c.length>2?c[2]:null;return this.control(f,i,x)}else return this.control(c)}};n.\u0275fac=function(f){return new(f||n)},n.\u0275prov=fa({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();var U1=(()=>{let n=class n{static withConfig(c){return{ngModule:n,providers:[{provide:lA,useValue:c.warnOnNgModelWithFormControl??"always"},{provide:hb,useValue:c.callSetDisabledState??db}]}}};n.\u0275fac=function(f){return new(f||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Un({imports:[aP]});let a=n;return a})();var yb=class{constructor(n){this._box=n,this._destroyed=new Mo,this._resizeSubject=new Mo,this._elementObservables=new Map,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(l=>this._resizeSubject.next(l)))}observe(n){return this._elementObservables.has(n)||this._elementObservables.set(n,new _g(l=>{let c=this._resizeSubject.subscribe(l);return this._resizeObserver?.observe(n,{box:this._box}),()=>{this._resizeObserver?.unobserve(n),c.unsubscribe(),this._elementObservables.delete(n)}}).pipe(p1(l=>l.some(c=>c.target===n)),Ry({bufferSize:1,refCount:!0}),Kl(this._destroyed))),this._elementObservables.get(n)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}},uA=(()=>{let n=class n{constructor(){this._observers=new Map,this._ngZone=Qn(Wn),typeof ResizeObserver<"u"}ngOnDestroy(){for(let[,c]of this._observers)c.destroy();this._observers.clear(),typeof ResizeObserver<"u"}observe(c,f){let i=f?.box||"content-box";return this._observers.has(i)||this._observers.set(i,new yb(i)),this._observers.get(i).observe(c)}};n.\u0275fac=function(f){return new(f||n)},n.\u0275prov=fa({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();var oP=["notch"],sP=["matFormFieldNotchedOutline",""],lP=["*"],cP=["textField"],uP=["iconPrefixContainer"],hP=["textPrefixContainer"],dP=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],fP=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];function pP(a,n){a&1&&an(0,"span",19)}function mP(a,n){if(a&1&&(Qi(0,"label",18),pa(1,1),_n(2,pP,1,0,"span",19),ji()),a&2){let l=Do(2);Bs("floating",l._shouldLabelFloat())("monitorResize",l._hasOutline())("id",l._labelId),Mc("for",l._control.disableAutomaticLabeling?null:l._control.id),Er(2),jn(!l.hideRequiredMarker&&l._control.required?2:-1)}}function gP(a,n){if(a&1&&_n(0,mP,3,5,"label",18),a&2){let l=Do();jn(l._hasFloatingLabel()?0:-1)}}function _P(a,n){a&1&&an(0,"div",5)}function xP(a,n){}function vP(a,n){if(a&1&&_n(0,xP,0,0,"ng-template",11),a&2){Do(2);let l=zy(1);Bs("ngTemplateOutlet",l)}}function yP(a,n){if(a&1&&(Qi(0,"div",7),_n(1,vP,1,1,null,11),ji()),a&2){let l=Do();Bs("matFormFieldNotchedOutlineOpen",l._shouldLabelFloat()),Er(),jn(l._forceDisplayInfixLabel()?-1:1)}}function bP(a,n){a&1&&(Qi(0,"div",8,2),pa(2,2),ji())}function wP(a,n){a&1&&(Qi(0,"div",9,3),pa(2,3),ji())}function TP(a,n){}function SP(a,n){if(a&1&&_n(0,TP,0,0,"ng-template",11),a&2){Do();let l=zy(1);Bs("ngTemplateOutlet",l)}}function EP(a,n){a&1&&(Qi(0,"div",12),pa(1,4),ji())}function AP(a,n){a&1&&(Qi(0,"div",13),pa(1,5),ji())}function CP(a,n){a&1&&an(0,"div",14)}function IP(a,n){if(a&1&&(Qi(0,"div",16),pa(1,6),ji()),a&2){let l=Do();Bs("@transitionMessages",l._subscriptAnimationState)}}function kP(a,n){if(a&1&&(Qi(0,"mat-hint",20),Gr(1),ji()),a&2){let l=Do(2);Bs("id",l._hintLabelId),Er(),Zu(l.hintLabel)}}function MP(a,n){if(a&1&&(Qi(0,"div",17),_n(1,kP,2,2,"mat-hint",20),pa(2,7),an(3,"div",21),pa(4,8),ji()),a&2){let l=Do();Bs("@transitionMessages",l._subscriptAnimationState),Er(),jn(l.hintLabel?1:-1)}}var i0=(()=>{let n=class n{};n.\u0275fac=function(f){return new(f||n)},n.\u0275dir=_r({type:n,selectors:[["mat-label"]],standalone:!0});let a=n;return a})(),DP=0,vA=new Hn("MatError"),yA=(()=>{let n=class n{constructor(c,f){this.id=`mat-mdc-error-${DP++}`,c||f.nativeElement.setAttribute("aria-live","polite")}};n.\u0275fac=function(f){return new(f||n)(xg("aria-live"),Ci(Ln))},n.\u0275dir=_r({type:n,selectors:[["mat-error"],["","matError",""]],hostAttrs:["aria-atomic","true",1,"mat-mdc-form-field-error","mat-mdc-form-field-bottom-align"],hostVars:1,hostBindings:function(f,i){f&2&&qm("id",i.id)},inputs:{id:"id"},standalone:!0,features:[Ea([{provide:vA,useExisting:n}])]});let a=n;return a})(),FP=0,hA=(()=>{let n=class n{constructor(){this.align="start",this.id=`mat-mdc-hint-${FP++}`}};n.\u0275fac=function(f){return new(f||n)},n.\u0275dir=_r({type:n,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(f,i){f&2&&(qm("id",i.id),Mc("align",null),Za("mat-mdc-form-field-hint-end",i.align==="end"))},inputs:{align:"align",id:"id"},standalone:!0});let a=n;return a})(),PP=new Hn("MatPrefix");var LP=new Hn("MatSuffix");var bA=new Hn("FloatingLabelParent"),dA=(()=>{let n=class n{get floating(){return this._floating}set floating(c){this._floating=c,this.monitorResize&&this._handleResize()}get monitorResize(){return this._monitorResize}set monitorResize(c){this._monitorResize=c,this._monitorResize?this._subscribeToResize():this._resizeSubscription.unsubscribe()}constructor(c){this._elementRef=c,this._floating=!1,this._monitorResize=!1,this._resizeObserver=Qn(uA),this._ngZone=Qn(Wn),this._parent=Qn(bA),this._resizeSubscription=new h1}ngOnDestroy(){this._resizeSubscription.unsubscribe()}getWidth(){return RP(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}_handleResize(){setTimeout(()=>this._parent._handleLabelResized())}_subscribeToResize(){this._resizeSubscription.unsubscribe(),this._ngZone.runOutsideAngular(()=>{this._resizeSubscription=this._resizeObserver.observe(this._elementRef.nativeElement,{box:"border-box"}).subscribe(()=>this._handleResize())})}};n.\u0275fac=function(f){return new(f||n)(Ci(Ln))},n.\u0275dir=_r({type:n,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(f,i){f&2&&Za("mdc-floating-label--float-above",i.floating)},inputs:{floating:"floating",monitorResize:"monitorResize"},standalone:!0});let a=n;return a})();function RP(a){let n=a;if(n.offsetParent!==null)return n.scrollWidth;let l=n.cloneNode(!0);l.style.setProperty("position","absolute"),l.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(l);let c=l.scrollWidth;return l.remove(),c}var fA="mdc-line-ripple--active",H1="mdc-line-ripple--deactivating",pA=(()=>{let n=class n{constructor(c,f){this._elementRef=c,this._handleTransitionEnd=i=>{let x=this._elementRef.nativeElement.classList,T=x.contains(H1);i.propertyName==="opacity"&&T&&x.remove(fA,H1)},f.runOutsideAngular(()=>{c.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){let c=this._elementRef.nativeElement.classList;c.remove(H1),c.add(fA)}deactivate(){this._elementRef.nativeElement.classList.add(H1)}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}};n.\u0275fac=function(f){return new(f||n)(Ci(Ln),Ci(Wn))},n.\u0275dir=_r({type:n,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"],standalone:!0});let a=n;return a})(),mA=(()=>{let n=class n{constructor(c,f){this._elementRef=c,this._ngZone=f,this.open=!1}ngAfterViewInit(){let c=this._elementRef.nativeElement.querySelector(".mdc-floating-label");c?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),typeof requestAnimationFrame=="function"&&(c.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>c.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_setNotchWidth(c){!this.open||!c?this._notch.nativeElement.style.width="":this._notch.nativeElement.style.width=`calc(${c}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`}};n.\u0275fac=function(f){return new(f||n)(Ci(Ln),Ci(Wn))},n.\u0275cmp=wa({type:n,selectors:[["div","matFormFieldNotchedOutline",""]],viewQuery:function(f,i){if(f&1&&Dc(oP,5),f&2){let x;Ta(x=Sa())&&(i._notch=x.first)}},hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(f,i){f&2&&Za("mdc-notched-outline--notched",i.open)},inputs:{open:[0,"matFormFieldNotchedOutlineOpen","open"]},standalone:!0,features:[Aa],attrs:sP,ngContentSelectors:lP,decls:5,vars:0,consts:[["notch",""],[1,"mdc-notched-outline__leading"],[1,"mdc-notched-outline__notch"],[1,"mdc-notched-outline__trailing"]],template:function(f,i){f&1&&(Ql(),an(0,"div",1),Qi(1,"div",2,0),pa(3),ji(),an(4,"div",3))},encapsulation:2,changeDetection:0});let a=n;return a})(),OP={transitionMessages:JS("transitionMessages",[eE("enter",Vy({opacity:1,transform:"translateY(0%)"})),tE("void => enter",[Vy({opacity:0,transform:"translateY(-5px)"}),QS("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},bb=(()=>{let n=class n{};n.\u0275fac=function(f){return new(f||n)},n.\u0275dir=_r({type:n});let a=n;return a})();var wb=new Hn("MatFormField"),NP=new Hn("MAT_FORM_FIELD_DEFAULT_OPTIONS"),gA=0,_A="fill",BP="auto",xA="fixed",zP="translateY(-50%)",G1=(()=>{let n=class n{get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(c){this._hideRequiredMarker=Op(c)}get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||BP}set floatLabel(c){c!==this._floatLabel&&(this._floatLabel=c,this._changeDetectorRef.markForCheck())}get appearance(){return this._appearance}set appearance(c){let f=this._appearance,i=c||this._defaults?.appearance||_A;this._appearance=i,this._appearance==="outline"&&this._appearance!==f&&(this._needsOutlineLabelOffsetUpdate=!0)}get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||xA}set subscriptSizing(c){this._subscriptSizing=c||this._defaults?.subscriptSizing||xA}get hintLabel(){return this._hintLabel}set hintLabel(c){this._hintLabel=c,this._processHints()}get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(c){this._explicitFormFieldControl=c}constructor(c,f,i,x,T,A,M,F){this._elementRef=c,this._changeDetectorRef=f,this._dir=x,this._platform=T,this._defaults=A,this._animationMode=M,this._labelChild=jS(i0),this._hideRequiredMarker=!1,this.color="primary",this._appearance=_A,this._subscriptSizing=null,this._hintLabel="",this._hasIconPrefix=!1,this._hasTextPrefix=!1,this._hasIconSuffix=!1,this._hasTextSuffix=!1,this._labelId=`mat-mdc-form-field-label-${gA++}`,this._hintLabelId=`mat-mdc-hint-${gA++}`,this._subscriptAnimationState="",this._destroyed=new Mo,this._isFocused=null,this._needsOutlineLabelOffsetUpdate=!1,this._injector=Qn(Wm),this.getLabelId=Fd(()=>this._hasFloatingLabel()?this._labelId:null),this._hasFloatingLabel=Fd(()=>!!this._labelChild()),A&&(A.appearance&&(this.appearance=A.appearance),this._hideRequiredMarker=!!A?.hideRequiredMarker,A.color&&(this.color=A.color))}ngAfterViewInit(){this._updateFocusState(),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(){let c=this._control;c.controlType&&this._elementRef.nativeElement.classList.add(`mat-mdc-form-field-type-${c.controlType}`),c.stateChanges.subscribe(()=>{this._updateFocusState(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),c.ngControl&&c.ngControl.valueChanges&&c.ngControl.valueChanges.pipe(Kl(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck())}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(c=>!c._isText),this._hasTextPrefix=!!this._prefixChildren.find(c=>c._isText),this._hasIconSuffix=!!this._suffixChildren.find(c=>!c._isText),this._hasTextSuffix=!!this._suffixChildren.find(c=>c._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),MS(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){this._control}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||this._isFocused===null)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdate=!0),zS(()=>{this._needsOutlineLabelOffsetUpdate&&(this._needsOutlineLabelOffsetUpdate=!1,this._updateOutlineLabelOffset())},{injector:this._injector}),this._dir.change.pipe(Kl(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdate=!0)}_shouldAlwaysFloat(){return this.floatLabel==="always"}_hasOutline(){return this.appearance==="outline"}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_shouldLabelFloat(){return this._control.shouldLabelFloat||this._shouldAlwaysFloat()}_shouldForward(c){let f=this._control?this._control.ngControl:null;return f&&f[c]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_handleLabelResized(){this._refreshOutlineNotchWidth()}_refreshOutlineNotchWidth(){!this._hasOutline()||!this._floatingLabel||!this._shouldLabelFloat()?this._notchedOutline?._setNotchWidth(0):this._notchedOutline?._setNotchWidth(this._floatingLabel.getWidth())}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){this._hintChildren}_syncDescribedByIds(){if(this._control){let c=[];if(this._control.userAriaDescribedBy&&typeof this._control.userAriaDescribedBy=="string"&&c.push(...this._control.userAriaDescribedBy.split(" ")),this._getDisplayedMessages()==="hint"){let f=this._hintChildren?this._hintChildren.find(x=>x.align==="start"):null,i=this._hintChildren?this._hintChildren.find(x=>x.align==="end"):null;f?c.push(f.id):this._hintLabel&&c.push(this._hintLabelId),i&&c.push(i.id)}else this._errorChildren&&c.push(...this._errorChildren.map(f=>f.id));this._control.setDescribedByIds(c)}}_updateOutlineLabelOffset(){if(!this._hasOutline()||!this._floatingLabel)return;let c=this._floatingLabel.element;if(!(this._iconPrefixContainer||this._textPrefixContainer)){c.style.transform="";return}if(!this._isAttachedToDom()){this._needsOutlineLabelOffsetUpdate=!0;return}let f=this._iconPrefixContainer?.nativeElement,i=this._textPrefixContainer?.nativeElement,x=f?.getBoundingClientRect().width??0,T=i?.getBoundingClientRect().width??0,A=this._dir.value==="rtl"?"-1":"1",M=`${x+T}px`,W=`calc(${A} * (${M} + var(--mat-mdc-form-field-label-offset-x, 0px)))`;c.style.transform=`var(
        --mat-mdc-form-field-label-transform,
        ${zP} translateX(${W})
    )`}_isAttachedToDom(){let c=this._elementRef.nativeElement;if(c.getRootNode){let f=c.getRootNode();return f&&f!==c}return document.documentElement.contains(c)}};n.\u0275fac=function(f){return new(f||n)(Ci(Ln),Ci(Lp),Ci(Wn),Ci(w1),Ci(Ya),Ci(NP,8),Ci(Id,8),Ci(is))},n.\u0275cmp=wa({type:n,selectors:[["mat-form-field"]],contentQueries:function(f,i,x){if(f&1&&(VS(x,i._labelChild,i0,5),zs(x,bb,5),zs(x,PP,5),zs(x,LP,5),zs(x,vA,5),zs(x,hA,5)),f&2){US();let T;Ta(T=Sa())&&(i._formFieldControl=T.first),Ta(T=Sa())&&(i._prefixChildren=T),Ta(T=Sa())&&(i._suffixChildren=T),Ta(T=Sa())&&(i._errorChildren=T),Ta(T=Sa())&&(i._hintChildren=T)}},viewQuery:function(f,i){if(f&1&&(Dc(cP,5),Dc(uP,5),Dc(hP,5),Dc(dA,5),Dc(mA,5),Dc(pA,5)),f&2){let x;Ta(x=Sa())&&(i._textField=x.first),Ta(x=Sa())&&(i._iconPrefixContainer=x.first),Ta(x=Sa())&&(i._textPrefixContainer=x.first),Ta(x=Sa())&&(i._floatingLabel=x.first),Ta(x=Sa())&&(i._notchedOutline=x.first),Ta(x=Sa())&&(i._lineRipple=x.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(f,i){f&2&&Za("mat-mdc-form-field-label-always-float",i._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",i._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",i._hasIconSuffix)("mat-form-field-invalid",i._control.errorState)("mat-form-field-disabled",i._control.disabled)("mat-form-field-autofilled",i._control.autofilled)("mat-form-field-no-animations",i._animationMode==="NoopAnimations")("mat-form-field-appearance-fill",i.appearance=="fill")("mat-form-field-appearance-outline",i.appearance=="outline")("mat-form-field-hide-placeholder",i._hasFloatingLabel()&&!i._shouldLabelFloat())("mat-focused",i._control.focused)("mat-primary",i.color!=="accent"&&i.color!=="warn")("mat-accent",i.color==="accent")("mat-warn",i.color==="warn")("ng-untouched",i._shouldForward("untouched"))("ng-touched",i._shouldForward("touched"))("ng-pristine",i._shouldForward("pristine"))("ng-dirty",i._shouldForward("dirty"))("ng-valid",i._shouldForward("valid"))("ng-invalid",i._shouldForward("invalid"))("ng-pending",i._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],standalone:!0,features:[Ea([{provide:wb,useExisting:n},{provide:bA,useExisting:n}]),Aa],ngContentSelectors:fP,decls:18,vars:21,consts:[["labelTemplate",""],["textField",""],["iconPrefixContainer",""],["textPrefixContainer",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],[1,"mat-mdc-form-field-focus-overlay"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen"],[1,"mat-mdc-form-field-icon-prefix"],[1,"mat-mdc-form-field-text-prefix"],[1,"mat-mdc-form-field-infix"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align"],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[3,"id"],[1,"mat-mdc-form-field-hint-spacer"]],template:function(f,i){if(f&1){let x=v1();Ql(dP),_n(0,gP,1,1,"ng-template",null,0,HS),Qi(2,"div",4,1),bs("click",function(A){return g1(x),_1(i._control.onContainerClick(A))}),_n(4,_P,1,0,"div",5),Qi(5,"div",6),_n(6,yP,2,2,"div",7)(7,bP,3,0,"div",8)(8,wP,3,0,"div",9),Qi(9,"div",10),_n(10,SP,1,1,null,11),pa(11),ji(),_n(12,EP,2,0,"div",12)(13,AP,2,0,"div",13),ji(),_n(14,CP,1,0,"div",14),ji(),Qi(15,"div",15),_n(16,IP,2,1,"div",16)(17,MP,5,2,"div",17),ji()}if(f&2){let x;Er(2),Za("mdc-text-field--filled",!i._hasOutline())("mdc-text-field--outlined",i._hasOutline())("mdc-text-field--no-label",!i._hasFloatingLabel())("mdc-text-field--disabled",i._control.disabled)("mdc-text-field--invalid",i._control.errorState),Er(2),jn(!i._hasOutline()&&!i._control.disabled?4:-1),Er(2),jn(i._hasOutline()?6:-1),Er(),jn(i._hasIconPrefix?7:-1),Er(),jn(i._hasTextPrefix?8:-1),Er(2),jn(!i._hasOutline()||i._forceDisplayInfixLabel()?10:-1),Er(2),jn(i._hasTextSuffix?12:-1),Er(),jn(i._hasIconSuffix?13:-1),Er(),jn(i._hasOutline()?-1:14),Er(),Za("mat-mdc-form-field-subscript-dynamic-size",i.subscriptSizing==="dynamic"),Er(),jn((x=i._getDisplayedMessages())==="error"?16:x==="hint"?17:-1)}},dependencies:[dA,mA,qS,pA,hA],styles:['.mdc-text-field{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:0;border-bottom-left-radius:0;display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field__input{height:28px;width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}@media all{.mdc-text-field__input::placeholder{opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{opacity:0}}@media all{.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}}@media all{.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}}.mdc-text-field__affix{height:28px;opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}@supports(-webkit-hyphens: none){.mdc-text-field--outlined .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field--filled{height:56px}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}@supports(-webkit-hyphens: none){.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-shape-small, 4px))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-shape-small, 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mdc-text-field--textarea{flex-direction:column;align-items:center;width:auto;height:auto;padding:0}.mdc-text-field--textarea .mdc-floating-label{top:19px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;resize:none;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--filled::before{display:none}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-10.25px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--filled .mdc-text-field__input{margin-top:23px;margin-bottom:9px}.mdc-text-field--textarea.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label{top:18px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{align-self:flex-end;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field__resizer{align-self:stretch;display:inline-flex;flex-direction:column;flex-grow:1;max-height:100%;max-width:100%;min-height:56px;min-width:fit-content;min-width:-moz-available;min-width:-webkit-fill-available;overflow:hidden;resize:both}.mdc-text-field--filled .mdc-text-field__resizer{transform:translateY(-1px)}.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(-1px) translateY(-1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer,.mdc-text-field--outlined .mdc-text-field__resizer[dir=rtl]{transform:translateX(1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateX(1px) translateY(1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input[dir=rtl],.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter[dir=rtl]{transform:translateX(-1px) translateY(1px)}.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field--with-leading-icon,.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field--with-trailing-icon,.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 96px/0.75)}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}@media screen and (forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled .mdc-text-field__ripple{display:none}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.mdc-floating-label{position:absolute;left:0;-webkit-transform-origin:left top;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0px;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after,.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)[dir=rtl]::after{margin-left:0;margin-right:1px}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;pointer-events:none}.mdc-notched-outline__trailing{flex-grow:1}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{border-top:1px solid;border-bottom:1px solid}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{max-width:calc(100% - 12px*2)}.mdc-line-ripple::before{border-bottom-width:1px}.mdc-line-ripple::after{border-bottom-width:2px}.mdc-text-field--filled{border-top-left-radius:var(--mdc-filled-text-field-container-shape);border-top-right-radius:var(--mdc-filled-text-field-container-shape);border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-caret-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-error-caret-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-filled-text-field-input-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-filled-text-field-disabled-input-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-focus-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-hover-label-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-disabled-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-focus-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-hover-label-text-color)}.mdc-text-field--filled .mdc-floating-label{font-family:var(--mdc-filled-text-field-label-text-font);font-size:var(--mdc-filled-text-field-label-text-size);font-weight:var(--mdc-filled-text-field-label-text-weight);letter-spacing:var(--mdc-filled-text-field-label-text-tracking)}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:var(--mdc-filled-text-field-container-color)}.mdc-text-field--filled.mdc-text-field--disabled{background-color:var(--mdc-filled-text-field-disabled-container-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-hover-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-focus-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-disabled-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-hover-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-error-focus-active-indicator-color)}.mdc-text-field--filled .mdc-line-ripple::before{border-bottom-width:var(--mdc-filled-text-field-active-indicator-height)}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-width:var(--mdc-filled-text-field-focus-active-indicator-height)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-caret-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-error-caret-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-outlined-text-field-input-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-outlined-text-field-disabled-input-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-focus-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-hover-label-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-disabled-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-focus-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-hover-label-text-color)}.mdc-text-field--outlined .mdc-floating-label{font-family:var(--mdc-outlined-text-field-label-text-font);font-size:var(--mdc-outlined-text-field-label-text-size);font-weight:var(--mdc-outlined-text-field-label-text-weight);letter-spacing:var(--mdc-outlined-text-field-label-text-tracking)}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(.75*var(--mdc-outlined-text-field-label-text-size))}.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mdc-outlined-text-field-label-text-size)}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-outlined-text-field-container-shape))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-hover-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-focus-outline-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-disabled-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-hover-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-focus-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-outline-width)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-focus-outline-width)}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;line-height:normal;pointer-events:all;will-change:auto}.mat-mdc-form-field:not(.mat-form-field-disabled) .mat-mdc-floating-label.mdc-floating-label{cursor:inherit}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto;will-change:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-form-field-disabled .mdc-text-field__input::placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-text-field-wrapper::before{content:none}.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:1px solid rgba(0,0,0,0)}[dir=rtl] .mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:none;border-right:1px solid rgba(0,0,0,0)}.mat-mdc-form-field-infix{min-height:var(--mat-form-field-container-height);padding-top:var(--mat-form-field-filled-with-label-container-padding-top);padding-bottom:var(--mat-form-field-filled-with-label-container-padding-bottom)}.mdc-text-field--outlined .mat-mdc-form-field-infix,.mdc-text-field--no-label .mat-mdc-form-field-infix{padding-top:var(--mat-form-field-container-vertical-padding);padding-bottom:var(--mat-form-field-container-vertical-padding)}.mat-mdc-text-field-wrapper .mat-mdc-form-field-flex .mat-mdc-floating-label{top:calc(var(--mat-form-field-container-height)/2)}.mdc-text-field--filled .mat-mdc-floating-label{display:var(--mat-form-field-filled-label-display, block)}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{--mat-mdc-form-field-label-transform: translateY(calc(calc(6.75px + var(--mat-form-field-container-height) / 2) * -1)) scale(var(--mat-mdc-form-field-floating-label-scale, 0.75));transform:var(--mat-mdc-form-field-label-transform)}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block;color:var(--mat-form-field-error-text-color)}.mat-mdc-form-field-subscript-wrapper,.mat-mdc-form-field-bottom-align::before{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-subscript-text-font);line-height:var(--mat-form-field-subscript-text-line-height);font-size:var(--mat-form-field-subscript-text-size);letter-spacing:var(--mat-form-field-subscript-text-tracking);font-weight:var(--mat-form-field-subscript-text-weight)}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none;background-color:var(--mat-form-field-state-layer-color)}.mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-hover-state-layer-opacity)}.mat-mdc-form-field.mat-focused .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-focus-state-layer-opacity)}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option{color:var(--mat-form-field-select-option-text-color)}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option:disabled{color:var(--mat-form-field-select-disabled-option-text-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none;color:var(--mat-form-field-enabled-select-arrow-color)}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select.mat-focused .mat-mdc-form-field-infix::after{color:var(--mat-form-field-focus-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select.mat-form-field-disabled .mat-mdc-form-field-infix::after{color:var(--mat-form-field-disabled-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}.cdk-high-contrast-active .mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-container-text-font);line-height:var(--mat-form-field-container-text-line-height);font-size:var(--mat-form-field-container-text-size);letter-spacing:var(--mat-form-field-container-text-tracking);font-weight:var(--mat-form-field-container-text-weight)}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field .mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(var(--mat-form-field-outlined-label-text-populated-size)*var(--mat-mdc-form-field-floating-label-scale))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mat-form-field-outlined-label-text-populated-size)}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%;z-index:0}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto;position:relative;z-index:1}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:0 12px;box-sizing:content-box}.mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-leading-icon-color)}.mat-form-field-disabled .mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-disabled-leading-icon-color)}.mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-trailing-icon-color)}.mat-form-field-disabled .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-disabled-trailing-icon-color)}.mat-form-field-invalid .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-trailing-icon-color)}.mat-form-field-invalid:not(.mat-focused):not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-hover-trailing-icon-color)}.mat-form-field-invalid.mat-focused .mat-mdc-text-field-wrapper .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-focus-trailing-icon-color)}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__affix{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea{transition:none}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-filled 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-filled{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}[dir=rtl] .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-notched-outline .mdc-floating-label{max-width:calc(100% + 1px)}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(133.3333333333% + 1px)}'],encapsulation:2,data:{animation:[OP.transitionMessages]},changeDetection:0});let a=n;return a})(),Rd=(()=>{let n=class n{};n.\u0275fac=function(f){return new(f||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Un({imports:[Wo,$S,cE,Wo]});let a=n;return a})();var jP=new Hn("MAT_INPUT_VALUE_ACCESSOR"),VP=["button","checkbox","file","hidden","image","radio","range","reset","submit"],UP=0,W1=(()=>{let n=class n{get disabled(){return this._disabled}set disabled(c){this._disabled=Op(c),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(c){this._id=c||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(mo.required)??!1}set required(c){this._required=Op(c)}get type(){return this._type}set type(c){this._type=c||"text",this._validateType(),!this._isTextarea&&Gy().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(c){this._errorStateTracker.matcher=c}get value(){return this._inputValueAccessor.value}set value(c){c!==this.value&&(this._inputValueAccessor.value=c,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(c){this._readonly=Op(c)}get errorState(){return this._errorStateTracker.errorState}set errorState(c){this._errorStateTracker.errorState=c}constructor(c,f,i,x,T,A,M,F,W,V){this._elementRef=c,this._platform=f,this.ngControl=i,this._autofillMonitor=F,this._formField=V,this._uid=`mat-input-${UP++}`,this.focused=!1,this.stateChanges=new Mo,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(H=>Gy().has(H)),this._iOSKeyupListener=H=>{let J=H.target;!J.value&&J.selectionStart===0&&J.selectionEnd===0&&(J.setSelectionRange(1,1),J.setSelectionRange(0,0))};let R=this._elementRef.nativeElement,te=R.nodeName.toLowerCase();this._inputValueAccessor=M||R,this._previousNativeValue=this.value,this.id=this.id,f.IOS&&W.runOutsideAngular(()=>{c.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._errorStateTracker=new S1(A,i,T,x,this.stateChanges),this._isServer=!this._platform.isBrowser,this._isNativeSelect=te==="select",this._isTextarea=te==="textarea",this._isInFormField=!!V,this._isNativeSelect&&(this.controlType=R.multiple?"mat-native-select-multiple":"mat-native-select")}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(c=>{this.autofilled=c.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&(this.updateErrorState(),this.ngControl.disabled!==null&&this.ngControl.disabled!==this.disabled&&(this.disabled=this.ngControl.disabled,this.stateChanges.next())),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(c){this._elementRef.nativeElement.focus(c)}updateErrorState(){this._errorStateTracker.updateErrorState()}_focusChanged(c){c!==this.focused&&(this.focused=c,this.stateChanges.next())}_onInput(){}_dirtyCheckNativeValue(){let c=this._elementRef.nativeElement.value;this._previousNativeValue!==c&&(this._previousNativeValue=c,this.stateChanges.next())}_dirtyCheckPlaceholder(){let c=this._getPlaceholder();if(c!==this._previousPlaceholder){let f=this._elementRef.nativeElement;this._previousPlaceholder=c,c?f.setAttribute("placeholder",c):f.removeAttribute("placeholder")}}_getPlaceholder(){return this.placeholder||null}_validateType(){VP.indexOf(this._type)>-1}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let c=this._elementRef.nativeElement.validity;return c&&c.badInput}get empty(){return!this._isNeverEmpty()&&!this._elementRef.nativeElement.value&&!this._isBadInput()&&!this.autofilled}get shouldLabelFloat(){if(this._isNativeSelect){let c=this._elementRef.nativeElement,f=c.options[0];return this.focused||c.multiple||!this.empty||!!(c.selectedIndex>-1&&f&&f.label)}else return this.focused||!this.empty}setDescribedByIds(c){c.length?this._elementRef.nativeElement.setAttribute("aria-describedby",c.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){let c=this._elementRef.nativeElement;return this._isNativeSelect&&(c.multiple||c.size>1)}};n.\u0275fac=function(f){return new(f||n)(Ci(Ln),Ci(Ya),Ci(zp,10),Ci(pb,8),Ci(jp,8),Ci(CE),Ci(jP,10),Ci(PE),Ci(Wn),Ci(wb,8))},n.\u0275dir=_r({type:n,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-mdc-input-element"],hostVars:18,hostBindings:function(f,i){f&1&&bs("focus",function(){return i._focusChanged(!0)})("blur",function(){return i._focusChanged(!1)})("input",function(){return i._onInput()}),f&2&&(qm("id",i.id)("disabled",i.disabled)("required",i.required),Mc("name",i.name||null)("readonly",i.readonly&&!i._isNativeSelect||null)("aria-invalid",i.empty&&i.required?null:i.errorState)("aria-required",i.required)("id",i.id),Za("mat-input-server",i._isServer)("mat-mdc-form-field-textarea-control",i._isInFormField&&i._isTextarea)("mat-mdc-form-field-input-control",i._isInFormField)("mdc-text-field__input",i._isInFormField)("mat-mdc-native-select-inline",i._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:[0,"aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],standalone:!0,features:[Ea([{provide:bb,useExisting:n}]),su]});let a=n;return a})(),r0=(()=>{let n=class n{};n.\u0275fac=function(f){return new(f||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Un({imports:[Wo,Rd,Rd,LE,Wo]});let a=n;return a})();function HP(a,n){if(a&1&&(Qi(0,"mat-error"),Gr(1),ji()),a&2){let l=Do();Er(),Zu(l.onGenericChanges("estado"))}}function GP(a,n){if(a&1&&(Qi(0,"mat-error"),Gr(1),ji()),a&2){let l=Do();Er(),Zu(l.onGenericChanges("name"))}}function WP(a,n){if(a&1&&(Qi(0,"mat-error"),Gr(1),ji()),a&2){let l=Do();Er(),Zu(l.onGenericChanges("city"))}}function qP(a,n){if(a&1&&(Qi(0,"mat-error"),Gr(1),ji()),a&2){let l=Do();Er(),Zu(l.onGenericChanges("tel"))}}function $P(a,n){if(a&1&&(Qi(0,"mat-error"),Gr(1),ji()),a&2){let l=Do();Er(),Zu(l.onGenericChanges("colonia"))}}function XP(a,n){if(a&1&&(Qi(0,"mat-error"),Gr(1),ji()),a&2){let l=Do();Er(),Zu(l.errorEmailMessage())}}function ZP(a,n){if(a&1&&(Qi(0,"mat-error"),Gr(1),ji()),a&2){let l=Do();Er(),Zu(l.onGenericChanges("calle"))}}function YP(a,n){if(a&1&&(Qi(0,"mat-error"),Gr(1),ji()),a&2){let l=Do();Er(),Zu(l.errorCpMessage())}}var SA=(()=>{let n=class n{constructor(c){this.fb=c,this.form=this.fb.group({id:["",mo.required],email:["",[mo.required,mo.email]],name:["",mo.required],tel:["",mo.required,mo.maxLength(10),mo.minLength(10)],createdAt:["",mo.required],reference:["",mo.required],city:["",mo.required],estado:["",mo.required],calle:["",mo.required],colonia:["",mo.required],cp:["",mo.required,mo.pattern(/^[0-9]{5}$/)]}),this.errorEmailMessage=kd(""),this.errorCpMessage=kd("")}ngOnInit(){this.onEmailChanges(),this.onCpChanges()}onEmailChanges(){this.form.get("email").valueChanges.subscribe(()=>this.emailErrorMessage)}onCpChanges(){this.form.get("cp").valueChanges.subscribe(()=>this.cpErrorMessage)}onGenericChanges(c){let f=this.form.get(c);return"Este campo es obligatorio"}get emailControl(){return this.form.get("email")}get cpControl(){return this.form.get("cp")}get emailErrorMessage(){return this.emailControl.hasError("required")?this.errorEmailMessage.set("El correo electr\xF3nico es obligatorio"):this.emailControl.hasError("email")&&this.errorEmailMessage.set("El formato del correo electr\xF3nico no es v\xE1lido."),!1}get cpErrorMessage(){return this.cpControl.hasError("required")?this.errorCpMessage.set("el campo es obligatorio"):this.cpControl.hasError("pattern")&&this.errorCpMessage.set("El formato es incorrecto"),!1}};n.patternForPostalCode="/^[0-9]{5}$/",n.\u0275fac=function(f){return new(f||n)(Ci(V1))},n.\u0275cmp=wa({type:n,selectors:[["app-register-form"]],standalone:!0,features:[Aa],decls:61,vars:9,consts:[[3,"formGroup"],["appearance","fill"],["matInput","","placeholder","","formControlName","id","readonly","true"],["matInput","","placeholder","","formControlName","estado","readonly","true"],["appearance","outline"],["matInput","","placeholder","","formControlName","name"],["matInput","","placeholder","","formControlName","city"],["matInput","","placeholder","","formControlName","tel","minlength","10","maxlength","10"],["matInput","","placeholder","","formControlName","colonia"],["matInput","","placeholder","","formControlName","email","email","true"],["matInput","","placeholder","","formControlName","calle"],["matInput","","placeholder","","formControlName","createdAt","readonly","createdAt"],["matInput","","placeholder","","formControlName","cp","maxlength","5","minlength","5"],["matInput","","placeholder","","formControlName","reference"],["mat-button",""]],template:function(f,i){f&1&&(Qi(0,"form",0)(1,"mat-form-field",1)(2,"mat-label"),Gr(3,"ID Client"),ji(),an(4,"input",2),ji(),Qi(5,"mat-form-field",1)(6,"mat-label"),Gr(7,"Estado"),ji(),an(8,"input",3),_n(9,HP,2,1,"mat-error"),ji(),an(10,"br"),Qi(11,"mat-form-field",4)(12,"mat-label"),Gr(13,"Nombres / Apellidos "),ji(),an(14,"input",5),_n(15,GP,2,1,"mat-error"),ji(),Qi(16,"mat-form-field",4)(17,"mat-label"),Gr(18,"Municipio"),ji(),an(19,"input",6),_n(20,WP,2,1,"mat-error"),ji(),an(21,"br"),Qi(22,"mat-form-field",4)(23,"mat-label"),Gr(24,"Telefono"),ji(),an(25,"input",7),_n(26,qP,2,1,"mat-error"),ji(),Qi(27,"mat-form-field",4)(28,"mat-label"),Gr(29,"colonia"),ji(),an(30,"input",8),_n(31,$P,2,1,"mat-error"),ji(),an(32,"br"),Qi(33,"mat-form-field",4)(34,"mat-label"),Gr(35,"Correo"),ji(),an(36,"input",9),_n(37,XP,2,1,"mat-error"),ji(),Qi(38,"mat-form-field",4)(39,"mat-label"),Gr(40,"calle"),ji(),an(41,"input",10),_n(42,ZP,2,1,"mat-error"),ji(),an(43,"br"),Qi(44,"mat-form-field",1)(45,"mat-label"),Gr(46,"Fecha de Creacion"),ji(),an(47,"input",11),ji(),Qi(48,"mat-form-field",4)(49,"mat-label"),Gr(50,"Codigo Postal"),ji(),an(51,"input",12),_n(52,YP,2,1,"mat-error"),ji(),an(53,"br"),Qi(54,"mat-form-field",4)(55,"mat-label"),Gr(56,"Referencia"),ji(),an(57,"input",13),ji(),Qi(58,"span")(59,"button",14),Gr(60,"Aceptar"),ji()()()),f&2&&(Bs("formGroup",i.form),Er(9),jn(i.form.get("estado").invalid?9:-1),Er(6),jn(i.form.get("name").invalid?15:-1),Er(5),jn(i.form.get("city").invalid?20:-1),Er(6),jn(i.form.get("tel").invalid?26:-1),Er(5),jn(i.form.get("colonia").invalid?31:-1),Er(6),jn(i.emailControl.invalid?37:-1),Er(5),jn(i.form.get("calle").invalid?42:-1),Er(10),jn(i.cpControl.invalid?52:-1))},dependencies:[C1,Of,Rf,A1,r0,W1,G1,i0,yA,Rd,U1,j1,e0,N1,B1,_b,xb,gb,jp,Cg],styles:["mat-form-field[_ngcontent-%COMP%]{margin:1em}span[_ngcontent-%COMP%]{margin:5em}"],changeDetection:0});let a=n;return a})();var q1=Fy(AA());var CA={mapbox_key:"pk.eyJ1IjoiYWxvbnNvLXNtaXRoIiwiYSI6ImNseWthbzNwMDB5NXMycXB3MmF0djdybTYifQ.ISu2pAOqs_Rn-v6ekD5Fmg",production:!1};var KP=["map"],IA=(()=>{let n=class n{constructor(c){this.fb=c,this.cordenadas=this.fb.group({x:["",mo.required],y:["",mo.required]})}ngAfterViewInit(){if(!this.divMap?.nativeElement)throw"Map Div not found";q1.default.accessToken=CA.mapbox_key,new q1.default.Map({container:this.divMap.nativeElement,style:"mapbox://styles/mapbox/streets-v12",center:[10,12],zoom:9,interactive:!0,attributionControl:!1}).addControl(new q1.default.NavigationControl)}setCordenadas(){let c=this.cordenadas.getRawValue();console.log(c)}};n.\u0275fac=function(f){return new(f||n)(Ci(V1))},n.\u0275cmp=wa({type:n,selectors:[["app-mapp-box"]],viewQuery:function(f,i){if(f&1&&Dc(KP,5),f&2){let x;Ta(x=Sa())&&(i.divMap=x.first)}},inputs:{lngLat:"lngLat"},standalone:!0,features:[Aa],decls:13,vars:1,consts:[["map",""],["id","mapContainer"],[3,"formGroup"],["appearance","outline"],["matInput","","formControlName","x","onlyNumbers",""],["matInput","","formControlName","y","onlyNumbers",""],["mat-button","",3,"click"]],template:function(f,i){if(f&1){let x=v1();an(0,"div",1,0),Qi(2,"form",2)(3,"mat-form-field",3)(4,"mat-label"),Gr(5,"X :"),ji(),an(6,"input",4),ji(),Qi(7,"mat-form-field",3)(8,"mat-label"),Gr(9,"Y : "),ji(),an(10,"input",5),ji(),Qi(11,"button",6),bs("click",function(){return g1(x),_1(i.setCordenadas())}),Gr(12,"Buscar"),ji()()}f&2&&(Er(2),Bs("formGroup",i.cordenadas))},dependencies:[Rd,G1,i0,U1,j1,e0,N1,B1,jp,Cg,r0,W1,Of,Rf],styles:["#mapContainer[_ngcontent-%COMP%]{border-radius:20px;overflow:hidden;width:40vw;height:36vw}mat-form-field[_ngcontent-%COMP%]{padding:2em 1em}"]});let a=n;return a})();function $1(a){return a&&typeof a.connect=="function"&&!(a instanceof SS)}var n0=function(a){return a[a.REPLACED=0]="REPLACED",a[a.INSERTED=1]="INSERTED",a[a.MOVED=2]="MOVED",a[a.REMOVED=3]="REMOVED",a}(n0||{}),Ig=new Hn("_ViewRepeater"),a0=class{applyChanges(n,l,c,f,i){n.forEachOperation((x,T,A)=>{let M,F;if(x.previousIndex==null){let W=c(x,T,A);M=l.createEmbeddedView(W.templateRef,W.context,W.index),F=n0.INSERTED}else A==null?(l.remove(T),F=n0.REMOVED):(M=l.get(T),l.move(M,A),F=n0.MOVED);i&&i({context:M?.context,operation:F,record:x})})}detach(){}};var JP=20,DA=(()=>{let n=class n{constructor(c,f,i){this._platform=c,this._change=new Mo,this._changeListener=x=>{this._change.next(x)},this._document=i,f.runOutsideAngular(()=>{if(c.isBrowser){let x=this._getWindow();x.addEventListener("resize",this._changeListener),x.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){let c=this._getWindow();c.removeEventListener("resize",this._changeListener),c.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let c={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),c}getViewportRect(){let c=this.getViewportScrollPosition(),{width:f,height:i}=this.getViewportSize();return{top:c.top,left:c.left,bottom:c.top+i,right:c.left+f,height:i,width:f}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let c=this._document,f=this._getWindow(),i=c.documentElement,x=i.getBoundingClientRect(),T=-x.top||c.body.scrollTop||f.scrollY||i.scrollTop||0,A=-x.left||c.body.scrollLeft||f.scrollX||i.scrollLeft||0;return{top:T,left:A}}change(c=JP){return c>0?this._change.pipe(DS(c)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let c=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:c.innerWidth,height:c.innerHeight}:{width:0,height:0}}};n.\u0275fac=function(f){return new(f||n)(Tn(Ya),Tn(Wn),Tn(is,8))},n.\u0275prov=fa({token:n,factory:n.\u0275fac,providedIn:"root"});let a=n;return a})();var kA=(()=>{let n=class n{};n.\u0275fac=function(f){return new(f||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Un({});let a=n;return a})(),FA=(()=>{let n=class n{};n.\u0275fac=function(f){return new(f||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Un({imports:[Zm,kA,Zm,kA]});let a=n;return a})();var tL=[[["caption"]],[["colgroup"],["col"]],"*"],iL=["caption","colgroup, col","*"];function rL(a,n){a&1&&pa(0,2)}function nL(a,n){a&1&&(Qi(0,"thead",0),Jl(1,1),ji(),Qi(2,"tbody",0),Jl(3,2)(4,3),ji(),Qi(5,"tfoot",0),Jl(6,4),ji())}function aL(a,n){a&1&&Jl(0,1)(1,2)(2,3)(3,4)}var Yu=new Hn("CDK_TABLE");var Q1=(()=>{let n=class n{constructor(c){this.template=c}};n.\u0275fac=function(f){return new(f||n)(Ci(Nh))},n.\u0275dir=_r({type:n,selectors:[["","cdkCellDef",""]],standalone:!0});let a=n;return a})(),ex=(()=>{let n=class n{constructor(c){this.template=c}};n.\u0275fac=function(f){return new(f||n)(Ci(Nh))},n.\u0275dir=_r({type:n,selectors:[["","cdkHeaderCellDef",""]],standalone:!0});let a=n;return a})(),RA=(()=>{let n=class n{constructor(c){this.template=c}};n.\u0275fac=function(f){return new(f||n)(Ci(Nh))},n.\u0275dir=_r({type:n,selectors:[["","cdkFooterCellDef",""]],standalone:!0});let a=n;return a})(),o0=(()=>{let n=class n{get name(){return this._name}set name(c){this._setNameInput(c)}get sticky(){return this._sticky}set sticky(c){c!==this._sticky&&(this._sticky=c,this._hasStickyChanged=!0)}get stickyEnd(){return this._stickyEnd}set stickyEnd(c){c!==this._stickyEnd&&(this._stickyEnd=c,this._hasStickyChanged=!0)}constructor(c){this._table=c,this._hasStickyChanged=!1,this._sticky=!1,this._stickyEnd=!1}hasStickyChanged(){let c=this._hasStickyChanged;return this.resetStickyChanged(),c}resetStickyChanged(){this._hasStickyChanged=!1}_updateColumnCssClassName(){this._columnCssClassName=[`cdk-column-${this.cssClassFriendlyName}`]}_setNameInput(c){c&&(this._name=c,this.cssClassFriendlyName=c.replace(/[^a-z0-9_-]/gi,"-"),this._updateColumnCssClassName())}};n.\u0275fac=function(f){return new(f||n)(Ci(Yu,8))},n.\u0275dir=_r({type:n,selectors:[["","cdkColumnDef",""]],contentQueries:function(f,i,x){if(f&1&&(zs(x,Q1,5),zs(x,ex,5),zs(x,RA,5)),f&2){let T;Ta(T=Sa())&&(i.cell=T.first),Ta(T=Sa())&&(i.headerCell=T.first),Ta(T=Sa())&&(i.footerCell=T.first)}},inputs:{name:[0,"cdkColumnDef","name"],sticky:[2,"sticky","sticky",ws],stickyEnd:[2,"stickyEnd","stickyEnd",ws]},standalone:!0,features:[Ea([{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:n}]),Al]});let a=n;return a})(),Z1=class{constructor(n,l){l.nativeElement.classList.add(...n._columnCssClassName)}},OA=(()=>{let n=class n extends Z1{constructor(c,f){super(c,f)}};n.\u0275fac=function(f){return new(f||n)(Ci(o0),Ci(Ln))},n.\u0275dir=_r({type:n,selectors:[["cdk-header-cell"],["th","cdk-header-cell",""]],hostAttrs:["role","columnheader",1,"cdk-header-cell"],standalone:!0,features:[ea]});let a=n;return a})();var NA=(()=>{let n=class n extends Z1{constructor(c,f){super(c,f);let i=c._table?._getCellRole();i&&f.nativeElement.setAttribute("role",i)}};n.\u0275fac=function(f){return new(f||n)(Ci(o0),Ci(Ln))},n.\u0275dir=_r({type:n,selectors:[["cdk-cell"],["td","cdk-cell",""]],hostAttrs:[1,"cdk-cell"],standalone:!0,features:[ea]});let a=n;return a})(),Y1=class{constructor(){this.tasks=[],this.endTasks=[]}},K1=new Hn("_COALESCED_STYLE_SCHEDULER"),Ab=(()=>{let n=class n{constructor(c){this._currentSchedule=null,this._ngZone=Qn(Wn)}schedule(c){this._createScheduleIfNeeded(),this._currentSchedule.tasks.push(c)}scheduleEnd(c){this._createScheduleIfNeeded(),this._currentSchedule.endTasks.push(c)}_createScheduleIfNeeded(){this._currentSchedule||(this._currentSchedule=new Y1,this._ngZone.runOutsideAngular(()=>queueMicrotask(()=>{for(;this._currentSchedule.tasks.length||this._currentSchedule.endTasks.length;){let c=this._currentSchedule;this._currentSchedule=new Y1;for(let f of c.tasks)f();for(let f of c.endTasks)f()}this._currentSchedule=null})))}};n.\u0275fac=function(f){return new(f||n)(Tn(Wn))},n.\u0275prov=fa({token:n,factory:n.\u0275fac});let a=n;return a})();var Cb=(()=>{let n=class n{constructor(c,f){this.template=c,this._differs=f}ngOnChanges(c){if(!this._columnsDiffer){let f=c.columns&&c.columns.currentValue||[];this._columnsDiffer=this._differs.find(f).create(),this._columnsDiffer.diff(f)}}getColumnsDiff(){return this._columnsDiffer.diff(this.columns)}extractCellTemplate(c){return this instanceof kg?c.headerCell.template:this instanceof Ib?c.footerCell.template:c.cell.template}};n.\u0275fac=function(f){return new(f||n)(Ci(Nh),Ci(Rp))},n.\u0275dir=_r({type:n,features:[su]});let a=n;return a})(),kg=(()=>{let n=class n extends Cb{get sticky(){return this._sticky}set sticky(c){c!==this._sticky&&(this._sticky=c,this._hasStickyChanged=!0)}constructor(c,f,i){super(c,f),this._table=i,this._hasStickyChanged=!1,this._sticky=!1}ngOnChanges(c){super.ngOnChanges(c)}hasStickyChanged(){let c=this._hasStickyChanged;return this.resetStickyChanged(),c}resetStickyChanged(){this._hasStickyChanged=!1}};n.\u0275fac=function(f){return new(f||n)(Ci(Nh),Ci(Rp),Ci(Yu,8))},n.\u0275dir=_r({type:n,selectors:[["","cdkHeaderRowDef",""]],inputs:{columns:[0,"cdkHeaderRowDef","columns"],sticky:[2,"cdkHeaderRowDefSticky","sticky",ws]},standalone:!0,features:[Al,ea,su]});let a=n;return a})(),Ib=(()=>{let n=class n extends Cb{get sticky(){return this._sticky}set sticky(c){c!==this._sticky&&(this._sticky=c,this._hasStickyChanged=!0)}constructor(c,f,i){super(c,f),this._table=i,this._hasStickyChanged=!1,this._sticky=!1}ngOnChanges(c){super.ngOnChanges(c)}hasStickyChanged(){let c=this._hasStickyChanged;return this.resetStickyChanged(),c}resetStickyChanged(){this._hasStickyChanged=!1}};n.\u0275fac=function(f){return new(f||n)(Ci(Nh),Ci(Rp),Ci(Yu,8))},n.\u0275dir=_r({type:n,selectors:[["","cdkFooterRowDef",""]],inputs:{columns:[0,"cdkFooterRowDef","columns"],sticky:[2,"cdkFooterRowDefSticky","sticky",ws]},standalone:!0,features:[Al,ea,su]});let a=n;return a})(),tx=(()=>{let n=class n extends Cb{constructor(c,f,i){super(c,f),this._table=i}};n.\u0275fac=function(f){return new(f||n)(Ci(Nh),Ci(Rp),Ci(Yu,8))},n.\u0275dir=_r({type:n,selectors:[["","cdkRowDef",""]],inputs:{columns:[0,"cdkRowDefColumns","columns"],when:[0,"cdkRowDefWhen","when"]},standalone:!0,features:[ea]});let a=n;return a})(),Vp=(()=>{let n=class n{constructor(c){this._viewContainer=c,n.mostRecentCellOutlet=this}ngOnDestroy(){n.mostRecentCellOutlet===this&&(n.mostRecentCellOutlet=null)}};n.mostRecentCellOutlet=null,n.\u0275fac=function(f){return new(f||n)(Ci(Pp))},n.\u0275dir=_r({type:n,selectors:[["","cdkCellOutlet",""]],standalone:!0});let a=n;return a})(),kb=(()=>{let n=class n{};n.\u0275fac=function(f){return new(f||n)},n.\u0275cmp=wa({type:n,selectors:[["cdk-header-row"],["tr","cdk-header-row",""]],hostAttrs:["role","row",1,"cdk-header-row"],standalone:!0,features:[Aa],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(f,i){f&1&&Jl(0,0)},dependencies:[Vp],encapsulation:2});let a=n;return a})();var Mb=(()=>{let n=class n{};n.\u0275fac=function(f){return new(f||n)},n.\u0275cmp=wa({type:n,selectors:[["cdk-row"],["tr","cdk-row",""]],hostAttrs:["role","row",1,"cdk-row"],standalone:!0,features:[Aa],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(f,i){f&1&&Jl(0,0)},dependencies:[Vp],encapsulation:2});let a=n;return a})(),BA=(()=>{let n=class n{constructor(c){this.templateRef=c,this._contentClassName="cdk-no-data-row"}};n.\u0275fac=function(f){return new(f||n)(Ci(Nh))},n.\u0275dir=_r({type:n,selectors:[["ng-template","cdkNoDataRow",""]],standalone:!0});let a=n;return a})(),PA=["top","bottom","left","right"],Eb=class{constructor(n,l,c,f,i=!0,x=!0,T){this._isNativeHtmlTable=n,this._stickCellCss=l,this.direction=c,this._coalescedStyleScheduler=f,this._isBrowser=i,this._needsPositionStickyOnElement=x,this._positionListener=T,this._cachedCellWidths=[],this._borderCellCss={top:`${l}-border-elem-top`,bottom:`${l}-border-elem-bottom`,left:`${l}-border-elem-left`,right:`${l}-border-elem-right`}}clearStickyPositioning(n,l){let c=[];for(let f of n)if(f.nodeType===f.ELEMENT_NODE){c.push(f);for(let i=0;i<f.children.length;i++)c.push(f.children[i])}this._coalescedStyleScheduler.schedule(()=>{for(let f of c)this._removeStickyStyle(f,l)})}updateStickyColumns(n,l,c,f=!0){if(!n.length||!this._isBrowser||!(l.some(i=>i)||c.some(i=>i))){this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:[]}),this._positionListener.stickyEndColumnsUpdated({sizes:[]}));return}this._coalescedStyleScheduler.schedule(()=>{let i=n[0],x=i.children.length,T=this._getCellWidths(i,f),A=this._getStickyStartColumnPositions(T,l),M=this._getStickyEndColumnPositions(T,c),F=l.lastIndexOf(!0),W=c.indexOf(!0),V=this.direction==="rtl",R=V?"right":"left",te=V?"left":"right";for(let H of n)for(let J=0;J<x;J++){let K=H.children[J];l[J]&&this._addStickyStyle(K,R,A[J],J===F),c[J]&&this._addStickyStyle(K,te,M[J],J===W)}this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:F===-1?[]:T.slice(0,F+1).map((H,J)=>l[J]?H:null)}),this._positionListener.stickyEndColumnsUpdated({sizes:W===-1?[]:T.slice(W).map((H,J)=>c[J+W]?H:null).reverse()}))})}stickRows(n,l,c){this._isBrowser&&this._coalescedStyleScheduler.schedule(()=>{let f=c==="bottom"?n.slice().reverse():n,i=c==="bottom"?l.slice().reverse():l,x=[],T=[],A=[];for(let F=0,W=0;F<f.length;F++){if(!i[F])continue;x[F]=W;let V=f[F];A[F]=this._isNativeHtmlTable?Array.from(V.children):[V];let R=V.getBoundingClientRect().height;W+=R,T[F]=R}let M=i.lastIndexOf(!0);for(let F=0;F<f.length;F++){if(!i[F])continue;let W=x[F],V=F===M;for(let R of A[F])this._addStickyStyle(R,c,W,V)}c==="top"?this._positionListener?.stickyHeaderRowsUpdated({sizes:T,offsets:x,elements:A}):this._positionListener?.stickyFooterRowsUpdated({sizes:T,offsets:x,elements:A})})}updateStickyFooterContainer(n,l){this._isNativeHtmlTable&&this._coalescedStyleScheduler.schedule(()=>{let c=n.querySelector("tfoot");c&&(l.some(f=>!f)?this._removeStickyStyle(c,["bottom"]):this._addStickyStyle(c,"bottom",0,!1))})}_removeStickyStyle(n,l){for(let f of l)n.style[f]="",n.classList.remove(this._borderCellCss[f]);PA.some(f=>l.indexOf(f)===-1&&n.style[f])?n.style.zIndex=this._getCalculatedZIndex(n):(n.style.zIndex="",this._needsPositionStickyOnElement&&(n.style.position=""),n.classList.remove(this._stickCellCss))}_addStickyStyle(n,l,c,f){n.classList.add(this._stickCellCss),f&&n.classList.add(this._borderCellCss[l]),n.style[l]=`${c}px`,n.style.zIndex=this._getCalculatedZIndex(n),this._needsPositionStickyOnElement&&(n.style.cssText+="position: -webkit-sticky; position: sticky; ")}_getCalculatedZIndex(n){let l={top:100,bottom:10,left:1,right:1},c=0;for(let f of PA)n.style[f]&&(c+=l[f]);return c?`${c}`:""}_getCellWidths(n,l=!0){if(!l&&this._cachedCellWidths.length)return this._cachedCellWidths;let c=[],f=n.children;for(let i=0;i<f.length;i++){let x=f[i];c.push(x.getBoundingClientRect().width)}return this._cachedCellWidths=c,c}_getStickyStartColumnPositions(n,l){let c=[],f=0;for(let i=0;i<n.length;i++)l[i]&&(c[i]=f,f+=n[i]);return c}_getStickyEndColumnPositions(n,l){let c=[],f=0;for(let i=n.length;i>0;i--)l[i]&&(c[i]=f,f+=n[i]);return c}};var J1=new Hn("CDK_SPL");var Db=(()=>{let n=class n{constructor(c,f){this.viewContainer=c,this.elementRef=f;let i=Qn(Yu);i._rowOutlet=this,i._outletAssigned()}};n.\u0275fac=function(f){return new(f||n)(Ci(Pp),Ci(Ln))},n.\u0275dir=_r({type:n,selectors:[["","rowOutlet",""]],standalone:!0});let a=n;return a})(),Fb=(()=>{let n=class n{constructor(c,f){this.viewContainer=c,this.elementRef=f;let i=Qn(Yu);i._headerRowOutlet=this,i._outletAssigned()}};n.\u0275fac=function(f){return new(f||n)(Ci(Pp),Ci(Ln))},n.\u0275dir=_r({type:n,selectors:[["","headerRowOutlet",""]],standalone:!0});let a=n;return a})(),Pb=(()=>{let n=class n{constructor(c,f){this.viewContainer=c,this.elementRef=f;let i=Qn(Yu);i._footerRowOutlet=this,i._outletAssigned()}};n.\u0275fac=function(f){return new(f||n)(Ci(Pp),Ci(Ln))},n.\u0275dir=_r({type:n,selectors:[["","footerRowOutlet",""]],standalone:!0});let a=n;return a})(),Lb=(()=>{let n=class n{constructor(c,f){this.viewContainer=c,this.elementRef=f;let i=Qn(Yu);i._noDataRowOutlet=this,i._outletAssigned()}};n.\u0275fac=function(f){return new(f||n)(Ci(Pp),Ci(Ln))},n.\u0275dir=_r({type:n,selectors:[["","noDataRowOutlet",""]],standalone:!0});let a=n;return a})();var Rb=(()=>{let n=class n{_getCellRole(){if(this._cellRoleInternal===void 0){let c=this._elementRef.nativeElement.getAttribute("role"),f=c==="grid"||c==="treegrid"?"gridcell":"cell";this._cellRoleInternal=this._isNativeHtmlTable&&f==="cell"?null:f}return this._cellRoleInternal}get trackBy(){return this._trackByFn}set trackBy(c){this._trackByFn=c}get dataSource(){return this._dataSource}set dataSource(c){this._dataSource!==c&&this._switchDataSource(c)}get multiTemplateDataRows(){return this._multiTemplateDataRows}set multiTemplateDataRows(c){this._multiTemplateDataRows=c,this._rowOutlet&&this._rowOutlet.viewContainer.length&&(this._forceRenderDataRows(),this.updateStickyColumnStyles())}get fixedLayout(){return this._fixedLayout}set fixedLayout(c){this._fixedLayout=c,this._forceRecalculateCellWidths=!0,this._stickyColumnStylesNeedReset=!0}constructor(c,f,i,x,T,A,M,F,W,V,R,te){this._differs=c,this._changeDetectorRef=f,this._elementRef=i,this._dir=T,this._platform=M,this._viewRepeater=F,this._coalescedStyleScheduler=W,this._viewportRuler=V,this._stickyPositioningListener=R,this._onDestroy=new Mo,this._columnDefsByName=new Map,this._customColumnDefs=new Set,this._customRowDefs=new Set,this._customHeaderRowDefs=new Set,this._customFooterRowDefs=new Set,this._headerRowDefChanged=!0,this._footerRowDefChanged=!0,this._stickyColumnStylesNeedReset=!0,this._forceRecalculateCellWidths=!0,this._cachedRenderRowsMap=new Map,this.stickyCssClass="cdk-table-sticky",this.needsPositionStickyOnElement=!0,this._isShowingNoDataRow=!1,this._hasAllOutlets=!1,this._hasInitialized=!1,this._cellRoleInternal=void 0,this._multiTemplateDataRows=!1,this._fixedLayout=!1,this.contentChanged=new lu,this.viewChange=new d1({start:0,end:Number.MAX_VALUE}),this._injector=Qn(Wm),x||i.nativeElement.setAttribute("role","table"),this._document=A,this._isServer=!M.isBrowser,this._isNativeHtmlTable=i.nativeElement.nodeName==="TABLE"}ngOnInit(){this._setupStickyStyler(),this._dataDiffer=this._differs.find([]).create((c,f)=>this.trackBy?this.trackBy(f.dataIndex,f.data):f),this._viewportRuler.change().pipe(Kl(this._onDestroy)).subscribe(()=>{this._forceRecalculateCellWidths=!0})}ngAfterContentInit(){this._hasInitialized=!0}ngAfterContentChecked(){this._canRender()&&this._render()}ngOnDestroy(){[this._rowOutlet?.viewContainer,this._headerRowOutlet?.viewContainer,this._footerRowOutlet?.viewContainer,this._cachedRenderRowsMap,this._customColumnDefs,this._customRowDefs,this._customHeaderRowDefs,this._customFooterRowDefs,this._columnDefsByName].forEach(c=>{c?.clear()}),this._headerRowDefs=[],this._footerRowDefs=[],this._defaultRowDef=null,this._onDestroy.next(),this._onDestroy.complete(),$1(this.dataSource)&&this.dataSource.disconnect(this)}renderRows(){this._renderRows=this._getAllRenderRows();let c=this._dataDiffer.diff(this._renderRows);if(!c){this._updateNoDataRow(),this.contentChanged.next();return}let f=this._rowOutlet.viewContainer;this._viewRepeater.applyChanges(c,f,(i,x,T)=>this._getEmbeddedViewArgs(i.item,T),i=>i.item.data,i=>{i.operation===n0.INSERTED&&i.context&&this._renderCellTemplateForItem(i.record.item.rowDef,i.context)}),this._updateRowIndexContext(),c.forEachIdentityChange(i=>{let x=f.get(i.currentIndex);x.context.$implicit=i.item.data}),this._updateNoDataRow(),By(()=>{this.updateStickyColumnStyles()},{injector:this._injector}),this.contentChanged.next()}addColumnDef(c){this._customColumnDefs.add(c)}removeColumnDef(c){this._customColumnDefs.delete(c)}addRowDef(c){this._customRowDefs.add(c)}removeRowDef(c){this._customRowDefs.delete(c)}addHeaderRowDef(c){this._customHeaderRowDefs.add(c),this._headerRowDefChanged=!0}removeHeaderRowDef(c){this._customHeaderRowDefs.delete(c),this._headerRowDefChanged=!0}addFooterRowDef(c){this._customFooterRowDefs.add(c),this._footerRowDefChanged=!0}removeFooterRowDef(c){this._customFooterRowDefs.delete(c),this._footerRowDefChanged=!0}setNoDataRow(c){this._customNoDataRow=c}updateStickyHeaderRowStyles(){let c=this._getRenderedRows(this._headerRowOutlet);if(this._isNativeHtmlTable){let i=LA(this._headerRowOutlet,"thead");i&&(i.style.display=c.length?"":"none")}let f=this._headerRowDefs.map(i=>i.sticky);this._stickyStyler.clearStickyPositioning(c,["top"]),this._stickyStyler.stickRows(c,f,"top"),this._headerRowDefs.forEach(i=>i.resetStickyChanged())}updateStickyFooterRowStyles(){let c=this._getRenderedRows(this._footerRowOutlet);if(this._isNativeHtmlTable){let i=LA(this._footerRowOutlet,"tfoot");i&&(i.style.display=c.length?"":"none")}let f=this._footerRowDefs.map(i=>i.sticky);this._stickyStyler.clearStickyPositioning(c,["bottom"]),this._stickyStyler.stickRows(c,f,"bottom"),this._stickyStyler.updateStickyFooterContainer(this._elementRef.nativeElement,f),this._footerRowDefs.forEach(i=>i.resetStickyChanged())}updateStickyColumnStyles(){let c=this._getRenderedRows(this._headerRowOutlet),f=this._getRenderedRows(this._rowOutlet),i=this._getRenderedRows(this._footerRowOutlet);(this._isNativeHtmlTable&&!this._fixedLayout||this._stickyColumnStylesNeedReset)&&(this._stickyStyler.clearStickyPositioning([...c,...f,...i],["left","right"]),this._stickyColumnStylesNeedReset=!1),c.forEach((x,T)=>{this._addStickyColumnStyles([x],this._headerRowDefs[T])}),this._rowDefs.forEach(x=>{let T=[];for(let A=0;A<f.length;A++)this._renderRows[A].rowDef===x&&T.push(f[A]);this._addStickyColumnStyles(T,x)}),i.forEach((x,T)=>{this._addStickyColumnStyles([x],this._footerRowDefs[T])}),Array.from(this._columnDefsByName.values()).forEach(x=>x.resetStickyChanged())}_outletAssigned(){!this._hasAllOutlets&&this._rowOutlet&&this._headerRowOutlet&&this._footerRowOutlet&&this._noDataRowOutlet&&(this._hasAllOutlets=!0,this._canRender()&&this._render())}_canRender(){return this._hasAllOutlets&&this._hasInitialized}_render(){this._cacheRowDefs(),this._cacheColumnDefs(),!this._headerRowDefs.length&&!this._footerRowDefs.length&&this._rowDefs.length;let f=this._renderUpdatedColumns()||this._headerRowDefChanged||this._footerRowDefChanged;this._stickyColumnStylesNeedReset=this._stickyColumnStylesNeedReset||f,this._forceRecalculateCellWidths=f,this._headerRowDefChanged&&(this._forceRenderHeaderRows(),this._headerRowDefChanged=!1),this._footerRowDefChanged&&(this._forceRenderFooterRows(),this._footerRowDefChanged=!1),this.dataSource&&this._rowDefs.length>0&&!this._renderChangeSubscription?this._observeRenderChanges():this._stickyColumnStylesNeedReset&&this.updateStickyColumnStyles(),this._checkStickyStates()}_getAllRenderRows(){let c=[],f=this._cachedRenderRowsMap;this._cachedRenderRowsMap=new Map;for(let i=0;i<this._data.length;i++){let x=this._data[i],T=this._getRenderRowsForData(x,i,f.get(x));this._cachedRenderRowsMap.has(x)||this._cachedRenderRowsMap.set(x,new WeakMap);for(let A=0;A<T.length;A++){let M=T[A],F=this._cachedRenderRowsMap.get(M.data);F.has(M.rowDef)?F.get(M.rowDef).push(M):F.set(M.rowDef,[M]),c.push(M)}}return c}_getRenderRowsForData(c,f,i){return this._getRowDefs(c,f).map(T=>{let A=i&&i.has(T)?i.get(T):[];if(A.length){let M=A.shift();return M.dataIndex=f,M}else return{data:c,rowDef:T,dataIndex:f}})}_cacheColumnDefs(){this._columnDefsByName.clear(),X1(this._getOwnDefs(this._contentColumnDefs),this._customColumnDefs).forEach(f=>{this._columnDefsByName.has(f.name),this._columnDefsByName.set(f.name,f)})}_cacheRowDefs(){this._headerRowDefs=X1(this._getOwnDefs(this._contentHeaderRowDefs),this._customHeaderRowDefs),this._footerRowDefs=X1(this._getOwnDefs(this._contentFooterRowDefs),this._customFooterRowDefs),this._rowDefs=X1(this._getOwnDefs(this._contentRowDefs),this._customRowDefs);let c=this._rowDefs.filter(f=>!f.when);!this.multiTemplateDataRows&&c.length>1,this._defaultRowDef=c[0]}_renderUpdatedColumns(){let c=(T,A)=>T||!!A.getColumnsDiff(),f=this._rowDefs.reduce(c,!1);f&&this._forceRenderDataRows();let i=this._headerRowDefs.reduce(c,!1);i&&this._forceRenderHeaderRows();let x=this._footerRowDefs.reduce(c,!1);return x&&this._forceRenderFooterRows(),f||i||x}_switchDataSource(c){this._data=[],$1(this.dataSource)&&this.dataSource.disconnect(this),this._renderChangeSubscription&&(this._renderChangeSubscription.unsubscribe(),this._renderChangeSubscription=null),c||(this._dataDiffer&&this._dataDiffer.diff([]),this._rowOutlet&&this._rowOutlet.viewContainer.clear()),this._dataSource=c}_observeRenderChanges(){if(!this.dataSource)return;let c;$1(this.dataSource)?c=this.dataSource.connect(this):f1(this.dataSource)?c=this.dataSource:Array.isArray(this.dataSource)&&(c=Fp(this.dataSource)),this._renderChangeSubscription=c.pipe(Kl(this._onDestroy)).subscribe(f=>{this._data=f||[],this.renderRows()})}_forceRenderHeaderRows(){this._headerRowOutlet.viewContainer.length>0&&this._headerRowOutlet.viewContainer.clear(),this._headerRowDefs.forEach((c,f)=>this._renderRow(this._headerRowOutlet,c,f)),this.updateStickyHeaderRowStyles()}_forceRenderFooterRows(){this._footerRowOutlet.viewContainer.length>0&&this._footerRowOutlet.viewContainer.clear(),this._footerRowDefs.forEach((c,f)=>this._renderRow(this._footerRowOutlet,c,f)),this.updateStickyFooterRowStyles()}_addStickyColumnStyles(c,f){let i=Array.from(f.columns||[]).map(A=>{let M=this._columnDefsByName.get(A);return M}),x=i.map(A=>A.sticky),T=i.map(A=>A.stickyEnd);this._stickyStyler.updateStickyColumns(c,x,T,!this._fixedLayout||this._forceRecalculateCellWidths)}_getRenderedRows(c){let f=[];for(let i=0;i<c.viewContainer.length;i++){let x=c.viewContainer.get(i);f.push(x.rootNodes[0])}return f}_getRowDefs(c,f){if(this._rowDefs.length==1)return[this._rowDefs[0]];let i=[];if(this.multiTemplateDataRows)i=this._rowDefs.filter(x=>!x.when||x.when(f,c));else{let x=this._rowDefs.find(T=>T.when&&T.when(f,c))||this._defaultRowDef;x&&i.push(x)}return i.length,i}_getEmbeddedViewArgs(c,f){let i=c.rowDef,x={$implicit:c.data};return{templateRef:i.template,context:x,index:f}}_renderRow(c,f,i,x={}){let T=c.viewContainer.createEmbeddedView(f.template,x,i);return this._renderCellTemplateForItem(f,x),T}_renderCellTemplateForItem(c,f){for(let i of this._getCellTemplates(c))Vp.mostRecentCellOutlet&&Vp.mostRecentCellOutlet._viewContainer.createEmbeddedView(i,f);this._changeDetectorRef.markForCheck()}_updateRowIndexContext(){let c=this._rowOutlet.viewContainer;for(let f=0,i=c.length;f<i;f++){let T=c.get(f).context;T.count=i,T.first=f===0,T.last=f===i-1,T.even=f%2===0,T.odd=!T.even,this.multiTemplateDataRows?(T.dataIndex=this._renderRows[f].dataIndex,T.renderIndex=f):T.index=this._renderRows[f].dataIndex}}_getCellTemplates(c){return!c||!c.columns?[]:Array.from(c.columns,f=>{let i=this._columnDefsByName.get(f);return c.extractCellTemplate(i)})}_forceRenderDataRows(){this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear(),this.renderRows()}_checkStickyStates(){let c=(f,i)=>f||i.hasStickyChanged();this._headerRowDefs.reduce(c,!1)&&this.updateStickyHeaderRowStyles(),this._footerRowDefs.reduce(c,!1)&&this.updateStickyFooterRowStyles(),Array.from(this._columnDefsByName.values()).reduce(c,!1)&&(this._stickyColumnStylesNeedReset=!0,this.updateStickyColumnStyles())}_setupStickyStyler(){let c=this._dir?this._dir.value:"ltr";this._stickyStyler=new Eb(this._isNativeHtmlTable,this.stickyCssClass,c,this._coalescedStyleScheduler,this._platform.isBrowser,this.needsPositionStickyOnElement,this._stickyPositioningListener),(this._dir?this._dir.change:Fp()).pipe(Kl(this._onDestroy)).subscribe(f=>{this._stickyStyler.direction=f,this.updateStickyColumnStyles()})}_getOwnDefs(c){return c.filter(f=>!f._table||f._table===this)}_updateNoDataRow(){let c=this._customNoDataRow||this._noDataRow;if(!c)return;let f=this._rowOutlet.viewContainer.length===0;if(f===this._isShowingNoDataRow)return;let i=this._noDataRowOutlet.viewContainer;if(f){let x=i.createEmbeddedView(c.templateRef),T=x.rootNodes[0];x.rootNodes.length===1&&T?.nodeType===this._document.ELEMENT_NODE&&(T.setAttribute("role","row"),T.classList.add(c._contentClassName))}else i.clear();this._isShowingNoDataRow=f,this._changeDetectorRef.markForCheck()}};n.\u0275fac=function(f){return new(f||n)(Ci(Rp),Ci(Lp),Ci(Ln),xg("role"),Ci(w1,8),Ci(is),Ci(Ya),Ci(Ig),Ci(K1),Ci(DA),Ci(J1,12),Ci(Wn,8))},n.\u0275cmp=wa({type:n,selectors:[["cdk-table"],["table","cdk-table",""]],contentQueries:function(f,i,x){if(f&1&&(zs(x,BA,5),zs(x,o0,5),zs(x,tx,5),zs(x,kg,5),zs(x,Ib,5)),f&2){let T;Ta(T=Sa())&&(i._noDataRow=T.first),Ta(T=Sa())&&(i._contentColumnDefs=T),Ta(T=Sa())&&(i._contentRowDefs=T),Ta(T=Sa())&&(i._contentHeaderRowDefs=T),Ta(T=Sa())&&(i._contentFooterRowDefs=T)}},hostAttrs:[1,"cdk-table"],hostVars:2,hostBindings:function(f,i){f&2&&Za("cdk-table-fixed-layout",i.fixedLayout)},inputs:{trackBy:"trackBy",dataSource:"dataSource",multiTemplateDataRows:[2,"multiTemplateDataRows","multiTemplateDataRows",ws],fixedLayout:[2,"fixedLayout","fixedLayout",ws]},outputs:{contentChanged:"contentChanged"},exportAs:["cdkTable"],standalone:!0,features:[Ea([{provide:Yu,useExisting:n},{provide:Ig,useClass:a0},{provide:K1,useClass:Ab},{provide:J1,useValue:null}]),Al,Aa],ngContentSelectors:iL,decls:5,vars:2,consts:[["role","rowgroup"],["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(f,i){f&1&&(Ql(tL),pa(0),pa(1,1),_n(2,rL,1,0)(3,nL,7,0)(4,aL,4,0)),f&2&&(Er(2),jn(i._isServer?2:-1),Er(),jn(i._isNativeHtmlTable?3:4))},dependencies:[Fb,Db,Lb,Pb],styles:[".cdk-table-fixed-layout{table-layout:fixed}"],encapsulation:2});let a=n;return a})();function X1(a,n){return a.concat(Array.from(n))}function LA(a,n){let l=n.toUpperCase(),c=a.viewContainer.element.nativeElement;for(;c;){let f=c.nodeType===1?c.nodeName:null;if(f===l)return c;if(f==="TABLE")break;c=c.parentNode}return null}var zA=(()=>{let n=class n{};n.\u0275fac=function(f){return new(f||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Un({imports:[FA]});let a=n;return a})();var oL=[[["caption"]],[["colgroup"],["col"]],"*"],sL=["caption","colgroup, col","*"];function lL(a,n){a&1&&pa(0,2)}function cL(a,n){a&1&&(Qi(0,"thead",0),Jl(1,1),ji(),Qi(2,"tbody",2),Jl(3,3)(4,4),ji(),Qi(5,"tfoot",0),Jl(6,5),ji())}function uL(a,n){a&1&&Jl(0,1)(1,3)(2,4)(3,5)}var jA=(()=>{let n=class n extends Rb{constructor(){super(...arguments),this.stickyCssClass="mat-mdc-table-sticky",this.needsPositionStickyOnElement=!1}};n.\u0275fac=(()=>{let c;return function(i){return(c||(c=al(n)))(i||n)}})(),n.\u0275cmp=wa({type:n,selectors:[["mat-table"],["table","mat-table",""]],hostAttrs:[1,"mat-mdc-table","mdc-data-table__table"],hostVars:2,hostBindings:function(f,i){f&2&&Za("mdc-table-fixed-layout",i.fixedLayout)},exportAs:["matTable"],standalone:!0,features:[Ea([{provide:Rb,useExisting:n},{provide:Yu,useExisting:n},{provide:K1,useClass:Ab},{provide:Ig,useClass:a0},{provide:J1,useValue:null}]),ea,Aa],ngContentSelectors:sL,decls:5,vars:2,consts:[["role","rowgroup"],["headerRowOutlet",""],["role","rowgroup",1,"mdc-data-table__content"],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(f,i){f&1&&(Ql(oL),pa(0),pa(1,1),_n(2,lL,1,0)(3,cL,7,0)(4,uL,4,0)),f&2&&(Er(2),jn(i._isServer?2:-1),Er(),jn(i._isNativeHtmlTable?3:4))},dependencies:[Fb,Db,Lb,Pb],styles:[".mat-mdc-table-sticky{position:sticky !important}mat-table{display:block}mat-header-row{min-height:56px}mat-row,mat-footer-row{min-height:48px}mat-row,mat-header-row,mat-footer-row{display:flex;border-width:0;border-bottom-width:1px;border-style:solid;align-items:center;box-sizing:border-box}mat-cell:first-of-type,mat-header-cell:first-of-type,mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] mat-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:first-of-type:not(:only-of-type){padding-left:0;padding-right:24px}mat-cell:last-of-type,mat-header-cell:last-of-type,mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] mat-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:last-of-type:not(:only-of-type){padding-right:0;padding-left:24px}mat-cell,mat-header-cell,mat-footer-cell{flex:1;display:flex;align-items:center;overflow:hidden;word-wrap:break-word;min-height:inherit}.mat-mdc-table{min-width:100%;border:0;border-spacing:0;table-layout:auto;white-space:normal;background-color:var(--mat-table-background-color)}.mdc-data-table__cell{box-sizing:border-box;overflow:hidden;text-align:left;text-overflow:ellipsis}[dir=rtl] .mdc-data-table__cell{text-align:right}.mdc-data-table__cell,.mdc-data-table__header-cell{padding:0 16px}.mat-mdc-header-row{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mat-table-header-container-height, 56px);color:var(--mat-table-header-headline-color, rgba(0, 0, 0, 0.87));font-family:var(--mat-table-header-headline-font, Roboto, sans-serif);line-height:var(--mat-table-header-headline-line-height);font-size:var(--mat-table-header-headline-size, 14px);font-weight:var(--mat-table-header-headline-weight, 500)}.mat-mdc-row{height:var(--mat-table-row-item-container-height, 52px);color:var(--mat-table-row-item-label-text-color, rgba(0, 0, 0, 0.87))}.mat-mdc-row,.mdc-data-table__content{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-table-row-item-label-text-font, Roboto, sans-serif);line-height:var(--mat-table-row-item-label-text-line-height);font-size:var(--mat-table-row-item-label-text-size, 14px);font-weight:var(--mat-table-row-item-label-text-weight)}.mat-mdc-footer-row{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mat-table-footer-container-height, 52px);color:var(--mat-table-row-item-label-text-color, rgba(0, 0, 0, 0.87));font-family:var(--mat-table-footer-supporting-text-font, Roboto, sans-serif);line-height:var(--mat-table-footer-supporting-text-line-height);font-size:var(--mat-table-footer-supporting-text-size, 14px);font-weight:var(--mat-table-footer-supporting-text-weight);letter-spacing:var(--mat-table-footer-supporting-text-tracking)}.mat-mdc-header-cell{border-bottom-color:var(--mat-table-row-item-outline-color, rgba(0, 0, 0, 0.12));border-bottom-width:var(--mat-table-row-item-outline-width, 1px);border-bottom-style:solid;letter-spacing:var(--mat-table-header-headline-tracking);font-weight:inherit;line-height:inherit;box-sizing:border-box;text-overflow:ellipsis;overflow:hidden;outline:none;text-align:left}[dir=rtl] .mat-mdc-header-cell{text-align:right}.mat-mdc-cell{border-bottom-color:var(--mat-table-row-item-outline-color, rgba(0, 0, 0, 0.12));border-bottom-width:var(--mat-table-row-item-outline-width, 1px);border-bottom-style:solid;letter-spacing:var(--mat-table-row-item-label-text-tracking);line-height:inherit}.mdc-data-table__row:last-child .mat-mdc-cell{border-bottom:none}.mat-mdc-footer-cell{letter-spacing:var(--mat-table-row-item-label-text-tracking)}mat-row.mat-mdc-row,mat-header-row.mat-mdc-header-row,mat-footer-row.mat-mdc-footer-row{border-bottom:none}.mat-mdc-table tbody,.mat-mdc-table tfoot,.mat-mdc-table thead,.mat-mdc-cell,.mat-mdc-footer-cell,.mat-mdc-header-row,.mat-mdc-row,.mat-mdc-footer-row,.mat-mdc-table .mat-mdc-header-cell{background:inherit}.mat-mdc-table mat-header-row.mat-mdc-header-row,.mat-mdc-table mat-row.mat-mdc-row,.mat-mdc-table mat-footer-row.mat-mdc-footer-cell{height:unset}mat-header-cell.mat-mdc-header-cell,mat-cell.mat-mdc-cell,mat-footer-cell.mat-mdc-footer-cell{align-self:stretch}"],encapsulation:2});let a=n;return a})(),VA=(()=>{let n=class n extends Q1{};n.\u0275fac=(()=>{let c;return function(i){return(c||(c=al(n)))(i||n)}})(),n.\u0275dir=_r({type:n,selectors:[["","matCellDef",""]],standalone:!0,features:[Ea([{provide:Q1,useExisting:n}]),ea]});let a=n;return a})(),UA=(()=>{let n=class n extends ex{};n.\u0275fac=(()=>{let c;return function(i){return(c||(c=al(n)))(i||n)}})(),n.\u0275dir=_r({type:n,selectors:[["","matHeaderCellDef",""]],standalone:!0,features:[Ea([{provide:ex,useExisting:n}]),ea]});let a=n;return a})();var HA=(()=>{let n=class n extends o0{get name(){return this._name}set name(c){this._setNameInput(c)}_updateColumnCssClassName(){super._updateColumnCssClassName(),this._columnCssClassName.push(`mat-column-${this.cssClassFriendlyName}`)}};n.\u0275fac=(()=>{let c;return function(i){return(c||(c=al(n)))(i||n)}})(),n.\u0275dir=_r({type:n,selectors:[["","matColumnDef",""]],inputs:{name:[0,"matColumnDef","name"]},standalone:!0,features:[Ea([{provide:o0,useExisting:n},{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:n}]),ea]});let a=n;return a})(),GA=(()=>{let n=class n extends OA{};n.\u0275fac=(()=>{let c;return function(i){return(c||(c=al(n)))(i||n)}})(),n.\u0275dir=_r({type:n,selectors:[["mat-header-cell"],["th","mat-header-cell",""]],hostAttrs:["role","columnheader",1,"mat-mdc-header-cell","mdc-data-table__header-cell"],standalone:!0,features:[ea]});let a=n;return a})();var WA=(()=>{let n=class n extends NA{};n.\u0275fac=(()=>{let c;return function(i){return(c||(c=al(n)))(i||n)}})(),n.\u0275dir=_r({type:n,selectors:[["mat-cell"],["td","mat-cell",""]],hostAttrs:[1,"mat-mdc-cell","mdc-data-table__cell"],standalone:!0,features:[ea]});let a=n;return a})();var qA=(()=>{let n=class n extends kg{};n.\u0275fac=(()=>{let c;return function(i){return(c||(c=al(n)))(i||n)}})(),n.\u0275dir=_r({type:n,selectors:[["","matHeaderRowDef",""]],inputs:{columns:[0,"matHeaderRowDef","columns"],sticky:[2,"matHeaderRowDefSticky","sticky",ws]},standalone:!0,features:[Ea([{provide:kg,useExisting:n}]),Al,ea]});let a=n;return a})();var $A=(()=>{let n=class n extends tx{};n.\u0275fac=(()=>{let c;return function(i){return(c||(c=al(n)))(i||n)}})(),n.\u0275dir=_r({type:n,selectors:[["","matRowDef",""]],inputs:{columns:[0,"matRowDefColumns","columns"],when:[0,"matRowDefWhen","when"]},standalone:!0,features:[Ea([{provide:tx,useExisting:n}]),ea]});let a=n;return a})(),XA=(()=>{let n=class n extends kb{};n.\u0275fac=(()=>{let c;return function(i){return(c||(c=al(n)))(i||n)}})(),n.\u0275cmp=wa({type:n,selectors:[["mat-header-row"],["tr","mat-header-row",""]],hostAttrs:["role","row",1,"mat-mdc-header-row","mdc-data-table__header-row"],exportAs:["matHeaderRow"],standalone:!0,features:[Ea([{provide:kb,useExisting:n}]),ea,Aa],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(f,i){f&1&&Jl(0,0)},dependencies:[Vp],encapsulation:2});let a=n;return a})();var ZA=(()=>{let n=class n extends Mb{};n.\u0275fac=(()=>{let c;return function(i){return(c||(c=al(n)))(i||n)}})(),n.\u0275cmp=wa({type:n,selectors:[["mat-row"],["tr","mat-row",""]],hostAttrs:["role","row",1,"mat-mdc-row","mdc-data-table__row"],exportAs:["matRow"],standalone:!0,features:[Ea([{provide:Mb,useExisting:n}]),ea,Aa],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(f,i){f&1&&Jl(0,0)},dependencies:[Vp],encapsulation:2});let a=n;return a})();var YA=(()=>{let n=class n{};n.\u0275fac=function(f){return new(f||n)},n.\u0275mod=Gn({type:n}),n.\u0275inj=Un({imports:[Wo,zA,Wo]});let a=n;return a})();var Bg={};Bg.version="0.18.5";var Hp=1200,_0=1252,dL=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],fL={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},N3=function(a){dL.indexOf(a)!=-1&&(_0=fL[0]=a)};function pL(){N3(1252)}var zg=function(a){Hp=a,N3(a)};function mL(){zg(1200),pL()}function gL(a){for(var n=[],l=0;l<a.length>>1;++l)n[l]=String.fromCharCode(a.charCodeAt(2*l+1)+(a.charCodeAt(2*l)<<8));return n.join("")}var ix=function(n){return String.fromCharCode(n)},KA=function(n){return String.fromCharCode(n)},Fa;var Hh=null,Mg=!0,Vf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function jg(a){for(var n="",l=0,c=0,f=0,i=0,x=0,T=0,A=0,M=0;M<a.length;)l=a.charCodeAt(M++),i=l>>2,c=a.charCodeAt(M++),x=(l&3)<<4|c>>4,f=a.charCodeAt(M++),T=(c&15)<<2|f>>6,A=f&63,isNaN(c)?T=A=64:isNaN(f)&&(A=64),n+=Vf.charAt(i)+Vf.charAt(x)+Vf.charAt(T)+Vf.charAt(A);return n}function jd(a){var n="",l=0,c=0,f=0,i=0,x=0,T=0,A=0;a=a.replace(/[^\w\+\/\=]/g,"");for(var M=0;M<a.length;)i=Vf.indexOf(a.charAt(M++)),x=Vf.indexOf(a.charAt(M++)),l=i<<2|x>>4,n+=String.fromCharCode(l),T=Vf.indexOf(a.charAt(M++)),c=(x&15)<<4|T>>2,T!==64&&(n+=String.fromCharCode(c)),A=Vf.indexOf(a.charAt(M++)),f=(T&3)<<6|A,A!==64&&(n+=String.fromCharCode(f));return n}var ta=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ud=function(){if(typeof Buffer<"u"){var a=!Buffer.from;if(!a)try{Buffer.from("foo","utf8")}catch{a=!0}return a?function(n,l){return l?new Buffer(n,l):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}}();function Wp(a){return ta?Buffer.alloc?Buffer.alloc(a):new Buffer(a):typeof Uint8Array<"u"?new Uint8Array(a):new Array(a)}function JA(a){return ta?Buffer.allocUnsafe?Buffer.allocUnsafe(a):new Buffer(a):typeof Uint8Array<"u"?new Uint8Array(a):new Array(a)}var Qu=function(n){return ta?Ud(n,"binary"):n.split("").map(function(l){return l.charCodeAt(0)&255})};function Sx(a){if(typeof ArrayBuffer>"u")return Qu(a);for(var n=new ArrayBuffer(a.length),l=new Uint8Array(n),c=0;c!=a.length;++c)l[c]=a.charCodeAt(c)&255;return n}function Wg(a){if(Array.isArray(a))return a.map(function(c){return String.fromCharCode(c)}).join("");for(var n=[],l=0;l<a.length;++l)n[l]=String.fromCharCode(a[l]);return n.join("")}function _L(a){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(a)}var Us=ta?function(a){return Buffer.concat(a.map(function(n){return Buffer.isBuffer(n)?n:Ud(n)}))}:function(a){if(typeof Uint8Array<"u"){var n=0,l=0;for(n=0;n<a.length;++n)l+=a[n].length;var c=new Uint8Array(l),f=0;for(n=0,l=0;n<a.length;l+=f,++n)if(f=a[n].length,a[n]instanceof Uint8Array)c.set(a[n],l);else{if(typeof a[n]=="string")throw"wtf";c.set(new Uint8Array(a[n]),l)}return c}return[].concat.apply([],a.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function xL(a){for(var n=[],l=0,c=a.length+250,f=Wp(a.length+255),i=0;i<a.length;++i){var x=a.charCodeAt(i);if(x<128)f[l++]=x;else if(x<2048)f[l++]=192|x>>6&31,f[l++]=128|x&63;else if(x>=55296&&x<57344){x=(x&1023)+64;var T=a.charCodeAt(++i)&1023;f[l++]=240|x>>8&7,f[l++]=128|x>>2&63,f[l++]=128|T>>6&15|(x&3)<<4,f[l++]=128|T&63}else f[l++]=224|x>>12&15,f[l++]=128|x>>6&63,f[l++]=128|x&63;l>c&&(n.push(f.slice(0,l)),l=0,f=Wp(65535),c=65530)}return n.push(f.slice(0,l)),Us(n)}var d0=/\u0000/g,rx=/[\u0001-\u0006]/g;function f0(a){for(var n="",l=a.length-1;l>=0;)n+=a.charAt(l--);return n}function eh(a,n){var l=""+a;return l.length>=n?l:To("0",n-l.length)+l}function Xb(a,n){var l=""+a;return l.length>=n?l:To(" ",n-l.length)+l}function hx(a,n){var l=""+a;return l.length>=n?l:l+To(" ",n-l.length)}function vL(a,n){var l=""+Math.round(a);return l.length>=n?l:To("0",n-l.length)+l}function yL(a,n){var l=""+a;return l.length>=n?l:To("0",n-l.length)+l}var QA=Math.pow(2,32);function s0(a,n){if(a>QA||a<-QA)return vL(a,n);var l=Math.round(a);return yL(l,n)}function dx(a,n){return n=n||0,a.length>=7+n&&(a.charCodeAt(n)|32)===103&&(a.charCodeAt(n+1)|32)===101&&(a.charCodeAt(n+2)|32)===110&&(a.charCodeAt(n+3)|32)===101&&(a.charCodeAt(n+4)|32)===114&&(a.charCodeAt(n+5)|32)===97&&(a.charCodeAt(n+6)|32)===108}var e3=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ob=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function bL(a){return a||(a={}),a[0]="General",a[1]="0",a[2]="0.00",a[3]="#,##0",a[4]="#,##0.00",a[9]="0%",a[10]="0.00%",a[11]="0.00E+00",a[12]="# ?/?",a[13]="# ??/??",a[14]="m/d/yy",a[15]="d-mmm-yy",a[16]="d-mmm",a[17]="mmm-yy",a[18]="h:mm AM/PM",a[19]="h:mm:ss AM/PM",a[20]="h:mm",a[21]="h:mm:ss",a[22]="m/d/yy h:mm",a[37]="#,##0 ;(#,##0)",a[38]="#,##0 ;[Red](#,##0)",a[39]="#,##0.00;(#,##0.00)",a[40]="#,##0.00;[Red](#,##0.00)",a[45]="mm:ss",a[46]="[h]:mm:ss",a[47]="mmss.0",a[48]="##0.0E+0",a[49]="@",a[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',a}var So={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},t3={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},wL={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function fx(a,n,l){for(var c=a<0?-1:1,f=a*c,i=0,x=1,T=0,A=1,M=0,F=0,W=Math.floor(f);M<n&&(W=Math.floor(f),T=W*x+i,F=W*M+A,!(f-W<5e-8));)f=1/(f-W),i=x,x=T,A=M,M=F;if(F>n&&(M>n?(F=A,T=i):(F=M,T=x)),!l)return[0,c*T,F];var V=Math.floor(c*T/F);return[V,c*T-V*F,F]}function nx(a,n,l){if(a>2958465||a<0)return null;var c=a|0,f=Math.floor(86400*(a-c)),i=0,x=[],T={D:c,T:f,u:86400*(a-c)-f,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(T.u)<1e-6&&(T.u=0),n&&n.date1904&&(c+=1462),T.u>.9999&&(T.u=0,++f==86400&&(T.T=f=0,++c,++T.D)),c===60)x=l?[1317,10,29]:[1900,2,29],i=3;else if(c===0)x=l?[1317,8,29]:[1900,1,0],i=6;else{c>60&&--c;var A=new Date(1900,0,1);A.setDate(A.getDate()+c-1),x=[A.getFullYear(),A.getMonth()+1,A.getDate()],i=A.getDay(),c<60&&(i=(i+6)%7),l&&(i=kL(A,x))}return T.y=x[0],T.m=x[1],T.d=x[2],T.S=f%60,f=Math.floor(f/60),T.M=f%60,f=Math.floor(f/60),T.H=f,T.q=i,T}var B3=new Date(1899,11,31,0,0,0),TL=B3.getTime(),SL=new Date(1900,2,1,0,0,0);function z3(a,n){var l=a.getTime();return n?l-=1461*24*60*60*1e3:a>=SL&&(l+=24*60*60*1e3),(l-(TL+(a.getTimezoneOffset()-B3.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Zb(a){return a.indexOf(".")==-1?a:a.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function EL(a){return a.indexOf("E")==-1?a:a.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function AL(a){var n=a<0?12:11,l=Zb(a.toFixed(12));return l.length<=n||(l=a.toPrecision(10),l.length<=n)?l:a.toExponential(5)}function CL(a){var n=Zb(a.toFixed(11));return n.length>(a<0?12:11)||n==="0"||n==="-0"?a.toPrecision(6):n}function IL(a){var n=Math.floor(Math.log(Math.abs(a))*Math.LOG10E),l;return n>=-4&&n<=-1?l=a.toPrecision(10+n):Math.abs(n)<=9?l=AL(a):n===10?l=a.toFixed(10).substr(0,12):l=CL(a),Zb(EL(l.toUpperCase()))}function Gb(a,n){switch(typeof a){case"string":return a;case"boolean":return a?"TRUE":"FALSE";case"number":return(a|0)===a?a.toString(10):IL(a);case"undefined":return"";case"object":if(a==null)return"";if(a instanceof Date)return Hf(14,z3(a,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+a)}function kL(a,n){n[0]-=581;var l=a.getDay();return a<60&&(l=(l+6)%7),l}function ML(a,n,l,c){var f="",i=0,x=0,T=l.y,A,M=0;switch(a){case 98:T=l.y+543;case 121:switch(n.length){case 1:case 2:A=T%100,M=2;break;default:A=T%1e4,M=4;break}break;case 109:switch(n.length){case 1:case 2:A=l.m,M=n.length;break;case 3:return Ob[l.m-1][1];case 5:return Ob[l.m-1][0];default:return Ob[l.m-1][2]}break;case 100:switch(n.length){case 1:case 2:A=l.d,M=n.length;break;case 3:return e3[l.q][0];default:return e3[l.q][1]}break;case 104:switch(n.length){case 1:case 2:A=1+(l.H+11)%12,M=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:A=l.H,M=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:A=l.M,M=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return l.u===0&&(n=="s"||n=="ss")?eh(l.S,n.length):(c>=2?x=c===3?1e3:100:x=c===1?10:1,i=Math.round(x*(l.S+l.u)),i>=60*x&&(i=0),n==="s"?i===0?"0":""+i/x:(f=eh(i,2+c),n==="ss"?f.substr(0,2):"."+f.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":A=l.D*24+l.H;break;case"[m]":case"[mm]":A=(l.D*24+l.H)*60+l.M;break;case"[s]":case"[ss]":A=((l.D*24+l.H)*60+l.M)*60+Math.round(l.S+l.u);break;default:throw"bad abstime format: "+n}M=n.length===3?1:2;break;case 101:A=T,M=1;break}var F=M>0?eh(A,M):"";return F}function Uf(a){var n=3;if(a.length<=n)return a;for(var l=a.length%n,c=a.substr(0,l);l!=a.length;l+=n)c+=(c.length>0?",":"")+a.substr(l,n);return c}var j3=/%/g;function DL(a,n,l){var c=n.replace(j3,""),f=n.length-c.length;return Nd(a,c,l*Math.pow(10,2*f))+To("%",f)}function FL(a,n,l){for(var c=n.length-1;n.charCodeAt(c-1)===44;)--c;return Nd(a,n.substr(0,c),l/Math.pow(10,3*(n.length-c)))}function V3(a,n){var l,c=a.indexOf("E")-a.indexOf(".")-1;if(a.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+V3(a,-n);var f=a.indexOf(".");f===-1&&(f=a.indexOf("E"));var i=Math.floor(Math.log(n)*Math.LOG10E)%f;if(i<0&&(i+=f),l=(n/Math.pow(10,i)).toPrecision(c+1+(f+i)%f),l.indexOf("e")===-1){var x=Math.floor(Math.log(n)*Math.LOG10E);for(l.indexOf(".")===-1?l=l.charAt(0)+"."+l.substr(1)+"E+"+(x-l.length+i):l+="E+"+(x-i);l.substr(0,2)==="0.";)l=l.charAt(0)+l.substr(2,f)+"."+l.substr(2+f),l=l.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");l=l.replace(/\+-/,"-")}l=l.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(T,A,M,F){return A+M+F.substr(0,(f+i)%f)+"."+F.substr(i)+"E"})}else l=n.toExponential(c);return a.match(/E\+00$/)&&l.match(/e[+-]\d$/)&&(l=l.substr(0,l.length-1)+"0"+l.charAt(l.length-1)),a.match(/E\-/)&&l.match(/e\+/)&&(l=l.replace(/e\+/,"e")),l.replace("e","E")}var U3=/# (\?+)( ?)\/( ?)(\d+)/;function PL(a,n,l){var c=parseInt(a[4],10),f=Math.round(n*c),i=Math.floor(f/c),x=f-i*c,T=c;return l+(i===0?"":""+i)+" "+(x===0?To(" ",a[1].length+1+a[4].length):Xb(x,a[1].length)+a[2]+"/"+a[3]+eh(T,a[4].length))}function LL(a,n,l){return l+(n===0?"":""+n)+To(" ",a[1].length+2+a[4].length)}var H3=/^#*0*\.([0#]+)/,G3=/\).*[0#]/,W3=/\(###\) ###\\?-####/;function Cl(a){for(var n="",l,c=0;c!=a.length;++c)switch(l=a.charCodeAt(c)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(l)}return n}function i3(a,n){var l=Math.pow(10,n);return""+Math.round(a*l)/l}function r3(a,n){var l=a-Math.floor(a),c=Math.pow(10,n);return n<(""+Math.round(l*c)).length?0:Math.round(l*c)}function RL(a,n){return n<(""+Math.round((a-Math.floor(a))*Math.pow(10,n))).length?1:0}function OL(a){return a<2147483647&&a>-2147483648?""+(a>=0?a|0:a-1|0):""+Math.floor(a)}function uu(a,n,l){if(a.charCodeAt(0)===40&&!n.match(G3)){var c=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return l>=0?uu("n",c,l):"("+uu("n",c,-l)+")"}if(n.charCodeAt(n.length-1)===44)return FL(a,n,l);if(n.indexOf("%")!==-1)return DL(a,n,l);if(n.indexOf("E")!==-1)return V3(n,l);if(n.charCodeAt(0)===36)return"$"+uu(a,n.substr(n.charAt(1)==" "?2:1),l);var f,i,x,T,A=Math.abs(l),M=l<0?"-":"";if(n.match(/^00+$/))return M+s0(A,n.length);if(n.match(/^[#?]+$/))return f=s0(l,0),f==="0"&&(f=""),f.length>n.length?f:Cl(n.substr(0,n.length-f.length))+f;if(i=n.match(U3))return PL(i,A,M);if(n.match(/^#+0+$/))return M+s0(A,n.length-n.indexOf("0"));if(i=n.match(H3))return f=i3(l,i[1].length).replace(/^([^\.]+)$/,"$1."+Cl(i[1])).replace(/\.$/,"."+Cl(i[1])).replace(/\.(\d*)$/,function(te,H){return"."+H+To("0",Cl(i[1]).length-H.length)}),n.indexOf("0.")!==-1?f:f.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),i=n.match(/^(0*)\.(#*)$/))return M+i3(A,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=n.match(/^#{1,3},##0(\.?)$/))return M+Uf(s0(A,0));if(i=n.match(/^#,##0\.([#0]*0)$/))return l<0?"-"+uu(a,n,-l):Uf(""+(Math.floor(l)+RL(l,i[1].length)))+"."+eh(r3(l,i[1].length),i[1].length);if(i=n.match(/^#,#*,#0/))return uu(a,n.replace(/^#,#*,/,""),l);if(i=n.match(/^([0#]+)(\\?-([0#]+))+$/))return f=f0(uu(a,n.replace(/[\\-]/g,""),l)),x=0,f0(f0(n.replace(/\\/g,"")).replace(/[0#]/g,function(te){return x<f.length?f.charAt(x++):te==="0"?"0":""}));if(n.match(W3))return f=uu(a,"##########",l),"("+f.substr(0,3)+") "+f.substr(3,3)+"-"+f.substr(6);var F="";if(i=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return x=Math.min(i[4].length,7),T=fx(A,Math.pow(10,x)-1,!1),f=""+M,F=Nd("n",i[1],T[1]),F.charAt(F.length-1)==" "&&(F=F.substr(0,F.length-1)+"0"),f+=F+i[2]+"/"+i[3],F=hx(T[2],x),F.length<i[4].length&&(F=Cl(i[4].substr(i[4].length-F.length))+F),f+=F,f;if(i=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return x=Math.min(Math.max(i[1].length,i[4].length),7),T=fx(A,Math.pow(10,x)-1,!0),M+(T[0]||(T[1]?"":"0"))+" "+(T[1]?Xb(T[1],x)+i[2]+"/"+i[3]+hx(T[2],x):To(" ",2*x+1+i[2].length+i[3].length));if(i=n.match(/^[#0?]+$/))return f=s0(l,0),n.length<=f.length?f:Cl(n.substr(0,n.length-f.length))+f;if(i=n.match(/^([#0?]+)\.([#0]+)$/)){f=""+l.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),x=f.indexOf(".");var W=n.indexOf(".")-x,V=n.length-f.length-W;return Cl(n.substr(0,W)+f+n.substr(n.length-V))}if(i=n.match(/^00,000\.([#0]*0)$/))return x=r3(l,i[1].length),l<0?"-"+uu(a,n,-l):Uf(OL(l)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(te){return"00,"+(te.length<3?eh(0,3-te.length):"")+te})+"."+eh(x,i[1].length);switch(n){case"###,##0.00":return uu(a,"#,##0.00",l);case"###,###":case"##,###":case"#,###":var R=Uf(s0(A,0));return R!=="0"?M+R:"";case"###,###.00":return uu(a,"###,##0.00",l).replace(/^0\./,".");case"#,###.00":return uu(a,"#,##0.00",l).replace(/^0\./,".");default:}throw new Error("unsupported format |"+n+"|")}function NL(a,n,l){for(var c=n.length-1;n.charCodeAt(c-1)===44;)--c;return Nd(a,n.substr(0,c),l/Math.pow(10,3*(n.length-c)))}function BL(a,n,l){var c=n.replace(j3,""),f=n.length-c.length;return Nd(a,c,l*Math.pow(10,2*f))+To("%",f)}function q3(a,n){var l,c=a.indexOf("E")-a.indexOf(".")-1;if(a.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+q3(a,-n);var f=a.indexOf(".");f===-1&&(f=a.indexOf("E"));var i=Math.floor(Math.log(n)*Math.LOG10E)%f;if(i<0&&(i+=f),l=(n/Math.pow(10,i)).toPrecision(c+1+(f+i)%f),!l.match(/[Ee]/)){var x=Math.floor(Math.log(n)*Math.LOG10E);l.indexOf(".")===-1?l=l.charAt(0)+"."+l.substr(1)+"E+"+(x-l.length+i):l+="E+"+(x-i),l=l.replace(/\+-/,"-")}l=l.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(T,A,M,F){return A+M+F.substr(0,(f+i)%f)+"."+F.substr(i)+"E"})}else l=n.toExponential(c);return a.match(/E\+00$/)&&l.match(/e[+-]\d$/)&&(l=l.substr(0,l.length-1)+"0"+l.charAt(l.length-1)),a.match(/E\-/)&&l.match(/e\+/)&&(l=l.replace(/e\+/,"e")),l.replace("e","E")}function Vh(a,n,l){if(a.charCodeAt(0)===40&&!n.match(G3)){var c=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return l>=0?Vh("n",c,l):"("+Vh("n",c,-l)+")"}if(n.charCodeAt(n.length-1)===44)return NL(a,n,l);if(n.indexOf("%")!==-1)return BL(a,n,l);if(n.indexOf("E")!==-1)return q3(n,l);if(n.charCodeAt(0)===36)return"$"+Vh(a,n.substr(n.charAt(1)==" "?2:1),l);var f,i,x,T,A=Math.abs(l),M=l<0?"-":"";if(n.match(/^00+$/))return M+eh(A,n.length);if(n.match(/^[#?]+$/))return f=""+l,l===0&&(f=""),f.length>n.length?f:Cl(n.substr(0,n.length-f.length))+f;if(i=n.match(U3))return LL(i,A,M);if(n.match(/^#+0+$/))return M+eh(A,n.length-n.indexOf("0"));if(i=n.match(H3))return f=(""+l).replace(/^([^\.]+)$/,"$1."+Cl(i[1])).replace(/\.$/,"."+Cl(i[1])),f=f.replace(/\.(\d*)$/,function(te,H){return"."+H+To("0",Cl(i[1]).length-H.length)}),n.indexOf("0.")!==-1?f:f.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),i=n.match(/^(0*)\.(#*)$/))return M+(""+A).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=n.match(/^#{1,3},##0(\.?)$/))return M+Uf(""+A);if(i=n.match(/^#,##0\.([#0]*0)$/))return l<0?"-"+Vh(a,n,-l):Uf(""+l)+"."+To("0",i[1].length);if(i=n.match(/^#,#*,#0/))return Vh(a,n.replace(/^#,#*,/,""),l);if(i=n.match(/^([0#]+)(\\?-([0#]+))+$/))return f=f0(Vh(a,n.replace(/[\\-]/g,""),l)),x=0,f0(f0(n.replace(/\\/g,"")).replace(/[0#]/g,function(te){return x<f.length?f.charAt(x++):te==="0"?"0":""}));if(n.match(W3))return f=Vh(a,"##########",l),"("+f.substr(0,3)+") "+f.substr(3,3)+"-"+f.substr(6);var F="";if(i=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return x=Math.min(i[4].length,7),T=fx(A,Math.pow(10,x)-1,!1),f=""+M,F=Nd("n",i[1],T[1]),F.charAt(F.length-1)==" "&&(F=F.substr(0,F.length-1)+"0"),f+=F+i[2]+"/"+i[3],F=hx(T[2],x),F.length<i[4].length&&(F=Cl(i[4].substr(i[4].length-F.length))+F),f+=F,f;if(i=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return x=Math.min(Math.max(i[1].length,i[4].length),7),T=fx(A,Math.pow(10,x)-1,!0),M+(T[0]||(T[1]?"":"0"))+" "+(T[1]?Xb(T[1],x)+i[2]+"/"+i[3]+hx(T[2],x):To(" ",2*x+1+i[2].length+i[3].length));if(i=n.match(/^[#0?]+$/))return f=""+l,n.length<=f.length?f:Cl(n.substr(0,n.length-f.length))+f;if(i=n.match(/^([#0]+)\.([#0]+)$/)){f=""+l.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),x=f.indexOf(".");var W=n.indexOf(".")-x,V=n.length-f.length-W;return Cl(n.substr(0,W)+f+n.substr(n.length-V))}if(i=n.match(/^00,000\.([#0]*0)$/))return l<0?"-"+Vh(a,n,-l):Uf(""+l).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(te){return"00,"+(te.length<3?eh(0,3-te.length):"")+te})+"."+eh(0,i[1].length);switch(n){case"###,###":case"##,###":case"#,###":var R=Uf(""+A);return R!=="0"?M+R:"";default:if(n.match(/\.[0#?]*$/))return Vh(a,n.slice(0,n.lastIndexOf(".")),l)+Cl(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function Nd(a,n,l){return(l|0)===l?Vh(a,n,l):uu(a,n,l)}function zL(a){for(var n=[],l=!1,c=0,f=0;c<a.length;++c)switch(a.charCodeAt(c)){case 34:l=!l;break;case 95:case 42:case 92:++c;break;case 59:n[n.length]=a.substr(f,c-f),f=c+1}if(n[n.length]=a.substr(f),l===!0)throw new Error("Format |"+a+"| unterminated string ");return n}var $3=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function X3(a){for(var n=0,l="",c="";n<a.length;)switch(l=a.charAt(n)){case"G":dx(a,n)&&(n+=6),n++;break;case'"':for(;a.charCodeAt(++n)!==34&&n<a.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(a.charAt(n+1)==="1"||a.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(a.substr(n,3).toUpperCase()==="A/P"||a.substr(n,5).toUpperCase()==="AM/PM"||a.substr(n,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++n;break;case"[":for(c=l;a.charAt(n++)!=="]"&&n<a.length;)c+=a.charAt(n);if(c.match($3))return!0;break;case".":case"0":case"#":for(;n<a.length&&("0#?.,E+-%".indexOf(l=a.charAt(++n))>-1||l=="\\"&&a.charAt(n+1)=="-"&&"0#".indexOf(a.charAt(n+2))>-1););break;case"?":for(;a.charAt(++n)===l;);break;case"*":++n,(a.charAt(n)==" "||a.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<a.length&&"0123456789".indexOf(a.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function jL(a,n,l,c){for(var f=[],i="",x=0,T="",A="t",M,F,W,V="H";x<a.length;)switch(T=a.charAt(x)){case"G":if(!dx(a,x))throw new Error("unrecognized character "+T+" in "+a);f[f.length]={t:"G",v:"General"},x+=7;break;case'"':for(i="";(W=a.charCodeAt(++x))!==34&&x<a.length;)i+=String.fromCharCode(W);f[f.length]={t:"t",v:i},++x;break;case"\\":var R=a.charAt(++x),te=R==="("||R===")"?R:"t";f[f.length]={t:te,v:R},++x;break;case"_":f[f.length]={t:"t",v:" "},x+=2;break;case"@":f[f.length]={t:"T",v:n},++x;break;case"B":case"b":if(a.charAt(x+1)==="1"||a.charAt(x+1)==="2"){if(M==null&&(M=nx(n,l,a.charAt(x+1)==="2"),M==null))return"";f[f.length]={t:"X",v:a.substr(x,2)},A=T,x+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":T=T.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||M==null&&(M=nx(n,l),M==null))return"";for(i=T;++x<a.length&&a.charAt(x).toLowerCase()===T;)i+=T;T==="m"&&A.toLowerCase()==="h"&&(T="M"),T==="h"&&(T=V),f[f.length]={t:T,v:i},A=T;break;case"A":case"a":case"\u4E0A":var H={t:T,v:T};if(M==null&&(M=nx(n,l)),a.substr(x,3).toUpperCase()==="A/P"?(M!=null&&(H.v=M.H>=12?"P":"A"),H.t="T",V="h",x+=3):a.substr(x,5).toUpperCase()==="AM/PM"?(M!=null&&(H.v=M.H>=12?"PM":"AM"),H.t="T",x+=5,V="h"):a.substr(x,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(M!=null&&(H.v=M.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),H.t="T",x+=5,V="h"):(H.t="t",++x),M==null&&H.t==="T")return"";f[f.length]=H,A=T;break;case"[":for(i=T;a.charAt(x++)!=="]"&&x<a.length;)i+=a.charAt(x);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match($3)){if(M==null&&(M=nx(n,l),M==null))return"";f[f.length]={t:"Z",v:i.toLowerCase()},A=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",X3(a)||(f[f.length]={t:"t",v:i}));break;case".":if(M!=null){for(i=T;++x<a.length&&(T=a.charAt(x))==="0";)i+=T;f[f.length]={t:"s",v:i};break}case"0":case"#":for(i=T;++x<a.length&&"0#?.,E+-%".indexOf(T=a.charAt(x))>-1;)i+=T;f[f.length]={t:"n",v:i};break;case"?":for(i=T;a.charAt(++x)===T;)i+=T;f[f.length]={t:T,v:i},A=T;break;case"*":++x,(a.charAt(x)==" "||a.charAt(x)=="*")&&++x;break;case"(":case")":f[f.length]={t:c===1?"t":T,v:T},++x;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=T;x<a.length&&"0123456789".indexOf(a.charAt(++x))>-1;)i+=a.charAt(x);f[f.length]={t:"D",v:i};break;case" ":f[f.length]={t:T,v:T},++x;break;case"$":f[f.length]={t:"t",v:"$"},++x;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(T)===-1)throw new Error("unrecognized character "+T+" in "+a);f[f.length]={t:"t",v:T},++x;break}var J=0,K=0,ne;for(x=f.length-1,A="t";x>=0;--x)switch(f[x].t){case"h":case"H":f[x].t=V,A="h",J<1&&(J=1);break;case"s":(ne=f[x].v.match(/\.0+$/))&&(K=Math.max(K,ne[0].length-1)),J<3&&(J=3);case"d":case"y":case"M":case"e":A=f[x].t;break;case"m":A==="s"&&(f[x].t="M",J<2&&(J=2));break;case"X":break;case"Z":J<1&&f[x].v.match(/[Hh]/)&&(J=1),J<2&&f[x].v.match(/[Mm]/)&&(J=2),J<3&&f[x].v.match(/[Ss]/)&&(J=3)}switch(J){case 0:break;case 1:M.u>=.5&&(M.u=0,++M.S),M.S>=60&&(M.S=0,++M.M),M.M>=60&&(M.M=0,++M.H);break;case 2:M.u>=.5&&(M.u=0,++M.S),M.S>=60&&(M.S=0,++M.M);break}var de="",De;for(x=0;x<f.length;++x)switch(f[x].t){case"t":case"T":case" ":case"D":break;case"X":f[x].v="",f[x].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":f[x].v=ML(f[x].t.charCodeAt(0),f[x].v,M,K),f[x].t="t";break;case"n":case"?":for(De=x+1;f[De]!=null&&((T=f[De].t)==="?"||T==="D"||(T===" "||T==="t")&&f[De+1]!=null&&(f[De+1].t==="?"||f[De+1].t==="t"&&f[De+1].v==="/")||f[x].t==="("&&(T===" "||T==="n"||T===")")||T==="t"&&(f[De].v==="/"||f[De].v===" "&&f[De+1]!=null&&f[De+1].t=="?"));)f[x].v+=f[De].v,f[De]={v:"",t:";"},++De;de+=f[x].v,x=De-1;break;case"G":f[x].t="t",f[x].v=Gb(n,l);break}var Fe="",et,Te;if(de.length>0){de.charCodeAt(0)==40?(et=n<0&&de.charCodeAt(0)===45?-n:n,Te=Nd("n",de,et)):(et=n<0&&c>1?-n:n,Te=Nd("n",de,et),et<0&&f[0]&&f[0].t=="t"&&(Te=Te.substr(1),f[0].v="-"+f[0].v)),De=Te.length-1;var ge=f.length;for(x=0;x<f.length;++x)if(f[x]!=null&&f[x].t!="t"&&f[x].v.indexOf(".")>-1){ge=x;break}var Ve=f.length;if(ge===f.length&&Te.indexOf("E")===-1){for(x=f.length-1;x>=0;--x)f[x]==null||"n?".indexOf(f[x].t)===-1||(De>=f[x].v.length-1?(De-=f[x].v.length,f[x].v=Te.substr(De+1,f[x].v.length)):De<0?f[x].v="":(f[x].v=Te.substr(0,De+1),De=-1),f[x].t="t",Ve=x);De>=0&&Ve<f.length&&(f[Ve].v=Te.substr(0,De+1)+f[Ve].v)}else if(ge!==f.length&&Te.indexOf("E")===-1){for(De=Te.indexOf(".")-1,x=ge;x>=0;--x)if(!(f[x]==null||"n?".indexOf(f[x].t)===-1)){for(F=f[x].v.indexOf(".")>-1&&x===ge?f[x].v.indexOf(".")-1:f[x].v.length-1,Fe=f[x].v.substr(F+1);F>=0;--F)De>=0&&(f[x].v.charAt(F)==="0"||f[x].v.charAt(F)==="#")&&(Fe=Te.charAt(De--)+Fe);f[x].v=Fe,f[x].t="t",Ve=x}for(De>=0&&Ve<f.length&&(f[Ve].v=Te.substr(0,De+1)+f[Ve].v),De=Te.indexOf(".")+1,x=ge;x<f.length;++x)if(!(f[x]==null||"n?(".indexOf(f[x].t)===-1&&x!==ge)){for(F=f[x].v.indexOf(".")>-1&&x===ge?f[x].v.indexOf(".")+1:0,Fe=f[x].v.substr(0,F);F<f[x].v.length;++F)De<Te.length&&(Fe+=Te.charAt(De++));f[x].v=Fe,f[x].t="t",Ve=x}}}for(x=0;x<f.length;++x)f[x]!=null&&"n?".indexOf(f[x].t)>-1&&(et=c>1&&n<0&&x>0&&f[x-1].v==="-"?-n:n,f[x].v=Nd(f[x].t,f[x].v,et),f[x].t="t");var Ae="";for(x=0;x!==f.length;++x)f[x]!=null&&(Ae+=f[x].v);return Ae}var n3=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function a3(a,n){if(n==null)return!1;var l=parseFloat(n[2]);switch(n[1]){case"=":if(a==l)return!0;break;case">":if(a>l)return!0;break;case"<":if(a<l)return!0;break;case"<>":if(a!=l)return!0;break;case">=":if(a>=l)return!0;break;case"<=":if(a<=l)return!0;break}return!1}function VL(a,n){var l=zL(a),c=l.length,f=l[c-1].indexOf("@");if(c<4&&f>-1&&--c,l.length>4)throw new Error("cannot find right format for |"+l.join("|")+"|");if(typeof n!="number")return[4,l.length===4||f>-1?l[l.length-1]:"@"];switch(l.length){case 1:l=f>-1?["General","General","General",l[0]]:[l[0],l[0],l[0],"@"];break;case 2:l=f>-1?[l[0],l[0],l[0],l[1]]:[l[0],l[1],l[0],"@"];break;case 3:l=f>-1?[l[0],l[1],l[0],l[2]]:[l[0],l[1],l[2],"@"];break;case 4:break}var i=n>0?l[0]:n<0?l[1]:l[2];if(l[0].indexOf("[")===-1&&l[1].indexOf("[")===-1)return[c,i];if(l[0].match(/\[[=<>]/)!=null||l[1].match(/\[[=<>]/)!=null){var x=l[0].match(n3),T=l[1].match(n3);return a3(n,x)?[c,l[0]]:a3(n,T)?[c,l[1]]:[c,l[x!=null&&T!=null?2:1]]}return[c,i]}function Hf(a,n,l){l==null&&(l={});var c="";switch(typeof a){case"string":a=="m/d/yy"&&l.dateNF?c=l.dateNF:c=a;break;case"number":a==14&&l.dateNF?c=l.dateNF:c=(l.table!=null?l.table:So)[a],c==null&&(c=l.table&&l.table[t3[a]]||So[t3[a]]),c==null&&(c=wL[a]||"General");break}if(dx(c,0))return Gb(n,l);n instanceof Date&&(n=z3(n,l.date1904));var f=VL(c,n);if(dx(f[1]))return Gb(n,l);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return jL(f[1],n,l,f[0])}function Z3(a,n){if(typeof n!="number"){n=+n||-1;for(var l=0;l<392;++l){if(So[l]==null){n<0&&(n=l);continue}if(So[l]==a){n=l;break}}n<0&&(n=391)}return So[n]=a,n}function Ex(a){for(var n=0;n!=392;++n)a[n]!==void 0&&Z3(a[n],n)}function Ax(){So=bL()}var Y3=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function UL(a){var n=typeof a=="number"?So[a]:a;return n=n.replace(Y3,"(\\d+)"),new RegExp("^"+n+"$")}function HL(a,n,l){var c=-1,f=-1,i=-1,x=-1,T=-1,A=-1;(n.match(Y3)||[]).forEach(function(W,V){var R=parseInt(l[V+1],10);switch(W.toLowerCase().charAt(0)){case"y":c=R;break;case"d":i=R;break;case"h":x=R;break;case"s":A=R;break;case"m":x>=0?T=R:f=R;break}}),A>=0&&T==-1&&f>=0&&(T=f,f=-1);var M=(""+(c>=0?c:new Date().getFullYear())).slice(-4)+"-"+("00"+(f>=1?f:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);M.length==7&&(M="0"+M),M.length==8&&(M="20"+M);var F=("00"+(x>=0?x:0)).slice(-2)+":"+("00"+(T>=0?T:0)).slice(-2)+":"+("00"+(A>=0?A:0)).slice(-2);return x==-1&&T==-1&&A==-1?M:c==-1&&f==-1&&i==-1?F:M+"T"+F}var GL=function(){var a={};a.version="1.2.0";function n(){for(var Te=0,ge=new Array(256),Ve=0;Ve!=256;++Ve)Te=Ve,Te=Te&1?-306674912^Te>>>1:Te>>>1,Te=Te&1?-306674912^Te>>>1:Te>>>1,Te=Te&1?-306674912^Te>>>1:Te>>>1,Te=Te&1?-306674912^Te>>>1:Te>>>1,Te=Te&1?-306674912^Te>>>1:Te>>>1,Te=Te&1?-306674912^Te>>>1:Te>>>1,Te=Te&1?-306674912^Te>>>1:Te>>>1,Te=Te&1?-306674912^Te>>>1:Te>>>1,ge[Ve]=Te;return typeof Int32Array<"u"?new Int32Array(ge):ge}var l=n();function c(Te){var ge=0,Ve=0,Ae=0,_e=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Ae=0;Ae!=256;++Ae)_e[Ae]=Te[Ae];for(Ae=0;Ae!=256;++Ae)for(Ve=Te[Ae],ge=256+Ae;ge<4096;ge+=256)Ve=_e[ge]=Ve>>>8^Te[Ve&255];var xe=[];for(Ae=1;Ae!=16;++Ae)xe[Ae-1]=typeof Int32Array<"u"?_e.subarray(Ae*256,Ae*256+256):_e.slice(Ae*256,Ae*256+256);return xe}var f=c(l),i=f[0],x=f[1],T=f[2],A=f[3],M=f[4],F=f[5],W=f[6],V=f[7],R=f[8],te=f[9],H=f[10],J=f[11],K=f[12],ne=f[13],de=f[14];function De(Te,ge){for(var Ve=ge^-1,Ae=0,_e=Te.length;Ae<_e;)Ve=Ve>>>8^l[(Ve^Te.charCodeAt(Ae++))&255];return~Ve}function Fe(Te,ge){for(var Ve=ge^-1,Ae=Te.length-15,_e=0;_e<Ae;)Ve=de[Te[_e++]^Ve&255]^ne[Te[_e++]^Ve>>8&255]^K[Te[_e++]^Ve>>16&255]^J[Te[_e++]^Ve>>>24]^H[Te[_e++]]^te[Te[_e++]]^R[Te[_e++]]^V[Te[_e++]]^W[Te[_e++]]^F[Te[_e++]]^M[Te[_e++]]^A[Te[_e++]]^T[Te[_e++]]^x[Te[_e++]]^i[Te[_e++]]^l[Te[_e++]];for(Ae+=15;_e<Ae;)Ve=Ve>>>8^l[(Ve^Te[_e++])&255];return~Ve}function et(Te,ge){for(var Ve=ge^-1,Ae=0,_e=Te.length,xe=0,Qe=0;Ae<_e;)xe=Te.charCodeAt(Ae++),xe<128?Ve=Ve>>>8^l[(Ve^xe)&255]:xe<2048?(Ve=Ve>>>8^l[(Ve^(192|xe>>6&31))&255],Ve=Ve>>>8^l[(Ve^(128|xe&63))&255]):xe>=55296&&xe<57344?(xe=(xe&1023)+64,Qe=Te.charCodeAt(Ae++)&1023,Ve=Ve>>>8^l[(Ve^(240|xe>>8&7))&255],Ve=Ve>>>8^l[(Ve^(128|xe>>2&63))&255],Ve=Ve>>>8^l[(Ve^(128|Qe>>6&15|(xe&3)<<4))&255],Ve=Ve>>>8^l[(Ve^(128|Qe&63))&255]):(Ve=Ve>>>8^l[(Ve^(224|xe>>12&15))&255],Ve=Ve>>>8^l[(Ve^(128|xe>>6&63))&255],Ve=Ve>>>8^l[(Ve^(128|xe&63))&255]);return~Ve}return a.table=l,a.bstr=De,a.buf=Fe,a.str=et,a}(),Ca=function(){var n={};n.version="1.2.1";function l(ee,z){for(var G=ee.split("/"),Q=z.split("/"),se=0,le=0,Me=Math.min(G.length,Q.length);se<Me;++se){if(le=G[se].length-Q[se].length)return le;if(G[se]!=Q[se])return G[se]<Q[se]?-1:1}return G.length-Q.length}function c(ee){if(ee.charAt(ee.length-1)=="/")return ee.slice(0,-1).indexOf("/")===-1?ee:c(ee.slice(0,-1));var z=ee.lastIndexOf("/");return z===-1?ee:ee.slice(0,z+1)}function f(ee){if(ee.charAt(ee.length-1)=="/")return f(ee.slice(0,-1));var z=ee.lastIndexOf("/");return z===-1?ee:ee.slice(z+1)}function i(ee,z){typeof z=="string"&&(z=new Date(z));var G=z.getHours();G=G<<6|z.getMinutes(),G=G<<5|z.getSeconds()>>>1,ee.write_shift(2,G);var Q=z.getFullYear()-1980;Q=Q<<4|z.getMonth()+1,Q=Q<<5|z.getDate(),ee.write_shift(2,Q)}function x(ee){var z=ee.read_shift(2)&65535,G=ee.read_shift(2)&65535,Q=new Date,se=G&31;G>>>=5;var le=G&15;G>>>=4,Q.setMilliseconds(0),Q.setFullYear(G+1980),Q.setMonth(le-1),Q.setDate(se);var Me=z&31;z>>>=5;var Ze=z&63;return z>>>=6,Q.setHours(z),Q.setMinutes(Ze),Q.setSeconds(Me<<1),Q}function T(ee){Pc(ee,0);for(var z={},G=0;ee.l<=ee.length-4;){var Q=ee.read_shift(2),se=ee.read_shift(2),le=ee.l+se,Me={};switch(Q){case 21589:G=ee.read_shift(1),G&1&&(Me.mtime=ee.read_shift(4)),se>5&&(G&2&&(Me.atime=ee.read_shift(4)),G&4&&(Me.ctime=ee.read_shift(4))),Me.mtime&&(Me.mt=new Date(Me.mtime*1e3));break}ee.l=le,z[Q]=Me}return z}var A;function M(){return A||(A={})}function F(ee,z){if(ee[0]==80&&ee[1]==75)return Rn(ee,z);if((ee[0]|32)==109&&(ee[1]|32)==105)return ka(ee,z);if(ee.length<512)throw new Error("CFB file size "+ee.length+" < 512");var G=3,Q=512,se=0,le=0,Me=0,Ze=0,ke=0,We=[],nt=ee.slice(0,512);Pc(nt,0);var dt=W(nt);switch(G=dt[0],G){case 3:Q=512;break;case 4:Q=4096;break;case 0:if(dt[1]==0)return Rn(ee,z);default:throw new Error("Major Version: Expected 3 or 4 saw "+G)}Q!==512&&(nt=ee.slice(0,Q),Pc(nt,28));var Pt=ee.slice(0,Q);V(nt,G);var ti=nt.read_shift(4,"i");if(G===3&&ti!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ti);nt.l+=4,Me=nt.read_shift(4,"i"),nt.l+=4,nt.chk("00100000","Mini Stream Cutoff Size: "),Ze=nt.read_shift(4,"i"),se=nt.read_shift(4,"i"),ke=nt.read_shift(4,"i"),le=nt.read_shift(4,"i");for(var Qt=-1,oi=0;oi<109&&(Qt=nt.read_shift(4,"i"),!(Qt<0));++oi)We[oi]=Qt;var Ei=R(ee,Q);J(ke,le,Ei,Q,We);var Wi=ne(Ei,Me,We,Q);Wi[Me].name="!Directory",se>0&&Ze!==Qe&&(Wi[Ze].name="!MiniFAT"),Wi[We[0]].name="!FAT",Wi.fat_addrs=We,Wi.ssz=Q;var wi={},wr=[],dr=[],yr=[];de(Me,Wi,Ei,wr,se,wi,dr,Ze),te(dr,yr,wr),wr.shift();var xn={FileIndex:dr,FullPaths:yr};return z&&z.raw&&(xn.raw={header:Pt,sectors:Ei}),xn}function W(ee){if(ee[ee.l]==80&&ee[ee.l+1]==75)return[0,0];ee.chk(Ce,"Header Signature: "),ee.l+=16;var z=ee.read_shift(2,"u");return[ee.read_shift(2,"u"),z]}function V(ee,z){var G=9;switch(ee.l+=2,G=ee.read_shift(2)){case 9:if(z!=3)throw new Error("Sector Shift: Expected 9 saw "+G);break;case 12:if(z!=4)throw new Error("Sector Shift: Expected 12 saw "+G);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+G)}ee.chk("0600","Mini Sector Shift: "),ee.chk("000000000000","Reserved: ")}function R(ee,z){for(var G=Math.ceil(ee.length/z)-1,Q=[],se=1;se<G;++se)Q[se-1]=ee.slice(se*z,(se+1)*z);return Q[G-1]=ee.slice(G*z),Q}function te(ee,z,G){for(var Q=0,se=0,le=0,Me=0,Ze=0,ke=G.length,We=[],nt=[];Q<ke;++Q)We[Q]=nt[Q]=Q,z[Q]=G[Q];for(;Ze<nt.length;++Ze)Q=nt[Ze],se=ee[Q].L,le=ee[Q].R,Me=ee[Q].C,We[Q]===Q&&(se!==-1&&We[se]!==se&&(We[Q]=We[se]),le!==-1&&We[le]!==le&&(We[Q]=We[le])),Me!==-1&&(We[Me]=Q),se!==-1&&Q!=We[Q]&&(We[se]=We[Q],nt.lastIndexOf(se)<Ze&&nt.push(se)),le!==-1&&Q!=We[Q]&&(We[le]=We[Q],nt.lastIndexOf(le)<Ze&&nt.push(le));for(Q=1;Q<ke;++Q)We[Q]===Q&&(le!==-1&&We[le]!==le?We[Q]=We[le]:se!==-1&&We[se]!==se&&(We[Q]=We[se]));for(Q=1;Q<ke;++Q)if(ee[Q].type!==0){if(Ze=Q,Ze!=We[Ze])do Ze=We[Ze],z[Q]=z[Ze]+"/"+z[Q];while(Ze!==0&&We[Ze]!==-1&&Ze!=We[Ze]);We[Q]=-1}for(z[0]+="/",Q=1;Q<ke;++Q)ee[Q].type!==2&&(z[Q]+="/")}function H(ee,z,G){for(var Q=ee.start,se=ee.size,le=[],Me=Q;G&&se>0&&Me>=0;)le.push(z.slice(Me*xe,Me*xe+xe)),se-=xe,Me=Up(G,Me*4);return le.length===0?ci(0):Us(le).slice(0,ee.size)}function J(ee,z,G,Q,se){var le=Qe;if(ee===Qe){if(z!==0)throw new Error("DIFAT chain shorter than expected")}else if(ee!==-1){var Me=G[ee],Ze=(Q>>>2)-1;if(!Me)return;for(var ke=0;ke<Ze&&(le=Up(Me,ke*4))!==Qe;++ke)se.push(le);J(Up(Me,Q-4),z-1,G,Q,se)}}function K(ee,z,G,Q,se){var le=[],Me=[];se||(se=[]);var Ze=Q-1,ke=0,We=0;for(ke=z;ke>=0;){se[ke]=!0,le[le.length]=ke,Me.push(ee[ke]);var nt=G[Math.floor(ke*4/Q)];if(We=ke*4&Ze,Q<4+We)throw new Error("FAT boundary crossed: "+ke+" 4 "+Q);if(!ee[nt])break;ke=Up(ee[nt],We)}return{nodes:le,data:f3([Me])}}function ne(ee,z,G,Q){var se=ee.length,le=[],Me=[],Ze=[],ke=[],We=Q-1,nt=0,dt=0,Pt=0,ti=0;for(nt=0;nt<se;++nt)if(Ze=[],Pt=nt+z,Pt>=se&&(Pt-=se),!Me[Pt]){ke=[];var Qt=[];for(dt=Pt;dt>=0;){Qt[dt]=!0,Me[dt]=!0,Ze[Ze.length]=dt,ke.push(ee[dt]);var oi=G[Math.floor(dt*4/Q)];if(ti=dt*4&We,Q<4+ti)throw new Error("FAT boundary crossed: "+dt+" 4 "+Q);if(!ee[oi]||(dt=Up(ee[oi],ti),Qt[dt]))break}le[Pt]={nodes:Ze,data:f3([ke])}}return le}function de(ee,z,G,Q,se,le,Me,Ze){for(var ke=0,We=Q.length?2:0,nt=z[ee].data,dt=0,Pt=0,ti;dt<nt.length;dt+=128){var Qt=nt.slice(dt,dt+128);Pc(Qt,64),Pt=Qt.read_shift(2),ti=kx(Qt,0,Pt-We),Q.push(ti);var oi={name:ti,type:Qt.read_shift(1),color:Qt.read_shift(1),L:Qt.read_shift(4,"i"),R:Qt.read_shift(4,"i"),C:Qt.read_shift(4,"i"),clsid:Qt.read_shift(16),state:Qt.read_shift(4,"i"),start:0,size:0},Ei=Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2);Ei!==0&&(oi.ct=De(Qt,Qt.l-8));var Wi=Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2);Wi!==0&&(oi.mt=De(Qt,Qt.l-8)),oi.start=Qt.read_shift(4,"i"),oi.size=Qt.read_shift(4,"i"),oi.size<0&&oi.start<0&&(oi.size=oi.type=0,oi.start=Qe,oi.name=""),oi.type===5?(ke=oi.start,se>0&&ke!==Qe&&(z[ke].name="!StreamData")):oi.size>=4096?(oi.storage="fat",z[oi.start]===void 0&&(z[oi.start]=K(G,oi.start,z.fat_addrs,z.ssz)),z[oi.start].name=oi.name,oi.content=z[oi.start].data.slice(0,oi.size)):(oi.storage="minifat",oi.size<0?oi.size=0:ke!==Qe&&oi.start!==Qe&&z[ke]&&(oi.content=H(oi,z[ke].data,(z[Ze]||{}).data))),oi.content&&Pc(oi.content,0),le[ti]=oi,Me.push(oi)}}function De(ee,z){return new Date((Ts(ee,z+4)/1e7*Math.pow(2,32)+Ts(ee,z)/1e7-11644473600)*1e3)}function Fe(ee,z){return M(),F(A.readFileSync(ee),z)}function et(ee,z){var G=z&&z.type;switch(G||ta&&Buffer.isBuffer(ee)&&(G="buffer"),G||"base64"){case"file":return Fe(ee,z);case"base64":return F(Qu(jd(ee)),z);case"binary":return F(Qu(ee),z)}return F(ee,z)}function Te(ee,z){var G=z||{},Q=G.root||"Root Entry";if(ee.FullPaths||(ee.FullPaths=[]),ee.FileIndex||(ee.FileIndex=[]),ee.FullPaths.length!==ee.FileIndex.length)throw new Error("inconsistent CFB structure");ee.FullPaths.length===0&&(ee.FullPaths[0]=Q+"/",ee.FileIndex[0]={name:Q,type:5}),G.CLSID&&(ee.FileIndex[0].clsid=G.CLSID),ge(ee)}function ge(ee){var z="Sh33tJ5";if(!Ca.find(ee,"/"+z)){var G=ci(4);G[0]=55,G[1]=G[3]=50,G[2]=54,ee.FileIndex.push({name:z,type:2,content:G,size:4,L:69,R:69,C:69}),ee.FullPaths.push(ee.FullPaths[0]+z),Ve(ee)}}function Ve(ee,z){Te(ee);for(var G=!1,Q=!1,se=ee.FullPaths.length-1;se>=0;--se){var le=ee.FileIndex[se];switch(le.type){case 0:Q?G=!0:(ee.FileIndex.pop(),ee.FullPaths.pop());break;case 1:case 2:case 5:Q=!0,isNaN(le.R*le.L*le.C)&&(G=!0),le.R>-1&&le.L>-1&&le.R==le.L&&(G=!0);break;default:G=!0;break}}if(!(!G&&!z)){var Me=new Date(1987,1,19),Ze=0,ke=Object.create?Object.create(null):{},We=[];for(se=0;se<ee.FullPaths.length;++se)ke[ee.FullPaths[se]]=!0,ee.FileIndex[se].type!==0&&We.push([ee.FullPaths[se],ee.FileIndex[se]]);for(se=0;se<We.length;++se){var nt=c(We[se][0]);Q=ke[nt],Q||(We.push([nt,{name:f(nt).replace("/",""),type:1,clsid:ut,ct:Me,mt:Me,content:null}]),ke[nt]=!0)}for(We.sort(function(ti,Qt){return l(ti[0],Qt[0])}),ee.FullPaths=[],ee.FileIndex=[],se=0;se<We.length;++se)ee.FullPaths[se]=We[se][0],ee.FileIndex[se]=We[se][1];for(se=0;se<We.length;++se){var dt=ee.FileIndex[se],Pt=ee.FullPaths[se];if(dt.name=f(Pt).replace("/",""),dt.L=dt.R=dt.C=-(dt.color=1),dt.size=dt.content?dt.content.length:0,dt.start=0,dt.clsid=dt.clsid||ut,se===0)dt.C=We.length>1?1:-1,dt.size=0,dt.type=5;else if(Pt.slice(-1)=="/"){for(Ze=se+1;Ze<We.length&&c(ee.FullPaths[Ze])!=Pt;++Ze);for(dt.C=Ze>=We.length?-1:Ze,Ze=se+1;Ze<We.length&&c(ee.FullPaths[Ze])!=c(Pt);++Ze);dt.R=Ze>=We.length?-1:Ze,dt.type=1}else c(ee.FullPaths[se+1]||"")==c(Pt)&&(dt.R=se+1),dt.type=2}}}function Ae(ee,z){var G=z||{};if(G.fileType=="mad")return Ki(ee,G);switch(Ve(ee),G.fileType){case"zip":return xo(ee,G)}var Q=function(ti){for(var Qt=0,oi=0,Ei=0;Ei<ti.FileIndex.length;++Ei){var Wi=ti.FileIndex[Ei];if(Wi.content){var wi=Wi.content.length;wi>0&&(wi<4096?Qt+=wi+63>>6:oi+=wi+511>>9)}}for(var wr=ti.FullPaths.length+3>>2,dr=Qt+7>>3,yr=Qt+127>>7,xn=dr+oi+wr+yr,en=xn+127>>7,En=en<=109?0:Math.ceil((en-109)/127);xn+en+En+127>>7>en;)En=++en<=109?0:Math.ceil((en-109)/127);var On=[1,En,en,yr,wr,oi,Qt,0];return ti.FileIndex[0].size=Qt<<6,On[7]=(ti.FileIndex[0].start=On[0]+On[1]+On[2]+On[3]+On[4]+On[5])+(On[6]+7>>3),On}(ee),se=ci(Q[7]<<9),le=0,Me=0;{for(le=0;le<8;++le)se.write_shift(1,Ye[le]);for(le=0;le<8;++le)se.write_shift(2,0);for(se.write_shift(2,62),se.write_shift(2,3),se.write_shift(2,65534),se.write_shift(2,9),se.write_shift(2,6),le=0;le<3;++le)se.write_shift(2,0);for(se.write_shift(4,0),se.write_shift(4,Q[2]),se.write_shift(4,Q[0]+Q[1]+Q[2]+Q[3]-1),se.write_shift(4,0),se.write_shift(4,4096),se.write_shift(4,Q[3]?Q[0]+Q[1]+Q[2]-1:Qe),se.write_shift(4,Q[3]),se.write_shift(-4,Q[1]?Q[0]-1:Qe),se.write_shift(4,Q[1]),le=0;le<109;++le)se.write_shift(-4,le<Q[2]?Q[1]+le:-1)}if(Q[1])for(Me=0;Me<Q[1];++Me){for(;le<236+Me*127;++le)se.write_shift(-4,le<Q[2]?Q[1]+le:-1);se.write_shift(-4,Me===Q[1]-1?Qe:Me+1)}var Ze=function(ti){for(Me+=ti;le<Me-1;++le)se.write_shift(-4,le+1);ti&&(++le,se.write_shift(-4,Qe))};for(Me=le=0,Me+=Q[1];le<Me;++le)se.write_shift(-4,st.DIFSECT);for(Me+=Q[2];le<Me;++le)se.write_shift(-4,st.FATSECT);Ze(Q[3]),Ze(Q[4]);for(var ke=0,We=0,nt=ee.FileIndex[0];ke<ee.FileIndex.length;++ke)nt=ee.FileIndex[ke],nt.content&&(We=nt.content.length,!(We<4096)&&(nt.start=Me,Ze(We+511>>9)));for(Ze(Q[6]+7>>3);se.l&511;)se.write_shift(-4,st.ENDOFCHAIN);for(Me=le=0,ke=0;ke<ee.FileIndex.length;++ke)nt=ee.FileIndex[ke],nt.content&&(We=nt.content.length,!(!We||We>=4096)&&(nt.start=Me,Ze(We+63>>6)));for(;se.l&511;)se.write_shift(-4,st.ENDOFCHAIN);for(le=0;le<Q[4]<<2;++le){var dt=ee.FullPaths[le];if(!dt||dt.length===0){for(ke=0;ke<17;++ke)se.write_shift(4,0);for(ke=0;ke<3;++ke)se.write_shift(4,-1);for(ke=0;ke<12;++ke)se.write_shift(4,0);continue}nt=ee.FileIndex[le],le===0&&(nt.start=nt.size?nt.start-1:Qe);var Pt=le===0&&G.root||nt.name;if(We=2*(Pt.length+1),se.write_shift(64,Pt,"utf16le"),se.write_shift(2,We),se.write_shift(1,nt.type),se.write_shift(1,nt.color),se.write_shift(-4,nt.L),se.write_shift(-4,nt.R),se.write_shift(-4,nt.C),nt.clsid)se.write_shift(16,nt.clsid,"hex");else for(ke=0;ke<4;++ke)se.write_shift(4,0);se.write_shift(4,nt.state||0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,nt.start),se.write_shift(4,nt.size),se.write_shift(4,0)}for(le=1;le<ee.FileIndex.length;++le)if(nt=ee.FileIndex[le],nt.size>=4096)if(se.l=nt.start+1<<9,ta&&Buffer.isBuffer(nt.content))nt.content.copy(se,se.l,0,nt.size),se.l+=nt.size+511&-512;else{for(ke=0;ke<nt.size;++ke)se.write_shift(1,nt.content[ke]);for(;ke&511;++ke)se.write_shift(1,0)}for(le=1;le<ee.FileIndex.length;++le)if(nt=ee.FileIndex[le],nt.size>0&&nt.size<4096)if(ta&&Buffer.isBuffer(nt.content))nt.content.copy(se,se.l,0,nt.size),se.l+=nt.size+63&-64;else{for(ke=0;ke<nt.size;++ke)se.write_shift(1,nt.content[ke]);for(;ke&63;++ke)se.write_shift(1,0)}if(ta)se.l=se.length;else for(;se.l<se.length;)se.write_shift(1,0);return se}function _e(ee,z){var G=ee.FullPaths.map(function(ke){return ke.toUpperCase()}),Q=G.map(function(ke){var We=ke.split("/");return We[We.length-(ke.slice(-1)=="/"?2:1)]}),se=!1;z.charCodeAt(0)===47?(se=!0,z=G[0].slice(0,-1)+z):se=z.indexOf("/")!==-1;var le=z.toUpperCase(),Me=se===!0?G.indexOf(le):Q.indexOf(le);if(Me!==-1)return ee.FileIndex[Me];var Ze=!le.match(rx);for(le=le.replace(d0,""),Ze&&(le=le.replace(rx,"!")),Me=0;Me<G.length;++Me)if((Ze?G[Me].replace(rx,"!"):G[Me]).replace(d0,"")==le||(Ze?Q[Me].replace(rx,"!"):Q[Me]).replace(d0,"")==le)return ee.FileIndex[Me];return null}var xe=64,Qe=-2,Ce="d0cf11e0a1b11ae1",Ye=[208,207,17,224,161,177,26,225],ut="00000000000000000000000000000000",st={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Qe,FREESECT:-1,HEADER_SIGNATURE:Ce,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ut,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function pt(ee,z,G){M();var Q=Ae(ee,G);A.writeFileSync(z,Q)}function Tt(ee){for(var z=new Array(ee.length),G=0;G<ee.length;++G)z[G]=String.fromCharCode(ee[G]);return z.join("")}function ht(ee,z){var G=Ae(ee,z);switch(z&&z.type||"buffer"){case"file":return M(),A.writeFileSync(z.filename,G),G;case"binary":return typeof G=="string"?G:Tt(G);case"base64":return jg(typeof G=="string"?G:Tt(G));case"buffer":if(ta)return Buffer.isBuffer(G)?G:Ud(G);case"array":return typeof G=="string"?Qu(G):G}return G}var Wt;function ie(ee){try{var z=ee.InflateRaw,G=new z;if(G._processChunk(new Uint8Array([3,0]),G._finishFlushFlag),G.bytesRead)Wt=ee;else throw new Error("zlib does not expose bytesRead")}catch(Q){console.error("cannot use native zlib: "+(Q.message||Q))}}function ye(ee,z){if(!Wt)return $r(ee,z);var G=Wt.InflateRaw,Q=new G,se=Q._processChunk(ee.slice(ee.l),Q._finishFlushFlag);return ee.l+=Q.bytesRead,se}function pe(ee){return Wt?Wt.deflateRawSync(ee):Or(ee)}var Ie=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ue=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],gt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function mt(ee){var z=(ee<<1|ee<<11)&139536|(ee<<5|ee<<15)&558144;return(z>>16|z>>8|z)&255}for(var wt=typeof Uint8Array<"u",Lt=wt?new Uint8Array(256):[],fi=0;fi<256;++fi)Lt[fi]=mt(fi);function yi(ee,z){var G=Lt[ee&255];return z<=8?G>>>8-z:(G=G<<8|Lt[ee>>8&255],z<=16?G>>>16-z:(G=G<<8|Lt[ee>>16&255],G>>>24-z))}function Fi(ee,z){var G=z&7,Q=z>>>3;return(ee[Q]|(G<=6?0:ee[Q+1]<<8))>>>G&3}function Pi(ee,z){var G=z&7,Q=z>>>3;return(ee[Q]|(G<=5?0:ee[Q+1]<<8))>>>G&7}function $t(ee,z){var G=z&7,Q=z>>>3;return(ee[Q]|(G<=4?0:ee[Q+1]<<8))>>>G&15}function lt(ee,z){var G=z&7,Q=z>>>3;return(ee[Q]|(G<=3?0:ee[Q+1]<<8))>>>G&31}function Bt(ee,z){var G=z&7,Q=z>>>3;return(ee[Q]|(G<=1?0:ee[Q+1]<<8))>>>G&127}function ni(ee,z,G){var Q=z&7,se=z>>>3,le=(1<<G)-1,Me=ee[se]>>>Q;return G<8-Q||(Me|=ee[se+1]<<8-Q,G<16-Q)||(Me|=ee[se+2]<<16-Q,G<24-Q)||(Me|=ee[se+3]<<24-Q),Me&le}function bi(ee,z,G){var Q=z&7,se=z>>>3;return Q<=5?ee[se]|=(G&7)<<Q:(ee[se]|=G<<Q&255,ee[se+1]=(G&7)>>8-Q),z+3}function ki(ee,z,G){var Q=z&7,se=z>>>3;return G=(G&1)<<Q,ee[se]|=G,z+1}function Ni(ee,z,G){var Q=z&7,se=z>>>3;return G<<=Q,ee[se]|=G&255,G>>>=8,ee[se+1]=G,z+8}function Bi(ee,z,G){var Q=z&7,se=z>>>3;return G<<=Q,ee[se]|=G&255,G>>>=8,ee[se+1]=G&255,ee[se+2]=G>>>8,z+16}function tr(ee,z){var G=ee.length,Q=2*G>z?2*G:z+5,se=0;if(G>=z)return ee;if(ta){var le=JA(Q);if(ee.copy)ee.copy(le);else for(;se<ee.length;++se)le[se]=ee[se];return le}else if(wt){var Me=new Uint8Array(Q);if(Me.set)Me.set(ee);else for(;se<G;++se)Me[se]=ee[se];return Me}return ee.length=Q,ee}function ar(ee){for(var z=new Array(ee),G=0;G<ee;++G)z[G]=0;return z}function vr(ee,z,G){var Q=1,se=0,le=0,Me=0,Ze=0,ke=ee.length,We=wt?new Uint16Array(32):ar(32);for(le=0;le<32;++le)We[le]=0;for(le=ke;le<G;++le)ee[le]=0;ke=ee.length;var nt=wt?new Uint16Array(ke):ar(ke);for(le=0;le<ke;++le)We[se=ee[le]]++,Q<se&&(Q=se),nt[le]=0;for(We[0]=0,le=1;le<=Q;++le)We[le+16]=Ze=Ze+We[le-1]<<1;for(le=0;le<ke;++le)Ze=ee[le],Ze!=0&&(nt[le]=We[Ze+16]++);var dt=0;for(le=0;le<ke;++le)if(dt=ee[le],dt!=0)for(Ze=yi(nt[le],Q)>>Q-dt,Me=(1<<Q+4-dt)-1;Me>=0;--Me)z[Ze|Me<<dt]=dt&15|le<<4;return Q}var kr=wt?new Uint16Array(512):ar(512),qr=wt?new Uint16Array(32):ar(32);if(!wt){for(var Kr=0;Kr<512;++Kr)kr[Kr]=0;for(Kr=0;Kr<32;++Kr)qr[Kr]=0}(function(){for(var ee=[],z=0;z<32;z++)ee.push(5);vr(ee,qr,32);var G=[];for(z=0;z<=143;z++)G.push(8);for(;z<=255;z++)G.push(9);for(;z<=279;z++)G.push(7);for(;z<=287;z++)G.push(8);vr(G,kr,288)})();var xr=function(){for(var z=wt?new Uint8Array(32768):[],G=0,Q=0;G<gt.length-1;++G)for(;Q<gt[G+1];++Q)z[Q]=G;for(;Q<32768;++Q)z[Q]=29;var se=wt?new Uint8Array(259):[];for(G=0,Q=0;G<Ue.length-1;++G)for(;Q<Ue[G+1];++Q)se[Q]=G;function le(Ze,ke){for(var We=0;We<Ze.length;){var nt=Math.min(65535,Ze.length-We),dt=We+nt==Ze.length;for(ke.write_shift(1,+dt),ke.write_shift(2,nt),ke.write_shift(2,~nt&65535);nt-- >0;)ke[ke.l++]=Ze[We++]}return ke.l}function Me(Ze,ke){for(var We=0,nt=0,dt=wt?new Uint16Array(32768):[];nt<Ze.length;){var Pt=Math.min(65535,Ze.length-nt);if(Pt<10){for(We=bi(ke,We,+(nt+Pt==Ze.length)),We&7&&(We+=8-(We&7)),ke.l=We/8|0,ke.write_shift(2,Pt),ke.write_shift(2,~Pt&65535);Pt-- >0;)ke[ke.l++]=Ze[nt++];We=ke.l*8;continue}We=bi(ke,We,+(nt+Pt==Ze.length)+2);for(var ti=0;Pt-- >0;){var Qt=Ze[nt];ti=(ti<<5^Qt)&32767;var oi=-1,Ei=0;if((oi=dt[ti])&&(oi|=nt&-32768,oi>nt&&(oi-=32768),oi<nt))for(;Ze[oi+Ei]==Ze[nt+Ei]&&Ei<250;)++Ei;if(Ei>2){Qt=se[Ei],Qt<=22?We=Ni(ke,We,Lt[Qt+1]>>1)-1:(Ni(ke,We,3),We+=5,Ni(ke,We,Lt[Qt-23]>>5),We+=3);var Wi=Qt<8?0:Qt-4>>2;Wi>0&&(Bi(ke,We,Ei-Ue[Qt]),We+=Wi),Qt=z[nt-oi],We=Ni(ke,We,Lt[Qt]>>3),We-=3;var wi=Qt<4?0:Qt-2>>1;wi>0&&(Bi(ke,We,nt-oi-gt[Qt]),We+=wi);for(var wr=0;wr<Ei;++wr)dt[ti]=nt&32767,ti=(ti<<5^Ze[nt])&32767,++nt;Pt-=Ei-1}else Qt<=143?Qt=Qt+48:We=ki(ke,We,1),We=Ni(ke,We,Lt[Qt]),dt[ti]=nt&32767,++nt}We=Ni(ke,We,0)-1}return ke.l=(We+7)/8|0,ke.l}return function(ke,We){return ke.length<8?le(ke,We):Me(ke,We)}}();function Or(ee){var z=ci(50+Math.floor(ee.length*1.1)),G=xr(ee,z);return z.slice(0,G)}var Ri=wt?new Uint16Array(32768):ar(32768),La=wt?new Uint16Array(32768):ar(32768),Di=wt?new Uint16Array(128):ar(128),go=1,fr=1;function Sn(ee,z){var G=lt(ee,z)+257;z+=5;var Q=lt(ee,z)+1;z+=5;var se=$t(ee,z)+4;z+=4;for(var le=0,Me=wt?new Uint8Array(19):ar(19),Ze=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ke=1,We=wt?new Uint8Array(8):ar(8),nt=wt?new Uint8Array(8):ar(8),dt=Me.length,Pt=0;Pt<se;++Pt)Me[Ie[Pt]]=le=Pi(ee,z),ke<le&&(ke=le),We[le]++,z+=3;var ti=0;for(We[0]=0,Pt=1;Pt<=ke;++Pt)nt[Pt]=ti=ti+We[Pt-1]<<1;for(Pt=0;Pt<dt;++Pt)(ti=Me[Pt])!=0&&(Ze[Pt]=nt[ti]++);var Qt=0;for(Pt=0;Pt<dt;++Pt)if(Qt=Me[Pt],Qt!=0){ti=Lt[Ze[Pt]]>>8-Qt;for(var oi=(1<<7-Qt)-1;oi>=0;--oi)Di[ti|oi<<Qt]=Qt&7|Pt<<3}var Ei=[];for(ke=1;Ei.length<G+Q;)switch(ti=Di[Bt(ee,z)],z+=ti&7,ti>>>=3){case 16:for(le=3+Fi(ee,z),z+=2,ti=Ei[Ei.length-1];le-- >0;)Ei.push(ti);break;case 17:for(le=3+Pi(ee,z),z+=3;le-- >0;)Ei.push(0);break;case 18:for(le=11+Bt(ee,z),z+=7;le-- >0;)Ei.push(0);break;default:Ei.push(ti),ke<ti&&(ke=ti);break}var Wi=Ei.slice(0,G),wi=Ei.slice(G);for(Pt=G;Pt<286;++Pt)Wi[Pt]=0;for(Pt=Q;Pt<30;++Pt)wi[Pt]=0;return go=vr(Wi,Ri,286),fr=vr(wi,La,30),z}function _o(ee,z){if(ee[0]==3&&!(ee[1]&3))return[Wp(z),2];for(var G=0,Q=0,se=JA(z||1<<18),le=0,Me=se.length>>>0,Ze=0,ke=0;!(Q&1);){if(Q=Pi(ee,G),G+=3,Q>>>1)Q>>1==1?(Ze=9,ke=5):(G=Sn(ee,G),Ze=go,ke=fr);else{G&7&&(G+=8-(G&7));var We=ee[G>>>3]|ee[(G>>>3)+1]<<8;if(G+=32,We>0)for(!z&&Me<le+We&&(se=tr(se,le+We),Me=se.length);We-- >0;)se[le++]=ee[G>>>3],G+=8;continue}for(;;){!z&&Me<le+32767&&(se=tr(se,le+32767),Me=se.length);var nt=ni(ee,G,Ze),dt=Q>>>1==1?kr[nt]:Ri[nt];if(G+=dt&15,dt>>>=4,!(dt>>>8&255))se[le++]=dt;else{if(dt==256)break;dt-=257;var Pt=dt<8?0:dt-4>>2;Pt>5&&(Pt=0);var ti=le+Ue[dt];Pt>0&&(ti+=ni(ee,G,Pt),G+=Pt),nt=ni(ee,G,ke),dt=Q>>>1==1?qr[nt]:La[nt],G+=dt&15,dt>>>=4;var Qt=dt<4?0:dt-2>>1,oi=gt[dt];for(Qt>0&&(oi+=ni(ee,G,Qt),G+=Qt),!z&&Me<ti&&(se=tr(se,ti+100),Me=se.length);le<ti;)se[le]=se[le-oi],++le}}}return z?[se,G+7>>>3]:[se.slice(0,le),G+7>>>3]}function $r(ee,z){var G=ee.slice(ee.l||0),Q=_o(G,z);return ee.l+=Q[1],Q[0]}function so(ee,z){if(ee)typeof console<"u"&&console.error(z);else throw new Error(z)}function Rn(ee,z){var G=ee;Pc(G,0);var Q=[],se=[],le={FileIndex:Q,FullPaths:se};Te(le,{root:z.root});for(var Me=G.length-4;(G[Me]!=80||G[Me+1]!=75||G[Me+2]!=5||G[Me+3]!=6)&&Me>=0;)--Me;G.l=Me+4,G.l+=4;var Ze=G.read_shift(2);G.l+=6;var ke=G.read_shift(4);for(G.l=ke,Me=0;Me<Ze;++Me){G.l+=20;var We=G.read_shift(4),nt=G.read_shift(4),dt=G.read_shift(2),Pt=G.read_shift(2),ti=G.read_shift(2);G.l+=8;var Qt=G.read_shift(4),oi=T(G.slice(G.l+dt,G.l+dt+Pt));G.l+=dt+Pt+ti;var Ei=G.l;G.l=Qt+4,Ja(G,We,nt,le,oi),G.l=Ei}return le}function Ja(ee,z,G,Q,se){ee.l+=2;var le=ee.read_shift(2),Me=ee.read_shift(2),Ze=x(ee);if(le&8257)throw new Error("Unsupported ZIP encryption");for(var ke=ee.read_shift(4),We=ee.read_shift(4),nt=ee.read_shift(4),dt=ee.read_shift(2),Pt=ee.read_shift(2),ti="",Qt=0;Qt<dt;++Qt)ti+=String.fromCharCode(ee[ee.l++]);if(Pt){var oi=T(ee.slice(ee.l,ee.l+Pt));(oi[21589]||{}).mt&&(Ze=oi[21589].mt),((se||{})[21589]||{}).mt&&(Ze=se[21589].mt)}ee.l+=Pt;var Ei=ee.slice(ee.l,ee.l+We);switch(Me){case 8:Ei=ye(ee,nt);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Me)}var Wi=!1;le&8&&(ke=ee.read_shift(4),ke==134695760&&(ke=ee.read_shift(4),Wi=!0),We=ee.read_shift(4),nt=ee.read_shift(4)),We!=z&&so(Wi,"Bad compressed size: "+z+" != "+We),nt!=G&&so(Wi,"Bad uncompressed size: "+G+" != "+nt),Qa(Q,ti,Ei,{unsafe:!0,mt:Ze})}function xo(ee,z){var G=z||{},Q=[],se=[],le=ci(1),Me=G.compression?8:0,Ze=0,ke=!1;ke&&(Ze|=8);var We=0,nt=0,dt=0,Pt=0,ti=ee.FullPaths[0],Qt=ti,oi=ee.FileIndex[0],Ei=[],Wi=0;for(We=1;We<ee.FullPaths.length;++We)if(Qt=ee.FullPaths[We].slice(ti.length),oi=ee.FileIndex[We],!(!oi.size||!oi.content||Qt=="Sh33tJ5")){var wi=dt,wr=ci(Qt.length);for(nt=0;nt<Qt.length;++nt)wr.write_shift(1,Qt.charCodeAt(nt)&127);wr=wr.slice(0,wr.l),Ei[Pt]=GL.buf(oi.content,0);var dr=oi.content;Me==8&&(dr=pe(dr)),le=ci(30),le.write_shift(4,67324752),le.write_shift(2,20),le.write_shift(2,Ze),le.write_shift(2,Me),oi.mt?i(le,oi.mt):le.write_shift(4,0),le.write_shift(-4,Ze&8?0:Ei[Pt]),le.write_shift(4,Ze&8?0:dr.length),le.write_shift(4,Ze&8?0:oi.content.length),le.write_shift(2,wr.length),le.write_shift(2,0),dt+=le.length,Q.push(le),dt+=wr.length,Q.push(wr),dt+=dr.length,Q.push(dr),Ze&8&&(le=ci(12),le.write_shift(-4,Ei[Pt]),le.write_shift(4,dr.length),le.write_shift(4,oi.content.length),dt+=le.l,Q.push(le)),le=ci(46),le.write_shift(4,33639248),le.write_shift(2,0),le.write_shift(2,20),le.write_shift(2,Ze),le.write_shift(2,Me),le.write_shift(4,0),le.write_shift(-4,Ei[Pt]),le.write_shift(4,dr.length),le.write_shift(4,oi.content.length),le.write_shift(2,wr.length),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(4,0),le.write_shift(4,wi),Wi+=le.l,se.push(le),Wi+=wr.length,se.push(wr),++Pt}return le=ci(22),le.write_shift(4,101010256),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(2,Pt),le.write_shift(2,Pt),le.write_shift(4,Wi),le.write_shift(4,dt),le.write_shift(2,0),Us([Us(Q),Us(se),le])}var vn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ar(ee,z){if(ee.ctype)return ee.ctype;var G=ee.name||"",Q=G.match(/\.([^\.]+)$/);return Q&&vn[Q[1]]||z&&(Q=(G=z).match(/[\.\\]([^\.\\])+$/),Q&&vn[Q[1]])?vn[Q[1]]:"application/octet-stream"}function dn(ee){for(var z=jg(ee),G=[],Q=0;Q<z.length;Q+=76)G.push(z.slice(Q,Q+76));return G.join(`\r
`)+`\r
`}function as(ee){var z=ee.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(We){var nt=We.charCodeAt(0).toString(16).toUpperCase();return"="+(nt.length==1?"0"+nt:nt)});z=z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),z.charAt(0)==`
`&&(z="=0D"+z.slice(1)),z=z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var G=[],Q=z.split(`\r
`),se=0;se<Q.length;++se){var le=Q[se];if(le.length==0){G.push("");continue}for(var Me=0;Me<le.length;){var Ze=76,ke=le.slice(Me,Me+Ze);ke.charAt(Ze-1)=="="?Ze--:ke.charAt(Ze-2)=="="?Ze-=2:ke.charAt(Ze-3)=="="&&(Ze-=3),ke=le.slice(Me,Me+Ze),Me+=Ze,Me<le.length&&(ke+="="),G.push(ke)}}return G.join(`\r
`)}function kn(ee){for(var z=[],G=0;G<ee.length;++G){for(var Q=ee[G];G<=ee.length&&Q.charAt(Q.length-1)=="=";)Q=Q.slice(0,Q.length-1)+ee[++G];z.push(Q)}for(var se=0;se<z.length;++se)z[se]=z[se].replace(/[=][0-9A-Fa-f]{2}/g,function(le){return String.fromCharCode(parseInt(le.slice(1),16))});return Qu(z.join(`\r
`))}function lo(ee,z,G){for(var Q="",se="",le="",Me,Ze=0;Ze<10;++Ze){var ke=z[Ze];if(!ke||ke.match(/^\s*$/))break;var We=ke.match(/^(.*?):\s*([^\s].*)$/);if(We)switch(We[1].toLowerCase()){case"content-location":Q=We[2].trim();break;case"content-type":le=We[2].trim();break;case"content-transfer-encoding":se=We[2].trim();break}}switch(++Ze,se.toLowerCase()){case"base64":Me=Qu(jd(z.slice(Ze).join("")));break;case"quoted-printable":Me=kn(z.slice(Ze));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+se)}var nt=Qa(ee,Q.slice(G.length),Me,{unsafe:!0});le&&(nt.ctype=le)}function ka(ee,z){if(Tt(ee.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var G=z&&z.root||"",Q=(ta&&Buffer.isBuffer(ee)?ee.toString("binary"):Tt(ee)).split(`\r
`),se=0,le="";for(se=0;se<Q.length;++se)if(le=Q[se],!!/^Content-Location:/i.test(le)&&(le=le.slice(le.indexOf("file")),G||(G=le.slice(0,le.lastIndexOf("/")+1)),le.slice(0,G.length)!=G))for(;G.length>0&&(G=G.slice(0,G.length-1),G=G.slice(0,G.lastIndexOf("/")+1),le.slice(0,G.length)!=G););var Me=(Q[1]||"").match(/boundary="(.*?)"/);if(!Me)throw new Error("MAD cannot find boundary");var Ze="--"+(Me[1]||""),ke=[],We=[],nt={FileIndex:ke,FullPaths:We};Te(nt);var dt,Pt=0;for(se=0;se<Q.length;++se){var ti=Q[se];ti!==Ze&&ti!==Ze+"--"||(Pt++&&lo(nt,Q.slice(dt,se),G),dt=se)}return nt}function Ki(ee,z){var G=z||{},Q=G.boundary||"SheetJS";Q="------="+Q;for(var se=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Q.slice(2)+'"',"","",""],le=ee.FullPaths[0],Me=le,Ze=ee.FileIndex[0],ke=1;ke<ee.FullPaths.length;++ke)if(Me=ee.FullPaths[ke].slice(le.length),Ze=ee.FileIndex[ke],!(!Ze.size||!Ze.content||Me=="Sh33tJ5")){Me=Me.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ei){return"_x"+Ei.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ei){return"_u"+Ei.charCodeAt(0).toString(16)+"_"});for(var We=Ze.content,nt=ta&&Buffer.isBuffer(We)?We.toString("binary"):Tt(We),dt=0,Pt=Math.min(1024,nt.length),ti=0,Qt=0;Qt<=Pt;++Qt)(ti=nt.charCodeAt(Qt))>=32&&ti<128&&++dt;var oi=dt>=Pt*4/5;se.push(Q),se.push("Content-Location: "+(G.root||"file:///C:/SheetJS/")+Me),se.push("Content-Transfer-Encoding: "+(oi?"quoted-printable":"base64")),se.push("Content-Type: "+Ar(Ze,Me)),se.push(""),se.push(oi?as(nt):dn(nt))}return se.push(Q+`--\r
`),se.join(`\r
`)}function Ro(ee){var z={};return Te(z,ee),z}function Qa(ee,z,G,Q){var se=Q&&Q.unsafe;se||Te(ee);var le=!se&&Ca.find(ee,z);if(!le){var Me=ee.FullPaths[0];z.slice(0,Me.length)==Me?Me=z:(Me.slice(-1)!="/"&&(Me+="/"),Me=(Me+z).replace("//","/")),le={name:f(z),type:2},ee.FileIndex.push(le),ee.FullPaths.push(Me),se||Ca.utils.cfb_gc(ee)}return le.content=G,le.size=G?G.length:0,Q&&(Q.CLSID&&(le.clsid=Q.CLSID),Q.mt&&(le.mt=Q.mt),Q.ct&&(le.ct=Q.ct)),le}function Va(ee,z){Te(ee);var G=Ca.find(ee,z);if(G){for(var Q=0;Q<ee.FileIndex.length;++Q)if(ee.FileIndex[Q]==G)return ee.FileIndex.splice(Q,1),ee.FullPaths.splice(Q,1),!0}return!1}function ca(ee,z,G){Te(ee);var Q=Ca.find(ee,z);if(Q){for(var se=0;se<ee.FileIndex.length;++se)if(ee.FileIndex[se]==Q)return ee.FileIndex[se].name=f(G),ee.FullPaths[se]=G,!0}return!1}function $n(ee){Ve(ee,!0)}return n.find=_e,n.read=et,n.parse=F,n.write=ht,n.writeFile=pt,n.utils={cfb_new:Ro,cfb_add:Qa,cfb_del:Va,cfb_mov:ca,cfb_gc:$n,ReadShift:Lg,CheckField:cC,prep_blob:Pc,bconcat:Us,use_zlib:ie,_deflateRaw:Or,_inflateRaw:$r,consts:st},n}(),ax;function WL(a){return typeof a=="string"?Sx(a):Array.isArray(a)?_L(a):a}function qg(a,n,l){if(typeof ax<"u"&&ax.writeFileSync)return l?ax.writeFileSync(a,n,l):ax.writeFileSync(a,n);if(typeof Deno<"u"){if(l&&typeof n=="string")switch(l){case"utf8":n=new TextEncoder(l).encode(n);break;case"binary":n=Sx(n);break;default:throw new Error("Unsupported encoding "+l)}return Deno.writeFileSync(a,n)}var c=l=="utf8"?Od(n):n;if(typeof IE_SaveFile<"u")return IE_SaveFile(c,a);if(typeof Blob<"u"){var f=new Blob([WL(c)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(f,a);if(typeof saveAs<"u")return saveAs(f,a);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(f);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:a,saveAs:!0});var x=document.createElement("a");if(x.download!=null)return x.download=a,x.href=i,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var T=File(a);return T.open("w"),T.encoding="binary",Array.isArray(n)&&(n=Wg(n)),T.write(n),T.close(),n}catch(A){if(!A.message||!A.message.match(/onstruct/))throw A}throw new Error("cannot save file "+a)}function Ws(a){for(var n=Object.keys(a),l=[],c=0;c<n.length;++c)Object.prototype.hasOwnProperty.call(a,n[c])&&l.push(n[c]);return l}function o3(a,n){for(var l=[],c=Ws(a),f=0;f!==c.length;++f)l[a[c[f]][n]]==null&&(l[a[c[f]][n]]=c[f]);return l}function Yb(a){for(var n=[],l=Ws(a),c=0;c!==l.length;++c)n[a[l[c]]]=l[c];return n}function Cx(a){for(var n=[],l=Ws(a),c=0;c!==l.length;++c)n[a[l[c]]]=parseInt(l[c],10);return n}function qL(a){for(var n=[],l=Ws(a),c=0;c!==l.length;++c)n[a[l[c]]]==null&&(n[a[l[c]]]=[]),n[a[l[c]]].push(l[c]);return n}var px=new Date(1899,11,30,0,0,0);function tc(a,n){var l=a.getTime();n&&(l-=1462*24*60*60*1e3);var c=px.getTime()+(a.getTimezoneOffset()-px.getTimezoneOffset())*6e4;return(l-c)/(24*60*60*1e3)}var K3=new Date,$L=px.getTime()+(K3.getTimezoneOffset()-px.getTimezoneOffset())*6e4,s3=K3.getTimezoneOffset();function J3(a){var n=new Date;return n.setTime(a*24*60*60*1e3+$L),n.getTimezoneOffset()!==s3&&n.setTime(n.getTime()+(n.getTimezoneOffset()-s3)*6e4),n}var l3=new Date("2017-02-19T19:06:09.000Z"),Q3=isNaN(l3.getFullYear())?new Date("2/19/17"):l3,XL=Q3.getFullYear()==2017;function kl(a,n){var l=new Date(a);if(XL)return n>0?l.setTime(l.getTime()+l.getTimezoneOffset()*60*1e3):n<0&&l.setTime(l.getTime()-l.getTimezoneOffset()*60*1e3),l;if(a instanceof Date)return a;if(Q3.getFullYear()==1917&&!isNaN(l.getFullYear())){var c=l.getFullYear();return a.indexOf(""+c)>-1||l.setFullYear(l.getFullYear()+100),l}var f=a.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+f[0],+f[1]-1,+f[2],+f[3]||0,+f[4]||0,+f[5]||0);return a.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Ix(a,n){if(ta&&Buffer.isBuffer(a)){if(n){if(a[0]==255&&a[1]==254)return Od(a.slice(2).toString("utf16le"));if(a[1]==254&&a[2]==255)return Od(gL(a.slice(2).toString("binary")))}return a.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(a[0]==255&&a[1]==254)return Od(new TextDecoder("utf-16le").decode(a.slice(2)));if(a[0]==254&&a[1]==255)return Od(new TextDecoder("utf-16be").decode(a.slice(2)))}var l={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(a)&&(a=new Uint8Array(a)),new TextDecoder("latin1").decode(a).replace(/[]/g,function(i){return l[i]||i})}catch{}for(var c=[],f=0;f!=a.length;++f)c.push(String.fromCharCode(a[f]));return c.join("")}function ic(a){if(typeof JSON<"u"&&!Array.isArray(a))return JSON.parse(JSON.stringify(a));if(typeof a!="object"||a==null)return a;if(a instanceof Date)return new Date(a.getTime());var n={};for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(n[l]=ic(a[l]));return n}function To(a,n){for(var l="";l.length<n;)l+=a;return l}function Bd(a){var n=Number(a);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(a))return n;var l=1,c=a.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return l*=100,""});return!isNaN(n=Number(c))||(c=c.replace(/[(](.*)[)]/,function(f,i){return l=-l,i}),!isNaN(n=Number(c)))?n/l:n}var ZL=["january","february","march","april","may","june","july","august","september","october","november","december"];function Vg(a){var n=new Date(a),l=new Date(NaN),c=n.getYear(),f=n.getMonth(),i=n.getDate();if(isNaN(i))return l;var x=a.toLowerCase();if(x.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(x=x.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),x.length>3&&ZL.indexOf(x)==-1)return l}else if(x.match(/[a-z]/))return l;return c<0||c>8099?l:(f>0||i>1)&&c!=101?n:a.match(/[^-0-9:,\/\\]/)?l:n}function hn(a,n,l){if(a.FullPaths){if(typeof l=="string"){var c;return ta?c=Ud(l):c=xL(l),Ca.utils.cfb_add(a,n,c)}Ca.utils.cfb_add(a,n,l)}else a.file(n,l)}function Kb(){return Ca.utils.cfb_new()}var Xo=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`;var YL={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Jb=Yb(YL);var Qb=/[&<>'"]/g,KL=/[\u0000-\u0008\u000b-\u001f]/g;function _a(a){var n=a+"";return n.replace(Qb,function(l){return Jb[l]}).replace(KL,function(l){return"_x"+("000"+l.charCodeAt(0).toString(16)).slice(-4)+"_"})}function c3(a){return _a(a).replace(/ /g,"_x0020_")}var eC=/[\u0000-\u001f]/g;function JL(a){var n=a+"";return n.replace(Qb,function(l){return Jb[l]}).replace(/\n/g,"<br/>").replace(eC,function(l){return"&#x"+("000"+l.charCodeAt(0).toString(16)).slice(-4)+";"})}function QL(a){var n=a+"";return n.replace(Qb,function(l){return Jb[l]}).replace(eC,function(l){return"&#x"+l.charCodeAt(0).toString(16).toUpperCase()+";"})}function eR(a){return a.replace(/(\r\n|[\r\n])/g,"&#10;")}function tR(a){switch(a){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Nb(a){for(var n="",l=0,c=0,f=0,i=0,x=0,T=0;l<a.length;){if(c=a.charCodeAt(l++),c<128){n+=String.fromCharCode(c);continue}if(f=a.charCodeAt(l++),c>191&&c<224){x=(c&31)<<6,x|=f&63,n+=String.fromCharCode(x);continue}if(i=a.charCodeAt(l++),c<240){n+=String.fromCharCode((c&15)<<12|(f&63)<<6|i&63);continue}x=a.charCodeAt(l++),T=((c&7)<<18|(f&63)<<12|(i&63)<<6|x&63)-65536,n+=String.fromCharCode(55296+(T>>>10&1023)),n+=String.fromCharCode(56320+(T&1023))}return n}function u3(a){var n=Wp(2*a.length),l,c,f=1,i=0,x=0,T;for(c=0;c<a.length;c+=f)f=1,(T=a.charCodeAt(c))<128?l=T:T<224?(l=(T&31)*64+(a.charCodeAt(c+1)&63),f=2):T<240?(l=(T&15)*4096+(a.charCodeAt(c+1)&63)*64+(a.charCodeAt(c+2)&63),f=3):(f=4,l=(T&7)*262144+(a.charCodeAt(c+1)&63)*4096+(a.charCodeAt(c+2)&63)*64+(a.charCodeAt(c+3)&63),l-=65536,x=55296+(l>>>10&1023),l=56320+(l&1023)),x!==0&&(n[i++]=x&255,n[i++]=x>>>8,x=0),n[i++]=l%256,n[i++]=l>>>8;return n.slice(0,i).toString("ucs2")}function h3(a){return Ud(a,"binary").toString("utf8")}var ox="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",Pg=ta&&(h3(ox)==Nb(ox)&&h3||u3(ox)==Nb(ox)&&u3)||Nb,Od=ta?function(a){return Ud(a,"utf8").toString("binary")}:function(a){for(var n=[],l=0,c=0,f=0;l<a.length;)switch(c=a.charCodeAt(l++),!0){case c<128:n.push(String.fromCharCode(c));break;case c<2048:n.push(String.fromCharCode(192+(c>>6))),n.push(String.fromCharCode(128+(c&63)));break;case(c>=55296&&c<57344):c-=55296,f=a.charCodeAt(l++)-56320+(c<<10),n.push(String.fromCharCode(240+(f>>18&7))),n.push(String.fromCharCode(144+(f>>12&63))),n.push(String.fromCharCode(128+(f>>6&63))),n.push(String.fromCharCode(128+(f&63)));break;default:n.push(String.fromCharCode(224+(c>>12))),n.push(String.fromCharCode(128+(c>>6&63))),n.push(String.fromCharCode(128+(c&63)))}return n.join("")};var iR=function(){var a=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(l){for(var c=l.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),f=0;f<a.length;++f)c=c.replace(a[f][0],a[f][1]);return c}}();var tC=/(^\s|\s$|\n)/;function Hs(a,n){return"<"+a+(n.match(tC)?' xml:space="preserve"':"")+">"+n+"</"+a+">"}function Ug(a){return Ws(a).map(function(n){return" "+n+'="'+a[n]+'"'}).join("")}function Vi(a,n,l){return"<"+a+(l!=null?Ug(l):"")+(n!=null?(n.match(tC)?' xml:space="preserve"':"")+">"+n+"</"+a:"/")+">"}function Wb(a,n){try{return a.toISOString().replace(/\.\d*/,"")}catch(l){if(n)throw l}return""}function rR(a,n){switch(typeof a){case"string":var l=Vi("vt:lpwstr",_a(a));return n&&(l=l.replace(/&quot;/g,"_x0022_")),l;case"number":return Vi((a|0)==a?"vt:i4":"vt:r8",_a(String(a)));case"boolean":return Vi("vt:bool",a?"true":"false")}if(a instanceof Date)return Vi("vt:filetime",Wb(a));throw new Error("Unable to serialize "+a)}var Ss={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},v0=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Lc={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function nR(a,n){for(var l=1-2*(a[n+7]>>>7),c=((a[n+7]&127)<<4)+(a[n+6]>>>4&15),f=a[n+6]&15,i=5;i>=0;--i)f=f*256+a[n+i];return c==2047?f==0?l*(1/0):NaN:(c==0?c=-1022:(c-=1023,f+=Math.pow(2,52)),l*Math.pow(2,c-52)*f)}function aR(a,n,l){var c=(n<0||1/n==-1/0?1:0)<<7,f=0,i=0,x=c?-n:n;isFinite(x)?x==0?f=i=0:(f=Math.floor(Math.log(x)/Math.LN2),i=x*Math.pow(2,52-f),f<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?f=-1022:(i-=Math.pow(2,52),f+=1023)):(f=2047,i=isNaN(n)?26985:0);for(var T=0;T<=5;++T,i/=256)a[l+T]=i&255;a[l+6]=(f&15)<<4|i&15,a[l+7]=f>>4|c}var d3=function(a){for(var n=[],l=10240,c=0;c<a[0].length;++c)if(a[0][c])for(var f=0,i=a[0][c].length;f<i;f+=l)n.push.apply(n,a[0][c].slice(f,f+l));return n},f3=ta?function(a){return a[0].length>0&&Buffer.isBuffer(a[0][0])?Buffer.concat(a[0].map(function(n){return Buffer.isBuffer(n)?n:Ud(n)})):d3(a)}:d3,p3=function(a,n,l){for(var c=[],f=n;f<l;f+=2)c.push(String.fromCharCode(Fg(a,f)));return c.join("").replace(d0,"")},kx=ta?function(a,n,l){return Buffer.isBuffer(a)?a.toString("utf16le",n,l).replace(d0,""):p3(a,n,l)}:p3,m3=function(a,n,l){for(var c=[],f=n;f<n+l;++f)c.push(("0"+a[f].toString(16)).slice(-2));return c.join("")},iC=ta?function(a,n,l){return Buffer.isBuffer(a)?a.toString("hex",n,n+l):m3(a,n,l)}:m3,g3=function(a,n,l){for(var c=[],f=n;f<l;f++)c.push(String.fromCharCode(u0(a,f)));return c.join("")},y0=ta?function(n,l,c){return Buffer.isBuffer(n)?n.toString("utf8",l,c):g3(n,l,c)}:g3,rC=function(a,n){var l=Ts(a,n);return l>0?y0(a,n+4,n+4+l-1):""},e2=rC,nC=function(a,n){var l=Ts(a,n);return l>0?y0(a,n+4,n+4+l-1):""},t2=nC,aC=function(a,n){var l=2*Ts(a,n);return l>0?y0(a,n+4,n+4+l-1):""},i2=aC,oC=function(n,l){var c=Ts(n,l);return c>0?kx(n,l+4,l+4+c):""},r2=oC,sC=function(a,n){var l=Ts(a,n);return l>0?y0(a,n+4,n+4+l):""},n2=sC,lC=function(a,n){return nR(a,n)},mx=lC,a2=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};ta&&(e2=function(n,l){if(!Buffer.isBuffer(n))return rC(n,l);var c=n.readUInt32LE(l);return c>0?n.toString("utf8",l+4,l+4+c-1):""},t2=function(n,l){if(!Buffer.isBuffer(n))return nC(n,l);var c=n.readUInt32LE(l);return c>0?n.toString("utf8",l+4,l+4+c-1):""},i2=function(n,l){if(!Buffer.isBuffer(n))return aC(n,l);var c=2*n.readUInt32LE(l);return n.toString("utf16le",l+4,l+4+c-1)},r2=function(n,l){if(!Buffer.isBuffer(n))return oC(n,l);var c=n.readUInt32LE(l);return n.toString("utf16le",l+4,l+4+c)},n2=function(n,l){if(!Buffer.isBuffer(n))return sC(n,l);var c=n.readUInt32LE(l);return n.toString("utf8",l+4,l+4+c)},mx=function(n,l){return Buffer.isBuffer(n)?n.readDoubleLE(l):lC(n,l)},a2=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});function oR(){kx=function(a,n,l){return Fa.utils.decode(1200,a.slice(n,l)).replace(d0,"")},y0=function(a,n,l){return Fa.utils.decode(65001,a.slice(n,l))},e2=function(a,n){var l=Ts(a,n);return l>0?Fa.utils.decode(_0,a.slice(n+4,n+4+l-1)):""},t2=function(a,n){var l=Ts(a,n);return l>0?Fa.utils.decode(Hp,a.slice(n+4,n+4+l-1)):""},i2=function(a,n){var l=2*Ts(a,n);return l>0?Fa.utils.decode(1200,a.slice(n+4,n+4+l-1)):""},r2=function(a,n){var l=Ts(a,n);return l>0?Fa.utils.decode(1200,a.slice(n+4,n+4+l)):""},n2=function(a,n){var l=Ts(a,n);return l>0?Fa.utils.decode(65001,a.slice(n+4,n+4+l)):""}}typeof Fa<"u"&&oR();var u0=function(a,n){return a[n]},Fg=function(a,n){return a[n+1]*256+a[n]},sR=function(a,n){var l=a[n+1]*256+a[n];return l<32768?l:(65535-l+1)*-1},Ts=function(a,n){return a[n+3]*(1<<24)+(a[n+2]<<16)+(a[n+1]<<8)+a[n]},Up=function(a,n){return a[n+3]<<24|a[n+2]<<16|a[n+1]<<8|a[n]},lR=function(a,n){return a[n]<<24|a[n+1]<<16|a[n+2]<<8|a[n+3]};function Lg(a,n){var l="",c,f,i=[],x,T,A,M;switch(n){case"dbcs":if(M=this.l,ta&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*a).toString("utf16le");else for(A=0;A<a;++A)l+=String.fromCharCode(Fg(this,M)),M+=2;a*=2;break;case"utf8":l=y0(this,this.l,this.l+a);break;case"utf16le":a*=2,l=kx(this,this.l,this.l+a);break;case"wstr":if(typeof Fa<"u")l=Fa.utils.decode(Hp,this.slice(this.l,this.l+2*a));else return Lg.call(this,a,"dbcs");a=2*a;break;case"lpstr-ansi":l=e2(this,this.l),a=4+Ts(this,this.l);break;case"lpstr-cp":l=t2(this,this.l),a=4+Ts(this,this.l);break;case"lpwstr":l=i2(this,this.l),a=4+2*Ts(this,this.l);break;case"lpp4":a=4+Ts(this,this.l),l=r2(this,this.l),a&2&&(a+=2);break;case"8lpp4":a=4+Ts(this,this.l),l=n2(this,this.l),a&3&&(a+=4-(a&3));break;case"cstr":for(a=0,l="";(x=u0(this,this.l+a++))!==0;)i.push(ix(x));l=i.join("");break;case"_wstr":for(a=0,l="";(x=Fg(this,this.l+a))!==0;)i.push(ix(x)),a+=2;a+=2,l=i.join("");break;case"dbcs-cont":for(l="",M=this.l,A=0;A<a;++A){if(this.lens&&this.lens.indexOf(M)!==-1)return x=u0(this,M),this.l=M+1,T=Lg.call(this,a-A,x?"dbcs-cont":"sbcs-cont"),i.join("")+T;i.push(ix(Fg(this,M))),M+=2}l=i.join(""),a*=2;break;case"cpstr":if(typeof Fa<"u"){l=Fa.utils.decode(Hp,this.slice(this.l,this.l+a));break}case"sbcs-cont":for(l="",M=this.l,A=0;A!=a;++A){if(this.lens&&this.lens.indexOf(M)!==-1)return x=u0(this,M),this.l=M+1,T=Lg.call(this,a-A,x?"dbcs-cont":"sbcs-cont"),i.join("")+T;i.push(ix(u0(this,M))),M+=1}l=i.join("");break;default:switch(a){case 1:return c=u0(this,this.l),this.l++,c;case 2:return c=(n==="i"?sR:Fg)(this,this.l),this.l+=2,c;case 4:case-4:return n==="i"||!(this[this.l+3]&128)?(c=(a>0?Up:lR)(this,this.l),this.l+=4,c):(f=Ts(this,this.l),this.l+=4,f);case 8:case-8:if(n==="f")return a==8?f=mx(this,this.l):f=mx([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,f;a=8;case 16:l=iC(this,this.l,a);break}}return this.l+=a,l}var cR=function(a,n,l){a[l]=n&255,a[l+1]=n>>>8&255,a[l+2]=n>>>16&255,a[l+3]=n>>>24&255},uR=function(a,n,l){a[l]=n&255,a[l+1]=n>>8&255,a[l+2]=n>>16&255,a[l+3]=n>>24&255},hR=function(a,n,l){a[l]=n&255,a[l+1]=n>>>8&255};function dR(a,n,l){var c=0,f=0;if(l==="dbcs"){for(f=0;f!=n.length;++f)hR(this,n.charCodeAt(f),this.l+2*f);c=2*n.length}else if(l==="sbcs"){if(typeof Fa<"u"&&_0==874)for(f=0;f!=n.length;++f){var i=Fa.utils.encode(_0,n.charAt(f));this[this.l+f]=i[0]}else for(n=n.replace(/[^\x00-\x7F]/g,"_"),f=0;f!=n.length;++f)this[this.l+f]=n.charCodeAt(f)&255;c=n.length}else if(l==="hex"){for(;f<a;++f)this[this.l++]=parseInt(n.slice(2*f,2*f+2),16)||0;return this}else if(l==="utf16le"){var x=Math.min(this.l+a,this.length);for(f=0;f<Math.min(n.length,a);++f){var T=n.charCodeAt(f);this[this.l++]=T&255,this[this.l++]=T>>8}for(;this.l<x;)this[this.l++]=0;return this}else switch(a){case 1:c=1,this[this.l]=n&255;break;case 2:c=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:c=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:c=4,cR(this,n,this.l);break;case 8:if(c=8,l==="f"){aR(this,n,this.l);break}case 16:break;case-4:c=4,uR(this,n,this.l);break}return this.l+=c,this}function cC(a,n){var l=iC(this,this.l,a.length>>1);if(l!==a)throw new Error(n+"Expected "+a+" saw "+l);this.l+=a.length>>1}function Pc(a,n){a.l=n,a.read_shift=Lg,a.chk=cC,a.write_shift=dR}function Gh(a,n){a.l+=n}function ci(a){var n=Wp(a);return Pc(n,0),n}function ec(){var a=[],n=ta?256:2048,l=function(M){var F=ci(M);return Pc(F,0),F},c=l(n),f=function(){c&&(c.length>c.l&&(c=c.slice(0,c.l),c.l=c.length),c.length>0&&a.push(c),c=null)},i=function(M){return c&&M<c.length-c.l?c:(f(),c=l(Math.max(M+1,n)))},x=function(){return f(),Us(a)},T=function(M){f(),c=M,c.l==null&&(c.l=c.length),i(n)};return{next:i,push:T,end:x,_bufs:a}}function Ii(a,n,l,c){var f=+n,i;if(!isNaN(f)){c||(c=az[f].p||(l||[]).length||0),i=1+(f>=128?1:0)+1,c>=128&&++i,c>=16384&&++i,c>=2097152&&++i;var x=a.next(i);f<=127?x.write_shift(1,f):(x.write_shift(1,(f&127)+128),x.write_shift(1,f>>7));for(var T=0;T!=4;++T)if(c>=128)x.write_shift(1,(c&127)+128),c>>=7;else{x.write_shift(1,c);break}c>0&&a2(l)&&a.push(l)}}function Rg(a,n,l){var c=ic(a);if(n.s?(c.cRel&&(c.c+=n.s.c),c.rRel&&(c.r+=n.s.r)):(c.cRel&&(c.c+=n.c),c.rRel&&(c.r+=n.r)),!l||l.biff<12){for(;c.c>=256;)c.c-=256;for(;c.r>=65536;)c.r-=65536}return c}function _3(a,n,l){var c=ic(a);return c.s=Rg(c.s,n.s,l),c.e=Rg(c.e,n.s,l),c}function Og(a,n){if(a.cRel&&a.c<0)for(a=ic(a);a.c<0;)a.c+=n>8?16384:256;if(a.rRel&&a.r<0)for(a=ic(a);a.r<0;)a.r+=n>8?1048576:n>5?65536:16384;var l=xa(a);return!a.cRel&&a.cRel!=null&&(l=mR(l)),!a.rRel&&a.rRel!=null&&(l=fR(l)),l}function Bb(a,n){return a.s.r==0&&!a.s.rRel&&a.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!a.e.rRel?(a.s.cRel?"":"$")+ol(a.s.c)+":"+(a.e.cRel?"":"$")+ol(a.e.c):a.s.c==0&&!a.s.cRel&&a.e.c==(n.biff>=12?16383:255)&&!a.e.cRel?(a.s.rRel?"":"$")+Gs(a.s.r)+":"+(a.e.rRel?"":"$")+Gs(a.e.r):Og(a.s,n.biff)+":"+Og(a.e,n.biff)}function o2(a){return parseInt(pR(a),10)-1}function Gs(a){return""+(a+1)}function fR(a){return a.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function pR(a){return a.replace(/\$(\d+)$/,"$1")}function s2(a){for(var n=gR(a),l=0,c=0;c!==n.length;++c)l=26*l+n.charCodeAt(c)-64;return l-1}function ol(a){if(a<0)throw new Error("invalid column "+a);var n="";for(++a;a;a=Math.floor((a-1)/26))n=String.fromCharCode((a-1)%26+65)+n;return n}function mR(a){return a.replace(/^([A-Z])/,"$$$1")}function gR(a){return a.replace(/^\$([A-Z])/,"$1")}function _R(a){return a.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Es(a){for(var n=0,l=0,c=0;c<a.length;++c){var f=a.charCodeAt(c);f>=48&&f<=57?n=10*n+(f-48):f>=65&&f<=90&&(l=26*l+(f-64))}return{c:l-1,r:n-1}}function xa(a){for(var n=a.c+1,l="";n;n=(n-1)/26|0)l=String.fromCharCode((n-1)%26+65)+l;return l+(a.r+1)}function Rc(a){var n=a.indexOf(":");return n==-1?{s:Es(a),e:Es(a)}:{s:Es(a.slice(0,n)),e:Es(a.slice(n+1))}}function $o(a,n){return typeof n>"u"||typeof n=="number"?$o(a.s,a.e):(typeof a!="string"&&(a=xa(a)),typeof n!="string"&&(n=xa(n)),a==n?a:a+":"+n)}function Ka(a){var n={s:{c:0,r:0},e:{c:0,r:0}},l=0,c=0,f=0,i=a.length;for(l=0;c<i&&!((f=a.charCodeAt(c)-64)<1||f>26);++c)l=26*l+f;for(n.s.c=--l,l=0;c<i&&!((f=a.charCodeAt(c)-48)<0||f>9);++c)l=10*l+f;if(n.s.r=--l,c===i||f!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++c,l=0;c!=i&&!((f=a.charCodeAt(c)-64)<1||f>26);++c)l=26*l+f;for(n.e.c=--l,l=0;c!=i&&!((f=a.charCodeAt(c)-48)<0||f>9);++c)l=10*l+f;return n.e.r=--l,n}function x3(a,n){var l=a.t=="d"&&n instanceof Date;if(a.z!=null)try{return a.w=Hf(a.z,l?tc(n):n)}catch{}try{return a.w=Hf((a.XF||{}).numFmtId||(l?14:0),l?tc(n):n)}catch{return""+n}}function Vd(a,n,l){return a==null||a.t==null||a.t=="z"?"":a.w!==void 0?a.w:(a.t=="d"&&!a.z&&l&&l.dateNF&&(a.z=l.dateNF),a.t=="e"?$g[a.v]||a.v:n==null?x3(a,a.v):x3(a,n))}function Xp(a,n){var l=n&&n.sheet?n.sheet:"Sheet1",c={};return c[l]=a,{SheetNames:[l],Sheets:c}}function uC(a,n,l){var c=l||{},f=a?Array.isArray(a):c.dense;Hh!=null&&f==null&&(f=Hh);var i=a||(f?[]:{}),x=0,T=0;if(i&&c.origin!=null){if(typeof c.origin=="number")x=c.origin;else{var A=typeof c.origin=="string"?Es(c.origin):c.origin;x=A.r,T=A.c}i["!ref"]||(i["!ref"]="A1:A1")}var M={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var F=Ka(i["!ref"]);M.s.c=F.s.c,M.s.r=F.s.r,M.e.c=Math.max(M.e.c,F.e.c),M.e.r=Math.max(M.e.r,F.e.r),x==-1&&(M.e.r=x=F.e.r+1)}for(var W=0;W!=n.length;++W)if(n[W]){if(!Array.isArray(n[W]))throw new Error("aoa_to_sheet expects an array of arrays");for(var V=0;V!=n[W].length;++V)if(!(typeof n[W][V]>"u")){var R={v:n[W][V]},te=x+W,H=T+V;if(M.s.r>te&&(M.s.r=te),M.s.c>H&&(M.s.c=H),M.e.r<te&&(M.e.r=te),M.e.c<H&&(M.e.c=H),n[W][V]&&typeof n[W][V]=="object"&&!Array.isArray(n[W][V])&&!(n[W][V]instanceof Date))R=n[W][V];else if(Array.isArray(R.v)&&(R.f=n[W][V][1],R.v=R.v[0]),R.v===null)if(R.f)R.t="n";else if(c.nullError)R.t="e",R.v=0;else if(c.sheetStubs)R.t="z";else continue;else typeof R.v=="number"?R.t="n":typeof R.v=="boolean"?R.t="b":R.v instanceof Date?(R.z=c.dateNF||So[14],c.cellDates?(R.t="d",R.w=Hf(R.z,tc(R.v))):(R.t="n",R.v=tc(R.v),R.w=Hf(R.z,R.v))):R.t="s";if(f)i[te]||(i[te]=[]),i[te][H]&&i[te][H].z&&(R.z=i[te][H].z),i[te][H]=R;else{var J=xa({c:H,r:te});i[J]&&i[J].z&&(R.z=i[J].z),i[J]=R}}}return M.s.c<1e7&&(i["!ref"]=$o(M)),i}function b0(a,n){return uC(null,a,n)}function xR(a){return a.read_shift(4,"i")}function th(a,n){return n||(n=ci(4)),n.write_shift(4,a),n}function sl(a){var n=a.read_shift(4);return n===0?"":a.read_shift(n,"dbcs")}function As(a,n){var l=!1;return n==null&&(l=!0,n=ci(4+2*a.length)),n.write_shift(4,a.length),a.length>0&&n.write_shift(0,a,"dbcs"),l?n.slice(0,n.l):n}function vR(a){return{ich:a.read_shift(2),ifnt:a.read_shift(2)}}function yR(a,n){return n||(n=ci(4)),n.write_shift(2,a.ich||0),n.write_shift(2,a.ifnt||0),n}function l2(a,n){var l=a.l,c=a.read_shift(1),f=sl(a),i=[],x={t:f,h:f};if(c&1){for(var T=a.read_shift(4),A=0;A!=T;++A)i.push(vR(a));x.r=i}else x.r=[{ich:0,ifnt:0}];return a.l=l+n,x}function bR(a,n){var l=!1;return n==null&&(l=!0,n=ci(15+4*a.t.length)),n.write_shift(1,0),As(a.t,n),l?n.slice(0,n.l):n}var wR=l2;function TR(a,n){var l=!1;return n==null&&(l=!0,n=ci(23+4*a.t.length)),n.write_shift(1,1),As(a.t,n),n.write_shift(4,1),yR({ich:0,ifnt:0},n),l?n.slice(0,n.l):n}function du(a){var n=a.read_shift(4),l=a.read_shift(2);return l+=a.read_shift(1)<<16,a.l++,{c:n,iStyleRef:l}}function Zp(a,n){return n==null&&(n=ci(8)),n.write_shift(-4,a.c),n.write_shift(3,a.iStyleRef||a.s),n.write_shift(1,0),n}function Yp(a){var n=a.read_shift(2);return n+=a.read_shift(1)<<16,a.l++,{c:-1,iStyleRef:n}}function Kp(a,n){return n==null&&(n=ci(4)),n.write_shift(3,a.iStyleRef||a.s),n.write_shift(1,0),n}var SR=sl,hC=As;function c2(a){var n=a.read_shift(4);return n===0||n===4294967295?"":a.read_shift(n,"dbcs")}function gx(a,n){var l=!1;return n==null&&(l=!0,n=ci(127)),n.write_shift(4,a.length>0?a.length:4294967295),a.length>0&&n.write_shift(0,a,"dbcs"),l?n.slice(0,n.l):n}var ER=sl,qb=c2,u2=gx;function dC(a){var n=a.slice(a.l,a.l+4),l=n[0]&1,c=n[0]&2;a.l+=4;var f=c===0?mx([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):Up(n,0)>>2;return l?f/100:f}function fC(a,n){n==null&&(n=ci(4));var l=0,c=0,f=a*100;if(a==(a|0)&&a>=-(1<<29)&&a<1<<29?c=1:f==(f|0)&&f>=-(1<<29)&&f<1<<29&&(c=1,l=1),c)n.write_shift(-4,((l?f:a)<<2)+(l+2));else throw new Error("unsupported RkNumber "+a)}function pC(a){var n={s:{},e:{}};return n.s.r=a.read_shift(4),n.e.r=a.read_shift(4),n.s.c=a.read_shift(4),n.e.c=a.read_shift(4),n}function AR(a,n){return n||(n=ci(16)),n.write_shift(4,a.s.r),n.write_shift(4,a.e.r),n.write_shift(4,a.s.c),n.write_shift(4,a.e.c),n}var Jp=pC,w0=AR;function T0(a){if(a.length-a.l<8)throw"XLS Xnum Buffer underflow";return a.read_shift(8,"f")}function qp(a,n){return(n||ci(8)).write_shift(8,a,"f")}function CR(a){var n={},l=a.read_shift(1),c=l>>>1,f=a.read_shift(1),i=a.read_shift(2,"i"),x=a.read_shift(1),T=a.read_shift(1),A=a.read_shift(1);switch(a.l++,c){case 0:n.auto=1;break;case 1:n.index=f;var M=OR[f];M&&(n.rgb=k3(M));break;case 2:n.rgb=k3([x,T,A]);break;case 3:n.theme=f;break}return i!=0&&(n.tint=i>0?i/32767:i/32768),n}function _x(a,n){if(n||(n=ci(8)),!a||a.auto)return n.write_shift(4,0),n.write_shift(4,0),n;a.index!=null?(n.write_shift(1,2),n.write_shift(1,a.index)):a.theme!=null?(n.write_shift(1,6),n.write_shift(1,a.theme)):(n.write_shift(1,5),n.write_shift(1,0));var l=a.tint||0;if(l>0?l*=32767:l<0&&(l*=32768),n.write_shift(2,l),!a.rgb||a.theme!=null)n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);else{var c=a.rgb||"FFFFFF";typeof c=="number"&&(c=("000000"+c.toString(16)).slice(-6)),n.write_shift(1,parseInt(c.slice(0,2),16)),n.write_shift(1,parseInt(c.slice(2,4),16)),n.write_shift(1,parseInt(c.slice(4,6),16)),n.write_shift(1,255)}return n}function IR(a){var n=a.read_shift(1);a.l++;var l={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return l}function kR(a,n){n||(n=ci(2));var l=(a.italic?2:0)|(a.strike?8:0)|(a.outline?16:0)|(a.shadow?32:0)|(a.condense?64:0)|(a.extend?128:0);return n.write_shift(1,l),n.write_shift(1,0),n}var mC=2,Fc=3,sx=11;var xx=19;var lx=64,MR=65,DR=71;var FR=4108,PR=4126,Vs=80;var v3={1:{n:"CodePage",t:mC},2:{n:"Category",t:Vs},3:{n:"PresentationFormat",t:Vs},4:{n:"ByteCount",t:Fc},5:{n:"LineCount",t:Fc},6:{n:"ParagraphCount",t:Fc},7:{n:"SlideCount",t:Fc},8:{n:"NoteCount",t:Fc},9:{n:"HiddenCount",t:Fc},10:{n:"MultimediaClipCount",t:Fc},11:{n:"ScaleCrop",t:sx},12:{n:"HeadingPairs",t:FR},13:{n:"TitlesOfParts",t:PR},14:{n:"Manager",t:Vs},15:{n:"Company",t:Vs},16:{n:"LinksUpToDate",t:sx},17:{n:"CharacterCount",t:Fc},19:{n:"SharedDoc",t:sx},22:{n:"HyperlinksChanged",t:sx},23:{n:"AppVersion",t:Fc,p:"version"},24:{n:"DigSig",t:MR},26:{n:"ContentType",t:Vs},27:{n:"ContentStatus",t:Vs},28:{n:"Language",t:Vs},29:{n:"Version",t:Vs},255:{},2147483648:{n:"Locale",t:xx},2147483651:{n:"Behavior",t:xx},1919054434:{}},y3={1:{n:"CodePage",t:mC},2:{n:"Title",t:Vs},3:{n:"Subject",t:Vs},4:{n:"Author",t:Vs},5:{n:"Keywords",t:Vs},6:{n:"Comments",t:Vs},7:{n:"Template",t:Vs},8:{n:"LastAuthor",t:Vs},9:{n:"RevNumber",t:Vs},10:{n:"EditTime",t:lx},11:{n:"LastPrinted",t:lx},12:{n:"CreatedDate",t:lx},13:{n:"ModifiedDate",t:lx},14:{n:"PageCount",t:Fc},15:{n:"WordCount",t:Fc},16:{n:"CharCount",t:Fc},17:{n:"Thumbnail",t:DR},18:{n:"Application",t:Vs},19:{n:"DocSecurity",t:Fc},255:{},2147483648:{n:"Locale",t:xx},2147483651:{n:"Behavior",t:xx},1919054434:{}};function LR(a){return a.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var RR=LR([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),OR=ic(RR),$g={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"};var NR={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},cx={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function gC(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function _C(a,n){var l=qL(NR),c=[],f;c[c.length]=Xo,c[c.length]=Vi("Types",null,{xmlns:Ss.CT,"xmlns:xsd":Ss.xsd,"xmlns:xsi":Ss.xsi}),c=c.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(A){return Vi("Default",null,{Extension:A[0],ContentType:A[1]})}));var i=function(A){a[A]&&a[A].length>0&&(f=a[A][0],c[c.length]=Vi("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:cx[A][n.bookType]||cx[A].xlsx}))},x=function(A){(a[A]||[]).forEach(function(M){c[c.length]=Vi("Override",null,{PartName:(M[0]=="/"?"":"/")+M,ContentType:cx[A][n.bookType]||cx[A].xlsx})})},T=function(A){(a[A]||[]).forEach(function(M){c[c.length]=Vi("Override",null,{PartName:(M[0]=="/"?"":"/")+M,ContentType:l[A][0]})})};return i("workbooks"),x("sheets"),x("charts"),T("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(T),T("vba"),T("comments"),T("threadedcomments"),T("drawings"),x("metadata"),T("people"),c.length>2&&(c[c.length]="</Types>",c[1]=c[1].replace("/>",">")),c.join("")}var qn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function xC(a){var n=a.lastIndexOf("/");return a.slice(0,n+1)+"_rels/"+a.slice(n+1)+".rels"}function p0(a){var n=[Xo,Vi("Relationships",null,{xmlns:Ss.RELS})];return Ws(a["!id"]).forEach(function(l){n[n.length]=Vi("Relationship",null,a["!id"][l])}),n.length>2&&(n[n.length]="</Relationships>",n[1]=n[1].replace("/>",">")),n.join("")}function ga(a,n,l,c,f,i){if(f||(f={}),a["!id"]||(a["!id"]={}),a["!idx"]||(a["!idx"]=1),n<0)for(n=a["!idx"];a["!id"]["rId"+n];++n);if(a["!idx"]=n+1,f.Id="rId"+n,f.Type=c,f.Target=l,i?f.TargetMode=i:[qn.HLINK,qn.XPATH,qn.XMISS].indexOf(f.Type)>-1&&(f.TargetMode="External"),a["!id"][f.Id])throw new Error("Cannot rewrite rId "+n);return a["!id"][f.Id]=f,a[("/"+f.Target).replace("//","/")]=f,n}function BR(a){var n=[Xo];n.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),n.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var l=0;l<a.length;++l)n.push('  <manifest:file-entry manifest:full-path="'+a[l][0]+'" manifest:media-type="'+a[l][1]+`"/>
`);return n.push("</manifest:manifest>"),n.join("")}function b3(a,n,l){return['  <rdf:Description rdf:about="'+a+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(l||"odf")+"#"+n+`"/>
`,`  </rdf:Description>
`].join("")}function zR(a,n){return['  <rdf:Description rdf:about="'+a+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+n+`"/>
`,`  </rdf:Description>
`].join("")}function jR(a){var n=[Xo];n.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var l=0;l!=a.length;++l)n.push(b3(a[l][0],a[l][1])),n.push(zR("",a[l][0]));return n.push(b3("","Document","pkg")),n.push("</rdf:RDF>"),n.join("")}function vC(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Bg.version+"</meta:generator></office:meta></office:document-meta>"}var Gp=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function zb(a,n,l,c,f){f[a]!=null||n==null||n===""||(f[a]=n,n=_a(n),c[c.length]=l?Vi(a,n,l):Hs(a,n))}function yC(a,n){var l=n||{},c=[Xo,Vi("cp:coreProperties",null,{"xmlns:cp":Ss.CORE_PROPS,"xmlns:dc":Ss.dc,"xmlns:dcterms":Ss.dcterms,"xmlns:dcmitype":Ss.dcmitype,"xmlns:xsi":Ss.xsi})],f={};if(!a&&!l.Props)return c.join("");a&&(a.CreatedDate!=null&&zb("dcterms:created",typeof a.CreatedDate=="string"?a.CreatedDate:Wb(a.CreatedDate,l.WTF),{"xsi:type":"dcterms:W3CDTF"},c,f),a.ModifiedDate!=null&&zb("dcterms:modified",typeof a.ModifiedDate=="string"?a.ModifiedDate:Wb(a.ModifiedDate,l.WTF),{"xsi:type":"dcterms:W3CDTF"},c,f));for(var i=0;i!=Gp.length;++i){var x=Gp[i],T=l.Props&&l.Props[x[1]]!=null?l.Props[x[1]]:a?a[x[1]]:null;T===!0?T="1":T===!1?T="0":typeof T=="number"&&(T=String(T)),T!=null&&zb(x[0],T,null,c,f)}return c.length>2&&(c[c.length]="</cp:coreProperties>",c[1]=c[1].replace("/>",">")),c.join("")}var m0=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],bC=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function wC(a){var n=[],l=Vi;return a||(a={}),a.Application="SheetJS",n[n.length]=Xo,n[n.length]=Vi("Properties",null,{xmlns:Ss.EXT_PROPS,"xmlns:vt":Ss.vt}),m0.forEach(function(c){if(a[c[1]]!==void 0){var f;switch(c[2]){case"string":f=_a(String(a[c[1]]));break;case"bool":f=a[c[1]]?"true":"false";break}f!==void 0&&(n[n.length]=l(c[0],f))}}),n[n.length]=l("HeadingPairs",l("vt:vector",l("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+l("vt:variant",l("vt:i4",String(a.Worksheets))),{size:2,baseType:"variant"})),n[n.length]=l("TitlesOfParts",l("vt:vector",a.SheetNames.map(function(c){return"<vt:lpstr>"+_a(c)+"</vt:lpstr>"}).join(""),{size:a.Worksheets,baseType:"lpstr"})),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}function TC(a){var n=[Xo,Vi("Properties",null,{xmlns:Ss.CUST_PROPS,"xmlns:vt":Ss.vt})];if(!a)return n.join("");var l=1;return Ws(a).forEach(function(f){++l,n[n.length]=Vi("property",rR(a[f],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:l,name:_a(f)})}),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var w3={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function VR(a,n){var l=[];return Ws(w3).map(function(c){for(var f=0;f<Gp.length;++f)if(Gp[f][1]==c)return Gp[f];for(f=0;f<m0.length;++f)if(m0[f][1]==c)return m0[f];throw c}).forEach(function(c){if(a[c[1]]!=null){var f=n&&n.Props&&n.Props[c[1]]!=null?n.Props[c[1]]:a[c[1]];switch(c[2]){case"date":f=new Date(f).toISOString().replace(/\.\d*Z/,"Z");break}typeof f=="number"?f=String(f):f===!0||f===!1?f=f?"1":"0":f instanceof Date&&(f=new Date(f).toISOString().replace(/\.\d*Z/,"")),l.push(Hs(w3[c[1]]||c[1],f))}}),Vi("DocumentProperties",l.join(""),{xmlns:Lc.o})}function UR(a,n){var l=["Worksheets","SheetNames"],c="CustomDocumentProperties",f=[];return a&&Ws(a).forEach(function(i){if(Object.prototype.hasOwnProperty.call(a,i)){for(var x=0;x<Gp.length;++x)if(i==Gp[x][1])return;for(x=0;x<m0.length;++x)if(i==m0[x][1])return;for(x=0;x<l.length;++x)if(i==l[x])return;var T=a[i],A="string";typeof T=="number"?(A="float",T=String(T)):T===!0||T===!1?(A="boolean",T=T?"1":"0"):T=String(T),f.push(Vi(c3(i),T,{"dt:dt":A}))}}),n&&Ws(n).forEach(function(i){if(Object.prototype.hasOwnProperty.call(n,i)&&!(a&&Object.prototype.hasOwnProperty.call(a,i))){var x=n[i],T="string";typeof x=="number"?(T="float",x=String(x)):x===!0||x===!1?(T="boolean",x=x?"1":"0"):x instanceof Date?(T="dateTime.tz",x=x.toISOString()):x=String(x),f.push(Vi(c3(i),x,{"dt:dt":T}))}}),"<"+c+' xmlns="'+Lc.o+'">'+f.join("")+"</"+c+">"}function HR(a){var n=typeof a=="string"?new Date(Date.parse(a)):a,l=n.getTime()/1e3+11644473600,c=l%Math.pow(2,32),f=(l-c)/Math.pow(2,32);c*=1e7,f*=1e7;var i=c/Math.pow(2,32)|0;i>0&&(c=c%Math.pow(2,32),f+=i);var x=ci(8);return x.write_shift(4,c),x.write_shift(4,f),x}function T3(a,n){var l=ci(4),c=ci(4);switch(l.write_shift(4,a==80?31:a),a){case 3:c.write_shift(-4,n);break;case 5:c=ci(8),c.write_shift(8,n,"f");break;case 11:c.write_shift(4,n?1:0);break;case 64:c=HR(n);break;case 31:case 80:for(c=ci(4+2*(n.length+1)+(n.length%2?0:2)),c.write_shift(4,n.length+1),c.write_shift(0,n,"dbcs");c.l!=c.length;)c.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+a+" "+n)}return Us([l,c])}var SC=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function GR(a){switch(typeof a){case"boolean":return 11;case"number":return(a|0)==a?3:5;case"string":return 31;case"object":if(a instanceof Date)return 64;break}return-1}function S3(a,n,l){var c=ci(8),f=[],i=[],x=8,T=0,A=ci(8),M=ci(8);if(A.write_shift(4,2),A.write_shift(4,1200),M.write_shift(4,1),i.push(A),f.push(M),x+=8+A.length,!n){M=ci(8),M.write_shift(4,0),f.unshift(M);var F=[ci(4)];for(F[0].write_shift(4,a.length),T=0;T<a.length;++T){var W=a[T][0];for(A=ci(8+2*(W.length+1)+(W.length%2?0:2)),A.write_shift(4,T+2),A.write_shift(4,W.length+1),A.write_shift(0,W,"dbcs");A.l!=A.length;)A.write_shift(1,0);F.push(A)}A=Us(F),i.unshift(A),x+=8+A.length}for(T=0;T<a.length;++T)if(!(n&&!n[a[T][0]])&&!(SC.indexOf(a[T][0])>-1||bC.indexOf(a[T][0])>-1)&&a[T][1]!=null){var V=a[T][1],R=0;if(n){R=+n[a[T][0]];var te=l[R];if(te.p=="version"&&typeof V=="string"){var H=V.split(".");V=(+H[0]<<16)+(+H[1]||0)}A=T3(te.t,V)}else{var J=GR(V);J==-1&&(J=31,V=String(V)),A=T3(J,V)}i.push(A),M=ci(8),M.write_shift(4,n?R:2+T),f.push(M),x+=8+A.length}var K=8*(i.length+1);for(T=0;T<i.length;++T)f[T].write_shift(4,K),K+=i[T].length;return c.write_shift(4,x),c.write_shift(4,i.length),Us([c].concat(f).concat(i))}function E3(a,n,l,c,f,i){var x=ci(f?68:48),T=[x];x.write_shift(2,65534),x.write_shift(2,0),x.write_shift(4,842412599),x.write_shift(16,Ca.utils.consts.HEADER_CLSID,"hex"),x.write_shift(4,f?2:1),x.write_shift(16,n,"hex"),x.write_shift(4,f?68:48);var A=S3(a,l,c);if(T.push(A),f){var M=S3(f,null,null);x.write_shift(16,i,"hex"),x.write_shift(4,68+A.length),T.push(M)}return Us(T)}function WR(a,n){n||(n=ci(a));for(var l=0;l<a;++l)n.write_shift(1,0);return n}function qR(a,n){return a.read_shift(n)===1}function Il(a,n){return n||(n=ci(2)),n.write_shift(2,+!!a),n}function EC(a){return a.read_shift(2,"u")}function hu(a,n){return n||(n=ci(2)),n.write_shift(2,a),n}function AC(a,n,l){return l||(l=ci(2)),l.write_shift(1,n=="e"?+a:+!!a),l.write_shift(1,n=="e"?1:0),l}function CC(a,n,l){var c=a.read_shift(l&&l.biff>=12?2:1),f="sbcs-cont",i=Hp;if(l&&l.biff>=8&&(Hp=1200),!l||l.biff==8){var x=a.read_shift(1);x&&(f="dbcs-cont")}else l.biff==12&&(f="wstr");l.biff>=2&&l.biff<=5&&(f="cpstr");var T=c?a.read_shift(c,f):"";return Hp=i,T}function $R(a){var n=a.t||"",l=1,c=ci(3+(l>1?2:0));c.write_shift(2,n.length),c.write_shift(1,(l>1?8:0)|1),l>1&&c.write_shift(2,l);var f=ci(2*n.length);f.write_shift(2*n.length,n,"utf16le");var i=[c,f];return Us(i)}function XR(a,n,l){var c;if(l){if(l.biff>=2&&l.biff<=5)return a.read_shift(n,"cpstr");if(l.biff>=12)return a.read_shift(n,"dbcs-cont")}var f=a.read_shift(1);return f===0?c=a.read_shift(n,"sbcs-cont"):c=a.read_shift(n,"dbcs-cont"),c}function ZR(a,n,l){var c=a.read_shift(l&&l.biff==2?1:2);return c===0?(a.l++,""):XR(a,c,l)}function YR(a,n,l){if(l.biff>5)return ZR(a,n,l);var c=a.read_shift(1);return c===0?(a.l++,""):a.read_shift(c,l.biff<=4||!a.lens?"cpstr":"sbcs-cont")}function IC(a,n,l){return l||(l=ci(3+2*a.length)),l.write_shift(2,a.length),l.write_shift(1,1),l.write_shift(31,a,"utf16le"),l}function A3(a,n){n||(n=ci(6+a.length*2)),n.write_shift(4,1+a.length);for(var l=0;l<a.length;++l)n.write_shift(2,a.charCodeAt(l));return n.write_shift(2,0),n}function KR(a){var n=ci(512),l=0,c=a.Target;c.slice(0,7)=="file://"&&(c=c.slice(7));var f=c.indexOf("#"),i=f>-1?31:23;switch(c.charAt(0)){case"#":i=28;break;case".":i&=-3;break}n.write_shift(4,2),n.write_shift(4,i);var x=[8,6815827,6619237,4849780,83];for(l=0;l<x.length;++l)n.write_shift(4,x[l]);if(i==28)c=c.slice(1),A3(c,n);else if(i&2){for(x="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),l=0;l<x.length;++l)n.write_shift(1,parseInt(x[l],16));var T=f>-1?c.slice(0,f):c;for(n.write_shift(4,2*(T.length+1)),l=0;l<T.length;++l)n.write_shift(2,T.charCodeAt(l));n.write_shift(2,0),i&8&&A3(f>-1?c.slice(f+1):"",n)}else{for(x="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),l=0;l<x.length;++l)n.write_shift(1,parseInt(x[l],16));for(var A=0;c.slice(A*3,A*3+3)=="../"||c.slice(A*3,A*3+3)=="..\\";)++A;for(n.write_shift(2,A),n.write_shift(4,c.length-3*A+1),l=0;l<c.length-3*A;++l)n.write_shift(1,c.charCodeAt(l+3*A)&255);for(n.write_shift(1,0),n.write_shift(2,65535),n.write_shift(2,57005),l=0;l<6;++l)n.write_shift(4,0)}return n.slice(0,n.l)}function $p(a,n,l,c){return c||(c=ci(6)),c.write_shift(2,a),c.write_shift(2,n),c.write_shift(2,l||0),c}function JR(a,n,l){var c=l.biff>8?4:2,f=a.read_shift(c),i=a.read_shift(c,"i"),x=a.read_shift(c,"i");return[f,i,x]}function QR(a){var n=a.read_shift(2),l=a.read_shift(2),c=a.read_shift(2),f=a.read_shift(2);return{s:{c,r:n},e:{c:f,r:l}}}function kC(a,n){return n||(n=ci(8)),n.write_shift(2,a.s.r),n.write_shift(2,a.e.r),n.write_shift(2,a.s.c),n.write_shift(2,a.e.c),n}function h2(a,n,l){var c=1536,f=16;switch(l.bookType){case"biff8":break;case"biff5":c=1280,f=8;break;case"biff4":c=4,f=6;break;case"biff3":c=3,f=6;break;case"biff2":c=2,f=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=ci(f);return i.write_shift(2,c),i.write_shift(2,n),f>4&&i.write_shift(2,29282),f>6&&i.write_shift(2,1997),f>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function e6(a,n){var l=!n||n.biff==8,c=ci(l?112:54);for(c.write_shift(n.biff==8?2:1,7),l&&c.write_shift(1,0),c.write_shift(4,859007059),c.write_shift(4,5458548|(l?0:536870912));c.l<c.length;)c.write_shift(1,l?0:32);return c}function t6(a,n){var l=!n||n.biff>=8?2:1,c=ci(8+l*a.name.length);c.write_shift(4,a.pos),c.write_shift(1,a.hs||0),c.write_shift(1,a.dt),c.write_shift(1,a.name.length),n.biff>=8&&c.write_shift(1,1),c.write_shift(l*a.name.length,a.name,n.biff<8?"sbcs":"utf16le");var f=c.slice(0,c.l);return f.l=c.l,f}function i6(a,n){var l=ci(8);l.write_shift(4,a.Count),l.write_shift(4,a.Unique);for(var c=[],f=0;f<a.length;++f)c[f]=$R(a[f],n);var i=Us([l].concat(c));return i.parts=[l.length].concat(c.map(function(x){return x.length})),i}function r6(){var a=ci(18);return a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,29280),a.write_shift(2,17600),a.write_shift(2,56),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,1),a.write_shift(2,500),a}function n6(a){var n=ci(18),l=1718;return a&&a.RTL&&(l|=64),n.write_shift(2,l),n.write_shift(4,0),n.write_shift(4,64),n.write_shift(4,0),n.write_shift(4,0),n}function a6(a,n){var l=a.name||"Arial",c=n&&n.biff==5,f=c?15+l.length:16+2*l.length,i=ci(f);return i.write_shift(2,(a.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,l.length),c||i.write_shift(1,1),i.write_shift((c?1:2)*l.length,l,c?"sbcs":"utf16le"),i}function o6(a,n,l,c){var f=ci(10);return $p(a,n,c,f),f.write_shift(4,l),f}function s6(a,n,l,c,f){var i=!f||f.biff==8,x=ci(8+ +i+(1+i)*l.length);return $p(a,n,c,x),x.write_shift(2,l.length),i&&x.write_shift(1,1),x.write_shift((1+i)*l.length,l,i?"utf16le":"sbcs"),x}function l6(a,n,l,c){var f=l&&l.biff==5;c||(c=ci(f?3+n.length:5+2*n.length)),c.write_shift(2,a),c.write_shift(f?1:2,n.length),f||c.write_shift(1,1),c.write_shift((f?1:2)*n.length,n,f?"sbcs":"utf16le");var i=c.length>c.l?c.slice(0,c.l):c;return i.l==null&&(i.l=i.length),i}function c6(a,n){var l=n.biff==8||!n.biff?4:2,c=ci(2*l+6);return c.write_shift(l,a.s.r),c.write_shift(l,a.e.r+1),c.write_shift(2,a.s.c),c.write_shift(2,a.e.c+1),c.write_shift(2,0),c}function C3(a,n,l,c){var f=l&&l.biff==5;c||(c=ci(f?16:20)),c.write_shift(2,0),a.style?(c.write_shift(2,a.numFmtId||0),c.write_shift(2,65524)):(c.write_shift(2,a.numFmtId||0),c.write_shift(2,n<<4));var i=0;return a.numFmtId>0&&f&&(i|=1024),c.write_shift(4,i),c.write_shift(4,0),f||c.write_shift(4,0),c.write_shift(2,0),c}function u6(a){var n=ci(8);return n.write_shift(4,0),n.write_shift(2,a[0]?a[0]+1:0),n.write_shift(2,a[1]?a[1]+1:0),n}function h6(a,n,l,c,f,i){var x=ci(8);return $p(a,n,c,x),AC(l,i,x),x}function d6(a,n,l,c){var f=ci(14);return $p(a,n,c,f),qp(l,f),f}function f6(a,n,l){if(l.biff<8)return p6(a,n,l);for(var c=[],f=a.l+n,i=a.read_shift(l.biff>8?4:2);i--!==0;)c.push(JR(a,l.biff>8?12:6,l));if(a.l!=f)throw new Error("Bad ExternSheet: "+a.l+" != "+f);return c}function p6(a,n,l){a[a.l+1]==3&&a[a.l]++;var c=CC(a,n,l);return c.charCodeAt(0)==3?c.slice(1):c}function m6(a){var n=ci(2+a.length*8);n.write_shift(2,a.length);for(var l=0;l<a.length;++l)kC(a[l],n);return n}function g6(a){var n=ci(24),l=Es(a[0]);n.write_shift(2,l.r),n.write_shift(2,l.r),n.write_shift(2,l.c),n.write_shift(2,l.c);for(var c="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),f=0;f<16;++f)n.write_shift(1,parseInt(c[f],16));return Us([n,KR(a[1])])}function _6(a){var n=a[1].Tooltip,l=ci(10+2*(n.length+1));l.write_shift(2,2048);var c=Es(a[0]);l.write_shift(2,c.r),l.write_shift(2,c.r),l.write_shift(2,c.c),l.write_shift(2,c.c);for(var f=0;f<n.length;++f)l.write_shift(2,n.charCodeAt(f));return l.write_shift(2,0),l}function x6(a){return a||(a=ci(4)),a.write_shift(2,1),a.write_shift(2,1),a}function v6(a,n,l){if(!l.cellStyles)return Gh(a,n);var c=l&&l.biff>=12?4:2,f=a.read_shift(c),i=a.read_shift(c),x=a.read_shift(c),T=a.read_shift(c),A=a.read_shift(2);c==2&&(a.l+=2);var M={s:f,e:i,w:x,ixfe:T,flags:A};return(l.biff>=5||!l.biff)&&(M.level=A>>8&7),M}function y6(a,n){var l=ci(12);l.write_shift(2,n),l.write_shift(2,n),l.write_shift(2,a.width*256),l.write_shift(2,0);var c=0;return a.hidden&&(c|=1),l.write_shift(1,c),c=a.level||0,l.write_shift(1,c),l.write_shift(2,0),l}function b6(a){for(var n=ci(2*a),l=0;l<a;++l)n.write_shift(2,l+1);return n}function w6(a,n,l){var c=ci(15);return Zg(c,a,n),c.write_shift(8,l,"f"),c}function T6(a,n,l){var c=ci(9);return Zg(c,a,n),c.write_shift(2,l),c}var S6=function(){var a={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=Yb({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function l(T,A){var M=[],F=Wp(1);switch(A.type){case"base64":F=Qu(jd(T));break;case"binary":F=Qu(T);break;case"buffer":case"array":F=T;break}Pc(F,0);var W=F.read_shift(1),V=!!(W&136),R=!1,te=!1;switch(W){case 2:break;case 3:break;case 48:R=!0,V=!0;break;case 49:R=!0,V=!0;break;case 131:break;case 139:break;case 140:te=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+W.toString(16))}var H=0,J=521;W==2&&(H=F.read_shift(2)),F.l+=3,W!=2&&(H=F.read_shift(4)),H>1048576&&(H=1e6),W!=2&&(J=F.read_shift(2));var K=F.read_shift(2),ne=A.codepage||1252;W!=2&&(F.l+=16,F.read_shift(1),F[F.l]!==0&&(ne=a[F[F.l]]),F.l+=1,F.l+=2),te&&(F.l+=36);for(var de=[],De={},Fe=Math.min(F.length,W==2?521:J-10-(R?264:0)),et=te?32:11;F.l<Fe&&F[F.l]!=13;)switch(De={},De.name=Fa.utils.decode(ne,F.slice(F.l,F.l+et)).replace(/[\u0000\r\n].*$/g,""),F.l+=et,De.type=String.fromCharCode(F.read_shift(1)),W!=2&&!te&&(De.offset=F.read_shift(4)),De.len=F.read_shift(1),W==2&&(De.offset=F.read_shift(2)),De.dec=F.read_shift(1),De.name.length&&de.push(De),W!=2&&(F.l+=te?13:14),De.type){case"B":(!R||De.len!=8)&&A.WTF&&console.log("Skipping "+De.name+":"+De.type);break;case"G":case"P":A.WTF&&console.log("Skipping "+De.name+":"+De.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+De.type)}if(F[F.l]!==13&&(F.l=J-1),F.read_shift(1)!==13)throw new Error("DBF Terminator not found "+F.l+" "+F[F.l]);F.l=J;var Te=0,ge=0;for(M[0]=[],ge=0;ge!=de.length;++ge)M[0][ge]=de[ge].name;for(;H-- >0;){if(F[F.l]===42){F.l+=K;continue}for(++F.l,M[++Te]=[],ge=0,ge=0;ge!=de.length;++ge){var Ve=F.slice(F.l,F.l+de[ge].len);F.l+=de[ge].len,Pc(Ve,0);var Ae=Fa.utils.decode(ne,Ve);switch(de[ge].type){case"C":Ae.trim().length&&(M[Te][ge]=Ae.replace(/\s+$/,""));break;case"D":Ae.length===8?M[Te][ge]=new Date(+Ae.slice(0,4),+Ae.slice(4,6)-1,+Ae.slice(6,8)):M[Te][ge]=Ae;break;case"F":M[Te][ge]=parseFloat(Ae.trim());break;case"+":case"I":M[Te][ge]=te?Ve.read_shift(-4,"i")^2147483648:Ve.read_shift(4,"i");break;case"L":switch(Ae.trim().toUpperCase()){case"Y":case"T":M[Te][ge]=!0;break;case"N":case"F":M[Te][ge]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Ae+"|")}break;case"M":if(!V)throw new Error("DBF Unexpected MEMO for type "+W.toString(16));M[Te][ge]="##MEMO##"+(te?parseInt(Ae.trim(),10):Ve.read_shift(4));break;case"N":Ae=Ae.replace(/\u0000/g,"").trim(),Ae&&Ae!="."&&(M[Te][ge]=+Ae||0);break;case"@":M[Te][ge]=new Date(Ve.read_shift(-8,"f")-621356832e5);break;case"T":M[Te][ge]=new Date((Ve.read_shift(4)-2440588)*864e5+Ve.read_shift(4));break;case"Y":M[Te][ge]=Ve.read_shift(4,"i")/1e4+Ve.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":M[Te][ge]=-Ve.read_shift(-8,"f");break;case"B":if(R&&de[ge].len==8){M[Te][ge]=Ve.read_shift(8,"f");break}case"G":case"P":Ve.l+=de[ge].len;break;case"0":if(de[ge].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+de[ge].type)}}}if(W!=2&&F.l<F.length&&F[F.l++]!=26)throw new Error("DBF EOF Marker missing "+(F.l-1)+" of "+F.length+" "+F[F.l-1].toString(16));return A&&A.sheetRows&&(M=M.slice(0,A.sheetRows)),A.DBF=de,M}function c(T,A){var M=A||{};M.dateNF||(M.dateNF="yyyymmdd");var F=b0(l(T,M),M);return F["!cols"]=M.DBF.map(function(W){return{wch:W.len,DBF:W}}),delete M.DBF,F}function f(T,A){try{return Xp(c(T,A),A)}catch(M){if(A&&A.WTF)throw M}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function x(T,A){var M=A||{};if(+M.codepage>=0&&zg(+M.codepage),M.type=="string")throw new Error("Cannot write DBF to JS string");var F=ec(),W=Tx(T,{header:1,raw:!0,cellDates:!0}),V=W[0],R=W.slice(1),te=T["!cols"]||[],H=0,J=0,K=0,ne=1;for(H=0;H<V.length;++H){if(((te[H]||{}).DBF||{}).name){V[H]=te[H].DBF.name,++K;continue}if(V[H]!=null){if(++K,typeof V[H]=="number"&&(V[H]=V[H].toString(10)),typeof V[H]!="string")throw new Error("DBF Invalid column name "+V[H]+" |"+typeof V[H]+"|");if(V.indexOf(V[H])!==H){for(J=0;J<1024;++J)if(V.indexOf(V[H]+"_"+J)==-1){V[H]+="_"+J;break}}}}var de=Ka(T["!ref"]),De=[],Fe=[],et=[];for(H=0;H<=de.e.c-de.s.c;++H){var Te="",ge="",Ve=0,Ae=[];for(J=0;J<R.length;++J)R[J][H]!=null&&Ae.push(R[J][H]);if(Ae.length==0||V[H]==null){De[H]="?";continue}for(J=0;J<Ae.length;++J){switch(typeof Ae[J]){case"number":ge="B";break;case"string":ge="C";break;case"boolean":ge="L";break;case"object":ge=Ae[J]instanceof Date?"D":"C";break;default:ge="C"}Ve=Math.max(Ve,String(Ae[J]).length),Te=Te&&Te!=ge?"C":ge}Ve>250&&(Ve=250),ge=((te[H]||{}).DBF||{}).type,ge=="C"&&te[H].DBF.len>Ve&&(Ve=te[H].DBF.len),Te=="B"&&ge=="N"&&(Te="N",et[H]=te[H].DBF.dec,Ve=te[H].DBF.len),Fe[H]=Te=="C"||ge=="N"?Ve:i[Te]||0,ne+=Fe[H],De[H]=Te}var _e=F.next(32);for(_e.write_shift(4,318902576),_e.write_shift(4,R.length),_e.write_shift(2,296+32*K),_e.write_shift(2,ne),H=0;H<4;++H)_e.write_shift(4,0);for(_e.write_shift(4,0|(+n[_0]||3)<<8),H=0,J=0;H<V.length;++H)if(V[H]!=null){var xe=F.next(32),Qe=(V[H].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);xe.write_shift(1,Qe,"sbcs"),xe.write_shift(1,De[H]=="?"?"C":De[H],"sbcs"),xe.write_shift(4,J),xe.write_shift(1,Fe[H]||i[De[H]]||0),xe.write_shift(1,et[H]||0),xe.write_shift(1,2),xe.write_shift(4,0),xe.write_shift(1,0),xe.write_shift(4,0),xe.write_shift(4,0),J+=Fe[H]||i[De[H]]||0}var Ce=F.next(264);for(Ce.write_shift(4,13),H=0;H<65;++H)Ce.write_shift(4,0);for(H=0;H<R.length;++H){var Ye=F.next(ne);for(Ye.write_shift(1,0),J=0;J<V.length;++J)if(V[J]!=null)switch(De[J]){case"L":Ye.write_shift(1,R[H][J]==null?63:R[H][J]?84:70);break;case"B":Ye.write_shift(8,R[H][J]||0,"f");break;case"N":var ut="0";for(typeof R[H][J]=="number"&&(ut=R[H][J].toFixed(et[J]||0)),K=0;K<Fe[J]-ut.length;++K)Ye.write_shift(1,32);Ye.write_shift(1,ut,"sbcs");break;case"D":R[H][J]?(Ye.write_shift(4,("0000"+R[H][J].getFullYear()).slice(-4),"sbcs"),Ye.write_shift(2,("00"+(R[H][J].getMonth()+1)).slice(-2),"sbcs"),Ye.write_shift(2,("00"+R[H][J].getDate()).slice(-2),"sbcs")):Ye.write_shift(8,"00000000","sbcs");break;case"C":var st=String(R[H][J]!=null?R[H][J]:"").slice(0,Fe[J]);for(Ye.write_shift(1,st,"sbcs"),K=0;K<Fe[J]-st.length;++K)Ye.write_shift(1,32);break}}return F.next(1).write_shift(1,26),F.end()}return{to_workbook:f,to_sheet:c,from_sheet:x}}(),E6=function(){var a={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+Ws(a).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),l=function(V,R){var te=a[R];return typeof te=="number"?KA(te):te},c=function(V,R,te){var H=R.charCodeAt(0)-32<<4|te.charCodeAt(0)-48;return H==59?V:KA(H)};a["|"]=254;function f(V,R){switch(R.type){case"base64":return i(jd(V),R);case"binary":return i(V,R);case"buffer":return i(ta&&Buffer.isBuffer(V)?V.toString("binary"):Wg(V),R);case"array":return i(Ix(V),R)}throw new Error("Unrecognized type "+R.type)}function i(V,R){var te=V.split(/[\n\r]+/),H=-1,J=-1,K=0,ne=0,de=[],De=[],Fe=null,et={},Te=[],ge=[],Ve=[],Ae=0,_e;for(+R.codepage>=0&&zg(+R.codepage);K!==te.length;++K){Ae=0;var xe=te[K].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,c).replace(n,l),Qe=xe.replace(/;;/g,"\0").split(";").map(function(Ie){return Ie.replace(/\u0000/g,";")}),Ce=Qe[0],Ye;if(xe.length>0)switch(Ce){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Qe[1].charAt(0)=="P"&&De.push(xe.slice(3).replace(/;;/g,";"));break;case"C":var ut=!1,st=!1,pt=!1,Tt=!1,ht=-1,Wt=-1;for(ne=1;ne<Qe.length;++ne)switch(Qe[ne].charAt(0)){case"A":break;case"X":J=parseInt(Qe[ne].slice(1))-1,st=!0;break;case"Y":for(H=parseInt(Qe[ne].slice(1))-1,st||(J=0),_e=de.length;_e<=H;++_e)de[_e]=[];break;case"K":Ye=Qe[ne].slice(1),Ye.charAt(0)==='"'?Ye=Ye.slice(1,Ye.length-1):Ye==="TRUE"?Ye=!0:Ye==="FALSE"?Ye=!1:isNaN(Bd(Ye))?isNaN(Vg(Ye).getDate())||(Ye=kl(Ye)):(Ye=Bd(Ye),Fe!==null&&X3(Fe)&&(Ye=J3(Ye))),typeof Fa<"u"&&typeof Ye=="string"&&(R||{}).type!="string"&&(R||{}).codepage&&(Ye=Fa.utils.decode(R.codepage,Ye)),ut=!0;break;case"E":Tt=!0;var ie=TO(Qe[ne].slice(1),{r:H,c:J});de[H][J]=[de[H][J],ie];break;case"S":pt=!0,de[H][J]=[de[H][J],"S5S"];break;case"G":break;case"R":ht=parseInt(Qe[ne].slice(1))-1;break;case"C":Wt=parseInt(Qe[ne].slice(1))-1;break;default:if(R&&R.WTF)throw new Error("SYLK bad record "+xe)}if(ut&&(de[H][J]&&de[H][J].length==2?de[H][J][0]=Ye:de[H][J]=Ye,Fe=null),pt){if(Tt)throw new Error("SYLK shared formula cannot have own formula");var ye=ht>-1&&de[ht][Wt];if(!ye||!ye[1])throw new Error("SYLK shared formula cannot find base");de[H][J][1]=SO(ye[1],{r:H-ht,c:J-Wt})}break;case"F":var pe=0;for(ne=1;ne<Qe.length;++ne)switch(Qe[ne].charAt(0)){case"X":J=parseInt(Qe[ne].slice(1))-1,++pe;break;case"Y":for(H=parseInt(Qe[ne].slice(1))-1,_e=de.length;_e<=H;++_e)de[_e]=[];break;case"M":Ae=parseInt(Qe[ne].slice(1))/20;break;case"F":break;case"G":break;case"P":Fe=De[parseInt(Qe[ne].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(Ve=Qe[ne].slice(1).split(" "),_e=parseInt(Ve[0],10);_e<=parseInt(Ve[1],10);++_e)Ae=parseInt(Ve[2],10),ge[_e-1]=Ae===0?{hidden:!0}:{wch:Ae},d2(ge[_e-1]);break;case"C":J=parseInt(Qe[ne].slice(1))-1,ge[J]||(ge[J]={});break;case"R":H=parseInt(Qe[ne].slice(1))-1,Te[H]||(Te[H]={}),Ae>0?(Te[H].hpt=Ae,Te[H].hpx=LC(Ae)):Ae===0&&(Te[H].hidden=!0);break;default:if(R&&R.WTF)throw new Error("SYLK bad record "+xe)}pe<1&&(Fe=null);break;default:if(R&&R.WTF)throw new Error("SYLK bad record "+xe)}}return Te.length>0&&(et["!rows"]=Te),ge.length>0&&(et["!cols"]=ge),R&&R.sheetRows&&(de=de.slice(0,R.sheetRows)),[de,et]}function x(V,R){var te=f(V,R),H=te[0],J=te[1],K=b0(H,R);return Ws(J).forEach(function(ne){K[ne]=J[ne]}),K}function T(V,R){return Xp(x(V,R),R)}function A(V,R,te,H){var J="C;Y"+(te+1)+";X"+(H+1)+";K";switch(V.t){case"n":J+=V.v||0,V.f&&!V.F&&(J+=";E"+p2(V.f,{r:te,c:H}));break;case"b":J+=V.v?"TRUE":"FALSE";break;case"e":J+=V.w||V.v;break;case"d":J+='"'+(V.w||V.v)+'"';break;case"s":J+='"'+V.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return J}function M(V,R){R.forEach(function(te,H){var J="F;W"+(H+1)+" "+(H+1)+" ";te.hidden?J+="0":(typeof te.width=="number"&&!te.wpx&&(te.wpx=vx(te.width)),typeof te.wpx=="number"&&!te.wch&&(te.wch=yx(te.wpx)),typeof te.wch=="number"&&(J+=Math.round(te.wch))),J.charAt(J.length-1)!=" "&&V.push(J)})}function F(V,R){R.forEach(function(te,H){var J="F;";te.hidden?J+="M0;":te.hpt?J+="M"+20*te.hpt+";":te.hpx&&(J+="M"+20*bx(te.hpx)+";"),J.length>2&&V.push(J+"R"+(H+1))})}function W(V,R){var te=["ID;PWXL;N;E"],H=[],J=Ka(V["!ref"]),K,ne=Array.isArray(V),de=`\r
`;te.push("P;PGeneral"),te.push("F;P0;DG0G8;M255"),V["!cols"]&&M(te,V["!cols"]),V["!rows"]&&F(te,V["!rows"]),te.push("B;Y"+(J.e.r-J.s.r+1)+";X"+(J.e.c-J.s.c+1)+";D"+[J.s.c,J.s.r,J.e.c,J.e.r].join(" "));for(var De=J.s.r;De<=J.e.r;++De)for(var Fe=J.s.c;Fe<=J.e.c;++Fe){var et=xa({r:De,c:Fe});K=ne?(V[De]||[])[Fe]:V[et],!(!K||K.v==null&&(!K.f||K.F))&&H.push(A(K,V,De,Fe,R))}return te.join(de)+de+H.join(de)+de+"E"+de}return{to_workbook:T,to_sheet:x,from_sheet:W}}(),A6=function(){function a(i,x){switch(x.type){case"base64":return n(jd(i),x);case"binary":return n(i,x);case"buffer":return n(ta&&Buffer.isBuffer(i)?i.toString("binary"):Wg(i),x);case"array":return n(Ix(i),x)}throw new Error("Unrecognized type "+x.type)}function n(i,x){for(var T=i.split(`
`),A=-1,M=-1,F=0,W=[];F!==T.length;++F){if(T[F].trim()==="BOT"){W[++A]=[],M=0;continue}if(!(A<0)){var V=T[F].trim().split(","),R=V[0],te=V[1];++F;for(var H=T[F]||"";(H.match(/["]/g)||[]).length&1&&F<T.length-1;)H+=`
`+T[++F];switch(H=H.trim(),+R){case-1:if(H==="BOT"){W[++A]=[],M=0;continue}else if(H!=="EOD")throw new Error("Unrecognized DIF special command "+H);break;case 0:H==="TRUE"?W[A][M]=!0:H==="FALSE"?W[A][M]=!1:isNaN(Bd(te))?isNaN(Vg(te).getDate())?W[A][M]=te:W[A][M]=kl(te):W[A][M]=Bd(te),++M;break;case 1:H=H.slice(1,H.length-1),H=H.replace(/""/g,'"'),Mg&&H&&H.match(/^=".*"$/)&&(H=H.slice(2,-1)),W[A][M++]=H!==""?H:null;break}if(H==="EOD")break}}return x&&x.sheetRows&&(W=W.slice(0,x.sheetRows)),W}function l(i,x){return b0(a(i,x),x)}function c(i,x){return Xp(l(i,x),x)}var f=function(){var i=function(A,M,F,W,V){A.push(M),A.push(F+","+W),A.push('"'+V.replace(/"/g,'""')+'"')},x=function(A,M,F,W){A.push(M+","+F),A.push(M==1?'"'+W.replace(/"/g,'""')+'"':W)};return function(A){var M=[],F=Ka(A["!ref"]),W,V=Array.isArray(A);i(M,"TABLE",0,1,"sheetjs"),i(M,"VECTORS",0,F.e.r-F.s.r+1,""),i(M,"TUPLES",0,F.e.c-F.s.c+1,""),i(M,"DATA",0,0,"");for(var R=F.s.r;R<=F.e.r;++R){x(M,-1,0,"BOT");for(var te=F.s.c;te<=F.e.c;++te){var H=xa({r:R,c:te});if(W=V?(A[R]||[])[te]:A[H],!W){x(M,1,0,"");continue}switch(W.t){case"n":var J=Mg?W.w:W.v;!J&&W.v!=null&&(J=W.v),J==null?Mg&&W.f&&!W.F?x(M,1,0,"="+W.f):x(M,1,0,""):x(M,0,J,"V");break;case"b":x(M,0,W.v?1:0,W.v?"TRUE":"FALSE");break;case"s":x(M,1,0,!Mg||isNaN(W.v)?W.v:'="'+W.v+'"');break;case"d":W.w||(W.w=Hf(W.z||So[14],tc(kl(W.v)))),Mg?x(M,0,W.w,"V"):x(M,1,0,W.w);break;default:x(M,1,0,"")}}}x(M,-1,0,"EOD");var K=`\r
`,ne=M.join(K);return ne}}();return{to_workbook:c,to_sheet:l,from_sheet:f}}(),MC=function(){function a(W){return W.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(W){return W.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function l(W,V){for(var R=W.split(`
`),te=-1,H=-1,J=0,K=[];J!==R.length;++J){var ne=R[J].trim().split(":");if(ne[0]==="cell"){var de=Es(ne[1]);if(K.length<=de.r)for(te=K.length;te<=de.r;++te)K[te]||(K[te]=[]);switch(te=de.r,H=de.c,ne[2]){case"t":K[te][H]=a(ne[3]);break;case"v":K[te][H]=+ne[3];break;case"vtf":var De=ne[ne.length-1];case"vtc":switch(ne[3]){case"nl":K[te][H]=!!+ne[4];break;default:K[te][H]=+ne[4];break}ne[2]=="vtf"&&(K[te][H]=[K[te][H],De])}}}return V&&V.sheetRows&&(K=K.slice(0,V.sheetRows)),K}function c(W,V){return b0(l(W,V),V)}function f(W,V){return Xp(c(W,V),V)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),x=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,T=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),A="--SocialCalcSpreadsheetControlSave--";function M(W){if(!W||!W["!ref"])return"";for(var V=[],R=[],te,H="",J=Rc(W["!ref"]),K=Array.isArray(W),ne=J.s.r;ne<=J.e.r;++ne)for(var de=J.s.c;de<=J.e.c;++de)if(H=xa({r:ne,c:de}),te=K?(W[ne]||[])[de]:W[H],!(!te||te.v==null||te.t==="z")){switch(R=["cell",H,"t"],te.t){case"s":case"str":R.push(n(te.v));break;case"n":te.f?(R[2]="vtf",R[3]="n",R[4]=te.v,R[5]=n(te.f)):(R[2]="v",R[3]=te.v);break;case"b":R[2]="vt"+(te.f?"f":"c"),R[3]="nl",R[4]=te.v?"1":"0",R[5]=n(te.f||(te.v?"TRUE":"FALSE"));break;case"d":var De=tc(kl(te.v));R[2]="vtc",R[3]="nd",R[4]=""+De,R[5]=te.w||Hf(te.z||So[14],De);break;case"e":continue}V.push(R.join(":"))}return V.push("sheet:c:"+(J.e.c-J.s.c+1)+":r:"+(J.e.r-J.s.r+1)+":tvf:1"),V.push("valueformat:1:text-wiki"),V.join(`
`)}function F(W){return[i,x,T,x,M(W),A].join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:F}}(),C6=function(){function a(F,W,V,R,te){te.raw?W[V][R]=F:F===""||(F==="TRUE"?W[V][R]=!0:F==="FALSE"?W[V][R]=!1:isNaN(Bd(F))?isNaN(Vg(F).getDate())?W[V][R]=F:W[V][R]=kl(F):W[V][R]=Bd(F))}function n(F,W){var V=W||{},R=[];if(!F||F.length===0)return R;for(var te=F.split(/[\r\n]/),H=te.length-1;H>=0&&te[H].length===0;)--H;for(var J=10,K=0,ne=0;ne<=H;++ne)K=te[ne].indexOf(" "),K==-1?K=te[ne].length:K++,J=Math.max(J,K);for(ne=0;ne<=H;++ne){R[ne]=[];var de=0;for(a(te[ne].slice(0,J).trim(),R,ne,de,V),de=1;de<=(te[ne].length-J)/10+1;++de)a(te[ne].slice(J+(de-1)*10,J+de*10).trim(),R,ne,de,V)}return V.sheetRows&&(R=R.slice(0,V.sheetRows)),R}var l={44:",",9:"	",59:";",124:"|"},c={44:3,9:2,59:1,124:0};function f(F){for(var W={},V=!1,R=0,te=0;R<F.length;++R)(te=F.charCodeAt(R))==34?V=!V:!V&&te in l&&(W[te]=(W[te]||0)+1);te=[];for(R in W)Object.prototype.hasOwnProperty.call(W,R)&&te.push([W[R],R]);if(!te.length){W=c;for(R in W)Object.prototype.hasOwnProperty.call(W,R)&&te.push([W[R],R])}return te.sort(function(H,J){return H[0]-J[0]||c[H[1]]-c[J[1]]}),l[te.pop()[1]]||44}function i(F,W){var V=W||{},R="";Hh!=null&&V.dense==null&&(V.dense=Hh);var te=V.dense?[]:{},H={s:{c:0,r:0},e:{c:0,r:0}};F.slice(0,4)=="sep="?F.charCodeAt(5)==13&&F.charCodeAt(6)==10?(R=F.charAt(4),F=F.slice(7)):F.charCodeAt(5)==13||F.charCodeAt(5)==10?(R=F.charAt(4),F=F.slice(6)):R=f(F.slice(0,1024)):V&&V.FS?R=V.FS:R=f(F.slice(0,1024));var J=0,K=0,ne=0,de=0,De=0,Fe=R.charCodeAt(0),et=!1,Te=0,ge=F.charCodeAt(0);F=F.replace(/\r\n/mg,`
`);var Ve=V.dateNF!=null?UL(V.dateNF):null;function Ae(){var _e=F.slice(de,De),xe={};if(_e.charAt(0)=='"'&&_e.charAt(_e.length-1)=='"'&&(_e=_e.slice(1,-1).replace(/""/g,'"')),_e.length===0)xe.t="z";else if(V.raw)xe.t="s",xe.v=_e;else if(_e.trim().length===0)xe.t="s",xe.v=_e;else if(_e.charCodeAt(0)==61)_e.charCodeAt(1)==34&&_e.charCodeAt(_e.length-1)==34?(xe.t="s",xe.v=_e.slice(2,-1).replace(/""/g,'"')):EO(_e)?(xe.t="n",xe.f=_e.slice(1)):(xe.t="s",xe.v=_e);else if(_e=="TRUE")xe.t="b",xe.v=!0;else if(_e=="FALSE")xe.t="b",xe.v=!1;else if(!isNaN(ne=Bd(_e)))xe.t="n",V.cellText!==!1&&(xe.w=_e),xe.v=ne;else if(!isNaN(Vg(_e).getDate())||Ve&&_e.match(Ve)){xe.z=V.dateNF||So[14];var Qe=0;Ve&&_e.match(Ve)&&(_e=HL(_e,V.dateNF,_e.match(Ve)||[]),Qe=1),V.cellDates?(xe.t="d",xe.v=kl(_e,Qe)):(xe.t="n",xe.v=tc(kl(_e,Qe))),V.cellText!==!1&&(xe.w=Hf(xe.z,xe.v instanceof Date?tc(xe.v):xe.v)),V.cellNF||delete xe.z}else xe.t="s",xe.v=_e;if(xe.t=="z"||(V.dense?(te[J]||(te[J]=[]),te[J][K]=xe):te[xa({c:K,r:J})]=xe),de=De+1,ge=F.charCodeAt(de),H.e.c<K&&(H.e.c=K),H.e.r<J&&(H.e.r=J),Te==Fe)++K;else if(K=0,++J,V.sheetRows&&V.sheetRows<=J)return!0}e:for(;De<F.length;++De)switch(Te=F.charCodeAt(De)){case 34:ge===34&&(et=!et);break;case Fe:case 10:case 13:if(!et&&Ae())break e;break;default:break}return De-de>0&&Ae(),te["!ref"]=$o(H),te}function x(F,W){return!(W&&W.PRN)||W.FS||F.slice(0,4)=="sep="||F.indexOf("	")>=0||F.indexOf(",")>=0||F.indexOf(";")>=0?i(F,W):b0(n(F,W),W)}function T(F,W){var V="",R=W.type=="string"?[0,0,0,0]:zz(F,W);switch(W.type){case"base64":V=jd(F);break;case"binary":V=F;break;case"buffer":W.codepage==65001?V=F.toString("utf8"):W.codepage&&typeof Fa<"u"?V=Fa.utils.decode(W.codepage,F):V=ta&&Buffer.isBuffer(F)?F.toString("binary"):Wg(F);break;case"array":V=Ix(F);break;case"string":V=F;break;default:throw new Error("Unrecognized type "+W.type)}return R[0]==239&&R[1]==187&&R[2]==191?V=Pg(V.slice(3)):W.type!="string"&&W.type!="buffer"&&W.codepage==65001?V=Pg(V):W.type=="binary"&&typeof Fa<"u"&&W.codepage&&(V=Fa.utils.decode(W.codepage,Fa.utils.encode(28591,V))),V.slice(0,19)=="socialcalc:version:"?MC.to_sheet(W.type=="string"?V:Pg(V),W):x(V,W)}function A(F,W){return Xp(T(F,W),W)}function M(F){for(var W=[],V=Ka(F["!ref"]),R,te=Array.isArray(F),H=V.s.r;H<=V.e.r;++H){for(var J=[],K=V.s.c;K<=V.e.c;++K){var ne=xa({r:H,c:K});if(R=te?(F[H]||[])[K]:F[ne],!R||R.v==null){J.push("          ");continue}for(var de=(R.w||(Vd(R),R.w)||"").slice(0,10);de.length<10;)de+=" ";J.push(de+(K===0?" ":""))}W.push(J.join(""))}return W.join(`
`)}return{to_workbook:A,to_sheet:T,from_sheet:M}}();var I3=function(){function a(ie,ye,pe){if(ie){Pc(ie,ie.l||0);for(var Ie=pe.Enum||ht;ie.l<ie.length;){var Ue=ie.read_shift(2),gt=Ie[Ue]||Ie[65535],mt=ie.read_shift(2),wt=ie.l+mt,Lt=gt.f&&gt.f(ie,mt,pe);if(ie.l=wt,ye(Lt,gt,Ue))return}}}function n(ie,ye){switch(ye.type){case"base64":return l(Qu(jd(ie)),ye);case"binary":return l(Qu(ie),ye);case"buffer":case"array":return l(ie,ye)}throw"Unsupported type "+ye.type}function l(ie,ye){if(!ie)return ie;var pe=ye||{};Hh!=null&&pe.dense==null&&(pe.dense=Hh);var Ie=pe.dense?[]:{},Ue="Sheet1",gt="",mt=0,wt={},Lt=[],fi=[],yi={s:{r:0,c:0},e:{r:0,c:0}},Fi=pe.sheetRows||0;if(ie[2]==0&&(ie[3]==8||ie[3]==9)&&ie.length>=16&&ie[14]==5&&ie[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(ie[2]==2)pe.Enum=ht,a(ie,function(Bt,ni,bi){switch(bi){case 0:pe.vers=Bt,Bt>=4096&&(pe.qpro=!0);break;case 6:yi=Bt;break;case 204:Bt&&(gt=Bt);break;case 222:gt=Bt;break;case 15:case 51:pe.qpro||(Bt[1].v=Bt[1].v.slice(1));case 13:case 14:case 16:bi==14&&(Bt[2]&112)==112&&(Bt[2]&15)>1&&(Bt[2]&15)<15&&(Bt[1].z=pe.dateNF||So[14],pe.cellDates&&(Bt[1].t="d",Bt[1].v=J3(Bt[1].v))),pe.qpro&&Bt[3]>mt&&(Ie["!ref"]=$o(yi),wt[Ue]=Ie,Lt.push(Ue),Ie=pe.dense?[]:{},yi={s:{r:0,c:0},e:{r:0,c:0}},mt=Bt[3],Ue=gt||"Sheet"+(mt+1),gt="");var ki=pe.dense?(Ie[Bt[0].r]||[])[Bt[0].c]:Ie[xa(Bt[0])];if(ki){ki.t=Bt[1].t,ki.v=Bt[1].v,Bt[1].z!=null&&(ki.z=Bt[1].z),Bt[1].f!=null&&(ki.f=Bt[1].f);break}pe.dense?(Ie[Bt[0].r]||(Ie[Bt[0].r]=[]),Ie[Bt[0].r][Bt[0].c]=Bt[1]):Ie[xa(Bt[0])]=Bt[1];break;default:}},pe);else if(ie[2]==26||ie[2]==14)pe.Enum=Wt,ie[2]==14&&(pe.qpro=!0,ie.l=0),a(ie,function(Bt,ni,bi){switch(bi){case 204:Ue=Bt;break;case 22:Bt[1].v=Bt[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Bt[3]>mt&&(Ie["!ref"]=$o(yi),wt[Ue]=Ie,Lt.push(Ue),Ie=pe.dense?[]:{},yi={s:{r:0,c:0},e:{r:0,c:0}},mt=Bt[3],Ue="Sheet"+(mt+1)),Fi>0&&Bt[0].r>=Fi)break;pe.dense?(Ie[Bt[0].r]||(Ie[Bt[0].r]=[]),Ie[Bt[0].r][Bt[0].c]=Bt[1]):Ie[xa(Bt[0])]=Bt[1],yi.e.c<Bt[0].c&&(yi.e.c=Bt[0].c),yi.e.r<Bt[0].r&&(yi.e.r=Bt[0].r);break;case 27:Bt[14e3]&&(fi[Bt[14e3][0]]=Bt[14e3][1]);break;case 1537:fi[Bt[0]]=Bt[1],Bt[0]==mt&&(Ue=Bt[1]);break;default:break}},pe);else throw new Error("Unrecognized LOTUS BOF "+ie[2]);if(Ie["!ref"]=$o(yi),wt[gt||Ue]=Ie,Lt.push(gt||Ue),!fi.length)return{SheetNames:Lt,Sheets:wt};for(var Pi={},$t=[],lt=0;lt<fi.length;++lt)wt[Lt[lt]]?($t.push(fi[lt]||Lt[lt]),Pi[fi[lt]]=wt[fi[lt]]||wt[Lt[lt]]):($t.push(fi[lt]),Pi[fi[lt]]={"!ref":"A1"});return{SheetNames:$t,Sheets:Pi}}function c(ie,ye){var pe=ye||{};if(+pe.codepage>=0&&zg(+pe.codepage),pe.type=="string")throw new Error("Cannot write WK1 to JS string");var Ie=ec(),Ue=Ka(ie["!ref"]),gt=Array.isArray(ie),mt=[];Ui(Ie,0,i(1030)),Ui(Ie,6,A(Ue));for(var wt=Math.min(Ue.e.r,8191),Lt=Ue.s.r;Lt<=wt;++Lt)for(var fi=Gs(Lt),yi=Ue.s.c;yi<=Ue.e.c;++yi){Lt===Ue.s.r&&(mt[yi]=ol(yi));var Fi=mt[yi]+fi,Pi=gt?(ie[Lt]||[])[yi]:ie[Fi];if(!(!Pi||Pi.t=="z"))if(Pi.t=="n")(Pi.v|0)==Pi.v&&Pi.v>=-32768&&Pi.v<=32767?Ui(Ie,13,R(Lt,yi,Pi.v)):Ui(Ie,14,H(Lt,yi,Pi.v));else{var $t=Vd(Pi);Ui(Ie,15,W(Lt,yi,$t.slice(0,239)))}}return Ui(Ie,1),Ie.end()}function f(ie,ye){var pe=ye||{};if(+pe.codepage>=0&&zg(+pe.codepage),pe.type=="string")throw new Error("Cannot write WK3 to JS string");var Ie=ec();Ui(Ie,0,x(ie));for(var Ue=0,gt=0;Ue<ie.SheetNames.length;++Ue)(ie.Sheets[ie.SheetNames[Ue]]||{})["!ref"]&&Ui(Ie,27,Tt(ie.SheetNames[Ue],gt++));var mt=0;for(Ue=0;Ue<ie.SheetNames.length;++Ue){var wt=ie.Sheets[ie.SheetNames[Ue]];if(!(!wt||!wt["!ref"])){for(var Lt=Ka(wt["!ref"]),fi=Array.isArray(wt),yi=[],Fi=Math.min(Lt.e.r,8191),Pi=Lt.s.r;Pi<=Fi;++Pi)for(var $t=Gs(Pi),lt=Lt.s.c;lt<=Lt.e.c;++lt){Pi===Lt.s.r&&(yi[lt]=ol(lt));var Bt=yi[lt]+$t,ni=fi?(wt[Pi]||[])[lt]:wt[Bt];if(!(!ni||ni.t=="z"))if(ni.t=="n")Ui(Ie,23,Ae(Pi,lt,mt,ni.v));else{var bi=Vd(ni);Ui(Ie,22,Te(Pi,lt,mt,bi.slice(0,239)))}}++mt}}return Ui(Ie,1),Ie.end()}function i(ie){var ye=ci(2);return ye.write_shift(2,ie),ye}function x(ie){var ye=ci(26);ye.write_shift(2,4096),ye.write_shift(2,4),ye.write_shift(4,0);for(var pe=0,Ie=0,Ue=0,gt=0;gt<ie.SheetNames.length;++gt){var mt=ie.SheetNames[gt],wt=ie.Sheets[mt];if(!(!wt||!wt["!ref"])){++Ue;var Lt=Rc(wt["!ref"]);pe<Lt.e.r&&(pe=Lt.e.r),Ie<Lt.e.c&&(Ie=Lt.e.c)}}return pe>8191&&(pe=8191),ye.write_shift(2,pe),ye.write_shift(1,Ue),ye.write_shift(1,Ie),ye.write_shift(2,0),ye.write_shift(2,0),ye.write_shift(1,1),ye.write_shift(1,2),ye.write_shift(4,0),ye.write_shift(4,0),ye}function T(ie,ye,pe){var Ie={s:{c:0,r:0},e:{c:0,r:0}};return ye==8&&pe.qpro?(Ie.s.c=ie.read_shift(1),ie.l++,Ie.s.r=ie.read_shift(2),Ie.e.c=ie.read_shift(1),ie.l++,Ie.e.r=ie.read_shift(2),Ie):(Ie.s.c=ie.read_shift(2),Ie.s.r=ie.read_shift(2),ye==12&&pe.qpro&&(ie.l+=2),Ie.e.c=ie.read_shift(2),Ie.e.r=ie.read_shift(2),ye==12&&pe.qpro&&(ie.l+=2),Ie.s.c==65535&&(Ie.s.c=Ie.e.c=Ie.s.r=Ie.e.r=0),Ie)}function A(ie){var ye=ci(8);return ye.write_shift(2,ie.s.c),ye.write_shift(2,ie.s.r),ye.write_shift(2,ie.e.c),ye.write_shift(2,ie.e.r),ye}function M(ie,ye,pe){var Ie=[{c:0,r:0},{t:"n",v:0},0,0];return pe.qpro&&pe.vers!=20768?(Ie[0].c=ie.read_shift(1),Ie[3]=ie.read_shift(1),Ie[0].r=ie.read_shift(2),ie.l+=2):(Ie[2]=ie.read_shift(1),Ie[0].c=ie.read_shift(2),Ie[0].r=ie.read_shift(2)),Ie}function F(ie,ye,pe){var Ie=ie.l+ye,Ue=M(ie,ye,pe);if(Ue[1].t="s",pe.vers==20768){ie.l++;var gt=ie.read_shift(1);return Ue[1].v=ie.read_shift(gt,"utf8"),Ue}return pe.qpro&&ie.l++,Ue[1].v=ie.read_shift(Ie-ie.l,"cstr"),Ue}function W(ie,ye,pe){var Ie=ci(7+pe.length);Ie.write_shift(1,255),Ie.write_shift(2,ye),Ie.write_shift(2,ie),Ie.write_shift(1,39);for(var Ue=0;Ue<Ie.length;++Ue){var gt=pe.charCodeAt(Ue);Ie.write_shift(1,gt>=128?95:gt)}return Ie.write_shift(1,0),Ie}function V(ie,ye,pe){var Ie=M(ie,ye,pe);return Ie[1].v=ie.read_shift(2,"i"),Ie}function R(ie,ye,pe){var Ie=ci(7);return Ie.write_shift(1,255),Ie.write_shift(2,ye),Ie.write_shift(2,ie),Ie.write_shift(2,pe,"i"),Ie}function te(ie,ye,pe){var Ie=M(ie,ye,pe);return Ie[1].v=ie.read_shift(8,"f"),Ie}function H(ie,ye,pe){var Ie=ci(13);return Ie.write_shift(1,255),Ie.write_shift(2,ye),Ie.write_shift(2,ie),Ie.write_shift(8,pe,"f"),Ie}function J(ie,ye,pe){var Ie=ie.l+ye,Ue=M(ie,ye,pe);if(Ue[1].v=ie.read_shift(8,"f"),pe.qpro)ie.l=Ie;else{var gt=ie.read_shift(2);De(ie.slice(ie.l,ie.l+gt),Ue),ie.l+=gt}return Ue}function K(ie,ye,pe){var Ie=ye&32768;return ye&=-32769,ye=(Ie?ie:0)+(ye>=8192?ye-16384:ye),(Ie?"":"$")+(pe?ol(ye):Gs(ye))}var ne={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},de=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function De(ie,ye){Pc(ie,0);for(var pe=[],Ie=0,Ue="",gt="",mt="",wt="";ie.l<ie.length;){var Lt=ie[ie.l++];switch(Lt){case 0:pe.push(ie.read_shift(8,"f"));break;case 1:gt=K(ye[0].c,ie.read_shift(2),!0),Ue=K(ye[0].r,ie.read_shift(2),!1),pe.push(gt+Ue);break;case 2:{var fi=K(ye[0].c,ie.read_shift(2),!0),yi=K(ye[0].r,ie.read_shift(2),!1);gt=K(ye[0].c,ie.read_shift(2),!0),Ue=K(ye[0].r,ie.read_shift(2),!1),pe.push(fi+yi+":"+gt+Ue)}break;case 3:if(ie.l<ie.length){console.error("WK1 premature formula end");return}break;case 4:pe.push("("+pe.pop()+")");break;case 5:pe.push(ie.read_shift(2));break;case 6:{for(var Fi="";Lt=ie[ie.l++];)Fi+=String.fromCharCode(Lt);pe.push('"'+Fi.replace(/"/g,'""')+'"')}break;case 8:pe.push("-"+pe.pop());break;case 23:pe.push("+"+pe.pop());break;case 22:pe.push("NOT("+pe.pop()+")");break;case 20:case 21:wt=pe.pop(),mt=pe.pop(),pe.push(["AND","OR"][Lt-20]+"("+mt+","+wt+")");break;default:if(Lt<32&&de[Lt])wt=pe.pop(),mt=pe.pop(),pe.push(mt+de[Lt]+wt);else if(ne[Lt]){if(Ie=ne[Lt][1],Ie==69&&(Ie=ie[ie.l++]),Ie>pe.length){console.error("WK1 bad formula parse 0x"+Lt.toString(16)+":|"+pe.join("|")+"|");return}var Pi=pe.slice(-Ie);pe.length-=Ie,pe.push(ne[Lt][0]+"("+Pi.join(",")+")")}else return Lt<=7?console.error("WK1 invalid opcode "+Lt.toString(16)):Lt<=24?console.error("WK1 unsupported op "+Lt.toString(16)):Lt<=30?console.error("WK1 invalid opcode "+Lt.toString(16)):Lt<=115?console.error("WK1 unsupported function opcode "+Lt.toString(16)):console.error("WK1 unrecognized opcode "+Lt.toString(16))}}pe.length==1?ye[1].f=""+pe[0]:console.error("WK1 bad formula parse |"+pe.join("|")+"|")}function Fe(ie){var ye=[{c:0,r:0},{t:"n",v:0},0];return ye[0].r=ie.read_shift(2),ye[3]=ie[ie.l++],ye[0].c=ie[ie.l++],ye}function et(ie,ye){var pe=Fe(ie,ye);return pe[1].t="s",pe[1].v=ie.read_shift(ye-4,"cstr"),pe}function Te(ie,ye,pe,Ie){var Ue=ci(6+Ie.length);Ue.write_shift(2,ie),Ue.write_shift(1,pe),Ue.write_shift(1,ye),Ue.write_shift(1,39);for(var gt=0;gt<Ie.length;++gt){var mt=Ie.charCodeAt(gt);Ue.write_shift(1,mt>=128?95:mt)}return Ue.write_shift(1,0),Ue}function ge(ie,ye){var pe=Fe(ie,ye);pe[1].v=ie.read_shift(2);var Ie=pe[1].v>>1;if(pe[1].v&1)switch(Ie&7){case 0:Ie=(Ie>>3)*5e3;break;case 1:Ie=(Ie>>3)*500;break;case 2:Ie=(Ie>>3)/20;break;case 3:Ie=(Ie>>3)/200;break;case 4:Ie=(Ie>>3)/2e3;break;case 5:Ie=(Ie>>3)/2e4;break;case 6:Ie=(Ie>>3)/16;break;case 7:Ie=(Ie>>3)/64;break}return pe[1].v=Ie,pe}function Ve(ie,ye){var pe=Fe(ie,ye),Ie=ie.read_shift(4),Ue=ie.read_shift(4),gt=ie.read_shift(2);if(gt==65535)return Ie===0&&Ue===3221225472?(pe[1].t="e",pe[1].v=15):Ie===0&&Ue===3489660928?(pe[1].t="e",pe[1].v=42):pe[1].v=0,pe;var mt=gt&32768;return gt=(gt&32767)-16446,pe[1].v=(1-mt*2)*(Ue*Math.pow(2,gt+32)+Ie*Math.pow(2,gt)),pe}function Ae(ie,ye,pe,Ie){var Ue=ci(14);if(Ue.write_shift(2,ie),Ue.write_shift(1,pe),Ue.write_shift(1,ye),Ie==0)return Ue.write_shift(4,0),Ue.write_shift(4,0),Ue.write_shift(2,65535),Ue;var gt=0,mt=0,wt=0,Lt=0;return Ie<0&&(gt=1,Ie=-Ie),mt=Math.log2(Ie)|0,Ie/=Math.pow(2,mt-31),Lt=Ie>>>0,Lt&2147483648||(Ie/=2,++mt,Lt=Ie>>>0),Ie-=Lt,Lt|=2147483648,Lt>>>=0,Ie*=Math.pow(2,32),wt=Ie>>>0,Ue.write_shift(4,wt),Ue.write_shift(4,Lt),mt+=16383+(gt?32768:0),Ue.write_shift(2,mt),Ue}function _e(ie,ye){var pe=Ve(ie,14);return ie.l+=ye-14,pe}function xe(ie,ye){var pe=Fe(ie,ye),Ie=ie.read_shift(4);return pe[1].v=Ie>>6,pe}function Qe(ie,ye){var pe=Fe(ie,ye),Ie=ie.read_shift(8,"f");return pe[1].v=Ie,pe}function Ce(ie,ye){var pe=Qe(ie,14);return ie.l+=ye-10,pe}function Ye(ie,ye){return ie[ie.l+ye-1]==0?ie.read_shift(ye,"cstr"):""}function ut(ie,ye){var pe=ie[ie.l++];pe>ye-1&&(pe=ye-1);for(var Ie="";Ie.length<pe;)Ie+=String.fromCharCode(ie[ie.l++]);return Ie}function st(ie,ye,pe){if(!(!pe.qpro||ye<21)){var Ie=ie.read_shift(1);ie.l+=17,ie.l+=1,ie.l+=2;var Ue=ie.read_shift(ye-21,"cstr");return[Ie,Ue]}}function pt(ie,ye){for(var pe={},Ie=ie.l+ye;ie.l<Ie;){var Ue=ie.read_shift(2);if(Ue==14e3){for(pe[Ue]=[0,""],pe[Ue][0]=ie.read_shift(2);ie[ie.l];)pe[Ue][1]+=String.fromCharCode(ie[ie.l]),ie.l++;ie.l++}}return pe}function Tt(ie,ye){var pe=ci(5+ie.length);pe.write_shift(2,14e3),pe.write_shift(2,ye);for(var Ie=0;Ie<ie.length;++Ie){var Ue=ie.charCodeAt(Ie);pe[pe.l++]=Ue>127?95:Ue}return pe[pe.l++]=0,pe}var ht={0:{n:"BOF",f:EC},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:T},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:V},14:{n:"NUMBER",f:te},15:{n:"LABEL",f:F},16:{n:"FORMULA",f:J},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:F},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ye},222:{n:"SHEETNAMELP",f:ut},65535:{n:""}},Wt={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:et},23:{n:"NUMBER17",f:Ve},24:{n:"NUMBER18",f:ge},25:{n:"FORMULA19",f:_e},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:pt},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:xe},38:{n:"??"},39:{n:"NUMBER27",f:Qe},40:{n:"FORMULA28",f:Ce},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ye},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:st},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:c,book_to_wk3:f,to_workbook:n}}();var I6=/^\s|\s$|[\t\n\r]/;function DC(a,n){if(!n.bookSST)return"";var l=[Xo];l[l.length]=Vi("sst",null,{xmlns:v0[0],count:a.Count,uniqueCount:a.Unique});for(var c=0;c!=a.length;++c)if(a[c]!=null){var f=a[c],i="<si>";f.r?i+=f.r:(i+="<t",f.t||(f.t=""),f.t.match(I6)&&(i+=' xml:space="preserve"'),i+=">"+_a(f.t)+"</t>"),i+="</si>",l[l.length]=i}return l.length>2&&(l[l.length]="</sst>",l[1]=l[1].replace("/>",">")),l.join("")}function k6(a){return[a.read_shift(4),a.read_shift(4)]}function M6(a,n){return n||(n=ci(8)),n.write_shift(4,a.Count),n.write_shift(4,a.Unique),n}var D6=bR;function F6(a){var n=ec();Ii(n,159,M6(a));for(var l=0;l<a.length;++l)Ii(n,19,D6(a[l]));return Ii(n,160),n.end()}function P6(a){if(typeof Fa<"u")return Fa.utils.encode(_0,a);for(var n=[],l=a.split(""),c=0;c<l.length;++c)n[c]=l[c].charCodeAt(0);return n}function FC(a){var n=0,l,c=P6(a),f=c.length+1,i,x,T,A,M;for(l=Wp(f),l[0]=c.length,i=1;i!=f;++i)l[i]=c[i-1];for(i=f-1;i>=0;--i)x=l[i],T=n&16384?1:0,A=n<<1&32767,M=T|A,n=M^x;return n^52811}var L6=function(){function a(f,i){switch(i.type){case"base64":return n(jd(f),i);case"binary":return n(f,i);case"buffer":return n(ta&&Buffer.isBuffer(f)?f.toString("binary"):Wg(f),i);case"array":return n(Ix(f),i)}throw new Error("Unrecognized type "+i.type)}function n(f,i){var x=i||{},T=x.dense?[]:{},A=f.match(/\\trowd.*?\\row\b/g);if(!A.length)throw new Error("RTF missing table");var M={s:{c:0,r:0},e:{c:0,r:A.length-1}};return A.forEach(function(F,W){Array.isArray(T)&&(T[W]=[]);for(var V=/\\\w+\b/g,R=0,te,H=-1;te=V.exec(F);){switch(te[0]){case"\\cell":var J=F.slice(R,V.lastIndex-te[0].length);if(J[0]==" "&&(J=J.slice(1)),++H,J.length){var K={v:J,t:"s"};Array.isArray(T)?T[W][H]=K:T[xa({r:W,c:H})]=K}break}R=V.lastIndex}H>M.e.c&&(M.e.c=H)}),T["!ref"]=$o(M),T}function l(f,i){return Xp(a(f,i),i)}function c(f){for(var i=["{\\rtf1\\ansi"],x=Ka(f["!ref"]),T,A=Array.isArray(f),M=x.s.r;M<=x.e.r;++M){i.push("\\trowd\\trautofit1");for(var F=x.s.c;F<=x.e.c;++F)i.push("\\cellx"+(F+1));for(i.push("\\pard\\intbl"),F=x.s.c;F<=x.e.c;++F){var W=xa({r:M,c:F});T=A?(f[M]||[])[F]:f[W],!(!T||T.v==null&&(!T.f||T.F))&&(i.push(" "+(T.w||(Vd(T),T.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:l,to_sheet:a,from_sheet:c}}();function k3(a){for(var n=0,l=1;n!=3;++n)l=l*256+(a[n]>255?255:a[n]<0?0:a[n]);return l.toString(16).toUpperCase().slice(1)}var R6=6;var zd=R6;function vx(a){return Math.floor((a+Math.round(128/zd)/256)*zd)}function yx(a){return Math.floor((a-5)/zd*100+.5)/100}function $b(a){return Math.round((a*zd+5)/zd*256)/256}function d2(a){a.width?(a.wpx=vx(a.width),a.wch=yx(a.wpx),a.MDW=zd):a.wpx?(a.wch=yx(a.wpx),a.width=$b(a.wch),a.MDW=zd):typeof a.wch=="number"&&(a.width=$b(a.wch),a.wpx=vx(a.width),a.MDW=zd),a.customWidth&&delete a.customWidth}var O6=96,PC=O6;function bx(a){return a*96/PC}function LC(a){return a*PC/96}function N6(a){var n=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(l){for(var c=l[0];c<=l[1];++c)a[c]!=null&&(n[n.length]=Vi("numFmt",null,{numFmtId:c,formatCode:_a(a[c])}))}),n.length===1?"":(n[n.length]="</numFmts>",n[0]=Vi("numFmts",null,{count:n.length-2}).replace("/>",">"),n.join(""))}function B6(a){var n=[];return n[n.length]=Vi("cellXfs",null),a.forEach(function(l){n[n.length]=Vi("xf",null,l)}),n[n.length]="</cellXfs>",n.length===2?"":(n[0]=Vi("cellXfs",null,{count:n.length-2}).replace("/>",">"),n.join(""))}function RC(a,n){var l=[Xo,Vi("styleSheet",null,{xmlns:v0[0],"xmlns:vt":Ss.vt})],c;return a.SSF&&(c=N6(a.SSF))!=null&&(l[l.length]=c),l[l.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',l[l.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',l[l.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',l[l.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(c=B6(n.cellXfs))&&(l[l.length]=c),l[l.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',l[l.length]='<dxfs count="0"/>',l[l.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',l.length>2&&(l[l.length]="</styleSheet>",l[1]=l[1].replace("/>",">")),l.join("")}function z6(a,n){var l=a.read_shift(2),c=sl(a,n-2);return[l,c]}function j6(a,n,l){l||(l=ci(6+4*n.length)),l.write_shift(2,a),As(n,l);var c=l.length>l.l?l.slice(0,l.l):l;return l.l==null&&(l.l=l.length),c}function V6(a,n,l){var c={};c.sz=a.read_shift(2)/20;var f=IR(a,2,l);f.fItalic&&(c.italic=1),f.fCondense&&(c.condense=1),f.fExtend&&(c.extend=1),f.fShadow&&(c.shadow=1),f.fOutline&&(c.outline=1),f.fStrikeout&&(c.strike=1);var i=a.read_shift(2);switch(i===700&&(c.bold=1),a.read_shift(2)){case 1:c.vertAlign="superscript";break;case 2:c.vertAlign="subscript";break}var x=a.read_shift(1);x!=0&&(c.underline=x);var T=a.read_shift(1);T>0&&(c.family=T);var A=a.read_shift(1);switch(A>0&&(c.charset=A),a.l++,c.color=CR(a,8),a.read_shift(1)){case 1:c.scheme="major";break;case 2:c.scheme="minor";break}return c.name=sl(a,n-21),c}function U6(a,n){n||(n=ci(25+4*32)),n.write_shift(2,a.sz*20),kR(a,n),n.write_shift(2,a.bold?700:400);var l=0;a.vertAlign=="superscript"?l=1:a.vertAlign=="subscript"&&(l=2),n.write_shift(2,l),n.write_shift(1,a.underline||0),n.write_shift(1,a.family||0),n.write_shift(1,a.charset||0),n.write_shift(1,0),_x(a.color,n);var c=0;return a.scheme=="major"&&(c=1),a.scheme=="minor"&&(c=2),n.write_shift(1,c),As(a.name,n),n.length>n.l?n.slice(0,n.l):n}var H6=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],jb,G6=Gh;function M3(a,n){n||(n=ci(4*3+8*7+16*1)),jb||(jb=Yb(H6));var l=jb[a.patternType];l==null&&(l=40),n.write_shift(4,l);var c=0;if(l!=40)for(_x({auto:1},n),_x({auto:1},n);c<12;++c)n.write_shift(4,0);else{for(;c<4;++c)n.write_shift(4,0);for(;c<12;++c)n.write_shift(4,0)}return n.length>n.l?n.slice(0,n.l):n}function W6(a,n){var l=a.l+n,c=a.read_shift(2),f=a.read_shift(2);return a.l=l,{ixfe:c,numFmtId:f}}function OC(a,n,l){l||(l=ci(16)),l.write_shift(2,n||0),l.write_shift(2,a.numFmtId||0),l.write_shift(2,0),l.write_shift(2,0),l.write_shift(2,0),l.write_shift(1,0),l.write_shift(1,0);var c=0;return l.write_shift(1,c),l.write_shift(1,0),l.write_shift(1,0),l.write_shift(1,0),l}function Dg(a,n){return n||(n=ci(10)),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(4,0),n}var q6=Gh;function $6(a,n){return n||(n=ci(51)),n.write_shift(1,0),Dg(null,n),Dg(null,n),Dg(null,n),Dg(null,n),Dg(null,n),n.length>n.l?n.slice(0,n.l):n}function X6(a,n){return n||(n=ci(12+4*10)),n.write_shift(4,a.xfId),n.write_shift(2,1),n.write_shift(1,+a.builtinId),n.write_shift(1,0),gx(a.name||"",n),n.length>n.l?n.slice(0,n.l):n}function Z6(a,n,l){var c=ci(2052);return c.write_shift(4,a),gx(n,c),gx(l,c),c.length>c.l?c.slice(0,c.l):c}function Y6(a,n){if(n){var l=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(c){for(var f=c[0];f<=c[1];++f)n[f]!=null&&++l}),l!=0&&(Ii(a,615,th(l)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(c){for(var f=c[0];f<=c[1];++f)n[f]!=null&&Ii(a,44,j6(f,n[f]))}),Ii(a,616))}}function K6(a){var n=1;n!=0&&(Ii(a,611,th(n)),Ii(a,43,U6({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Ii(a,612))}function J6(a){var n=2;n!=0&&(Ii(a,603,th(n)),Ii(a,45,M3({patternType:"none"})),Ii(a,45,M3({patternType:"gray125"})),Ii(a,604))}function Q6(a){var n=1;n!=0&&(Ii(a,613,th(n)),Ii(a,46,$6({})),Ii(a,614))}function eO(a){var n=1;Ii(a,626,th(n)),Ii(a,47,OC({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Ii(a,627)}function tO(a,n){Ii(a,617,th(n.length)),n.forEach(function(l){Ii(a,47,OC(l,0))}),Ii(a,618)}function iO(a){var n=1;Ii(a,619,th(n)),Ii(a,48,X6({xfId:0,builtinId:0,name:"Normal"})),Ii(a,620)}function rO(a){var n=0;Ii(a,505,th(n)),Ii(a,506)}function nO(a){var n=0;Ii(a,508,Z6(n,"TableStyleMedium9","PivotStyleMedium4")),Ii(a,509)}function aO(a,n){var l=ec();return Ii(l,278),Y6(l,a.SSF),K6(l,a),J6(l,a),Q6(l,a),eO(l,a),tO(l,n.cellXfs),iO(l,a),rO(l,a),nO(l,a),Ii(l,279),l.end()}function NC(a,n){if(n&&n.themeXLSX)return n.themeXLSX;if(a&&typeof a.raw=="string")return a.raw;var l=[Xo];return l[l.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',l[l.length]="<a:themeElements>",l[l.length]='<a:clrScheme name="Office">',l[l.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',l[l.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',l[l.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',l[l.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',l[l.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',l[l.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',l[l.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',l[l.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',l[l.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',l[l.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',l[l.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',l[l.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',l[l.length]="</a:clrScheme>",l[l.length]='<a:fontScheme name="Office">',l[l.length]="<a:majorFont>",l[l.length]='<a:latin typeface="Cambria"/>',l[l.length]='<a:ea typeface=""/>',l[l.length]='<a:cs typeface=""/>',l[l.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',l[l.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',l[l.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',l[l.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',l[l.length]='<a:font script="Arab" typeface="Times New Roman"/>',l[l.length]='<a:font script="Hebr" typeface="Times New Roman"/>',l[l.length]='<a:font script="Thai" typeface="Tahoma"/>',l[l.length]='<a:font script="Ethi" typeface="Nyala"/>',l[l.length]='<a:font script="Beng" typeface="Vrinda"/>',l[l.length]='<a:font script="Gujr" typeface="Shruti"/>',l[l.length]='<a:font script="Khmr" typeface="MoolBoran"/>',l[l.length]='<a:font script="Knda" typeface="Tunga"/>',l[l.length]='<a:font script="Guru" typeface="Raavi"/>',l[l.length]='<a:font script="Cans" typeface="Euphemia"/>',l[l.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',l[l.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',l[l.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',l[l.length]='<a:font script="Thaa" typeface="MV Boli"/>',l[l.length]='<a:font script="Deva" typeface="Mangal"/>',l[l.length]='<a:font script="Telu" typeface="Gautami"/>',l[l.length]='<a:font script="Taml" typeface="Latha"/>',l[l.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',l[l.length]='<a:font script="Orya" typeface="Kalinga"/>',l[l.length]='<a:font script="Mlym" typeface="Kartika"/>',l[l.length]='<a:font script="Laoo" typeface="DokChampa"/>',l[l.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',l[l.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',l[l.length]='<a:font script="Viet" typeface="Times New Roman"/>',l[l.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',l[l.length]='<a:font script="Geor" typeface="Sylfaen"/>',l[l.length]="</a:majorFont>",l[l.length]="<a:minorFont>",l[l.length]='<a:latin typeface="Calibri"/>',l[l.length]='<a:ea typeface=""/>',l[l.length]='<a:cs typeface=""/>',l[l.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',l[l.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',l[l.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',l[l.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',l[l.length]='<a:font script="Arab" typeface="Arial"/>',l[l.length]='<a:font script="Hebr" typeface="Arial"/>',l[l.length]='<a:font script="Thai" typeface="Tahoma"/>',l[l.length]='<a:font script="Ethi" typeface="Nyala"/>',l[l.length]='<a:font script="Beng" typeface="Vrinda"/>',l[l.length]='<a:font script="Gujr" typeface="Shruti"/>',l[l.length]='<a:font script="Khmr" typeface="DaunPenh"/>',l[l.length]='<a:font script="Knda" typeface="Tunga"/>',l[l.length]='<a:font script="Guru" typeface="Raavi"/>',l[l.length]='<a:font script="Cans" typeface="Euphemia"/>',l[l.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',l[l.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',l[l.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',l[l.length]='<a:font script="Thaa" typeface="MV Boli"/>',l[l.length]='<a:font script="Deva" typeface="Mangal"/>',l[l.length]='<a:font script="Telu" typeface="Gautami"/>',l[l.length]='<a:font script="Taml" typeface="Latha"/>',l[l.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',l[l.length]='<a:font script="Orya" typeface="Kalinga"/>',l[l.length]='<a:font script="Mlym" typeface="Kartika"/>',l[l.length]='<a:font script="Laoo" typeface="DokChampa"/>',l[l.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',l[l.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',l[l.length]='<a:font script="Viet" typeface="Arial"/>',l[l.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',l[l.length]='<a:font script="Geor" typeface="Sylfaen"/>',l[l.length]="</a:minorFont>",l[l.length]="</a:fontScheme>",l[l.length]='<a:fmtScheme name="Office">',l[l.length]="<a:fillStyleLst>",l[l.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',l[l.length]='<a:gradFill rotWithShape="1">',l[l.length]="<a:gsLst>",l[l.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',l[l.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',l[l.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',l[l.length]="</a:gsLst>",l[l.length]='<a:lin ang="16200000" scaled="1"/>',l[l.length]="</a:gradFill>",l[l.length]='<a:gradFill rotWithShape="1">',l[l.length]="<a:gsLst>",l[l.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',l[l.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',l[l.length]="</a:gsLst>",l[l.length]='<a:lin ang="16200000" scaled="0"/>',l[l.length]="</a:gradFill>",l[l.length]="</a:fillStyleLst>",l[l.length]="<a:lnStyleLst>",l[l.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',l[l.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',l[l.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',l[l.length]="</a:lnStyleLst>",l[l.length]="<a:effectStyleLst>",l[l.length]="<a:effectStyle>",l[l.length]="<a:effectLst>",l[l.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',l[l.length]="</a:effectLst>",l[l.length]="</a:effectStyle>",l[l.length]="<a:effectStyle>",l[l.length]="<a:effectLst>",l[l.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',l[l.length]="</a:effectLst>",l[l.length]="</a:effectStyle>",l[l.length]="<a:effectStyle>",l[l.length]="<a:effectLst>",l[l.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',l[l.length]="</a:effectLst>",l[l.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',l[l.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',l[l.length]="</a:effectStyle>",l[l.length]="</a:effectStyleLst>",l[l.length]="<a:bgFillStyleLst>",l[l.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',l[l.length]='<a:gradFill rotWithShape="1">',l[l.length]="<a:gsLst>",l[l.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',l[l.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',l[l.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',l[l.length]="</a:gsLst>",l[l.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',l[l.length]="</a:gradFill>",l[l.length]='<a:gradFill rotWithShape="1">',l[l.length]="<a:gsLst>",l[l.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',l[l.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',l[l.length]="</a:gsLst>",l[l.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',l[l.length]="</a:gradFill>",l[l.length]="</a:bgFillStyleLst>",l[l.length]="</a:fmtScheme>",l[l.length]="</a:themeElements>",l[l.length]="<a:objectDefaults>",l[l.length]="<a:spDef>",l[l.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',l[l.length]="</a:spDef>",l[l.length]="<a:lnDef>",l[l.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',l[l.length]="</a:lnDef>",l[l.length]="</a:objectDefaults>",l[l.length]="<a:extraClrSchemeLst/>",l[l.length]="</a:theme>",l.join("")}function oO(a,n){return{flags:a.read_shift(4),version:a.read_shift(4),name:sl(a,n-8)}}function sO(a){var n=ci(12+2*a.name.length);return n.write_shift(4,a.flags),n.write_shift(4,a.version),As(a.name,n),n.slice(0,n.l)}function lO(a){for(var n=[],l=a.read_shift(4);l-- >0;)n.push([a.read_shift(4),a.read_shift(4)]);return n}function cO(a){var n=ci(4+8*a.length);n.write_shift(4,a.length);for(var l=0;l<a.length;++l)n.write_shift(4,a[l][0]),n.write_shift(4,a[l][1]);return n}function uO(a,n){var l=ci(8+2*n.length);return l.write_shift(4,a),As(n,l),l.slice(0,l.l)}function hO(a){return a.l+=4,a.read_shift(4)!=0}function dO(a,n){var l=ci(8);return l.write_shift(4,a),l.write_shift(4,n?1:0),l}function fO(){var a=ec();return Ii(a,332),Ii(a,334,th(1)),Ii(a,335,sO({name:"XLDAPR",version:12e4,flags:3496657072})),Ii(a,336),Ii(a,339,uO(1,"XLDAPR")),Ii(a,52),Ii(a,35,th(514)),Ii(a,4096,th(0)),Ii(a,4097,hu(1)),Ii(a,36),Ii(a,53),Ii(a,340),Ii(a,337,dO(1,!0)),Ii(a,51,cO([[1,0]])),Ii(a,338),Ii(a,333),a.end()}function BC(){var a=[Xo];return a.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),a.join("")}function pO(a){var n={};n.i=a.read_shift(4);var l={};l.r=a.read_shift(4),l.c=a.read_shift(4),n.r=xa(l);var c=a.read_shift(1);return c&2&&(n.l="1"),c&8&&(n.a="1"),n}var h0=1024;function zC(a,n){for(var l=[21600,21600],c=["m0,0l0",l[1],l[0],l[1],l[0],"0xe"].join(","),f=[Vi("xml",null,{"xmlns:v":Lc.v,"xmlns:o":Lc.o,"xmlns:x":Lc.x,"xmlns:mv":Lc.mv}).replace(/\/>/,">"),Vi("o:shapelayout",Vi("o:idmap",null,{"v:ext":"edit",data:a}),{"v:ext":"edit"}),Vi("v:shapetype",[Vi("v:stroke",null,{joinstyle:"miter"}),Vi("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:l.join(","),path:c})];h0<a*1e3;)h0+=1e3;return n.forEach(function(i){var x=Es(i[0]),T={color2:"#BEFF82",type:"gradient"};T.type=="gradient"&&(T.angle="-180");var A=T.type=="gradient"?Vi("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,M=Vi("v:fill",A,T),F={on:"t",obscured:"t"};++h0,f=f.concat(["<v:shape"+Ug({id:"_x0000_s"+h0,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",M,Vi("v:shadow",null,F),Vi("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Hs("x:Anchor",[x.c+1,0,x.r+1,0,x.c+3,20,x.r+5,20].join(",")),Hs("x:AutoFill","False"),Hs("x:Row",String(x.r)),Hs("x:Column",String(x.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),f.push("</xml>"),f.join("")}function jC(a){var n=[Xo,Vi("comments",null,{xmlns:v0[0]})],l=[];return n.push("<authors>"),a.forEach(function(c){c[1].forEach(function(f){var i=_a(f.a);l.indexOf(i)==-1&&(l.push(i),n.push("<author>"+i+"</author>")),f.T&&f.ID&&l.indexOf("tc="+f.ID)==-1&&(l.push("tc="+f.ID),n.push("<author>tc="+f.ID+"</author>"))})}),l.length==0&&(l.push("SheetJ5"),n.push("<author>SheetJ5</author>")),n.push("</authors>"),n.push("<commentList>"),a.forEach(function(c){var f=0,i=[];if(c[1][0]&&c[1][0].T&&c[1][0].ID?f=l.indexOf("tc="+c[1][0].ID):c[1].forEach(function(A){A.a&&(f=l.indexOf(_a(A.a))),i.push(A.t||"")}),n.push('<comment ref="'+c[0]+'" authorId="'+f+'"><text>'),i.length<=1)n.push(Hs("t",_a(i[0]||"")));else{for(var x=`Comment:
    `+i[0]+`
`,T=1;T<i.length;++T)x+=`Reply:
    `+i[T]+`
`;n.push(Hs("t",_a(x)))}n.push("</text></comment>")}),n.push("</commentList>"),n.length>2&&(n[n.length]="</comments>",n[1]=n[1].replace("/>",">")),n.join("")}function mO(a,n,l){var c=[Xo,Vi("ThreadedComments",null,{xmlns:Ss.TCMNT}).replace(/[\/]>/,">")];return a.forEach(function(f){var i="";(f[1]||[]).forEach(function(x,T){if(!x.T){delete x.ID;return}x.a&&n.indexOf(x.a)==-1&&n.push(x.a);var A={ref:f[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+l.tcid++).slice(-12)+"}"};T==0?i=A.id:A.parentId=i,x.ID=A.id,x.a&&(A.personId="{54EE7950-7262-4200-6969-"+("000000000000"+n.indexOf(x.a)).slice(-12)+"}"),c.push(Vi("threadedComment",Hs("text",x.t||""),A))})}),c.push("</ThreadedComments>"),c.join("")}function gO(a){var n=[Xo,Vi("personList",null,{xmlns:Ss.TCMNT,"xmlns:x":v0[0]}).replace(/[\/]>/,">")];return a.forEach(function(l,c){n.push(Vi("person",null,{displayName:l,id:"{54EE7950-7262-4200-6969-"+("000000000000"+c).slice(-12)+"}",userId:l,providerId:"None"}))}),n.push("</personList>"),n.join("")}function _O(a){var n={};n.iauthor=a.read_shift(4);var l=Jp(a,16);return n.rfx=l.s,n.ref=xa(l.s),a.l+=16,n}function xO(a,n){return n==null&&(n=ci(36)),n.write_shift(4,a[1].iauthor),w0(a[0],n),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n}var vO=sl;function yO(a){return As(a.slice(0,54))}function bO(a){var n=ec(),l=[];return Ii(n,628),Ii(n,630),a.forEach(function(c){c[1].forEach(function(f){l.indexOf(f.a)>-1||(l.push(f.a.slice(0,54)),Ii(n,632,yO(f.a)))})}),Ii(n,631),Ii(n,633),a.forEach(function(c){c[1].forEach(function(f){f.iauthor=l.indexOf(f.a);var i={s:Es(c[0]),e:Es(c[0])};Ii(n,635,xO([i,f])),f.t&&f.t.length>0&&Ii(n,637,TR(f)),Ii(n,636),delete f.iauthor})}),Ii(n,634),Ii(n,629),n.end()}function wO(a,n){n.FullPaths.forEach(function(l,c){if(c!=0){var f=l.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");f.slice(-1)!=="/"&&Ca.utils.cfb_add(a,f,n.FileIndex[c].content)}})}var VC=["xlsb","xlsm","xlam","biff8","xla"];var TO=function(){var a=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function l(c,f,i,x){var T=!1,A=!1;i.length==0?A=!0:i.charAt(0)=="["&&(A=!0,i=i.slice(1,-1)),x.length==0?T=!0:x.charAt(0)=="["&&(T=!0,x=x.slice(1,-1));var M=i.length>0?parseInt(i,10)|0:0,F=x.length>0?parseInt(x,10)|0:0;return T?F+=n.c:--F,A?M+=n.r:--M,f+(T?"":"$")+ol(F)+(A?"":"$")+Gs(M)}return function(f,i){return n=i,f.replace(a,l)}}(),f2=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,p2=function(){return function(n,l){return n.replace(f2,function(c,f,i,x,T,A){var M=s2(x)-(i?0:l.c),F=o2(A)-(T?0:l.r),W=F==0?"":T?F+1:"["+F+"]",V=M==0?"":i?M+1:"["+M+"]";return f+"R"+W+"C"+V})}}();function SO(a,n){return a.replace(f2,function(l,c,f,i,x,T){return c+(f=="$"?f+i:ol(s2(i)+n.c))+(x=="$"?x+T:Gs(o2(T)+n.r))})}function EO(a){return a.length!=1}function qo(a){a.l+=1}function Gf(a,n){var l=a.read_shift(n==1?1:2);return[l&16383,l>>14&1,l>>15&1]}function UC(a,n,l){var c=2;if(l){if(l.biff>=2&&l.biff<=5)return HC(a,n,l);l.biff==12&&(c=4)}var f=a.read_shift(c),i=a.read_shift(c),x=Gf(a,2),T=Gf(a,2);return{s:{r:f,c:x[0],cRel:x[1],rRel:x[2]},e:{r:i,c:T[0],cRel:T[1],rRel:T[2]}}}function HC(a){var n=Gf(a,2),l=Gf(a,2),c=a.read_shift(1),f=a.read_shift(1);return{s:{r:n[0],c,cRel:n[1],rRel:n[2]},e:{r:l[0],c:f,cRel:l[1],rRel:l[2]}}}function AO(a,n,l){if(l.biff<8)return HC(a,n,l);var c=a.read_shift(l.biff==12?4:2),f=a.read_shift(l.biff==12?4:2),i=Gf(a,2),x=Gf(a,2);return{s:{r:c,c:i[0],cRel:i[1],rRel:i[2]},e:{r:f,c:x[0],cRel:x[1],rRel:x[2]}}}function GC(a,n,l){if(l&&l.biff>=2&&l.biff<=5)return CO(a,n,l);var c=a.read_shift(l&&l.biff==12?4:2),f=Gf(a,2);return{r:c,c:f[0],cRel:f[1],rRel:f[2]}}function CO(a){var n=Gf(a,2),l=a.read_shift(1);return{r:n[0],c:l,cRel:n[1],rRel:n[2]}}function IO(a){var n=a.read_shift(2),l=a.read_shift(2);return{r:n,c:l&255,fQuoted:!!(l&16384),cRel:l>>15,rRel:l>>15}}function kO(a,n,l){var c=l&&l.biff?l.biff:8;if(c>=2&&c<=5)return MO(a,n,l);var f=a.read_shift(c>=12?4:2),i=a.read_shift(2),x=(i&16384)>>14,T=(i&32768)>>15;if(i&=16383,T==1)for(;f>524287;)f-=1048576;if(x==1)for(;i>8191;)i=i-16384;return{r:f,c:i,cRel:x,rRel:T}}function MO(a){var n=a.read_shift(2),l=a.read_shift(1),c=(n&32768)>>15,f=(n&16384)>>14;return n&=16383,c==1&&n>=8192&&(n=n-16384),f==1&&l>=128&&(l=l-256),{r:n,c:l,cRel:f,rRel:c}}function DO(a,n,l){var c=(a[a.l++]&96)>>5,f=UC(a,l.biff>=2&&l.biff<=5?6:8,l);return[c,f]}function FO(a,n,l){var c=(a[a.l++]&96)>>5,f=a.read_shift(2,"i"),i=8;if(l)switch(l.biff){case 5:a.l+=12,i=6;break;case 12:i=12;break}var x=UC(a,i,l);return[c,f,x]}function PO(a,n,l){var c=(a[a.l++]&96)>>5;return a.l+=l&&l.biff>8?12:l.biff<8?6:8,[c]}function LO(a,n,l){var c=(a[a.l++]&96)>>5,f=a.read_shift(2),i=8;if(l)switch(l.biff){case 5:a.l+=12,i=6;break;case 12:i=12;break}return a.l+=i,[c,f]}function RO(a,n,l){var c=(a[a.l++]&96)>>5,f=AO(a,n-1,l);return[c,f]}function OO(a,n,l){var c=(a[a.l++]&96)>>5;return a.l+=l.biff==2?6:l.biff==12?14:7,[c]}function D3(a){var n=a[a.l+1]&1,l=1;return a.l+=4,[n,l]}function NO(a,n,l){a.l+=2;for(var c=a.read_shift(l&&l.biff==2?1:2),f=[],i=0;i<=c;++i)f.push(a.read_shift(l&&l.biff==2?1:2));return f}function BO(a,n,l){var c=a[a.l+1]&255?1:0;return a.l+=2,[c,a.read_shift(l&&l.biff==2?1:2)]}function zO(a,n,l){var c=a[a.l+1]&255?1:0;return a.l+=2,[c,a.read_shift(l&&l.biff==2?1:2)]}function jO(a){var n=a[a.l+1]&255?1:0;return a.l+=2,[n,a.read_shift(2)]}function VO(a,n,l){var c=a[a.l+1]&255?1:0;return a.l+=l&&l.biff==2?3:4,[c]}function WC(a){var n=a.read_shift(1),l=a.read_shift(1);return[n,l]}function UO(a){return a.read_shift(2),WC(a,2)}function HO(a){return a.read_shift(2),WC(a,2)}function GO(a,n,l){var c=(a[a.l]&96)>>5;a.l+=1;var f=GC(a,0,l);return[c,f]}function WO(a,n,l){var c=(a[a.l]&96)>>5;a.l+=1;var f=kO(a,0,l);return[c,f]}function qO(a,n,l){var c=(a[a.l]&96)>>5;a.l+=1;var f=a.read_shift(2);l&&l.biff==5&&(a.l+=12);var i=GC(a,0,l);return[c,f,i]}function $O(a,n,l){var c=(a[a.l]&96)>>5;a.l+=1;var f=a.read_shift(l&&l.biff<=3?1:2);return[$N[f],XC[f],c]}function XO(a,n,l){var c=a[a.l++],f=a.read_shift(1),i=l&&l.biff<=3?[c==88?-1:0,a.read_shift(1)]:ZO(a);return[f,(i[0]===0?XC:qN)[i[1]]]}function ZO(a){return[a[a.l+1]>>7,a.read_shift(2)&32767]}function YO(a,n,l){a.l+=l&&l.biff==2?3:4}function KO(a,n,l){if(a.l++,l&&l.biff==12)return[a.read_shift(4,"i"),0];var c=a.read_shift(2),f=a.read_shift(l&&l.biff==2?1:2);return[c,f]}function JO(a){return a.l++,$g[a.read_shift(1)]}function QO(a){return a.l++,a.read_shift(2)}function eN(a){return a.l++,a.read_shift(1)!==0}function tN(a){return a.l++,T0(a,8)}function iN(a,n,l){return a.l++,CC(a,n-1,l)}function rN(a,n){var l=[a.read_shift(1)];if(n==12)switch(l[0]){case 2:l[0]=4;break;case 4:l[0]=16;break;case 0:l[0]=1;break;case 1:l[0]=2;break}switch(l[0]){case 4:l[1]=qR(a,1)?"TRUE":"FALSE",n!=12&&(a.l+=7);break;case 37:case 16:l[1]=$g[a[a.l]],a.l+=n==12?4:8;break;case 0:a.l+=8;break;case 1:l[1]=T0(a,8);break;case 2:l[1]=YR(a,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+l[0])}return l}function nN(a,n,l){for(var c=a.read_shift(l.biff==12?4:2),f=[],i=0;i!=c;++i)f.push((l.biff==12?Jp:QR)(a,8));return f}function aN(a,n,l){var c=0,f=0;l.biff==12?(c=a.read_shift(4),f=a.read_shift(4)):(f=1+a.read_shift(1),c=1+a.read_shift(2)),l.biff>=2&&l.biff<8&&(--c,--f==0&&(f=256));for(var i=0,x=[];i!=c&&(x[i]=[]);++i)for(var T=0;T!=f;++T)x[i][T]=rN(a,l.biff);return x}function oN(a,n,l){var c=a.read_shift(1)>>>5&3,f=!l||l.biff>=8?4:2,i=a.read_shift(f);switch(l.biff){case 2:a.l+=5;break;case 3:case 4:a.l+=8;break;case 5:a.l+=12;break}return[c,0,i]}function sN(a,n,l){if(l.biff==5)return lN(a,n,l);var c=a.read_shift(1)>>>5&3,f=a.read_shift(2),i=a.read_shift(4);return[c,f,i]}function lN(a){var n=a.read_shift(1)>>>5&3,l=a.read_shift(2,"i");a.l+=8;var c=a.read_shift(2);return a.l+=12,[n,l,c]}function cN(a,n,l){var c=a.read_shift(1)>>>5&3;a.l+=l&&l.biff==2?3:4;var f=a.read_shift(l&&l.biff==2?1:2);return[c,f]}function uN(a,n,l){var c=a.read_shift(1)>>>5&3,f=a.read_shift(l&&l.biff==2?1:2);return[c,f]}function hN(a,n,l){var c=a.read_shift(1)>>>5&3;return a.l+=4,l.biff<8&&a.l--,l.biff==12&&(a.l+=2),[c]}function dN(a,n,l){var c=(a[a.l++]&96)>>5,f=a.read_shift(2),i=4;if(l)switch(l.biff){case 5:i=15;break;case 12:i=6;break}return a.l+=i,[c,f]}var fN=Gh,pN=Gh,mN=Gh;function Xg(a,n,l){return a.l+=2,[IO(a,4,l)]}function m2(a){return a.l+=6,[]}var gN=Xg,_N=m2,xN=m2,vN=Xg;function qC(a){return a.l+=2,[EC(a),a.read_shift(2)&1]}var yN=Xg,bN=qC,wN=m2,TN=Xg,SN=Xg,EN=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function AN(a){a.l+=2;var n=a.read_shift(2),l=a.read_shift(2),c=a.read_shift(4),f=a.read_shift(2),i=a.read_shift(2),x=EN[l>>2&31];return{ixti:n,coltype:l&3,rt:x,idx:c,c:f,C:i}}function CN(a){return a.l+=2,[a.read_shift(4)]}function IN(a,n,l){return a.l+=5,a.l+=2,a.l+=l.biff==2?1:4,["PTGSHEET"]}function kN(a,n,l){return a.l+=l.biff==2?4:5,["PTGENDSHEET"]}function MN(a){var n=a.read_shift(1)>>>5&3,l=a.read_shift(2);return[n,l]}function DN(a){var n=a.read_shift(1)>>>5&3,l=a.read_shift(2);return[n,l]}function FN(a){return a.l+=4,[0,0]}var F3={1:{n:"PtgExp",f:KO},2:{n:"PtgTbl",f:mN},3:{n:"PtgAdd",f:qo},4:{n:"PtgSub",f:qo},5:{n:"PtgMul",f:qo},6:{n:"PtgDiv",f:qo},7:{n:"PtgPower",f:qo},8:{n:"PtgConcat",f:qo},9:{n:"PtgLt",f:qo},10:{n:"PtgLe",f:qo},11:{n:"PtgEq",f:qo},12:{n:"PtgGe",f:qo},13:{n:"PtgGt",f:qo},14:{n:"PtgNe",f:qo},15:{n:"PtgIsect",f:qo},16:{n:"PtgUnion",f:qo},17:{n:"PtgRange",f:qo},18:{n:"PtgUplus",f:qo},19:{n:"PtgUminus",f:qo},20:{n:"PtgPercent",f:qo},21:{n:"PtgParen",f:qo},22:{n:"PtgMissArg",f:qo},23:{n:"PtgStr",f:iN},26:{n:"PtgSheet",f:IN},27:{n:"PtgEndSheet",f:kN},28:{n:"PtgErr",f:JO},29:{n:"PtgBool",f:eN},30:{n:"PtgInt",f:QO},31:{n:"PtgNum",f:tN},32:{n:"PtgArray",f:OO},33:{n:"PtgFunc",f:$O},34:{n:"PtgFuncVar",f:XO},35:{n:"PtgName",f:oN},36:{n:"PtgRef",f:GO},37:{n:"PtgArea",f:DO},38:{n:"PtgMemArea",f:cN},39:{n:"PtgMemErr",f:fN},40:{n:"PtgMemNoMem",f:pN},41:{n:"PtgMemFunc",f:uN},42:{n:"PtgRefErr",f:hN},43:{n:"PtgAreaErr",f:PO},44:{n:"PtgRefN",f:WO},45:{n:"PtgAreaN",f:RO},46:{n:"PtgMemAreaN",f:MN},47:{n:"PtgMemNoMemN",f:DN},57:{n:"PtgNameX",f:sN},58:{n:"PtgRef3d",f:qO},59:{n:"PtgArea3d",f:FO},60:{n:"PtgRefErr3d",f:dN},61:{n:"PtgAreaErr3d",f:LO},255:{}},PN={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},LN={1:{n:"PtgElfLel",f:qC},2:{n:"PtgElfRw",f:TN},3:{n:"PtgElfCol",f:gN},6:{n:"PtgElfRwV",f:SN},7:{n:"PtgElfColV",f:vN},10:{n:"PtgElfRadical",f:yN},11:{n:"PtgElfRadicalS",f:wN},13:{n:"PtgElfColS",f:_N},15:{n:"PtgElfColSV",f:xN},16:{n:"PtgElfRadicalLel",f:bN},25:{n:"PtgList",f:AN},29:{n:"PtgSxName",f:CN},255:{}},RN={0:{n:"PtgAttrNoop",f:FN},1:{n:"PtgAttrSemi",f:VO},2:{n:"PtgAttrIf",f:zO},4:{n:"PtgAttrChoose",f:NO},8:{n:"PtgAttrGoto",f:BO},16:{n:"PtgAttrSum",f:YO},32:{n:"PtgAttrBaxcel",f:D3},33:{n:"PtgAttrBaxcel",f:D3},64:{n:"PtgAttrSpace",f:UO},65:{n:"PtgAttrSpaceSemi",f:HO},128:{n:"PtgAttrIfError",f:jO},255:{}};function ON(a,n,l,c){if(c.biff<8)return Gh(a,n);for(var f=a.l+n,i=[],x=0;x!==l.length;++x)switch(l[x][0]){case"PtgArray":l[x][1]=aN(a,0,c),i.push(l[x][1]);break;case"PtgMemArea":l[x][2]=nN(a,l[x][1],c),i.push(l[x][2]);break;case"PtgExp":c&&c.biff==12&&(l[x][1][1]=a.read_shift(4),i.push(l[x][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+l[x][0];default:break}return n=f-a.l,n!==0&&i.push(Gh(a,n)),i}function NN(a,n,l){for(var c=a.l+n,f,i,x=[];c!=a.l;)n=c-a.l,i=a[a.l],f=F3[i]||F3[PN[i]],(i===24||i===25)&&(f=(i===24?LN:RN)[a[a.l+1]]),!f||!f.f?Gh(a,n):x.push([f.n,f.f(a,n,l)]);return x}function BN(a){for(var n=[],l=0;l<a.length;++l){for(var c=a[l],f=[],i=0;i<c.length;++i){var x=c[i];if(x)switch(x[0]){case 2:f.push('"'+x[1].replace(/"/g,'""')+'"');break;default:f.push(x[1])}else f.push("")}n.push(f.join(","))}return n.join(";")}var zN={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function jN(a,n){if(!a&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(a)?"'"+a+"'":a}function $C(a,n,l){if(!a)return"SH33TJSERR0";if(l.biff>8&&(!a.XTI||!a.XTI[n]))return a.SheetNames[n];if(!a.XTI)return"SH33TJSERR6";var c=a.XTI[n];if(l.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":a.XTI[n-1];if(!c)return"SH33TJSERR1";var f="";if(l.biff>8)switch(a[c[0]][0]){case 357:return f=c[1]==-1?"#REF":a.SheetNames[c[1]],c[1]==c[2]?f:f+":"+a.SheetNames[c[2]];case 358:return l.SID!=null?a.SheetNames[l.SID]:"SH33TJSSAME"+a[c[0]][0];case 355:default:return"SH33TJSSRC"+a[c[0]][0]}switch(a[c[0]][0][0]){case 1025:return f=c[1]==-1?"#REF":a.SheetNames[c[1]]||"SH33TJSERR3",c[1]==c[2]?f:f+":"+a.SheetNames[c[2]];case 14849:return a[c[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return a[c[0]][0][3]?(f=c[1]==-1?"#REF":a[c[0]][0][3][c[1]]||"SH33TJSERR4",c[1]==c[2]?f:f+":"+a[c[0]][0][3][c[2]]):"SH33TJSERR2"}}function P3(a,n,l){var c=$C(a,n,l);return c=="#REF"?c:jN(c,l)}function x0(a,n,l,c,f){var i=f&&f.biff||8,x={s:{c:0,r:0},e:{c:0,r:0}},T=[],A,M,F,W=0,V=0,R,te="";if(!a[0]||!a[0][0])return"";for(var H=-1,J="",K=0,ne=a[0].length;K<ne;++K){var de=a[0][K];switch(de[0]){case"PtgUminus":T.push("-"+T.pop());break;case"PtgUplus":T.push("+"+T.pop());break;case"PtgPercent":T.push(T.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(A=T.pop(),M=T.pop(),H>=0){switch(a[0][H][1][0]){case 0:J=To(" ",a[0][H][1][1]);break;case 1:J=To("\r",a[0][H][1][1]);break;default:if(J="",f.WTF)throw new Error("Unexpected PtgAttrSpaceType "+a[0][H][1][0])}M=M+J,H=-1}T.push(M+zN[de[0]]+A);break;case"PtgIsect":A=T.pop(),M=T.pop(),T.push(M+" "+A);break;case"PtgUnion":A=T.pop(),M=T.pop(),T.push(M+","+A);break;case"PtgRange":A=T.pop(),M=T.pop(),T.push(M+":"+A);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":F=Rg(de[1][1],x,f),T.push(Og(F,i));break;case"PtgRefN":F=l?Rg(de[1][1],l,f):de[1][1],T.push(Og(F,i));break;case"PtgRef3d":W=de[1][1],F=Rg(de[1][2],x,f),te=P3(c,W,f);var De=te;T.push(te+"!"+Og(F,i));break;case"PtgFunc":case"PtgFuncVar":var Fe=de[1][0],et=de[1][1];Fe||(Fe=0),Fe&=127;var Te=Fe==0?[]:T.slice(-Fe);T.length-=Fe,et==="User"&&(et=Te.shift()),T.push(et+"("+Te.join(",")+")");break;case"PtgBool":T.push(de[1]?"TRUE":"FALSE");break;case"PtgInt":T.push(de[1]);break;case"PtgNum":T.push(String(de[1]));break;case"PtgStr":T.push('"'+de[1].replace(/"/g,'""')+'"');break;case"PtgErr":T.push(de[1]);break;case"PtgAreaN":R=_3(de[1][1],l?{s:l}:x,f),T.push(Bb(R,f));break;case"PtgArea":R=_3(de[1][1],x,f),T.push(Bb(R,f));break;case"PtgArea3d":W=de[1][1],R=de[1][2],te=P3(c,W,f),T.push(te+"!"+Bb(R,f));break;case"PtgAttrSum":T.push("SUM("+T.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":V=de[1][2];var ge=(c.names||[])[V-1]||(c[0]||[])[V],Ve=ge?ge.Name:"SH33TJSNAME"+String(V);Ve&&Ve.slice(0,6)=="_xlfn."&&!f.xlfn&&(Ve=Ve.slice(6)),T.push(Ve);break;case"PtgNameX":var Ae=de[1][1];V=de[1][2];var _e;if(f.biff<=5)Ae<0&&(Ae=-Ae),c[Ae]&&(_e=c[Ae][V]);else{var xe="";if(((c[Ae]||[])[0]||[])[0]==14849||(((c[Ae]||[])[0]||[])[0]==1025?c[Ae][V]&&c[Ae][V].itab>0&&(xe=c.SheetNames[c[Ae][V].itab-1]+"!"):xe=c.SheetNames[V-1]+"!"),c[Ae]&&c[Ae][V])xe+=c[Ae][V].Name;else if(c[0]&&c[0][V])xe+=c[0][V].Name;else{var Qe=($C(c,Ae,f)||"").split(";;");Qe[V-1]?xe=Qe[V-1]:xe+="SH33TJSERRX"}T.push(xe);break}_e||(_e={Name:"SH33TJSERRY"}),T.push(_e.Name);break;case"PtgParen":var Ce="(",Ye=")";if(H>=0){switch(J="",a[0][H][1][0]){case 2:Ce=To(" ",a[0][H][1][1])+Ce;break;case 3:Ce=To("\r",a[0][H][1][1])+Ce;break;case 4:Ye=To(" ",a[0][H][1][1])+Ye;break;case 5:Ye=To("\r",a[0][H][1][1])+Ye;break;default:if(f.WTF)throw new Error("Unexpected PtgAttrSpaceType "+a[0][H][1][0])}H=-1}T.push(Ce+T.pop()+Ye);break;case"PtgRefErr":T.push("#REF!");break;case"PtgRefErr3d":T.push("#REF!");break;case"PtgExp":F={c:de[1][1],r:de[1][0]};var ut={c:l.c,r:l.r};if(c.sharedf[xa(F)]){var st=c.sharedf[xa(F)];T.push(x0(st,x,ut,c,f))}else{var pt=!1;for(A=0;A!=c.arrayf.length;++A)if(M=c.arrayf[A],!(F.c<M[0].s.c||F.c>M[0].e.c)&&!(F.r<M[0].s.r||F.r>M[0].e.r)){T.push(x0(M[1],x,ut,c,f)),pt=!0;break}pt||T.push(de[1])}break;case"PtgArray":T.push("{"+BN(de[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":H=K;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":T.push("");break;case"PtgAreaErr":T.push("#REF!");break;case"PtgAreaErr3d":T.push("#REF!");break;case"PtgList":T.push("Table"+de[1].idx+"[#"+de[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(de));default:throw new Error("Unrecognized Formula Token: "+String(de))}var Tt=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(f.biff!=3&&H>=0&&Tt.indexOf(a[0][K][0])==-1){de=a[0][H];var ht=!0;switch(de[1][0]){case 4:ht=!1;case 0:J=To(" ",de[1][1]);break;case 5:ht=!1;case 1:J=To("\r",de[1][1]);break;default:if(J="",f.WTF)throw new Error("Unexpected PtgAttrSpaceType "+de[1][0])}T.push((ht?J:"")+T.pop()+(ht?"":J)),H=-1}}if(T.length>1&&f.WTF)throw new Error("bad formula stack");return T[0]}function VN(a){if(a==null){var n=ci(8);return n.write_shift(1,3),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,65535),n}else if(typeof a=="number")return qp(a);return qp(0)}function UN(a,n,l,c,f){var i=$p(n,l,f),x=VN(a.v),T=ci(6),A=33;T.write_shift(2,A),T.write_shift(4,0);for(var M=ci(a.bf.length),F=0;F<a.bf.length;++F)M[F]=a.bf[F];var W=Us([i,x,T,M]);return W}function Mx(a,n,l){var c=a.read_shift(4),f=NN(a,c,l),i=a.read_shift(4),x=i>0?ON(a,i,f,l):null;return[f,x]}var HN=Mx,Dx=Mx,GN=Mx,WN=Mx,qN={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},XC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},$N={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function XN(a){var n="of:="+a.replace(f2,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return n.replace(/;/g,"|").replace(/,/g,";")}function ZN(a){return a.replace(/\./,"!")}var Ng=typeof Map<"u";function g2(a,n,l){var c=0,f=a.length;if(l){if(Ng?l.has(n):Object.prototype.hasOwnProperty.call(l,n)){for(var i=Ng?l.get(n):l[n];c<i.length;++c)if(a[i[c]].t===n)return a.Count++,i[c]}}else for(;c<f;++c)if(a[c].t===n)return a.Count++,c;return a[f]={t:n},a.Count++,a.Unique++,l&&(Ng?(l.has(n)||l.set(n,[]),l.get(n).push(f)):(Object.prototype.hasOwnProperty.call(l,n)||(l[n]=[]),l[n].push(f))),f}function Fx(a,n){var l={min:a+1,max:a+1},c=-1;return n.MDW&&(zd=n.MDW),n.width!=null?l.customWidth=1:n.wpx!=null?c=yx(n.wpx):n.wch!=null&&(c=n.wch),c>-1?(l.width=$b(c),l.customWidth=1):n.width!=null&&(l.width=n.width),n.hidden&&(l.hidden=!0),n.level!=null&&(l.outlineLevel=l.level=n.level),l}function ZC(a,n){if(a){var l=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(l=[1,1,1,1,.5,.5]),a.left==null&&(a.left=l[0]),a.right==null&&(a.right=l[1]),a.top==null&&(a.top=l[2]),a.bottom==null&&(a.bottom=l[3]),a.header==null&&(a.header=l[4]),a.footer==null&&(a.footer=l[5])}}function qf(a,n,l){var c=l.revssf[n.z!=null?n.z:"General"],f=60,i=a.length;if(c==null&&l.ssf){for(;f<392;++f)if(l.ssf[f]==null){Z3(n.z,f),l.ssf[f]=n.z,l.revssf[n.z]=c=f;break}}for(f=0;f!=i;++f)if(a[f].numFmtId===c)return f;return a[i]={numFmtId:c,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function YN(a,n,l){if(a&&a["!ref"]){var c=Ka(a["!ref"]);if(c.e.c<c.s.c||c.e.r<c.s.r)throw new Error("Bad range ("+l+"): "+a["!ref"])}}function KN(a){if(a.length===0)return"";for(var n='<mergeCells count="'+a.length+'">',l=0;l!=a.length;++l)n+='<mergeCell ref="'+$o(a[l])+'"/>';return n+"</mergeCells>"}function JN(a,n,l,c,f){var i=!1,x={},T=null;if(c.bookType!=="xlsx"&&n.vbaraw){var A=n.SheetNames[l];try{n.Workbook&&(A=n.Workbook.Sheets[l].CodeName||A)}catch{}i=!0,x.codeName=Od(_a(A))}if(a&&a["!outline"]){var M={summaryBelow:1,summaryRight:1};a["!outline"].above&&(M.summaryBelow=0),a["!outline"].left&&(M.summaryRight=0),T=(T||"")+Vi("outlinePr",null,M)}!i&&!T||(f[f.length]=Vi("sheetPr",T,x))}var QN=["objects","scenarios","selectLockedCells","selectUnlockedCells"],e8=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function t8(a){var n={sheet:1};return QN.forEach(function(l){a[l]!=null&&a[l]&&(n[l]="1")}),e8.forEach(function(l){a[l]!=null&&!a[l]&&(n[l]="0")}),a.password&&(n.password=FC(a.password).toString(16).toUpperCase()),Vi("sheetProtection",null,n)}function i8(a){return ZC(a),Vi("pageMargins",null,a)}function r8(a,n){for(var l=["<cols>"],c,f=0;f!=n.length;++f)(c=n[f])&&(l[l.length]=Vi("col",null,Fx(f,c)));return l[l.length]="</cols>",l.join("")}function n8(a,n,l,c){var f=typeof a.ref=="string"?a.ref:$o(a.ref);l.Workbook||(l.Workbook={Sheets:[]}),l.Workbook.Names||(l.Workbook.Names=[]);var i=l.Workbook.Names,x=Rc(f);x.s.r==x.e.r&&(x.e.r=Rc(n["!ref"]).e.r,f=$o(x));for(var T=0;T<i.length;++T){var A=i[T];if(A.Name=="_xlnm._FilterDatabase"&&A.Sheet==c){A.Ref="'"+l.SheetNames[c]+"'!"+f;break}}return T==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:c,Ref:"'"+l.SheetNames[c]+"'!"+f}),Vi("autoFilter",null,{ref:f})}function a8(a,n,l,c){var f={workbookViewId:"0"};return(((c||{}).Workbook||{}).Views||[])[0]&&(f.rightToLeft=c.Workbook.Views[0].RTL?"1":"0"),Vi("sheetViews",Vi("sheetView",null,f),{})}function o8(a,n,l,c){if(a.c&&l["!comments"].push([n,a.c]),a.v===void 0&&typeof a.f!="string"||a.t==="z"&&!a.f)return"";var f="",i=a.t,x=a.v;if(a.t!=="z")switch(a.t){case"b":f=a.v?"1":"0";break;case"n":f=""+a.v;break;case"e":f=$g[a.v];break;case"d":c&&c.cellDates?f=kl(a.v,-1).toISOString():(a=ic(a),a.t="n",f=""+(a.v=tc(kl(a.v)))),typeof a.z>"u"&&(a.z=So[14]);break;default:f=a.v;break}var T=Hs("v",_a(f)),A={r:n},M=qf(c.cellXfs,a,c);switch(M!==0&&(A.s=M),a.t){case"n":break;case"d":A.t="d";break;case"b":A.t="b";break;case"e":A.t="e";break;case"z":break;default:if(a.v==null){delete a.t;break}if(a.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(c&&c.bookSST){T=Hs("v",""+g2(c.Strings,a.v,c.revStrings)),A.t="s";break}A.t="str";break}if(a.t!=i&&(a.t=i,a.v=x),typeof a.f=="string"&&a.f){var F=a.F&&a.F.slice(0,n.length)==n?{t:"array",ref:a.F}:null;T=Vi("f",_a(a.f),F)+(a.v!=null?T:"")}return a.l&&l["!links"].push([n,a.l]),a.D&&(A.cm=1),Vi("c",T,A)}function s8(a,n,l,c){var f=[],i=[],x=Ka(a["!ref"]),T="",A,M="",F=[],W=0,V=0,R=a["!rows"],te=Array.isArray(a),H={r:M},J,K=-1;for(V=x.s.c;V<=x.e.c;++V)F[V]=ol(V);for(W=x.s.r;W<=x.e.r;++W){for(i=[],M=Gs(W),V=x.s.c;V<=x.e.c;++V){A=F[V]+M;var ne=te?(a[W]||[])[V]:a[A];ne!==void 0&&(T=o8(ne,A,a,n,l,c))!=null&&i.push(T)}(i.length>0||R&&R[W])&&(H={r:M},R&&R[W]&&(J=R[W],J.hidden&&(H.hidden=1),K=-1,J.hpx?K=bx(J.hpx):J.hpt&&(K=J.hpt),K>-1&&(H.ht=K,H.customHeight=1),J.level&&(H.outlineLevel=J.level)),f[f.length]=Vi("row",i.join(""),H))}if(R)for(;W<R.length;++W)R&&R[W]&&(H={r:W+1},J=R[W],J.hidden&&(H.hidden=1),K=-1,J.hpx?K=bx(J.hpx):J.hpt&&(K=J.hpt),K>-1&&(H.ht=K,H.customHeight=1),J.level&&(H.outlineLevel=J.level),f[f.length]=Vi("row","",H));return f.join("")}function YC(a,n,l,c){var f=[Xo,Vi("worksheet",null,{xmlns:v0[0],"xmlns:r":Ss.r})],i=l.SheetNames[a],x=0,T="",A=l.Sheets[i];A==null&&(A={});var M=A["!ref"]||"A1",F=Ka(M);if(F.e.c>16383||F.e.r>1048575){if(n.WTF)throw new Error("Range "+M+" exceeds format limit A1:XFD1048576");F.e.c=Math.min(F.e.c,16383),F.e.r=Math.min(F.e.c,1048575),M=$o(F)}c||(c={}),A["!comments"]=[];var W=[];JN(A,l,a,n,f),f[f.length]=Vi("dimension",null,{ref:M}),f[f.length]=a8(A,n,a,l),n.sheetFormat&&(f[f.length]=Vi("sheetFormatPr",null,{defaultRowHeight:n.sheetFormat.defaultRowHeight||"16",baseColWidth:n.sheetFormat.baseColWidth||"10",outlineLevelRow:n.sheetFormat.outlineLevelRow||"7"})),A["!cols"]!=null&&A["!cols"].length>0&&(f[f.length]=r8(A,A["!cols"])),f[x=f.length]="<sheetData/>",A["!links"]=[],A["!ref"]!=null&&(T=s8(A,n,a,l,c),T.length>0&&(f[f.length]=T)),f.length>x+1&&(f[f.length]="</sheetData>",f[x]=f[x].replace("/>",">")),A["!protect"]&&(f[f.length]=t8(A["!protect"])),A["!autofilter"]!=null&&(f[f.length]=n8(A["!autofilter"],A,l,a)),A["!merges"]!=null&&A["!merges"].length>0&&(f[f.length]=KN(A["!merges"]));var V=-1,R,te=-1;return A["!links"].length>0&&(f[f.length]="<hyperlinks>",A["!links"].forEach(function(H){H[1].Target&&(R={ref:H[0]},H[1].Target.charAt(0)!="#"&&(te=ga(c,-1,_a(H[1].Target).replace(/#.*$/,""),qn.HLINK),R["r:id"]="rId"+te),(V=H[1].Target.indexOf("#"))>-1&&(R.location=_a(H[1].Target.slice(V+1))),H[1].Tooltip&&(R.tooltip=_a(H[1].Tooltip)),f[f.length]=Vi("hyperlink",null,R))}),f[f.length]="</hyperlinks>"),delete A["!links"],A["!margins"]!=null&&(f[f.length]=i8(A["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&(f[f.length]=Hs("ignoredErrors",Vi("ignoredError",null,{numberStoredAsText:1,sqref:M}))),W.length>0&&(te=ga(c,-1,"../drawings/drawing"+(a+1)+".xml",qn.DRAW),f[f.length]=Vi("drawing",null,{"r:id":"rId"+te}),A["!drawing"]=W),A["!comments"].length>0&&(te=ga(c,-1,"../drawings/vmlDrawing"+(a+1)+".vml",qn.VML),f[f.length]=Vi("legacyDrawing",null,{"r:id":"rId"+te}),A["!legacy"]=te),f.length>1&&(f[f.length]="</worksheet>",f[1]=f[1].replace("/>",">")),f.join("")}function l8(a,n){var l={},c=a.l+n;l.r=a.read_shift(4),a.l+=4;var f=a.read_shift(2);a.l+=1;var i=a.read_shift(1);return a.l=c,i&7&&(l.level=i&7),i&16&&(l.hidden=!0),i&32&&(l.hpt=f/20),l}function c8(a,n,l){var c=ci(145),f=(l["!rows"]||[])[a]||{};c.write_shift(4,a),c.write_shift(4,0);var i=320;f.hpx?i=bx(f.hpx)*20:f.hpt&&(i=f.hpt*20),c.write_shift(2,i),c.write_shift(1,0);var x=0;f.level&&(x|=f.level),f.hidden&&(x|=16),(f.hpx||f.hpt)&&(x|=32),c.write_shift(1,x),c.write_shift(1,0);var T=0,A=c.l;c.l+=4;for(var M={r:a,c:0},F=0;F<16;++F)if(!(n.s.c>F+1<<10||n.e.c<F<<10)){for(var W=-1,V=-1,R=F<<10;R<F+1<<10;++R){M.c=R;var te=Array.isArray(l)?(l[M.r]||[])[M.c]:l[xa(M)];te&&(W<0&&(W=R),V=R)}W<0||(++T,c.write_shift(4,W),c.write_shift(4,V))}var H=c.l;return c.l=A,c.write_shift(4,T),c.l=H,c.length>c.l?c.slice(0,c.l):c}function u8(a,n,l,c){var f=c8(c,l,n);(f.length>17||(n["!rows"]||[])[c])&&Ii(a,0,f)}var h8=Jp,d8=w0;function f8(){}function p8(a,n){var l={},c=a[a.l];return++a.l,l.above=!(c&64),l.left=!(c&128),a.l+=18,l.name=SR(a,n-19),l}function m8(a,n,l){l==null&&(l=ci(84+4*a.length));var c=192;n&&(n.above&&(c&=-65),n.left&&(c&=-129)),l.write_shift(1,c);for(var f=1;f<3;++f)l.write_shift(1,0);return _x({auto:1},l),l.write_shift(-4,-1),l.write_shift(-4,-1),hC(a,l),l.slice(0,l.l)}function g8(a){var n=du(a);return[n]}function _8(a,n,l){return l==null&&(l=ci(8)),Zp(n,l)}function x8(a){var n=Yp(a);return[n]}function v8(a,n,l){return l==null&&(l=ci(4)),Kp(n,l)}function y8(a){var n=du(a),l=a.read_shift(1);return[n,l,"b"]}function b8(a,n,l){return l==null&&(l=ci(9)),Zp(n,l),l.write_shift(1,a.v?1:0),l}function w8(a){var n=Yp(a),l=a.read_shift(1);return[n,l,"b"]}function T8(a,n,l){return l==null&&(l=ci(5)),Kp(n,l),l.write_shift(1,a.v?1:0),l}function S8(a){var n=du(a),l=a.read_shift(1);return[n,l,"e"]}function E8(a,n,l){return l==null&&(l=ci(9)),Zp(n,l),l.write_shift(1,a.v),l}function A8(a){var n=Yp(a),l=a.read_shift(1);return[n,l,"e"]}function C8(a,n,l){return l==null&&(l=ci(8)),Kp(n,l),l.write_shift(1,a.v),l.write_shift(2,0),l.write_shift(1,0),l}function I8(a){var n=du(a),l=a.read_shift(4);return[n,l,"s"]}function k8(a,n,l){return l==null&&(l=ci(12)),Zp(n,l),l.write_shift(4,n.v),l}function M8(a){var n=Yp(a),l=a.read_shift(4);return[n,l,"s"]}function D8(a,n,l){return l==null&&(l=ci(8)),Kp(n,l),l.write_shift(4,n.v),l}function F8(a){var n=du(a),l=T0(a);return[n,l,"n"]}function P8(a,n,l){return l==null&&(l=ci(16)),Zp(n,l),qp(a.v,l),l}function L8(a){var n=Yp(a),l=T0(a);return[n,l,"n"]}function R8(a,n,l){return l==null&&(l=ci(12)),Kp(n,l),qp(a.v,l),l}function O8(a){var n=du(a),l=dC(a);return[n,l,"n"]}function N8(a,n,l){return l==null&&(l=ci(12)),Zp(n,l),fC(a.v,l),l}function B8(a){var n=Yp(a),l=dC(a);return[n,l,"n"]}function z8(a,n,l){return l==null&&(l=ci(8)),Kp(n,l),fC(a.v,l),l}function j8(a){var n=du(a),l=l2(a);return[n,l,"is"]}function V8(a){var n=du(a),l=sl(a);return[n,l,"str"]}function U8(a,n,l){return l==null&&(l=ci(12+4*a.v.length)),Zp(n,l),As(a.v,l),l.length>l.l?l.slice(0,l.l):l}function H8(a){var n=Yp(a),l=sl(a);return[n,l,"str"]}function G8(a,n,l){return l==null&&(l=ci(8+4*a.v.length)),Kp(n,l),As(a.v,l),l.length>l.l?l.slice(0,l.l):l}function W8(a,n,l){var c=a.l+n,f=du(a);f.r=l["!row"];var i=a.read_shift(1),x=[f,i,"b"];if(l.cellFormula){a.l+=2;var T=Dx(a,c-a.l,l);x[3]=x0(T,null,f,l.supbooks,l)}else a.l=c;return x}function q8(a,n,l){var c=a.l+n,f=du(a);f.r=l["!row"];var i=a.read_shift(1),x=[f,i,"e"];if(l.cellFormula){a.l+=2;var T=Dx(a,c-a.l,l);x[3]=x0(T,null,f,l.supbooks,l)}else a.l=c;return x}function $8(a,n,l){var c=a.l+n,f=du(a);f.r=l["!row"];var i=T0(a),x=[f,i,"n"];if(l.cellFormula){a.l+=2;var T=Dx(a,c-a.l,l);x[3]=x0(T,null,f,l.supbooks,l)}else a.l=c;return x}function X8(a,n,l){var c=a.l+n,f=du(a);f.r=l["!row"];var i=sl(a),x=[f,i,"str"];if(l.cellFormula){a.l+=2;var T=Dx(a,c-a.l,l);x[3]=x0(T,null,f,l.supbooks,l)}else a.l=c;return x}var Z8=Jp,Y8=w0;function K8(a,n){return n==null&&(n=ci(4)),n.write_shift(4,a),n}function J8(a,n){var l=a.l+n,c=Jp(a,16),f=c2(a),i=sl(a),x=sl(a),T=sl(a);a.l=l;var A={rfx:c,relId:f,loc:i,display:T};return x&&(A.Tooltip=x),A}function Q8(a,n){var l=ci(50+4*(a[1].Target.length+(a[1].Tooltip||"").length));w0({s:Es(a[0]),e:Es(a[0])},l),u2("rId"+n,l);var c=a[1].Target.indexOf("#"),f=c==-1?"":a[1].Target.slice(c+1);return As(f||"",l),As(a[1].Tooltip||"",l),As("",l),l.slice(0,l.l)}function eB(){}function tB(a,n,l){var c=a.l+n,f=pC(a,16),i=a.read_shift(1),x=[f];if(x[2]=i,l.cellFormula){var T=HN(a,c-a.l,l);x[1]=T}else a.l=c;return x}function iB(a,n,l){var c=a.l+n,f=Jp(a,16),i=[f];if(l.cellFormula){var x=WN(a,c-a.l,l);i[1]=x,a.l=c}else a.l=c;return i}function rB(a,n,l){l==null&&(l=ci(18));var c=Fx(a,n);l.write_shift(-4,a),l.write_shift(-4,a),l.write_shift(4,(c.width||10)*256),l.write_shift(4,0);var f=0;return n.hidden&&(f|=1),typeof c.width=="number"&&(f|=2),n.level&&(f|=n.level<<8),l.write_shift(2,f),l}var KC=["left","right","top","bottom","header","footer"];function nB(a){var n={};return KC.forEach(function(l){n[l]=T0(a,8)}),n}function aB(a,n){return n==null&&(n=ci(6*8)),ZC(a),KC.forEach(function(l){qp(a[l],n)}),n}function oB(a){var n=a.read_shift(2);return a.l+=28,{RTL:n&32}}function sB(a,n,l){l==null&&(l=ci(30));var c=924;return(((n||{}).Views||[])[0]||{}).RTL&&(c|=32),l.write_shift(2,c),l.write_shift(4,0),l.write_shift(4,0),l.write_shift(4,0),l.write_shift(1,0),l.write_shift(1,0),l.write_shift(2,0),l.write_shift(2,100),l.write_shift(2,0),l.write_shift(2,0),l.write_shift(2,0),l.write_shift(4,0),l}function lB(a){var n=ci(24);return n.write_shift(4,4),n.write_shift(4,1),w0(a,n),n}function cB(a,n){return n==null&&(n=ci(16*4+2)),n.write_shift(2,a.password?FC(a.password):0),n.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(l){l[1]?n.write_shift(4,a[l[0]]!=null&&!a[l[0]]?1:0):n.write_shift(4,a[l[0]]!=null&&a[l[0]]?0:1)}),n}function uB(){}function hB(){}function dB(a,n,l,c,f,i,x){if(n.v===void 0)return!1;var T="";switch(n.t){case"b":T=n.v?"1":"0";break;case"d":n=ic(n),n.z=n.z||So[14],n.v=tc(kl(n.v)),n.t="n";break;case"n":case"e":T=""+n.v;break;default:T=n.v;break}var A={r:l,c};switch(A.s=qf(f.cellXfs,n,f),n.l&&i["!links"].push([xa(A),n.l]),n.c&&i["!comments"].push([xa(A),n.c]),n.t){case"s":case"str":return f.bookSST?(T=g2(f.Strings,n.v,f.revStrings),A.t="s",A.v=T,x?Ii(a,18,D8(n,A)):Ii(a,7,k8(n,A))):(A.t="str",x?Ii(a,17,G8(n,A)):Ii(a,6,U8(n,A))),!0;case"n":return n.v==(n.v|0)&&n.v>-1e3&&n.v<1e3?x?Ii(a,13,z8(n,A)):Ii(a,2,N8(n,A)):x?Ii(a,16,R8(n,A)):Ii(a,5,P8(n,A)),!0;case"b":return A.t="b",x?Ii(a,15,T8(n,A)):Ii(a,4,b8(n,A)),!0;case"e":return A.t="e",x?Ii(a,14,C8(n,A)):Ii(a,3,E8(n,A)),!0}return x?Ii(a,12,v8(n,A)):Ii(a,1,_8(n,A)),!0}function fB(a,n,l,c){var f=Ka(n["!ref"]||"A1"),i,x="",T=[];Ii(a,145);var A=Array.isArray(n),M=f.e.r;n["!rows"]&&(M=Math.max(f.e.r,n["!rows"].length-1));for(var F=f.s.r;F<=M;++F){x=Gs(F),u8(a,n,f,F);var W=!1;if(F<=f.e.r)for(var V=f.s.c;V<=f.e.c;++V){F===f.s.r&&(T[V]=ol(V)),i=T[V]+x;var R=A?(n[F]||[])[V]:n[i];if(!R){W=!1;continue}W=dB(a,R,F,V,c,n,W)}}Ii(a,146)}function pB(a,n){!n||!n["!merges"]||(Ii(a,177,K8(n["!merges"].length)),n["!merges"].forEach(function(l){Ii(a,176,Y8(l))}),Ii(a,178))}function mB(a,n){!n||!n["!cols"]||(Ii(a,390),n["!cols"].forEach(function(l,c){l&&Ii(a,60,rB(c,l))}),Ii(a,391))}function gB(a,n){!n||!n["!ref"]||(Ii(a,648),Ii(a,649,lB(Ka(n["!ref"]))),Ii(a,650))}function _B(a,n,l){n["!links"].forEach(function(c){if(c[1].Target){var f=ga(l,-1,c[1].Target.replace(/#.*$/,""),qn.HLINK);Ii(a,494,Q8(c,f))}}),delete n["!links"]}function xB(a,n,l,c){if(n["!comments"].length>0){var f=ga(c,-1,"../drawings/vmlDrawing"+(l+1)+".vml",qn.VML);Ii(a,551,u2("rId"+f)),n["!legacy"]=f}}function vB(a,n,l,c){if(n["!autofilter"]){var f=n["!autofilter"],i=typeof f.ref=="string"?f.ref:$o(f.ref);l.Workbook||(l.Workbook={Sheets:[]}),l.Workbook.Names||(l.Workbook.Names=[]);var x=l.Workbook.Names,T=Rc(i);T.s.r==T.e.r&&(T.e.r=Rc(n["!ref"]).e.r,i=$o(T));for(var A=0;A<x.length;++A){var M=x[A];if(M.Name=="_xlnm._FilterDatabase"&&M.Sheet==c){M.Ref="'"+l.SheetNames[c]+"'!"+i;break}}A==x.length&&x.push({Name:"_xlnm._FilterDatabase",Sheet:c,Ref:"'"+l.SheetNames[c]+"'!"+i}),Ii(a,161,w0(Ka(i))),Ii(a,162)}}function yB(a,n,l){Ii(a,133),Ii(a,137,sB(n,l)),Ii(a,138),Ii(a,134)}function bB(a,n){n["!protect"]&&Ii(a,535,cB(n["!protect"]))}function wB(a,n,l,c){var f=ec(),i=l.SheetNames[a],x=l.Sheets[i]||{},T=i;try{l&&l.Workbook&&(T=l.Workbook.Sheets[a].CodeName||T)}catch{}var A=Ka(x["!ref"]||"A1");if(A.e.c>16383||A.e.r>1048575){if(n.WTF)throw new Error("Range "+(x["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");A.e.c=Math.min(A.e.c,16383),A.e.r=Math.min(A.e.c,1048575)}return x["!links"]=[],x["!comments"]=[],Ii(f,129),(l.vbaraw||x["!outline"])&&Ii(f,147,m8(T,x["!outline"])),Ii(f,148,d8(A)),yB(f,x,l.Workbook),mB(f,x,a,n,l),fB(f,x,a,n,l),bB(f,x),vB(f,x,l,a),pB(f,x),_B(f,x,c),x["!margins"]&&Ii(f,476,aB(x["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&gB(f,x),xB(f,x,a,c),Ii(f,130),f.end()}function TB(a,n){a.l+=10;var l=sl(a,n-10);return{name:l}}var SB=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function EB(a){return!a.Workbook||!a.Workbook.WBProps?"false":tR(a.Workbook.WBProps.date1904)?"true":"false"}var AB="][*?/\\".split("");function JC(a,n){if(a.length>31){if(n)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var l=!0;return AB.forEach(function(c){if(a.indexOf(c)!=-1){if(!n)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");l=!1}}),l}function CB(a,n,l){a.forEach(function(c,f){JC(c);for(var i=0;i<f;++i)if(c==a[i])throw new Error("Duplicate Sheet Name: "+c);if(l){var x=n&&n[f]&&n[f].CodeName||c;if(x.charCodeAt(0)==95&&x.length>22)throw new Error("Bad Code Name: Worksheet"+x)}})}function IB(a){if(!a||!a.SheetNames||!a.Sheets)throw new Error("Invalid Workbook");if(!a.SheetNames.length)throw new Error("Workbook is empty");var n=a.Workbook&&a.Workbook.Sheets||[];CB(a.SheetNames,n,!!a.vbaraw);for(var l=0;l<a.SheetNames.length;++l)YN(a.Sheets[a.SheetNames[l]],a.SheetNames[l],l)}function QC(a){var n=[Xo];n[n.length]=Vi("workbook",null,{xmlns:v0[0],"xmlns:r":Ss.r});var l=a.Workbook&&(a.Workbook.Names||[]).length>0,c={codeName:"ThisWorkbook"};a.Workbook&&a.Workbook.WBProps&&(SB.forEach(function(T){a.Workbook.WBProps[T[0]]!=null&&a.Workbook.WBProps[T[0]]!=T[1]&&(c[T[0]]=a.Workbook.WBProps[T[0]])}),a.Workbook.WBProps.CodeName&&(c.codeName=a.Workbook.WBProps.CodeName,delete c.CodeName)),n[n.length]=Vi("workbookPr",null,c);var f=a.Workbook&&a.Workbook.Sheets||[],i=0;if(f&&f[0]&&f[0].Hidden){for(n[n.length]="<bookViews>",i=0;i!=a.SheetNames.length&&!(!f[i]||!f[i].Hidden);++i);i==a.SheetNames.length&&(i=0),n[n.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',n[n.length]="</bookViews>"}for(n[n.length]="<sheets>",i=0;i!=a.SheetNames.length;++i){var x={name:_a(a.SheetNames[i].slice(0,31))};if(x.sheetId=""+(i+1),x["r:id"]="rId"+(i+1),f[i])switch(f[i].Hidden){case 1:x.state="hidden";break;case 2:x.state="veryHidden";break}n[n.length]=Vi("sheet",null,x)}return n[n.length]="</sheets>",l&&(n[n.length]="<definedNames>",a.Workbook&&a.Workbook.Names&&a.Workbook.Names.forEach(function(T){var A={name:T.Name};T.Comment&&(A.comment=T.Comment),T.Sheet!=null&&(A.localSheetId=""+T.Sheet),T.Hidden&&(A.hidden="1"),T.Ref&&(n[n.length]=Vi("definedName",_a(T.Ref),A))}),n[n.length]="</definedNames>"),n.length>2&&(n[n.length]="</workbook>",n[1]=n[1].replace("/>",">")),n.join("")}function kB(a,n){var l={};return l.Hidden=a.read_shift(4),l.iTabID=a.read_shift(4),l.strRelID=qb(a,n-8),l.name=sl(a),l}function MB(a,n){return n||(n=ci(127)),n.write_shift(4,a.Hidden),n.write_shift(4,a.iTabID),u2(a.strRelID,n),As(a.name.slice(0,31),n),n.length>n.l?n.slice(0,n.l):n}function DB(a,n){var l={},c=a.read_shift(4);l.defaultThemeVersion=a.read_shift(4);var f=n>8?sl(a):"";return f.length>0&&(l.CodeName=f),l.autoCompressPictures=!!(c&65536),l.backupFile=!!(c&64),l.checkCompatibility=!!(c&4096),l.date1904=!!(c&1),l.filterPrivacy=!!(c&8),l.hidePivotFieldList=!!(c&1024),l.promptedSolutions=!!(c&16),l.publishItems=!!(c&2048),l.refreshAllConnections=!!(c&262144),l.saveExternalLinkValues=!!(c&128),l.showBorderUnselectedTables=!!(c&4),l.showInkAnnotation=!!(c&32),l.showObjects=["all","placeholders","none"][c>>13&3],l.showPivotChartFilter=!!(c&32768),l.updateLinks=["userSet","never","always"][c>>8&3],l}function FB(a,n){n||(n=ci(72));var l=0;return a&&a.filterPrivacy&&(l|=8),n.write_shift(4,l),n.write_shift(4,0),hC(a&&a.CodeName||"ThisWorkbook",n),n.slice(0,n.l)}function PB(a,n,l){var c=a.l+n;a.l+=4,a.l+=1;var f=a.read_shift(4),i=ER(a),x=GN(a,0,l),T=c2(a);a.l=c;var A={Name:i,Ptg:x};return f<268435455&&(A.Sheet=f),T&&(A.Comment=T),A}function LB(a,n){Ii(a,143);for(var l=0;l!=n.SheetNames.length;++l){var c=n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[l]&&n.Workbook.Sheets[l].Hidden||0,f={Hidden:c,iTabID:l+1,strRelID:"rId"+(l+1),name:n.SheetNames[l]};Ii(a,156,MB(f))}Ii(a,144)}function RB(a,n){n||(n=ci(127));for(var l=0;l!=4;++l)n.write_shift(4,0);return As("SheetJS",n),As(Bg.version,n),As(Bg.version,n),As("7262",n),n.length>n.l?n.slice(0,n.l):n}function OB(a,n){n||(n=ci(29)),n.write_shift(-4,0),n.write_shift(-4,460),n.write_shift(4,28800),n.write_shift(4,17600),n.write_shift(4,500),n.write_shift(4,a),n.write_shift(4,a);var l=120;return n.write_shift(1,l),n.length>n.l?n.slice(0,n.l):n}function NB(a,n){if(!(!n.Workbook||!n.Workbook.Sheets)){for(var l=n.Workbook.Sheets,c=0,f=-1,i=-1;c<l.length;++c)!l[c]||!l[c].Hidden&&f==-1?f=c:l[c].Hidden==1&&i==-1&&(i=c);i>f||(Ii(a,135),Ii(a,158,OB(f)),Ii(a,136))}}function BB(a,n){var l=ec();return Ii(l,131),Ii(l,128,RB()),Ii(l,153,FB(a.Workbook&&a.Workbook.WBProps||null)),NB(l,a,n),LB(l,a,n),Ii(l,132),l.end()}function zB(a,n,l){return(n.slice(-4)===".bin"?BB:QC)(a,l)}function jB(a,n,l,c,f){return(n.slice(-4)===".bin"?wB:YC)(a,l,c,f)}function VB(a,n,l){return(n.slice(-4)===".bin"?aO:RC)(a,l)}function UB(a,n,l){return(n.slice(-4)===".bin"?F6:DC)(a,l)}function HB(a,n,l){return(n.slice(-4)===".bin"?bO:jC)(a,l)}function GB(a){return(a.slice(-4)===".bin"?fO:BC)()}function WB(a,n){var l=[];return a.Props&&l.push(VR(a.Props,n)),a.Custprops&&l.push(UR(a.Props,a.Custprops,n)),l.join("")}function qB(){return""}function $B(a,n){var l=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return n.cellXfs.forEach(function(c,f){var i=[];i.push(Vi("NumberFormat",null,{"ss:Format":_a(So[c.numFmtId])}));var x={"ss:ID":"s"+(21+f)};l.push(Vi("Style",i.join(""),x))}),Vi("Styles",l.join(""))}function e4(a){return Vi("NamedRange",null,{"ss:Name":a.Name,"ss:RefersTo":"="+p2(a.Ref,{r:0,c:0})})}function XB(a){if(!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,l=[],c=0;c<n.length;++c){var f=n[c];f.Sheet==null&&(f.Name.match(/^_xlfn\./)||l.push(e4(f)))}return Vi("Names",l.join(""))}function ZB(a,n,l,c){if(!a||!((c||{}).Workbook||{}).Names)return"";for(var f=c.Workbook.Names,i=[],x=0;x<f.length;++x){var T=f[x];T.Sheet==l&&(T.Name.match(/^_xlfn\./)||i.push(e4(T)))}return i.join("")}function YB(a,n,l,c){if(!a)return"";var f=[];if(a["!margins"]&&(f.push("<PageSetup>"),a["!margins"].header&&f.push(Vi("Header",null,{"x:Margin":a["!margins"].header})),a["!margins"].footer&&f.push(Vi("Footer",null,{"x:Margin":a["!margins"].footer})),f.push(Vi("PageMargins",null,{"x:Bottom":a["!margins"].bottom||"0.75","x:Left":a["!margins"].left||"0.7","x:Right":a["!margins"].right||"0.7","x:Top":a["!margins"].top||"0.75"})),f.push("</PageSetup>")),c&&c.Workbook&&c.Workbook.Sheets&&c.Workbook.Sheets[l])if(c.Workbook.Sheets[l].Hidden)f.push(Vi("Visible",c.Workbook.Sheets[l].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<l&&!(c.Workbook.Sheets[i]&&!c.Workbook.Sheets[i].Hidden);++i);i==l&&f.push("<Selected/>")}return((((c||{}).Workbook||{}).Views||[])[0]||{}).RTL&&f.push("<DisplayRightToLeft/>"),a["!protect"]&&(f.push(Hs("ProtectContents","True")),a["!protect"].objects&&f.push(Hs("ProtectObjects","True")),a["!protect"].scenarios&&f.push(Hs("ProtectScenarios","True")),a["!protect"].selectLockedCells!=null&&!a["!protect"].selectLockedCells?f.push(Hs("EnableSelection","NoSelection")):a["!protect"].selectUnlockedCells!=null&&!a["!protect"].selectUnlockedCells&&f.push(Hs("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(x){a["!protect"][x[0]]&&f.push("<"+x[1]+"/>")})),f.length==0?"":Vi("WorksheetOptions",f.join(""),{xmlns:Lc.x})}function KB(a){return a.map(function(n){var l=eR(n.t||""),c=Vi("ss:Data",l,{xmlns:"http://www.w3.org/TR/REC-html40"});return Vi("Comment",c,{"ss:Author":n.a})}).join("")}function JB(a,n,l,c,f,i,x){if(!a||a.v==null&&a.f==null)return"";var T={};if(a.f&&(T["ss:Formula"]="="+_a(p2(a.f,x))),a.F&&a.F.slice(0,n.length)==n){var A=Es(a.F.slice(n.length+1));T["ss:ArrayRange"]="RC:R"+(A.r==x.r?"":"["+(A.r-x.r)+"]")+"C"+(A.c==x.c?"":"["+(A.c-x.c)+"]")}if(a.l&&a.l.Target&&(T["ss:HRef"]=_a(a.l.Target),a.l.Tooltip&&(T["x:HRefScreenTip"]=_a(a.l.Tooltip))),l["!merges"])for(var M=l["!merges"],F=0;F!=M.length;++F)M[F].s.c!=x.c||M[F].s.r!=x.r||(M[F].e.c>M[F].s.c&&(T["ss:MergeAcross"]=M[F].e.c-M[F].s.c),M[F].e.r>M[F].s.r&&(T["ss:MergeDown"]=M[F].e.r-M[F].s.r));var W="",V="";switch(a.t){case"z":if(!c.sheetStubs)return"";break;case"n":W="Number",V=String(a.v);break;case"b":W="Boolean",V=a.v?"1":"0";break;case"e":W="Error",V=$g[a.v];break;case"d":W="DateTime",V=new Date(a.v).toISOString(),a.z==null&&(a.z=a.z||So[14]);break;case"s":W="String",V=QL(a.v||"");break}var R=qf(c.cellXfs,a,c);T["ss:StyleID"]="s"+(21+R),T["ss:Index"]=x.c+1;var te=a.v!=null?V:"",H=a.t=="z"?"":'<Data ss:Type="'+W+'">'+te+"</Data>";return(a.c||[]).length>0&&(H+=KB(a.c)),Vi("Cell",H,T)}function QB(a,n){var l='<Row ss:Index="'+(a+1)+'"';return n&&(n.hpt&&!n.hpx&&(n.hpx=LC(n.hpt)),n.hpx&&(l+=' ss:AutoFitHeight="0" ss:Height="'+n.hpx+'"'),n.hidden&&(l+=' ss:Hidden="1"')),l+">"}function ez(a,n,l,c){if(!a["!ref"])return"";var f=Ka(a["!ref"]),i=a["!merges"]||[],x=0,T=[];a["!cols"]&&a["!cols"].forEach(function(J,K){d2(J);var ne=!!J.width,de=Fx(K,J),De={"ss:Index":K+1};ne&&(De["ss:Width"]=vx(de.width)),J.hidden&&(De["ss:Hidden"]="1"),T.push(Vi("Column",null,De))});for(var A=Array.isArray(a),M=f.s.r;M<=f.e.r;++M){for(var F=[QB(M,(a["!rows"]||[])[M])],W=f.s.c;W<=f.e.c;++W){var V=!1;for(x=0;x!=i.length;++x)if(!(i[x].s.c>W)&&!(i[x].s.r>M)&&!(i[x].e.c<W)&&!(i[x].e.r<M)){(i[x].s.c!=W||i[x].s.r!=M)&&(V=!0);break}if(!V){var R={r:M,c:W},te=xa(R),H=A?(a[M]||[])[W]:a[te];F.push(JB(H,te,a,n,l,c,R))}}F.push("</Row>"),F.length>2&&T.push(F.join(""))}return T.join("")}function tz(a,n,l){var c=[],f=l.SheetNames[a],i=l.Sheets[f],x=i?ZB(i,n,a,l):"";return x.length>0&&c.push("<Names>"+x+"</Names>"),x=i?ez(i,n,a,l):"",x.length>0&&c.push("<Table>"+x+"</Table>"),c.push(YB(i,n,a,l)),c.join("")}function iz(a,n){n||(n={}),a.SSF||(a.SSF=ic(So)),a.SSF&&(Ax(),Ex(a.SSF),n.revssf=Cx(a.SSF),n.revssf[a.SSF[65535]]=0,n.ssf=a.SSF,n.cellXfs=[],qf(n.cellXfs,{},{revssf:{General:0}}));var l=[];l.push(WB(a,n)),l.push(qB(a,n)),l.push(""),l.push("");for(var c=0;c<a.SheetNames.length;++c)l.push(Vi("Worksheet",tz(c,n,a),{"ss:Name":_a(a.SheetNames[c])}));return l[2]=$B(a,n),l[3]=XB(a,n),Xo+Vi("Workbook",l.join(""),{xmlns:Lc.ss,"xmlns:o":Lc.o,"xmlns:x":Lc.x,"xmlns:ss":Lc.ss,"xmlns:dt":Lc.dt,"xmlns:html":Lc.html})}var Vb={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function rz(a,n){var l=[],c=[],f=[],i=0,x,T=o3(v3,"n"),A=o3(y3,"n");if(a.Props)for(x=Ws(a.Props),i=0;i<x.length;++i)(Object.prototype.hasOwnProperty.call(T,x[i])?l:Object.prototype.hasOwnProperty.call(A,x[i])?c:f).push([x[i],a.Props[x[i]]]);if(a.Custprops)for(x=Ws(a.Custprops),i=0;i<x.length;++i)Object.prototype.hasOwnProperty.call(a.Props||{},x[i])||(Object.prototype.hasOwnProperty.call(T,x[i])?l:Object.prototype.hasOwnProperty.call(A,x[i])?c:f).push([x[i],a.Custprops[x[i]]]);var M=[];for(i=0;i<f.length;++i)SC.indexOf(f[i][0])>-1||bC.indexOf(f[i][0])>-1||f[i][1]!=null&&M.push(f[i]);c.length&&Ca.utils.cfb_add(n,"/SummaryInformation",E3(c,Vb.SI,A,y3)),(l.length||M.length)&&Ca.utils.cfb_add(n,"/DocumentSummaryInformation",E3(l,Vb.DSI,T,v3,M.length?M:null,Vb.UDI))}function nz(a,n){var l=n||{},c=Ca.utils.cfb_new({root:"R"}),f="/Workbook";switch(l.bookType||"xls"){case"xls":l.bookType="biff8";case"xla":l.bookType||(l.bookType="xla");case"biff8":f="/Workbook",l.biff=8;break;case"biff5":f="/Book",l.biff=5;break;default:throw new Error("invalid type "+l.bookType+" for XLS CFB")}return Ca.utils.cfb_add(c,f,t4(a,l)),l.biff==8&&(a.Props||a.Custprops)&&rz(a,c),l.biff==8&&a.vbaraw&&wO(c,Ca.read(a.vbaraw,{type:typeof a.vbaraw=="string"?"binary":"buffer"})),c}var az={0:{f:l8},1:{f:g8},2:{f:O8},3:{f:S8},4:{f:y8},5:{f:F8},6:{f:V8},7:{f:I8},8:{f:X8},9:{f:$8},10:{f:W8},11:{f:q8},12:{f:x8},13:{f:B8},14:{f:A8},15:{f:w8},16:{f:L8},17:{f:H8},18:{f:M8},19:{f:l2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:PB},40:{},42:{},43:{f:V6},44:{f:z6},45:{f:G6},46:{f:q6},47:{f:W6},48:{},49:{f:xR},50:{},51:{f:lO},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:v6},62:{f:j8},63:{f:pO},64:{f:uB},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Gh,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:oB},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:p8},148:{f:h8,p:16},151:{f:eB},152:{},153:{f:DB},154:{},155:{},156:{f:kB},157:{},158:{},159:{T:1,f:k6},160:{T:-1},161:{T:1,f:Jp},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Z8},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:oO},336:{T:-1},337:{f:hO,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:qb},357:{},358:{},359:{},360:{T:1},361:{},362:{f:f6},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:tB},427:{f:iB},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:nB},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:f8},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:J8},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:qb},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:vO},633:{T:1},634:{T:-1},635:{T:1,f:_O},636:{T:-1},637:{f:wR},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:TB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:hB},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Ui(a,n,l,c){var f=n;if(!isNaN(f)){var i=c||(l||[]).length||0,x=a.next(4);x.write_shift(2,f),x.write_shift(2,i),i>0&&a2(l)&&a.push(l)}}function oz(a,n,l,c){var f=c||(l||[]).length||0;if(f<=8224)return Ui(a,n,l,f);var i=n;if(!isNaN(i)){for(var x=l.parts||[],T=0,A=0,M=0;M+(x[T]||8224)<=8224;)M+=x[T]||8224,T++;var F=a.next(4);for(F.write_shift(2,i),F.write_shift(2,M),a.push(l.slice(A,A+M)),A+=M;A<f;){for(F=a.next(4),F.write_shift(2,60),M=0;M+(x[T]||8224)<=8224;)M+=x[T]||8224,T++;F.write_shift(2,M),a.push(l.slice(A,A+M)),A+=M}}}function Zg(a,n,l){return a||(a=ci(7)),a.write_shift(2,n),a.write_shift(2,l),a.write_shift(2,0),a.write_shift(1,0),a}function sz(a,n,l,c){var f=ci(9);return Zg(f,a,n),AC(l,c||"b",f),f}function lz(a,n,l){var c=ci(8+2*l.length);return Zg(c,a,n),c.write_shift(1,l.length),c.write_shift(l.length,l,"sbcs"),c.l<c.length?c.slice(0,c.l):c}function cz(a,n,l,c){if(n.v!=null)switch(n.t){case"d":case"n":var f=n.t=="d"?tc(kl(n.v)):n.v;f==(f|0)&&f>=0&&f<65536?Ui(a,2,T6(l,c,f)):Ui(a,3,w6(l,c,f));return;case"b":case"e":Ui(a,5,sz(l,c,n.v,n.t));return;case"s":case"str":Ui(a,4,lz(l,c,(n.v||"").slice(0,255)));return}Ui(a,1,Zg(null,l,c))}function uz(a,n,l,c){var f=Array.isArray(n),i=Ka(n["!ref"]||"A1"),x,T="",A=[];if(i.e.c>255||i.e.r>16383){if(c.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),x=$o(i)}for(var M=i.s.r;M<=i.e.r;++M){T=Gs(M);for(var F=i.s.c;F<=i.e.c;++F){M===i.s.r&&(A[F]=ol(F)),x=A[F]+T;var W=f?(n[M]||[])[F]:n[x];W&&cz(a,W,M,F,c)}}}function hz(a,n){var l=n||{};Hh!=null&&l.dense==null&&(l.dense=Hh);for(var c=ec(),f=0,i=0;i<a.SheetNames.length;++i)a.SheetNames[i]==l.sheet&&(f=i);if(f==0&&l.sheet&&a.SheetNames[0]!=l.sheet)throw new Error("Sheet not found: "+l.sheet);return Ui(c,l.biff==4?1033:l.biff==3?521:9,h2(a,16,l)),uz(c,a.Sheets[a.SheetNames[f]],f,l,a),Ui(c,10),c.end()}function dz(a,n,l){Ui(a,49,a6({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},l))}function fz(a,n,l){n&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(c){for(var f=c[0];f<=c[1];++f)n[f]!=null&&Ui(a,1054,l6(f,n[f],l))})}function pz(a,n){var l=ci(19);l.write_shift(4,2151),l.write_shift(4,0),l.write_shift(4,0),l.write_shift(2,3),l.write_shift(1,1),l.write_shift(4,0),Ui(a,2151,l),l=ci(39),l.write_shift(4,2152),l.write_shift(4,0),l.write_shift(4,0),l.write_shift(2,3),l.write_shift(1,0),l.write_shift(4,0),l.write_shift(2,1),l.write_shift(4,4),l.write_shift(2,0),kC(Ka(n["!ref"]||"A1"),l),l.write_shift(4,4),Ui(a,2152,l)}function mz(a,n){for(var l=0;l<16;++l)Ui(a,224,C3({numFmtId:0,style:!0},0,n));n.cellXfs.forEach(function(c){Ui(a,224,C3(c,0,n))})}function gz(a,n){for(var l=0;l<n["!links"].length;++l){var c=n["!links"][l];Ui(a,440,g6(c)),c[1].Tooltip&&Ui(a,2048,_6(c))}delete n["!links"]}function _z(a,n){if(n){var l=0;n.forEach(function(c,f){++l<=256&&c&&Ui(a,125,y6(Fx(f,c),f))})}}function xz(a,n,l,c,f){var i=16+qf(f.cellXfs,n,f);if(n.v==null&&!n.bf){Ui(a,513,$p(l,c,i));return}if(n.bf)Ui(a,6,UN(n,l,c,f,i));else switch(n.t){case"d":case"n":var x=n.t=="d"?tc(kl(n.v)):n.v;Ui(a,515,d6(l,c,x,i,f));break;case"b":case"e":Ui(a,517,h6(l,c,n.v,i,f,n.t));break;case"s":case"str":if(f.bookSST){var T=g2(f.Strings,n.v,f.revStrings);Ui(a,253,o6(l,c,T,i,f))}else Ui(a,516,s6(l,c,(n.v||"").slice(0,255),i,f));break;default:Ui(a,513,$p(l,c,i))}}function vz(a,n,l){var c=ec(),f=l.SheetNames[a],i=l.Sheets[f]||{},x=(l||{}).Workbook||{},T=(x.Sheets||[])[a]||{},A=Array.isArray(i),M=n.biff==8,F,W="",V=[],R=Ka(i["!ref"]||"A1"),te=M?65536:16384;if(R.e.c>255||R.e.r>=te){if(n.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");R.e.c=Math.min(R.e.c,255),R.e.r=Math.min(R.e.c,te-1)}Ui(c,2057,h2(l,16,n)),Ui(c,13,hu(1)),Ui(c,12,hu(100)),Ui(c,15,Il(!0)),Ui(c,17,Il(!1)),Ui(c,16,qp(.001)),Ui(c,95,Il(!0)),Ui(c,42,Il(!1)),Ui(c,43,Il(!1)),Ui(c,130,hu(1)),Ui(c,128,u6([0,0])),Ui(c,131,Il(!1)),Ui(c,132,Il(!1)),M&&_z(c,i["!cols"]),Ui(c,512,c6(R,n)),M&&(i["!links"]=[]);for(var H=R.s.r;H<=R.e.r;++H){W=Gs(H);for(var J=R.s.c;J<=R.e.c;++J){H===R.s.r&&(V[J]=ol(J)),F=V[J]+W;var K=A?(i[H]||[])[J]:i[F];K&&(xz(c,K,H,J,n),M&&K.l&&i["!links"].push([F,K.l]))}}var ne=T.CodeName||T.name||f;return M&&Ui(c,574,n6((x.Views||[])[0])),M&&(i["!merges"]||[]).length&&Ui(c,229,m6(i["!merges"])),M&&gz(c,i),Ui(c,442,IC(ne,n)),M&&pz(c,i),Ui(c,10),c.end()}function yz(a,n,l){var c=ec(),f=(a||{}).Workbook||{},i=f.Sheets||[],x=f.WBProps||{},T=l.biff==8,A=l.biff==5;if(Ui(c,2057,h2(a,5,l)),l.bookType=="xla"&&Ui(c,135),Ui(c,225,T?hu(1200):null),Ui(c,193,WR(2)),A&&Ui(c,191),A&&Ui(c,192),Ui(c,226),Ui(c,92,e6("SheetJS",l)),Ui(c,66,hu(T?1200:1252)),T&&Ui(c,353,hu(0)),T&&Ui(c,448),Ui(c,317,b6(a.SheetNames.length)),T&&a.vbaraw&&Ui(c,211),T&&a.vbaraw){var M=x.CodeName||"ThisWorkbook";Ui(c,442,IC(M,l))}Ui(c,156,hu(17)),Ui(c,25,Il(!1)),Ui(c,18,Il(!1)),Ui(c,19,hu(0)),T&&Ui(c,431,Il(!1)),T&&Ui(c,444,hu(0)),Ui(c,61,r6(l)),Ui(c,64,Il(!1)),Ui(c,141,hu(0)),Ui(c,34,Il(EB(a)=="true")),Ui(c,14,Il(!0)),T&&Ui(c,439,Il(!1)),Ui(c,218,hu(0)),dz(c,a,l),fz(c,a.SSF,l),mz(c,l),T&&Ui(c,352,Il(!1));var F=c.end(),W=ec();T&&Ui(W,140,x6()),T&&l.Strings&&oz(W,252,i6(l.Strings,l)),Ui(W,10);var V=W.end(),R=ec(),te=0,H=0;for(H=0;H<a.SheetNames.length;++H)te+=(T?12:11)+(T?2:1)*a.SheetNames[H].length;var J=F.length+te+V.length;for(H=0;H<a.SheetNames.length;++H){var K=i[H]||{};Ui(R,133,t6({pos:J,hs:K.Hidden||0,dt:0,name:a.SheetNames[H]},l)),J+=n[H].length}var ne=R.end();if(te!=ne.length)throw new Error("BS8 "+te+" != "+ne.length);var de=[];return F.length&&de.push(F),ne.length&&de.push(ne),V.length&&de.push(V),Us(de)}function bz(a,n){var l=n||{},c=[];a&&!a.SSF&&(a.SSF=ic(So)),a&&a.SSF&&(Ax(),Ex(a.SSF),l.revssf=Cx(a.SSF),l.revssf[a.SSF[65535]]=0,l.ssf=a.SSF),l.Strings=[],l.Strings.Count=0,l.Strings.Unique=0,_2(l),l.cellXfs=[],qf(l.cellXfs,{},{revssf:{General:0}}),a.Props||(a.Props={});for(var f=0;f<a.SheetNames.length;++f)c[c.length]=vz(f,l,a);return c.unshift(yz(a,c,l)),Us(c)}function t4(a,n){for(var l=0;l<=a.SheetNames.length;++l){var c=a.Sheets[a.SheetNames[l]];if(!(!c||!c["!ref"])){var f=Rc(c["!ref"]);f.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+a.SheetNames[l]+"' extends beyond column IV (255).  Data may be lost.")}}var i=n||{};switch(i.biff||2){case 8:case 5:return bz(a,n);case 4:case 3:case 2:return hz(a,n)}throw new Error("invalid type "+i.bookType+" for BIFF")}function wz(a,n,l,c){for(var f=a["!merges"]||[],i=[],x=n.s.c;x<=n.e.c;++x){for(var T=0,A=0,M=0;M<f.length;++M)if(!(f[M].s.r>l||f[M].s.c>x)&&!(f[M].e.r<l||f[M].e.c<x)){if(f[M].s.r<l||f[M].s.c<x){T=-1;break}T=f[M].e.r-f[M].s.r+1,A=f[M].e.c-f[M].s.c+1;break}if(!(T<0)){var F=xa({r:l,c:x}),W=c.dense?(a[l]||[])[x]:a[F],V=W&&W.v!=null&&(W.h||JL(W.w||(Vd(W),W.w)||""))||"",R={};T>1&&(R.rowspan=T),A>1&&(R.colspan=A),c.editable?V='<span contenteditable="true">'+V+"</span>":W&&(R["data-t"]=W&&W.t||"z",W.v!=null&&(R["data-v"]=W.v),W.z!=null&&(R["data-z"]=W.z),W.l&&(W.l.Target||"#").charAt(0)!="#"&&(V='<a href="'+W.l.Target+'">'+V+"</a>")),R.id=(c.id||"sjs")+"-"+F,i.push(Vi("td",V,R))}}var te="<tr>";return te+i.join("")+"</tr>"}var Tz='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Sz="</body></html>";function Ez(a,n,l){var c=[];return c.join("")+"<table"+(l&&l.id?' id="'+l.id+'"':"")+">"}function i4(a,n){var l=n||{},c=l.header!=null?l.header:Tz,f=l.footer!=null?l.footer:Sz,i=[c],x=Rc(a["!ref"]);l.dense=Array.isArray(a),i.push(Ez(a,x,l));for(var T=x.s.r;T<=x.e.r;++T)i.push(wz(a,x,T,l));return i.push("</table>"+f),i.join("")}function r4(a,n,l){var c=l||{};Hh!=null&&(c.dense=Hh);var f=0,i=0;if(c.origin!=null)if(typeof c.origin=="number")f=c.origin;else{var x=typeof c.origin=="string"?Es(c.origin):c.origin;f=x.r,i=x.c}var T=n.getElementsByTagName("tr"),A=Math.min(c.sheetRows||1e7,T.length),M={s:{r:0,c:0},e:{r:f,c:i}};if(a["!ref"]){var F=Rc(a["!ref"]);M.s.r=Math.min(M.s.r,F.s.r),M.s.c=Math.min(M.s.c,F.s.c),M.e.r=Math.max(M.e.r,F.e.r),M.e.c=Math.max(M.e.c,F.e.c),f==-1&&(M.e.r=f=F.e.r+1)}var W=[],V=0,R=a["!rows"]||(a["!rows"]=[]),te=0,H=0,J=0,K=0,ne=0,de=0;for(a["!cols"]||(a["!cols"]=[]);te<T.length&&H<A;++te){var De=T[te];if(L3(De)){if(c.display)continue;R[H]={hidden:!0}}var Fe=De.children;for(J=K=0;J<Fe.length;++J){var et=Fe[J];if(!(c.display&&L3(et))){var Te=et.hasAttribute("data-v")?et.getAttribute("data-v"):et.hasAttribute("v")?et.getAttribute("v"):iR(et.innerHTML),ge=et.getAttribute("data-z")||et.getAttribute("z");for(V=0;V<W.length;++V){var Ve=W[V];Ve.s.c==K+i&&Ve.s.r<H+f&&H+f<=Ve.e.r&&(K=Ve.e.c+1-i,V=-1)}de=+et.getAttribute("colspan")||1,((ne=+et.getAttribute("rowspan")||1)>1||de>1)&&W.push({s:{r:H+f,c:K+i},e:{r:H+f+(ne||1)-1,c:K+i+(de||1)-1}});var Ae={t:"s",v:Te},_e=et.getAttribute("data-t")||et.getAttribute("t")||"";Te!=null&&(Te.length==0?Ae.t=_e||"z":c.raw||Te.trim().length==0||_e=="s"||(Te==="TRUE"?Ae={t:"b",v:!0}:Te==="FALSE"?Ae={t:"b",v:!1}:isNaN(Bd(Te))?isNaN(Vg(Te).getDate())||(Ae={t:"d",v:kl(Te)},c.cellDates||(Ae={t:"n",v:tc(Ae.v)}),Ae.z=c.dateNF||So[14]):Ae={t:"n",v:Bd(Te)})),Ae.z===void 0&&ge!=null&&(Ae.z=ge);var xe="",Qe=et.getElementsByTagName("A");if(Qe&&Qe.length)for(var Ce=0;Ce<Qe.length&&!(Qe[Ce].hasAttribute("href")&&(xe=Qe[Ce].getAttribute("href"),xe.charAt(0)!="#"));++Ce);xe&&xe.charAt(0)!="#"&&(Ae.l={Target:xe}),c.dense?(a[H+f]||(a[H+f]=[]),a[H+f][K+i]=Ae):a[xa({c:K+i,r:H+f})]=Ae,M.e.c<K+i&&(M.e.c=K+i),K+=de}}++H}return W.length&&(a["!merges"]=(a["!merges"]||[]).concat(W)),M.e.r=Math.max(M.e.r,H-1+f),a["!ref"]=$o(M),H>=A&&(a["!fullref"]=$o((M.e.r=T.length-te+H-1+f,M))),a}function n4(a,n){var l=n||{},c=l.dense?[]:{};return r4(c,a,n)}function Az(a,n){return Xp(n4(a,n),n)}function L3(a){var n="",l=Cz(a);return l&&(n=l(a).getPropertyValue("display")),n||(n=a.style&&a.style.display),n==="none"}function Cz(a){return a.ownerDocument.defaultView&&typeof a.ownerDocument.defaultView.getComputedStyle=="function"?a.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var Iz=function(){var a=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),n="<office:document-styles "+Ug({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+a+"</office:document-styles>";return function(){return Xo+n}}(),R3=function(){var a=function(i){return _a(i).replace(/  +/g,function(x){return'<text:s text:c="'+x.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},n=`          <table:table-cell />
`,l=`          <table:covered-table-cell/>
`,c=function(i,x,T){var A=[];A.push('      <table:table table:name="'+_a(x.SheetNames[T])+`" table:style-name="ta1">
`);var M=0,F=0,W=Rc(i["!ref"]||"A1"),V=i["!merges"]||[],R=0,te=Array.isArray(i);if(i["!cols"])for(F=0;F<=W.e.c;++F)A.push("        <table:table-column"+(i["!cols"][F]?' table:style-name="co'+i["!cols"][F].ods+'"':"")+`></table:table-column>
`);var H="",J=i["!rows"]||[];for(M=0;M<W.s.r;++M)H=J[M]?' table:style-name="ro'+J[M].ods+'"':"",A.push("        <table:table-row"+H+`></table:table-row>
`);for(;M<=W.e.r;++M){for(H=J[M]?' table:style-name="ro'+J[M].ods+'"':"",A.push("        <table:table-row"+H+`>
`),F=0;F<W.s.c;++F)A.push(n);for(;F<=W.e.c;++F){var K=!1,ne={},de="";for(R=0;R!=V.length;++R)if(!(V[R].s.c>F)&&!(V[R].s.r>M)&&!(V[R].e.c<F)&&!(V[R].e.r<M)){(V[R].s.c!=F||V[R].s.r!=M)&&(K=!0),ne["table:number-columns-spanned"]=V[R].e.c-V[R].s.c+1,ne["table:number-rows-spanned"]=V[R].e.r-V[R].s.r+1;break}if(K){A.push(l);continue}var De=xa({r:M,c:F}),Fe=te?(i[M]||[])[F]:i[De];if(Fe&&Fe.f&&(ne["table:formula"]=_a(XN(Fe.f)),Fe.F&&Fe.F.slice(0,De.length)==De)){var et=Rc(Fe.F);ne["table:number-matrix-columns-spanned"]=et.e.c-et.s.c+1,ne["table:number-matrix-rows-spanned"]=et.e.r-et.s.r+1}if(!Fe){A.push(n);continue}switch(Fe.t){case"b":de=Fe.v?"TRUE":"FALSE",ne["office:value-type"]="boolean",ne["office:boolean-value"]=Fe.v?"true":"false";break;case"n":de=Fe.w||String(Fe.v||0),ne["office:value-type"]="float",ne["office:value"]=Fe.v||0;break;case"s":case"str":de=Fe.v==null?"":Fe.v,ne["office:value-type"]="string";break;case"d":de=Fe.w||kl(Fe.v).toISOString(),ne["office:value-type"]="date",ne["office:date-value"]=kl(Fe.v).toISOString(),ne["table:style-name"]="ce1";break;default:A.push(n);continue}var Te=a(de);if(Fe.l&&Fe.l.Target){var ge=Fe.l.Target;ge=ge.charAt(0)=="#"?"#"+ZN(ge.slice(1)):ge,ge.charAt(0)!="#"&&!ge.match(/^\w+:/)&&(ge="../"+ge),Te=Vi("text:a",Te,{"xlink:href":ge.replace(/&/g,"&amp;")})}A.push("          "+Vi("table:table-cell",Vi("text:p",Te,{}),ne)+`
`)}A.push(`        </table:table-row>
`)}return A.push(`      </table:table>
`),A.join("")},f=function(i,x){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var T=0;x.SheetNames.map(function(M){return x.Sheets[M]}).forEach(function(M){if(M&&M["!cols"]){for(var F=0;F<M["!cols"].length;++F)if(M["!cols"][F]){var W=M["!cols"][F];if(W.width==null&&W.wpx==null&&W.wch==null)continue;d2(W),W.ods=T;var V=M["!cols"][F].wpx+"px";i.push('  <style:style style:name="co'+T+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+V+`"/>
`),i.push(`  </style:style>
`),++T}}});var A=0;x.SheetNames.map(function(M){return x.Sheets[M]}).forEach(function(M){if(M&&M["!rows"]){for(var F=0;F<M["!rows"].length;++F)if(M["!rows"][F]){M["!rows"][F].ods=A;var W=M["!rows"][F].hpx+"px";i.push('  <style:style style:name="ro'+A+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+W+`"/>
`),i.push(`  </style:style>
`),++A}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(x,T){var A=[Xo],M=Ug({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),F=Ug({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});T.bookType=="fods"?(A.push("<office:document"+M+F+`>
`),A.push(vC().replace(/office:document-meta/g,"office:meta"))):A.push("<office:document-content"+M+`>
`),f(A,x),A.push(`  <office:body>
`),A.push(`    <office:spreadsheet>
`);for(var W=0;W!=x.SheetNames.length;++W)A.push(c(x.Sheets[x.SheetNames[W]],x,W,T));return A.push(`    </office:spreadsheet>
`),A.push(`  </office:body>
`),T.bookType=="fods"?A.push("</office:document>"):A.push("</office:document-content>"),A.join("")}}();function a4(a,n){if(n.bookType=="fods")return R3(a,n);var l=Kb(),c="",f=[],i=[];return c="mimetype",hn(l,c,"application/vnd.oasis.opendocument.spreadsheet"),c="content.xml",hn(l,c,R3(a,n)),f.push([c,"text/xml"]),i.push([c,"ContentFile"]),c="styles.xml",hn(l,c,Iz(a,n)),f.push([c,"text/xml"]),i.push([c,"StylesFile"]),c="meta.xml",hn(l,c,Xo+vC()),f.push([c,"text/xml"]),i.push([c,"MetadataFile"]),c="manifest.rdf",hn(l,c,jR(i)),f.push([c,"application/rdf+xml"]),c="META-INF/manifest.xml",hn(l,c,BR(f)),l}function wx(a){return new DataView(a.buffer,a.byteOffset,a.byteLength)}function kz(a){return typeof TextEncoder<"u"?new TextEncoder().encode(a):Qu(Od(a))}function Mz(a,n){e:for(var l=0;l<=a.length-n.length;++l){for(var c=0;c<n.length;++c)if(a[l+c]!=n[c])continue e;return!0}return!1}function Wf(a){var n=a.reduce(function(f,i){return f+i.length},0),l=new Uint8Array(n),c=0;return a.forEach(function(f){l.set(f,c),c+=f.length}),l}function Dz(a,n,l){var c=Math.floor(l==0?0:Math.LOG10E*Math.log(Math.abs(l)))+6176-20,f=l/Math.pow(10,c-6176);a[n+15]|=c>>7,a[n+14]|=(c&127)<<1;for(var i=0;f>=1;++i,f/=256)a[n+i]=f&255;a[n+15]|=l>=0?0:128}function Hg(a,n){var l=n?n[0]:0,c=a[l]&127;e:if(a[l++]>=128&&(c|=(a[l]&127)<<7,a[l++]<128||(c|=(a[l]&127)<<14,a[l++]<128)||(c|=(a[l]&127)<<21,a[l++]<128)||(c+=(a[l]&127)*Math.pow(2,28),++l,a[l++]<128)||(c+=(a[l]&127)*Math.pow(2,35),++l,a[l++]<128)||(c+=(a[l]&127)*Math.pow(2,42),++l,a[l++]<128)))break e;return n&&(n[0]=l),c}function ma(a){var n=new Uint8Array(7);n[0]=a&127;var l=1;e:if(a>127){if(n[l-1]|=128,n[l]=a>>7&127,++l,a<=16383||(n[l-1]|=128,n[l]=a>>14&127,++l,a<=2097151)||(n[l-1]|=128,n[l]=a>>21&127,++l,a<=268435455)||(n[l-1]|=128,n[l]=a/256>>>21&127,++l,a<=34359738367)||(n[l-1]|=128,n[l]=a/65536>>>21&127,++l,a<=4398046511103))break e;n[l-1]|=128,n[l]=a/16777216>>>21&127,++l}return n.slice(0,l)}function g0(a){var n=0,l=a[n]&127;e:if(a[n++]>=128){if(l|=(a[n]&127)<<7,a[n++]<128||(l|=(a[n]&127)<<14,a[n++]<128)||(l|=(a[n]&127)<<21,a[n++]<128))break e;l|=(a[n]&127)<<28}return l}function rs(a){for(var n=[],l=[0];l[0]<a.length;){var c=l[0],f=Hg(a,l),i=f&7;f=Math.floor(f/8);var x=0,T;if(f==0)break;switch(i){case 0:{for(var A=l[0];a[l[0]++]>=128;);T=a.slice(A,l[0])}break;case 5:x=4,T=a.slice(l[0],l[0]+x),l[0]+=x;break;case 1:x=8,T=a.slice(l[0],l[0]+x),l[0]+=x;break;case 2:x=Hg(a,l),T=a.slice(l[0],l[0]+x),l[0]+=x;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(f," at offset ").concat(c))}var M={data:T,type:i};n[f]==null?n[f]=[M]:n[f].push(M)}return n}function js(a){var n=[];return a.forEach(function(l,c){l.forEach(function(f){f.data&&(n.push(ma(c*8+f.type)),f.type==2&&n.push(ma(f.data.length)),n.push(f.data))})}),Wf(n)}function Ku(a){for(var n,l=[],c=[0];c[0]<a.length;){var f=Hg(a,c),i=rs(a.slice(c[0],c[0]+f));c[0]+=f;var x={id:g0(i[1][0].data),messages:[]};i[2].forEach(function(T){var A=rs(T.data),M=g0(A[3][0].data);x.messages.push({meta:A,data:a.slice(c[0],c[0]+M)}),c[0]+=M}),(n=i[3])!=null&&n[0]&&(x.merge=g0(i[3][0].data)>>>0>0),l.push(x)}return l}function l0(a){var n=[];return a.forEach(function(l){var c=[];c[1]=[{data:ma(l.id),type:0}],c[2]=[],l.merge!=null&&(c[3]=[{data:ma(+!!l.merge),type:0}]);var f=[];l.messages.forEach(function(x){f.push(x.data),x.meta[3]=[{type:0,data:ma(x.data.length)}],c[2].push({data:js(x.meta),type:2})});var i=js(c);n.push(ma(i.length)),n.push(i),f.forEach(function(x){return n.push(x)})}),Wf(n)}function Fz(a,n){if(a!=0)throw new Error("Unexpected Snappy chunk type ".concat(a));for(var l=[0],c=Hg(n,l),f=[];l[0]<n.length;){var i=n[l[0]]&3;if(i==0){var x=n[l[0]++]>>2;if(x<60)++x;else{var T=x-59;x=n[l[0]],T>1&&(x|=n[l[0]+1]<<8),T>2&&(x|=n[l[0]+2]<<16),T>3&&(x|=n[l[0]+3]<<24),x>>>=0,x++,l[0]+=T}f.push(n.slice(l[0],l[0]+x)),l[0]+=x;continue}else{var A=0,M=0;if(i==1?(M=(n[l[0]]>>2&7)+4,A=(n[l[0]++]&224)<<3,A|=n[l[0]++]):(M=(n[l[0]++]>>2)+1,i==2?(A=n[l[0]]|n[l[0]+1]<<8,l[0]+=2):(A=(n[l[0]]|n[l[0]+1]<<8|n[l[0]+2]<<16|n[l[0]+3]<<24)>>>0,l[0]+=4)),f=[Wf(f)],A==0)throw new Error("Invalid offset 0");if(A>f[0].length)throw new Error("Invalid offset beyond length");if(M>=A)for(f.push(f[0].slice(-A)),M-=A;M>=f[f.length-1].length;)f.push(f[f.length-1]),M-=f[f.length-1].length;f.push(f[0].slice(-A,-A+M))}}var F=Wf(f);if(F.length!=c)throw new Error("Unexpected length: ".concat(F.length," != ").concat(c));return F}function Ju(a){for(var n=[],l=0;l<a.length;){var c=a[l++],f=a[l]|a[l+1]<<8|a[l+2]<<16;l+=3,n.push(Fz(c,a.slice(l,l+f))),l+=f}if(l!==a.length)throw new Error("data is not a valid framed stream!");return Wf(n)}function c0(a){for(var n=[],l=0;l<a.length;){var c=Math.min(a.length-l,268435455),f=new Uint8Array(4);n.push(f);var i=ma(c),x=i.length;n.push(i),c<=60?(x++,n.push(new Uint8Array([c-1<<2]))):c<=256?(x+=2,n.push(new Uint8Array([240,c-1&255]))):c<=65536?(x+=3,n.push(new Uint8Array([244,c-1&255,c-1>>8&255]))):c<=16777216?(x+=4,n.push(new Uint8Array([248,c-1&255,c-1>>8&255,c-1>>16&255]))):c<=4294967296&&(x+=5,n.push(new Uint8Array([252,c-1&255,c-1>>8&255,c-1>>16&255,c-1>>>24&255]))),n.push(a.slice(l,l+c)),x+=c,f[0]=0,f[1]=x&255,f[2]=x>>8&255,f[3]=x>>16&255,l+=c}return Wf(n)}function Ub(a,n){var l=new Uint8Array(32),c=wx(l),f=12,i=0;switch(l[0]=5,a.t){case"n":l[1]=2,Dz(l,f,a.v),i|=1,f+=16;break;case"b":l[1]=6,c.setFloat64(f,a.v?1:0,!0),i|=2,f+=8;break;case"s":if(n.indexOf(a.v)==-1)throw new Error("Value ".concat(a.v," missing from SST!"));l[1]=3,c.setUint32(f,n.indexOf(a.v),!0),i|=8,f+=4;break;default:throw"unsupported cell type "+a.t}return c.setUint32(8,i,!0),l.slice(0,f)}function Hb(a,n){var l=new Uint8Array(32),c=wx(l),f=12,i=0;switch(l[0]=3,a.t){case"n":l[2]=2,c.setFloat64(f,a.v,!0),i|=32,f+=8;break;case"b":l[2]=6,c.setFloat64(f,a.v?1:0,!0),i|=32,f+=8;break;case"s":if(n.indexOf(a.v)==-1)throw new Error("Value ".concat(a.v," missing from SST!"));l[2]=3,c.setUint32(f,n.indexOf(a.v),!0),i|=16,f+=4;break;default:throw"unsupported cell type "+a.t}return c.setUint32(4,i,!0),l.slice(0,f)}function jf(a){var n=rs(a);return Hg(n[1][0].data)}function Pz(a,n,l){var c,f,i,x;if(!((c=a[6])!=null&&c[0])||!((f=a[7])!=null&&f[0]))throw"Mutation only works on post-BNC storages!";var T=((x=(i=a[8])==null?void 0:i[0])==null?void 0:x.data)&&g0(a[8][0].data)>0||!1;if(T)throw"Math only works with normal offsets";for(var A=0,M=wx(a[7][0].data),F=0,W=[],V=wx(a[4][0].data),R=0,te=[],H=0;H<n.length;++H){if(n[H]==null){M.setUint16(H*2,65535,!0),V.setUint16(H*2,65535);continue}M.setUint16(H*2,F,!0),V.setUint16(H*2,R,!0);var J,K;switch(typeof n[H]){case"string":J=Ub({t:"s",v:n[H]},l),K=Hb({t:"s",v:n[H]},l);break;case"number":J=Ub({t:"n",v:n[H]},l),K=Hb({t:"n",v:n[H]},l);break;case"boolean":J=Ub({t:"b",v:n[H]},l),K=Hb({t:"b",v:n[H]},l);break;default:throw new Error("Unsupported value "+n[H])}W.push(J),F+=J.length,te.push(K),R+=K.length,++A}for(a[2][0].data=ma(A);H<a[7][0].data.length/2;++H)M.setUint16(H*2,65535,!0),V.setUint16(H*2,65535,!0);return a[6][0].data=Wf(W),a[3][0].data=Wf(te),A}function Lz(a,n){if(!n||!n.numbers)throw new Error("Must pass a `numbers` option -- check the README");var l=a.Sheets[a.SheetNames[0]];a.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var c=Rc(l["!ref"]);c.s.r=c.s.c=0;var f=!1;c.e.c>9&&(f=!0,c.e.c=9),c.e.r>49&&(f=!0,c.e.r=49),f&&console.error("The Numbers writer is currently limited to ".concat($o(c)));var i=Tx(l,{range:c,header:1}),x=["~Sh33tJ5~"];i.forEach(function(pe){return pe.forEach(function(Ie){typeof Ie=="string"&&x.push(Ie)})});var T={},A=[],M=Ca.read(n.numbers,{type:"base64"});M.FileIndex.map(function(pe,Ie){return[pe,M.FullPaths[Ie]]}).forEach(function(pe){var Ie=pe[0],Ue=pe[1];if(Ie.type==2&&Ie.name.match(/\.iwa/)){var gt=Ie.content,mt=Ju(gt),wt=Ku(mt);wt.forEach(function(Lt){A.push(Lt.id),T[Lt.id]={deps:[],location:Ue,type:g0(Lt.messages[0].meta[1][0].data)}})}}),A.sort(function(pe,Ie){return pe-Ie});var F=A.filter(function(pe){return pe>1}).map(function(pe){return[pe,ma(pe)]});M.FileIndex.map(function(pe,Ie){return[pe,M.FullPaths[Ie]]}).forEach(function(pe){var Ie=pe[0],Ue=pe[1];if(Ie.name.match(/\.iwa/)){var gt=Ku(Ju(Ie.content));gt.forEach(function(mt){mt.messages.forEach(function(wt){F.forEach(function(Lt){mt.messages.some(function(fi){return g0(fi.meta[1][0].data)!=11006&&Mz(fi.data,Lt[1])})&&T[Lt[0]].deps.push(mt.id)})})})}});function W(){for(var pe=927262;pe<2e6;++pe)if(!T[pe])return pe;throw new Error("Too many messages")}for(var V=Ca.find(M,T[1].location),R=Ku(Ju(V.content)),te,H=0;H<R.length;++H){var J=R[H];J.id==1&&(te=J)}var K=jf(rs(te.messages[0].data)[1][0].data);for(V=Ca.find(M,T[K].location),R=Ku(Ju(V.content)),H=0;H<R.length;++H)J=R[H],J.id==K&&(te=J);for(K=jf(rs(te.messages[0].data)[2][0].data),V=Ca.find(M,T[K].location),R=Ku(Ju(V.content)),H=0;H<R.length;++H)J=R[H],J.id==K&&(te=J);for(K=jf(rs(te.messages[0].data)[2][0].data),V=Ca.find(M,T[K].location),R=Ku(Ju(V.content)),H=0;H<R.length;++H)J=R[H],J.id==K&&(te=J);var ne=rs(te.messages[0].data);{ne[6][0].data=ma(c.e.r+1),ne[7][0].data=ma(c.e.c+1);var de=jf(ne[46][0].data),De=Ca.find(M,T[de].location),Fe=Ku(Ju(De.content));{for(var et=0;et<Fe.length&&Fe[et].id!=de;++et);if(Fe[et].id!=de)throw"Bad ColumnRowUIDMapArchive";var Te=rs(Fe[et].messages[0].data);Te[1]=[],Te[2]=[],Te[3]=[];for(var ge=0;ge<=c.e.c;++ge){var Ve=[];Ve[1]=Ve[2]=[{type:0,data:ma(ge+420690)}],Te[1].push({type:2,data:js(Ve)}),Te[2].push({type:0,data:ma(ge)}),Te[3].push({type:0,data:ma(ge)})}Te[4]=[],Te[5]=[],Te[6]=[];for(var Ae=0;Ae<=c.e.r;++Ae)Ve=[],Ve[1]=Ve[2]=[{type:0,data:ma(Ae+726270)}],Te[4].push({type:2,data:js(Ve)}),Te[5].push({type:0,data:ma(Ae)}),Te[6].push({type:0,data:ma(Ae)});Fe[et].messages[0].data=js(Te)}De.content=c0(l0(Fe)),De.size=De.content.length,delete ne[46];var _e=rs(ne[4][0].data);{_e[7][0].data=ma(c.e.r+1);var xe=rs(_e[1][0].data),Qe=jf(xe[2][0].data);De=Ca.find(M,T[Qe].location),Fe=Ku(Ju(De.content));{if(Fe[0].id!=Qe)throw"Bad HeaderStorageBucket";var Ce=rs(Fe[0].messages[0].data);for(Ae=0;Ae<i.length;++Ae){var Ye=rs(Ce[2][0].data);Ye[1][0].data=ma(Ae),Ye[4][0].data=ma(i[Ae].length),Ce[2][Ae]={type:Ce[2][0].type,data:js(Ye)}}Fe[0].messages[0].data=js(Ce)}De.content=c0(l0(Fe)),De.size=De.content.length;var ut=jf(_e[2][0].data);De=Ca.find(M,T[ut].location),Fe=Ku(Ju(De.content));{if(Fe[0].id!=ut)throw"Bad HeaderStorageBucket";for(Ce=rs(Fe[0].messages[0].data),ge=0;ge<=c.e.c;++ge)Ye=rs(Ce[2][0].data),Ye[1][0].data=ma(ge),Ye[4][0].data=ma(c.e.r+1),Ce[2][ge]={type:Ce[2][0].type,data:js(Ye)};Fe[0].messages[0].data=js(Ce)}De.content=c0(l0(Fe)),De.size=De.content.length;var st=jf(_e[4][0].data);(function(){for(var pe=Ca.find(M,T[st].location),Ie=Ku(Ju(pe.content)),Ue,gt=0;gt<Ie.length;++gt){var mt=Ie[gt];mt.id==st&&(Ue=mt)}var wt=rs(Ue.messages[0].data);{wt[3]=[];var Lt=[];x.forEach(function(Fi,Pi){Lt[1]=[{type:0,data:ma(Pi)}],Lt[2]=[{type:0,data:ma(1)}],Lt[3]=[{type:2,data:kz(Fi)}],wt[3].push({type:2,data:js(Lt)})})}Ue.messages[0].data=js(wt);var fi=l0(Ie),yi=c0(fi);pe.content=yi,pe.size=pe.content.length})();var pt=rs(_e[3][0].data);{var Tt=pt[1][0];delete pt[2];var ht=rs(Tt.data);{var Wt=jf(ht[2][0].data);(function(){for(var pe=Ca.find(M,T[Wt].location),Ie=Ku(Ju(pe.content)),Ue,gt=0;gt<Ie.length;++gt){var mt=Ie[gt];mt.id==Wt&&(Ue=mt)}var wt=rs(Ue.messages[0].data);{delete wt[6],delete pt[7];var Lt=new Uint8Array(wt[5][0].data);wt[5]=[];for(var fi=0,yi=0;yi<=c.e.r;++yi){var Fi=rs(Lt);fi+=Pz(Fi,i[yi],x),Fi[1][0].data=ma(yi),wt[5].push({data:js(Fi),type:2})}wt[1]=[{type:0,data:ma(c.e.c+1)}],wt[2]=[{type:0,data:ma(c.e.r+1)}],wt[3]=[{type:0,data:ma(fi)}],wt[4]=[{type:0,data:ma(c.e.r+1)}]}Ue.messages[0].data=js(wt);var Pi=l0(Ie),$t=c0(Pi);pe.content=$t,pe.size=pe.content.length})()}Tt.data=js(ht)}_e[3][0].data=js(pt)}ne[4][0].data=js(_e)}te.messages[0].data=js(ne);var ie=l0(R),ye=c0(ie);return V.content=ye,V.size=V.content.length,M}function Rz(a){return function(l){for(var c=0;c!=a.length;++c){var f=a[c];l[f[0]]===void 0&&(l[f[0]]=f[1]),f[2]==="n"&&(l[f[0]]=Number(l[f[0]]))}}}function _2(a){Rz([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(a)}function Oz(a,n){return n.bookType=="ods"?a4(a,n):n.bookType=="numbers"?Lz(a,n):n.bookType=="xlsb"?Nz(a,n):Bz(a,n)}function Nz(a,n){h0=1024,a&&!a.SSF&&(a.SSF=ic(So)),a&&a.SSF&&(Ax(),Ex(a.SSF),n.revssf=Cx(a.SSF),n.revssf[a.SSF[65535]]=0,n.ssf=a.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Ng?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var l=n.bookType=="xlsb"?"bin":"xml",c=VC.indexOf(n.bookType)>-1,f=gC();_2(n=n||{});var i=Kb(),x="",T=0;if(n.cellXfs=[],qf(n.cellXfs,{},{revssf:{General:0}}),a.Props||(a.Props={}),x="docProps/core.xml",hn(i,x,yC(a.Props,n)),f.coreprops.push(x),ga(n.rels,2,x,qn.CORE_PROPS),x="docProps/app.xml",!(a.Props&&a.Props.SheetNames))if(!a.Workbook||!a.Workbook.Sheets)a.Props.SheetNames=a.SheetNames;else{for(var A=[],M=0;M<a.SheetNames.length;++M)(a.Workbook.Sheets[M]||{}).Hidden!=2&&A.push(a.SheetNames[M]);a.Props.SheetNames=A}for(a.Props.Worksheets=a.Props.SheetNames.length,hn(i,x,wC(a.Props,n)),f.extprops.push(x),ga(n.rels,3,x,qn.EXT_PROPS),a.Custprops!==a.Props&&Ws(a.Custprops||{}).length>0&&(x="docProps/custom.xml",hn(i,x,TC(a.Custprops,n)),f.custprops.push(x),ga(n.rels,4,x,qn.CUST_PROPS)),T=1;T<=a.SheetNames.length;++T){var F={"!id":{}},W=a.Sheets[a.SheetNames[T-1]],V=(W||{})["!type"]||"sheet";switch(V){case"chart":default:x="xl/worksheets/sheet"+T+"."+l,hn(i,x,jB(T-1,x,n,a,F)),f.sheets.push(x),ga(n.wbrels,-1,"worksheets/sheet"+T+"."+l,qn.WS[0])}if(W){var R=W["!comments"],te=!1,H="";R&&R.length>0&&(H="xl/comments"+T+"."+l,hn(i,H,HB(R,H,n)),f.comments.push(H),ga(F,-1,"../comments"+T+"."+l,qn.CMNT),te=!0),W["!legacy"]&&te&&hn(i,"xl/drawings/vmlDrawing"+T+".vml",zC(T,W["!comments"])),delete W["!comments"],delete W["!legacy"]}F["!id"].rId1&&hn(i,xC(x),p0(F))}return n.Strings!=null&&n.Strings.length>0&&(x="xl/sharedStrings."+l,hn(i,x,UB(n.Strings,x,n)),f.strs.push(x),ga(n.wbrels,-1,"sharedStrings."+l,qn.SST)),x="xl/workbook."+l,hn(i,x,zB(a,x,n)),f.workbooks.push(x),ga(n.rels,1,x,qn.WB),x="xl/theme/theme1.xml",hn(i,x,NC(a.Themes,n)),f.themes.push(x),ga(n.wbrels,-1,"theme/theme1.xml",qn.THEME),x="xl/styles."+l,hn(i,x,VB(a,x,n)),f.styles.push(x),ga(n.wbrels,-1,"styles."+l,qn.STY),a.vbaraw&&c&&(x="xl/vbaProject.bin",hn(i,x,a.vbaraw),f.vba.push(x),ga(n.wbrels,-1,"vbaProject.bin",qn.VBA)),x="xl/metadata."+l,hn(i,x,GB(x)),f.metadata.push(x),ga(n.wbrels,-1,"metadata."+l,qn.XLMETA),hn(i,"[Content_Types].xml",_C(f,n)),hn(i,"_rels/.rels",p0(n.rels)),hn(i,"xl/_rels/workbook."+l+".rels",p0(n.wbrels)),delete n.revssf,delete n.ssf,i}function Bz(a,n){h0=1024,a&&!a.SSF&&(a.SSF=ic(So)),a&&a.SSF&&(Ax(),Ex(a.SSF),n.revssf=Cx(a.SSF),n.revssf[a.SSF[65535]]=0,n.ssf=a.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Ng?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var l="xml",c=VC.indexOf(n.bookType)>-1,f=gC();_2(n=n||{});var i=Kb(),x="",T=0;if(n.cellXfs=[],qf(n.cellXfs,{},{revssf:{General:0}}),a.Props||(a.Props={}),x="docProps/core.xml",hn(i,x,yC(a.Props,n)),f.coreprops.push(x),ga(n.rels,2,x,qn.CORE_PROPS),x="docProps/app.xml",!(a.Props&&a.Props.SheetNames))if(!a.Workbook||!a.Workbook.Sheets)a.Props.SheetNames=a.SheetNames;else{for(var A=[],M=0;M<a.SheetNames.length;++M)(a.Workbook.Sheets[M]||{}).Hidden!=2&&A.push(a.SheetNames[M]);a.Props.SheetNames=A}a.Props.Worksheets=a.Props.SheetNames.length,hn(i,x,wC(a.Props,n)),f.extprops.push(x),ga(n.rels,3,x,qn.EXT_PROPS),a.Custprops!==a.Props&&Ws(a.Custprops||{}).length>0&&(x="docProps/custom.xml",hn(i,x,TC(a.Custprops,n)),f.custprops.push(x),ga(n.rels,4,x,qn.CUST_PROPS));var F=["SheetJ5"];for(n.tcid=0,T=1;T<=a.SheetNames.length;++T){var W={"!id":{}},V=a.Sheets[a.SheetNames[T-1]],R=(V||{})["!type"]||"sheet";switch(R){case"chart":default:x="xl/worksheets/sheet"+T+"."+l,hn(i,x,YC(T-1,n,a,W)),f.sheets.push(x),ga(n.wbrels,-1,"worksheets/sheet"+T+"."+l,qn.WS[0])}if(V){var te=V["!comments"],H=!1,J="";if(te&&te.length>0){var K=!1;te.forEach(function(ne){ne[1].forEach(function(de){de.T==!0&&(K=!0)})}),K&&(J="xl/threadedComments/threadedComment"+T+"."+l,hn(i,J,mO(te,F,n)),f.threadedcomments.push(J),ga(W,-1,"../threadedComments/threadedComment"+T+"."+l,qn.TCMNT)),J="xl/comments"+T+"."+l,hn(i,J,jC(te,n)),f.comments.push(J),ga(W,-1,"../comments"+T+"."+l,qn.CMNT),H=!0}V["!legacy"]&&H&&hn(i,"xl/drawings/vmlDrawing"+T+".vml",zC(T,V["!comments"])),delete V["!comments"],delete V["!legacy"]}W["!id"].rId1&&hn(i,xC(x),p0(W))}return n.Strings!=null&&n.Strings.length>0&&(x="xl/sharedStrings."+l,hn(i,x,DC(n.Strings,n)),f.strs.push(x),ga(n.wbrels,-1,"sharedStrings."+l,qn.SST)),x="xl/workbook."+l,hn(i,x,QC(a,n)),f.workbooks.push(x),ga(n.rels,1,x,qn.WB),x="xl/theme/theme1.xml",hn(i,x,NC(a.Themes,n)),f.themes.push(x),ga(n.wbrels,-1,"theme/theme1.xml",qn.THEME),x="xl/styles."+l,hn(i,x,RC(a,n)),f.styles.push(x),ga(n.wbrels,-1,"styles."+l,qn.STY),a.vbaraw&&c&&(x="xl/vbaProject.bin",hn(i,x,a.vbaraw),f.vba.push(x),ga(n.wbrels,-1,"vbaProject.bin",qn.VBA)),x="xl/metadata."+l,hn(i,x,BC()),f.metadata.push(x),ga(n.wbrels,-1,"metadata."+l,qn.XLMETA),F.length>1&&(x="xl/persons/person.xml",hn(i,x,gO(F,n)),f.people.push(x),ga(n.wbrels,-1,"persons/person.xml",qn.PEOPLE)),hn(i,"[Content_Types].xml",_C(f,n)),hn(i,"_rels/.rels",p0(n.rels)),hn(i,"xl/_rels/workbook."+l+".rels",p0(n.wbrels)),delete n.revssf,delete n.ssf,i}function zz(a,n){var l="";switch((n||{}).type||"base64"){case"buffer":return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]];case"base64":l=jd(a.slice(0,12));break;case"binary":l=a;break;case"array":return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[l.charCodeAt(0),l.charCodeAt(1),l.charCodeAt(2),l.charCodeAt(3),l.charCodeAt(4),l.charCodeAt(5),l.charCodeAt(6),l.charCodeAt(7)]}function o4(a,n){switch(n.type){case"base64":case"binary":break;case"buffer":case"array":n.type="";break;case"file":return qg(n.file,Ca.write(a,{type:ta?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");default:throw new Error("Unrecognized type "+n.type)}return Ca.write(a,n)}function jz(a,n){var l=ic(n||{}),c=Oz(a,l);return Vz(c,l)}function Vz(a,n){var l={},c=ta?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(n.compression&&(l.compression="DEFLATE"),n.password)l.type=c;else switch(n.type){case"base64":l.type="base64";break;case"binary":l.type="string";break;case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");case"buffer":case"file":l.type=c;break;default:throw new Error("Unrecognized type "+n.type)}var f=a.FullPaths?Ca.write(a,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[l.type]||l.type,compression:!!n.compression}):a.generate(l);if(typeof Deno<"u"&&typeof f=="string"){if(n.type=="binary"||n.type=="base64")return f;f=new Uint8Array(Sx(f))}return n.password&&typeof encrypt_agile<"u"?o4(encrypt_agile(f,n.password),n):n.type==="file"?qg(n.file,f):n.type=="string"?Pg(f):f}function Uz(a,n){var l=n||{},c=nz(a,l);return o4(c,l)}function Uh(a,n,l){l||(l="");var c=l+a;switch(n.type){case"base64":return jg(Od(c));case"binary":return Od(c);case"string":return a;case"file":return qg(n.file,c,"utf8");case"buffer":return ta?Ud(c,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(c):Uh(c,{type:"binary"}).split("").map(function(f){return f.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function Hz(a,n){switch(n.type){case"base64":return jg(a);case"binary":return a;case"string":return a;case"file":return qg(n.file,a,"binary");case"buffer":return ta?Ud(a,"binary"):a.split("").map(function(l){return l.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function ux(a,n){switch(n.type){case"string":case"base64":case"binary":for(var l="",c=0;c<a.length;++c)l+=String.fromCharCode(a[c]);return n.type=="base64"?jg(l):n.type=="string"?Pg(l):l;case"file":return qg(n.file,a);case"buffer":return a;default:throw new Error("Unrecognized type "+n.type)}}function s4(a,n){mL(),IB(a);var l=ic(n||{});if(l.cellStyles&&(l.cellNF=!0,l.sheetStubs=!0),l.type=="array"){l.type="binary";var c=s4(a,l);return l.type="array",Sx(c)}var f=0;if(l.sheet&&(typeof l.sheet=="number"?f=l.sheet:f=a.SheetNames.indexOf(l.sheet),!a.SheetNames[f]))throw new Error("Sheet not found: "+l.sheet+" : "+typeof l.sheet);switch(l.bookType||"xlsb"){case"xml":case"xlml":return Uh(iz(a,l),l);case"slk":case"sylk":return Uh(E6.from_sheet(a.Sheets[a.SheetNames[f]],l),l);case"htm":case"html":return Uh(i4(a.Sheets[a.SheetNames[f]],l),l);case"txt":return Hz(c4(a.Sheets[a.SheetNames[f]],l),l);case"csv":return Uh(x2(a.Sheets[a.SheetNames[f]],l),l,"\uFEFF");case"dif":return Uh(A6.from_sheet(a.Sheets[a.SheetNames[f]],l),l);case"dbf":return ux(S6.from_sheet(a.Sheets[a.SheetNames[f]],l),l);case"prn":return Uh(C6.from_sheet(a.Sheets[a.SheetNames[f]],l),l);case"rtf":return Uh(L6.from_sheet(a.Sheets[a.SheetNames[f]],l),l);case"eth":return Uh(MC.from_sheet(a.Sheets[a.SheetNames[f]],l),l);case"fods":return Uh(a4(a,l),l);case"wk1":return ux(I3.sheet_to_wk1(a.Sheets[a.SheetNames[f]],l),l);case"wk3":return ux(I3.book_to_wk3(a,l),l);case"biff2":l.biff||(l.biff=2);case"biff3":l.biff||(l.biff=3);case"biff4":return l.biff||(l.biff=4),ux(t4(a,l),l);case"biff5":l.biff||(l.biff=5);case"biff8":case"xla":case"xls":return l.biff||(l.biff=8),Uz(a,l);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return jz(a,l);default:throw new Error("Unrecognized bookType |"+l.bookType+"|")}}function Gz(a){if(!a.bookType){var n={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},l=a.file.slice(a.file.lastIndexOf(".")).toLowerCase();l.match(/^\.[a-z]+$/)&&(a.bookType=l.slice(1)),a.bookType=n[a.bookType]||a.bookType}}function l4(a,n,l){var c=l||{};return c.type="file",c.file=n,Gz(c),s4(a,c)}function Wz(a,n,l,c,f,i,x,T){var A=Gs(l),M=T.defval,F=T.raw||!Object.prototype.hasOwnProperty.call(T,"raw"),W=!0,V=f===1?[]:{};if(f!==1)if(Object.defineProperty)try{Object.defineProperty(V,"__rowNum__",{value:l,enumerable:!1})}catch{V.__rowNum__=l}else V.__rowNum__=l;if(!x||a[l])for(var R=n.s.c;R<=n.e.c;++R){var te=x?a[l][R]:a[c[R]+A];if(te===void 0||te.t===void 0){if(M===void 0)continue;i[R]!=null&&(V[i[R]]=M);continue}var H=te.v;switch(te.t){case"z":if(H==null)break;continue;case"e":H=H==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+te.t)}if(i[R]!=null){if(H==null)if(te.t=="e"&&H===null)V[i[R]]=null;else if(M!==void 0)V[i[R]]=M;else if(F&&H===null)V[i[R]]=null;else continue;else V[i[R]]=F&&(te.t!=="n"||te.t==="n"&&T.rawNumbers!==!1)?H:Vd(te,H,T);H!=null&&(W=!1)}}return{row:V,isempty:W}}function Tx(a,n){if(a==null||a["!ref"]==null)return[];var l={t:"n",v:0},c=0,f=1,i=[],x=0,T="",A={s:{r:0,c:0},e:{r:0,c:0}},M=n||{},F=M.range!=null?M.range:a["!ref"];switch(M.header===1?c=1:M.header==="A"?c=2:Array.isArray(M.header)?c=3:M.header==null&&(c=0),typeof F){case"string":A=Ka(F);break;case"number":A=Ka(a["!ref"]),A.s.r=F;break;default:A=F}c>0&&(f=0);var W=Gs(A.s.r),V=[],R=[],te=0,H=0,J=Array.isArray(a),K=A.s.r,ne=0,de={};J&&!a[K]&&(a[K]=[]);var De=M.skipHidden&&a["!cols"]||[],Fe=M.skipHidden&&a["!rows"]||[];for(ne=A.s.c;ne<=A.e.c;++ne)if(!(De[ne]||{}).hidden)switch(V[ne]=ol(ne),l=J?a[K][ne]:a[V[ne]+W],c){case 1:i[ne]=ne-A.s.c;break;case 2:i[ne]=V[ne];break;case 3:i[ne]=M.header[ne-A.s.c];break;default:if(l==null&&(l={w:"__EMPTY",t:"s"}),T=x=Vd(l,null,M),H=de[x]||0,!H)de[x]=1;else{do T=x+"_"+H++;while(de[T]);de[x]=H,de[T]=1}i[ne]=T}for(K=A.s.r+f;K<=A.e.r;++K)if(!(Fe[K]||{}).hidden){var et=Wz(a,A,K,V,c,i,J,M);(et.isempty===!1||(c===1?M.blankrows!==!1:M.blankrows))&&(R[te++]=et.row)}return R.length=te,R}var O3=/"/g;function qz(a,n,l,c,f,i,x,T){for(var A=!0,M=[],F="",W=Gs(l),V=n.s.c;V<=n.e.c;++V)if(c[V]){var R=T.dense?(a[l]||[])[V]:a[c[V]+W];if(R==null)F="";else if(R.v!=null){A=!1,F=""+(T.rawNumbers&&R.t=="n"?R.v:Vd(R,null,T));for(var te=0,H=0;te!==F.length;++te)if((H=F.charCodeAt(te))===f||H===i||H===34||T.forceQuotes){F='"'+F.replace(O3,'""')+'"';break}F=="ID"&&(F='"ID"')}else R.f!=null&&!R.F?(A=!1,F="="+R.f,F.indexOf(",")>=0&&(F='"'+F.replace(O3,'""')+'"')):F="";M.push(F)}return T.blankrows===!1&&A?null:M.join(x)}function x2(a,n){var l=[],c=n??{};if(a==null||a["!ref"]==null)return"";var f=Ka(a["!ref"]),i=c.FS!==void 0?c.FS:",",x=i.charCodeAt(0),T=c.RS!==void 0?c.RS:`
`,A=T.charCodeAt(0),M=new RegExp((i=="|"?"\\|":i)+"+$"),F="",W=[];c.dense=Array.isArray(a);for(var V=c.skipHidden&&a["!cols"]||[],R=c.skipHidden&&a["!rows"]||[],te=f.s.c;te<=f.e.c;++te)(V[te]||{}).hidden||(W[te]=ol(te));for(var H=0,J=f.s.r;J<=f.e.r;++J)(R[J]||{}).hidden||(F=qz(a,f,J,W,x,A,i,c),F!=null&&(c.strip&&(F=F.replace(M,"")),(F||c.blankrows!==!1)&&l.push((H++?T:"")+F)));return delete c.dense,l.join("")}function c4(a,n){n||(n={}),n.FS="	",n.RS=`
`;var l=x2(a,n);if(typeof Fa>"u"||n.type=="string")return l;var c=Fa.utils.encode(1200,l,"str");return"\xFF\xFE"+c}function $z(a){var n="",l,c="";if(a==null||a["!ref"]==null)return[];var f=Ka(a["!ref"]),i="",x=[],T,A=[],M=Array.isArray(a);for(T=f.s.c;T<=f.e.c;++T)x[T]=ol(T);for(var F=f.s.r;F<=f.e.r;++F)for(i=Gs(F),T=f.s.c;T<=f.e.c;++T)if(n=x[T]+i,l=M?(a[F]||[])[T]:a[n],c="",l!==void 0){if(l.F!=null){if(n=l.F,!l.f)continue;c=l.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(l.f!=null)c=l.f;else{if(l.t=="z")continue;if(l.t=="n"&&l.v!=null)c=""+l.v;else if(l.t=="b")c=l.v?"TRUE":"FALSE";else if(l.w!==void 0)c="'"+l.w;else{if(l.v===void 0)continue;l.t=="s"?c="'"+l.v:c=""+l.v}}A[A.length]=n+"="+c}return A}function u4(a,n,l){var c=l||{},f=+!c.skipHeader,i=a||{},x=0,T=0;if(i&&c.origin!=null)if(typeof c.origin=="number")x=c.origin;else{var A=typeof c.origin=="string"?Es(c.origin):c.origin;x=A.r,T=A.c}var M,F={s:{c:0,r:0},e:{c:T,r:x+n.length-1+f}};if(i["!ref"]){var W=Ka(i["!ref"]);F.e.c=Math.max(F.e.c,W.e.c),F.e.r=Math.max(F.e.r,W.e.r),x==-1&&(x=W.e.r+1,F.e.r=x+n.length-1+f)}else x==-1&&(x=0,F.e.r=n.length-1+f);var V=c.header||[],R=0;n.forEach(function(H,J){Ws(H).forEach(function(K){(R=V.indexOf(K))==-1&&(V[R=V.length]=K);var ne=H[K],de="z",De="",Fe=xa({c:T+R,r:x+J+f});M=Gg(i,Fe),ne&&typeof ne=="object"&&!(ne instanceof Date)?i[Fe]=ne:(typeof ne=="number"?de="n":typeof ne=="boolean"?de="b":typeof ne=="string"?de="s":ne instanceof Date?(de="d",c.cellDates||(de="n",ne=tc(ne)),De=c.dateNF||So[14]):ne===null&&c.nullError&&(de="e",ne=0),M?(M.t=de,M.v=ne,delete M.w,delete M.R,De&&(M.z=De)):i[Fe]=M={t:de,v:ne},De&&(M.z=De))})}),F.e.c=Math.max(F.e.c,T+V.length-1);var te=Gs(x);if(f)for(R=0;R<V.length;++R)i[ol(R+T)+te]={t:"s",v:V[R]};return i["!ref"]=$o(F),i}function Xz(a,n){return u4(null,a,n)}function Gg(a,n,l){if(typeof n=="string"){if(Array.isArray(a)){var c=Es(n);return a[c.r]||(a[c.r]=[]),a[c.r][c.c]||(a[c.r][c.c]={t:"z"})}return a[n]||(a[n]={t:"z"})}return typeof n!="number"?Gg(a,xa(n)):Gg(a,xa({r:n,c:l||0}))}function Zz(a,n){if(typeof n=="number"){if(n>=0&&a.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var l=a.SheetNames.indexOf(n);if(l>-1)return l;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function Yz(){return{SheetNames:[],Sheets:{}}}function Kz(a,n,l,c){var f=1;if(!l)for(;f<=65535&&a.SheetNames.indexOf(l="Sheet"+f)!=-1;++f,l=void 0);if(!l||a.SheetNames.length>=65535)throw new Error("Too many worksheets");if(c&&a.SheetNames.indexOf(l)>=0){var i=l.match(/(^.*?)(\d+)$/);f=i&&+i[2]||0;var x=i&&i[1]||l;for(++f;f<=65535&&a.SheetNames.indexOf(l=x+f)!=-1;++f);}if(JC(l),a.SheetNames.indexOf(l)>=0)throw new Error("Worksheet with name |"+l+"| already exists!");return a.SheetNames.push(l),a.Sheets[l]=n,l}function Jz(a,n,l){a.Workbook||(a.Workbook={}),a.Workbook.Sheets||(a.Workbook.Sheets=[]);var c=Zz(a,n);switch(a.Workbook.Sheets[c]||(a.Workbook.Sheets[c]={}),l){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+l)}a.Workbook.Sheets[c].Hidden=l}function Qz(a,n){return a.z=n,a}function h4(a,n,l){return n?(a.l={Target:n},l&&(a.l.Tooltip=l)):delete a.l,a}function e7(a,n,l){return h4(a,"#"+n,l)}function t7(a,n,l){a.c||(a.c=[]),a.c.push({t:n,a:l||"SheetJS"})}function i7(a,n,l,c){for(var f=typeof n!="string"?n:Ka(n),i=typeof n=="string"?n:$o(n),x=f.s.r;x<=f.e.r;++x)for(var T=f.s.c;T<=f.e.c;++T){var A=Gg(a,x,T);A.t="n",A.F=i,delete A.v,x==f.s.r&&T==f.s.c&&(A.f=l,c&&(A.D=!0))}return a}var Px={encode_col:ol,encode_row:Gs,encode_cell:xa,encode_range:$o,decode_col:s2,decode_row:o2,split_cell:_R,decode_cell:Es,decode_range:Rc,format_cell:Vd,sheet_add_aoa:uC,sheet_add_json:u4,sheet_add_dom:r4,aoa_to_sheet:b0,json_to_sheet:Xz,table_to_sheet:n4,table_to_book:Az,sheet_to_csv:x2,sheet_to_txt:c4,sheet_to_json:Tx,sheet_to_html:i4,sheet_to_formulae:$z,sheet_to_row_object_array:Tx,sheet_get_cell:Gg,book_new:Yz,book_append_sheet:Kz,book_set_sheet_visibility:Jz,cell_set_number_format:Qz,cell_set_hyperlink:h4,cell_set_internal_link:e7,cell_add_comment:t7,sheet_set_array_formula:i7,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var yG=Bg.version;Gx();var J4=Fy(K4());function ij(a,n){a&1&&(Qi(0,"th",12),Gr(1," id "),ji())}function rj(a,n){if(a&1&&(Qi(0,"td",13),Gr(1),ji()),a&2){let l=n.$implicit;Er(),Bh(" ",l.id," ")}}function nj(a,n){a&1&&(Qi(0,"th",12),Gr(1," Name "),ji())}function aj(a,n){if(a&1&&(Qi(0,"td",13),Gr(1),ji()),a&2){let l=n.$implicit;Er(),Bh(" ",l.nombre," ")}}function oj(a,n){a&1&&(Qi(0,"th",12),Gr(1," Weight "),ji())}function sj(a,n){if(a&1&&(Qi(0,"td",13),Gr(1),ji()),a&2){let l=n.$implicit;Er(),Bh(" ",l.tel," ")}}function lj(a,n){a&1&&(Qi(0,"th",12),Gr(1," correo "),ji())}function cj(a,n){if(a&1&&(Qi(0,"td",13),Gr(1),ji()),a&2){let l=n.$implicit;Er(),Bh(" ",l.correo," ")}}function uj(a,n){a&1&&(Qi(0,"th",12),Gr(1," city "),ji())}function hj(a,n){if(a&1&&(Qi(0,"td",13),Gr(1),ji()),a&2){let l=n.$implicit;Er(),Bh(" ",l.city," ")}}function dj(a,n){a&1&&(Qi(0,"th",12),Gr(1," cp "),ji())}function fj(a,n){if(a&1&&(Qi(0,"td",13),Gr(1),ji()),a&2){let l=n.$implicit;Er(),Bh(" ",l.cp," ")}}function pj(a,n){a&1&&an(0,"tr",14)}function mj(a,n){a&1&&an(0,"tr",15)}var gj=[{id:1,nombre:"Juan P\xE9rez",tel:5551234567,correo:"juan@example.com",city:"Los Angeles",cp:90001},{id:2,nombre:"Mar\xEDa Rodr\xEDguez",tel:5559876543,correo:"maria@example.com",city:"New York",cp:10001}],Q4=(()=>{let n=class n{constructor(){this.displayedColumns=["id","nombre","tel","correo","city","cp"],this.dataSource=gj}exportToExcel(){let c=Px.json_to_sheet(this.dataSource,{header:this.displayedColumns}),f=Px.book_new();Px.book_append_sheet(f,c,"Sheet1"),l4(f,"tabla.xlsx")}exportToPDF(){let c=new j2,f=this.displayedColumns,i=this.dataSource.map(x=>f.map(T=>x[T]));(0,J4.default)(c,{head:[f],body:i}),c.save("tabla.pdf")}};n.\u0275fac=function(f){return new(f||n)},n.\u0275cmp=wa({type:n,selectors:[["app-user-tables"]],standalone:!0,features:[Aa],decls:25,vars:3,consts:[["mat-button","",3,"click"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","nombre"],["matColumnDef","tel"],["matColumnDef","correo"],["matColumnDef","city"],["matColumnDef","cp"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(f,i){f&1&&(Qi(0,"button",0),bs("click",function(){return i.exportToExcel()}),Gr(1,"Exportar a Exel"),ji(),Qi(2,"button",0),bs("click",function(){return i.exportToPDF()}),Gr(3,"Exportar a PDF"),ji(),Qi(4,"table",1),Md(5,2),_n(6,ij,2,0,"th",3)(7,rj,2,1,"td",4),Dd(),Md(8,5),_n(9,nj,2,0,"th",3)(10,aj,2,1,"td",4),Dd(),Md(11,6),_n(12,oj,2,0,"th",3)(13,sj,2,1,"td",4),Dd(),Md(14,7),_n(15,lj,2,0,"th",3)(16,cj,2,1,"td",4),Dd(),Md(17,8),_n(18,uj,2,0,"th",3)(19,hj,2,1,"td",4),Dd(),Md(20,9),_n(21,dj,2,0,"th",3)(22,fj,2,1,"td",4),Dd(),_n(23,pj,1,0,"tr",10)(24,mj,1,0,"tr",11),ji()),f&2&&(Er(4),Bs("dataSource",i.dataSource),Er(19),Bs("matHeaderRowDef",i.displayedColumns),Er(),Bs("matRowDefColumns",i.displayedColumns))},dependencies:[YA,jA,UA,qA,HA,VA,$A,GA,WA,XA,ZA,Of,Rf],styles:[".container[_ngcontent-%COMP%]{overflow:scroll}.mat-header-row[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#f9f9f9}table[_ngcontent-%COMP%]{width:100%}"]});let a=n;return a})();function _j(a,n){a&1&&an(0,"app-register-form")}function xj(a,n){a&1&&an(0,"app-user-tables")}var eI=(()=>{let n=class n{constructor(){this.page=!0}showListas(){this.page=!0}showRegister(){this.page=!1}};n.\u0275fac=function(f){return new(f||n)},n.\u0275cmp=wa({type:n,selectors:[["app-main"]],standalone:!0,features:[Aa],decls:11,vars:2,consts:[[1,"example-button-row"],["mat-button","",3,"click"],["src","/src/assets/logo-itsmarts.png","alt","logo-itsmarts"],[1,"container"]],template:function(f,i){f&1&&(Qi(0,"mat-toolbar")(1,"div",0)(2,"button",1),bs("click",function(){return i.showListas()}),Gr(3,"Listas"),ji(),Qi(4,"button",1),bs("click",function(){return i.showRegister()}),Gr(5,"Registro"),ji(),an(6,"img",2),ji()(),Qi(7,"div",3),_n(8,_j,1,0,"app-register-form")(9,xj,1,0,"app-user-tables"),an(10,"app-mapp-box"),ji()),f&2&&(Er(8),jn(i.page===!1?8:-1),Er(),jn(i.page===!0?9:-1))},dependencies:[C1,DE,Of,Rf,A1,r0,Rd,SA,IA,Q4],styles:[".example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.example-button-row[_ngcontent-%COMP%]{display:table-cell;max-width:600px}.container[_ngcontent-%COMP%]{position:absolute;padding:2vw 4vw;display:flex;min-width:100%}.container[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{float:left}.container[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:first-child{margin-right:48px;width:36vw;height:36vw;overflow:auto}.container[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:last-child{width:40vw}.c[_ngcontent-%COMP%]{border:1px solid black}"]});let a=n;return a})();var tI=[{path:"register",component:eI},{path:"**",redirectTo:"register"}];var vj="@",yj=(()=>{let n=class n{constructor(c,f,i,x,T){this.doc=c,this.delegate=f,this.zone=i,this.animationType=x,this.moduleImpl=T,this._rendererFactoryPromise=null,this.scheduler=Qn(OS,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-PDS5AIYX.mjs").then(f=>f)).catch(f=>{throw new Gm(5300,!1)}).then(({\u0275createEngine:f,\u0275AnimationRendererFactory:i})=>{this._engine=f(this.animationType,this.doc);let x=new i(this.delegate,this._engine,this.zone);return this.delegate=x,x})}createRenderer(c,f){let i=this.delegate.createRenderer(c,f);if(i.\u0275type===0)return i;typeof i.throwOnSyntheticProps=="boolean"&&(i.throwOnSyntheticProps=!1);let x=new H2(i);return f?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(T=>{let A=T.createRenderer(c,f);x.use(A),this.scheduler?.notify(9)}).catch(T=>{x.use(i)}),x}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}};n.\u0275fac=function(f){x1()},n.\u0275prov=fa({token:n,factory:n.\u0275fac});let a=n;return a})(),H2=class{constructor(n){this.delegate=n,this.replay=[],this.\u0275type=1}use(n){if(this.delegate=n,this.replay!==null){for(let l of this.replay)l(n);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(n,l){return this.delegate.createElement(n,l)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}get destroyNode(){return this.delegate.destroyNode}appendChild(n,l){this.delegate.appendChild(n,l)}insertBefore(n,l,c,f){this.delegate.insertBefore(n,l,c,f)}removeChild(n,l,c){this.delegate.removeChild(n,l,c)}selectRootElement(n,l){return this.delegate.selectRootElement(n,l)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,l,c,f){this.delegate.setAttribute(n,l,c,f)}removeAttribute(n,l,c){this.delegate.removeAttribute(n,l,c)}addClass(n,l){this.delegate.addClass(n,l)}removeClass(n,l){this.delegate.removeClass(n,l)}setStyle(n,l,c,f){this.delegate.setStyle(n,l,c,f)}removeStyle(n,l,c){this.delegate.removeStyle(n,l,c)}setProperty(n,l,c){this.shouldReplay(l)&&this.replay.push(f=>f.setProperty(n,l,c)),this.delegate.setProperty(n,l,c)}setValue(n,l){this.delegate.setValue(n,l)}listen(n,l,c){return this.shouldReplay(l)&&this.replay.push(f=>f.listen(n,l,c)),this.delegate.listen(n,l,c)}shouldReplay(n){return this.replay!==null&&n.startsWith(vj)}};function iI(a="animations"){return BS("NgAsyncAnimations"),PS([{provide:NS,useFactory:(n,l,c)=>new yj(n,l,c,a),deps:[is,ZS,Wn]},{provide:Id,useValue:a==="noop"?"NoopAnimations":"BrowserAnimations"}])}var rI={providers:[nE(tI),KS(),iI()]};var bj={providers:[iE()]},nI=WS(rI,bj);var wj=()=>YS(aE,nI),tW=wj;export{tW as a};
