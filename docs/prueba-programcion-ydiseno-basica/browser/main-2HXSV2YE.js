import{a as Pa,b as UL}from"./chunk-KTCT5UX3.js";import{$ as om,$a as hs,A as ip,Aa as Uv,Ab as WC,B as CC,Ba as Vv,Bb as ds,C as P2,Ca as Gv,Cb as ef,D as u_,Da as Tn,Db as tf,E as np,Ea as LC,Eb as A0,F as L2,Fa as Hv,Fb as qC,G as IC,Ga as Yd,Gb as $C,H as kC,Ha as Kd,Hb as aa,I as O2,Ia as OC,Ib as Zv,J as Lv,Ja as na,Jb as V2,K as h_,Ka as _l,Kb as XC,L as bu,La as NC,Lb as G2,M as gl,Ma as BC,Mb as ZC,N as cs,Na as En,Nb as YC,O as Xa,Oa as cc,Ob as v_,P as ap,Pa as Xs,Pb as KC,Q as Li,Qa as io,R as Un,Ra as g_,S as MC,Sa as Zn,Sb as JC,T as Hi,Ta as ti,Tb as QC,U as N2,Ua as Ur,V as bi,Va as nn,Vb as H2,W as Jr,Wa as Jd,Wb as e3,X as d_,Xa as Qd,Xb as t3,Y as pa,Ya as uc,Z as Vn,Za as Wv,_ as pi,_a as E0,a as y0,aa as DC,ab as Bo,b as wC,ba as Ov,bb as hc,c as x0,ca as ed,cb as wa,d as M2,da as lc,db as Ds,e as s_,ea as Nv,eb as Vc,f as Ra,fa as Bv,fb as Ta,g as ml,ga as us,gb as Sa,h as Qh,ha as S0,hb as zC,i as sc,ia as op,ib as jC,j as ji,ja as zv,jb as j2,k as l_,ka as Ln,kb as Yi,l as b0,la as B2,lb as uh,m as TC,ma as $s,mb as rd,n as Xn,na as RC,nb as Fa,o as c_,oa as jv,ob as ma,p as xu,pa as FC,pb as UC,q as Pv,qa as Xd,qb as qv,r as D2,ra as Zd,rb as $v,s as SC,sa as f_,sb as Xv,t as EC,ta as z2,tb as __,u as ch,ua as p_,ub as VC,v as AC,va as Ii,vb as U2,w as w0,wa as Er,wb as id,x as T0,xa as m_,xb as sm,y as R2,ya as td,yb as GC,z as F2,za as PC,zb as HC}from"./chunk-EFHPFQVU.js";import{a as jr,b as ba,c as Fv,d as vC,e as yC,f as jL,g as xC,h as bC}from"./chunk-VOSPIT4N.js";var w4=yC((b5,w5)=>{"use strict";(function(a,i){typeof b5=="object"&&typeof w5<"u"?w5.exports=i():typeof define=="function"&&define.amd?define(i):(a=typeof globalThis<"u"?globalThis:a||self,a.mapboxgl=i())})(b5,function(){"use strict";var a,i,o;function c(r,_){if(!a)a=_;else if(!i)i=_;else{var T="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+a+")(sharedChunk); ("+i+")(sharedChunk); self.onerror = null;",E={};a(E),o=_(E),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(o.workerUrl=window.URL.createObjectURL(new Blob([T],{type:"text/javascript"})))}}c(["exports"],function(r){var _="3.5.1";let T,E={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(T==null){let t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{T=process.env.API_URL_REGEX!=null?new RegExp(process.env.API_URL_REGEX):t}catch{T=t}}return T},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!E.API_URL)return null;try{let t=new URL(E.API_URL);return t.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":t.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function k(t){return E.API_URL_REGEX.test(t)}function D(t){return t.indexOf("mapbox:")===0}function j(t){return E.API_CDN_URL_REGEX.test(t)}function B(t){return E.API_SPRITE_REGEX.test(t)}function P(t){return E.API_STYLE_REGEX.test(t)&&!B(t)}let ee={create:"create",load:"load",fullLoad:"fullLoad"},G={mark(t){performance.mark(t)},measure(t,e,n){performance.measure(t,e,n)}};function K(t){let e=t.name.split("?")[0];return j(e)&&e.includes("mapbox-gl.js")?"javascript":j(e)&&e.includes("mapbox-gl.css")?"css":function(n){return E.API_FONTS_REGEX.test(n)}(e)?"fontRange":B(e)?"sprite":P(e)?"style":function(n){return E.API_TILEJSON_REGEX.test(n)}(e)?"tilejson":"other"}function J(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ne={},he={};Object.defineProperty(he,"__esModule",{value:!0}),he.setMatrixArrayType=function(t){he.ARRAY_TYPE=Re=t},he.toRadian=function(t){return t*Te},he.equals=function(t,e){return Math.abs(t-e)<=Me*Math.max(1,Math.abs(t),Math.abs(e))},he.RANDOM=he.ARRAY_TYPE=he.EPSILON=void 0;var Me=1e-6;he.EPSILON=Me;var Re=typeof Float32Array<"u"?Float32Array:Array;he.ARRAY_TYPE=Re;var et=Math.random;he.RANDOM=et;var Te=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var ge={};function Ue(t){return Ue=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ue(t)}Object.defineProperty(ge,"__esModule",{value:!0}),ge.create=function(){var t=new Ae.ARRAY_TYPE(4);return Ae.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},ge.clone=function(t){var e=new Ae.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},ge.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},ge.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},ge.fromValues=function(t,e,n,l){var h=new Ae.ARRAY_TYPE(4);return h[0]=t,h[1]=e,h[2]=n,h[3]=l,h},ge.set=function(t,e,n,l,h){return t[0]=e,t[1]=n,t[2]=l,t[3]=h,t},ge.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},ge.invert=function(t,e){var n=e[0],l=e[1],h=e[2],f=e[3],p=n*f-h*l;return p?(t[0]=f*(p=1/p),t[1]=-l*p,t[2]=-h*p,t[3]=n*p,t):null},ge.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},ge.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},ge.multiply=ve,ge.rotate=function(t,e,n){var l=e[0],h=e[1],f=e[2],p=e[3],v=Math.sin(n),y=Math.cos(n);return t[0]=l*y+f*v,t[1]=h*y+p*v,t[2]=l*-v+f*y,t[3]=h*-v+p*y,t},ge.scale=function(t,e,n){var l=e[1],h=e[2],f=e[3],p=n[0],v=n[1];return t[0]=e[0]*p,t[1]=l*p,t[2]=h*v,t[3]=f*v,t},ge.fromRotation=function(t,e){var n=Math.sin(e),l=Math.cos(e);return t[0]=l,t[1]=n,t[2]=-n,t[3]=l,t},ge.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},ge.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},ge.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},ge.LDU=function(t,e,n,l){return t[2]=l[2]/l[0],n[0]=l[0],n[1]=l[1],n[3]=l[3]-t[2]*n[1],[t,e,n]},ge.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},ge.subtract=Qe,ge.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},ge.equals=function(t,e){var n=t[0],l=t[1],h=t[2],f=t[3],p=e[0],v=e[1],y=e[2],w=e[3];return Math.abs(n-p)<=Ae.EPSILON*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(l-v)<=Ae.EPSILON*Math.max(1,Math.abs(l),Math.abs(v))&&Math.abs(h-y)<=Ae.EPSILON*Math.max(1,Math.abs(h),Math.abs(y))&&Math.abs(f-w)<=Ae.EPSILON*Math.max(1,Math.abs(f),Math.abs(w))},ge.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},ge.multiplyScalarAndAdd=function(t,e,n,l){return t[0]=e[0]+n[0]*l,t[1]=e[1]+n[1]*l,t[2]=e[2]+n[2]*l,t[3]=e[3]+n[3]*l,t},ge.sub=ge.mul=void 0;var Ae=function(t,e){if(t&&t.__esModule)return t;if(t===null||Ue(t)!=="object"&&typeof t!="function")return{default:t};var n=_e(void 0);if(n&&n.has(t))return n.get(t);var l={},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var p=h?Object.getOwnPropertyDescriptor(t,f):null;p&&(p.get||p.set)?Object.defineProperty(l,f,p):l[f]=t[f]}return l.default=t,n&&n.set(t,l),l}(he);function _e(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(_e=function(l){return l?n:e})(t)}function ve(t,e,n){var l=e[0],h=e[1],f=e[2],p=e[3],v=n[0],y=n[1],w=n[2],A=n[3];return t[0]=l*v+f*y,t[1]=h*v+p*y,t[2]=l*w+f*A,t[3]=h*w+p*A,t}function Qe(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}ge.mul=ve,ge.sub=Qe;var Ce={};function Ye(t){return Ye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ye(t)}Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.create=function(){var t=new ut.ARRAY_TYPE(6);return ut.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t},Ce.clone=function(t){var e=new ut.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},Ce.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},Ce.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},Ce.fromValues=function(t,e,n,l,h,f){var p=new ut.ARRAY_TYPE(6);return p[0]=t,p[1]=e,p[2]=n,p[3]=l,p[4]=h,p[5]=f,p},Ce.set=function(t,e,n,l,h,f,p){return t[0]=e,t[1]=n,t[2]=l,t[3]=h,t[4]=f,t[5]=p,t},Ce.invert=function(t,e){var n=e[0],l=e[1],h=e[2],f=e[3],p=e[4],v=e[5],y=n*f-l*h;return y?(t[0]=f*(y=1/y),t[1]=-l*y,t[2]=-h*y,t[3]=n*y,t[4]=(h*v-f*p)*y,t[5]=(l*p-n*v)*y,t):null},Ce.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},Ce.multiply=pt,Ce.rotate=function(t,e,n){var l=e[0],h=e[1],f=e[2],p=e[3],v=e[4],y=e[5],w=Math.sin(n),A=Math.cos(n);return t[0]=l*A+f*w,t[1]=h*A+p*w,t[2]=l*-w+f*A,t[3]=h*-w+p*A,t[4]=v,t[5]=y,t},Ce.scale=function(t,e,n){var l=e[1],h=e[2],f=e[3],p=e[4],v=e[5],y=n[0],w=n[1];return t[0]=e[0]*y,t[1]=l*y,t[2]=h*w,t[3]=f*w,t[4]=p,t[5]=v,t},Ce.translate=function(t,e,n){var l=e[0],h=e[1],f=e[2],p=e[3],v=e[4],y=e[5],w=n[0],A=n[1];return t[0]=l,t[1]=h,t[2]=f,t[3]=p,t[4]=l*w+f*A+v,t[5]=h*w+p*A+y,t},Ce.fromRotation=function(t,e){var n=Math.sin(e),l=Math.cos(e);return t[0]=l,t[1]=n,t[2]=-n,t[3]=l,t[4]=0,t[5]=0,t},Ce.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},Ce.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},Ce.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},Ce.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)},Ce.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},Ce.subtract=Tt,Ce.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},Ce.multiplyScalarAndAdd=function(t,e,n,l){return t[0]=e[0]+n[0]*l,t[1]=e[1]+n[1]*l,t[2]=e[2]+n[2]*l,t[3]=e[3]+n[3]*l,t[4]=e[4]+n[4]*l,t[5]=e[5]+n[5]*l,t},Ce.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},Ce.equals=function(t,e){var n=t[0],l=t[1],h=t[2],f=t[3],p=t[4],v=t[5],y=e[0],w=e[1],A=e[2],M=e[3],R=e[4],N=e[5];return Math.abs(n-y)<=ut.EPSILON*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(l-w)<=ut.EPSILON*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(h-A)<=ut.EPSILON*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(f-M)<=ut.EPSILON*Math.max(1,Math.abs(f),Math.abs(M))&&Math.abs(p-R)<=ut.EPSILON*Math.max(1,Math.abs(p),Math.abs(R))&&Math.abs(v-N)<=ut.EPSILON*Math.max(1,Math.abs(v),Math.abs(N))},Ce.sub=Ce.mul=void 0;var ut=function(t,e){if(t&&t.__esModule)return t;if(t===null||Ye(t)!=="object"&&typeof t!="function")return{default:t};var n=st(void 0);if(n&&n.has(t))return n.get(t);var l={},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var p=h?Object.getOwnPropertyDescriptor(t,f):null;p&&(p.get||p.set)?Object.defineProperty(l,f,p):l[f]=t[f]}return l.default=t,n&&n.set(t,l),l}(he);function st(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(st=function(l){return l?n:e})(t)}function pt(t,e,n){var l=e[0],h=e[1],f=e[2],p=e[3],v=e[4],y=e[5],w=n[0],A=n[1],M=n[2],R=n[3],N=n[4],z=n[5];return t[0]=l*w+f*A,t[1]=h*w+p*A,t[2]=l*M+f*R,t[3]=h*M+p*R,t[4]=l*N+f*z+v,t[5]=h*N+p*z+y,t}function Tt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}Ce.mul=pt,Ce.sub=Tt;var ht={};function Wt(t){return Wt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wt(t)}Object.defineProperty(ht,"__esModule",{value:!0}),ht.create=function(){var t=new re.ARRAY_TYPE(9);return re.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},ht.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},ht.clone=function(t){var e=new re.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},ht.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},ht.fromValues=function(t,e,n,l,h,f,p,v,y){var w=new re.ARRAY_TYPE(9);return w[0]=t,w[1]=e,w[2]=n,w[3]=l,w[4]=h,w[5]=f,w[6]=p,w[7]=v,w[8]=y,w},ht.set=function(t,e,n,l,h,f,p,v,y,w){return t[0]=e,t[1]=n,t[2]=l,t[3]=h,t[4]=f,t[5]=p,t[6]=v,t[7]=y,t[8]=w,t},ht.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},ht.transpose=function(t,e){if(t===e){var n=e[1],l=e[2],h=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=l,t[7]=h}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},ht.invert=function(t,e){var n=e[0],l=e[1],h=e[2],f=e[3],p=e[4],v=e[5],y=e[6],w=e[7],A=e[8],M=A*p-v*w,R=-A*f+v*y,N=w*f-p*y,z=n*M+l*R+h*N;return z?(t[0]=M*(z=1/z),t[1]=(-A*l+h*w)*z,t[2]=(v*l-h*p)*z,t[3]=R*z,t[4]=(A*n-h*y)*z,t[5]=(-v*n+h*f)*z,t[6]=N*z,t[7]=(-w*n+l*y)*z,t[8]=(p*n-l*f)*z,t):null},ht.adjoint=function(t,e){var n=e[0],l=e[1],h=e[2],f=e[3],p=e[4],v=e[5],y=e[6],w=e[7],A=e[8];return t[0]=p*A-v*w,t[1]=h*w-l*A,t[2]=l*v-h*p,t[3]=v*y-f*A,t[4]=n*A-h*y,t[5]=h*f-n*v,t[6]=f*w-p*y,t[7]=l*y-n*w,t[8]=n*p-l*f,t},ht.determinant=function(t){var e=t[3],n=t[4],l=t[5],h=t[6],f=t[7],p=t[8];return t[0]*(p*n-l*f)+t[1]*(-p*e+l*h)+t[2]*(f*e-n*h)},ht.multiply=pe,ht.translate=function(t,e,n){var l=e[0],h=e[1],f=e[2],p=e[3],v=e[4],y=e[5],w=e[6],A=e[7],M=e[8],R=n[0],N=n[1];return t[0]=l,t[1]=h,t[2]=f,t[3]=p,t[4]=v,t[5]=y,t[6]=R*l+N*p+w,t[7]=R*h+N*v+A,t[8]=R*f+N*y+M,t},ht.rotate=function(t,e,n){var l=e[0],h=e[1],f=e[2],p=e[3],v=e[4],y=e[5],w=e[6],A=e[7],M=e[8],R=Math.sin(n),N=Math.cos(n);return t[0]=N*l+R*p,t[1]=N*h+R*v,t[2]=N*f+R*y,t[3]=N*p-R*l,t[4]=N*v-R*h,t[5]=N*y-R*f,t[6]=w,t[7]=A,t[8]=M,t},ht.scale=function(t,e,n){var l=n[0],h=n[1];return t[0]=l*e[0],t[1]=l*e[1],t[2]=l*e[2],t[3]=h*e[3],t[4]=h*e[4],t[5]=h*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},ht.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},ht.fromRotation=function(t,e){var n=Math.sin(e),l=Math.cos(e);return t[0]=l,t[1]=n,t[2]=0,t[3]=-n,t[4]=l,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},ht.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},ht.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},ht.fromQuat=function(t,e){var n=e[0],l=e[1],h=e[2],f=e[3],p=n+n,v=l+l,y=h+h,w=n*p,A=l*p,M=l*v,R=h*p,N=h*v,z=h*y,q=f*p,Z=f*v,oe=f*y;return t[0]=1-M-z,t[3]=A-oe,t[6]=R+Z,t[1]=A+oe,t[4]=1-w-z,t[7]=N-q,t[2]=R-Z,t[5]=N+q,t[8]=1-w-M,t},ht.normalFromMat4=function(t,e){var n=e[0],l=e[1],h=e[2],f=e[3],p=e[4],v=e[5],y=e[6],w=e[7],A=e[8],M=e[9],R=e[10],N=e[11],z=e[12],q=e[13],Z=e[14],oe=e[15],ye=n*v-l*p,be=n*y-h*p,we=n*w-f*p,$e=l*y-h*v,He=l*w-f*v,rt=h*w-f*y,ot=A*q-M*z,_t=A*Z-R*z,Mt=A*oe-N*z,At=M*Z-R*q,zt=M*oe-N*q,Jt=R*oe-N*Z,Ot=ye*Jt-be*zt+we*At+$e*Mt-He*_t+rt*ot;return Ot?(t[0]=(v*Jt-y*zt+w*At)*(Ot=1/Ot),t[1]=(y*Mt-p*Jt-w*_t)*Ot,t[2]=(p*zt-v*Mt+w*ot)*Ot,t[3]=(h*zt-l*Jt-f*At)*Ot,t[4]=(n*Jt-h*Mt+f*_t)*Ot,t[5]=(l*Mt-n*zt-f*ot)*Ot,t[6]=(q*rt-Z*He+oe*$e)*Ot,t[7]=(Z*we-z*rt-oe*be)*Ot,t[8]=(z*He-q*we+oe*ye)*Ot,t):null},ht.projection=function(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},ht.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},ht.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},ht.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},ht.subtract=Ie,ht.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},ht.multiplyScalarAndAdd=function(t,e,n,l){return t[0]=e[0]+n[0]*l,t[1]=e[1]+n[1]*l,t[2]=e[2]+n[2]*l,t[3]=e[3]+n[3]*l,t[4]=e[4]+n[4]*l,t[5]=e[5]+n[5]*l,t[6]=e[6]+n[6]*l,t[7]=e[7]+n[7]*l,t[8]=e[8]+n[8]*l,t},ht.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},ht.equals=function(t,e){var n=t[0],l=t[1],h=t[2],f=t[3],p=t[4],v=t[5],y=t[6],w=t[7],A=t[8],M=e[0],R=e[1],N=e[2],z=e[3],q=e[4],Z=e[5],oe=e[6],ye=e[7],be=e[8];return Math.abs(n-M)<=re.EPSILON*Math.max(1,Math.abs(n),Math.abs(M))&&Math.abs(l-R)<=re.EPSILON*Math.max(1,Math.abs(l),Math.abs(R))&&Math.abs(h-N)<=re.EPSILON*Math.max(1,Math.abs(h),Math.abs(N))&&Math.abs(f-z)<=re.EPSILON*Math.max(1,Math.abs(f),Math.abs(z))&&Math.abs(p-q)<=re.EPSILON*Math.max(1,Math.abs(p),Math.abs(q))&&Math.abs(v-Z)<=re.EPSILON*Math.max(1,Math.abs(v),Math.abs(Z))&&Math.abs(y-oe)<=re.EPSILON*Math.max(1,Math.abs(y),Math.abs(oe))&&Math.abs(w-ye)<=re.EPSILON*Math.max(1,Math.abs(w),Math.abs(ye))&&Math.abs(A-be)<=re.EPSILON*Math.max(1,Math.abs(A),Math.abs(be))},ht.sub=ht.mul=void 0;var re=function(t,e){if(t&&t.__esModule)return t;if(t===null||Wt(t)!=="object"&&typeof t!="function")return{default:t};var n=xe(void 0);if(n&&n.has(t))return n.get(t);var l={},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var p=h?Object.getOwnPropertyDescriptor(t,f):null;p&&(p.get||p.set)?Object.defineProperty(l,f,p):l[f]=t[f]}return l.default=t,n&&n.set(t,l),l}(he);function xe(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(xe=function(l){return l?n:e})(t)}function pe(t,e,n){var l=e[0],h=e[1],f=e[2],p=e[3],v=e[4],y=e[5],w=e[6],A=e[7],M=e[8],R=n[0],N=n[1],z=n[2],q=n[3],Z=n[4],oe=n[5],ye=n[6],be=n[7],we=n[8];return t[0]=R*l+N*p+z*w,t[1]=R*h+N*v+z*A,t[2]=R*f+N*y+z*M,t[3]=q*l+Z*p+oe*w,t[4]=q*h+Z*v+oe*A,t[5]=q*f+Z*y+oe*M,t[6]=ye*l+be*p+we*w,t[7]=ye*h+be*v+we*A,t[8]=ye*f+be*y+we*M,t}function Ie(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}ht.mul=pe,ht.sub=Ie;var Ve={};function gt(t){return gt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gt(t)}Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.create=function(){var t=new mt.ARRAY_TYPE(16);return mt.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},Ve.clone=function(t){var e=new mt.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},Ve.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},Ve.fromValues=function(t,e,n,l,h,f,p,v,y,w,A,M,R,N,z,q){var Z=new mt.ARRAY_TYPE(16);return Z[0]=t,Z[1]=e,Z[2]=n,Z[3]=l,Z[4]=h,Z[5]=f,Z[6]=p,Z[7]=v,Z[8]=y,Z[9]=w,Z[10]=A,Z[11]=M,Z[12]=R,Z[13]=N,Z[14]=z,Z[15]=q,Z},Ve.set=function(t,e,n,l,h,f,p,v,y,w,A,M,R,N,z,q,Z){return t[0]=e,t[1]=n,t[2]=l,t[3]=h,t[4]=f,t[5]=p,t[6]=v,t[7]=y,t[8]=w,t[9]=A,t[10]=M,t[11]=R,t[12]=N,t[13]=z,t[14]=q,t[15]=Z,t},Ve.identity=Pt,Ve.transpose=function(t,e){if(t===e){var n=e[1],l=e[2],h=e[3],f=e[6],p=e[7],v=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=l,t[9]=f,t[11]=e[14],t[12]=h,t[13]=p,t[14]=v}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},Ve.invert=function(t,e){var n=e[0],l=e[1],h=e[2],f=e[3],p=e[4],v=e[5],y=e[6],w=e[7],A=e[8],M=e[9],R=e[10],N=e[11],z=e[12],q=e[13],Z=e[14],oe=e[15],ye=n*v-l*p,be=n*y-h*p,we=n*w-f*p,$e=l*y-h*v,He=l*w-f*v,rt=h*w-f*y,ot=A*q-M*z,_t=A*Z-R*z,Mt=A*oe-N*z,At=M*Z-R*q,zt=M*oe-N*q,Jt=R*oe-N*Z,Ot=ye*Jt-be*zt+we*At+$e*Mt-He*_t+rt*ot;return Ot?(t[0]=(v*Jt-y*zt+w*At)*(Ot=1/Ot),t[1]=(h*zt-l*Jt-f*At)*Ot,t[2]=(q*rt-Z*He+oe*$e)*Ot,t[3]=(R*He-M*rt-N*$e)*Ot,t[4]=(y*Mt-p*Jt-w*_t)*Ot,t[5]=(n*Jt-h*Mt+f*_t)*Ot,t[6]=(Z*we-z*rt-oe*be)*Ot,t[7]=(A*rt-R*we+N*be)*Ot,t[8]=(p*zt-v*Mt+w*ot)*Ot,t[9]=(l*Mt-n*zt-f*ot)*Ot,t[10]=(z*He-q*we+oe*ye)*Ot,t[11]=(M*we-A*He-N*ye)*Ot,t[12]=(v*_t-p*At-y*ot)*Ot,t[13]=(n*At-l*_t+h*ot)*Ot,t[14]=(q*be-z*$e-Z*ye)*Ot,t[15]=(A*$e-M*be+R*ye)*Ot,t):null},Ve.adjoint=function(t,e){var n=e[0],l=e[1],h=e[2],f=e[3],p=e[4],v=e[5],y=e[6],w=e[7],A=e[8],M=e[9],R=e[10],N=e[11],z=e[12],q=e[13],Z=e[14],oe=e[15];return t[0]=v*(R*oe-N*Z)-M*(y*oe-w*Z)+q*(y*N-w*R),t[1]=-(l*(R*oe-N*Z)-M*(h*oe-f*Z)+q*(h*N-f*R)),t[2]=l*(y*oe-w*Z)-v*(h*oe-f*Z)+q*(h*w-f*y),t[3]=-(l*(y*N-w*R)-v*(h*N-f*R)+M*(h*w-f*y)),t[4]=-(p*(R*oe-N*Z)-A*(y*oe-w*Z)+z*(y*N-w*R)),t[5]=n*(R*oe-N*Z)-A*(h*oe-f*Z)+z*(h*N-f*R),t[6]=-(n*(y*oe-w*Z)-p*(h*oe-f*Z)+z*(h*w-f*y)),t[7]=n*(y*N-w*R)-p*(h*N-f*R)+A*(h*w-f*y),t[8]=p*(M*oe-N*q)-A*(v*oe-w*q)+z*(v*N-w*M),t[9]=-(n*(M*oe-N*q)-A*(l*oe-f*q)+z*(l*N-f*M)),t[10]=n*(v*oe-w*q)-p*(l*oe-f*q)+z*(l*w-f*v),t[11]=-(n*(v*N-w*M)-p*(l*N-f*M)+A*(l*w-f*v)),t[12]=-(p*(M*Z-R*q)-A*(v*Z-y*q)+z*(v*R-y*M)),t[13]=n*(M*Z-R*q)-A*(l*Z-h*q)+z*(l*R-h*M),t[14]=-(n*(v*Z-y*q)-p*(l*Z-h*q)+z*(l*y-h*v)),t[15]=n*(v*R-y*M)-p*(l*R-h*M)+A*(l*y-h*v),t},Ve.determinant=function(t){var e=t[0],n=t[1],l=t[2],h=t[3],f=t[4],p=t[5],v=t[6],y=t[7],w=t[8],A=t[9],M=t[10],R=t[11],N=t[12],z=t[13],q=t[14],Z=t[15];return(e*p-n*f)*(M*Z-R*q)-(e*v-l*f)*(A*Z-R*z)+(e*y-h*f)*(A*q-M*z)+(n*v-l*p)*(w*Z-R*N)-(n*y-h*p)*(w*q-M*N)+(l*y-h*v)*(w*z-A*N)},Ve.multiply=fr,Ve.translate=function(t,e,n){var l,h,f,p,v,y,w,A,M,R,N,z,q=n[0],Z=n[1],oe=n[2];return e===t?(t[12]=e[0]*q+e[4]*Z+e[8]*oe+e[12],t[13]=e[1]*q+e[5]*Z+e[9]*oe+e[13],t[14]=e[2]*q+e[6]*Z+e[10]*oe+e[14],t[15]=e[3]*q+e[7]*Z+e[11]*oe+e[15]):(h=e[1],f=e[2],p=e[3],v=e[4],y=e[5],w=e[6],A=e[7],M=e[8],R=e[9],N=e[10],z=e[11],t[0]=l=e[0],t[1]=h,t[2]=f,t[3]=p,t[4]=v,t[5]=y,t[6]=w,t[7]=A,t[8]=M,t[9]=R,t[10]=N,t[11]=z,t[12]=l*q+v*Z+M*oe+e[12],t[13]=h*q+y*Z+R*oe+e[13],t[14]=f*q+w*Z+N*oe+e[14],t[15]=p*q+A*Z+z*oe+e[15]),t},Ve.scale=function(t,e,n){var l=n[0],h=n[1],f=n[2];return t[0]=e[0]*l,t[1]=e[1]*l,t[2]=e[2]*l,t[3]=e[3]*l,t[4]=e[4]*h,t[5]=e[5]*h,t[6]=e[6]*h,t[7]=e[7]*h,t[8]=e[8]*f,t[9]=e[9]*f,t[10]=e[10]*f,t[11]=e[11]*f,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},Ve.rotate=function(t,e,n,l){var h,f,p,v,y,w,A,M,R,N,z,q,Z,oe,ye,be,we,$e,He,rt,ot,_t,Mt,At,zt=l[0],Jt=l[1],Ot=l[2],Xt=Math.hypot(zt,Jt,Ot);return Xt<mt.EPSILON?null:(zt*=Xt=1/Xt,Jt*=Xt,Ot*=Xt,h=Math.sin(n),f=Math.cos(n),y=e[1],w=e[2],A=e[3],R=e[5],N=e[6],z=e[7],Z=e[9],oe=e[10],ye=e[11],be=zt*zt*(p=1-f)+f,He=zt*Jt*p-Ot*h,rt=Jt*Jt*p+f,ot=Ot*Jt*p+zt*h,_t=zt*Ot*p+Jt*h,Mt=Jt*Ot*p-zt*h,At=Ot*Ot*p+f,t[0]=(v=e[0])*be+(M=e[4])*(we=Jt*zt*p+Ot*h)+(q=e[8])*($e=Ot*zt*p-Jt*h),t[1]=y*be+R*we+Z*$e,t[2]=w*be+N*we+oe*$e,t[3]=A*be+z*we+ye*$e,t[4]=v*He+M*rt+q*ot,t[5]=y*He+R*rt+Z*ot,t[6]=w*He+N*rt+oe*ot,t[7]=A*He+z*rt+ye*ot,t[8]=v*_t+M*Mt+q*At,t[9]=y*_t+R*Mt+Z*At,t[10]=w*_t+N*Mt+oe*At,t[11]=A*_t+z*Mt+ye*At,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},Ve.rotateX=function(t,e,n){var l=Math.sin(n),h=Math.cos(n),f=e[4],p=e[5],v=e[6],y=e[7],w=e[8],A=e[9],M=e[10],R=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=f*h+w*l,t[5]=p*h+A*l,t[6]=v*h+M*l,t[7]=y*h+R*l,t[8]=w*h-f*l,t[9]=A*h-p*l,t[10]=M*h-v*l,t[11]=R*h-y*l,t},Ve.rotateY=function(t,e,n){var l=Math.sin(n),h=Math.cos(n),f=e[0],p=e[1],v=e[2],y=e[3],w=e[8],A=e[9],M=e[10],R=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=f*h-w*l,t[1]=p*h-A*l,t[2]=v*h-M*l,t[3]=y*h-R*l,t[8]=f*l+w*h,t[9]=p*l+A*h,t[10]=v*l+M*h,t[11]=y*l+R*h,t},Ve.rotateZ=function(t,e,n){var l=Math.sin(n),h=Math.cos(n),f=e[0],p=e[1],v=e[2],y=e[3],w=e[4],A=e[5],M=e[6],R=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=f*h+w*l,t[1]=p*h+A*l,t[2]=v*h+M*l,t[3]=y*h+R*l,t[4]=w*h-f*l,t[5]=A*h-p*l,t[6]=M*h-v*l,t[7]=R*h-y*l,t},Ve.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},Ve.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Ve.fromRotation=function(t,e,n){var l,h,f,p=n[0],v=n[1],y=n[2],w=Math.hypot(p,v,y);return w<mt.EPSILON?null:(p*=w=1/w,v*=w,y*=w,l=Math.sin(e),h=Math.cos(e),t[0]=p*p*(f=1-h)+h,t[1]=v*p*f+y*l,t[2]=y*p*f-v*l,t[3]=0,t[4]=p*v*f-y*l,t[5]=v*v*f+h,t[6]=y*v*f+p*l,t[7]=0,t[8]=p*y*f+v*l,t[9]=v*y*f-p*l,t[10]=y*y*f+h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},Ve.fromXRotation=function(t,e){var n=Math.sin(e),l=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Ve.fromYRotation=function(t,e){var n=Math.sin(e),l=Math.cos(e);return t[0]=l,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Ve.fromZRotation=function(t,e){var n=Math.sin(e),l=Math.cos(e);return t[0]=l,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Ve.fromRotationTranslation=xr,Ve.fromQuat2=function(t,e){var n=new mt.ARRAY_TYPE(3),l=-e[0],h=-e[1],f=-e[2],p=e[3],v=e[4],y=e[5],w=e[6],A=e[7],M=l*l+h*h+f*f+p*p;return M>0?(n[0]=2*(v*p+A*l+y*f-w*h)/M,n[1]=2*(y*p+A*h+w*l-v*f)/M,n[2]=2*(w*p+A*f+v*h-y*l)/M):(n[0]=2*(v*p+A*l+y*f-w*h),n[1]=2*(y*p+A*h+w*l-v*f),n[2]=2*(w*p+A*f+v*h-y*l)),xr(t,e,n),t},Ve.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},Ve.getScaling=Rr,Ve.getRotation=function(t,e){var n=new mt.ARRAY_TYPE(3);Rr(n,e);var l=1/n[0],h=1/n[1],f=1/n[2],p=e[0]*l,v=e[1]*h,y=e[2]*f,w=e[4]*l,A=e[5]*h,M=e[6]*f,R=e[8]*l,N=e[9]*h,z=e[10]*f,q=p+A+z,Z=0;return q>0?(Z=2*Math.sqrt(q+1),t[3]=.25*Z,t[0]=(M-N)/Z,t[1]=(R-y)/Z,t[2]=(v-w)/Z):p>A&&p>z?(Z=2*Math.sqrt(1+p-A-z),t[3]=(M-N)/Z,t[0]=.25*Z,t[1]=(v+w)/Z,t[2]=(R+y)/Z):A>z?(Z=2*Math.sqrt(1+A-p-z),t[3]=(R-y)/Z,t[0]=(v+w)/Z,t[1]=.25*Z,t[2]=(M+N)/Z):(Z=2*Math.sqrt(1+z-p-A),t[3]=(v-w)/Z,t[0]=(R+y)/Z,t[1]=(M+N)/Z,t[2]=.25*Z),t},Ve.fromRotationTranslationScale=function(t,e,n,l){var h=e[0],f=e[1],p=e[2],v=e[3],y=h+h,w=f+f,A=p+p,M=h*y,R=h*w,N=h*A,z=f*w,q=f*A,Z=p*A,oe=v*y,ye=v*w,be=v*A,we=l[0],$e=l[1],He=l[2];return t[0]=(1-(z+Z))*we,t[1]=(R+be)*we,t[2]=(N-ye)*we,t[3]=0,t[4]=(R-be)*$e,t[5]=(1-(M+Z))*$e,t[6]=(q+oe)*$e,t[7]=0,t[8]=(N+ye)*He,t[9]=(q-oe)*He,t[10]=(1-(M+z))*He,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},Ve.fromRotationTranslationScaleOrigin=function(t,e,n,l,h){var f=e[0],p=e[1],v=e[2],y=e[3],w=f+f,A=p+p,M=v+v,R=f*w,N=f*A,z=f*M,q=p*A,Z=p*M,oe=v*M,ye=y*w,be=y*A,we=y*M,$e=l[0],He=l[1],rt=l[2],ot=h[0],_t=h[1],Mt=h[2],At=(1-(q+oe))*$e,zt=(N+we)*$e,Jt=(z-be)*$e,Ot=(N-we)*He,Xt=(1-(R+oe))*He,Dt=(Z+ye)*He,Zt=(z+be)*rt,ir=(Z-ye)*rt,Kt=(1-(R+q))*rt;return t[0]=At,t[1]=zt,t[2]=Jt,t[3]=0,t[4]=Ot,t[5]=Xt,t[6]=Dt,t[7]=0,t[8]=Zt,t[9]=ir,t[10]=Kt,t[11]=0,t[12]=n[0]+ot-(At*ot+Ot*_t+Zt*Mt),t[13]=n[1]+_t-(zt*ot+Xt*_t+ir*Mt),t[14]=n[2]+Mt-(Jt*ot+Dt*_t+Kt*Mt),t[15]=1,t},Ve.fromQuat=function(t,e){var n=e[0],l=e[1],h=e[2],f=e[3],p=n+n,v=l+l,y=h+h,w=n*p,A=l*p,M=l*v,R=h*p,N=h*v,z=h*y,q=f*p,Z=f*v,oe=f*y;return t[0]=1-M-z,t[1]=A+oe,t[2]=R-Z,t[3]=0,t[4]=A-oe,t[5]=1-w-z,t[6]=N+q,t[7]=0,t[8]=R+Z,t[9]=N-q,t[10]=1-w-M,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Ve.frustum=function(t,e,n,l,h,f,p){var v=1/(n-e),y=1/(h-l),w=1/(f-p);return t[0]=2*f*v,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*f*y,t[6]=0,t[7]=0,t[8]=(n+e)*v,t[9]=(h+l)*y,t[10]=(p+f)*w,t[11]=-1,t[12]=0,t[13]=0,t[14]=p*f*2*w,t[15]=0,t},Ve.perspectiveNO=Fr,Ve.perspectiveZO=function(t,e,n,l,h){var f,p=1/Math.tan(e/2);return t[0]=p/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=p,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,h!=null&&h!==1/0?(t[10]=h*(f=1/(l-h)),t[14]=h*l*f):(t[10]=-1,t[14]=-l),t},Ve.perspectiveFromFieldOfView=function(t,e,n,l){var h=Math.tan(e.upDegrees*Math.PI/180),f=Math.tan(e.downDegrees*Math.PI/180),p=Math.tan(e.leftDegrees*Math.PI/180),v=Math.tan(e.rightDegrees*Math.PI/180),y=2/(p+v),w=2/(h+f);return t[0]=y,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=w,t[6]=0,t[7]=0,t[8]=-(p-v)*y*.5,t[9]=(h-f)*w*.5,t[10]=l/(n-l),t[11]=-1,t[12]=0,t[13]=0,t[14]=l*n/(n-l),t[15]=0,t},Ve.orthoNO=$t,Ve.orthoZO=function(t,e,n,l,h,f,p){var v=1/(e-n),y=1/(l-h),w=1/(f-p);return t[0]=-2*v,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=w,t[11]=0,t[12]=(e+n)*v,t[13]=(h+l)*y,t[14]=f*w,t[15]=1,t},Ve.lookAt=function(t,e,n,l){var h,f,p,v,y,w,A,M,R,N,z=e[0],q=e[1],Z=e[2],oe=l[0],ye=l[1],be=l[2],we=n[0],$e=n[1],He=n[2];return Math.abs(z-we)<mt.EPSILON&&Math.abs(q-$e)<mt.EPSILON&&Math.abs(Z-He)<mt.EPSILON?Pt(t):(A=z-we,M=q-$e,R=Z-He,h=ye*(R*=N=1/Math.hypot(A,M,R))-be*(M*=N),f=be*(A*=N)-oe*R,p=oe*M-ye*A,(N=Math.hypot(h,f,p))?(h*=N=1/N,f*=N,p*=N):(h=0,f=0,p=0),v=M*p-R*f,y=R*h-A*p,w=A*f-M*h,(N=Math.hypot(v,y,w))?(v*=N=1/N,y*=N,w*=N):(v=0,y=0,w=0),t[0]=h,t[1]=v,t[2]=A,t[3]=0,t[4]=f,t[5]=y,t[6]=M,t[7]=0,t[8]=p,t[9]=w,t[10]=R,t[11]=0,t[12]=-(h*z+f*q+p*Z),t[13]=-(v*z+y*q+w*Z),t[14]=-(A*z+M*q+R*Z),t[15]=1,t)},Ve.targetTo=function(t,e,n,l){var h=e[0],f=e[1],p=e[2],v=l[0],y=l[1],w=l[2],A=h-n[0],M=f-n[1],R=p-n[2],N=A*A+M*M+R*R;N>0&&(A*=N=1/Math.sqrt(N),M*=N,R*=N);var z=y*R-w*M,q=w*A-v*R,Z=v*M-y*A;return(N=z*z+q*q+Z*Z)>0&&(z*=N=1/Math.sqrt(N),q*=N,Z*=N),t[0]=z,t[1]=q,t[2]=Z,t[3]=0,t[4]=M*Z-R*q,t[5]=R*z-A*Z,t[6]=A*q-M*z,t[7]=0,t[8]=A,t[9]=M,t[10]=R,t[11]=0,t[12]=h,t[13]=f,t[14]=p,t[15]=1,t},Ve.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},Ve.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},Ve.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},Ve.subtract=lt,Ve.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},Ve.multiplyScalarAndAdd=function(t,e,n,l){return t[0]=e[0]+n[0]*l,t[1]=e[1]+n[1]*l,t[2]=e[2]+n[2]*l,t[3]=e[3]+n[3]*l,t[4]=e[4]+n[4]*l,t[5]=e[5]+n[5]*l,t[6]=e[6]+n[6]*l,t[7]=e[7]+n[7]*l,t[8]=e[8]+n[8]*l,t[9]=e[9]+n[9]*l,t[10]=e[10]+n[10]*l,t[11]=e[11]+n[11]*l,t[12]=e[12]+n[12]*l,t[13]=e[13]+n[13]*l,t[14]=e[14]+n[14]*l,t[15]=e[15]+n[15]*l,t},Ve.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},Ve.equals=function(t,e){var n=t[0],l=t[1],h=t[2],f=t[3],p=t[4],v=t[5],y=t[6],w=t[7],A=t[8],M=t[9],R=t[10],N=t[11],z=t[12],q=t[13],Z=t[14],oe=t[15],ye=e[0],be=e[1],we=e[2],$e=e[3],He=e[4],rt=e[5],ot=e[6],_t=e[7],Mt=e[8],At=e[9],zt=e[10],Jt=e[11],Ot=e[12],Xt=e[13],Dt=e[14],Zt=e[15];return Math.abs(n-ye)<=mt.EPSILON*Math.max(1,Math.abs(n),Math.abs(ye))&&Math.abs(l-be)<=mt.EPSILON*Math.max(1,Math.abs(l),Math.abs(be))&&Math.abs(h-we)<=mt.EPSILON*Math.max(1,Math.abs(h),Math.abs(we))&&Math.abs(f-$e)<=mt.EPSILON*Math.max(1,Math.abs(f),Math.abs($e))&&Math.abs(p-He)<=mt.EPSILON*Math.max(1,Math.abs(p),Math.abs(He))&&Math.abs(v-rt)<=mt.EPSILON*Math.max(1,Math.abs(v),Math.abs(rt))&&Math.abs(y-ot)<=mt.EPSILON*Math.max(1,Math.abs(y),Math.abs(ot))&&Math.abs(w-_t)<=mt.EPSILON*Math.max(1,Math.abs(w),Math.abs(_t))&&Math.abs(A-Mt)<=mt.EPSILON*Math.max(1,Math.abs(A),Math.abs(Mt))&&Math.abs(M-At)<=mt.EPSILON*Math.max(1,Math.abs(M),Math.abs(At))&&Math.abs(R-zt)<=mt.EPSILON*Math.max(1,Math.abs(R),Math.abs(zt))&&Math.abs(N-Jt)<=mt.EPSILON*Math.max(1,Math.abs(N),Math.abs(Jt))&&Math.abs(z-Ot)<=mt.EPSILON*Math.max(1,Math.abs(z),Math.abs(Ot))&&Math.abs(q-Xt)<=mt.EPSILON*Math.max(1,Math.abs(q),Math.abs(Xt))&&Math.abs(Z-Dt)<=mt.EPSILON*Math.max(1,Math.abs(Z),Math.abs(Dt))&&Math.abs(oe-Zt)<=mt.EPSILON*Math.max(1,Math.abs(oe),Math.abs(Zt))},Ve.sub=Ve.mul=Ve.ortho=Ve.perspective=void 0;var mt=function(t,e){if(t&&t.__esModule)return t;if(t===null||gt(t)!=="object"&&typeof t!="function")return{default:t};var n=wt(void 0);if(n&&n.has(t))return n.get(t);var l={},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var p=h?Object.getOwnPropertyDescriptor(t,f):null;p&&(p.get||p.set)?Object.defineProperty(l,f,p):l[f]=t[f]}return l.default=t,n&&n.set(t,l),l}(he);function wt(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(wt=function(l){return l?n:e})(t)}function Pt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function fr(t,e,n){var l=e[0],h=e[1],f=e[2],p=e[3],v=e[4],y=e[5],w=e[6],A=e[7],M=e[8],R=e[9],N=e[10],z=e[11],q=e[12],Z=e[13],oe=e[14],ye=e[15],be=n[0],we=n[1],$e=n[2],He=n[3];return t[0]=be*l+we*v+$e*M+He*q,t[1]=be*h+we*y+$e*R+He*Z,t[2]=be*f+we*w+$e*N+He*oe,t[3]=be*p+we*A+$e*z+He*ye,t[4]=(be=n[4])*l+(we=n[5])*v+($e=n[6])*M+(He=n[7])*q,t[5]=be*h+we*y+$e*R+He*Z,t[6]=be*f+we*w+$e*N+He*oe,t[7]=be*p+we*A+$e*z+He*ye,t[8]=(be=n[8])*l+(we=n[9])*v+($e=n[10])*M+(He=n[11])*q,t[9]=be*h+we*y+$e*R+He*Z,t[10]=be*f+we*w+$e*N+He*oe,t[11]=be*p+we*A+$e*z+He*ye,t[12]=(be=n[12])*l+(we=n[13])*v+($e=n[14])*M+(He=n[15])*q,t[13]=be*h+we*y+$e*R+He*Z,t[14]=be*f+we*w+$e*N+He*oe,t[15]=be*p+we*A+$e*z+He*ye,t}function xr(t,e,n){var l=e[0],h=e[1],f=e[2],p=e[3],v=l+l,y=h+h,w=f+f,A=l*v,M=l*y,R=l*w,N=h*y,z=h*w,q=f*w,Z=p*v,oe=p*y,ye=p*w;return t[0]=1-(N+q),t[1]=M+ye,t[2]=R-oe,t[3]=0,t[4]=M-ye,t[5]=1-(A+q),t[6]=z+Z,t[7]=0,t[8]=R+oe,t[9]=z-Z,t[10]=1-(A+N),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Rr(t,e){var n=e[4],l=e[5],h=e[6],f=e[8],p=e[9],v=e[10];return t[0]=Math.hypot(e[0],e[1],e[2]),t[1]=Math.hypot(n,l,h),t[2]=Math.hypot(f,p,v),t}function Fr(t,e,n,l,h){var f,p=1/Math.tan(e/2);return t[0]=p/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=p,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,h!=null&&h!==1/0?(t[10]=(h+l)*(f=1/(l-h)),t[14]=2*h*l*f):(t[10]=-1,t[14]=-2*l),t}function $t(t,e,n,l,h,f,p){var v=1/(e-n),y=1/(l-h),w=1/(f-p);return t[0]=-2*v,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*w,t[11]=0,t[12]=(e+n)*v,t[13]=(h+l)*y,t[14]=(p+f)*w,t[15]=1,t}function lt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}Ve.perspective=Fr,Ve.ortho=$t,Ve.mul=fr,Ve.sub=lt;var Bt={},nr={};function br(t){return br=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},br(t)}Object.defineProperty(nr,"__esModule",{value:!0}),nr.create=Br,nr.clone=function(t){var e=new kr.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},nr.length=ii,nr.fromValues=function(t,e,n){var l=new kr.ARRAY_TYPE(3);return l[0]=t,l[1]=e,l[2]=n,l},nr.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},nr.set=function(t,e,n,l){return t[0]=e,t[1]=n,t[2]=l,t},nr.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},nr.subtract=si,nr.multiply=wi,nr.divide=Ri,nr.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},nr.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},nr.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},nr.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},nr.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},nr.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},nr.scaleAndAdd=function(t,e,n,l){return t[0]=e[0]+n[0]*l,t[1]=e[1]+n[1]*l,t[2]=e[2]+n[2]*l,t},nr.distance=Ji,nr.squaredDistance=an,nr.squaredLength=xi,nr.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},nr.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},nr.normalize=function(t,e){var n=e[0],l=e[1],h=e[2],f=n*n+l*l+h*h;return f>0&&(f=1/Math.sqrt(f)),t[0]=e[0]*f,t[1]=e[1]*f,t[2]=e[2]*f,t},nr.dot=Ui,nr.cross=function(t,e,n){var l=e[0],h=e[1],f=e[2],p=n[0],v=n[1],y=n[2];return t[0]=h*y-f*v,t[1]=f*p-l*y,t[2]=l*v-h*p,t},nr.lerp=function(t,e,n,l){var h=e[0],f=e[1],p=e[2];return t[0]=h+l*(n[0]-h),t[1]=f+l*(n[1]-f),t[2]=p+l*(n[2]-p),t},nr.hermite=function(t,e,n,l,h,f){var p=f*f,v=p*(2*f-3)+1,y=p*(f-2)+f,w=p*(f-1),A=p*(3-2*f);return t[0]=e[0]*v+n[0]*y+l[0]*w+h[0]*A,t[1]=e[1]*v+n[1]*y+l[1]*w+h[1]*A,t[2]=e[2]*v+n[2]*y+l[2]*w+h[2]*A,t},nr.bezier=function(t,e,n,l,h,f){var p=1-f,v=p*p,y=f*f,w=v*p,A=3*f*v,M=3*y*p,R=y*f;return t[0]=e[0]*w+n[0]*A+l[0]*M+h[0]*R,t[1]=e[1]*w+n[1]*A+l[1]*M+h[1]*R,t[2]=e[2]*w+n[2]*A+l[2]*M+h[2]*R,t},nr.random=function(t,e){e=e||1;var n=2*kr.RANDOM()*Math.PI,l=2*kr.RANDOM()-1,h=Math.sqrt(1-l*l)*e;return t[0]=Math.cos(n)*h,t[1]=Math.sin(n)*h,t[2]=l*e,t},nr.transformMat4=function(t,e,n){var l=e[0],h=e[1],f=e[2],p=n[3]*l+n[7]*h+n[11]*f+n[15];return t[0]=(n[0]*l+n[4]*h+n[8]*f+n[12])/(p=p||1),t[1]=(n[1]*l+n[5]*h+n[9]*f+n[13])/p,t[2]=(n[2]*l+n[6]*h+n[10]*f+n[14])/p,t},nr.transformMat3=function(t,e,n){var l=e[0],h=e[1],f=e[2];return t[0]=l*n[0]+h*n[3]+f*n[6],t[1]=l*n[1]+h*n[4]+f*n[7],t[2]=l*n[2]+h*n[5]+f*n[8],t},nr.transformQuat=function(t,e,n){var l=n[0],h=n[1],f=n[2],p=e[0],v=e[1],y=e[2],w=h*y-f*v,A=f*p-l*y,M=l*v-h*p,R=h*M-f*A,N=f*w-l*M,z=l*A-h*w,q=2*n[3];return A*=q,M*=q,N*=2,z*=2,t[0]=p+(w*=q)+(R*=2),t[1]=v+A+N,t[2]=y+M+z,t},nr.rotateX=function(t,e,n,l){var h=[],f=[];return h[0]=e[0]-n[0],h[1]=e[1]-n[1],h[2]=e[2]-n[2],f[0]=h[0],f[1]=h[1]*Math.cos(l)-h[2]*Math.sin(l),f[2]=h[1]*Math.sin(l)+h[2]*Math.cos(l),t[0]=f[0]+n[0],t[1]=f[1]+n[1],t[2]=f[2]+n[2],t},nr.rotateY=function(t,e,n,l){var h=[],f=[];return h[0]=e[0]-n[0],h[1]=e[1]-n[1],h[2]=e[2]-n[2],f[0]=h[2]*Math.sin(l)+h[0]*Math.cos(l),f[1]=h[1],f[2]=h[2]*Math.cos(l)-h[0]*Math.sin(l),t[0]=f[0]+n[0],t[1]=f[1]+n[1],t[2]=f[2]+n[2],t},nr.rotateZ=function(t,e,n,l){var h=[],f=[];return h[0]=e[0]-n[0],h[1]=e[1]-n[1],h[2]=e[2]-n[2],f[0]=h[0]*Math.cos(l)-h[1]*Math.sin(l),f[1]=h[0]*Math.sin(l)+h[1]*Math.cos(l),f[2]=h[2],t[0]=f[0]+n[0],t[1]=f[1]+n[1],t[2]=f[2]+n[2],t},nr.angle=function(t,e){var n=t[0],l=t[1],h=t[2],f=e[0],p=e[1],v=e[2],y=Math.sqrt(n*n+l*l+h*h)*Math.sqrt(f*f+p*p+v*v),w=y&&Ui(t,e)/y;return Math.acos(Math.min(Math.max(w,-1),1))},nr.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t},nr.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},nr.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},nr.equals=function(t,e){var n=t[0],l=t[1],h=t[2],f=e[0],p=e[1],v=e[2];return Math.abs(n-f)<=kr.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(l-p)<=kr.EPSILON*Math.max(1,Math.abs(l),Math.abs(p))&&Math.abs(h-v)<=kr.EPSILON*Math.max(1,Math.abs(h),Math.abs(v))},nr.forEach=nr.sqrLen=nr.len=nr.sqrDist=nr.dist=nr.div=nr.mul=nr.sub=void 0;var kr=function(t,e){if(t&&t.__esModule)return t;if(t===null||br(t)!=="object"&&typeof t!="function")return{default:t};var n=Nr(void 0);if(n&&n.has(t))return n.get(t);var l={},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var p=h?Object.getOwnPropertyDescriptor(t,f):null;p&&(p.get||p.set)?Object.defineProperty(l,f,p):l[f]=t[f]}return l.default=t,n&&n.set(t,l),l}(he);function Nr(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Nr=function(l){return l?n:e})(t)}function Br(){var t=new kr.ARRAY_TYPE(3);return kr.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function ii(t){return Math.hypot(t[0],t[1],t[2])}function si(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function wi(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Ri(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function Ji(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])}function an(t,e){var n=e[0]-t[0],l=e[1]-t[1],h=e[2]-t[2];return n*n+l*l+h*h}function xi(t){var e=t[0],n=t[1],l=t[2];return e*e+n*n+l*l}function Ui(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}nr.sub=si,nr.mul=wi,nr.div=Ri,nr.dist=Ji,nr.sqrDist=an,nr.len=ii,nr.sqrLen=xi;var Lr,Ua=(Lr=Br(),function(t,e,n,l,h,f){var p,v;for(e||(e=3),n||(n=0),v=l?Math.min(l*e+n,t.length):t.length,p=n;p<v;p+=e)Lr[0]=t[p],Lr[1]=t[p+1],Lr[2]=t[p+2],h(Lr,Lr,f),t[p]=Lr[0],t[p+1]=Lr[1],t[p+2]=Lr[2];return t});nr.forEach=Ua;var Dr={};function Eo(t){return Eo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Eo(t)}Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.create=Ao,Dr.clone=function(t){var e=new gi.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},Dr.fromValues=function(t,e,n,l){var h=new gi.ARRAY_TYPE(4);return h[0]=t,h[1]=e,h[2]=n,h[3]=l,h},Dr.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},Dr.set=function(t,e,n,l,h){return t[0]=e,t[1]=n,t[2]=l,t[3]=h,t},Dr.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},Dr.subtract=Qi,Dr.multiply=_o,Dr.divide=Gn,Dr.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},Dr.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},Dr.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},Dr.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},Dr.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},Dr.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},Dr.scaleAndAdd=function(t,e,n,l){return t[0]=e[0]+n[0]*l,t[1]=e[1]+n[1]*l,t[2]=e[2]+n[2]*l,t[3]=e[3]+n[3]*l,t},Dr.distance=oo,Dr.squaredDistance=Co,Dr.length=Cn,Dr.squaredLength=ki,Dr.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},Dr.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},Dr.normalize=function(t,e){var n=e[0],l=e[1],h=e[2],f=e[3],p=n*n+l*l+h*h+f*f;return p>0&&(p=1/Math.sqrt(p)),t[0]=n*p,t[1]=l*p,t[2]=h*p,t[3]=f*p,t},Dr.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},Dr.cross=function(t,e,n,l){var h=n[0]*l[1]-n[1]*l[0],f=n[0]*l[2]-n[2]*l[0],p=n[0]*l[3]-n[3]*l[0],v=n[1]*l[2]-n[2]*l[1],y=n[1]*l[3]-n[3]*l[1],w=n[2]*l[3]-n[3]*l[2],A=e[0],M=e[1],R=e[2],N=e[3];return t[0]=M*w-R*y+N*v,t[1]=-A*w+R*p-N*f,t[2]=A*y-M*p+N*h,t[3]=-A*v+M*f-R*h,t},Dr.lerp=function(t,e,n,l){var h=e[0],f=e[1],p=e[2],v=e[3];return t[0]=h+l*(n[0]-h),t[1]=f+l*(n[1]-f),t[2]=p+l*(n[2]-p),t[3]=v+l*(n[3]-v),t},Dr.random=function(t,e){var n,l,h,f,p,v;e=e||1;do p=(n=2*gi.RANDOM()-1)*n+(l=2*gi.RANDOM()-1)*l;while(p>=1);do v=(h=2*gi.RANDOM()-1)*h+(f=2*gi.RANDOM()-1)*f;while(v>=1);var y=Math.sqrt((1-p)/v);return t[0]=e*n,t[1]=e*l,t[2]=e*h*y,t[3]=e*f*y,t},Dr.transformMat4=function(t,e,n){var l=e[0],h=e[1],f=e[2],p=e[3];return t[0]=n[0]*l+n[4]*h+n[8]*f+n[12]*p,t[1]=n[1]*l+n[5]*h+n[9]*f+n[13]*p,t[2]=n[2]*l+n[6]*h+n[10]*f+n[14]*p,t[3]=n[3]*l+n[7]*h+n[11]*f+n[15]*p,t},Dr.transformQuat=function(t,e,n){var l=e[0],h=e[1],f=e[2],p=n[0],v=n[1],y=n[2],w=n[3],A=w*l+v*f-y*h,M=w*h+y*l-p*f,R=w*f+p*h-v*l,N=-p*l-v*h-y*f;return t[0]=A*w+N*-p+M*-y-R*-v,t[1]=M*w+N*-v+R*-p-A*-y,t[2]=R*w+N*-y+A*-v-M*-p,t[3]=e[3],t},Dr.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},Dr.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},Dr.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},Dr.equals=function(t,e){var n=t[0],l=t[1],h=t[2],f=t[3],p=e[0],v=e[1],y=e[2],w=e[3];return Math.abs(n-p)<=gi.EPSILON*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(l-v)<=gi.EPSILON*Math.max(1,Math.abs(l),Math.abs(v))&&Math.abs(h-y)<=gi.EPSILON*Math.max(1,Math.abs(h),Math.abs(y))&&Math.abs(f-w)<=gi.EPSILON*Math.max(1,Math.abs(f),Math.abs(w))},Dr.forEach=Dr.sqrLen=Dr.len=Dr.sqrDist=Dr.dist=Dr.div=Dr.mul=Dr.sub=void 0;var gi=function(t,e){if(t&&t.__esModule)return t;if(t===null||Eo(t)!=="object"&&typeof t!="function")return{default:t};var n=Dn(void 0);if(n&&n.has(t))return n.get(t);var l={},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var p=h?Object.getOwnPropertyDescriptor(t,f):null;p&&(p.get||p.set)?Object.defineProperty(l,f,p):l[f]=t[f]}return l.default=t,n&&n.set(t,l),l}(he);function Dn(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Dn=function(l){return l?n:e})(t)}function Ao(){var t=new gi.ARRAY_TYPE(4);return gi.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Qi(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function _o(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function Gn(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function oo(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2],e[3]-t[3])}function Co(t,e){var n=e[0]-t[0],l=e[1]-t[1],h=e[2]-t[2],f=e[3]-t[3];return n*n+l*l+h*h+f*f}function Cn(t){return Math.hypot(t[0],t[1],t[2],t[3])}function ki(t){var e=t[0],n=t[1],l=t[2],h=t[3];return e*e+n*n+l*l+h*h}Dr.sub=Qi,Dr.mul=_o,Dr.div=Gn,Dr.dist=oo,Dr.sqrDist=Co,Dr.len=Cn,Dr.sqrLen=ki;var yn=function(){var t=Ao();return function(e,n,l,h,f,p){var v,y;for(n||(n=4),l||(l=0),y=h?Math.min(h*n+l,e.length):e.length,v=l;v<y;v+=n)t[0]=e[v],t[1]=e[v+1],t[2]=e[v+2],t[3]=e[v+3],f(t,t,p),e[v]=t[0],e[v+1]=t[1],e[v+2]=t[2],e[v+3]=t[3];return e}}();function ms(t){return ms=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ms(t)}Dr.forEach=yn,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.create=Za,Bt.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},Bt.setAxisAngle=_a,Bt.getAxisAngle=function(t,e){var n=2*Math.acos(e[3]),l=Math.sin(n/2);return l>On.EPSILON?(t[0]=e[0]/l,t[1]=e[1]/l,t[2]=e[2]/l):(t[0]=1,t[1]=0,t[2]=0),n},Bt.getAngle=function(t,e){var n=le(t,e);return Math.acos(2*n*n-1)},Bt.multiply=Jn,Bt.rotateX=function(t,e,n){n*=.5;var l=e[0],h=e[1],f=e[2],p=e[3],v=Math.sin(n),y=Math.cos(n);return t[0]=l*y+p*v,t[1]=h*y+f*v,t[2]=f*y-h*v,t[3]=p*y-l*v,t},Bt.rotateY=function(t,e,n){n*=.5;var l=e[0],h=e[1],f=e[2],p=e[3],v=Math.sin(n),y=Math.cos(n);return t[0]=l*y-f*v,t[1]=h*y+p*v,t[2]=f*y+l*v,t[3]=p*y-h*v,t},Bt.rotateZ=function(t,e,n){n*=.5;var l=e[0],h=e[1],f=e[2],p=e[3],v=Math.sin(n),y=Math.cos(n);return t[0]=l*y+h*v,t[1]=h*y-l*v,t[2]=f*y+p*v,t[3]=p*y-f*v,t},Bt.calculateW=function(t,e){var n=e[0],l=e[1],h=e[2];return t[0]=n,t[1]=l,t[2]=h,t[3]=Math.sqrt(Math.abs(1-n*n-l*l-h*h)),t},Bt.exp=te,Bt.ln=U,Bt.pow=function(t,e,n){return U(t,e),se(t,t,n),te(t,t),t},Bt.slerp=W,Bt.random=function(t){var e=On.RANDOM(),n=On.RANDOM(),l=On.RANDOM(),h=Math.sqrt(1-e),f=Math.sqrt(e);return t[0]=h*Math.sin(2*Math.PI*n),t[1]=h*Math.cos(2*Math.PI*n),t[2]=f*Math.sin(2*Math.PI*l),t[3]=f*Math.cos(2*Math.PI*l),t},Bt.invert=function(t,e){var n=e[0],l=e[1],h=e[2],f=e[3],p=n*n+l*l+h*h+f*f,v=p?1/p:0;return t[0]=-n*v,t[1]=-l*v,t[2]=-h*v,t[3]=f*v,t},Bt.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},Bt.fromMat3=Q,Bt.fromEuler=function(t,e,n,l){var h=.5*Math.PI/180;e*=h,n*=h,l*=h;var f=Math.sin(e),p=Math.cos(e),v=Math.sin(n),y=Math.cos(n),w=Math.sin(l),A=Math.cos(l);return t[0]=f*y*A-p*v*w,t[1]=p*v*A+f*y*w,t[2]=p*y*w-f*v*A,t[3]=p*y*A+f*v*w,t},Bt.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},Bt.setAxes=Bt.sqlerp=Bt.rotationTo=Bt.equals=Bt.exactEquals=Bt.normalize=Bt.sqrLen=Bt.squaredLength=Bt.len=Bt.length=Bt.lerp=Bt.dot=Bt.scale=Bt.mul=Bt.add=Bt.set=Bt.copy=Bt.fromValues=Bt.clone=void 0;var On=so(he),vo=so(ht),Oa=so(nr),Qr=so(Dr);function Vo(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Vo=function(l){return l?n:e})(t)}function so(t,e){if(t&&t.__esModule)return t;if(t===null||ms(t)!=="object"&&typeof t!="function")return{default:t};var n=Vo(e);if(n&&n.has(t))return n.get(t);var l={},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var p=h?Object.getOwnPropertyDescriptor(t,f):null;p&&(p.get||p.set)?Object.defineProperty(l,f,p):l[f]=t[f]}return l.default=t,n&&n.set(t,l),l}function Za(){var t=new On.ARRAY_TYPE(4);return On.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function _a(t,e,n){n*=.5;var l=Math.sin(n);return t[0]=l*e[0],t[1]=l*e[1],t[2]=l*e[2],t[3]=Math.cos(n),t}function Jn(t,e,n){var l=e[0],h=e[1],f=e[2],p=e[3],v=n[0],y=n[1],w=n[2],A=n[3];return t[0]=l*A+p*v+h*w-f*y,t[1]=h*A+p*y+f*v-l*w,t[2]=f*A+p*w+l*y-h*v,t[3]=p*A-l*v-h*y-f*w,t}function te(t,e){var n=e[0],l=e[1],h=e[2],f=e[3],p=Math.sqrt(n*n+l*l+h*h),v=Math.exp(f),y=p>0?v*Math.sin(p)/p:0;return t[0]=n*y,t[1]=l*y,t[2]=h*y,t[3]=v*Math.cos(p),t}function U(t,e){var n=e[0],l=e[1],h=e[2],f=e[3],p=Math.sqrt(n*n+l*l+h*h),v=p>0?Math.atan2(p,f)/p:0;return t[0]=n*v,t[1]=l*v,t[2]=h*v,t[3]=.5*Math.log(n*n+l*l+h*h+f*f),t}function W(t,e,n,l){var h,f,p,v,y,w=e[0],A=e[1],M=e[2],R=e[3],N=n[0],z=n[1],q=n[2],Z=n[3];return(f=w*N+A*z+M*q+R*Z)<0&&(f=-f,N=-N,z=-z,q=-q,Z=-Z),1-f>On.EPSILON?(h=Math.acos(f),p=Math.sin(h),v=Math.sin((1-l)*h)/p,y=Math.sin(l*h)/p):(v=1-l,y=l),t[0]=v*w+y*N,t[1]=v*A+y*z,t[2]=v*M+y*q,t[3]=v*R+y*Z,t}function Q(t,e){var n,l=e[0]+e[4]+e[8];if(l>0)n=Math.sqrt(l+1),t[3]=.5*n,t[0]=(e[5]-e[7])*(n=.5/n),t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var h=0;e[4]>e[0]&&(h=1),e[8]>e[3*h+h]&&(h=2);var f=(h+1)%3,p=(h+2)%3;n=Math.sqrt(e[3*h+h]-e[3*f+f]-e[3*p+p]+1),t[h]=.5*n,t[3]=(e[3*f+p]-e[3*p+f])*(n=.5/n),t[f]=(e[3*f+h]+e[3*h+f])*n,t[p]=(e[3*p+h]+e[3*h+p])*n}return t}Bt.clone=Qr.clone,Bt.fromValues=Qr.fromValues,Bt.copy=Qr.copy,Bt.set=Qr.set,Bt.add=Qr.add,Bt.mul=Jn;var se=Qr.scale;Bt.scale=se;var le=Qr.dot;Bt.dot=le,Bt.lerp=Qr.lerp;var De=Qr.length;Bt.length=De,Bt.len=De;var Ze=Qr.squaredLength;Bt.squaredLength=Ze,Bt.sqrLen=Ze;var ke=Qr.normalize;Bt.normalize=ke,Bt.exactEquals=Qr.exactEquals,Bt.equals=Qr.equals;var We,nt,dt,Ft=(We=Oa.create(),nt=Oa.fromValues(1,0,0),dt=Oa.fromValues(0,1,0),function(t,e,n){var l=Oa.dot(e,n);return l<-.999999?(Oa.cross(We,nt,e),Oa.len(We)<1e-6&&Oa.cross(We,dt,e),Oa.normalize(We,We),_a(t,We,Math.PI),t):l>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Oa.cross(We,e,n),t[0]=We[0],t[1]=We[1],t[2]=We[2],t[3]=1+l,ke(t,t))});Bt.rotationTo=Ft;var tr,Qt,or=(tr=Za(),Qt=Za(),function(t,e,n,l,h,f){return W(tr,e,h,f),W(Qt,n,l,f),W(t,tr,Qt,2*f*(1-f)),t});Bt.sqlerp=or;var Ar,qr=(Ar=vo.create(),function(t,e,n,l){return Ar[0]=n[0],Ar[3]=n[1],Ar[6]=n[2],Ar[1]=l[0],Ar[4]=l[1],Ar[7]=l[2],Ar[2]=-e[0],Ar[5]=-e[1],Ar[8]=-e[2],ke(t,Q(t,Ar))});Bt.setAxes=qr;var wr={};function Ei(t){return Ei=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ei(t)}Object.defineProperty(wr,"__esModule",{value:!0}),wr.create=function(){var t=new mi.ARRAY_TYPE(8);return mi.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t},wr.clone=function(t){var e=new mi.ARRAY_TYPE(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e},wr.fromValues=function(t,e,n,l,h,f,p,v){var y=new mi.ARRAY_TYPE(8);return y[0]=t,y[1]=e,y[2]=n,y[3]=l,y[4]=h,y[5]=f,y[6]=p,y[7]=v,y},wr.fromRotationTranslationValues=function(t,e,n,l,h,f,p){var v=new mi.ARRAY_TYPE(8);v[0]=t,v[1]=e,v[2]=n,v[3]=l;var y=.5*h,w=.5*f,A=.5*p;return v[4]=y*l+w*n-A*e,v[5]=w*l+A*t-y*n,v[6]=A*l+y*e-w*t,v[7]=-y*t-w*e-A*n,v},wr.fromRotationTranslation=Hn,wr.fromTranslation=function(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t},wr.fromRotation=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},wr.fromMat4=function(t,e){var n=Ti.create();An.getRotation(n,e);var l=new mi.ARRAY_TYPE(3);return An.getTranslation(l,e),Hn(t,n,l),t},wr.copy=fn,wr.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},wr.set=function(t,e,n,l,h,f,p,v,y){return t[0]=e,t[1]=n,t[2]=l,t[3]=h,t[4]=f,t[5]=p,t[6]=v,t[7]=y,t},wr.getDual=function(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t},wr.setDual=function(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t},wr.getTranslation=function(t,e){var n=e[4],l=e[5],h=e[6],f=e[7],p=-e[0],v=-e[1],y=-e[2],w=e[3];return t[0]=2*(n*w+f*p+l*y-h*v),t[1]=2*(l*w+f*v+h*p-n*y),t[2]=2*(h*w+f*y+n*v-l*p),t},wr.translate=function(t,e,n){var l=e[0],h=e[1],f=e[2],p=e[3],v=.5*n[0],y=.5*n[1],w=.5*n[2],A=e[4],M=e[5],R=e[6],N=e[7];return t[0]=l,t[1]=h,t[2]=f,t[3]=p,t[4]=p*v+h*w-f*y+A,t[5]=p*y+f*v-l*w+M,t[6]=p*w+l*y-h*v+R,t[7]=-l*v-h*y-f*w+N,t},wr.rotateX=function(t,e,n){var l=-e[0],h=-e[1],f=-e[2],p=e[3],v=e[4],y=e[5],w=e[6],A=e[7],M=v*p+A*l+y*f-w*h,R=y*p+A*h+w*l-v*f,N=w*p+A*f+v*h-y*l,z=A*p-v*l-y*h-w*f;return Ti.rotateX(t,e,n),t[4]=M*(p=t[3])+z*(l=t[0])+R*(f=t[2])-N*(h=t[1]),t[5]=R*p+z*h+N*l-M*f,t[6]=N*p+z*f+M*h-R*l,t[7]=z*p-M*l-R*h-N*f,t},wr.rotateY=function(t,e,n){var l=-e[0],h=-e[1],f=-e[2],p=e[3],v=e[4],y=e[5],w=e[6],A=e[7],M=v*p+A*l+y*f-w*h,R=y*p+A*h+w*l-v*f,N=w*p+A*f+v*h-y*l,z=A*p-v*l-y*h-w*f;return Ti.rotateY(t,e,n),t[4]=M*(p=t[3])+z*(l=t[0])+R*(f=t[2])-N*(h=t[1]),t[5]=R*p+z*h+N*l-M*f,t[6]=N*p+z*f+M*h-R*l,t[7]=z*p-M*l-R*h-N*f,t},wr.rotateZ=function(t,e,n){var l=-e[0],h=-e[1],f=-e[2],p=e[3],v=e[4],y=e[5],w=e[6],A=e[7],M=v*p+A*l+y*f-w*h,R=y*p+A*h+w*l-v*f,N=w*p+A*f+v*h-y*l,z=A*p-v*l-y*h-w*f;return Ti.rotateZ(t,e,n),t[4]=M*(p=t[3])+z*(l=t[0])+R*(f=t[2])-N*(h=t[1]),t[5]=R*p+z*h+N*l-M*f,t[6]=N*p+z*f+M*h-R*l,t[7]=z*p-M*l-R*h-N*f,t},wr.rotateByQuatAppend=function(t,e,n){var l=n[0],h=n[1],f=n[2],p=n[3],v=e[0],y=e[1],w=e[2],A=e[3];return t[0]=v*p+A*l+y*f-w*h,t[1]=y*p+A*h+w*l-v*f,t[2]=w*p+A*f+v*h-y*l,t[3]=A*p-v*l-y*h-w*f,t[4]=(v=e[4])*p+(A=e[7])*l+(y=e[5])*f-(w=e[6])*h,t[5]=y*p+A*h+w*l-v*f,t[6]=w*p+A*f+v*h-y*l,t[7]=A*p-v*l-y*h-w*f,t},wr.rotateByQuatPrepend=function(t,e,n){var l=e[0],h=e[1],f=e[2],p=e[3],v=n[0],y=n[1],w=n[2],A=n[3];return t[0]=l*A+p*v+h*w-f*y,t[1]=h*A+p*y+f*v-l*w,t[2]=f*A+p*w+l*y-h*v,t[3]=p*A-l*v-h*y-f*w,t[4]=l*(A=n[7])+p*(v=n[4])+h*(w=n[6])-f*(y=n[5]),t[5]=h*A+p*y+f*v-l*w,t[6]=f*A+p*w+l*y-h*v,t[7]=p*A-l*v-h*y-f*w,t},wr.rotateAroundAxis=function(t,e,n,l){if(Math.abs(l)<mi.EPSILON)return fn(t,e);var h=Math.hypot(n[0],n[1],n[2]);l*=.5;var f=Math.sin(l),p=f*n[0]/h,v=f*n[1]/h,y=f*n[2]/h,w=Math.cos(l),A=e[0],M=e[1],R=e[2],N=e[3];t[0]=A*w+N*p+M*y-R*v,t[1]=M*w+N*v+R*p-A*y,t[2]=R*w+N*y+A*v-M*p,t[3]=N*w-A*p-M*v-R*y;var z=e[4],q=e[5],Z=e[6],oe=e[7];return t[4]=z*w+oe*p+q*y-Z*v,t[5]=q*w+oe*v+Z*p-z*y,t[6]=Z*w+oe*y+z*v-q*p,t[7]=oe*w-z*p-q*v-Z*y,t},wr.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t},wr.multiply=Gl,wr.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t},wr.lerp=function(t,e,n,l){var h=1-l;return wh(e,n)<0&&(l=-l),t[0]=e[0]*h+n[0]*l,t[1]=e[1]*h+n[1]*l,t[2]=e[2]*h+n[2]*l,t[3]=e[3]*h+n[3]*l,t[4]=e[4]*h+n[4]*l,t[5]=e[5]*h+n[5]*l,t[6]=e[6]*h+n[6]*l,t[7]=e[7]*h+n[7]*l,t},wr.invert=function(t,e){var n=gc(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t},wr.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t},wr.normalize=function(t,e){var n=gc(e);if(n>0){n=Math.sqrt(n);var l=e[0]/n,h=e[1]/n,f=e[2]/n,p=e[3]/n,v=e[4],y=e[5],w=e[6],A=e[7],M=l*v+h*y+f*w+p*A;t[0]=l,t[1]=h,t[2]=f,t[3]=p,t[4]=(v-l*M)/n,t[5]=(y-h*M)/n,t[6]=(w-f*M)/n,t[7]=(A-p*M)/n}return t},wr.str=function(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"},wr.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]},wr.equals=function(t,e){var n=t[0],l=t[1],h=t[2],f=t[3],p=t[4],v=t[5],y=t[6],w=t[7],A=e[0],M=e[1],R=e[2],N=e[3],z=e[4],q=e[5],Z=e[6],oe=e[7];return Math.abs(n-A)<=mi.EPSILON*Math.max(1,Math.abs(n),Math.abs(A))&&Math.abs(l-M)<=mi.EPSILON*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(h-R)<=mi.EPSILON*Math.max(1,Math.abs(h),Math.abs(R))&&Math.abs(f-N)<=mi.EPSILON*Math.max(1,Math.abs(f),Math.abs(N))&&Math.abs(p-z)<=mi.EPSILON*Math.max(1,Math.abs(p),Math.abs(z))&&Math.abs(v-q)<=mi.EPSILON*Math.max(1,Math.abs(v),Math.abs(q))&&Math.abs(y-Z)<=mi.EPSILON*Math.max(1,Math.abs(y),Math.abs(Z))&&Math.abs(w-oe)<=mi.EPSILON*Math.max(1,Math.abs(w),Math.abs(oe))},wr.sqrLen=wr.squaredLength=wr.len=wr.length=wr.dot=wr.mul=wr.setReal=wr.getReal=void 0;var mi=Rn(he),Ti=Rn(Bt),An=Rn(Ve);function ln(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(ln=function(l){return l?n:e})(t)}function Rn(t,e){if(t&&t.__esModule)return t;if(t===null||Ei(t)!=="object"&&typeof t!="function")return{default:t};var n=ln(e);if(n&&n.has(t))return n.get(t);var l={},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var p=h?Object.getOwnPropertyDescriptor(t,f):null;p&&(p.get||p.set)?Object.defineProperty(l,f,p):l[f]=t[f]}return l.default=t,n&&n.set(t,l),l}function Hn(t,e,n){var l=.5*n[0],h=.5*n[1],f=.5*n[2],p=e[0],v=e[1],y=e[2],w=e[3];return t[0]=p,t[1]=v,t[2]=y,t[3]=w,t[4]=l*w+h*y-f*v,t[5]=h*w+f*p-l*y,t[6]=f*w+l*v-h*p,t[7]=-l*p-h*v-f*y,t}function fn(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Gl(t,e,n){var l=e[0],h=e[1],f=e[2],p=e[3],v=n[4],y=n[5],w=n[6],A=n[7],M=e[4],R=e[5],N=e[6],z=e[7],q=n[0],Z=n[1],oe=n[2],ye=n[3];return t[0]=l*ye+p*q+h*oe-f*Z,t[1]=h*ye+p*Z+f*q-l*oe,t[2]=f*ye+p*oe+l*Z-h*q,t[3]=p*ye-l*q-h*Z-f*oe,t[4]=l*A+p*v+h*w-f*y+M*ye+z*q+R*oe-N*Z,t[5]=h*A+p*y+f*v-l*w+R*ye+z*Z+N*q-M*oe,t[6]=f*A+p*w+l*y-h*v+N*ye+z*oe+M*Z-R*q,t[7]=p*A-l*v-h*y-f*w+z*ye-M*q-R*Z-N*oe,t}wr.getReal=Ti.copy,wr.setReal=Ti.copy,wr.mul=Gl;var wh=Ti.dot;wr.dot=wh;var md=Ti.length;wr.length=md,wr.len=md;var gc=Ti.squaredLength;wr.squaredLength=gc,wr.sqrLen=gc;var ci={};function Os(t){return Os=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Os(t)}Object.defineProperty(ci,"__esModule",{value:!0}),ci.create=Cu,ci.clone=function(t){var e=new Ns.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},ci.fromValues=function(t,e){var n=new Ns.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},ci.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},ci.set=function(t,e,n){return t[0]=e,t[1]=n,t},ci.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},ci.subtract=Th,ci.multiply=gd,ci.divide=Sh,ci.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},ci.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},ci.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},ci.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},ci.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},ci.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},ci.scaleAndAdd=function(t,e,n,l){return t[0]=e[0]+n[0]*l,t[1]=e[1]+n[1]*l,t},ci.distance=_d,ci.squaredDistance=Eh,ci.length=vd,ci.squaredLength=Iu,ci.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},ci.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},ci.normalize=function(t,e){var n=e[0],l=e[1],h=n*n+l*l;return h>0&&(h=1/Math.sqrt(h)),t[0]=e[0]*h,t[1]=e[1]*h,t},ci.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},ci.cross=function(t,e,n){var l=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=l,t},ci.lerp=function(t,e,n,l){var h=e[0],f=e[1];return t[0]=h+l*(n[0]-h),t[1]=f+l*(n[1]-f),t},ci.random=function(t,e){e=e||1;var n=2*Ns.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},ci.transformMat2=function(t,e,n){var l=e[0],h=e[1];return t[0]=n[0]*l+n[2]*h,t[1]=n[1]*l+n[3]*h,t},ci.transformMat2d=function(t,e,n){var l=e[0],h=e[1];return t[0]=n[0]*l+n[2]*h+n[4],t[1]=n[1]*l+n[3]*h+n[5],t},ci.transformMat3=function(t,e,n){var l=e[0],h=e[1];return t[0]=n[0]*l+n[3]*h+n[6],t[1]=n[1]*l+n[4]*h+n[7],t},ci.transformMat4=function(t,e,n){var l=e[0],h=e[1];return t[0]=n[0]*l+n[4]*h+n[12],t[1]=n[1]*l+n[5]*h+n[13],t},ci.rotate=function(t,e,n,l){var h=e[0]-n[0],f=e[1]-n[1],p=Math.sin(l),v=Math.cos(l);return t[0]=h*v-f*p+n[0],t[1]=h*p+f*v+n[1],t},ci.angle=function(t,e){var n=t[0],l=t[1],h=e[0],f=e[1],p=Math.sqrt(n*n+l*l)*Math.sqrt(h*h+f*f);return Math.acos(Math.min(Math.max(p&&(n*h+l*f)/p,-1),1))},ci.zero=function(t){return t[0]=0,t[1]=0,t},ci.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},ci.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},ci.equals=function(t,e){var n=t[0],l=t[1],h=e[0],f=e[1];return Math.abs(n-h)<=Ns.EPSILON*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(l-f)<=Ns.EPSILON*Math.max(1,Math.abs(l),Math.abs(f))},ci.forEach=ci.sqrLen=ci.sqrDist=ci.dist=ci.div=ci.mul=ci.sub=ci.len=void 0;var Ns=function(t,e){if(t&&t.__esModule)return t;if(t===null||Os(t)!=="object"&&typeof t!="function")return{default:t};var n=Go(void 0);if(n&&n.has(t))return n.get(t);var l={},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var p=h?Object.getOwnPropertyDescriptor(t,f):null;p&&(p.get||p.set)?Object.defineProperty(l,f,p):l[f]=t[f]}return l.default=t,n&&n.set(t,l),l}(he);function Go(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Go=function(l){return l?n:e})(t)}function Cu(){var t=new Ns.ARRAY_TYPE(2);return Ns.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function Th(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function gd(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function Sh(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function _d(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1])}function Eh(t,e){var n=e[0]-t[0],l=e[1]-t[1];return n*n+l*l}function vd(t){return Math.hypot(t[0],t[1])}function Iu(t){var e=t[0],n=t[1];return e*e+n*n}ci.len=vd,ci.sub=Th,ci.mul=gd,ci.div=Sh,ci.dist=_d,ci.sqrDist=Eh,ci.sqrLen=Iu;var gf=function(){var t=Cu();return function(e,n,l,h,f,p){var v,y;for(n||(n=2),l||(l=0),y=h?Math.min(h*n+l,e.length):e.length,v=l;v<y;v+=n)t[0]=e[v],t[1]=e[v+1],f(t,t,p),e[v]=t[0],e[v+1]=t[1];return e}}();function Zc(t){return Zc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zc(t)}ci.forEach=gf,Object.defineProperty(ne,"__esModule",{value:!0}),r.aA=ne.vec4=r._=ne.vec3=ne.vec2=ne.quat2=r.av=ne.quat=r.ad=ne.mat4=r.bC=ne.mat3=ne.mat2d=r.aC=ne.mat2=ne.glMatrix=void 0;var Ah=yo(he);ne.glMatrix=Ah;var rl=yo(ge);r.aC=ne.mat2=rl;var ku=yo(Ce);ne.mat2d=ku;var Mu=yo(ht);r.bC=ne.mat3=Mu;var yd=yo(Ve);r.ad=ne.mat4=yd;var Ya=yo(Bt);r.av=ne.quat=Ya;var Mi=yo(wr);ne.quat2=Mi;var _f=yo(ci);ne.vec2=_f;var Vi=yo(nr);r._=ne.vec3=Vi;var Cp=yo(Dr);function xd(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(xd=function(l){return l?n:e})(t)}function yo(t,e){if(t&&t.__esModule)return t;if(t===null||Zc(t)!=="object"&&typeof t!="function")return{default:t};var n=xd(e);if(n&&n.has(t))return n.get(t);var l={},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in t)if(f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)){var p=h?Object.getOwnPropertyDescriptor(t,f):null;p&&(p.get||p.set)?Object.defineProperty(l,f,p):l[f]=t[f]}return l.default=t,n&&n.set(t,l),l}r.aA=ne.vec4=Cp;var Ch=Yc;function Yc(t,e,n,l){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(l-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=n,this.p2y=l}Yc.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(e===void 0&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var n=t,l=0;l<8;l++){var h=this.sampleCurveX(n)-t;if(Math.abs(h)<e)return n;var f=this.sampleCurveDerivativeX(n);if(Math.abs(f)<1e-6)break;n-=h/f}var p=0,v=1;for(n=t,l=0;l<20&&(h=this.sampleCurveX(n),!(Math.abs(h-t)<e));l++)t>h?p=n:v=n,n=.5*(v-p)+p;return n},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var Hl=J(Ch),Kc=_c;function _c(t,e){this.x=t,this.y=e}_c.prototype={clone:function(){return new _c(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),l=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=l,this},_rotateAround:function(t,e){var n=Math.cos(t),l=Math.sin(t),h=e.y+l*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-l*(this.y-e.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},_c.convert=function(t){return t instanceof _c?t:Array.isArray(t)?new _c(t[0],t[1]):t};var hr=J(Kc);let vf=Math.PI/180,vc=180/Math.PI;function Ai(t){return t*vf}function ka(t){return t*vc}let yf=[[0,0],[1,0],[1,1],[0,1]];function yc(t){if(t<=0)return 0;if(t>=1)return 1;let e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function xc(t,e,n,l){let h=new Hl(t,e,n,l);return function(f){return h.solve(f)}}let Sl=xc(.25,.1,.25,1);function ui(t,e,n){return Math.min(n,Math.max(e,t))}function Wl(t,e,n){return(n=ui((n-t)/(e-t),0,1))*n*(3-2*n)}function ql(t,e,n){let l=n-e,h=((t-e)%l+l)%l+e;return h===e?n:h}function bc(t,e,n){if(!t.length)return n(null,[]);let l=t.length,h=new Array(t.length),f=null;t.forEach((p,v)=>{e(p,(y,w)=>{y&&(f=y),h[v]=w,--l==0&&n(f,h)})})}function lo(t){let e=[];for(let n in t)e.push(t[n]);return e}function Ma(t,...e){for(let n of e)for(let l in n)t[l]=n[l];return t}let Ip=1;function El(){return Ip++}function gs(){return function t(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function Du(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function wc(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function Ih(t,e){t.forEach(n=>{e[n]&&(e[n]=e[n].bind(e))})}function $l(t,e){return t.indexOf(e,t.length-e.length)!==-1}function Jc(t,e,n){let l={};for(let h in t)l[h]=e.call(this,t[h],h,t);return l}function Al(t,e,n){let l={};for(let h in t)e.call(this,t[h],h,t)&&(l[h]=t[h]);return l}function _s(t){return Array.isArray(t)?t.map(_s):typeof t=="object"&&t?Jc(t,_s):t}let kh={};function Wn(t){kh[t]||(typeof console<"u"&&console.warn(t),kh[t]=!0)}function vs(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function co(t){let e=0;for(let n,l,h=0,f=t.length,p=f-1;h<f;p=h++)n=t[h],l=t[p],e+=(l.x-n.x)*(n.y+l.y);return e}function il([t,e,n]){let l=Ai(e+90),h=Ai(n);return{x:t*Math.cos(l)*Math.sin(h),y:t*Math.sin(l)*Math.sin(h),z:t*Math.cos(h),azimuthal:e,polar:n}}function uo(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Qc(t){let e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,l,h,f)=>{let p=h||f;return e[l]=!p||p.toLowerCase(),""}),e["max-age"]){let n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}let Tc,eu,Bs,Sc,H,Ee,ct=null;function yt(t){try{let e=self[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Lt(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}function sr(t,e,n,l){for(;e<n;){let h=e+n>>1;t[h]<l?e=h+1:n=h}return e}function Mr(t,e,n,l){for(;e<n;){let h=e+n>>1;t[h]<=l?e=h+1:n=h}return e}function Yr(t){return t>0?1/(1.001-t):1+t}function hi(t){return t>0?1-1/(1.001-t):-t}function Fi(){return Tc==null&&(Tc=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Tc}let di={now:()=>Sc!==void 0?Sc:performance.now(),setNow(t){Sc=t},restoreNow(){Sc=void 0},frame(t){let e=requestAnimationFrame(t);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(t,e=0){let{width:n,height:l}=t;H||(H=document.createElement("canvas"));let h=H.getContext("2d",{willReadFrequently:!0});if(!h)throw new Error("failed to create canvas 2d context");return(n>H.width||l>H.height)&&(H.width=n,H.height=l),h.clearRect(-e,-e,n+2*e,l+2*e),h.drawImage(t,0,0,n,l),h.getImageData(-e,-e,n+2*e,l+2*e)},resolveURL:t=>(eu||(eu=document.createElement("a")),eu.href=t,eu.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Bs==null&&(Bs=window.matchMedia("(prefers-reduced-motion: reduce)")),Bs.matches)},hasCanvasFingerprintNoise(){if(Ee!==void 0)return Ee;if(!Fi())return Ee=!1,!1;let t=new OffscreenCanvas(85,1),e=t.getContext("2d",{willReadFrequently:!0}),n=0;for(let h=0;h<t.width;++h)e.fillStyle=`rgba(${n++},${n++},${n++}, 255)`,e.fillRect(h,0,1,1);let l=e.getImageData(0,0,t.width,t.height);n=0;for(let h=0;h<l.data.length;++h)if(h%4!=3&&n++!==l.data[h])return Ee=!0,!0;return Ee=!1,!1}};function pn(t,e){let n=t.indexOf("?");if(n<0)return`${t}?${new URLSearchParams(e).toString()}`;let l=new URLSearchParams(t.slice(n));for(let h in e)l.set(h,e[h]);return`${t.slice(0,n)}?${l.toString()}`}function va(t,e={persistentParams:[]}){let n=t.indexOf("?");if(n<0)return t;let l=new URLSearchParams,h=new URLSearchParams(t.slice(n));for(let p of e.persistentParams){let v=h.get(p);v&&l.set(p,v)}let f=l.toString();return`${t.slice(0,n)}${f.length>0?`?${f}`:""}`}let Na="mapbox-tiles",Va=500,Io=50,la,ys;function xs(){try{return caches}catch{}}function zs(){let t=xs();t&&!la&&(la=t.open(Na))}let Ru=1/0,tu={supported:!1,testSupport:function(t){!Fu&&Cl&&(Pu?rs(t):Xl=t)}},Xl,Cl,Fu=!1,Pu=!1,ru=typeof self<"u"?self:{};function rs(t){let e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,Cl),t.isContextLost())return;tu.supported=!0}catch{}t.deleteTexture(e),Fu=!0}ru.document&&(Cl=ru.document.createElement("img"),Cl.onload=function(){Xl&&rs(Xl),Xl=null,Pu=!0},Cl.onerror=function(){Fu=!0,Xl=null},Cl.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");let Ec={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Ec);class iu extends Error{constructor(e,n,l){n===401&&k(l)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=n,this.url=l}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}let Ac=uo()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Cc=function(t,e){if(!(/^file:/.test(n=t.url)||/^file:/.test(Ac())&&!/^\w+:/.test(n))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(l,h){let f=new AbortController,p=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:Ac(),referrerPolicy:l.referrerPolicy,signal:f.signal}),v=!1,y=!1,w=(A=p.url).indexOf("sku=")>0&&k(A);var A;l.type==="json"&&p.headers.set("Accept","application/json");let M=(N,z,q)=>{if(y)return;if(N&&N.message!=="SecurityError"&&Wn(N.toString()),z&&q)return R(z);let Z=Date.now();fetch(p).then(oe=>{if(oe.ok){let ye=w?oe.clone():null;return R(oe,ye,Z)}return h(new iu(oe.statusText,oe.status,l.url))}).catch(oe=>{oe.name!=="AbortError"&&h(new Error(`${oe.message} ${l.url}`))})},R=(N,z,q)=>{(l.type==="arrayBuffer"?N.arrayBuffer():l.type==="json"?N.json():N.text()).then(Z=>{y||(z&&q&&function(oe,ye,be){if(zs(),!la)return;let we=Qc(ye.headers.get("Cache-Control")||"");if(we["no-store"])return;let $e={status:ye.status,statusText:ye.statusText,headers:new Headers};ye.headers.forEach((ot,_t)=>$e.headers.set(_t,ot)),we["max-age"]&&$e.headers.set("Expires",new Date(be+1e3*we["max-age"]).toUTCString());let He=$e.headers.get("Expires");if(!He||new Date(He).getTime()-be<42e4)return;let rt=va(oe.url,{persistentParams:["language","worldview"]});if(ye.status===206){let ot=oe.headers.get("Range");if(!ot)return;$e.status=200,rt=pn(rt,{range:ot})}(function(ot,_t){if(ys===void 0)try{new Response(new ReadableStream),ys=!0}catch{ys=!1}ys?_t(ot.body):ot.blob().then(_t)})(ye,ot=>{let _t=new Response((Mt=ye.status)!==200&&Mt!==404&&[101,103,204,205,304].includes(Mt)?null:ot,$e);var Mt;zs(),la&&la.then(At=>At.put(rt,_t)).catch(At=>Wn(At.message))})}(p,z,q),v=!0,h(null,Z,N.headers.get("Cache-Control"),N.headers.get("Expires")))}).catch(Z=>{y||h(new Error(Z.message))})};return w?function(N,z){if(zs(),!la)return z(null);la.then(q=>{let Z=va(N.url,{persistentParams:["language","worldview"]}),oe=N.headers.get("Range");oe&&(Z=pn(Z,{range:oe})),q.match(Z).then(ye=>{let be=function(we){if(!we)return!1;let $e=new Date(we.headers.get("Expires")||0),He=Qc(we.headers.get("Cache-Control")||"");return $e>Date.now()&&!He["no-cache"]}(ye);q.delete(Z),be&&q.put(Z,ye.clone()),z(null,ye,be)}).catch(z)}).catch(z)}(p,M):M(null,null),{cancel:()=>{y=!0,v||f.abort()}}}(t,e);if(uo()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var n;return function(l,h){let f=new XMLHttpRequest;f.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(f.responseType="arraybuffer");for(let p in l.headers)f.setRequestHeader(p,l.headers[p]);return l.type==="json"&&(f.responseType="text",f.setRequestHeader("Accept","application/json")),f.withCredentials=l.credentials==="include",f.onerror=()=>{h(new Error(f.statusText))},f.onload=()=>{if((f.status>=200&&f.status<300||f.status===0)&&f.response!==null){let p=f.response;if(l.type==="json")try{p=JSON.parse(f.response)}catch(v){return h(v)}h(null,p,f.getResponseHeader("Cache-Control"),f.getResponseHeader("Expires"))}else h(new iu(f.statusText,f.status,l.url))},f.send(l.body),{cancel:()=>f.abort()}}(t,e)},ho=function(t,e){return Cc(Ma(t,{type:"arrayBuffer"}),e)};function xf(t){let e=document.createElement("a");return e.href=t,e.protocol===location.protocol&&e.host===location.host}let Lu="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",nu,is;nu=[],is=0;let nl=function(t,e){if(tu.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),is>=E.MAX_PARALLEL_IMAGE_REQUESTS){let f={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return nu.push(f),f}is++;let n=!1,l=()=>{if(!n)for(n=!0,is--;nu.length&&is<E.MAX_PARALLEL_IMAGE_REQUESTS;){let f=nu.shift(),{requestParameters:p,callback:v,cancelled:y}=f;y||(f.cancel=nl(p,v).cancel)}},h=ho(t,(f,p,v,y)=>{l(),f?e(f):p&&(self.createImageBitmap?function(w,A){let M=new Blob([new Uint8Array(w)],{type:"image/png"});createImageBitmap(M).then(R=>{A(null,R)}).catch(R=>{A(new Error(`Could not load image because of ${R.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(p,(w,A)=>e(w,A,v,y)):function(w,A){let M=new Image;M.onload=()=>{A(null,M),URL.revokeObjectURL(M.src),M.onload=null,requestAnimationFrame(()=>{M.src=Lu})},M.onerror=()=>A(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let R=new Blob([new Uint8Array(w)],{type:"image/png"});M.src=w.byteLength?URL.createObjectURL(R):Lu}(p,(w,A)=>e(w,A,v,y)))});return{cancel:()=>{h.cancel(),l()}}},bd="01",wd="NO_ACCESS_TOKEN",au=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ga(t){let e=t.match(au);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Ho(t){let e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}let Il="mapbox.eventData";function kl(t){if(!t)return null;let e=t.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(atob(e[1]).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class js{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){let n=kl(E.ACCESS_TOKEN),l="";return l=n&&n.u?btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(h,f)=>String.fromCharCode(+("0x"+f)))):E.ACCESS_TOKEN||"",e?`${Il}.${e}:${l}`:`${Il}:${l}`}fetchEventData(){let e=yt("localStorage"),n=this.getStorageKey(),l=this.getStorageKey("uuid");if(e)try{let h=localStorage.getItem(n);h&&(this.eventData=JSON.parse(h));let f=localStorage.getItem(l);f&&(this.anonId=f)}catch{Wn("Unable to read from LocalStorage")}}saveEventData(){let e=yt("localStorage"),n=this.getStorageKey(),l=this.getStorageKey("uuid"),h=this.anonId;if(e&&h)try{localStorage.setItem(l,h),Object.keys(this.eventData).length>=1&&localStorage.setItem(n,JSON.stringify(this.eventData))}catch{Wn("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,n,l,h){if(!E.EVENTS_URL)return;let f=Ga(E.EVENTS_URL);f.params.push(`access_token=${h||E.ACCESS_TOKEN||""}`);let p={event:this.type,created:new Date(e).toISOString()},v=n?Ma(p,n):p,y={url:Ho(f),headers:{"Content-Type":"text/plain"},body:JSON.stringify([v])};this.pendingRequest=function(w,A){return Cc(Ma(w,{method:"POST"}),A)}(y,w=>{this.pendingRequest=null,l(w),this.saveEventData(),this.processRequests(h)})}queueRequest(e,n){this.queue.push(e),this.processRequests(n)}}let Ou=new class extends js{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){E.EVENTS_URL&&E.ACCESS_TOKEN&&Array.isArray(t)&&t.some(n=>D(n)||k(n))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();let e=kl(E.ACCESS_TOKEN),n=e?e.u:E.ACCESS_TOKEN,l=n!==this.eventData.tokenU;wc(this.anonId)||(this.anonId=gs(),l=!0);let h=this.queue.shift();if(this.eventData.lastSuccess){let f=new Date(this.eventData.lastSuccess),p=new Date(h),v=(h-this.eventData.lastSuccess)/864e5;l=l||v>=1||v<-1||f.getDate()!==p.getDate()}else l=!0;l?this.postEvent(h,{sdkIdentifier:"mapbox-gl-js",sdkVersion:_,skuId:bd,"enabled.telemetry":!1,userId:this.anonId},f=>{f||(this.eventData.lastSuccess=h,this.eventData.tokenU=n)},t):this.processRequests()}},Us=Ou.postTurnstileEvent.bind(Ou),Zl=new class extends js{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,n,l){this.skuToken=e,this.errorCb=l,E.EVENTS_URL&&(n||E.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(wd)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;let{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),wc(this.anonId)||(this.anonId=gs()),this.postEvent(n,{sdkIdentifier:"mapbox-gl-js",sdkVersion:_,skuId:bd,skuToken:this.skuToken,userId:this.anonId},l=>{l?this.errorCb(l):e&&(this.success[e]=!0)},t))}remove(){this.errorCb=null}},Mh=Zl.postMapLoadEvent.bind(Zl),Ic=new class extends js{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(t){let e=this.mapInstanceIdMap.get(t);return e||(e=gs(),this.mapInstanceIdMap.set(t,e)),e}getEventId(t){let e=this.eventIdPerMapInstanceMap.get(t)||0;return this.eventIdPerMapInstanceMap.set(t,e+1),e}postStyleLoadEvent(t,e){let{map:n,style:l,importedStyles:h}=e;if(!E.EVENTS_URL||!t&&!E.ACCESS_TOKEN)return;let f=this.getMapInstanceId(n),p={mapInstanceId:f,eventId:this.getEventId(f),style:l};h.length&&(p.importedStyles=h),this.queueRequest({timestamp:Date.now(),payload:p},t)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;let{timestamp:e,payload:n}=this.queue.shift();this.postEvent(e,n,()=>{},t)}},Ml=Ic.postStyleLoadEvent.bind(Ic),al=new class extends js{constructor(){super("gljs.performance")}postPerformanceEvent(t,e){E.EVENTS_URL&&(t||E.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},t)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;let{timestamp:e,performanceData:n}=this.queue.shift(),l=function(h){let f=performance.getEntriesByType("resource"),p=performance.getEntriesByType("mark"),v=function(N){let z={};if(N){for(let q in N)if(q!=="other")for(let Z of N[q]){let oe=`${q}ResolveRangeMin`,ye=`${q}ResolveRangeMax`,be=`${q}RequestCount`,we=`${q}RequestCachedCount`;z[oe]=Math.min(z[oe]||1/0,Z.startTime),z[ye]=Math.max(z[ye]||-1/0,Z.responseEnd);let $e=He=>{z[He]===void 0&&(z[He]=0),++z[He]};Z.transferSize!==void 0&&Z.transferSize===0&&$e(we),$e(be)}}return z}(function(N,z){let q={};if(N)for(let Z of N){let oe=z(Z);q[oe]===void 0&&(q[oe]=[]),q[oe].push(Z)}return q}(f,K)),y=window.devicePixelRatio,w=navigator.connection||navigator.mozConnection||navigator.webkitConnection,A=w?w.effectiveType:void 0,M={counters:[],metadata:[],attributes:[]},R=(N,z,q)=>{q!=null&&N.push({name:z,value:q.toString()})};for(let N in v)R(M.counters,N,v[N]);if(h.interactionRange[0]!==1/0&&h.interactionRange[1]!==-1/0&&(R(M.counters,"interactionRangeMin",h.interactionRange[0]),R(M.counters,"interactionRangeMax",h.interactionRange[1])),p)for(let N of Object.keys(ee)){let z=ee[N],q=p.find(Z=>Z.name===z);q&&R(M.counters,z,q.startTime)}return R(M.counters,"visibilityHidden",h.visibilityHidden),R(M.attributes,"style",function(N){if(N)for(let z of N){let q=z.name.split("?")[0];if(P(q)){let Z=q.split("/").slice(-2);if(Z.length===2)return`mapbox://styles/${Z[0]}/${Z[1]}`}}}(f)),R(M.attributes,"terrainEnabled",h.terrainEnabled?"true":"false"),R(M.attributes,"fogEnabled",h.fogEnabled?"true":"false"),R(M.attributes,"projection",h.projection),R(M.attributes,"zoom",h.zoom),R(M.metadata,"devicePixelRatio",y),R(M.metadata,"connectionEffectiveType",A),R(M.metadata,"navigatorUserAgent",navigator.userAgent),R(M.metadata,"screenWidth",window.screen.width),R(M.metadata,"screenHeight",window.screen.height),R(M.metadata,"windowWidth",window.innerWidth),R(M.metadata,"windowHeight",window.innerHeight),R(M.metadata,"mapWidth",h.width/y),R(M.metadata,"mapHeight",h.height/y),R(M.metadata,"webglRenderer",h.renderer),R(M.metadata,"webglVendor",h.vendor),R(M.metadata,"sdkVersion",_),R(M.metadata,"sdkIdentifier","mapbox-gl-js"),M}(n);for(let h of l.metadata);for(let h of l.counters);for(let h of l.attributes);this.postEvent(e,l,()=>{},t)}},Nu=al.postPerformanceEvent.bind(al),Dl=new class extends js{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,n,l){if(!E.API_URL||!E.SESSION_PATH)return;let h=Ga(E.API_URL+E.SESSION_PATH);h.params.push(`sku=${e||""}`),h.params.push(`access_token=${l||E.ACCESS_TOKEN||""}`);let f={url:Ho(h),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(p,v){return Cc(Ma(p,{method:"GET"}),v)}(f,p=>{this.pendingRequest=null,n(p),this.saveEventData(),this.processRequests(l)})}getSessionAPI(t,e,n,l){this.skuToken=e,this.errorCb=l,E.SESSION_PATH&&E.API_URL&&(n||E.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(wd)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;let{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||this.getSession(n,this.skuToken,l=>{l?this.errorCb(l):e&&(this.success[e]=!0)},t)}remove(){this.errorCb=null}},Yl=Dl.getSessionAPI.bind(Dl),ol=new Set;var Rl={exports:{}},Vs={exports:function(t,e){var n,l,h,f,p,v,y,w;for(l=t.length-(n=3&t.length),h=e,p=3432918353,v=461845907,w=0;w<l;)y=255&t.charCodeAt(w)|(255&t.charCodeAt(++w))<<8|(255&t.charCodeAt(++w))<<16|(255&t.charCodeAt(++w))<<24,++w,h=27492+(65535&(f=5*(65535&(h=(h^=y=(65535&(y=(y=(65535&y)*p+(((y>>>16)*p&65535)<<16)&4294967295)<<15|y>>>17))*v+(((y>>>16)*v&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(y=0,n){case 3:y^=(255&t.charCodeAt(w+2))<<16;case 2:y^=(255&t.charCodeAt(w+1))<<8;case 1:h^=y=(65535&(y=(y=(65535&(y^=255&t.charCodeAt(w)))*p+(((y>>>16)*p&65535)<<16)&4294967295)<<15|y>>>17))*v+(((y>>>16)*v&65535)<<16)&4294967295}return h^=t.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0}},kc={exports:function(t,e){for(var n,l=t.length,h=e^l,f=0;l>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(f)|(255&t.charCodeAt(++f))<<8|(255&t.charCodeAt(++f))<<16|(255&t.charCodeAt(++f))<<24))+((1540483477*(n>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),l-=4,++f;switch(l){case 3:h^=(255&t.charCodeAt(f+2))<<16;case 2:h^=(255&t.charCodeAt(f+1))<<8;case 1:h=1540483477*(65535&(h^=255&t.charCodeAt(f)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0}},Qn=Vs.exports,Yn=kc.exports;Rl.exports=Qn,Rl.exports.murmur3=Qn,Rl.exports.murmur2=Yn;var ca=J(Rl.exports);function Ka(t,e,n){n[t]&&n[t].indexOf(e)!==-1||(n[t]=n[t]||[],n[t].push(e))}function bs(t,e,n){if(n&&n[t]){let l=n[t].indexOf(e);l!==-1&&n[t].splice(l,1)}}class Ha{constructor(e,n={}){Ma(this,n),this.type=e}}class Mc extends Ha{constructor(e,n={}){super("error",Ma({error:e},n))}}class Kl{on(e,n){return this._listeners=this._listeners||{},Ka(e,n,this._listeners),this}off(e,n){return bs(e,n,this._listeners),bs(e,n,this._oneTimeListeners),this}once(e,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},Ka(e,n,this._oneTimeListeners),this):new Promise(l=>this.once(e,l))}fire(e,n){typeof e=="string"&&(e=new Ha(e,n||{}));let l=e.type;if(this.listens(l)){e.target=this;let h=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(let v of h)v.call(this,e);let f=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(let v of f)bs(l,v,this._oneTimeListeners),v.call(this,e);let p=this._eventedParent;p&&(Ma(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),p.fire(e))}else e instanceof Mc&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,n){return this._eventedParent=e,this._eventedParentData=n,this}}r.F=void 0;var kp={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Td(t){return(t=Math.round(t))<0?0:t>255?255:t}function bf(t){return Td(t[t.length-1]==="%"?parseFloat(t)/100*255:parseInt(t))}function Dh(t){return(e=t[t.length-1]==="%"?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function Rh(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{r.F={}.parseCSSColor=function(t){var e,n=t.replace(/ /g,"").toLowerCase();if(n in kp)return kp[n].slice();if(n[0]==="#")return n.length===4?(e=parseInt(n.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:n.length===7&&(e=parseInt(n.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var l=n.indexOf("("),h=n.indexOf(")");if(l!==-1&&h+1===n.length){var f=n.substr(0,l),p=n.substr(l+1,h-(l+1)).split(","),v=1;switch(f){case"rgba":if(p.length!==4)return null;v=Dh(p.pop());case"rgb":return p.length!==3?null:[bf(p[0]),bf(p[1]),bf(p[2]),v];case"hsla":if(p.length!==4)return null;v=Dh(p.pop());case"hsl":if(p.length!==3)return null;var y=(parseFloat(p[0])%360+360)%360/360,w=Dh(p[1]),A=Dh(p[2]),M=A<=.5?A*(w+1):A+w-A*w,R=2*A-M;return[Td(255*Rh(R,M,y+1/3)),Td(255*Rh(R,M,y)),Td(255*Rh(R,M,y-1/3)),v];default:return null}}return null}}catch{}class qi{constructor(e,n,l,h=1){this.r=e,this.g=n,this.b=l,this.a=h}static parse(e){if(!e)return;if(e instanceof qi)return e;if(typeof e!="string")return;let n=r.F(e);return n?new qi(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3]):void 0}toString(){let[e,n,l,h]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(e)},${Math.round(n)},${Math.round(l)},${h})`}toRenderColor(e){let{r:n,g:l,b:h,a:f}=this;return new Mp(e,n,l,h,f)}}class Mp{constructor(e,n,l,h,f){if(e){let p=e.image.height,v=p*p;n=f===0?0:n/f*(p-1),l=f===0?0:l/f*(p-1),h=f===0?0:h/f*(p-1);let y=Math.floor(n),w=Math.floor(l),A=Math.floor(h),M=Math.ceil(n),R=Math.ceil(l),N=Math.ceil(h),z=n-y,q=l-w,Z=h-A,oe=e.image.data,ye=4*(y+w*v+A*p),be=4*(y+w*v+N*p),we=4*(y+R*v+A*p),$e=4*(y+R*v+N*p),He=4*(M+w*v+A*p),rt=4*(M+w*v+N*p),ot=4*(M+R*v+A*p),_t=4*(M+R*v+N*p);if(ye<0||_t>=oe.length)throw new Error("out of range");this.r=Xr(Xr(Xr(oe[ye],oe[be],Z),Xr(oe[we],oe[$e],Z),q),Xr(Xr(oe[He],oe[rt],Z),Xr(oe[ot],oe[_t],Z),q),z)/255*f,this.g=Xr(Xr(Xr(oe[ye+1],oe[be+1],Z),Xr(oe[we+1],oe[$e+1],Z),q),Xr(Xr(oe[He+1],oe[rt+1],Z),Xr(oe[ot+1],oe[_t+1],Z),q),z)/255*f,this.b=Xr(Xr(Xr(oe[ye+2],oe[be+2],Z),Xr(oe[we+2],oe[$e+2],Z),q),Xr(Xr(oe[He+2],oe[rt+2],Z),Xr(oe[ot+2],oe[_t+2],Z),q),z)/255*f,this.a=f}else this.r=n,this.g=l,this.b=h,this.a=f}toArray(){let{r:e,g:n,b:l,a:h}=this;return h===0?[0,0,0,0]:[255*e/h,255*n/h,255*l/h,h]}toArray01(){let{r:e,g:n,b:l,a:h}=this;return h===0?[0,0,0,0]:[e/h,n/h,l/h,h]}toArray01Scaled(e){let{r:n,g:l,b:h,a:f}=this;return f===0?[0,0,0]:[n/f*e,l/f*e,h/f*e]}toArray01PremultipliedAlpha(){let{r:e,g:n,b:l,a:h}=this;return[e,n,l,h]}toArray01Linear(){let{r:e,g:n,b:l,a:h}=this;return h===0?[0,0,0,0]:[Math.pow(e/h,2.2),Math.pow(n/h,2.2),Math.pow(l/h,2.2),h]}}function Xr(t,e,n){return t*(1-n)+e*n}function ws(t,e,n){return t.map((l,h)=>Xr(l,e[h],n))}qi.black=new qi(0,0,0,1),qi.white=new qi(1,1,1,1),qi.transparent=new qi(0,0,0,0),qi.red=new qi(1,0,0,1),qi.blue=new qi(0,0,1,1);var ns=Object.freeze({__proto__:null,array:ws,color:function(t,e,n){return new qi(Xr(t.r,e.r,n),Xr(t.g,e.g,n),Xr(t.b,e.b,n),Xr(t.a,e.a,n))},number:Xr});function Fh(t,...e){for(let n of e)for(let l in n)t[l]=n[l];return t}class Gs extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}class wf{constructor(e,n=[]){this.parent=e,this.bindings={};for(let[l,h]of n)this.bindings[l]=h}concat(e){return new wf(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}let Dc={kind:"null"},Tr={kind:"number"},Gi={kind:"string"},$i={kind:"boolean"},Po={kind:"color"},ou={kind:"object"},Oi={kind:"value"},Hs={kind:"collator"},Ph={kind:"formatted"},Jl={kind:"resolvedImage"};function as(t,e){return{kind:"array",itemType:t,N:e}}function Da(t){if(t.kind==="array"){let e=Da(t.itemType);return typeof t.N=="number"?`array<${e}, ${t.N}>`:t.itemType.kind==="value"?"array":`array<${e}>`}return t.kind}let vg=[Dc,Tr,Gi,$i,Po,Ph,ou,as(Oi),Jl];function Sd(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Sd(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(let n of vg)if(!Sd(n,e))return null}}return`Expected ${Da(t)} but found ${Da(e)} instead.`}function Dp(t,e){return e.some(n=>n.kind===t.kind)}function Lh(t,e){return e.some(n=>n==="null"?t===null:n==="array"?Array.isArray(t):n==="object"?t&&!Array.isArray(t)&&typeof t=="object":n===typeof t)}class Bu{constructor(e,n,l){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Rc{constructor(e,n,l,h,f){this.text=e.normalize?e.normalize():e,this.image=n,this.scale=l,this.fontStack=h,this.textColor=f}}class Ja{constructor(e){this.sections=e}static fromString(e){return new Ja([new Rc(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.namePrimary.length!==0)}static factory(e){return e instanceof Ja?e:Ja.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){let e=["format"];for(let n of this.sections){if(n.image){e.push(["image",n.image.namePrimary]);continue}e.push(n.text);let l={};n.fontStack&&(l["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(l["font-scale"]=n.scale),n.textColor&&(l["text-color"]=["rgba"].concat(n.textColor.toRenderColor(null).toArray())),e.push(l)}return e}}class os{constructor(e){this.namePrimary=e.namePrimary,e.nameSecondary&&(this.nameSecondary=e.nameSecondary),this.available=e.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(e,n){return e?new os({namePrimary:e,nameSecondary:n,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function Nm(t,e,n,l){return typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[t,e,n,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[t,e,n,l]:[t,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Wo(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof qi||t instanceof Bu||t instanceof Ja||t instanceof os)return!0;if(Array.isArray(t)){for(let e of t)if(!Wo(e))return!1;return!0}if(typeof t=="object"){for(let e in t)if(!Wo(t[e]))return!1;return!0}return!1}function Wa(t){if(t===null)return Dc;if(typeof t=="string")return Gi;if(typeof t=="boolean")return $i;if(typeof t=="number")return Tr;if(t instanceof qi)return Po;if(t instanceof Bu)return Hs;if(t instanceof Ja)return Ph;if(t instanceof os)return Jl;if(Array.isArray(t)){let e=t.length,n;for(let l of t){let h=Wa(l);if(n){if(n===h)continue;n=Oi;break}n=h}return as(n||Oi,e)}return ou}function sl(t){let e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof qi||t instanceof Ja||t instanceof os?t.toString():JSON.stringify(t)}class Fc{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(e.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Wo(e[1]))return n.error("invalid value");let l=e[1],h=Wa(l),f=n.expectedType;return h.kind!=="array"||h.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(h=f),new Fc(h,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof qi?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof Ja?this.value.serialize():this.value}}class fo{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}let Ql={string:Gi,number:Tr,boolean:$i,object:ou};class Qa{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let l,h=1,f=e[0];if(f==="array"){let v,y;if(e.length>2){let w=e[1];if(typeof w!="string"||!(w in Ql)||w==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);v=Ql[w],h++}else v=Oi;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);y=e[2],h++}l=as(v,y)}else l=Ql[f];let p=[];for(;h<e.length;h++){let v=n.parse(e[h],h,Oi);if(!v)return null;p.push(v)}return new Qa(l,p)}evaluate(e){for(let n=0;n<this.args.length;n++){let l=this.args[n].evaluate(e);if(!Sd(this.type,Wa(l)))return l;if(n===this.args.length-1)throw new fo(`Expected value to be of type ${Da(this.type)}, but found ${Da(Wa(l))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){let e=this.type,n=[e.kind];if(e.kind==="array"){let l=e.itemType;if(l.kind==="string"||l.kind==="number"||l.kind==="boolean"){n.push(l.kind);let h=e.N;(typeof h=="number"||this.args.length>1)&&n.push(h)}}return n.concat(this.args.map(l=>l.serialize()))}}class Ws{constructor(e){this.type=Ph,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let l=e[1];if(!Array.isArray(l)&&typeof l=="object")return n.error("First argument must be an image or text section.");let h=[],f=!1;for(let p=1;p<=e.length-1;++p){let v=e[p];if(f&&typeof v=="object"&&!Array.isArray(v)){f=!1;let y=null;if(v["font-scale"]&&(y=n.parse(v["font-scale"],1,Tr),!y))return null;let w=null;if(v["text-font"]&&(w=n.parse(v["text-font"],1,as(Gi)),!w))return null;let A=null;if(v["text-color"]&&(A=n.parse(v["text-color"],1,Po),!A))return null;let M=h[h.length-1];M.scale=y,M.font=w,M.textColor=A}else{let y=n.parse(e[p],1,Oi);if(!y)return null;let w=y.type.kind;if(w!=="string"&&w!=="value"&&w!=="null"&&w!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,h.push({content:y,scale:null,font:null,textColor:null})}}return new Ws(h)}evaluate(e){return new Ja(this.sections.map(n=>{let l=n.content.evaluate(e);return Wa(l)===Jl?new Rc("",l,null,null,null):new Rc(sl(l),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)}))}eachChild(e){for(let n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}outputDefined(){return!1}serialize(){let e=["format"];for(let n of this.sections){e.push(n.content.serialize());let l={};n.scale&&(l["font-scale"]=n.scale.serialize()),n.font&&(l["text-font"]=n.font.serialize()),n.textColor&&(l["text-color"]=n.textColor.serialize()),e.push(l)}return e}}class Ed{constructor(e,n){this.type=Jl,this.inputPrimary=e,this.inputSecondary=n}static parse(e,n){if(e.length<2)return n.error("Expected two or more arguments.");let l=n.parse(e[1],1,Gi);if(!l)return n.error("No image name provided.");if(e.length===2)return new Ed(l);let h=n.parse(e[2],1,Gi);return h?new Ed(l,h):n.error("Secondary image variant is not a string.")}evaluate(e){let n=os.fromString(this.inputPrimary.evaluate(e),this.inputSecondary?this.inputSecondary.evaluate(e):void 0);return n&&e.availableImages&&(n.available=e.availableImages.indexOf(n.namePrimary)>-1,n.nameSecondary&&n.available&&e.availableImages&&(n.available=e.availableImages.indexOf(n.nameSecondary)>-1)),n}eachChild(e){e(this.inputPrimary),this.inputSecondary&&e(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function su(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}let lu={"to-boolean":$i,"to-color":Po,"to-number":Tr,"to-string":Gi};class qa{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let l=e[0],h=[],f=Dc;if(l==="to-array"){if(!Array.isArray(e[1]))return null;let p=e[1].length;if(n.expectedType){if(n.expectedType.kind!=="array")return n.error(`Expected ${n.expectedType.kind} but found array.`);f=as(n.expectedType.itemType,p)}else{if(!(p>0&&Wo(e[1][0])))return null;f=as(Wa(e[1][0]),p)}for(let v=0;v<p;v++){let y=e[1][v],w;if(su(y)==="array")w=n.parse(y,void 0,f.itemType);else{let A=su(y);if(A!==f.itemType.kind)return n.error(`Expected ${f.itemType.kind} but found ${A}.`);w=n.registry.literal.parse(["literal",y===void 0?null:y],n)}if(!w)return null;h.push(w)}}else{if((l==="to-boolean"||l==="to-string")&&e.length!==2)return n.error("Expected one argument.");f=lu[l];for(let p=1;p<e.length;p++){let v=n.parse(e[p],p,Oi);if(!v)return null;h.push(v)}}return new qa(f,h)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let n,l;for(let h of this.args){if(n=h.evaluate(e),l=null,n instanceof qi)return n;if(typeof n=="string"){let f=e.parseColor(n);if(f)return f}else if(Array.isArray(n)&&(l=n.length<3||n.length>4?`Invalid rbga value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:Nm(n[0],n[1],n[2],n[3]),!l))return new qi(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new fo(l||`Could not parse color from value '${typeof n=="string"?n:String(JSON.stringify(n))}'`)}if(this.type.kind==="number"){let n=null;for(let l of this.args){if(n=l.evaluate(e),n===null)return 0;let h=Number(n);if(!isNaN(h))return h}throw new fo(`Could not convert ${JSON.stringify(n)} to number.`)}return this.type.kind==="formatted"?Ja.fromString(sl(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?os.fromString(sl(this.args[0].evaluate(e))):this.type.kind==="array"?this.args.map(n=>n.evaluate(e)):sl(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Ws([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Ed(this.args[0]).serialize();let e=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(n=>{e.push(n.serialize())}),e}}let Bm=["Unknown","Point","LineString","Polygon"];class zm{constructor(e,n){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=e,this.options=n}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Bm[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(e){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){let e=this.featureDistanceData.center,n=this.featureDistanceData.scale,{x:l,y:h}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(l*n-e[0])+this.featureDistanceData.bearing[1]*(h*n-e[1])}return 0}parseColor(e){let n=this._parseColorCache[e];return n||(n=this._parseColorCache[e]=qi.parse(e)),n}getConfig(e){return this.options?this.options.get(e):null}}class Lo{constructor(e,n,l,h,f){this.name=e,this.type=n,this._evaluate=l,this.args=h,this._overloadIndex=f}evaluate(e){if(!this._evaluate){let n=Lo.definitions[this.name];this._evaluate=Array.isArray(n)?n[2]:n.overloads[this._overloadIndex][1]}return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,n){let l=e[0],h=Lo.definitions[l];if(!h)return n.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);let f=Array.isArray(h)?h[0]:h.type,p=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,v=[],y=null,w=-1;for(let[A,M]of p){if(Array.isArray(A)&&A.length!==e.length-1)continue;v.push(A),w++,y=new Op(n.registry,n.path,null,n.scope,void 0,n._scope,n.options);let R=[],N=!1;for(let z=1;z<e.length;z++){let q=e[z],Z=Array.isArray(A)?A[z-1]:A.type,oe=y.parse(q,1+R.length,Z);if(!oe){N=!0;break}R.push(oe)}if(!N)if(Array.isArray(A)&&A.length!==R.length)y.error(`Expected ${A.length} arguments, but found ${R.length} instead.`);else{for(let z=0;z<R.length;z++){let q=Array.isArray(A)?A[z]:A.type,Z=R[z];y.concat(z+1).checkSubtype(q,Z.type)}if(y.errors.length===0)return new Lo(l,f,M,R,w)}}if(v.length===1)n.errors.push(...y.errors);else{let A=(v.length?v:p.map(([R])=>R)).map(Tf).join(" | "),M=[];for(let R=1;R<e.length;R++){let N=n.parse(e[R],1+M.length);if(!N)return null;M.push(Da(N.type))}n.error(`Expected arguments of type ${A}, but found (${M.join(", ")}) instead.`)}return null}static register(e,n){Lo.definitions=n;for(let l in n)e[l]=Lo}}function Tf(t){return Array.isArray(t)?`(${t.map(Da).join(", ")})`:`(${Da(t.type)}...)`}class Pc{constructor(e,n,l){this.type=Hs,this.locale=l,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(e.length!==2)return n.error("Expected one argument.");let l=e[1];if(typeof l!="object"||Array.isArray(l))return n.error("Collator options argument must be an object.");let h=n.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,$i);if(!h)return null;let f=n.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,$i);if(!f)return null;let p=null;return l.locale&&(p=n.parse(l.locale,1,Gi),!p)?null:new Pc(h,f,p)}evaluate(e){return new Bu(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){let e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}var Sf={exports:{}};Sf.exports=function(){function t(l,h,f,p,v){for(;p>f;){if(p-f>600){var y=p-f+1,w=h-f+1,A=Math.log(y),M=.5*Math.exp(2*A/3),R=.5*Math.sqrt(A*M*(y-M)/y)*(w-y/2<0?-1:1);t(l,h,Math.max(f,Math.floor(h-w*M/y+R)),Math.min(p,Math.floor(h+(y-w)*M/y+R)),v)}var N=l[h],z=f,q=p;for(e(l,f,h),v(l[p],N)>0&&e(l,f,p);z<q;){for(e(l,z,q),z++,q--;v(l[z],N)<0;)z++;for(;v(l[q],N)>0;)q--}v(l[f],N)===0?e(l,f,q):e(l,++q,p),q<=h&&(f=q+1),h<=q&&(p=q-1)}}function e(l,h,f){var p=l[h];l[h]=l[f],l[f]=p}function n(l,h){return l<h?-1:l>h?1:0}return function(l,h,f,p,v){t(l,h,f||0,p||l.length-1,v||n)}}();var yg=J(Sf.exports);function Ef(t){let e=0;for(let n,l,h=0,f=t.length,p=f-1;h<f;p=h++)n=t[h],l=t[p],e+=(l.x-n.x)*(n.y+l.y);return e}function cu(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function ec(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Rp(t,e,n){let l=t[0]-e[0],h=t[1]-e[1],f=t[0]-n[0],p=t[1]-n[1];return l*p-f*h==0&&l*f<=0&&h*p<=0}function zu(t,e,n=!1){let l=!1;for(let v=0,y=e.length;v<y;v++){let w=e[v];for(let A=0,M=w.length,R=M-1;A<M;R=A++){let N=w[R],z=w[A];if(Rp(t,N,z))return n;(f=N)[1]>(h=t)[1]!=(p=z)[1]>h[1]&&h[0]<(p[0]-f[0])*(h[1]-f[1])/(p[1]-f[1])+f[0]&&(l=!l)}}var h,f,p;return l}function Fp(t,e,n,l){let h=l[0]-n[0],f=l[1]-n[1],p=(t[0]-n[0])*f-h*(t[1]-n[1]),v=(e[0]-n[0])*f-h*(e[1]-n[1]);return p>0&&v<0||p<0&&v>0}function zi(t,e,n,l){return(h=[l[0]-n[0],l[1]-n[1]])[0]*(f=[e[0]-t[0],e[1]-t[1]])[1]-h[1]*f[0]!=0&&!(!Fp(t,e,n,l)||!Fp(n,l,t,e));var h,f}let Lc=8192;function jm(t,e){let n=(180+t[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,h=Math.pow(2,e.z);return[Math.round(n*h*Lc),Math.round(l*h*Lc)]}function xg(t,e){for(let n=0;n<e.length;n++)if(zu(t,e[n]))return!0;return!1}function bg(t,e,n){for(let l of n)for(let h=0,f=l.length,p=f-1;h<f;p=h++)if(zi(t,e,l[p],l[h]))return!0;return!1}function Ad(t,e){for(let n=0;n<t.length;++n)if(!zu(t[n],e))return!1;for(let n=0;n<t.length-1;++n)if(bg(t[n],t[n+1],e))return!1;return!0}function Af(t,e){for(let n=0;n<e.length;n++)if(Ad(t,e[n]))return!0;return!1}function ju(t,e,n){let l=[];for(let h=0;h<t.length;h++){let f=[];for(let p=0;p<t[h].length;p++){let v=jm(t[h][p],n);cu(e,v),f.push(v)}l.push(f)}return l}function Cd(t,e,n){let l=[];for(let h=0;h<t.length;h++){let f=ju(t[h],e,n);l.push(f)}return l}function Pp(t,e,n,l){if(t[0]<n[0]||t[0]>n[2]){let h=.5*l,f=t[0]-n[0]>h?-l:n[0]-t[0]>h?l:0;f===0&&(f=t[0]-n[2]>h?-l:n[2]-t[0]>h?l:0),t[0]+=f}cu(e,t)}function Fl(t,e,n,l){let h=Math.pow(2,l.z)*Lc,f=[l.x*Lc,l.y*Lc],p=[];if(!t)return p;for(let v of t)for(let y of v){let w=[y.x+f[0],y.y+f[1]];Pp(w,e,n,h),p.push(w)}return p}function Lp(t,e,n,l){let h=Math.pow(2,l.z)*Lc,f=[l.x*Lc,l.y*Lc],p=[];if(!t)return p;for(let y of t){let w=[];for(let A of y){let M=[A.x+f[0],A.y+f[1]];cu(e,M),w.push(M)}p.push(w)}if(e[2]-e[0]<=h/2){(v=e)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(let y of p)for(let w of y)Pp(w,e,n,h)}var v;return p}class I{constructor(e,n){this.type=$i,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Wo(e[1])){let l=e[1];if(l.type==="FeatureCollection")for(let h=0;h<l.features.length;++h){let f=l.features[h].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new I(l,l.features[h].geometry)}else if(l.type==="Feature"){let h=l.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new I(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new I(l,l)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(n,l){let h=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],p=n.canonicalID();if(!p)return!1;if(l.type==="Polygon"){let v=ju(l.coordinates,f,p),y=Fl(n.geometry(),h,f,p);if(!ec(h,f))return!1;for(let w of y)if(!zu(w,v))return!1}if(l.type==="MultiPolygon"){let v=Cd(l.coordinates,f,p),y=Fl(n.geometry(),h,f,p);if(!ec(h,f))return!1;for(let w of y)if(!xg(w,v))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(n,l){let h=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],p=n.canonicalID();if(!p)return!1;if(l.type==="Polygon"){let v=ju(l.coordinates,f,p),y=Lp(n.geometry(),h,f,p);if(!ec(h,f))return!1;for(let w of y)if(!Ad(w,v))return!1}if(l.type==="MultiPolygon"){let v=Cd(l.coordinates,f,p),y=Lp(n.geometry(),h,f,p);if(!ec(h,f))return!1;for(let w of y)if(!Af(w,v))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}let L={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Y=1/298.257223563,ce=Y*(2-Y),Se=Math.PI/180;class Le{static fromTile(e,n,l){let h=Math.PI*(1-2*(e+.5)/Math.pow(2,n)),f=Math.atan(.5*(Math.exp(h)-Math.exp(-h)))/Se;return new Le(f,l)}static get units(){return L}constructor(e,n){if(e===void 0)throw new Error("No latitude given.");if(n&&!L[n])throw new Error(`Unknown unit ${n}. Use one of: ${Object.keys(L).join(", ")}`);let l=6378.137*Se*(n?L[n]:1),h=Math.cos(e*Se),f=1/(1-ce*(1-h*h)),p=Math.sqrt(f);this.kx=l*p*h,this.ky=l*p*f*(1-ce)}distance(e,n){let l=Xe(e[0]-n[0])*this.kx,h=(e[1]-n[1])*this.ky;return Math.sqrt(l*l+h*h)}bearing(e,n){let l=Xe(n[0]-e[0])*this.kx;return Math.atan2(l,(n[1]-e[1])*this.ky)/Se}destination(e,n,l){let h=l*Se;return this.offset(e,Math.sin(h)*n,Math.cos(h)*n)}offset(e,n,l){return[e[0]+n/this.kx,e[1]+l/this.ky]}lineDistance(e){let n=0;for(let l=0;l<e.length-1;l++)n+=this.distance(e[l],e[l+1]);return n}area(e){let n=0;for(let l=0;l<e.length;l++){let h=e[l];for(let f=0,p=h.length,v=p-1;f<p;v=f++)n+=Xe(h[f][0]-h[v][0])*(h[f][1]+h[v][1])*(l?-1:1)}return Math.abs(n)/2*this.kx*this.ky}along(e,n){let l=0;if(n<=0)return e[0];for(let h=0;h<e.length-1;h++){let f=e[h],p=e[h+1],v=this.distance(f,p);if(l+=v,l>n)return Ge(f,p,(n-(l-v))/v)}return e[e.length-1]}pointToSegmentDistance(e,n,l){let[h,f]=n,p=Xe(l[0]-h)*this.kx,v=(l[1]-f)*this.ky;if(p!==0||v!==0){let y=(Xe(e[0]-h)*this.kx*p+(e[1]-f)*this.ky*v)/(p*p+v*v);y>1?(h=l[0],f=l[1]):y>0&&(h+=p/this.kx*y,f+=v/this.ky*y)}return p=Xe(e[0]-h)*this.kx,v=(e[1]-f)*this.ky,Math.sqrt(p*p+v*v)}pointOnLine(e,n){let l=1/0,h=e[0][0],f=e[0][1],p=0,v=0;for(let y=0;y<e.length-1;y++){let w=e[y][0],A=e[y][1],M=Xe(e[y+1][0]-w)*this.kx,R=(e[y+1][1]-A)*this.ky,N=0;M===0&&R===0||(N=(Xe(n[0]-w)*this.kx*M+(n[1]-A)*this.ky*R)/(M*M+R*R),N>1?(w=e[y+1][0],A=e[y+1][1]):N>0&&(w+=M/this.kx*N,A+=R/this.ky*N)),M=Xe(n[0]-w)*this.kx,R=(n[1]-A)*this.ky;let z=M*M+R*R;z<l&&(l=z,h=w,f=A,p=y,v=N)}return{point:[h,f],index:p,t:Math.max(0,Math.min(1,v))}}lineSlice(e,n,l){let h=this.pointOnLine(l,e),f=this.pointOnLine(l,n);if(h.index>f.index||h.index===f.index&&h.t>f.t){let w=h;h=f,f=w}let p=[h.point],v=h.index+1,y=f.index;!ze(l[v],p[0])&&v<=y&&p.push(l[v]);for(let w=v+1;w<=y;w++)p.push(l[w]);return ze(l[y],f.point)||p.push(f.point),p}lineSliceAlong(e,n,l){let h=0,f=[];for(let p=0;p<l.length-1;p++){let v=l[p],y=l[p+1],w=this.distance(v,y);if(h+=w,h>e&&f.length===0&&f.push(Ge(v,y,(e-(h-w))/w)),h>=n)return f.push(Ge(v,y,(n-(h-w))/w)),f;h>e&&f.push(y)}return f}bufferPoint(e,n){let l=n/this.ky,h=n/this.kx;return[e[0]-h,e[1]-l,e[0]+h,e[1]+l]}bufferBBox(e,n){let l=n/this.ky,h=n/this.kx;return[e[0]-h,e[1]-l,e[2]+h,e[3]+l]}insideBBox(e,n){return Xe(e[0]-n[0])>=0&&Xe(e[0]-n[2])<=0&&e[1]>=n[1]&&e[1]<=n[3]}}function ze(t,e){return t[0]===e[0]&&t[1]===e[1]}function Ge(t,e,n){let l=Xe(e[0]-t[0]);return[t[0]+l*n,t[1]+(e[1]-t[1])*n]}function Xe(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}var tt={exports:{}};(function(t,e){t.exports=function(){var n=function(h,f){if(h===void 0&&(h=[]),f===void 0&&(f=l),this.data=h,this.length=this.data.length,this.compare=f,this.length>0)for(var p=(this.length>>1)-1;p>=0;p--)this._down(p)};function l(h,f){return h<f?-1:h>f?1:0}return n.prototype.push=function(h){this.data.push(h),this.length++,this._up(this.length-1)},n.prototype.pop=function(){if(this.length!==0){var h=this.data[0],f=this.data.pop();return this.length--,this.length>0&&(this.data[0]=f,this._down(0)),h}},n.prototype.peek=function(){return this.data[0]},n.prototype._up=function(h){for(var f=this.data,p=this.compare,v=f[h];h>0;){var y=h-1>>1,w=f[y];if(p(v,w)>=0)break;f[h]=w,h=y}f[h]=v},n.prototype._down=function(h){for(var f=this.data,p=this.compare,v=this.length>>1,y=f[h];h<v;){var w=1+(h<<1),A=f[w],M=w+1;if(M<this.length&&p(f[M],A)<0&&(w=M,A=f[M]),p(A,y)>=0)break;f[h]=A,h=w}f[h]=y},n}()})(tt);var St=J(tt.exports),it=8192;function Ut(t,e){return e.dist-t.dist}let Rt=100,vr=50;function rr(t){let e=[1/0,1/0,-1/0,-1/0];if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Et(t){return t[1]-t[0]+1}function It(t,e){let n=t[1]>=t[0]&&t[1]<e;return n||console.warn("Distance Expression: Index is out of range"),n}function ur(t,e){if(t[0]>t[1])return[null,null];let n=Et(t);if(e){if(n===2)return[t,null];let l=Math.floor(n/2);return[[t[0],t[0]+l],[t[0]+l,t[1]]]}{if(n===1)return[t,null];let l=Math.floor(n/2)-1;return[[t[0],t[0]+l],[t[0]+l+1,t[1]]]}}function yr(t,e){let n=[1/0,1/0,-1/0,-1/0];if(!It(e,t.length))return n;for(let l=e[0];l<=e[1];++l)cu(n,t[l]);return n}function gr(t){let e=[1/0,1/0,-1/0,-1/0];for(let n=0;n<t.length;++n)for(let l=0;l<t[n].length;++l)cu(e,t[n][l]);return e}function $r(t,e,n){if(rr(t)||rr(e))return NaN;let l=0,h=0;return t[2]<e[0]&&(l=e[0]-t[2]),t[0]>e[2]&&(l=t[0]-e[2]),t[1]>e[3]&&(h=t[1]-e[3]),t[3]<e[1]&&(h=e[1]-t[3]),n.distance([0,0],[l,h])}function Hr(t){return 360*t-180}function Ci(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Wr(t,e){let n=Math.pow(2,e.z),l=(t.y/it+e.y)/n;return[Hr((t.x/it+e.x)/n),Ci(l)]}function Fn(t,e){let n=[];for(let l=0;l<t.length;++l)n.push(Wr(t[l],e));return n}function Nn(t,e,n){let l=n.pointOnLine(e,t).point;return n.distance(t,l)}function on(t,e,n,l,h){let f=n.slice(l[0],l[1]+1),p=1/0;for(let v=e[0];v<=e[1];++v)if((p=Math.min(p,Nn(t[v],f,h)))===0)return 0;return p}function dn(t,e,n,l,h){let f=Math.min(h.pointToSegmentDistance(t,n,l),h.pointToSegmentDistance(e,n,l)),p=Math.min(h.pointToSegmentDistance(n,t,e),h.pointToSegmentDistance(l,t,e));return Math.min(f,p)}function ea(t,e,n,l,h){if(!It(e,t.length)||!It(l,n.length))return NaN;let f=1/0;for(let p=e[0];p<e[1];++p)for(let v=l[0];v<l[1];++v){if(zi(t[p],t[p+1],n[v],n[v+1]))return 0;f=Math.min(f,dn(t[p],t[p+1],n[v],n[v+1],h))}return f}function qn(t,e,n,l,h){if(!It(e,t.length)||!It(l,n.length))return NaN;let f=1/0;for(let p=e[0];p<=e[1];++p)for(let v=l[0];v<=l[1];++v)if((f=Math.min(f,h.distance(t[p],n[v])))===0)return f;return f}function Ki(t,e,n){if(zu(t,e,!0))return 0;let l=1/0;for(let h of e){let f=h.length;if(f<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(h[0]!==h[f-1]&&(l=Math.min(l,n.pointToSegmentDistance(t,h[f-1],h[0])))===0||(l=Math.min(l,Nn(t,h,n)))===0)return l}return l}function Bn(t,e,n,l){if(!It(e,t.length))return NaN;for(let f=e[0];f<=e[1];++f)if(zu(t[f],n,!0))return 0;let h=1/0;for(let f=e[0];f<e[1];++f)for(let p of n)for(let v=0,y=p.length,w=y-1;v<y;w=v++){if(zi(t[f],t[f+1],p[w],p[v]))return 0;h=Math.min(h,dn(t[f],t[f+1],p[w],p[v],l))}return h}function qo(t,e){for(let n of t)for(let l=0;l<=n.length-1;++l)if(zu(n[l],e,!0))return!0;return!1}function po(t,e,n,l=1/0){let h=gr(t),f=gr(e);if(l!==1/0&&$r(h,f,n)>=l)return l;if(ec(h,f)){if(qo(t,e))return 0}else if(qo(e,t))return 0;let p=l;for(let v of t)for(let y=0,w=v.length,A=w-1;y<w;A=y++)for(let M of e)for(let R=0,N=M.length,z=N-1;R<N;z=R++){if(zi(v[A],v[y],M[z],M[R]))return 0;p=Math.min(p,dn(v[A],v[y],M[z],M[R],n))}return p}function ko(t,e,n,l,h,f,p){if(f===null||p===null)return;let v=$r(yr(l,f),yr(h,p),n);v<e&&t.push({dist:v,range1:f,range2:p})}function In(t,e,n,l,h=1/0){let f=Math.min(l.distance(t[0],n[0][0]),h);if(f===0)return f;let p=new St([{dist:0,range1:[0,t.length-1],range2:[0,0]}],Ut),v=e?vr:Rt,y=gr(n);for(;p.length;){let w=p.pop();if(w.dist>=f)continue;let A=w.range1;if(Et(A)<=v){if(!It(A,t.length))return NaN;if(e){let M=Bn(t,A,n,l);if((f=Math.min(f,M))===0)return f}else for(let M=A[0];M<=A[1];++M){let R=Ki(t[M],n,l);if((f=Math.min(f,R))===0)return f}}else{let M=ur(A,e);if(M[0]!==null){let R=$r(yr(t,M[0]),y,l);R<f&&p.push({dist:R,range1:M[0],range2:[0,0]})}if(M[1]!==null){let R=$r(yr(t,M[1]),y,l);R<f&&p.push({dist:R,range1:M[1],range2:[0,0]})}}}return f}function Ts(t,e,n,l,h,f=1/0){let p=Math.min(f,h.distance(t[0],n[0]));if(p===0)return p;let v=new St([{dist:0,range1:[0,t.length-1],range2:[0,n.length-1]}],Ut),y=e?vr:Rt,w=l?vr:Rt;for(;v.length;){let A=v.pop();if(A.dist>=p)continue;let M=A.range1,R=A.range2;if(Et(M)<=y&&Et(R)<=w){if(!It(M,t.length)||!It(R,n.length))return NaN;if(e&&l?p=Math.min(p,ea(t,M,n,R,h)):e||l?e&&!l?p=Math.min(p,on(n,R,t,M,h)):!e&&l&&(p=Math.min(p,on(t,M,n,R,h))):p=Math.min(p,qn(t,M,n,R,h)),p===0)return p}else{let N=ur(M,e),z=ur(R,l);ko(v,p,h,t,n,N[0],z[0]),ko(v,p,h,t,n,N[0],z[1]),ko(v,p,h,t,n,N[1],z[0]),ko(v,p,h,t,n,N[1],z[1])}}return p}function ss(t,e,n,l,h=1/0){let f=h,p=yr(t,[0,t.length-1]);for(let v of n)if(!(f!==1/0&&$r(p,yr(v,[0,v.length-1]),l)>=f)&&(f=Math.min(f,Ts(t,e,v,!0,l,f)),f===0))return f;return f}function eo(t,e,n,l,h=1/0){let f=h,p=yr(t,[0,t.length-1]);for(let v of n){if(f!==1/0&&$r(p,gr(v),l)>=f)continue;let y=In(t,e,v,l,f);if(isNaN(y))return y;if((f=Math.min(f,y))===0)return f}return f}function xo(t){return t==="Point"||t==="MultiPoint"||t==="LineString"||t==="MultiLineString"||t==="Polygon"||t==="MultiPolygon"}class to{constructor(e,n){this.type=Tr,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'distance' expression requires either one argument, but found ' ${e.length-1} instead.`);if(Wo(e[1])){let l=e[1];if(l.type==="FeatureCollection"){for(let h=0;h<l.features.length;++h)if(xo(l.features[h].geometry.type))return new to(l,l.features[h].geometry)}else if(l.type==="Feature"){if(xo(l.geometry.type))return new to(l,l.geometry)}else if(xo(l.type))return new to(l,l)}return n.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(e){let n=e.geometry(),l=e.canonicalID();if(n!=null&&l!=null){if(e.geometryType()==="Point")return function(h,f,p){let v=[];for(let w of h)for(let A of w)v.push(Wr(A,f));let y=new Le(v[0][1],"meters");return p.type==="Point"||p.type==="MultiPoint"||p.type==="LineString"?Ts(v,!1,p.type==="Point"?[p.coordinates]:p.coordinates,p.type==="LineString",y):p.type==="MultiLineString"?ss(v,!1,p.coordinates,y):p.type==="Polygon"||p.type==="MultiPolygon"?eo(v,!1,p.type==="Polygon"?[p.coordinates]:p.coordinates,y):null}(n,l,this.geometries);if(e.geometryType()==="LineString")return function(h,f,p){let v=[];for(let w of h){let A=[];for(let M of w)A.push(Wr(M,f));v.push(A)}let y=new Le(v[0][0][1],"meters");if(p.type==="Point"||p.type==="MultiPoint"||p.type==="LineString")return ss(p.type==="Point"?[p.coordinates]:p.coordinates,p.type==="LineString",v,y);if(p.type==="MultiLineString"){let w=1/0;for(let A=0;A<p.coordinates.length;A++){let M=ss(p.coordinates[A],!0,v,y,w);if(isNaN(M))return M;if((w=Math.min(w,M))===0)return w}return w}if(p.type==="Polygon"||p.type==="MultiPolygon"){let w=1/0;for(let A=0;A<v.length;A++){let M=eo(v[A],!0,p.type==="Polygon"?[p.coordinates]:p.coordinates,y,w);if(isNaN(M))return M;if((w=Math.min(w,M))===0)return w}return w}return null}(n,l,this.geometries);if(e.geometryType()==="Polygon")return function(h,f,p){let v=[];for(let w of function(A,M){let R=A.length;if(R<=1)return[A];let N=[],z,q;for(let Z=0;Z<R;Z++){let oe=Ef(A[Z]);oe!==0&&(A[Z].area=Math.abs(oe),q===void 0&&(q=oe<0),q===oe<0?(z&&N.push(z),z=[A[Z]]):z.push(A[Z]))}return z&&N.push(z),N}(h)){let A=[];for(let M=0;M<w.length;++M)A.push(Fn(w[M],f));v.push(A)}let y=new Le(v[0][0][0][1],"meters");if(p.type==="Point"||p.type==="MultiPoint"||p.type==="LineString")return eo(p.type==="Point"?[p.coordinates]:p.coordinates,p.type==="LineString",v,y);if(p.type==="MultiLineString"){let w=1/0;for(let A=0;A<p.coordinates.length;A++){let M=eo(p.coordinates[A],!0,v,y,w);if(isNaN(M))return M;if((w=Math.min(w,M))===0)return w}return w}return p.type==="Polygon"||p.type==="MultiPolygon"?function(w,A,M){let R=1/0;for(let N of w)for(let z of A){let q=po(N,z,M,R);if(isNaN(q))return q;if((R=Math.min(R,q))===0)return R}return R}(p.type==="Polygon"?[p.coordinates]:p.coordinates,v,y):null}(n,l,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Oo(t,e){switch(t){case"string":return sl(e);case"number":return+e;case"boolean":return!!e;case"color":return qi.parse(e);case"formatted":return Ja.fromString(sl(e));case"resolvedImage":return os.fromString(sl(e))}return e}function Ss(t,e,n,l){return l!==void 0&&(t=l*Math.round(t/l)),e!==void 0&&t<e&&(t=e),n!==void 0&&t>n&&(t=n),t}class xn{constructor(e,n,l){this.type=e,this.key=n,this.scope=l}static parse(e,n){let l=n.expectedType;if(l==null&&(l=Oi),e.length<2||e.length>3)return n.error("Invalid number of arguments for 'config' expression.");let h=n.parse(e[1],1);if(!(h instanceof Fc))return n.error("Key name of 'config' expression must be a string literal.");if(e.length>=3){let f=n.parse(e[2],2);return f instanceof Fc?new xn(l,sl(h.value),sl(f.value)):n.error("Scope of 'config' expression must be a string literal.")}return new xn(l,sl(h.value))}evaluate(e){let n=[this.key,this.scope,e.scope].filter(Boolean).join(""),l=e.getConfig(n);if(!l)return null;let{type:h,value:f,values:p,minValue:v,maxValue:y,stepValue:w}=l,A=l.default.evaluate(e),M=A;if(f){let R=e.scope;e.scope=(R||"").split("").slice(1).join(""),M=f.evaluate(e),e.scope=R}return h&&(M=Oo(h,M)),M===void 0||v===void 0&&y===void 0&&w===void 0||(typeof M=="number"?M=Ss(M,v,y,w):Array.isArray(M)&&(M=M.map(R=>typeof R=="number"?Ss(R,v,y,w):R))),f!==void 0&&M!==void 0&&p&&!p.includes(M)&&(M=A,h&&(M=Oo(h,M))),(h&&h!==this.type||M!==void 0&&Wa(M)!==this.type)&&(M=Oo(this.type.kind,M)),M}eachChild(){}outputDefined(){return!1}serialize(){let e=["config",this.key];return this.scope&&e.concat(this.key),e}}function $o(t){if(t instanceof Lo&&(t.name==="get"&&t.args.length===1||t.name==="feature-state"||t.name==="has"&&t.args.length===1||t.name==="properties"||t.name==="geometry-type"||t.name==="id"||/^filter-/.test(t.name))||t instanceof I||t instanceof to)return!1;let e=!0;return t.eachChild(n=>{e&&!$o(n)&&(e=!1)}),e}function tc(t){if(t instanceof Lo&&t.name==="feature-state")return!1;let e=!0;return t.eachChild(n=>{e&&!tc(n)&&(e=!1)}),e}function uu(t){if(t instanceof xn)return!1;let e=!0;return t.eachChild(n=>{e&&!uu(n)&&(e=!1)}),e}function ll(t,e){if(t instanceof Lo&&e.indexOf(t.name)>=0)return!1;let n=!0;return t.eachChild(l=>{n&&!ll(l,e)&&(n=!1)}),n}class ya{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");let l=e[1];return n.scope.has(l)?new ya(l,n.scope.get(l)):n.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Uu{constructor(e,n=[],l,h=new wf,f=[],p,v){this.registry=e,this.path=n,this.key=n.map(y=>`[${y}]`).join(""),this.scope=h,this.errors=f,this.expectedType=l,this._scope=p,this.options=v}parse(e,n,l,h,f={}){return n||l?this.concat(n,l,h)._parse(e,f):this._parse(e,f)}_parse(e,n){function l(h,f,p){return p==="assert"?new Qa(f,[h]):p==="coerce"?new qa(f,[h]):h}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let h=typeof e[0]=="string"?this.registry[e[0]]:void 0;if(h){let f=h.parse(e,this);if(!f)return null;if(this.expectedType){let p=this.expectedType,v=f.type;if(p.kind!=="string"&&p.kind!=="number"&&p.kind!=="boolean"&&p.kind!=="object"&&p.kind!=="array"||v.kind!=="value")if(p.kind!=="color"&&p.kind!=="formatted"&&p.kind!=="resolvedImage"||v.kind!=="value"&&v.kind!=="string"){if(this.checkSubtype(p,v))return null}else f=l(f,p,n.typeAnnotation||"coerce");else f=l(f,p,n.typeAnnotation||"assert")}if(!(f instanceof Fc)&&f.type.kind!=="resolvedImage"&&Oh(f)){let p=new zm(this._scope,this.options);try{f=new Fc(f.type,f.evaluate(p))}catch(v){return this.error(v.message),null}}return f}return qa.parse(["to-array",e],this)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,n,l){let h=typeof e=="number"?this.path.concat(e):this.path,f=l?this.scope.concat(l):this.scope;return new Uu(this.registry,h,n||null,f,this.errors,this._scope,this.options)}error(e,...n){let l=`${this.key}${n.map(h=>`[${h}]`).join("")}`;this.errors.push(new Gs(l,e))}checkSubtype(e,n){let l=Sd(e,n);return l&&this.error(l),l}}var Op=Uu;function Oh(t){if(t instanceof ya)return Oh(t.boundExpression);if(t instanceof Lo&&t.name==="error"||t instanceof Pc||t instanceof I||t instanceof to||t instanceof xn)return!1;let e=t instanceof qa||t instanceof Qa,n=!0;return t.eachChild(l=>{n=e?n&&Oh(l):n&&l instanceof Fc}),!!n&&$o(t)&&ll(t,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Vu(t,e){let n=t.length-1,l,h,f=0,p=n,v=0;for(;f<=p;)if(v=Math.floor((f+p)/2),l=t[v],h=t[v+1],l<=e){if(v===n||e<h)return v;f=v+1}else{if(!(l>e))throw new fo("Input is not a number.");p=v-1}return 0}class Oc{constructor(e,n,l){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(let[h,f]of l)this.labels.push(h),this.outputs.push(f)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");let l=n.parse(e[1],1,Tr);if(!l)return null;let h=[],f=null;n.expectedType&&n.expectedType.kind!=="value"&&(f=n.expectedType);for(let p=1;p<e.length;p+=2){let v=p===1?-1/0:e[p],y=e[p+1],w=p,A=p+1;if(typeof v!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',w);if(h.length&&h[h.length-1][0]>=v)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',w);let M=n.parse(y,A,f);if(!M)return null;f=f||M.type,h.push([v,M])}return new Oc(f,l,h)}evaluate(e){let n=this.labels,l=this.outputs;if(n.length===1)return l[0].evaluate(e);let h=this.input.evaluate(e);if(h<=n[0])return l[0].evaluate(e);let f=n.length;return h>=n[f-1]?l[f-1].evaluate(e):l[Vu(n,h)].evaluate(e)}eachChild(e){e(this.input);for(let n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e=["step",this.input.serialize()];for(let n=0;n<this.labels.length;n++)n>0&&e.push(this.labels[n]),e.push(this.outputs[n].serialize());return e}}let Gu=.95047,cl=1.08883,hu=4/29,ul=6/29,Np=3*ul*ul,Nh=ul*ul*ul,Id=Math.PI/180,kd=180/Math.PI;function Md(t){return t>Nh?Math.pow(t,1/3):t/Np+hu}function Hu(t){return t>ul?t*t*t:Np*(t-hu)}function Wu(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Dd(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Um(t){let e=Dd(t.r),n=Dd(t.g),l=Dd(t.b),h=Md((.4124564*e+.3575761*n+.1804375*l)/Gu),f=Md((.2126729*e+.7151522*n+.072175*l)/1);return{l:116*f-16,a:500*(h-f),b:200*(f-Md((.0193339*e+.119192*n+.9503041*l)/cl)),alpha:t.a}}function Cf(t){let e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,l=isNaN(t.b)?e:e-t.b/200;return e=1*Hu(e),n=Gu*Hu(n),l=cl*Hu(l),new qi(Wu(3.2404542*n-1.5371385*e-.4985314*l),Wu(-.969266*n+1.8760108*e+.041556*l),Wu(.0556434*n-.2040259*e+1.0572252*l),t.alpha)}function du(t,e,n){let l=e-t;return t+n*(l>180||l<-180?l-360*Math.round(l/360):l)}let Rd={forward:Um,reverse:Cf,interpolate:function(t,e,n){return{l:Xr(t.l,e.l,n),a:Xr(t.a,e.a,n),b:Xr(t.b,e.b,n),alpha:Xr(t.alpha,e.alpha,n)}}},Bh={forward:function(t){let{l:e,a:n,b:l}=Um(t),h=Math.atan2(l,n)*kd;return{h:h<0?h+360:h,c:Math.sqrt(n*n+l*l),l:e,alpha:t.a}},reverse:function(t){let e=t.h*Id,n=t.c;return Cf({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:du(t.h,e.h,n),c:Xr(t.c,e.c,n),l:Xr(t.l,e.l,n),alpha:Xr(t.alpha,e.alpha,n)}}};var Vm=Object.freeze({__proto__:null,hcl:Bh,lab:Rd});class Es{constructor(e,n,l,h,f){this.type=e,this.operator=n,this.interpolation=l,this.input=h,this.labels=[],this.outputs=[];for(let[p,v]of f)this.labels.push(p),this.outputs.push(v)}static interpolationFactor(e,n,l,h){let f=0;if(e.name==="exponential")f=zh(n,e.base,l,h);else if(e.name==="linear")f=zh(n,1,l,h);else if(e.name==="cubic-bezier"){let p=e.controlPoints;f=new Hl(p[0],p[1],p[2],p[3]).solve(zh(n,1,l,h))}return f}static parse(e,n){let[l,h,f,...p]=e;if(!Array.isArray(h)||h.length===0)return n.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){let w=h[1];if(typeof w!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:w}}else{if(h[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(h[0])}`,1,0);{let w=h.slice(1);if(w.length!==4||w.some(A=>typeof A!="number"||A<0||A>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:w}}}if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(f=n.parse(f,2,Tr),!f)return null;let v=[],y=null;l==="interpolate-hcl"||l==="interpolate-lab"?y=Po:n.expectedType&&n.expectedType.kind!=="value"&&(y=n.expectedType);for(let w=0;w<p.length;w+=2){let A=p[w],M=p[w+1],R=w+3,N=w+4;if(typeof A!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(v.length&&v[v.length-1][0]>=A)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',R);let z=n.parse(M,N,y);if(!z)return null;y=y||z.type,v.push([A,z])}return y.kind==="number"||y.kind==="color"||y.kind==="array"&&y.itemType.kind==="number"&&typeof y.N=="number"?new Es(y,l,h,f,v):n.error(`Type ${Da(y)} is not interpolatable.`)}evaluate(e){let n=this.labels,l=this.outputs;if(n.length===1)return l[0].evaluate(e);let h=this.input.evaluate(e);if(h<=n[0])return l[0].evaluate(e);let f=n.length;if(h>=n[f-1])return l[f-1].evaluate(e);let p=Vu(n,h),v=Es.interpolationFactor(this.interpolation,h,n[p],n[p+1]),y=l[p].evaluate(e),w=l[p+1].evaluate(e);return this.operator==="interpolate"?ns[this.type.kind.toLowerCase()](y,w,v):this.operator==="interpolate-hcl"?Bh.reverse(Bh.interpolate(Bh.forward(y),Bh.forward(w),v)):Rd.reverse(Rd.interpolate(Rd.forward(y),Rd.forward(w),v))}eachChild(e){e(this.input);for(let n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);let n=[this.operator,e,this.input.serialize()];for(let l=0;l<this.labels.length;l++)n.push(this.labels[l],this.outputs[l].serialize());return n}}function zh(t,e,n,l){let h=l-n,f=t-n;return h===0?0:e===1?f/h:(Math.pow(e,f)-1)/(Math.pow(e,h)-1)}class Fd{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expectected at least one argument.");let l=null,h=n.expectedType;h&&h.kind!=="value"&&(l=h);let f=[];for(let v of e.slice(1)){let y=n.parse(v,1+f.length,l,void 0,{typeAnnotation:"omit"});if(!y)return null;l=l||y.type,f.push(y)}let p=h&&f.some(v=>Sd(h,v.type));return new Fd(p?Oi:l,f)}evaluate(e){let n,l=null,h=0;for(let f of this.args){if(h++,l=f.evaluate(e),l&&l instanceof os&&!l.available&&(n||(n=l),l=null,h===this.args.length))return n;if(l!==null)break}return l}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){let e=["coalesce"];return this.eachChild(n=>{e.push(n.serialize())}),e}}class Pd{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(let n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);let l=[];for(let f=1;f<e.length-1;f+=2){let p=e[f];if(typeof p!="string")return n.error(`Expected string, but found ${typeof p} instead.`,f);if(/[^a-zA-Z0-9_]/.test(p))return n.error("Variable names must contain only alphanumeric characters or '_'.",f);let v=n.parse(e[f+1],f+1);if(!v)return null;l.push([p,v])}let h=n.parse(e[e.length-1],e.length-1,n.expectedType,l);return h?new Pd(l,h):null}outputDefined(){return this.result.outputDefined()}serialize(){let e=["let"];for(let[n,l]of this.bindings)e.push(n,l.serialize());return e.push(this.result.serialize()),e}}class jh{constructor(e,n,l){this.type=e,this.index=n,this.input=l}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);let l=n.parse(e[1],1,Tr),h=n.parse(e[2],2,as(n.expectedType||Oi));return l&&h?new jh(h.type.itemType,l,h):null}evaluate(e){let n=this.index.evaluate(e),l=this.input.evaluate(e);if(n<0)throw new fo(`Array index out of bounds: ${n} < 0.`);if(n>=l.length)throw new fo(`Array index out of bounds: ${n} > ${l.length-1}.`);if(n!==Math.floor(n))throw new fo(`Array index must be an integer, but found ${n} instead.`);return l[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Ld{constructor(e,n){this.type=$i,this.needle=e,this.haystack=n}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);let l=n.parse(e[1],1,Oi),h=n.parse(e[2],2,Oi);return l&&h?Dp(l.type,[$i,Gi,Tr,Dc,Oi])?new Ld(l,h):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Da(l.type)} instead`):null}evaluate(e){let n=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(l==null)return!1;if(!Lh(n,["boolean","string","number","null"]))throw new fo(`Expected first argument to be of type boolean, string, number or null, but found ${Da(Wa(n))} instead.`);if(!Lh(l,["string","array"]))throw new fo(`Expected second argument to be of type array or string, but found ${Da(Wa(l))} instead.`);return l.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class fu{constructor(e,n,l){this.type=Tr,this.needle=e,this.haystack=n,this.fromIndex=l}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);let l=n.parse(e[1],1,Oi),h=n.parse(e[2],2,Oi);if(!l||!h)return null;if(!Dp(l.type,[$i,Gi,Tr,Dc,Oi]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Da(l.type)} instead`);if(e.length===4){let f=n.parse(e[3],3,Tr);return f?new fu(l,h,f):null}return new fu(l,h)}evaluate(e){let n=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(!Lh(n,["boolean","string","number","null"]))throw new fo(`Expected first argument to be of type boolean, string, number or null, but found ${Da(Wa(n))} instead.`);if(!Lh(l,["string","array"]))throw new fo(`Expected second argument to be of type array or string, but found ${Da(Wa(l))} instead.`);if(this.fromIndex){let h=this.fromIndex.evaluate(e);return l.indexOf(n,h)}return l.indexOf(n)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){let e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class qu{constructor(e,n,l,h,f,p){this.inputType=e,this.type=n,this.input=l,this.cases=h,this.outputs=f,this.otherwise=p}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return n.error("Expected an even number of arguments.");let l,h;n.expectedType&&n.expectedType.kind!=="value"&&(h=n.expectedType);let f={},p=[];for(let w=2;w<e.length-1;w+=2){let A=e[w],M=e[w+1];Array.isArray(A)||(A=[A]);let R=n.concat(w);if(A.length===0)return R.error("Expected at least one branch label.");for(let z of A){if(typeof z!="number"&&typeof z!="string")return R.error("Branch labels must be numbers or strings.");if(typeof z=="number"&&Math.abs(z)>Number.MAX_SAFE_INTEGER)return R.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof z=="number"&&Math.floor(z)!==z)return R.error("Numeric branch labels must be integer values.");if(l){if(R.checkSubtype(l,Wa(z)))return null}else l=Wa(z);if(f[String(z)]!==void 0)return R.error("Branch labels must be unique.");f[String(z)]=p.length}let N=n.parse(M,w,h);if(!N)return null;h=h||N.type,p.push(N)}let v=n.parse(e[1],1,Oi);if(!v)return null;let y=n.parse(e[e.length-1],e.length-1,h);return y?v.type.kind!=="value"&&n.concat(1).checkSubtype(l,v.type)?null:new qu(l,h,v,f,p,y):null}evaluate(e){let n=this.input.evaluate(e);return(Wa(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){let e=["match",this.input.serialize()],n=Object.keys(this.cases).sort(),l=[],h={};for(let p of n){let v=h[this.cases[p]];v===void 0?(h[this.cases[p]]=l.length,l.push([this.cases[p],[p]])):l[v][1].push(p)}let f=p=>this.inputType.kind==="number"?Number(p):p;for(let[p,v]of l)e.push(v.length===1?f(v[0]):v.map(f)),e.push(this.outputs[p].serialize());return e.push(this.otherwise.serialize()),e}}class Bp{constructor(e,n,l){this.type=e,this.branches=n,this.otherwise=l}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return n.error("Expected an odd number of arguments.");let l;n.expectedType&&n.expectedType.kind!=="value"&&(l=n.expectedType);let h=[];for(let p=1;p<e.length-1;p+=2){let v=n.parse(e[p],p,$i);if(!v)return null;let y=n.parse(e[p+1],p+1,l);if(!y)return null;h.push([v,y]),l=l||y.type}let f=n.parse(e[e.length-1],e.length-1,l);return f?new Bp(l,h,f):null}evaluate(e){for(let[n,l]of this.branches)if(n.evaluate(e))return l.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(let[n,l]of this.branches)e(n),e(l);e(this.otherwise)}outputDefined(){return this.branches.every(([e,n])=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){let e=["case"];return this.eachChild(n=>{e.push(n.serialize())}),e}}class $u{constructor(e,n,l,h){this.type=e,this.input=n,this.beginIndex=l,this.endIndex=h}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);let l=n.parse(e[1],1,Oi),h=n.parse(e[2],2,Tr);if(!l||!h)return null;if(!Dp(l.type,[as(Oi),Gi,Oi]))return n.error(`Expected first argument to be of type array or string, but found ${Da(l.type)} instead`);if(e.length===4){let f=n.parse(e[3],3,Tr);return f?new $u(l.type,l,h,f):null}return new $u(l.type,l,h)}evaluate(e){let n=this.input.evaluate(e),l=this.beginIndex.evaluate(e);if(!Lh(n,["string","array"]))throw new fo(`Expected first argument to be of type array or string, but found ${Da(Wa(n))} instead.`);if(this.endIndex){let h=this.endIndex.evaluate(e);return n.slice(l,h)}return n.slice(l)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){let e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Uh(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function If(t,e,n,l){return l.compare(e,n)===0}function As(t,e,n){let l=t!=="=="&&t!=="!=";return class b4{constructor(f,p,v){this.type=$i,this.lhs=f,this.rhs=p,this.collator=v,this.hasUntypedArgument=f.type.kind==="value"||p.type.kind==="value"}static parse(f,p){if(f.length!==3&&f.length!==4)return p.error("Expected two or three arguments.");let v=f[0],y=p.parse(f[1],1,Oi);if(!y)return null;if(!Uh(v,y.type))return p.concat(1).error(`"${v}" comparisons are not supported for type '${Da(y.type)}'.`);let w=p.parse(f[2],2,Oi);if(!w)return null;if(!Uh(v,w.type))return p.concat(2).error(`"${v}" comparisons are not supported for type '${Da(w.type)}'.`);if(y.type.kind!==w.type.kind&&y.type.kind!=="value"&&w.type.kind!=="value")return p.error(`Cannot compare types '${Da(y.type)}' and '${Da(w.type)}'.`);l&&(y.type.kind==="value"&&w.type.kind!=="value"?y=new Qa(w.type,[y]):y.type.kind!=="value"&&w.type.kind==="value"&&(w=new Qa(y.type,[w])));let A=null;if(f.length===4){if(y.type.kind!=="string"&&w.type.kind!=="string"&&y.type.kind!=="value"&&w.type.kind!=="value")return p.error("Cannot use collator to compare non-string types.");if(A=p.parse(f[3],3,Hs),!A)return null}return new b4(y,w,A)}evaluate(f){let p=this.lhs.evaluate(f),v=this.rhs.evaluate(f);if(l&&this.hasUntypedArgument){let y=Wa(p),w=Wa(v);if(y.kind!==w.kind||y.kind!=="string"&&y.kind!=="number")throw new fo(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${y.kind}, ${w.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){let y=Wa(p),w=Wa(v);if(y.kind!=="string"||w.kind!=="string")return e(f,p,v)}return this.collator?n(f,p,v,this.collator.evaluate(f)):e(f,p,v)}eachChild(f){f(this.lhs),f(this.rhs),this.collator&&f(this.collator)}outputDefined(){return!0}serialize(){let f=[t];return this.eachChild(p=>{f.push(p.serialize())}),f}}}let Gm=As("==",function(t,e,n){return e===n},If),zp=As("!=",function(t,e,n){return e!==n},function(t,e,n,l){return!If(0,e,n,l)}),Hm=As("<",function(t,e,n){return e<n},function(t,e,n,l){return l.compare(e,n)<0}),jp=As(">",function(t,e,n){return e>n},function(t,e,n,l){return l.compare(e,n)>0}),Xu=As("<=",function(t,e,n){return e<=n},function(t,e,n,l){return l.compare(e,n)<=0}),Up=As(">=",function(t,e,n){return e>=n},function(t,e,n,l){return l.compare(e,n)>=0});class Vh{constructor(e,n,l,h,f,p){this.type=Gi,this.number=e,this.locale=n,this.currency=l,this.unit=h,this.minFractionDigits=f,this.maxFractionDigits=p}static parse(e,n){if(e.length!==3)return n.error("Expected two arguments.");let l=n.parse(e[1],1,Tr);if(!l)return null;let h=e[2];if(typeof h!="object"||Array.isArray(h))return n.error("NumberFormat options argument must be an object.");let f=null;if(h.locale&&(f=n.parse(h.locale,1,Gi),!f))return null;let p=null;if(h.currency&&(p=n.parse(h.currency,1,Gi),!p))return null;let v=null;if(h.unit&&(v=n.parse(h.unit,1,Gi),!v))return null;let y=null;if(h["min-fraction-digits"]&&(y=n.parse(h["min-fraction-digits"],1,Tr),!y))return null;let w=null;return h["max-fraction-digits"]&&(w=n.parse(h["max-fraction-digits"],1,Tr),!w)?null:new Vh(l,f,p,v,y,w)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){let e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Vp{constructor(e){this.type=Tr,this.input=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);let l=n.parse(e[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${Da(l.type)} instead.`):new Vp(l):null}evaluate(e){let n=this.input.evaluate(e);if(typeof n=="string"||Array.isArray(n))return n.length;throw new fo(`Expected value to be of type string or array, but found ${Da(Wa(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){let e=["length"];return this.eachChild(n=>{e.push(n.serialize())}),e}}function Gp(t){return function(){t=1831565813+(t|=0)|0;let e=Math.imul(t^t>>>15,1|t);return e=e+Math.imul(e^e>>>7,61|e)^e,((e^e>>>14)>>>0)/4294967296}}let Zu={"==":Gm,"!=":zp,">":jp,"<":Hm,">=":Up,"<=":Xu,array:Qa,at:jh,boolean:Qa,case:Bp,coalesce:Fd,collator:Pc,format:Ws,image:Ed,in:Ld,"index-of":fu,interpolate:Es,"interpolate-hcl":Es,"interpolate-lab":Es,length:Vp,let:Pd,literal:Fc,match:qu,number:Qa,"number-format":Vh,object:Qa,slice:$u,step:Oc,string:Qa,"to-boolean":qa,"to-color":qa,"to-number":qa,"to-string":qa,var:ya,within:I,distance:to,config:xn};function Gh(t,[e,n,l,h]){e=e.evaluate(t),n=n.evaluate(t),l=l.evaluate(t);let f=h?h.evaluate(t):1,p=Nm(e,n,l,f);if(p)throw new fo(p);return new qi(e/255*f,n/255*f,l/255*f,f)}function kf(t,[e,n,l,h]){e=e.evaluate(t),n=n.evaluate(t),l=l.evaluate(t);let f=h?h.evaluate(t):1,p=function(w,A,M,R){return typeof w=="number"&&w>=0&&w<=360?typeof A=="number"&&A>=0&&A<=100&&typeof M=="number"&&M>=0&&M<=100?R===void 0||typeof R=="number"&&R>=0&&R<=1?null:`Invalid hsla value [${[w,A,M,R].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof R=="number"?[w,A,M,R]:[w,A,M]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof R=="number"?[w,A,M,R]:[w,A,M]).join(", ")}]: 'h' must be between 0 and 360.`}(e,n,l,f);if(p)throw new fo(p);let v=`hsla(${e}, ${n}%, ${l}%, ${f})`,y=qi.parse(v);if(!y)throw new fo(`Failed to parse HSLA color: ${v}`);return y}function Od(t,e){return t in e}function Pl(t,e){let n=e[t];return n===void 0?null:n}function Cs(t){return{type:t}}function Nc(t){return{result:"success",value:t}}function rc(t){return{result:"error",value:t}}function Mf(t,e){return!!t&&!!t.parameters&&t.parameters.indexOf(e)>-1}function Nd(t){return t["property-type"]==="data-driven"}function wg(t){return Mf(t.expression,"measure-light")}function m(t){return Mf(t.expression,"zoom")}function s(t){return!!t.expression&&t.expression.interpolated}function d(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function g(t){return t}function x(t,e){let n=e.type==="color",l=t.stops&&typeof t.stops[0][0]=="object",h=l||!(l||t.property!==void 0),f=t.type||(s(e)?"exponential":"interval");if(n&&((t=Fh({},t)).stops&&(t.stops=t.stops.map(w=>[w[0],qi.parse(w[1])])),t.default=qi.parse(t.default?t.default:e.default)),t.colorSpace&&t.colorSpace!=="rgb"&&!Vm[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let p,v,y;if(f==="exponential")p=F;else if(f==="interval")p=C;else if(f==="categorical"){p=S,v=Object.create(null);for(let w of t.stops)v[w[0]]=w[1];y=typeof t.stops[0][0]}else{if(f!=="identity")throw new Error(`Unknown function type "${f}"`);p=O}if(l){let w={},A=[];for(let N=0;N<t.stops.length;N++){let z=t.stops[N],q=z[0].zoom;w[q]===void 0&&(w[q]={zoom:q,type:t.type,property:t.property,default:t.default,stops:[]},A.push(q)),w[q].stops.push([z[0].value,z[1]])}let M=[];for(let N of A)M.push([w[N].zoom,x(w[N],e)]);let R={name:"linear"};return{kind:"composite",interpolationType:R,interpolationFactor:Es.interpolationFactor.bind(void 0,R),zoomStops:M.map(N=>N[0]),evaluate:({zoom:N},z)=>F({stops:M,base:t.base},e,N).evaluate(N,z)}}if(h){let w=f==="exponential"?{name:"exponential",base:t.base!==void 0?t.base:1}:null;return{kind:"camera",interpolationType:w,interpolationFactor:Es.interpolationFactor.bind(void 0,w),zoomStops:t.stops.map(A=>A[0]),evaluate:({zoom:A})=>p(t,e,A,v,y)}}return{kind:"source",evaluate(w,A){let M=A&&A.properties?A.properties[t.property]:void 0;return M===void 0?b(t.default,e.default):p(t,e,M,v,y)}}}function b(t,e,n){return t!==void 0?t:e!==void 0?e:n!==void 0?n:void 0}function S(t,e,n,l,h){return b(typeof n===h?l[n]:void 0,t.default,e.default)}function C(t,e,n){if(su(n)!=="number")return b(t.default,e.default);let l=t.stops.length;if(l===1||n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[l-1][0])return t.stops[l-1][1];let h=Vu(t.stops.map(f=>f[0]),n);return t.stops[h][1]}function F(t,e,n){let l=t.base!==void 0?t.base:1;if(su(n)!=="number")return b(t.default,e.default);let h=t.stops.length;if(h===1||n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[h-1][0])return t.stops[h-1][1];let f=Vu(t.stops.map(A=>A[0]),n),p=function(A,M,R,N){let z=N-R,q=A-R;return z===0?0:M===1?q/z:(Math.pow(M,q)-1)/(Math.pow(M,z)-1)}(n,l,t.stops[f][0],t.stops[f+1][0]),v=t.stops[f][1],y=t.stops[f+1][1],w=ns[e.type]||g;if(t.colorSpace&&t.colorSpace!=="rgb"){let A=Vm[t.colorSpace];w=(M,R)=>A.reverse(A.interpolate(A.forward(M),A.forward(R),p))}return typeof v.evaluate=="function"?{evaluate(...A){let M=v.evaluate.apply(void 0,A),R=y.evaluate.apply(void 0,A);if(M!==void 0&&R!==void 0)return w(M,R,p)}}:w(v,y,p)}function O(t,e,n){return e.type==="color"?n=qi.parse(n):e.type==="formatted"?n=Ja.fromString(n.toString()):e.type==="resolvedImage"?n=os.fromString(n.toString()):su(n)===e.type||e.type==="enum"&&e.values[n]||(n=void 0),b(n,t.default,e.default)}Lo.register(Zu,{error:[{kind:"error"},[Gi],(t,[e])=>{throw new fo(e.evaluate(t))}],typeof:[Gi,[Oi],(t,[e])=>Da(Wa(e.evaluate(t)))],"to-rgba":[as(Tr,4),[Po],(t,[e])=>e.evaluate(t).toRenderColor(null).toArray()],rgb:[Po,[Tr,Tr,Tr],Gh],rgba:[Po,[Tr,Tr,Tr,Tr],Gh],hsl:[Po,[Tr,Tr,Tr],kf],hsla:[Po,[Tr,Tr,Tr,Tr],kf],has:{type:$i,overloads:[[[Gi],(t,[e])=>Od(e.evaluate(t),t.properties())],[[Gi,ou],(t,[e,n])=>Od(e.evaluate(t),n.evaluate(t))]]},get:{type:Oi,overloads:[[[Gi],(t,[e])=>Pl(e.evaluate(t),t.properties())],[[Gi,ou],(t,[e,n])=>Pl(e.evaluate(t),n.evaluate(t))]]},"feature-state":[Oi,[Gi],(t,[e])=>Pl(e.evaluate(t),t.featureState||{})],properties:[ou,[],t=>t.properties()],"geometry-type":[Gi,[],t=>t.geometryType()],id:[Oi,[],t=>t.id()],zoom:[Tr,[],t=>t.globals.zoom],pitch:[Tr,[],t=>t.globals.pitch||0],"distance-from-center":[Tr,[],t=>t.distanceFromCenter()],"measure-light":[Tr,[Gi],(t,[e])=>t.measureLight(e.evaluate(t))],"heatmap-density":[Tr,[],t=>t.globals.heatmapDensity||0],"line-progress":[Tr,[],t=>t.globals.lineProgress||0],"raster-value":[Tr,[],t=>t.globals.rasterValue||0],"raster-particle-speed":[Tr,[],t=>t.globals.rasterParticleSpeed||0],"sky-radial-progress":[Tr,[],t=>t.globals.skyRadialProgress||0],accumulated:[Oi,[],t=>t.globals.accumulated===void 0?null:t.globals.accumulated],"+":[Tr,Cs(Tr),(t,e)=>{let n=0;for(let l of e)n+=l.evaluate(t);return n}],"*":[Tr,Cs(Tr),(t,e)=>{let n=1;for(let l of e)n*=l.evaluate(t);return n}],"-":{type:Tr,overloads:[[[Tr,Tr],(t,[e,n])=>e.evaluate(t)-n.evaluate(t)],[[Tr],(t,[e])=>-e.evaluate(t)]]},"/":[Tr,[Tr,Tr],(t,[e,n])=>e.evaluate(t)/n.evaluate(t)],"%":[Tr,[Tr,Tr],(t,[e,n])=>e.evaluate(t)%n.evaluate(t)],ln2:[Tr,[],()=>Math.LN2],pi:[Tr,[],()=>Math.PI],e:[Tr,[],()=>Math.E],"^":[Tr,[Tr,Tr],(t,[e,n])=>Math.pow(e.evaluate(t),n.evaluate(t))],sqrt:[Tr,[Tr],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[Tr,[Tr],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[Tr,[Tr],(t,[e])=>Math.log(e.evaluate(t))],log2:[Tr,[Tr],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[Tr,[Tr],(t,[e])=>Math.sin(e.evaluate(t))],cos:[Tr,[Tr],(t,[e])=>Math.cos(e.evaluate(t))],tan:[Tr,[Tr],(t,[e])=>Math.tan(e.evaluate(t))],asin:[Tr,[Tr],(t,[e])=>Math.asin(e.evaluate(t))],acos:[Tr,[Tr],(t,[e])=>Math.acos(e.evaluate(t))],atan:[Tr,[Tr],(t,[e])=>Math.atan(e.evaluate(t))],min:[Tr,Cs(Tr),(t,e)=>Math.min(...e.map(n=>n.evaluate(t)))],max:[Tr,Cs(Tr),(t,e)=>Math.max(...e.map(n=>n.evaluate(t)))],abs:[Tr,[Tr],(t,[e])=>Math.abs(e.evaluate(t))],round:[Tr,[Tr],(t,[e])=>{let n=e.evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[Tr,[Tr],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[Tr,[Tr],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[$i,[Gi,Oi],(t,[e,n])=>t.properties()[e.value]===n.value],"filter-id-==":[$i,[Oi],(t,[e])=>t.id()===e.value],"filter-type-==":[$i,[Gi],(t,[e])=>t.geometryType()===e.value],"filter-<":[$i,[Gi,Oi],(t,[e,n])=>{let l=t.properties()[e.value],h=n.value;return typeof l==typeof h&&l<h}],"filter-id-<":[$i,[Oi],(t,[e])=>{let n=t.id(),l=e.value;return typeof n==typeof l&&n<l}],"filter->":[$i,[Gi,Oi],(t,[e,n])=>{let l=t.properties()[e.value],h=n.value;return typeof l==typeof h&&l>h}],"filter-id->":[$i,[Oi],(t,[e])=>{let n=t.id(),l=e.value;return typeof n==typeof l&&n>l}],"filter-<=":[$i,[Gi,Oi],(t,[e,n])=>{let l=t.properties()[e.value],h=n.value;return typeof l==typeof h&&l<=h}],"filter-id-<=":[$i,[Oi],(t,[e])=>{let n=t.id(),l=e.value;return typeof n==typeof l&&n<=l}],"filter->=":[$i,[Gi,Oi],(t,[e,n])=>{let l=t.properties()[e.value],h=n.value;return typeof l==typeof h&&l>=h}],"filter-id->=":[$i,[Oi],(t,[e])=>{let n=t.id(),l=e.value;return typeof n==typeof l&&n>=l}],"filter-has":[$i,[Oi],(t,[e])=>e.value in t.properties()],"filter-has-id":[$i,[],t=>t.id()!==null&&t.id()!==void 0],"filter-type-in":[$i,[as(Gi)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[$i,[as(Oi)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[$i,[Gi,as(Oi)],(t,[e,n])=>n.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[$i,[Gi,as(Oi)],(t,[e,n])=>function(l,h,f,p){for(;f<=p;){let v=f+p>>1;if(h[v]===l)return!0;h[v]>l?p=v-1:f=v+1}return!1}(t.properties()[e.value],n.value,0,n.value.length-1)],all:{type:$i,overloads:[[[$i,$i],(t,[e,n])=>e.evaluate(t)&&n.evaluate(t)],[Cs($i),(t,e)=>{for(let n of e)if(!n.evaluate(t))return!1;return!0}]]},any:{type:$i,overloads:[[[$i,$i],(t,[e,n])=>e.evaluate(t)||n.evaluate(t)],[Cs($i),(t,e)=>{for(let n of e)if(n.evaluate(t))return!0;return!1}]]},"!":[$i,[$i],(t,[e])=>!e.evaluate(t)],"is-supported-script":[$i,[Gi],(t,[e])=>{let n=t.globals&&t.globals.isSupportedScript;return!n||n(e.evaluate(t))}],upcase:[Gi,[Gi],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[Gi,[Gi],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[Gi,Cs(Oi),(t,e)=>e.map(n=>sl(n.evaluate(t))).join("")],"resolved-locale":[Gi,[Hs],(t,[e])=>e.evaluate(t).resolvedLocale()],random:[Tr,[Tr,Tr,Oi],(t,e)=>{let[n,l,h]=e.map(p=>p.evaluate(t));if(n>l||n===l)return n;let f;if(typeof h=="string")f=function(p){let v=0;if(p.length===0)return v;for(let y=0;y<p.length;y++)v=(v<<5)-v+p.charCodeAt(y),v|=0;return v}(h);else{if(typeof h!="number")throw new fo(`Invalid seed input: ${h}`);f=h}return n+Gp(f)()*(l-n)}]});class V{constructor(e,n,l,h){this.expression=e,this._warningHistory={},this._evaluator=new zm(l,h),this._defaultValue=n?function(f){return f.type==="color"&&(d(f.default)||Array.isArray(f.default))?new qi(0,0,0,0):f.type==="color"?qi.parse(f.default)||null:f.default===void 0?null:f.default}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(e,n,l,h,f,p,v,y){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=l,this._evaluator.canonical=h||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=p,this._evaluator.featureTileCoord=v||null,this._evaluator.featureDistanceData=y||null,this.expression.evaluate(this._evaluator)}evaluate(e,n,l,h,f,p,v,y){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=l||null,this._evaluator.canonical=h||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=p||null,this._evaluator.featureTileCoord=v||null,this._evaluator.featureDistanceData=y||null;try{let w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new fo(`Expected value to be one of ${Object.keys(this._enumValues).map(A=>JSON.stringify(A)).join(", ")}, but found ${JSON.stringify(w)} instead.`);return w}catch(w){return this._warningHistory[w.message]||(this._warningHistory[w.message]=!0,typeof console<"u"&&console.warn(w.message)),this._defaultValue}}}function X(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in Zu}function ie(t,e,n,l){let h=new Op(Zu,[],e?function(p){let v={color:Po,string:Gi,number:Tr,enum:Gi,boolean:$i,formatted:Ph,resolvedImage:Jl};return p.type==="array"?as(v[p.value]||Oi,p.length):v[p.type]}(e):void 0,void 0,void 0,n,l),f=h.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?Nc(new V(f,e,n,l)):rc(h.errors)}class ae{constructor(e,n,l){this.kind=e,this._styleExpression=n,this.isLightConstant=l,this.isStateDependent=e!=="constant"&&!tc(n.expression),this.isConfigDependent=!uu(n.expression)}evaluateWithoutErrorHandling(e,n,l,h,f,p){return this._styleExpression.evaluateWithoutErrorHandling(e,n,l,h,f,p)}evaluate(e,n,l,h,f,p){return this._styleExpression.evaluate(e,n,l,h,f,p)}}class ue{constructor(e,n,l,h,f){this.kind=e,this.zoomStops=l,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!tc(n.expression),this.isLightConstant=f,this.isConfigDependent=!uu(n.expression),this.interpolationType=h}evaluateWithoutErrorHandling(e,n,l,h,f,p){return this._styleExpression.evaluateWithoutErrorHandling(e,n,l,h,f,p)}evaluate(e,n,l,h,f,p){return this._styleExpression.evaluate(e,n,l,h,f,p)}interpolationFactor(e,n,l){return this.interpolationType?Es.interpolationFactor(this.interpolationType,e,n,l):0}}function de(t,e,n,l){if((t=ie(t,e,n,l)).result==="error")return t;let h=t.value.expression,f=$o(h);if(!f&&!Nd(e))return rc([new Gs("","data expressions not supported")]);let p=ll(h,["zoom","pitch","distance-from-center"]);if(!p&&!m(e))return rc([new Gs("","zoom expressions not supported")]);let v=ll(h,["measure-light"]);if(!v&&!wg(e))return rc([new Gs("","measure-light expression not supported")]);let y=e.expression&&e.expression.relaxZoomRestriction,w=me(h);return w||p||y?w instanceof Gs?rc([w]):w instanceof Es&&!s(e)?rc([new Gs("",'"interpolate" expressions cannot be used with this property')]):Nc(w?new ue(f?"camera":"composite",t.value,w.labels,w instanceof Es?w.interpolation:void 0,v):new ae(f?"constant":"source",t.value,v)):rc([new Gs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class fe{constructor(e,n){this._parameters=e,this._specification=n,Fh(this,x(this._parameters,this._specification))}static deserialize(e){return new fe(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function me(t){let e=null;if(t instanceof Pd)e=me(t.result);else if(t instanceof Fd){for(let n of t.args)if(e=me(n),e)break}else(t instanceof Oc||t instanceof Es)&&t.input instanceof Lo&&t.input.name==="zoom"&&(e=t);return e instanceof Gs||t.eachChild(n=>{let l=me(n);l instanceof Gs?e=l:e&&l&&e!==l&&(e=new Gs("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}var Pe=Ne,Oe=3;function Ne(t,e,n){var l=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var h=new Int32Array(this.arrayBuffer);t=h[0],this.d=(e=h[1])+2*(n=h[2]);for(var f=0;f<this.d*this.d;f++){var p=h[Oe+f],v=h[Oe+f+1];l.push(p===v?null:h.subarray(p,v))}var y=h[Oe+l.length+1];this.keys=h.subarray(h[Oe+l.length],y),this.bboxes=h.subarray(y),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var w=0;w<this.d*this.d;w++)l.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var A=n/e*t;this.min=-A,this.max=t+A}Ne.prototype.insert=function(t,e,n,l,h){this._forEachCell(e,n,l,h,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(l),this.bboxes.push(h)},Ne.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ne.prototype._insertCell=function(t,e,n,l,h,f){this.cells[h].push(f)},Ne.prototype.query=function(t,e,n,l,h){var f=this.min,p=this.max;if(t<=f&&e<=f&&p<=n&&p<=l&&!h)return Array.prototype.slice.call(this.keys);var v=[];return this._forEachCell(t,e,n,l,this._queryCell,v,{},h),v},Ne.prototype._queryCell=function(t,e,n,l,h,f,p,v){var y=this.cells[h];if(y!==null)for(var w=this.keys,A=this.bboxes,M=0;M<y.length;M++){var R=y[M];if(p[R]===void 0){var N=4*R;(v?v(A[N+0],A[N+1],A[N+2],A[N+3]):t<=A[N+2]&&e<=A[N+3]&&n>=A[N+0]&&l>=A[N+1])?(p[R]=!0,f.push(w[R])):p[R]=!1}}},Ne.prototype._forEachCell=function(t,e,n,l,h,f,p,v){for(var y=this._convertToCellCoord(t),w=this._convertToCellCoord(e),A=this._convertToCellCoord(n),M=this._convertToCellCoord(l),R=y;R<=A;R++)for(var N=w;N<=M;N++){var z=this.d*N+R;if((!v||v(this._convertFromCellCoord(R),this._convertFromCellCoord(N),this._convertFromCellCoord(R+1),this._convertFromCellCoord(N+1)))&&h.call(this,t,e,n,l,z,f,p,v))return}},Ne.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Ne.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Ne.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=Oe+this.cells.length+1+1,n=0,l=0;l<this.cells.length;l++)n+=this.cells[l].length;var h=new Int32Array(e+n+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var f=e,p=0;p<t.length;p++){var v=t[p];h[Oe+p]=f,h.set(v,f),f+=v.length}return h[Oe+t.length]=f,h.set(this.keys,f),h[Oe+t.length+1]=f+=this.keys.length,h.set(this.bboxes,f),f+=this.bboxes.length,h.buffer};var Je=J(Pe);let Ke={};function Fe(t,e,n={}){Object.defineProperty(t,"_classRegistryKey",{value:e,writable:!1}),Ke[e]={klass:t,omit:n.omit||[]}}Fe(Object,"Object"),Je.serialize=function(t,e){let n=t.toArrayBuffer();return e&&e.add(n),{buffer:n}},Je.deserialize=function(t){return new Je(t.buffer)},Object.defineProperty(Je,"name",{value:"Grid"}),Fe(Je,"Grid"),Fe(qi,"Color"),Fe(Error,"Error"),Fe(Ja,"Formatted"),Fe(Rc,"FormattedSection"),Fe(iu,"AJAXError"),Fe(os,"ResolvedImage"),Fe(fe,"StylePropertyFunction"),Fe(V,"StyleExpression",{omit:["_evaluator"]}),Fe(ue,"ZoomDependentExpression"),Fe(ae,"ZoomConstantExpression"),Fe(Lo,"CompoundExpression",{omit:["_evaluate"]});for(let t in Zu)Ke[Zu[t]._classRegistryKey]||Fe(Zu[t],`Expression${t}`);function Be(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function je(t){return self.ImageBitmap&&t instanceof ImageBitmap}function at(t,e){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Be(t)||je(t))return e&&e.add(t),t;if(ArrayBuffer.isView(t)){let n=t;return e&&e.add(n.buffer),n}if(t instanceof ImageData)return e&&e.add(t.data.buffer),t;if(Array.isArray(t)){let n=[];for(let l of t)n.push(at(l,e));return n}if(t instanceof Map){let n={$name:"Map"};for(let[l,h]of t.entries())n[l]=at(h);return n}if(typeof t=="object"){let n=t.constructor,l=n._classRegistryKey;if(!l)throw new Error(`can't serialize object of unregistered class ${l}`);let h=n.serialize?n.serialize(t,e):{};if(!n.serialize){for(let f in t)t.hasOwnProperty(f)&&(Ke[l].omit.indexOf(f)>=0||(h[f]=at(t[f],e)));t instanceof Error&&(h.message=t.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(h.$name=l),h}throw new Error("can't serialize object of type "+typeof t)}function xt(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Be(t)||je(t)||ArrayBuffer.isView(t)||t instanceof ImageData)return t;if(Array.isArray(t))return t.map(xt);if(typeof t=="object"){let e=t.$name||"Object";if(e==="Map"){let h=new Map;for(let f of Object.keys(t))f!=="$name"&&h.set(f,xt(t[f]));return h}let{klass:n}=Ke[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(t);let l=Object.create(n.prototype);for(let h of Object.keys(t))h!=="$name"&&(l[h]=xt(t[h]));return l}throw new Error("can't deserialize object of type "+typeof t)}let qe={"Latin-1 Supplement":t=>t>=128&&t<=255,Arabic:t=>t>=1536&&t<=1791,"Arabic Supplement":t=>t>=1872&&t<=1919,"Arabic Extended-A":t=>t>=2208&&t<=2303,"Hangul Jamo":t=>t>=4352&&t<=4607,"Unified Canadian Aboriginal Syllabics":t=>t>=5120&&t<=5759,Khmer:t=>t>=6016&&t<=6143,"Unified Canadian Aboriginal Syllabics Extended":t=>t>=6320&&t<=6399,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"CJK Radicals Supplement":t=>t>=11904&&t<=12031,"Kangxi Radicals":t=>t>=12032&&t<=12255,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Bopomofo:t=>t>=12544&&t<=12591,"Hangul Compatibility Jamo":t=>t>=12592&&t<=12687,Kanbun:t=>t>=12688&&t<=12703,"Bopomofo Extended":t=>t>=12704&&t<=12735,"CJK Strokes":t=>t>=12736&&t<=12783,"Katakana Phonetic Extensions":t=>t>=12784&&t<=12799,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"CJK Unified Ideographs Extension A":t=>t>=13312&&t<=19903,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Yi Syllables":t=>t>=40960&&t<=42127,"Yi Radicals":t=>t>=42128&&t<=42191,"Hangul Jamo Extended-A":t=>t>=43360&&t<=43391,"Hangul Syllables":t=>t>=44032&&t<=55215,"Hangul Jamo Extended-B":t=>t>=55216&&t<=55295,"Private Use Area":t=>t>=57344&&t<=63743,"CJK Compatibility Ideographs":t=>t>=63744&&t<=64255,"Arabic Presentation Forms-A":t=>t>=64336&&t<=65023,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Arabic Presentation Forms-B":t=>t>=65136&&t<=65279,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519,"CJK Unified Ideographs Extension B":t=>t>=131072&&t<=173791};function bt(t){for(let e of t)if(qt(e.charCodeAt(0)))return!0;return!1}function Ct(t){for(let e of t)if(!Gt(e.charCodeAt(0)))return!1;return!0}function Gt(t){return!(qe.Arabic(t)||qe["Arabic Supplement"](t)||qe["Arabic Extended-A"](t)||qe["Arabic Presentation Forms-A"](t)||qe["Arabic Presentation Forms-B"](t))}function qt(t){return!(t!==746&&t!==747&&(t<4352||!(qe["Bopomofo Extended"](t)||qe.Bopomofo(t)||qe["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||qe["CJK Compatibility Ideographs"](t)||qe["CJK Compatibility"](t)||qe["CJK Radicals Supplement"](t)||qe["CJK Strokes"](t)||!(!qe["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||t===12336)||qe["CJK Unified Ideographs Extension A"](t)||qe["CJK Unified Ideographs"](t)||qe["Enclosed CJK Letters and Months"](t)||qe["Hangul Compatibility Jamo"](t)||qe["Hangul Jamo Extended-A"](t)||qe["Hangul Jamo Extended-B"](t)||qe["Hangul Jamo"](t)||qe["Hangul Syllables"](t)||qe.Hiragana(t)||qe["Ideographic Description Characters"](t)||qe.Kanbun(t)||qe["Kangxi Radicals"](t)||qe["Katakana Phonetic Extensions"](t)||qe.Katakana(t)&&t!==12540||!(!qe["Halfwidth and Fullwidth Forms"](t)||t===65288||t===65289||t===65293||t>=65306&&t<=65310||t===65339||t===65341||t===65343||t>=65371&&t<=65503||t===65507||t>=65512&&t<=65519)||!(!qe["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||qe["Unified Canadian Aboriginal Syllabics"](t)||qe["Unified Canadian Aboriginal Syllabics Extended"](t)||qe["Vertical Forms"](t)||qe["Yijing Hexagram Symbols"](t)||qe["Yi Syllables"](t)||qe["Yi Radicals"](t))))}function Vt(t){return!(qt(t)||function(e){return!!(qe["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||qe["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||qe["Letterlike Symbols"](e)||qe["Number Forms"](e)||qe["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||qe["Control Pictures"](e)&&e!==9251||qe["Optical Character Recognition"](e)||qe["Enclosed Alphanumerics"](e)||qe["Geometric Shapes"](e)||qe["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||qe["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||qe["CJK Symbols and Punctuation"](e)||qe.Katakana(e)||qe["Private Use Area"](e)||qe["CJK Compatibility Forms"](e)||qe["Small Form Variants"](e)||qe["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(t))}function ft(t){return t>=1424&&t<=2303||qe["Arabic Presentation Forms-A"](t)||qe["Arabic Presentation Forms-B"](t)}function kt(t,e){return!(!e&&ft(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||qe.Khmer(t))}function jt(t){for(let e of t)if(ft(e.charCodeAt(0)))return!0;return!1}let dr="deferred",pr="loading",Cr="loaded",mr=null,Yt="unavailable",Nt=null,Pr=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(Yt="error"),mr&&mr(t)};function _i(){oi.fire(new Ha("pluginStateChange",{pluginStatus:Yt,pluginURL:Nt}))}let oi=new Kl,Di=function(){return Yt},Xi=function(){if(Yt!==dr||!Nt)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Yt=pr,_i(),Nt&&ho({url:Nt},t=>{t?Pr(t):(Yt=Cr,_i())})},_n={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Yt===Cr||_n.applyArabicShaping!=null,isLoading:()=>Yt===pr,setState(t){Yt=t.pluginStatus,Nt=t.pluginURL},isParsed:()=>_n.applyArabicShaping!=null&&_n.processBidirectionalText!=null&&_n.processStyledBidirectionalText!=null,getPluginURL:()=>Nt};class ni{constructor(e,n){this.zoom=e,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.transition=n.transition,this.pitch=n.pitch,this.brightness=n.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(e){return function(n,l){for(let h of n)if(!kt(h.charCodeAt(0),l))return!1;return!0}(e,_n.isLoaded())}}class cn{constructor(e,n,l,h){this.property=e,this.value=n,this.expression=function(f,p,v,y){if(d(f))return new fe(f,p);if(X(f)||Array.isArray(f)&&f.length>0){let w=de(f,p,v,y);if(w.result==="error")throw new Error(w.value.map(A=>`${A.key}: ${A.message}`).join(", "));return w.value}{let w=f;return typeof f=="string"&&p.type==="color"&&(w=qi.parse(f)),{kind:"constant",isConfigDependent:!1,evaluate:()=>w}}}(n===void 0?e.specification.default:n,e.specification,l,h)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,n,l){return this.property.possiblyEvaluate(this,e,n,l)}}class kn{constructor(e,n,l){this.property=e,this.value=new cn(e,void 0,n,l)}transitioned(e,n){return new Ni(this.property,this.value,n,Ma({},e.transition,this.transition),e.now)}untransitioned(){return new Ni(this.property,this.value,null,{},0)}}class mn{constructor(e,n,l){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._scope=n,this._options=l,this.isConfigDependent=!1}getValue(e){return _s(this._values[e].value.value)}setValue(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new kn(this._values[e].property,this._scope,this._options)),this._values[e].value=new cn(this._values[e].property,n===null?void 0:_s(n),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[e].value.expression.isConfigDependent}setTransitionOrValue(e,n){n&&(this._options=n);let l=this._properties.properties;if(e)for(let h in e){let f=e[h];if($l(h,"-transition")){let p=h.slice(0,-11);l[p]&&this.setTransition(p,f)}else l.hasOwnProperty(h)&&this.setValue(h,f)}}getTransition(e){return _s(this._values[e].transition)}setTransition(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new kn(this._values[e].property)),this._values[e].transition=_s(n)||void 0}serialize(){let e={};for(let n of Object.keys(this._values)){let l=this.getValue(n);l!==void 0&&(e[n]=l);let h=this.getTransition(n);h!==void 0&&(e[`${n}-transition`]=h)}return e}transitioned(e,n){let l=new li(this._properties);for(let h of Object.keys(this._values))l._values[h]=this._values[h].transitioned(e,n._values[h]);return l}untransitioned(){let e=new li(this._properties);for(let n of Object.keys(this._values))e._values[n]=this._values[n].untransitioned();return e}}class Ni{constructor(e,n,l,h,f){let p=h.delay||0,v=h.duration||0;f=f||0,this.property=e,this.value=n,this.begin=f+p,this.end=this.begin+v,e.specification.transition&&(h.delay||h.duration)&&(this.prior=l)}possiblyEvaluate(e,n,l){let h=e.now||0,f=this.value.possiblyEvaluate(e,n,l),p=this.prior;if(p){if(h>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(h<this.begin)return p.possiblyEvaluate(e,n,l);{let v=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(p.possiblyEvaluate(e,n,l),f,yc(v))}}return f}}class li{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,n,l){let h=new bn(this._properties);for(let f of Object.keys(this._values))h._values[f]=this._values[f].possiblyEvaluate(e,n,l);return h}hasTransition(){for(let e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class zn{constructor(e,n,l){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._scope=n,this._options=l,this.isConfigDependent=!1}getValue(e){return _s(this._values[e].value)}setValue(e,n){this._values[e]=new cn(this._values[e].property,n===null?void 0:_s(n),this._scope,this._options),this.isConfigDependent=this.isConfigDependent||this._values[e].expression.isConfigDependent}serialize(){let e={};for(let n of Object.keys(this._values)){let l=this.getValue(n);l!==void 0&&(e[n]=l)}return e}possiblyEvaluate(e,n,l){let h=new bn(this._properties);for(let f of Object.keys(this._values))h._values[f]=this._values[f].possiblyEvaluate(e,n,l);return h}}class $n{constructor(e,n,l){this.property=e,this.value=n,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,n,l,h){return this.property.evaluate(this.value,this.parameters,e,n,l,h)}}class bn{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Ht{constructor(e){this.specification=e}possiblyEvaluate(e,n){return e.expression.evaluate(n)}interpolate(e,n,l){let h=ns[this.specification.type];return h?h(e,n,l):e}}class _r{constructor(e,n){this.specification=e,this.overrides=n}possiblyEvaluate(e,n,l,h){return new $n(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(n,null,{},l,h)}:e.expression,n)}interpolate(e,n,l){if(e.value.kind!=="constant"||n.value.kind!=="constant")return e;if(e.value.value===void 0||n.value.value===void 0)return new $n(this,{kind:"constant",value:void 0},e.parameters);let h=ns[this.specification.type];return h?new $n(this,{kind:"constant",value:h(e.value.value,n.value.value,l)},e.parameters):e}evaluate(e,n,l,h,f,p){return e.kind==="constant"?e.value:e.evaluate(n,l,h,f,p)}}class ua{constructor(e){this.specification=e}possiblyEvaluate(e,n,l,h){return!!e.expression.evaluate(n,null,{},l,h)}interpolate(){return!1}}class un{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];let n=new ni(0,{});for(let l in e){let h=e[l];h.specification.overridable&&this.overridableProperties.push(l);let f=this.defaultPropertyValues[l]=new cn(h,void 0),p=this.defaultTransitionablePropertyValues[l]=new kn(h);this.defaultTransitioningPropertyValues[l]=p.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=f.possiblyEvaluate(n)}}}Fe(_r,"DataDrivenProperty"),Fe(Ht,"DataConstantProperty"),Fe(ua,"ColorRampProperty");var vt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant","experimental":true}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Ll(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Xo(t){if(Array.isArray(t))return t.map(Xo);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){let e={};for(let n in t)e[n]=Xo(t[n]);return e}return Ll(t)}function Is(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(let e of t.slice(1))if(!Is(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function Mo(t,e="fill"){if(t==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Is(t)||(t=pu(t));let n=t,l=!0;try{l=function(w){if(!Ol(w))return w;let A=Xo(w);return Bc(A),A=qs(A),A}(n)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(n,null,2)}
        `)}let h=vt[`filter_${e}`],f=ie(l,h),p=null;if(f.result==="error")throw new Error(f.value.map(w=>`${w.key}: ${w.message}`).join(", "));p=(w,A,M)=>f.value.evaluate(w,A,{},M);let v=null,y=null;if(l!==n){let w=ie(n,h);if(w.result==="error")throw new Error(w.value.map(A=>`${A.key}: ${A.message}`).join(", "));v=(A,M,R,N,z)=>w.value.evaluate(A,M,{},R,void 0,void 0,N,z),y=!$o(w.value.expression)}return{filter:p,dynamicFilter:v||void 0,needGeometry:Yu(l),needFeature:!!y}}function qs(t){if(!Array.isArray(t))return t;let e=function(n){if(Hh.has(n[0])){for(let l=1;l<n.length;l++)if(Ol(n[l]))return!0}return n}(t);return e===!0?e:e.map(n=>qs(n))}function Bc(t){let e=!1,n=[];if(t[0]==="case"){for(let l=1;l<t.length-1;l+=2)e=e||Ol(t[l]),n.push(t[l+1]);n.push(t[t.length-1])}else if(t[0]==="match"){e=e||Ol(t[1]);for(let l=2;l<t.length-1;l+=2)n.push(t[l+1]);n.push(t[t.length-1])}else if(t[0]==="step"){e=e||Ol(t[1]);for(let l=1;l<t.length-1;l+=2)n.push(t[l+1])}e&&(t.length=0,t.push("any",...n));for(let l=1;l<t.length;l++)Bc(t[l])}function Ol(t){if(!Array.isArray(t))return!1;if((e=t[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let n=1;n<t.length;n++)if(Ol(t[n]))return!0;return!1}let Hh=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Wh(t,e){return t<e?-1:t>e?1:0}function Yu(t){if(!Array.isArray(t))return!1;if(t[0]==="within"||t[0]==="distance")return!0;for(let e=1;e<t.length;e++)if(Yu(t[e]))return!0;return!1}function pu(t){if(!t)return!0;let e=t[0];return t.length<=1?e!=="any":e==="=="?Ku(t[1],t[2],"=="):e==="!="?Bd(Ku(t[1],t[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Ku(t[1],t[2],e):e==="any"?(n=t.slice(1),["any"].concat(n.map(pu))):e==="all"?["all"].concat(t.slice(1).map(pu)):e==="none"?["all"].concat(t.slice(1).map(pu).map(Bd)):e==="in"?Df(t[1],t.slice(2)):e==="!in"?Bd(Df(t[1],t.slice(2))):e==="has"?Rf(t[1]):e!=="!has"||Bd(Rf(t[1]));var n}function Ku(t,e,n){switch(t){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,t,e]}}function Df(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(n=>typeof n!=typeof e[0])?["filter-in-large",t,["literal",e.sort(Wh)]]:["filter-in-small",t,["literal",e]]}}function Rf(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Bd(t){return["!",t]}let Ff="";function Wm(t,e){return e?`${t}${Ff}${e}`:t}let qm="-transition",Tg=new Set(["fill","line","background","hillshade","raster"]);class bo extends Kl{constructor(e,n,l,h,f){if(super(),this.id=e.id,this.fqid=Wm(this.id,l),this.type=e.type,this.scope=l,this.lut=h,this.options=f,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&e.type!=="slot"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),e.slot&&(this.slot=e.slot),n.layout&&(this._unevaluatedLayout=new zn(n.layout,this.scope,f),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),n.paint)){this._transitionablePaint=new mn(n.paint,this.scope,f);for(let p in e.paint)this.setPaintProperty(p,e.paint[p]);for(let p in e.layout)this.setLayoutProperty(p,e.layout[p]);this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new bn(n.paint)}}onAdd(e){}onRemove(e){}isDraped(e){return Tg.has(this.type)}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,n){if(this.type==="custom"&&e==="visibility")return void(this.visibility=n);let l=this._unevaluatedLayout;l._properties.properties[e]&&(l.setValue(e,n),this.isConfigDependent=this.isConfigDependent||l.isConfigDependent,e==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(e){return $l(e,qm)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,n){let l=this._transitionablePaint,h=l._properties.properties;if($l(e,qm)){let M=e.slice(0,-11);return h[M]&&l.setTransition(M,n||void 0),!1}if(!h[e])return!1;let f=l._values[e],p=f.value.isDataDriven(),v=f.value;l.setValue(e,n),this.isConfigDependent=this.isConfigDependent||l.isConfigDependent,this._handleSpecialPaintPropertyUpdate(e);let y=l._values[e].value,w=y.isDataDriven(),A=$l(e,"pattern")||e==="line-dasharray";return w||p||A||this._handleOverridablePaintPropertyUpdate(e,v,y)}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getDefaultProgramParams(e,n,l){return null}_handleOverridablePaintPropertyUpdate(e,n,l){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,n){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,n)}serialize(){return Al({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(e,n)=>!(e===void 0||n==="layout"&&!Object.keys(e).length||n==="paint"&&!Object.keys(e).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(let e in this.paint._values){let n=this.paint.get(e);if(n instanceof $n&&Nd(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Mo(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(e){this._stats&&(e.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(e){}queryIntersectsFeature(e,n,l,h,f,p,v,y,w){}queryIntersectsMatchingFeature(e,n,l,h){}}let Sg={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Pf{constructor(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ta{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,n){return e._trim(),n&&(e.isTransferred=!0,n.add(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){let n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...e){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...e){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function hn(t,e=1){let n=0,l=0;return{members:t.map(h=>{let f=Sg[h.type].BYTES_PER_ELEMENT,p=n=VT(n,Math.max(e,f)),v=h.components||1;return l=Math.max(l,f),n+=f*v,{name:h.name,type:h.type,components:v,offset:p}}),size:VT(n,Math.max(l,e)),alignment:e}}function VT(t,e){return Math.ceil(t/e)*e}class Ju extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n){let l=this.length;return this.resize(l+1),this.emplace(l,e,n)}emplace(e,n,l){let h=2*e;return this.int16[h+0]=n,this.int16[h+1]=l,e}}Ju.prototype.bytesPerElement=4,Fe(Ju,"StructArrayLayout2i4");class I1 extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,l){let h=this.length;return this.resize(h+1),this.emplace(h,e,n,l)}emplace(e,n,l,h){let f=3*e;return this.int16[f+0]=n,this.int16[f+1]=l,this.int16[f+2]=h,e}}I1.prototype.bytesPerElement=6,Fe(I1,"StructArrayLayout3i6");class Lf extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,l,h){let f=this.length;return this.resize(f+1),this.emplace(f,e,n,l,h)}emplace(e,n,l,h,f){let p=4*e;return this.int16[p+0]=n,this.int16[p+1]=l,this.int16[p+2]=h,this.int16[p+3]=f,e}}Lf.prototype.bytesPerElement=8,Fe(Lf,"StructArrayLayout4i8");class Gx extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,l,h,f){let p=this.length;return this.resize(p+1),this.emplace(p,e,n,l,h,f)}emplace(e,n,l,h,f,p){let v=5*e;return this.int16[v+0]=n,this.int16[v+1]=l,this.int16[v+2]=h,this.int16[v+3]=f,this.int16[v+4]=p,e}}Gx.prototype.bytesPerElement=10,Fe(Gx,"StructArrayLayout5i10");class Hx extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,l,h,f,p,v){let y=this.length;return this.resize(y+1),this.emplace(y,e,n,l,h,f,p,v)}emplace(e,n,l,h,f,p,v,y){let w=6*e,A=12*e,M=3*e;return this.int16[w+0]=n,this.int16[w+1]=l,this.uint8[A+4]=h,this.uint8[A+5]=f,this.uint8[A+6]=p,this.uint8[A+7]=v,this.float32[M+2]=y,e}}Hx.prototype.bytesPerElement=12,Fe(Hx,"StructArrayLayout2i4ub1f12");class Of extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,l,h){let f=this.length;return this.resize(f+1),this.emplace(f,e,n,l,h)}emplace(e,n,l,h,f){let p=4*e;return this.float32[p+0]=n,this.float32[p+1]=l,this.float32[p+2]=h,this.float32[p+3]=f,e}}Of.prototype.bytesPerElement=16,Fe(Of,"StructArrayLayout4f16");class Nf extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,l){let h=this.length;return this.resize(h+1),this.emplace(h,e,n,l)}emplace(e,n,l,h){let f=3*e;return this.float32[f+0]=n,this.float32[f+1]=l,this.float32[f+2]=h,e}}Nf.prototype.bytesPerElement=12,Fe(Nf,"StructArrayLayout3f12");class Bf extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,l,h,f){let p=this.length;return this.resize(p+1),this.emplace(p,e,n,l,h,f)}emplace(e,n,l,h,f,p){let v=6*e,y=3*e;return this.uint16[v+0]=n,this.uint16[v+1]=l,this.uint16[v+2]=h,this.uint16[v+3]=f,this.float32[y+2]=p,e}}Bf.prototype.bytesPerElement=12,Fe(Bf,"StructArrayLayout4ui1f12");class k1 extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,l,h){let f=this.length;return this.resize(f+1),this.emplace(f,e,n,l,h)}emplace(e,n,l,h,f){let p=4*e;return this.uint16[p+0]=n,this.uint16[p+1]=l,this.uint16[p+2]=h,this.uint16[p+3]=f,e}}k1.prototype.bytesPerElement=8,Fe(k1,"StructArrayLayout4ui8");class M1 extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,l,h,f,p){let v=this.length;return this.resize(v+1),this.emplace(v,e,n,l,h,f,p)}emplace(e,n,l,h,f,p,v){let y=6*e;return this.int16[y+0]=n,this.int16[y+1]=l,this.int16[y+2]=h,this.int16[y+3]=f,this.int16[y+4]=p,this.int16[y+5]=v,e}}M1.prototype.bytesPerElement=12,Fe(M1,"StructArrayLayout6i12");class Wx extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,l,h,f,p,v,y,w,A,M,R){let N=this.length;return this.resize(N+1),this.emplace(N,e,n,l,h,f,p,v,y,w,A,M,R)}emplace(e,n,l,h,f,p,v,y,w,A,M,R,N){let z=12*e;return this.int16[z+0]=n,this.int16[z+1]=l,this.int16[z+2]=h,this.int16[z+3]=f,this.uint16[z+4]=p,this.uint16[z+5]=v,this.uint16[z+6]=y,this.uint16[z+7]=w,this.int16[z+8]=A,this.int16[z+9]=M,this.int16[z+10]=R,this.int16[z+11]=N,e}}Wx.prototype.bytesPerElement=24,Fe(Wx,"StructArrayLayout4i4ui4i24");class qx extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,l,h,f,p){let v=this.length;return this.resize(v+1),this.emplace(v,e,n,l,h,f,p)}emplace(e,n,l,h,f,p,v){let y=10*e,w=5*e;return this.int16[y+0]=n,this.int16[y+1]=l,this.int16[y+2]=h,this.float32[w+2]=f,this.float32[w+3]=p,this.float32[w+4]=v,e}}qx.prototype.bytesPerElement=20,Fe(qx,"StructArrayLayout3i3f20");class $x extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){let n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint32[1*e+0]=n,e}}$x.prototype.bytesPerElement=4,Fe($x,"StructArrayLayout1ul4");class Hp extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){let n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.float32[1*e+0]=n,e}}Hp.prototype.bytesPerElement=4,Fe(Hp,"StructArrayLayout1f4");class zf extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n){let l=this.length;return this.resize(l+1),this.emplace(l,e,n)}emplace(e,n,l){let h=2*e;return this.uint16[h+0]=n,this.uint16[h+1]=l,e}}zf.prototype.bytesPerElement=4,Fe(zf,"StructArrayLayout2ui4");class Xx extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,l,h,f,p,v,y,w,A,M,R,N){let z=this.length;return this.resize(z+1),this.emplace(z,e,n,l,h,f,p,v,y,w,A,M,R,N)}emplace(e,n,l,h,f,p,v,y,w,A,M,R,N,z){let q=20*e,Z=10*e;return this.int16[q+0]=n,this.int16[q+1]=l,this.int16[q+2]=h,this.int16[q+3]=f,this.int16[q+4]=p,this.float32[Z+3]=v,this.float32[Z+4]=y,this.float32[Z+5]=w,this.float32[Z+6]=A,this.int16[q+14]=M,this.uint32[Z+8]=R,this.uint16[q+18]=N,this.uint16[q+19]=z,e}}Xx.prototype.bytesPerElement=40,Fe(Xx,"StructArrayLayout5i4f1i1ul2ui40");class D1 extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,l,h,f,p,v){let y=this.length;return this.resize(y+1),this.emplace(y,e,n,l,h,f,p,v)}emplace(e,n,l,h,f,p,v,y){let w=8*e;return this.int16[w+0]=n,this.int16[w+1]=l,this.int16[w+2]=h,this.int16[w+4]=f,this.int16[w+5]=p,this.int16[w+6]=v,this.int16[w+7]=y,e}}D1.prototype.bytesPerElement=16,Fe(D1,"StructArrayLayout3i2i2i16");class Zx extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,l,h,f){let p=this.length;return this.resize(p+1),this.emplace(p,e,n,l,h,f)}emplace(e,n,l,h,f,p){let v=4*e,y=8*e;return this.float32[v+0]=n,this.float32[v+1]=l,this.float32[v+2]=h,this.int16[y+6]=f,this.int16[y+7]=p,e}}Zx.prototype.bytesPerElement=16,Fe(Zx,"StructArrayLayout2f1f2i16");class Yx extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,l,h){let f=this.length;return this.resize(f+1),this.emplace(f,e,n,l,h)}emplace(e,n,l,h,f){let p=12*e,v=3*e;return this.uint8[p+0]=n,this.uint8[p+1]=l,this.float32[v+1]=h,this.float32[v+2]=f,e}}Yx.prototype.bytesPerElement=12,Fe(Yx,"StructArrayLayout2ub2f12");class No extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,l){let h=this.length;return this.resize(h+1),this.emplace(h,e,n,l)}emplace(e,n,l,h){let f=3*e;return this.uint16[f+0]=n,this.uint16[f+1]=l,this.uint16[f+2]=h,e}}No.prototype.bytesPerElement=6,Fe(No,"StructArrayLayout3ui6");class Kx extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,l,h,f,p,v,y,w,A,M,R,N,z,q,Z,oe,ye,be,we,$e){let He=this.length;return this.resize(He+1),this.emplace(He,e,n,l,h,f,p,v,y,w,A,M,R,N,z,q,Z,oe,ye,be,we,$e)}emplace(e,n,l,h,f,p,v,y,w,A,M,R,N,z,q,Z,oe,ye,be,we,$e,He){let rt=30*e,ot=15*e,_t=60*e;return this.int16[rt+0]=n,this.int16[rt+1]=l,this.int16[rt+2]=h,this.float32[ot+2]=f,this.float32[ot+3]=p,this.uint16[rt+8]=v,this.uint16[rt+9]=y,this.uint32[ot+5]=w,this.uint32[ot+6]=A,this.uint32[ot+7]=M,this.uint16[rt+16]=R,this.uint16[rt+17]=N,this.uint16[rt+18]=z,this.float32[ot+10]=q,this.float32[ot+11]=Z,this.uint8[_t+48]=oe,this.uint8[_t+49]=ye,this.uint8[_t+50]=be,this.uint32[ot+13]=we,this.int16[rt+28]=$e,this.uint8[_t+58]=He,e}}Kx.prototype.bytesPerElement=60,Fe(Kx,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Jx extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,l,h,f,p,v,y,w,A,M,R,N,z,q,Z,oe,ye,be,we,$e,He,rt,ot,_t,Mt,At,zt,Jt,Ot,Xt,Dt,Zt,ir){let Kt=this.length;return this.resize(Kt+1),this.emplace(Kt,e,n,l,h,f,p,v,y,w,A,M,R,N,z,q,Z,oe,ye,be,we,$e,He,rt,ot,_t,Mt,At,zt,Jt,Ot,Xt,Dt,Zt,ir)}emplace(e,n,l,h,f,p,v,y,w,A,M,R,N,z,q,Z,oe,ye,be,we,$e,He,rt,ot,_t,Mt,At,zt,Jt,Ot,Xt,Dt,Zt,ir,Kt){let Sr=22*e,er=44*e,lr=88*e;return this.float32[Sr+0]=n,this.float32[Sr+1]=l,this.int16[er+4]=h,this.int16[er+5]=f,this.int16[er+6]=p,this.int16[er+7]=v,this.int16[er+8]=y,this.int16[er+9]=w,this.int16[er+10]=A,this.int16[er+11]=M,this.int16[er+12]=R,this.uint16[er+13]=N,this.uint16[er+14]=z,this.uint16[er+15]=q,this.uint16[er+16]=Z,this.uint16[er+17]=oe,this.uint16[er+18]=ye,this.uint16[er+19]=be,this.uint16[er+20]=we,this.uint16[er+21]=$e,this.uint16[er+22]=He,this.uint16[er+23]=rt,this.uint16[er+24]=ot,this.uint16[er+25]=_t,this.uint16[er+26]=Mt,this.uint16[er+27]=At,this.uint32[Sr+14]=zt,this.float32[Sr+15]=Jt,this.float32[Sr+16]=Ot,this.float32[Sr+17]=Xt,this.float32[Sr+18]=Dt,this.float32[Sr+19]=Zt,this.float32[Sr+20]=ir,this.uint8[lr+84]=Kt,e}}Jx.prototype.bytesPerElement=88,Fe(Jx,"StructArrayLayout2f9i15ui1ul6f1ub88");class Wp extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,l,h,f){let p=this.length;return this.resize(p+1),this.emplace(p,e,n,l,h,f)}emplace(e,n,l,h,f,p){let v=5*e;return this.float32[v+0]=n,this.float32[v+1]=l,this.float32[v+2]=h,this.float32[v+3]=f,this.float32[v+4]=p,e}}Wp.prototype.bytesPerElement=20,Fe(Wp,"StructArrayLayout5f20");class Qx extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,l,h,f,p,v){let y=this.length;return this.resize(y+1),this.emplace(y,e,n,l,h,f,p,v)}emplace(e,n,l,h,f,p,v,y){let w=7*e;return this.float32[w+0]=n,this.float32[w+1]=l,this.float32[w+2]=h,this.float32[w+3]=f,this.float32[w+4]=p,this.float32[w+5]=v,this.float32[w+6]=y,e}}Qx.prototype.bytesPerElement=28,Fe(Qx,"StructArrayLayout7f28");class $m extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n){let l=this.length;return this.resize(l+1),this.emplace(l,e,n)}emplace(e,n,l){let h=2*e;return this.float32[h+0]=n,this.float32[h+1]=l,e}}$m.prototype.bytesPerElement=8,Fe($m,"StructArrayLayout2f8");class eb extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,l,h){let f=this.length;return this.resize(f+1),this.emplace(f,e,n,l,h)}emplace(e,n,l,h,f){let p=6*e;return this.uint32[3*e+0]=n,this.uint16[p+2]=l,this.uint16[p+3]=h,this.uint16[p+4]=f,e}}eb.prototype.bytesPerElement=12,Fe(eb,"StructArrayLayout1ul3ui12");class Eg extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){let n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint16[1*e+0]=n,e}}Eg.prototype.bytesPerElement=2,Fe(Eg,"StructArrayLayout1ui2");class tb extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,l,h,f,p,v,y,w,A,M,R,N,z,q,Z){let oe=this.length;return this.resize(oe+1),this.emplace(oe,e,n,l,h,f,p,v,y,w,A,M,R,N,z,q,Z)}emplace(e,n,l,h,f,p,v,y,w,A,M,R,N,z,q,Z,oe){let ye=16*e;return this.float32[ye+0]=n,this.float32[ye+1]=l,this.float32[ye+2]=h,this.float32[ye+3]=f,this.float32[ye+4]=p,this.float32[ye+5]=v,this.float32[ye+6]=y,this.float32[ye+7]=w,this.float32[ye+8]=A,this.float32[ye+9]=M,this.float32[ye+10]=R,this.float32[ye+11]=N,this.float32[ye+12]=z,this.float32[ye+13]=q,this.float32[ye+14]=Z,this.float32[ye+15]=oe,e}}tb.prototype.bytesPerElement=64,Fe(tb,"StructArrayLayout16f64");class R1 extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,l,h,f,p,v){let y=this.length;return this.resize(y+1),this.emplace(y,e,n,l,h,f,p,v)}emplace(e,n,l,h,f,p,v,y){let w=10*e,A=5*e;return this.uint16[w+0]=n,this.uint16[w+1]=l,this.uint16[w+2]=h,this.uint16[w+3]=f,this.float32[A+2]=p,this.float32[A+3]=v,this.float32[A+4]=y,e}}R1.prototype.bytesPerElement=20,Fe(R1,"StructArrayLayout4ui3f20");class rb extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e){let n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.int16[1*e+0]=n,e}}rb.prototype.bytesPerElement=2,Fe(rb,"StructArrayLayout1i2");class ib extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(e){let n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint8[1*e+0]=n,e}}ib.prototype.bytesPerElement=1,Fe(ib,"StructArrayLayout1ub1");class GT extends Pf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}GT.prototype.size=40;class nb extends Xx{get(e){return new GT(this,e)}}Fe(nb,"CollisionBoxArray");class HT extends Pf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}HT.prototype.size=60;class WT extends Kx{get(e){return new HT(this,e)}}Fe(WT,"PlacedSymbolArray");class qT extends Pf{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(e){this._structArray.uint32[this._pos4+14]=e}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(e){this._structArray.float32[this._pos4+18]=e}get occlusionState(){return this._structArray.float32[this._pos4+19]}set occlusionState(e){this._structArray.float32[this._pos4+19]=e}get occlusionOpacity(){return this._structArray.float32[this._pos4+20]}set occlusionOpacity(e){this._structArray.float32[this._pos4+20]=e}get hasIconTextFit(){return this._structArray.uint8[this._pos1+84]}}qT.prototype.size=88;class $T extends Jx{get(e){return new qT(this,e)}}Fe($T,"SymbolInstanceArray");class XT extends Hp{getoffsetX(e){return this.float32[1*e+0]}}Fe(XT,"GlyphOffsetArray");class ZT extends Ju{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}Fe(ZT,"SymbolLineVertexArray");class YT extends Pf{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}YT.prototype.size=12;class KT extends eb{get(e){return new YT(this,e)}}Fe(KT,"FeatureIndexArray");class JT extends zf{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}Fe(JT,"FillExtrusionCentroidArray");let tR=hn([{name:"a_pos",components:2,type:"Int16"}],4),rR=hn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ha{constructor(e=[]){this.segments=e}_prepareSegment(e,n,l,h){let f=this.segments[this.segments.length-1];return e>ha.MAX_VERTEX_ARRAY_LENGTH&&Wn(`Max vertices per segment is ${ha.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!f||f.vertexLength+e>ha.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==h)&&(f={vertexOffset:n,primitiveOffset:l,vertexLength:0,primitiveLength:0},h!==void 0&&(f.sortKey=h),this.segments.push(f)),f}prepareSegment(e,n,l,h){return this._prepareSegment(e,n.length,l.length,h)}get(){return this.segments}destroy(){for(let e of this.segments)for(let n in e.vaos)e.vaos[n].destroy()}static simpleSegment(e,n,l,h){return new ha([{vertexOffset:e,primitiveOffset:n,vertexLength:l,primitiveLength:h,vaos:{},sortKey:0}])}}function QT(t,e){return 256*(t=ui(Math.floor(t),0,255))+ui(Math.floor(e),0,255)}ha.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Fe(ha,"SegmentVector");let iR=hn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),nR=hn([{name:"a_dash",components:4,type:"Uint16"}]);class Ag{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(e,n,l,h){this.ids.push(eS(e)),this.positions.push(n,l,h)}eachPosition(e,n){let l=eS(e),h=0,f=this.ids.length-1;for(;h<f;){let p=h+f>>1;this.ids[p]>=l?f=p:h=p+1}for(;this.ids[h]===l;)n(this.positions[3*h],this.positions[3*h+1],this.positions[3*h+2]),h++}static serialize(e,n){let l=new Float64Array(e.ids),h=new Uint32Array(e.positions);return ab(l,h,0,l.length-1),n&&(n.add(l.buffer),n.add(h.buffer)),{ids:l,positions:h}}static deserialize(e){let n=new Ag,l;n.ids=e.ids,n.positions=e.positions;for(let h of n.ids)h!==l&&n.uniqueIds.push(h),l=h;return n.indexed=!0,n}}function eS(t){let e=+t;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:ca(String(t))}function ab(t,e,n,l){for(;n<l;){let h=t[n+l>>1],f=n-1,p=l+1;for(;;){do f++;while(t[f]<h);do p--;while(t[p]>h);if(f>=p)break;F1(t,f,p),F1(e,3*f,3*p),F1(e,3*f+1,3*p+1),F1(e,3*f+2,3*p+2)}p-n<l-p?(ab(t,e,n,p),n=p+1):(ab(t,e,p+1,l),l=p)}}function F1(t,e,n){let l=t[e];t[e]=t[n],t[n]=l}Fe(Ag,"FeaturePositionMap");class zd{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,n){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,n),this.initialized=!0),!!this.location}set(e,n,l){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class P1 extends zd{constructor(e){super(e),this.current=0}set(e,n,l){this.fetchUniformLocation(e,n)&&this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}}class hl extends zd{constructor(e){super(e),this.current=0}set(e,n,l){this.fetchUniformLocation(e,n)&&this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))}}class jd extends zd{constructor(e){super(e),this.current=[0,0]}set(e,n,l){this.fetchUniformLocation(e,n)&&(l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1])))}}class ob extends zd{constructor(e){super(e),this.current=[0,0,0]}set(e,n,l){this.fetchUniformLocation(e,n)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2])))}}class sb extends zd{constructor(e){super(e),this.current=[0,0,0,0]}set(e,n,l){this.fetchUniformLocation(e,n)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3])))}}class tS extends zd{constructor(e){super(e),this.current=qi.transparent.toRenderColor(null)}set(e,n,l){this.fetchUniformLocation(e,n)&&(l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a)))}}let aR=new Float32Array(16);class Cg extends zd{constructor(e){super(e),this.current=aR}set(e,n,l){if(this.fetchUniformLocation(e,n)){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let h=1;h<16;h++)if(l[h]!==this.current[h]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}}}let oR=new Float32Array(9),sR=new Float32Array(4);class lb extends zd{constructor(e){super(e),this.current=sR}set(e,n,l){if(this.fetchUniformLocation(e,n)){for(let h=0;h<4;h++)if(l[h]!==this.current[h]){this.current=l,this.gl.uniformMatrix2fv(this.location,!1,l);break}}}}function cb(t){return[QT(255*t.r,255*t.g),QT(255*t.b,255*t.a)]}class Ig{constructor(e,n,l,h){this.value=e,this.uniformNames=n.map(f=>`u_${f}`),this.type=l,this.context=h}setUniform(e,n,l,h,f){let p=h.constantOr(this.value);n.set(e,f,p instanceof qi?p.toRenderColor(this.context.lut):p)}getBinding(e,n){return this.type==="color"?new tS(e):new hl(e)}}class Xm{constructor(e,n){this.uniformNames=n.map(l=>`u_${l}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,n,l,h,f){let p=f==="u_pattern"||f==="u_dash"?this.pattern:f==="u_pixel_ratio"?this.pixelRatio:null;p&&n.set(e,f,p)}getBinding(e,n){return n==="u_pattern"||n==="u_dash"?new sb(e):new hl(e)}}class Ud{constructor(e,n,l,h){this.expression=e,this.type=l,this.maxValue=0,this.paintVertexAttributes=n.map(f=>({name:`a_${f}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(e,n,l,h,f,p,v){let y=this.paintVertexArray.length,w=this.expression.evaluate(new ni(0,{brightness:p}),n,{},f,h,v);this.paintVertexArray.resize(e),this._setPaintValue(y,e,w,this.context)}updatePaintArray(e,n,l,h,f,p,v){let y=this.expression.evaluate({zoom:0,brightness:v},l,h,void 0,f);this._setPaintValue(e,n,y,this.context)}_setPaintValue(e,n,l,h){if(this.type==="color"){let f=cb(l.toRenderColor(h.lut));for(let p=e;p<n;p++)this.paintVertexArray.emplace(p,f[0],f[1])}else{for(let f=e;f<n;f++)this.paintVertexArray.emplace(f,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Qu{constructor(e,n,l,h,f,p){this.expression=e,this.uniformNames=n.map(v=>`u_${v}_t`),this.type=l,this.useIntegerZoom=h,this.context=f,this.maxValue=0,this.paintVertexAttributes=n.map(v=>({name:`a_${v}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new p}populatePaintArray(e,n,l,h,f,p,v){let y=this.expression.evaluate(new ni(this.context.zoom,{brightness:p}),n,{},f,h,v),w=this.expression.evaluate(new ni(this.context.zoom+1,{brightness:p}),n,{},f,h,v),A=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(A,e,y,w,this.context)}updatePaintArray(e,n,l,h,f,p,v){let y=this.expression.evaluate({zoom:this.context.zoom,brightness:v},l,h,void 0,f),w=this.expression.evaluate({zoom:this.context.zoom+1,brightness:v},l,h,void 0,f);this._setPaintValue(e,n,y,w,this.context)}_setPaintValue(e,n,l,h,f){if(this.type==="color"){let p=cb(l.toRenderColor(f.lut)),v=cb(l.toRenderColor(f.lut));for(let y=e;y<n;y++)this.paintVertexArray.emplace(y,p[0],p[1],v[0],v[1])}else{for(let p=e;p<n;p++)this.paintVertexArray.emplace(p,l,h);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(h))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,n,l,h,f){let p=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,v=ui(this.expression.interpolationFactor(p,this.context.zoom,this.context.zoom+1),0,1);n.set(e,f,v)}getBinding(e,n){return new hl(e)}}class jf{constructor(e,n,l,h,f){this.expression=e,this.layerId=f,this.paintVertexAttributes=(l==="array"?nR:iR).members;for(let p=0;p<n.length;++p);this.paintVertexArray=new h}populatePaintArray(e,n,l,h){let f=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(f,e,n.patterns&&n.patterns[this.layerId],l)}updatePaintArray(e,n,l,h,f,p,v){this._setPaintValues(e,n,l.patterns&&l.patterns[this.layerId],p)}_setPaintValues(e,n,l,h){if(!h||!l)return;let f=h[l];if(!f)return;let{tl:p,br:v,pixelRatio:y}=f;for(let w=e;w<n;w++)this.paintVertexArray.emplace(w,p[0],p[1],v[0],v[1],y)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class qp{constructor(e,n,l=()=>!0){this.binders={},this._buffers=[],this.context=n;let h=[];for(let f in e.paint._values){let p=e.paint.get(f);if(!l(f)||!(p instanceof $n&&Nd(p.property.specification)))continue;let v=cR(f,e.type),y=p.value,w=p.property.specification.type,A=!!p.property.useIntegerZoom,M=f==="line-dasharray"||f.endsWith("pattern"),R=f==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(y.kind!=="constant"||R)if(y.kind==="source"||R||M){let N=rS(f,w,"source");this.binders[f]=M?new jf(y,v,w,N,e.id):new Ud(y,v,w,N),h.push(`/a_${f}`)}else{let N=rS(f,w,"composite");this.binders[f]=new Qu(y,v,w,A,n,N),h.push(`/z_${f}`)}else this.binders[f]=M?new Xm(y.value,v):new Ig(y.value,v,w,n),h.push(`/u_${f}`)}this.cacheKey=h.sort().join("")}getMaxValue(e){let n=this.binders[e];return n instanceof Ud||n instanceof Qu?n.maxValue:0}populatePaintArrays(e,n,l,h,f,p,v){for(let y in this.binders){let w=this.binders[y];w.context=this.context,(w instanceof Ud||w instanceof Qu||w instanceof jf)&&w.populatePaintArray(e,n,l,h,f,p,v)}}setConstantPatternPositions(e){for(let n in this.binders){let l=this.binders[n];l instanceof Xm&&l.setConstantPatternPositions(e)}}updatePaintArrays(e,n,l,h,f,p,v,y){let w=!1,A=Object.keys(e),M=A.length!==0,R=M?A:n.uniqueIds;this.context.lut=f.lut;for(let N in this.binders){let z=this.binders[N];if(z.context=this.context,(z instanceof Ud||z instanceof Qu||z instanceof jf)&&(z.expression.isStateDependent===!0||z.expression.isLightConstant===!1)){let q=f.paint.get(N);z.expression=q.value;for(let Z of R){let oe=e[Z.toString()];n.eachPosition(Z,(ye,be,we)=>{let $e=h.feature(ye);z.updatePaintArray(be,we,$e,oe,p,v,y)})}if(!M)for(let Z of l.uniqueIds){let oe=e[Z.toString()];l.eachPosition(Z,(ye,be,we)=>{let $e=h.feature(ye);z.updatePaintArray(be,we,$e,oe,p,v,y)})}w=!0}}return w}defines(){let e=[];for(let n in this.binders){let l=this.binders[n];(l instanceof Ig||l instanceof Xm)&&e.push(...l.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return e}getBinderAttributes(){let e=[];for(let n in this.binders){let l=this.binders[n];if(l instanceof Ud||l instanceof Qu||l instanceof jf)for(let h=0;h<l.paintVertexAttributes.length;h++)e.push(l.paintVertexAttributes[h].name)}return e}getBinderUniforms(){let e=[];for(let n in this.binders){let l=this.binders[n];if(l instanceof Ig||l instanceof Xm||l instanceof Qu)for(let h of l.uniformNames)e.push(h)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){let n=[];for(let l in this.binders){let h=this.binders[l];if(h instanceof Ig||h instanceof Xm||h instanceof Qu)for(let f of h.uniformNames)n.push({name:f,property:l,binding:h.getBinding(e,f)})}return n}setUniforms(e,n,l,h,f){for(let{name:p,property:v,binding:y}of l)this.binders[v].setUniform(e,y,f,h.get(v),p)}updatePaintBuffers(){this._buffers=[];for(let e in this.binders){let n=this.binders[e];(n instanceof Ud||n instanceof Qu||n instanceof jf)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(e){for(let n in this.binders){let l=this.binders[n];(l instanceof Ud||l instanceof Qu||l instanceof jf)&&l.upload(e)}this.updatePaintBuffers()}destroy(){for(let e in this.binders){let n=this.binders[e];(n instanceof Ud||n instanceof Qu||n instanceof jf)&&n.destroy()}}}class Uf{constructor(e,n,l=()=>!0){this.programConfigurations={};for(let h of e)this.programConfigurations[h.id]=new qp(h,n,l);this.needsUpload=!1,this._featureMap=new Ag,this._featureMapWithoutIds=new Ag,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(e,n,l,h,f,p,v,y){for(let w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(e,n,h,f,p,v,y);n.id!==void 0?this._featureMap.add(n.id,l,this._bufferOffset,e):(this._featureMapWithoutIds.add(this._idlessCounter,l,this._bufferOffset,e),this._idlessCounter+=1),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,n,l,h,f,p){for(let v of l)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(e,this._featureMap,this._featureMapWithoutIds,n,v,h,f,p||0)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(let n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}}destroy(){for(let e in this.programConfigurations)this.programConfigurations[e].destroy()}}let lR={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function cR(t,e){return lR[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}let uR={"line-pattern":{source:Bf,composite:Bf},"fill-pattern":{source:Bf,composite:Bf},"fill-extrusion-pattern":{source:Bf,composite:Bf},"line-dasharray":{source:k1,composite:k1}},hR={color:{source:$m,composite:Of},number:{source:Hp,composite:$m}};function rS(t,e,n){let l=uR[t];return l&&l[n]||hR[e][n]}Fe(Ig,"ConstantBinder"),Fe(Xm,"PatternConstantBinder"),Fe(Ud,"SourceExpressionBinder"),Fe(jf,"PatternCompositeBinder"),Fe(Qu,"CompositeExpressionBinder"),Fe(qp,"ProgramConfiguration",{omit:["_buffers"]}),Fe(Uf,"ProgramConfigurationSet");let dl=it/Math.PI/2,ub=5,iS=6,dR=16383,Zm=64,hb=[Zm,32,16],mu=-dl,gu=dl;function Ym(t,e,n,l=dl){return n=Ai(n),[t*Math.sin(n)*l,-e*l,t*Math.cos(n)*l]}function $p(t,e,n){return Ym(Math.cos(Ai(t)),Math.sin(Ai(t)),e,n)}let Km=63710088e-1,db=2*Math.PI*Km;class en{constructor(e,n){if(isNaN(e)||isNaN(n))throw new Error(`Invalid LngLat object: (${e}, ${n})`);if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new en(ql(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){let n=Math.PI/180,l=this.lat*n,h=e.lat*n,f=Math.sin(l)*Math.sin(h)+Math.cos(l)*Math.cos(h)*Math.cos((e.lng-this.lng)*n);return Km*Math.acos(Math.min(f,1))}toBounds(e=0){let n=360*e/40075017,l=n/Math.cos(Math.PI/180*this.lat);return new Vf({lng:this.lng-l,lat:this.lat-n},{lng:this.lng+l,lat:this.lat+n})}toEcef(e){return $p(this.lat,this.lng,dl+e*dl/Km)}static convert(e){if(e instanceof en)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new en(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new en(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Vf{constructor(e,n){if(e)if(n)this.setSouthWest(e).setNorthEast(n);else if(e.length===4){let l=e;this.setSouthWest([l[0],l[1]]).setNorthEast([l[2],l[3]])}else{let l=e;this.setSouthWest(l[0]).setNorthEast(l[1])}}setNorthEast(e){return this._ne=e instanceof en?new en(e.lng,e.lat):en.convert(e),this}setSouthWest(e){return this._sw=e instanceof en?new en(e.lng,e.lat):en.convert(e),this}extend(e){let n=this._sw,l=this._ne,h,f;if(e instanceof en)h=e,f=e;else{if(!(e instanceof Vf))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Vf.convert(e)):this.extend(en.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(en.convert(e)):this;if(h=e._sw,f=e._ne,!h||!f)return this}return n||l?(n.lng=Math.min(h.lng,n.lng),n.lat=Math.min(h.lat,n.lat),l.lng=Math.max(f.lng,l.lng),l.lat=Math.max(f.lat,l.lat)):(this._sw=new en(h.lng,h.lat),this._ne=new en(f.lng,f.lat)),this}getCenter(){return new en((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new en(this.getWest(),this.getNorth())}getSouthEast(){return new en(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){let{lng:n,lat:l}=en.convert(e),h=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&h}static convert(e){return!e||e instanceof Vf?e:new Vf(e)}}var nS={};(function(t,e){(function(n){function l(f,p,v){var y=h(256*f,256*(p=Math.pow(2,v)-p-1),v),w=h(256*(f+1),256*(p+1),v);return y[0]+","+y[1]+","+w[0]+","+w[1]}function h(f,p,v){var y=2*Math.PI*6378137/256/Math.pow(2,v);return[f*y-2*Math.PI*6378137/2,p*y-2*Math.PI*6378137/2]}n.getURL=function(f,p,v,y,w,A){return A=A||{},f+"?"+["bbox="+l(v,y,w),"format="+(A.format||"image/png"),"service="+(A.service||"WMS"),"version="+(A.version||"1.1.1"),"request="+(A.request||"GetMap"),"srs="+(A.srs||"EPSG:3857"),"width="+(A.width||256),"height="+(A.height||256),"layers="+p].join("&")},n.getTileBBox=l,n.getMercCoords=h,Object.defineProperty(n,"__esModule",{value:!0})})(e)})(0,nS);var fR=nS;class Xp{constructor(e,n,l){this.z=e,this.x=n,this.y=l,this.key=kg(0,e,e,n,l)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,n){let l=fR.getTileBBox(this.x,this.y,this.z),h=function(f,p,v){let y,w="";for(let A=f;A>0;A--)y=1<<A-1,w+=(p&y?1:0)+(v&y?2:0);return w}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",h).replace("{bbox-epsg-3857}",l)}toString(){return`${this.z}/${this.x}/${this.y}`}}class aS{constructor(e,n){this.wrap=e,this.canonical=n,this.key=kg(e,n.z,n.z,n.x,n.y)}}class wo{constructor(e,n,l,h,f){this.overscaledZ=e,this.wrap=n,this.canonical=new Xp(l,+h,+f),this.key=n===0&&e===l?this.canonical.key:kg(n,e,l,h,f)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){let n=this.canonical.z-e;return e>this.canonical.z?new wo(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new wo(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(e,n=!0){if(this.overscaledZ===e&&n)return this.key;if(e>this.canonical.z)return kg(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y);{let l=this.canonical.z-e;return kg(this.wrap*+n,e,e,this.canonical.x>>l,this.canonical.y>>l)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;let n=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.z<this.canonical.z&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n}children(e){if(this.overscaledZ>=e)return[new wo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let n=this.canonical.z+1,l=2*this.canonical.x,h=2*this.canonical.y;return[new wo(n,this.wrap,n,l,h),new wo(n,this.wrap,n,l+1,h),new wo(n,this.wrap,n,l,h+1),new wo(n,this.wrap,n,l+1,h+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new wo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new wo(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new aS(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function kg(t,e,n,l,h){let f=1<<Math.min(n,22),p=f*(h%f)+l%f;return t&&n<22&&(p+=f*f*((t<0?-2*t-1:2*t)%(1<<2*(22-n)))),16*(32*p+n)+(e-n)}let pR=[t=>{let e=t.canonical.x-1,n=t.wrap;return e<0&&(e=(1<<t.canonical.z)-1,n--),new wo(t.overscaledZ,n,t.canonical.z,e,t.canonical.y)},t=>{let e=t.canonical.x+1,n=t.wrap;return e===1<<t.canonical.z&&(e=0,n++),new wo(t.overscaledZ,n,t.canonical.z,e,t.canonical.y)},t=>new wo(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,(t.canonical.y===0?1<<t.canonical.z:t.canonical.y)-1),t=>new wo(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y===(1<<t.canonical.z)-1?0:t.canonical.y+1)];Fe(Xp,"CanonicalTileID"),Fe(wo,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});let mR=0,gR=25.5;function fb(t){return db*Math.cos(t*Math.PI/180)}function qh(t){return(180+t)/360}function $h(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function fl(t,e){return t/fb(e)}function Nl(t){return 360*t-180}function Zo(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function oS(t,e){return t*fb(Zo(e))}let $a=85.051129;function sS(t){return Math.cos(Ai(ui(t,-$a,$a)))}function Zp(t,e){let n=ui(e,mR,gR),l=Math.pow(2,n);return sS(t)*db/(512*l)}function lS(t){return 1/Math.cos(t*Math.PI/180)}function L1(t,e=0){let n=Math.exp(Math.PI*(1-(t.y+e/it)/(1<<t.z)*2));return 80150034*n/(n*n+1)/it/(1<<t.z)}class ks{constructor(e,n,l=0){this.x=+e,this.y=+n,this.z=+l}static fromLngLat(e,n=0){let l=en.convert(e);return new ks(qh(l.lng),$h(l.lat),fl(n,l.lat))}toLngLat(){return new en(Nl(this.x),Zo(this.y))}toAltitude(){return oS(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/db*lS(Zo(this.y))}}function pb(t,e,n,l,h,f,p,v,y){let w=(e+l)/2,A=(n+h)/2,M=new hr(w,A);v(M),function(R,N,z,q,Z,oe){let ye=z-Z,be=q-oe;return Math.abs((q-N)*ye-(z-R)*be)/Math.hypot(ye,be)}(M.x,M.y,f.x,f.y,p.x,p.y)>=y?(pb(t,e,n,w,A,f,M,v,y),pb(t,w,A,l,h,M,p,v,y)):t.push(p)}function cS(t,e,n){let l=t[0],h=l.x,f=l.y;e(l);let p=[l];for(let v=1;v<t.length;v++){let y=t[v],{x:w,y:A}=y;e(y),pb(p,h,f,w,A,l,y,e,n),h=w,f=A,l=y}return p}function mb(t,e,n,l){if(l(e,n)){let h=e.add(n)._mult(.5);mb(t,e,h,l),mb(t,h,n,l)}else t.push(n)}function _R(t,e){let n=t[0],l=[n];for(let h=1;h<t.length;h++){let f=t[h];mb(l,n,f,e),n=f}return l}let gb=Math.pow(2,14)-1,uS=-gb-1;function vR(t,e){let n=Math.round(t.x*e),l=Math.round(t.y*e);return t.x=ui(n,uS,gb),t.y=ui(l,uS,gb),(n<t.x||n>t.x+1||l<t.y||l>t.y+1)&&Wn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function eh(t,e,n){let l=t.loadGeometry(),h=t.extent,f=it/h;if(e&&n&&n.projection.isReprojectedInTileSpace){let p=1<<e.z,{scale:v,x:y,y:w,projection:A}=n,M=R=>{let N=Nl((e.x+R.x/h)/p),z=Zo((e.y+R.y/h)/p),q=A.project(N,z);R.x=(q.x*v-y)*h,R.y=(q.y*v-w)*h};for(let R=0;R<l.length;R++)if(t.type!==1)l[R]=cS(l[R],M,1);else{let N=[];for(let z of l[R])z.x<0||z.x>=h||z.y<0||z.y>=h||(M(z),N.push(z));l[R]=N}}for(let p of l)for(let v of p)vR(v,f);return l}function Vd(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?eh(t):[]}}function O1(t,e,n,l,h){t.emplaceBack(2*e+(l+1)/2,2*n+(h+1)/2)}function N1(t,e,n){t.emplaceBack(e.x,e.y,e.z,n[0]*16384,n[1]*16384,n[2]*16384)}class _b{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.fqid),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Ju,this.indexArray=new No,this.segments=new ha,this.programConfigurations=new Uf(e.layers,{zoom:e.zoom,lut:e.lut}),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}updateFootprints(e,n){}populate(e,n,l,h){let f=this.layers[0],p=[],v=null;f.type==="circle"&&(v=f.layout.get("circle-sort-key"));for(let{feature:w,id:A,index:M,sourceLayerIndex:R}of e){let N=this.layers[0]._featureFilter.needGeometry,z=Vd(w,N);if(!this.layers[0]._featureFilter.filter(new ni(this.zoom),z,l))continue;let q=v?v.evaluate(z,{},l):void 0,Z={id:A,properties:w.properties,type:w.type,sourceLayerIndex:R,index:M,geometry:N?z.geometry:eh(w,l,h),patterns:{},sortKey:q};p.push(Z)}v&&p.sort((w,A)=>w.sortKey-A.sortKey);let y=null;h.projection.name==="globe"&&(this.globeExtVertexArray=new M1,y=h.projection);for(let w of p){let{geometry:A,index:M,sourceLayerIndex:R}=w,N=e[M].feature;this.addFeature(w,A,M,n.availableImages,l,y,n.brightness),n.featureIndex.insert(N,A,M,R,this.index)}}update(e,n,l,h,f){let p=Object.keys(e).length!==0;p&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,n,p?this.stateDependentLayers:this.layers,l,h,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,tR.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,rR.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,n,l,h,f,p,v){for(let y of n)for(let w of y){let A=w.x,M=w.y;if(A<0||A>=it||M<0||M>=it)continue;if(p){let z=p.projectTilePoint(A,M,f),q=p.upVector(f,A,M),Z=this.globeExtVertexArray;N1(Z,z,q),N1(Z,z,q),N1(Z,z,q),N1(Z,z,q)}let R=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),N=R.vertexLength;O1(this.layoutVertexArray,A,M,-1,-1),O1(this.layoutVertexArray,A,M,1,-1),O1(this.layoutVertexArray,A,M,1,1),O1(this.layoutVertexArray,A,M,-1,1),this.indexArray.emplaceBack(N,N+1,N+2),this.indexArray.emplaceBack(N,N+2,N+3),R.vertexLength+=4,R.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,{},h,f,v)}}function vb(t,e){for(let n=0;n<t.length;n++)if(Gf(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(Gf(t,e[n]))return!0;return!!yb(t,e)}function yR(t,e,n){return!!Gf(t,e)||!!xb(e,t,n)}function hS(t,e){if(t.length===1)return fS(e,t[0]);for(let n=0;n<e.length;n++){let l=e[n];for(let h=0;h<l.length;h++)if(Gf(t,l[h]))return!0}for(let n=0;n<t.length;n++)if(fS(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(yb(t,e[n]))return!0;return!1}function xR(t,e,n){if(t.length>1){if(yb(t,e))return!0;for(let l=0;l<e.length;l++)if(xb(e[l],t,n))return!0}for(let l=0;l<t.length;l++)if(xb(t[l],e,n))return!0;return!1}function yb(t,e){if(t.length===0||e.length===0)return!1;for(let n=0;n<t.length-1;n++){let l=t[n],h=t[n+1];for(let f=0;f<e.length-1;f++)if(bR(l,h,e[f],e[f+1]))return!0}return!1}function bR(t,e,n,l){return vs(t,n,l)!==vs(e,n,l)&&vs(t,e,n)!==vs(t,e,l)}function xb(t,e,n){let l=n*n;if(e.length===1)return t.distSqr(e[0])<l;for(let h=1;h<e.length;h++)if(dS(t,e[h-1],e[h])<l)return!0;return!1}function dS(t,e,n){let l=e.distSqr(n);if(l===0)return t.distSqr(e);let h=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/l;return t.distSqr(h<0?e:h>1?n:n.sub(e)._mult(h)._add(e))}function fS(t,e){let n,l,h,f=!1;for(let p=0;p<t.length;p++){n=t[p];for(let v=0,y=n.length-1;v<n.length;y=v++)l=n[v],h=n[y],l.y>e.y!=h.y>e.y&&e.x<(h.x-l.x)*(e.y-l.y)/(h.y-l.y)+l.x&&(f=!f)}return f}function Gf(t,e){let n=!1;for(let l=0,h=t.length-1;l<t.length;h=l++){let f=t[l],p=t[h];f.y>e.y!=p.y>e.y&&e.x<(p.x-f.x)*(e.y-f.y)/(p.y-f.y)+f.x&&(n=!n)}return n}function pS(t,e,n,l,h){for(let p of t)if(e<=p.x&&n<=p.y&&l>=p.x&&h>=p.y)return!0;let f=[new hr(e,n),new hr(e,h),new hr(l,h),new hr(l,n)];if(t.length>2){for(let p of f)if(Gf(t,p))return!0}for(let p=0;p<t.length-1;p++)if(wR(t[p],t[p+1],f))return!0;return!1}function wR(t,e,n){let l=n[0],h=n[2];if(t.x<l.x&&e.x<l.x||t.x>h.x&&e.x>h.x||t.y<l.y&&e.y<l.y||t.y>h.y&&e.y>h.y)return!1;let f=vs(t,e,n[0]);return f!==vs(t,e,n[1])||f!==vs(t,e,n[2])||f!==vs(t,e,n[3])}function Jm(t,e,n,l,h,f){let p=e.y-t.y,v=t.x-e.x;if(f=f||0){let y=p*p+v*v;if(y===0)return!0;let w=Math.sqrt(y);p/=w,v/=w}return!((n.x-t.x)*p+(n.y-t.y)*v-f<0||(l.x-t.x)*p+(l.y-t.y)*v-f<0||(h.x-t.x)*p+(h.y-t.y)*v-f<0)}function bb(t,e,n,l,h,f,p){return!(Jm(t,e,l,h,f,p)||Jm(e,n,l,h,f,p)||Jm(n,t,l,h,f,p)||Jm(l,h,t,e,n,p)||Jm(h,f,t,e,n,p)||Jm(f,l,t,e,n,p))}function Qm(t,e,n){let l=e.paint.get(t).value;return l.kind==="constant"?l.value:n.programConfigurations.get(e.id).getMaxValue(t)}function B1(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function mS(t,e,n,l,h){if(!e[0]&&!e[1])return t;let f=hr.convert(e)._mult(h);n==="viewport"&&f._rotate(-l);let p=[];for(let v=0;v<t.length;v++)p.push(t[v].sub(f));return p}function gS(t,e,n,l){let h=hr.convert(t)._mult(l);return e==="viewport"&&h._rotate(-n),h}Fe(_b,"CircleBucket",{omit:["layers"]});let TR=new un({"circle-sort-key":new _r(vt.layout_circle["circle-sort-key"]),visibility:new Ht(vt.layout_circle.visibility)});var SR={paint:new un({"circle-radius":new _r(vt.paint_circle["circle-radius"]),"circle-color":new _r(vt.paint_circle["circle-color"]),"circle-blur":new _r(vt.paint_circle["circle-blur"]),"circle-opacity":new _r(vt.paint_circle["circle-opacity"]),"circle-translate":new Ht(vt.paint_circle["circle-translate"]),"circle-translate-anchor":new Ht(vt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ht(vt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ht(vt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new _r(vt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new _r(vt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new _r(vt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Ht(vt.paint_circle["circle-emissive-strength"])}),layout:TR};class wb{constructor(e,n){this.pos=e,this.dir=n}intersectsPlane(e,n,l){let h=r._.dot(n,this.dir);if(Math.abs(h)<1e-6)return!1;let f=((e[0]-this.pos[0])*n[0]+(e[1]-this.pos[1])*n[1]+(e[2]-this.pos[2])*n[2])/h;return l[0]=this.pos[0]+this.dir[0]*f,l[1]=this.pos[1]+this.dir[1]*f,l[2]=this.pos[2]+this.dir[2]*f,!0}closestPointOnSphere(e,n,l){if(r._.equals(this.pos,e)||n===0)return l[0]=l[1]=l[2]=0,!1;let[h,f,p]=this.dir,v=this.pos[0]-e[0],y=this.pos[1]-e[1],w=this.pos[2]-e[2],A=h*h+f*f+p*p,M=2*(v*h+y*f+w*p),R=M*M-4*A*(v*v+y*y+w*w-n*n);if(R<0){let N=Math.max(-M/2,0),z=v+h*N,q=y+f*N,Z=w+p*N,oe=Math.hypot(z,q,Z);return l[0]=z*n/oe,l[1]=q*n/oe,l[2]=Z*n/oe,!1}{let N=(-M-Math.sqrt(R))/(2*A);if(N<0){let z=Math.hypot(v,y,w);return l[0]=v*n/z,l[1]=y*n/z,l[2]=w*n/z,!1}return l[0]=v+h*N,l[1]=y+f*N,l[2]=w+p*N,!0}}}class Tb{constructor(e,n,l,h,f){this.TL=e,this.TR=n,this.BR=l,this.BL=h,this.horizon=f}static fromInvProjectionMatrix(e,n,l){let h=[-1,1,1],f=[1,1,1],p=[1,-1,1],v=[-1,-1,1],y=r._.transformMat4(h,h,e),w=r._.transformMat4(f,f,e),A=r._.transformMat4(p,p,e),M=r._.transformMat4(v,v,e);return new Tb(y,w,A,M,n/l)}}function Mg(t,e,n){let l=1/0,h=-1/0,f=[];for(let p of t){r._.sub(f,p,e);let v=r._.dot(f,n);l=Math.min(l,v),h=Math.max(h,v)}return[l,h]}function _S(t,e){let n=!0;for(let l=0;l<t.planes.length;l++){let h=t.planes[l],f=0;for(let p=0;p<e.length;p++)f+=r._.dot(h,e[p])+h[3]>=0;if(f===0)return 0;f!==e.length&&(n=!1)}return n?2:1}function vS(t,e){for(let n of t.projections){let l=Mg(e,t.points[0],n.axis);if(n.projection[1]<l[0]||n.projection[0]>l[1])return 0}return 1}function yS(t,e){let n=0,l=[0,0,0,0];for(let h=0;h<t.length;h++)l[0]=t[h][0],l[1]=t[h][1],l[2]=t[h][2],l[3]=1,r.aA.dot(l,e)>=0&&n++;return n}class Sb{constructor(e,n){this.points=e||new Array(8).fill([0,0,0]),this.planes=n||new Array(6).fill([0,0,0,0]),this.bounds=da.fromPoints(this.points),this.projections=[],this.frustumEdges=[r._.sub([],this.points[2],this.points[3]),r._.sub([],this.points[0],this.points[3]),r._.sub([],this.points[4],this.points[0]),r._.sub([],this.points[5],this.points[1]),r._.sub([],this.points[6],this.points[2]),r._.sub([],this.points[7],this.points[3])];for(let l of this.frustumEdges){let h=[0,-l[2],l[1]],f=[l[2],0,-l[0]];this.projections.push({axis:h,projection:Mg(this.points,this.points[0],h)}),this.projections.push({axis:f,projection:Mg(this.points,this.points[0],f)})}}static fromInvProjectionMatrix(e,n,l,h){let f=Math.pow(2,l),p=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(w=>{let A=r.aA.transformMat4([],w,e),M=1/A[3]/n*f;return r.aA.mul(A,A,[M,M,h?1/A[3]:M,M])}),v=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(w=>{let A=r._.sub([],p[w[0]],p[w[1]]),M=r._.sub([],p[w[2]],p[w[1]]),R=r._.normalize([],r._.cross([],A,M)),N=-r._.dot(R,p[w[1]]);return R.concat(N)}),y=[];for(let w=0;w<p.length;w++)y.push([p[w][0],p[w][1],p[w][2]]);return new Sb(y,v)}intersectsPrecise(e,n,l){for(let h=0;h<n.length;h++)if(!yS(e,n[h]))return 0;for(let h=0;h<this.planes.length;h++)if(!yS(e,this.planes[h]))return 0;for(let h of l)for(let f of this.frustumEdges){let p=r._.cross([],h,f),v=r._.length(p);if(v===0)continue;r._.scale(p,p,1/v);let y=Mg(this.points,this.points[0],p),w=Mg(e,this.points[0],p);if(y[0]>w[1]||w[0]>y[1])return 0}return 1}}class da{static fromPoints(e){let n=[1/0,1/0,1/0],l=[-1/0,-1/0,-1/0];for(let h of e)r._.min(n,n,h),r._.max(l,l,h);return new da(n,l)}static fromTileIdAndHeight(e,n,l){let h=1<<e.canonical.z,f=e.canonical.x,p=e.canonical.y;return new da([f/h,p/h,n],[(f+1)/h,(p+1)/h,l])}static applyTransform(e,n){let l=e.getCorners();for(let h=0;h<l.length;++h)r._.transformMat4(l[h],l[h],n);return da.fromPoints(l)}static projectAabbCorners(e,n){let l=e.getCorners();for(let h=0;h<l.length;++h)r._.transformMat4(l[h],l[h],n);return l}constructor(e,n){this.min=e,this.max=n,this.center=r._.scale([],r._.add([],this.min,this.max),.5)}quadrant(e){let n=[e%2==0,e<2],l=r._.clone(this.min),h=r._.clone(this.max);for(let f=0;f<n.length;f++)l[f]=n[f]?this.min[f]:this.center[f],h[f]=n[f]?this.center[f]:this.max[f];return h[2]=this.max[2],new da(l,h)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){let e=this.min,n=this.max;return[[e[0],e[1],e[2]],[n[0],e[1],e[2]],[n[0],n[1],e[2]],[e[0],n[1],e[2]],[e[0],e[1],n[2]],[n[0],e[1],n[2]],[n[0],n[1],n[2]],[e[0],n[1],n[2]]]}intersects(e){return this.intersectsAabb(e.bounds)?_S(e,this.getCorners()):0}intersectsFlat(e){return this.intersectsAabb(e.bounds)?_S(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(e,n){return n||this.intersects(e)?vS(e,this.getCorners()):0}intersectsPreciseFlat(e,n){return n||this.intersectsFlat(e)?vS(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(e){for(let n=0;n<3;++n)if(this.min[n]>e.max[n]||e.min[n]>this.max[n])return!1;return!0}intersectsAabbXY(e){return!(this.min[0]>e.max[0]||e.min[0]>this.max[0]||this.min[1]>e.max[1]||e.min[1]>this.max[1])}encapsulate(e){for(let n=0;n<3;n++)this.min[n]=Math.min(this.min[n],e.min[n]),this.max[n]=Math.max(this.max[n],e.max[n])}encapsulatePoint(e){for(let n=0;n<3;n++)this.min[n]=Math.min(this.min[n],e[n]),this.max[n]=Math.max(this.max[n],e[n])}closestPoint(e){return[Math.max(Math.min(this.max[0],e[0]),this.min[0]),Math.max(Math.min(this.max[1],e[1]),this.min[1]),Math.max(Math.min(this.max[2],e[2]),this.min[2])]}}Fe(da,"Aabb");let ER=hn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:z1}=ER,xS=hn([{name:"a_pos_3",components:3,type:"Int16"}]);var Dg=hn([{name:"a_pos",type:"Int16",components:2}]);function j1(t){return t*dl/Km}let AR=[new da([mu,mu,mu],[gu,gu,gu]),new da([mu,mu,mu],[0,0,gu]),new da([0,mu,mu],[gu,0,gu]),new da([mu,0,mu],[0,gu,gu]),new da([0,0,mu],[gu,gu,gu])];function bS(t,e,n,l=!0){let h=r._.scale([],t._camera.position,t.worldSize),f=[e,n,1,1];r.aA.transformMat4(f,f,t.pixelMatrixInverse),r.aA.scale(f,f,1/f[3]);let p=r._.sub([],f,h),v=r._.normalize([],p),y=t.globeMatrix,w=[y[12],y[13],y[14]],A=r._.sub([],w,h),M=r._.length(A),R=r._.normalize([],A),N=t.worldSize/(2*Math.PI),z=r._.dot(R,v),q=Math.asin(N/M);if(q<Math.acos(z)){if(!l)return null;let At=[],zt=[];r._.scale(At,v,M/z),r._.normalize(zt,r._.sub(zt,At,A)),r._.normalize(v,r._.add(v,A,r._.scale(v,zt,Math.tan(q)*M)))}let Z=[];new wb(h,v).closestPointOnSphere(w,N,Z);let oe=r._.normalize([],Lt(y,0)),ye=r._.normalize([],Lt(y,1)),be=r._.normalize([],Lt(y,2)),we=r._.dot(oe,Z),$e=r._.dot(ye,Z),He=r._.dot(be,Z),rt=ka(Math.asin(-$e/N)),ot=ka(Math.atan2(we,He));ot=t.center.lng+function(At,zt){let Jt=(zt-At+180)%360-180;return Jt<-180?Jt+360:Jt}(t.center.lng,ot);let _t=qh(ot),Mt=ui($h(rt),0,1);return new ks(_t,Mt)}class CR{constructor(e,n,l){this.a=r._.sub([],e,l),this.b=r._.sub([],n,l),this.center=l;let h=r._.normalize([],this.a),f=r._.normalize([],this.b);this.angle=Math.acos(r._.dot(h,f))}}function Eb(t,e){if(t.angle===0)return null;let n;return n=t.a[e]===0?1/t.angle*.5*Math.PI:1/t.angle*Math.atan(t.b[e]/t.a[e]/Math.sin(t.angle)-1/Math.tan(t.angle)),n<0||n>1?null:function(l,h,f,p){let v=Math.sin(f);return l*(Math.sin((1-p)*f)/v)+h*(Math.sin(p*f)/v)}(t.a[e],t.b[e],t.angle,ui(n,0,1))+t.center[e]}function Xh(t){if(t.z<=1)return AR[t.z+2*t.y+t.x];let e=Ab(U1(t));return da.fromPoints(e)}function Gd(t,e,n){return r._.scale(t,t,1-n),r._.scaleAndAdd(t,t,e,n)}function wS(t,e){let n=Hd(e.zoom);if(n===0)return Xh(t);let l=U1(t),h=Ab(l),f=qh(l.getWest())*e.worldSize,p=qh(l.getEast())*e.worldSize,v=$h(l.getNorth())*e.worldSize,y=$h(l.getSouth())*e.worldSize,w=[f,v,0],A=[p,v,0],M=[f,y,0],R=[p,y,0],N=r.ad.invert([],e.globeMatrix);return r._.transformMat4(w,w,N),r._.transformMat4(A,A,N),r._.transformMat4(M,M,N),r._.transformMat4(R,R,N),h[0]=Gd(h[0],M,n),h[1]=Gd(h[1],R,n),h[2]=Gd(h[2],A,n),h[3]=Gd(h[3],w,n),da.fromPoints(h)}function TS(t,e,n){for(let l of t)r._.transformMat4(l,l,e),r._.scale(l,l,n)}function SS(t,e,n,l){let h=e/t.worldSize,f=t.globeMatrix;if(n.z<=1){let _t=Xh(n).getCorners();return TS(_t,f,h),da.fromPoints(_t)}let p=U1(n,l),v=Ab(p,dl+j1(t._tileCoverLift));TS(v,f,h);let y=Number.MAX_VALUE,w=[-y,-y,-y],A=[y,y,y];if(p.contains(t.center)){for(let At of v)r._.min(A,A,At),r._.max(w,w,At);w[2]=0;let _t=t.point,Mt=[_t.x*h,_t.y*h,0];return r._.min(A,A,Mt),r._.max(w,w,Mt),new da(A,w)}if(t._tileCoverLift>0){for(let _t of v)r._.min(A,A,_t),r._.max(w,w,_t);return new da(A,w)}let M=[f[12]*h,f[13]*h,f[14]*h],R=p.getCenter(),N=ui(t.center.lat,-$a,$a),z=ui(R.lat,-$a,$a),q=qh(t.center.lng),Z=$h(N),oe=q-qh(R.lng),ye=Z-$h(z);oe>.5?oe-=1:oe<-.5&&(oe+=1);let be=0;if(Math.abs(oe)>Math.abs(ye))be=oe>=0?1:3;else{be=ye>=0?0:2;let _t=[f[4]*h,f[5]*h,f[6]*h],Mt=-Math.sin(Ai(ye>=0?p.getSouth():p.getNorth()))*dl;r._.scaleAndAdd(M,M,_t,Mt)}let we=v[be],$e=v[(be+1)%4],He=new CR(we,$e,M),rt=[Eb(He,0)||we[0],Eb(He,1)||we[1],Eb(He,2)||we[2]],ot=Hd(t.zoom);if(ot>0){let _t=function({x:At,y:zt,z:Jt},Ot,Xt,Dt,Zt){let ir=1/(1<<Jt),Kt=At*ir,Sr=Kt+ir,er=zt*ir,lr=er+ir,Zr=0,zr=(Kt+Sr)/2-Dt;return zr>.5?Zr=-1:zr<-.5&&(Zr=1),Kt=((Kt+Zr)*Ot-(Dt*=Ot))*Xt+Dt,Sr=((Sr+Zr)*Ot-Dt)*Xt+Dt,er=(er*Ot-(Zt*=Ot))*Xt+Zt,lr=(lr*Ot-Zt)*Xt+Zt,[[Kt,lr,0],[Sr,lr,0],[Sr,er,0],[Kt,er,0]]}(n,e,t._pixelsPerMercatorPixel,q,Z);for(let At=0;At<v.length;At++)Gd(v[At],_t[At],ot);let Mt=r._.add([],_t[be],_t[(be+1)%4]);r._.scale(Mt,Mt,.5),Gd(rt,Mt,ot)}for(let _t of v)r._.min(A,A,_t),r._.max(w,w,_t);return A[2]=Math.min(we[2],$e[2]),r._.min(A,A,rt),r._.max(w,w,rt),new da(A,w)}function U1({x:t,y:e,z:n},l=!1){let h=1/(1<<n),f=new en(Nl(t*h),e===(1<<n)-1&&l?-90:Zo((e+1)*h)),p=new en(Nl((t+1)*h),e===0&&l?90:Zo(e*h));return new Vf(f,p)}function Ab(t,e=dl){let n=Ai(t.getNorth()),l=Ai(t.getSouth()),h=Math.cos(n),f=Math.cos(l),p=Math.sin(n),v=Math.sin(l),y=t.getWest(),w=t.getEast();return[Ym(f,v,y,e),Ym(f,v,w,e),Ym(h,p,w,e),Ym(h,p,y,e)]}function Rg(t,e,n,l){let h=1<<n.z,f=(t/it+n.x)/h;return $p(Zo((e/it+n.y)/h),Nl(f),l)}function V1({min:t,max:e}){return dR/Math.max(e[0]-t[0],e[1]-t[1],e[2]-t[2])}let ES=new Float64Array(16);function Fg(t){let e=V1(t),n=r.ad.fromScaling(ES,[e,e,e]);return r.ad.translate(n,n,r._.negate([],t.min))}function Cb(t){let e=r.ad.fromTranslation(ES,t.min),n=1/V1(t);return r.ad.scale(e,e,[n,n,n])}function Ib(t){let e=it/(2*Math.PI);return t/(2*Math.PI)/e}function AS(t,e){return it/(512*Math.pow(2,t))*V1(Xh(e))}function CS(t,e,n,l,h){let f=Ib(n),p=[t,e,-n/(2*Math.PI)],v=r.ad.identity(new Float64Array(16));return r.ad.translate(v,v,p),r.ad.scale(v,v,[f,f,f]),r.ad.rotateX(v,v,Ai(-h)),r.ad.rotateY(v,v,Ai(-l)),v}function Hd(t){return Wl(ub,iS,t)}function IS(t,e){let n=$p(e.lat,e.lng),l=function(f){let p=$p(f._center.lat,f._center.lng),v=r._.fromValues(0,1,0),y=r._.cross([],v,p),w=r.ad.fromRotation([],-f.angle,p);y=r._.transformMat4(y,y,w),r.ad.fromRotation(w,-f._pitch,y);let A=r._.normalize([],p);return r._.scale(A,A,j1(f.cameraToCenterDistance/f.pixelsPerMeter)),r._.transformMat4(A,A,w),r._.add([],p,A)}(t),h=r._.subtract([],l,n);return r._.angle(h,n)}function kb(t,e){return IS(t,e)>Math.PI/2*1.01}let kS=Ai(85),IR=Math.cos(kS),kR=Math.sin(kS),MR=r.ad.create(),MS=t=>{let e=[];return t.paint.get("circle-pitch-alignment")==="map"&&e.push("PITCH_WITH_MAP"),t.paint.get("circle-pitch-scale")==="map"&&e.push("SCALE_WITH_MAP"),e};function DS(t,e,n,l,h,f,p,v,y){if(f&&t.queryGeometry.isAboveHorizon)return!1;f&&(y*=t.pixelToTileUnitsFactor);let w=t.tileID.canonical,A=n.projection.upVectorScale(w,n.center.lat,n.worldSize).metersToTile;for(let M of e)for(let R of M){let N=R.add(v),z=h&&n.elevation?n.elevation.exaggeration()*h.getElevationAt(N.x,N.y,!0):0,q=n.projection.projectTilePoint(N.x,N.y,w);if(z>0){let be=n.projection.upVector(w,N.x,N.y);q.x+=be[0]*A*z,q.y+=be[1]*A*z,q.z+=be[2]*A*z}let Z=f?N:DR(q.x,q.y,q.z,l),oe=f?t.tilespaceRays.map(be=>FR(be,z)):t.queryGeometry.screenGeometry,ye=r.aA.transformMat4([],[q.x,q.y,q.z,1],l);if(!p&&f?y*=ye[3]/n.cameraToCenterDistance:p&&!f&&(y*=n.cameraToCenterDistance/ye[3]),f){let be=Zo((R.y/it+w.y)/(1<<w.z));y/=n.projection.pixelsPerMeter(be,1)/fl(1,be)}if(yR(oe,Z,y))return!0}return!1}function DR(t,e,n,l){let h=r.aA.transformMat4([],[t,e,n,1],l);return new hr(h[0]/h[3],h[1]/h[3])}let RS=r._.fromValues(0,0,0),RR=r._.fromValues(0,0,1);function FR(t,e){let n=r._.create();return RS[2]=e,t.intersectsPlane(RS,RR,n),new hr(n[0],n[1])}class FS extends _b{}function PS(t,{width:e,height:n},l,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==e*n*l)throw new RangeError("mismatched image size")}else h=new Uint8Array(e*n*l);return t.width=e,t.height=n,t.data=h,t}function LS(t,e,n){let{width:l,height:h}=e;l===t.width&&h===t.height||(Mb(t,e,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,l),height:Math.min(t.height,h)},n,null),t.width=l,t.height=h,t.data=e.data)}function Mb(t,e,n,l,h,f,p,v){if(h.width===0||h.height===0)return e;if(h.width>t.width||h.height>t.height||n.x>t.width-h.width||n.y>t.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>e.width||h.height>e.height||l.x>e.width-h.width||l.y>e.height-h.height)throw new RangeError("out of range destination coordinates for image copy");let y=t.data,w=e.data,A=f===4&&v;for(let M=0;M<h.height;M++){let R=((n.y+M)*t.width+n.x)*f,N=((l.y+M)*e.width+l.x)*f;if(A)for(let z=0;z<h.width;z++){let q=R+z*f+3,Z=N+z*f;w[Z+0]=255,w[Z+1]=255,w[Z+2]=255,w[Z+3]=y[q]}else if(p)for(let z=0;z<h.width;z++){let q=R+z*f,Z=N+z*f,oe=y[q+3],ye=new qi(y[q+0]/255*oe,y[q+1]/255*oe,y[q+2]/255*oe,oe).toRenderColor(p).toArray();w[Z+0]=ye[0],w[Z+1]=ye[1],w[Z+2]=ye[2],w[Z+3]=ye[3]}else for(let z=0;z<h.width*f;z++)w[N+z]=y[R+z]}return e}Fe(FS,"HeatmapBucket",{omit:["layers"]});class Hf{constructor(e,n){PS(this,e,1,n)}resize(e){LS(this,new Hf(e),1)}clone(){return new Hf({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,l,h,f){Mb(e,n,l,h,f,1,null)}}class zc{constructor(e,n){PS(this,e,4,n)}resize(e){LS(this,new zc(e),4)}replace(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new zc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,l,h,f,p,v){Mb(e,n,l,h,f,4,p,v)}}class OS{constructor(e,n){this.width=e.width,this.height=e.height,this.data=n instanceof Uint8Array?new Float32Array(n.buffer):n}}Fe(Hf,"AlphaImage"),Fe(zc,"RGBAImage");let PR=new un({visibility:new Ht(vt.layout_heatmap.visibility)});var LR={paint:new un({"heatmap-radius":new _r(vt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new _r(vt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ht(vt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ua(vt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ht(vt.paint_heatmap["heatmap-opacity"])}),layout:PR};function Pg(t){let e={},n=t.resolution||256,l=t.clips?t.clips.length:1,h=t.image||new zc({width:n,height:l}),f=(p,v,y)=>{e[t.evaluationKey]=y;let w=t.expression.evaluate(e);w&&(h.data[p+v+0]=Math.floor(255*w.r/w.a),h.data[p+v+1]=Math.floor(255*w.g/w.a),h.data[p+v+2]=Math.floor(255*w.b/w.a),h.data[p+v+3]=Math.floor(255*w.a))};if(t.clips)for(let p=0,v=0;p<l;++p,v+=4*n)for(let y=0,w=0;y<n;y++,w+=4){let A=y/(n-1),{start:M,end:R}=t.clips[p];f(v,w,M*(1-A)+R*A)}else for(let p=0,v=0;p<n;p++,v+=4)f(0,v,p/(n-1));return h}let OR=new un({visibility:new Ht(vt.layout_hillshade.visibility)});var NR={paint:new un({"hillshade-illumination-direction":new Ht(vt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ht(vt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ht(vt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ht(vt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ht(vt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ht(vt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Ht(vt.paint_hillshade["hillshade-emissive-strength"])}),layout:OR};let BR=hn([{name:"a_pos",components:2,type:"Int16"}],4),{members:zR}=BR;function Lg(t,e,n=2){let l=e&&e.length,h=l?e[0]*n:t.length,f=NS(t,0,h,n,!0),p=[];if(!f||f.next===f.prev)return p;let v,y,w;if(l&&(f=function(A,M,R,N){let z=[];for(let q=0,Z=M.length;q<Z;q++){let oe=NS(A,M[q]*N,q<Z-1?M[q+1]*N:A.length,N,!1);oe===oe.next&&(oe.steiner=!0),z.push($R(oe))}z.sort(HR);for(let q=0;q<z.length;q++)R=WR(z[q],R);return R}(t,e,f,n)),t.length>80*n){v=1/0,y=1/0;let A=-1/0,M=-1/0;for(let R=n;R<h;R+=n){let N=t[R],z=t[R+1];N<v&&(v=N),z<y&&(y=z),N>A&&(A=N),z>M&&(M=z)}w=Math.max(A-v,M-y),w=w!==0?32767/w:0}return Og(f,p,n,v,y,w,0),p}function NS(t,e,n,l,h){let f;if(h===function(p,v,y,w){let A=0;for(let M=v,R=y-w;M<y;M+=w)A+=(p[R]-p[M])*(p[M+1]+p[R+1]),R=M;return A}(t,e,n,l)>0)for(let p=e;p<n;p+=l)f=jS(p/l|0,t[p],t[p+1],f);else for(let p=n-l;p>=e;p-=l)f=jS(p/l|0,t[p],t[p+1],f);return f&&G1(f,f.next)&&(Bg(f),f=f.next),f}function Yp(t,e){if(!t)return t;e||(e=t);let n,l=t;do if(n=!1,l.steiner||!G1(l,l.next)&&To(l.prev,l,l.next)!==0)l=l.next;else{if(Bg(l),l=e=l.prev,l===l.next)break;n=!0}while(n||l!==e);return e}function Og(t,e,n,l,h,f,p){if(!t)return;!p&&f&&function(y,w,A,M){let R=y;do R.z===0&&(R.z=Db(R.x,R.y,w,A,M)),R.prevZ=R.prev,R.nextZ=R.next,R=R.next;while(R!==y);R.prevZ.nextZ=null,R.prevZ=null,function(N){let z,q=1;do{let Z,oe=N;N=null;let ye=null;for(z=0;oe;){z++;let be=oe,we=0;for(let He=0;He<q&&(we++,be=be.nextZ,be);He++);let $e=q;for(;we>0||$e>0&&be;)we!==0&&($e===0||!be||oe.z<=be.z)?(Z=oe,oe=oe.nextZ,we--):(Z=be,be=be.nextZ,$e--),ye?ye.nextZ=Z:N=Z,Z.prevZ=ye,ye=Z;oe=be}ye.nextZ=null,q*=2}while(z>1)}(R)}(t,l,h,f);let v=t;for(;t.prev!==t.next;){let y=t.prev,w=t.next;if(f?UR(t,l,h,f):jR(t))e.push(y.i,t.i,w.i),Bg(t),t=w.next,v=w.next;else if((t=w)===v){p?p===1?Og(t=VR(Yp(t),e),e,n,l,h,f,2):p===2&&GR(t,e,n,l,h,f):Og(Yp(t),e,n,l,h,f,1);break}}}function jR(t){let e=t.prev,n=t,l=t.next;if(To(e,n,l)>=0)return!1;let h=e.x,f=n.x,p=l.x,v=e.y,y=n.y,w=l.y,A=h<f?h<p?h:p:f<p?f:p,M=v<y?v<w?v:w:y<w?y:w,R=h>f?h>p?h:p:f>p?f:p,N=v>y?v>w?v:w:y>w?y:w,z=l.next;for(;z!==e;){if(z.x>=A&&z.x<=R&&z.y>=M&&z.y<=N&&e0(h,v,f,y,p,w,z.x,z.y)&&To(z.prev,z,z.next)>=0)return!1;z=z.next}return!0}function UR(t,e,n,l){let h=t.prev,f=t,p=t.next;if(To(h,f,p)>=0)return!1;let v=h.x,y=f.x,w=p.x,A=h.y,M=f.y,R=p.y,N=v<y?v<w?v:w:y<w?y:w,z=A<M?A<R?A:R:M<R?M:R,q=v>y?v>w?v:w:y>w?y:w,Z=A>M?A>R?A:R:M>R?M:R,oe=Db(N,z,e,n,l),ye=Db(q,Z,e,n,l),be=t.prevZ,we=t.nextZ;for(;be&&be.z>=oe&&we&&we.z<=ye;){if(be.x>=N&&be.x<=q&&be.y>=z&&be.y<=Z&&be!==h&&be!==p&&e0(v,A,y,M,w,R,be.x,be.y)&&To(be.prev,be,be.next)>=0||(be=be.prevZ,we.x>=N&&we.x<=q&&we.y>=z&&we.y<=Z&&we!==h&&we!==p&&e0(v,A,y,M,w,R,we.x,we.y)&&To(we.prev,we,we.next)>=0))return!1;we=we.nextZ}for(;be&&be.z>=oe;){if(be.x>=N&&be.x<=q&&be.y>=z&&be.y<=Z&&be!==h&&be!==p&&e0(v,A,y,M,w,R,be.x,be.y)&&To(be.prev,be,be.next)>=0)return!1;be=be.prevZ}for(;we&&we.z<=ye;){if(we.x>=N&&we.x<=q&&we.y>=z&&we.y<=Z&&we!==h&&we!==p&&e0(v,A,y,M,w,R,we.x,we.y)&&To(we.prev,we,we.next)>=0)return!1;we=we.nextZ}return!0}function VR(t,e){let n=t;do{let l=n.prev,h=n.next.next;!G1(l,h)&&BS(l,n,n.next,h)&&Ng(l,h)&&Ng(h,l)&&(e.push(l.i,n.i,h.i),Bg(n),Bg(n.next),n=t=h),n=n.next}while(n!==t);return Yp(n)}function GR(t,e,n,l,h,f){let p=t;do{let v=p.next.next;for(;v!==p.prev;){if(p.i!==v.i&&XR(p,v)){let y=zS(p,v);return p=Yp(p,p.next),y=Yp(y,y.next),Og(p,e,n,l,h,f,0),void Og(y,e,n,l,h,f,0)}v=v.next}p=p.next}while(p!==t)}function HR(t,e){return t.x-e.x}function WR(t,e){let n=function(h,f){let p=f,v=h.x,y=h.y,w,A=-1/0;do{if(y<=p.y&&y>=p.next.y&&p.next.y!==p.y){let q=p.x+(y-p.y)*(p.next.x-p.x)/(p.next.y-p.y);if(q<=v&&q>A&&(A=q,w=p.x<p.next.x?p:p.next,q===v))return w}p=p.next}while(p!==f);if(!w)return null;let M=w,R=w.x,N=w.y,z=1/0;p=w;do{if(v>=p.x&&p.x>=R&&v!==p.x&&e0(y<N?v:A,y,R,N,y<N?A:v,y,p.x,p.y)){let q=Math.abs(y-p.y)/(v-p.x);Ng(p,h)&&(q<z||q===z&&(p.x>w.x||p.x===w.x&&qR(w,p)))&&(w=p,z=q)}p=p.next}while(p!==M);return w}(t,e);if(!n)return e;let l=zS(n,t);return Yp(l,l.next),Yp(n,n.next)}function qR(t,e){return To(t.prev,t,e.prev)<0&&To(e.next,t,t.next)<0}function Db(t,e,n,l,h){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-l)*h|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function $R(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function e0(t,e,n,l,h,f,p,v){return(h-p)*(e-v)>=(t-p)*(f-v)&&(t-p)*(l-v)>=(n-p)*(e-v)&&(n-p)*(f-v)>=(h-p)*(l-v)}function XR(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(n,l){let h=n;do{if(h.i!==n.i&&h.next.i!==n.i&&h.i!==l.i&&h.next.i!==l.i&&BS(h,h.next,n,l))return!0;h=h.next}while(h!==n);return!1}(t,e)&&(Ng(t,e)&&Ng(e,t)&&function(n,l){let h=n,f=!1,p=(n.x+l.x)/2,v=(n.y+l.y)/2;do h.y>v!=h.next.y>v&&h.next.y!==h.y&&p<(h.next.x-h.x)*(v-h.y)/(h.next.y-h.y)+h.x&&(f=!f),h=h.next;while(h!==n);return f}(t,e)&&(To(t.prev,t,e.prev)||To(t,e.prev,e))||G1(t,e)&&To(t.prev,t,t.next)>0&&To(e.prev,e,e.next)>0)}function To(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function G1(t,e){return t.x===e.x&&t.y===e.y}function BS(t,e,n,l){let h=W1(To(t,e,n)),f=W1(To(t,e,l)),p=W1(To(n,l,t)),v=W1(To(n,l,e));return h!==f&&p!==v||!(h!==0||!H1(t,n,e))||!(f!==0||!H1(t,l,e))||!(p!==0||!H1(n,t,l))||!(v!==0||!H1(n,e,l))}function H1(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function W1(t){return t>0?1:t<0?-1:0}function Ng(t,e){return To(t.prev,t,t.next)<0?To(t,e,t.next)>=0&&To(t,t.prev,e)>=0:To(t,e,t.prev)<0||To(t,t.next,e)<0}function zS(t,e){let n=Rb(t.i,t.x,t.y),l=Rb(e.i,e.x,e.y),h=t.next,f=e.prev;return t.next=e,e.prev=t,n.next=h,h.prev=n,l.next=n,n.prev=l,f.next=l,l.prev=f,l}function jS(t,e,n,l){let h=Rb(t,e,n);return l?(h.next=l.next,h.prev=l,l.next.prev=h,l.next=h):(h.prev=h,h.next=h),h}function Bg(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Rb(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function q1(t,e){let n=t.length;if(n<=1)return[t];let l=[],h,f;for(let p=0;p<n;p++){let v=co(t[p]);v!==0&&(t[p].area=Math.abs(v),f===void 0&&(f=v<0),f===v<0?(h&&l.push(h),h=[t[p]]):h.push(t[p]))}if(h&&l.push(h),e>1)for(let p=0;p<l.length;p++)l[p].length<=e||(yg(l[p],e,1,l[p].length-1,ZR),l[p]=l[p].slice(0,e));return l}function ZR(t,e){return e.area-t.area}function Fb(t,e,n){let l=n.patternDependencies,h=!1;for(let f of e){let p=f.paint.get(`${t}-pattern`);p.isConstant()||(h=!0);let v=p.constantOr(null);v&&(h=!0,l[v]=!0)}return h}function Pb(t,e,n,l,h){let f=h.patternDependencies;for(let p of e){let v=p.paint.get(`${t}-pattern`).value;if(v.kind!=="constant"){let y=v.evaluate({zoom:l},n,{},h.availableImages);y=y&&y.name?y.name:y,f[y]=!0,n.patterns[p.id]=y}}return n}class $1{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.fqid),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ju,this.indexArray=new No,this.indexArray2=new zf,this.programConfigurations=new Uf(e.layers,{zoom:e.zoom,lut:e.lut}),this.segments=new ha,this.segments2=new ha,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.projection=e.projection}updateFootprints(e,n){}populate(e,n,l,h){this.hasPattern=Fb("fill",this.layers,n);let f=this.layers[0].layout.get("fill-sort-key"),p=[];for(let{feature:v,id:y,index:w,sourceLayerIndex:A}of e){let M=this.layers[0]._featureFilter.needGeometry,R=Vd(v,M);if(!this.layers[0]._featureFilter.filter(new ni(this.zoom),R,l))continue;let N=f?f.evaluate(R,{},l,n.availableImages):void 0,z={id:y,properties:v.properties,type:v.type,sourceLayerIndex:A,index:w,geometry:M?R.geometry:eh(v,l,h),patterns:{},sortKey:N};p.push(z)}f&&p.sort((v,y)=>v.sortKey-y.sortKey);for(let v of p){let{geometry:y,index:w,sourceLayerIndex:A}=v;if(this.hasPattern){let M=Pb("fill",this.layers,v,this.zoom,n);this.patternFeatures.push(M)}else this.addFeature(v,y,w,l,{},n.availableImages,n.brightness);n.featureIndex.insert(e[w].feature,y,w,A,this.index)}}update(e,n,l,h,f){let p=Object.keys(e).length!==0;p&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,n,p?this.stateDependentLayers:this.layers,l,h,f)}addFeatures(e,n,l,h,f,p){for(let v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,n,l,h,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,zR),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,n,l,h,f,p=[],v){for(let y of q1(n,500)){let w=0;for(let q of y)w+=q.length;let A=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray),M=A.vertexLength,R=[],N=[];for(let q of y){if(q.length===0)continue;q!==y[0]&&N.push(R.length/2);let Z=this.segments2.prepareSegment(q.length,this.layoutVertexArray,this.indexArray2),oe=Z.vertexLength;this.layoutVertexArray.emplaceBack(q[0].x,q[0].y),this.indexArray2.emplaceBack(oe+q.length-1,oe),R.push(q[0].x),R.push(q[0].y);for(let ye=1;ye<q.length;ye++)this.layoutVertexArray.emplaceBack(q[ye].x,q[ye].y),this.indexArray2.emplaceBack(oe+ye-1,oe+ye),R.push(q[ye].x),R.push(q[ye].y);Z.vertexLength+=q.length,Z.primitiveLength+=q.length}let z=Lg(R,N);for(let q=0;q<z.length;q+=3)this.indexArray.emplaceBack(M+z[q],M+z[q+1],M+z[q+2]);A.vertexLength+=w,A.primitiveLength+=z.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,f,p,h,v)}}Fe($1,"FillBucket",{omit:["layers","patternFeatures"]});let YR=new un({"fill-sort-key":new _r(vt.layout_fill["fill-sort-key"]),visibility:new Ht(vt.layout_fill.visibility)});var KR={paint:new un({"fill-antialias":new Ht(vt.paint_fill["fill-antialias"]),"fill-opacity":new _r(vt.paint_fill["fill-opacity"]),"fill-color":new _r(vt.paint_fill["fill-color"]),"fill-outline-color":new _r(vt.paint_fill["fill-outline-color"]),"fill-translate":new Ht(vt.paint_fill["fill-translate"]),"fill-translate-anchor":new Ht(vt.paint_fill["fill-translate-anchor"]),"fill-pattern":new _r(vt.paint_fill["fill-pattern"]),"fill-emissive-strength":new Ht(vt.paint_fill["fill-emissive-strength"])}),layout:YR};class Lb{constructor(e,n,l,h){if(this.triangleCount=n.length/3,this.min=new hr(0,0),this.max=new hr(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||e.length===0)return;let[f,p]=[e[0].clone(),e[0].clone()];for(let M=1;M<e.length;++M){let R=e[M];f.x=Math.min(f.x,R.x),f.y=Math.min(f.y,R.y),p.x=Math.max(p.x,R.x),p.y=Math.max(p.y,R.y)}if(h){let M=Math.ceil(Math.max(p.x-f.x,p.y-f.y)/h);l=Math.max(l,M)}if(l===0)return;this.min=f,this.max=p;let v=this.max.sub(this.min);v.x=Math.max(v.x,1),v.y=Math.max(v.y,1);let y=Math.max(v.x,v.y)/l;this.cellsX=Math.max(1,Math.ceil(v.x/y)),this.cellsY=Math.max(1,Math.ceil(v.y/y)),this.xScale=1/y,this.yScale=1/y;let w=[];for(let M=0;M<this.triangleCount;M++){let R=e[n[3*M+0]].sub(this.min),N=e[n[3*M+1]].sub(this.min),z=e[n[3*M+2]].sub(this.min),q=Zh(Math.floor(Math.min(R.x,N.x,z.x)),this.xScale,this.cellsX),Z=Zh(Math.floor(Math.max(R.x,N.x,z.x)),this.xScale,this.cellsX),oe=Zh(Math.floor(Math.min(R.y,N.y,z.y)),this.yScale,this.cellsY),ye=Zh(Math.floor(Math.max(R.y,N.y,z.y)),this.yScale,this.cellsY),be=new hr(0,0),we=new hr(0,0),$e=new hr(0,0),He=new hr(0,0);for(let rt=oe;rt<=ye;++rt){be.y=we.y=rt*y,$e.y=He.y=(rt+1)*y;for(let ot=q;ot<=Z;++ot)be.x=$e.x=ot*y,we.x=He.x=(ot+1)*y,(bb(R,N,z,be,we,He)||bb(R,N,z,be,He,$e))&&w.push({cellIdx:rt*this.cellsX+ot,triIdx:M})}}if(w.length===0)return;w.sort((M,R)=>M.cellIdx-R.cellIdx||M.triIdx-R.triIdx);let A=0;for(;A<w.length;){let M=w[A].cellIdx,R={start:this.payload.length,len:0};for(;A<w.length&&w[A].cellIdx===M;)++R.len,this.payload.push(w[A++].triIdx);this.cells[M]=R}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(e,n){if(this.triangleCount===0||this.cells.length===0||e.x>this.max.x||this.min.x>e.x||e.y>this.max.y||this.min.y>e.y)return;let l=Zh(e.x-this.min.x,this.xScale,this.cellsX),h=Zh(e.y-this.min.y,this.yScale,this.cellsY),f=this.cells[h*this.cellsX+l];if(f){this._lazyInitLookup();for(let p=0;p<f.len;p++){let v=this.payload[f.start+p],y=Math.floor(v/8),w=1<<v%8;if(!(this.lookup[y]&w)&&(this.lookup[y]|=w,n.push(v),n.length===this.triangleCount))return}}}query(e,n,l){if(this.triangleCount===0||this.cells.length===0||e.x>this.max.x||this.min.x>n.x||e.y>this.max.y||this.min.y>n.y)return;this._lazyInitLookup();let h=Zh(e.x-this.min.x,this.xScale,this.cellsX),f=Zh(n.x-this.min.x,this.xScale,this.cellsX),p=Zh(e.y-this.min.y,this.yScale,this.cellsY),v=Zh(n.y-this.min.y,this.yScale,this.cellsY);for(let y=p;y<=v;y++)for(let w=h;w<=f;w++){let A=this.cells[y*this.cellsX+w];if(A)for(let M=0;M<A.len;M++){let R=this.payload[A.start+M],N=Math.floor(R/8),z=1<<R%8;if(!(this.lookup[N]&z)&&(this.lookup[N]|=z,l.push(R),l.length===this.triangleCount))return}}}}function Zh(t,e,n){return Math.max(0,Math.min(n-1,Math.floor(t*e)))}Fe(Lb,"TriangleGridIndex");class US{constructor(e){this.zoom=e.zoom,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.fqid),this.index=e.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.footprints=[]}updateFootprints(e,n){for(let l of this.footprints)n.push({footprint:l,id:e})}populate(e,n,l,h){let f=[];for(let{feature:p,id:v,index:y,sourceLayerIndex:w}of e){let A=this.layers[0]._featureFilter.needGeometry,M=Vd(p,A);if(!this.layers[0]._featureFilter.filter(new ni(this.zoom),M,l))continue;let R={id:v,properties:p.properties,type:p.type,sourceLayerIndex:w,index:y,geometry:A?M.geometry:eh(p,l,h),patterns:{}};f.push(R)}for(let p of f){let{geometry:v,index:y,sourceLayerIndex:w}=p;this.addFeature(p,v,y,l,{},n.availableImages,n.brightness),n.featureIndex.insert(e[y].feature,v,y,w,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(e){}update(e,n,l,h,f){}destroy(){}addFeature(e,n,l,h,f,p=[],v){for(let y of q1(n,2)){let w=[],A=[],M=[],R=new hr(1/0,1/0),N=new hr(-1/0,-1/0);for(let Z of y)if(Z.length!==0){Z!==y[0]&&M.push(A.length/2);for(let oe=0;oe<Z.length;oe++)A.push(Z[oe].x),A.push(Z[oe].y),w.push(Z[oe]),R.x=Math.min(R.x,Z[oe].x),R.y=Math.min(R.y,Z[oe].y),N.x=Math.max(N.x,Z[oe].x),N.y=Math.max(N.y,Z[oe].y)}let z=Lg(A,M),q=new Lb(w,z,8,256);this.footprints.push({vertices:w,indices:z,grid:q,min:R,max:N})}}}Fe(US,"ClipBucket",{omit:["layers"]});let JR=new un({"clip-layer-types":new Ht(vt.layout_clip["clip-layer-types"])});var QR={paint:new un({}),layout:JR};let eF=hn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),tF=hn([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),rF=hn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),iF=hn([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),nF=hn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:aF}=eF;var X1={},oF=Kc,VS=t0;function t0(t,e,n,l,h){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=l,this._values=h,t.readFields(sF,this,e)}function sF(t,e,n){t==1?e.id=n.readVarint():t==2?function(l,h){for(var f=l.readVarint()+l.pos;l.pos<f;){var p=h._keys[l.readVarint()],v=h._values[l.readVarint()];h.properties[p]=v}}(n,e):t==3?e.type=n.readVarint():t==4&&(e._geometry=n.pos)}function lF(t){for(var e,n,l=0,h=0,f=t.length,p=f-1;h<f;p=h++)l+=((n=t[p]).x-(e=t[h]).x)*(e.y+n.y);return l}t0.types=["Unknown","Point","LineString","Polygon"],t0.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,l=1,h=0,f=0,p=0,v=[];t.pos<n;){if(h<=0){var y=t.readVarint();l=7&y,h=y>>3}if(h--,l===1||l===2)f+=t.readSVarint(),p+=t.readSVarint(),l===1&&(e&&v.push(e),e=[]),e.push(new oF(f,p));else{if(l!==7)throw new Error("unknown command "+l);e&&e.push(e[0].clone())}}return e&&v.push(e),v},t0.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,l=0,h=0,f=0,p=1/0,v=-1/0,y=1/0,w=-1/0;t.pos<e;){if(l<=0){var A=t.readVarint();n=7&A,l=A>>3}if(l--,n===1||n===2)(h+=t.readSVarint())<p&&(p=h),h>v&&(v=h),(f+=t.readSVarint())<y&&(y=f),f>w&&(w=f);else if(n!==7)throw new Error("unknown command "+n)}return[p,y,v,w]},t0.prototype.toGeoJSON=function(t,e,n){var l,h,f=this.extent*Math.pow(2,n),p=this.extent*t,v=this.extent*e,y=this.loadGeometry(),w=t0.types[this.type];function A(N){for(var z=0;z<N.length;z++){var q=N[z];N[z]=[360*(q.x+p)/f-180,360/Math.PI*Math.atan(Math.exp((180-360*(q.y+v)/f)*Math.PI/180))-90]}}switch(this.type){case 1:var M=[];for(l=0;l<y.length;l++)M[l]=y[l][0];A(y=M);break;case 2:for(l=0;l<y.length;l++)A(y[l]);break;case 3:for(y=function(N){var z=N.length;if(z<=1)return[N];for(var q,Z,oe=[],ye=0;ye<z;ye++){var be=lF(N[ye]);be!==0&&(Z===void 0&&(Z=be<0),Z===be<0?(q&&oe.push(q),q=[N[ye]]):q.push(N[ye]))}return q&&oe.push(q),oe}(y),l=0;l<y.length;l++)for(h=0;h<y[l].length;h++)A(y[l][h])}y.length===1?y=y[0]:w="Multi"+w;var R={type:"Feature",geometry:{type:w,coordinates:y},properties:this.properties};return"id"in this&&(R.id=this.id),R};var cF=VS,GS=HS;function HS(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(uF,this,e),this.length=this._features.length}function uF(t,e,n){t===15?e.version=n.readVarint():t===1?e.name=n.readString():t===5?e.extent=n.readVarint():t===2?e._features.push(n.pos):t===3?e._keys.push(n.readString()):t===4&&e._values.push(function(l){for(var h=null,f=l.readVarint()+l.pos;l.pos<f;){var p=l.readVarint()>>3;h=p===1?l.readString():p===2?l.readFloat():p===3?l.readDouble():p===4?l.readVarint64():p===5?l.readVarint():p===6?l.readSVarint():p===7?l.readBoolean():null}return h}(n))}HS.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new cF(this._pbf,e,this.extent,this._keys,this._values)};var hF=GS;function dF(t,e,n){if(t===3){var l=new hF(n,n.readVarint()+n.pos);l.length&&(e[l.name]=l)}}var Ob=X1.VectorTile=function(t,e){this.layers=t.readFields(dF,{},e)},Z1=X1.VectorTileFeature=VS;X1.VectorTileLayer=GS;class Kp extends hr{constructor(e,n,l){super(e,n),this.z=l}}class WS extends Kp{constructor(e,n,l,h){super(e,n,l),this.w=h}}function Y1(t,e,n,l){let h=[],f=l===0?(p,v,y,w,A,M)=>{p.push(new hr(M,y+(M-v)/(w-v)*(A-y)))}:(p,v,y,w,A,M)=>{p.push(new hr(v+(M-y)/(A-y)*(w-v),M))};for(let p of t){let v=[];for(let y of p){if(y.length<=2)continue;let w=[];for(let R=0;R<y.length-1;R++){let N=y[R].x,z=y[R].y,q=y[R+1].x,Z=y[R+1].y,oe=l===0?N:z,ye=l===0?q:Z;oe<e?ye>e&&f(w,N,z,q,Z,e):oe>n?ye<n&&f(w,N,z,q,Z,n):w.push(y[R]),ye<e&&oe>=e&&f(w,N,z,q,Z,e),ye>n&&oe<=n&&f(w,N,z,q,Z,n)}let A=y[y.length-1],M=l===0?A.x:A.y;M>=e&&M<=n&&w.push(A),w.length&&(A=w[w.length-1],w[0].x===A.x&&w[0].y===A.y||w.push(w[0]),v.push(w))}v.length&&h.push(v)}return h}function qS(t,e,n,l){let h=n==="x"?"y":"x",f=(l-t[n])/(e[n]-t[n]);t[h]=t[h]+(e[h]-t[h])*f,t[n]=l,t.hasOwnProperty("z")&&(t.z=Xr(t.z,e.z,f)),t.hasOwnProperty("w")&&(t.w=Xr(t.w,e.w,f))}function $S(t,e,n,l){let h=n,f=l;for(let p of["x","y"]){let v=t,y=e;v[p]>=y[p]&&(v=e,y=t),v[p]<h&&y[p]>h&&qS(v,y,p,h),v[p]<f&&y[p]>f&&qS(y,v,p,f)}}function K1(t,e){return t.x-e.x||t.y-e.y}function XS(t,e){return K1(t.min,e.min)===0&&K1(t.max,e.max)===0}function Nb(t,e){return!(t.min.x>e.max.x||t.max.x<e.min.x||t.min.y>e.max.y||t.max.y<e.min.y)}function Bb(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n].sourceId!==e[n].sourceId||!XS(t[n],e[n])||t[n].order!==e[n].order||t[n].clipMask!==e[n].clipMask)return!1;return!0}function ZS(t,e,n){let l=1/it,h=1/(1<<n.canonical.z),f=(e.x*l+n.canonical.x)*h+n.wrap,p=(e.y*l+n.canonical.y)*h;return{min:new hr((t.x*l+n.canonical.x)*h+n.wrap,(t.y*l+n.canonical.y)*h),max:new hr(f,p)}}function fF(t,e,n){let l=1<<n.canonical.z,h=((e.x-n.wrap)*l-n.canonical.x)*it,f=(e.y*l-n.canonical.y)*it;return{min:new hr(((t.x-n.wrap)*l-n.canonical.x)*it,(t.y*l-n.canonical.y)*it),max:new hr(h,f)}}function YS(t,e,n,l,h,f,p){let v=t.indices,y=t.vertices,w=[];for(let A=l;A<l+h;A+=3){let M=e[n[A+0]+f],R=e[n[A+1]+f],N=e[n[A+2]+f],z=Math.min(M.x,R.x,N.x),q=Math.max(M.x,R.x,N.x),Z=Math.min(M.y,R.y,N.y),oe=Math.max(M.y,R.y,N.y);w.length=0,t.grid.query(new hr(z,Z),new hr(q,oe),w);for(let ye=0;ye<w.length;ye++){let be=w[ye];if(bb(y[v[3*be+0]],y[v[3*be+1]],y[v[3*be+2]],M,R,N,p))return!0}}return!1}function KS(t,e,n,l){if(!t||!n)return!1;let h=t.vertices;if(!e.canonical.equals(l.canonical)||e.wrap!==l.wrap){if(n.vertices.length<t.vertices.length)return KS(n,l,t,e);let f=e.canonical,p=l.canonical,v=Math.pow(2,p.z-f.z);h=t.vertices.map(y=>new hr((y.x+f.x*it)*v-p.x*it,(y.y+f.y*it)*v-p.y*it))}return YS(n,h,t.indices,0,t.indices.length,0,0)}function JS(t,e,n,l){let h=Math.pow(2,l.z-n.z);return new hr((t+n.x*it)*h-l.x*it,(e+n.y*it)*h-l.y*it)}function QS(t,e){let n=[];e.footprint.grid.queryPoint(t,n);let l=e.footprint.indices,h=e.footprint.vertices;for(let f=0;f<n.length;f++){let p=n[f];if(Gf([h[l[3*p+0]],h[l[3*p+1]],h[l[3*p+2]]],t))return!0}return!1}class eE{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,n){let l=this.toIdx(e,n);return{min:this.minimums[l],max:this.maximums[l]}}isLeaf(e,n){return this.leaves[this.toIdx(e,n)]}toIdx(e,n){return n*this.size+e}}function tE(t,e,n,l){let h=0,f=Number.MAX_VALUE;for(let p=0;p<3;p++)if(Math.abs(l[p])<1e-15){if(n[p]<t[p]||n[p]>e[p])return null}else{let v=1/l[p],y=(t[p]-n[p])*v,w=(e[p]-n[p])*v;if(y>w){let A=y;y=w,w=A}if(y>h&&(h=y),w<f&&(f=w),h>f)return null}return h}function rE(t,e,n,l,h,f,p,v,y,w,A){let M=l-t,R=h-e,N=f-n,z=p-t,q=v-e,Z=y-n,oe=A[1]*Z-A[2]*q,ye=A[2]*z-A[0]*Z,be=A[0]*q-A[1]*z,we=M*oe+R*ye+N*be;if(Math.abs(we)<1e-15)return null;let $e=1/we,He=w[0]-t,rt=w[1]-e,ot=w[2]-n,_t=(He*oe+rt*ye+ot*be)*$e;if(_t<0||_t>1)return null;let Mt=rt*N-ot*R,At=ot*M-He*N,zt=He*R-rt*M,Jt=(A[0]*Mt+A[1]*At+A[2]*zt)*$e;return Jt<0||_t+Jt>1?null:(z*Mt+q*At+Z*zt)*$e}function iE(t,e,n){return(t-e)/(n-e)}function nE(t,e,n,l,h,f,p,v,y){let w=1<<n,A=f-l,M=p-h,R=(t+1)/w*A+l,N=(e+0)/w*M+h,z=(e+1)/w*M+h;v[0]=(t+0)/w*A+l,v[1]=N,y[0]=R,y[1]=z}class aE{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;let n=function(f){let p=Math.ceil(Math.log2(f.dim/8)),v=[],y=Math.ceil(Math.pow(2,p)),w=1/y,A=(N,z,q,Z,oe)=>{let ye=Z?1:0,be=(N+1)*q-ye,we=z*q,$e=(z+1)*q-ye;oe[0]=N*q,oe[1]=we,oe[2]=be,oe[3]=$e},M=new eE(y),R=[];for(let N=0;N<y*y;N++){A(N%y,Math.floor(N/y),w,!1,R);let z=Wf(R[0],R[1],f),q=Wf(R[2],R[1],f),Z=Wf(R[2],R[3],f),oe=Wf(R[0],R[3],f);M.minimums.push(Math.min(z,q,Z,oe)),M.maximums.push(Math.max(z,q,Z,oe)),M.leaves.push(1)}for(v.push(M),y/=2;y>=1;y/=2){let N=v[v.length-1];M=new eE(y);for(let z=0;z<y*y;z++){A(z%y,Math.floor(z/y),2,!0,R);let q=N.getElevation(R[0],R[1]),Z=N.getElevation(R[2],R[1]),oe=N.getElevation(R[2],R[3]),ye=N.getElevation(R[0],R[3]),be=N.isLeaf(R[0],R[1]),we=N.isLeaf(R[2],R[1]),$e=N.isLeaf(R[2],R[3]),He=N.isLeaf(R[0],R[3]),rt=Math.min(q.min,Z.min,oe.min,ye.min),ot=Math.max(q.max,Z.max,oe.max,ye.max),_t=be&&we&&$e&&He;M.maximums.push(ot),M.minimums.push(rt),M.leaves.push(ot-rt<=5&&_t?1:0)}v.push(M)}return v}(this.dem),l=n.length-1,h=n[l];this._addNode(h.minimums[0],h.maximums[0],h.leaves[0]),this._construct(n,0,0,l,0)}raycastRoot(e,n,l,h,f,p,v=1){return tE([e,n,-100],[l,h,this.maximums[0]*v],f,p)}raycast(e,n,l,h,f,p,v=1){if(!this.nodeCount)return null;let y=this.raycastRoot(e,n,l,h,f,p,v);if(y==null)return null;let w=[],A=[],M=[],R=[],N=[{idx:0,t:y,nodex:0,nodey:0,depth:0}];for(;N.length>0;){let{idx:z,t:q,nodex:Z,nodey:oe,depth:ye}=N.pop();if(this.leaves[z]){nE(Z,oe,ye,e,n,l,h,M,R);let we=1<<ye,$e=(Z+0)/we,He=(Z+1)/we,rt=(oe+0)/we,ot=(oe+1)/we,_t=Wf($e,rt,this.dem)*v,Mt=Wf(He,rt,this.dem)*v,At=Wf(He,ot,this.dem)*v,zt=Wf($e,ot,this.dem)*v,Jt=rE(M[0],M[1],_t,R[0],M[1],Mt,R[0],R[1],At,f,p),Ot=rE(R[0],R[1],At,M[0],R[1],zt,M[0],M[1],_t,f,p),Xt=Math.min(Jt!==null?Jt:Number.MAX_VALUE,Ot!==null?Ot:Number.MAX_VALUE);if(Xt!==Number.MAX_VALUE)return Xt;{let Dt=r._.scaleAndAdd([],f,p,q);if(oE(_t,Mt,zt,At,iE(Dt[0],M[0],R[0]),iE(Dt[1],M[1],R[1]))>=Dt[2])return q}continue}let be=0;for(let we=0;we<this._siblingOffset.length;we++){nE((Z<<1)+this._siblingOffset[we][0],(oe<<1)+this._siblingOffset[we][1],ye+1,e,n,l,h,M,R),M[2]=-100,R[2]=this.maximums[this.childOffsets[z]+we]*v;let $e=tE(M,R,f,p);if($e!=null){let He=$e;w[we]=He;let rt=!1;for(let ot=0;ot<be&&!rt;ot++)He>=w[A[ot]]&&(A.splice(ot,0,we),rt=!0);rt||(A[be]=we),be++}}for(let we=0;we<be;we++){let $e=A[we];N.push({idx:this.childOffsets[z]+$e,t:w[$e],nodex:(Z<<1)+this._siblingOffset[$e][0],nodey:(oe<<1)+this._siblingOffset[$e][1],depth:ye+1})}}return null}_addNode(e,n,l){return this.minimums.push(e),this.maximums.push(n),this.leaves.push(l),this.childOffsets.push(0),this.nodeCount++}_construct(e,n,l,h,f){if(e[h].isLeaf(n,l)===1)return;this.childOffsets[f]||(this.childOffsets[f]=this.nodeCount);let p=h-1,v=e[p],y=0,w=0;for(let A=0;A<this._siblingOffset.length;A++){let M=2*n+this._siblingOffset[A][0],R=2*l+this._siblingOffset[A][1],N=v.getElevation(M,R),z=v.isLeaf(M,R),q=this._addNode(N.min,N.max,z);z&&(y|=1<<A),w||(w=q)}for(let A=0;A<this._siblingOffset.length;A++)y&1<<A||this._construct(e,2*n+this._siblingOffset[A][0],2*l+this._siblingOffset[A][1],p,w+A)}}function oE(t,e,n,l,h,f){return Xr(Xr(t,n,f),Xr(e,l,f),h)}function Wf(t,e,n){let l=n.dim,h=ui(t*l-.5,0,l-1),f=ui(e*l-.5,0,l-1),p=Math.floor(h),v=Math.floor(f),y=Math.min(p+1,l-1),w=Math.min(v+1,l-1);return oE(n.get(p,v),n.get(y,v),n.get(p,w),n.get(y,w),h-p,f-v)}let pF={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function mF(t,e,n){return(256*t*256+256*e+n)/10-1e4}function gF(t,e,n){return 256*t+e+n/256-32768}class J1{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,n,l,h=!1){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(l&&l!=="mapbox"&&l!=="terrarium")return Wn(`"${l}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=n.height;let f=this.dim=n.height-2,p=new Uint32Array(n.data.buffer);if(this.pixels=new Uint8Array(n.data.buffer),this.floatView=new Float32Array(n.data.buffer),this.borderReady=h,this._modifiedForSources={},!h){for(let y=0;y<f;y++)p[this._idx(-1,y)]=p[this._idx(0,y)],p[this._idx(f,y)]=p[this._idx(f-1,y)],p[this._idx(y,-1)]=p[this._idx(y,0)],p[this._idx(y,f)]=p[this._idx(y,f-1)];p[this._idx(-1,-1)]=p[this._idx(0,0)],p[this._idx(f,-1)]=p[this._idx(f-1,0)],p[this._idx(-1,f)]=p[this._idx(0,f-1)],p[this._idx(f,f)]=p[this._idx(f-1,f-1)]}let v=l==="terrarium"?gF:mF;for(let y=0;y<p.length;++y){let w=4*y;this.floatView[y]=v(this.pixels[w],this.pixels[w+1],this.pixels[w+2])}this._timestamp=di.now()}_buildQuadTree(){this._tree=new aE(this)}get(e,n,l=!1){l&&(e=ui(e,-1,this.dim),n=ui(n,-1,this.dim));let h=this._idx(e,n);return this.floatView[h]}set(e,n,l){let h=this._idx(e,n),f=this.floatView[h];return this.floatView[h]=l,l-f}static getUnpackVector(e){return pF[e]}_idx(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(e+1)}static pack(e,n){let l=[0,0,0,0],h=J1.getUnpackVector(n),f=Math.floor((e+h[3])/h[2]);return l[2]=f%256,f=Math.floor(f/256),l[1]=f%256,f=Math.floor(f/256),l[0]=f,l}getPixels(){return new OS({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,n,l){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let h=n*this.dim,f=n*this.dim+this.dim,p=l*this.dim,v=l*this.dim+this.dim;switch(n){case-1:h=f-1;break;case 1:f=h+1}switch(l){case-1:p=v-1;break;case 1:v=p+1}let y=-n*this.dim,w=-l*this.dim;for(let A=p;A<v;A++)for(let M=h;M<f;M++){let R=4*this._idx(M,A),N=4*this._idx(M+y,A+w);this.pixels[R+0]=e.pixels[N+0],this.pixels[R+1]=e.pixels[N+1],this.pixels[R+2]=e.pixels[N+2],this.pixels[R+3]=e.pixels[N+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Fe(J1,"DEMData"),Fe(aE,"DemMinMaxQuadTree",{omit:["dem"]});class r0{constructor(e,n,l){this._demTile=e,this._dem=this._demTile.dem,this._scale=n,this._offset=l}static create(e,n,l){let h=l||e.findDEMTileFor(n);if(!h||!h.dem)return;let f=h.dem,p=h.tileID,v=1<<n.canonical.z-p.canonical.z;return new r0(h,f.dim/it/v,[(n.canonical.x/v-p.canonical.x)*f.dim,(n.canonical.y/v-p.canonical.y)*f.dim])}tileCoordToPixel(e,n){let l=n*this._scale+this._offset[1],h=Math.floor(e*this._scale+this._offset[0]),f=Math.floor(l);return new hr(h,f)}getElevationAt(e,n,l,h){let f=e*this._scale+this._offset[0],p=n*this._scale+this._offset[1],v=Math.floor(f),y=Math.floor(p),w=this._dem;return h=!!h,l?Xr(Xr(w.get(v,y,h),w.get(v,y+1,h),p-y),Xr(w.get(v+1,y,h),w.get(v+1,y+1,h),p-y),f-v):w.get(v,y,h)}getElevationAtPixel(e,n,l){return this._dem.get(e,n,!!l)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*fl(1,e)*this._dem.stride}}let sE={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7},_F=Z1.types,vF=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],yF=["fill-extrusion-flood-light-ground-radius"],xF=Math.pow(2,13),bF=Math.pow(2,15)-1,lE=new hr(0,1),qf=2147483648;function zg(t,e,n,l,h,f,p,v){t.emplaceBack((e<<1)+p,(n<<1)+f,(Math.floor(l*xF)<<1)+h,Math.round(v))}function Q1(t,e,n,l,h,f){t.emplaceBack(e.x,e.y,(n.x<<1)+l,(n.y<<1)+h,f)}function jg(t,e,n){t.emplaceBack(e.x,e.y,e.z,n[0]*16384,n[1]*16384,n[2]*16384)}class cE{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class uE{constructor(){this.centroidXY=new hr(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new hr(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new hr(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new hr(this.max.x-this.min.x,this.max.y-this.min.y)}}class hE{constructor(){this.acc=new hr(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(e,n){e.min.x===Number.MAX_VALUE&&(e.min.x=e.max.x=n.x,e.min.y=e.max.y=n.y)}appendEdge(e,n,l){this.accCount++,this.acc._add(n);let h=!!this.borders;n.x<e.min.x?(e.min.x=n.x,h=!0):n.x>e.max.x&&(e.max.x=n.x,h=!0),n.y<e.min.y?(e.min.y=n.y,h=!0):n.y>e.max.y&&(e.max.y=n.y,h=!0),((n.x===0||n.x===it)&&n.x===l.x)!=((n.y===0||n.y===it)&&n.y===l.y)&&this.processBorderOverlap(n,l),h&&this.checkBorderIntersection(n,l)}checkBorderIntersection(e,n){n.x<0!=e.x<0&&this.addBorderIntersection(0,Xr(n.y,e.y,(0-n.x)/(e.x-n.x))),n.x>it!=e.x>it&&this.addBorderIntersection(1,Xr(n.y,e.y,(it-n.x)/(e.x-n.x))),n.y<0!=e.y<0&&this.addBorderIntersection(2,Xr(n.x,e.x,(0-n.y)/(e.y-n.y))),n.y>it!=e.y>it&&this.addBorderIntersection(3,Xr(n.x,e.x,(it-n.y)/(e.y-n.y)))}addBorderIntersection(e,n){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);let l=this.borders[e];n<l[0]&&(l[0]=n),n>l[1]&&(l[1]=n)}processBorderOverlap(e,n){if(e.x===n.x){if(e.y===n.y)return;let l=e.x===0?0:1;this.addBorderIntersection(l,n.y),this.addBorderIntersection(l,e.y)}else{let l=e.y===0?2:3;this.addBorderIntersection(l,n.x),this.addBorderIntersection(l,e.x)}}centroid(){return this.accCount===0?new hr(0,0):new hr(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((e,n)=>e+ +(n[0]!==Number.MAX_VALUE),0):0}}function dE(t,e){let n=t.add(e)._unit(),l=ui(t.x*n.x+t.y*n.y,-1,1);var h,f,p;return h=Math.acos(l),Math.min(4,Math.max(-4,Math.tan(h)))/4*bF*((f=t).x*(p=e).y-f.y*p.x<0?-1:1)}let wF=[t=>t.x<0,t=>t.x>it,t=>t.y<0,t=>t.y>it];function TF(t,e,n,l){let h=[4];if(l===0)return h;n._mult(l);let f=t.sub(n),p=e.sub(n),v=[t,e,f,p];for(let y=0;y<4;y++)for(let w of v)if(wF[y](w)){h.push(y);break}return h}class fE{constructor(e){this.vertexArray=new Gx,this.indexArray=new No,this.programConfigurations=new Uf(e.layers,{zoom:e.zoom,lut:e.lut},n=>yF.includes(n)),this._segments=new ha,this.hiddenByLandmarkVertexArray=new ib,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new ha}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(e,n,l,h=!1){let f=e.length;if(f>2){let p=Math.max(0,this._segments.get().length-1),v=this._segments._prepareSegment(4*f,this.vertexArray.length,2*this._segmentToGroundQuads[p].length),y;p!==this._segments.get().length-1&&(p++,this._segmentToGroundQuads[p]=[],this._segmentToRegionTriCounts[p]=[0,0,0,0,0]);{let w=e[0],A=e[1];y=dE(w.sub(e[f-1])._perp()._unit(),A.sub(w)._perp()._unit())}for(let w=0;w<f;w++){let A=w===f-1?0:w+1,M=e[w],R=e[A],N=e[A===f-1?0:A+1],z=R.sub(M)._perp()._unit(),q=dE(z,N.sub(R)._perp()._unit()),Z=y,oe=q;if(zb(M,R,n)||h&&gE(M,n)&&gE(R,n)){y=q;continue}let ye=v.vertexLength;Q1(this.vertexArray,M,R,1,1,Z),Q1(this.vertexArray,M,R,1,0,Z),Q1(this.vertexArray,M,R,0,1,oe),Q1(this.vertexArray,M,R,0,0,oe),v.vertexLength+=4;let be=TF(M,R,z,l);for(let we of be)this._segmentToGroundQuads[p].push({id:ye,region:we}),this._segmentToRegionTriCounts[p][we]+=2,v.primitiveLength+=2;y=q}}}prepareBorderSegments(){if(!this.hasData())return;let e=this._segments.get(),n=e.length;for(let l=0;l<n;l++)this._segmentToGroundQuads[l].sort((h,f)=>h.region-f.region);for(let l=0;l<n;l++){let h=this._segmentToGroundQuads[l],f=e[l],p=this._segmentToRegionTriCounts[l];p.reduce((y,w)=>y+w,0);let v=0;for(let y=0;y<=4;y++){let w=p[y];if(w!==0){let A=this.regionSegments[y];A||(A=this.regionSegments[y]=new ha);let M={vertexOffset:f.vertexOffset,primitiveOffset:f.primitiveOffset+v,vertexLength:f.vertexLength,primitiveLength:w};A.get().push(M)}v+=w}for(let y=0;y<h.length;y++){let w=h[y].id;this.indexArray.emplaceBack(w,w+1,w+3),this.indexArray.emplaceBack(w,w+3,w+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(e,n,l,h,f,p){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,e,n,l,h,f,p)}upload(e){this.hasData()&&(this.vertexBuffer=e.createVertexBuffer(this.vertexArray,tF.members),this.indexBuffer=e.createIndexBuffer(this.indexArray))}uploadPaintProperties(e){this.hasData()&&this.programConfigurations.upload(e)}update(e,n,l,h,f,p){this.hasData()&&this.programConfigurations.updatePaintArrays(e,n,l,h,f,p)}updateHiddenByLandmark(e){if(!this.hasData())return;let n=e.groundVertexCount+e.groundVertexArrayOffset;if(e.groundVertexCount===0)return;let l=e.flags&qf?1:0;for(let h=e.groundVertexArrayOffset;h<n;++h)this.hiddenByLandmarkVertexArray.emplace(h,l);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(e){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=e.createVertexBuffer(this.hiddenByLandmarkVertexArray,iF.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let e=0;e<=4;e++){let n=this.regionSegments[e];n&&n.destroy()}}}}class ev{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.fqid),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new No,this.footprintVertices=new Ju,this.footprintSegments=[],this.layoutVertexArray=new Lf,this.centroidVertexArray=new JT,this.indexArray=new No,this.programConfigurations=new Uf(e.layers,{zoom:e.zoom,lut:e.lut},n=>vF.includes(n)),this.segments=new ha,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.groundEffect=new fE(e),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(e,n){}populate(e,n,l,h){this.features=[],this.hasPattern=Fb("fill-extrusion",this.layers,n),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=L1(l),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(let{feature:f,id:p,index:v,sourceLayerIndex:y}of e){let w=this.layers[0]._featureFilter.needGeometry,A=Vd(f,w);if(!this.layers[0]._featureFilter.filter(new ni(this.zoom),A,l))continue;let M={id:p,sourceLayerIndex:y,index:v,geometry:w?A.geometry:eh(f,l,h),properties:f.properties,type:f.type,patterns:{}},R=this.layoutVertexArray.length;this.hasPattern?this.features.push(Pb("fill-extrusion",this.layers,M,this.zoom,n)):this.addFeature(M,M.geometry,v,l,{},n.availableImages,h,n.brightness),n.featureIndex.insert(f,M.geometry,v,y,this.index,R)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(e,n,l,h,f,p){for(let v of this.features){let{geometry:y}=v;this.addFeature(v,y,v.index,n,l,h,f,p)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(e,n,l,h,f){let p=Object.keys(e).length!==0;if(p&&!this.stateDependentLayers.length)return;let v=p?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(e,n,v,l,h,f),this.groundEffect.update(e,n,v,l,h,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,aF),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,nF.members,!0)),this.groundEffect.upload(e)),this.groundEffect.uploadPaintProperties(e),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.groundEffect.uploadHiddenByLandmark(e),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,rF.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,l,h,f,p,v,y){let w=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(e,{})/this.tileToMeter,A=[new hr(0,0),new hr(it,it)],M=v.projection,R=M.name==="globe",N=_F[e.type]==="Polygon",z=new hE;z.centroidDataIndex=this.centroidData.length;let q=new uE,Z=this.layers[0].paint.get("fill-extrusion-base").evaluate(e,{},h)<=0,oe=this.layers[0].paint.get("fill-extrusion-height").evaluate(e,{},h);q.height=oe,q.vertexArrayOffset=this.layoutVertexArray.length,q.groundVertexArrayOffset=this.groundEffect.vertexArray.length,R&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new M1);let ye=q1(n,500);for(let ot=ye.length-1;ot>=0;ot--){let _t=ye[ot];(_t.length===0||(be=_t[0]).every(Mt=>Mt.x<=0)||be.every(Mt=>Mt.x>=it)||be.every(Mt=>Mt.y<=0)||be.every(Mt=>Mt.y>=it))&&ye.splice(ot,1)}var be;let we;if(R)we=xE(ye,A,h);else{we=[];for(let ot of ye)we.push({polygon:ot,bounds:A})}let $e=N?this.edgeRadius:0,He=$e>0&&this.zoom<17,rt=(ot,_t)=>{if(ot.length===0)return!1;let Mt=ot[ot.length-1];return _t.x===Mt.x&&_t.y===Mt.y};for(let{polygon:ot,bounds:_t}of we){let Mt=0,At=0;for(let Xt of ot)N&&!Xt[0].equals(Xt[Xt.length-1])&&Xt.push(Xt[0]),At+=N?Xt.length-1:Xt.length;let zt=this.segments.prepareSegment((N?5:4)*At,this.layoutVertexArray,this.indexArray);q.footprintSegIdx<0&&(q.footprintSegIdx=this.footprintSegments.length),q.polygonSegIdx<0&&(q.polygonSegIdx=this.polygonSegments.length);let Jt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Ot=new cE;if(Ot.vertexOffset=this.footprintVertices.length,Ot.indexOffset=3*this.footprintIndices.length,Ot.ringIndices=[],N){let Xt=[],Dt=[];Mt=zt.vertexLength;for(let ir=0;ir<ot.length;ir++){let Kt=ot[ir];Kt.length&&ir!==0&&Dt.push(Xt.length/2);let Sr=[],er,lr;er=Kt[1].sub(Kt[0])._perp()._unit(),Ot.ringIndices.push(Kt.length-1);for(let Zr=1;Zr<Kt.length;Zr++){let zr=Kt[Zr],Or=Kt[Zr===Kt.length-1?1:Zr+1],ar=zr.clone();if($e){lr=Or.sub(zr)._perp()._unit();let Kr=er.add(lr)._unit(),vi=$e*Math.min(4,1/(er.x*Kr.x+er.y*Kr.y));ar.x+=vi*Kr.x,ar.y+=vi*Kr.y,ar.x=Math.round(ar.x),ar.y=Math.round(ar.y),er=lr}!Z||$e!==0&&!He||rt(Sr,ar)||Sr.push(ar),zg(this.layoutVertexArray,ar.x,ar.y,0,0,1,1,0),zt.vertexLength++,this.footprintVertices.emplaceBack(zr.x,zr.y),Xt.push(zr.x,zr.y),R&&jg(this.layoutVertexExtArray,M.projectTilePoint(ar.x,ar.y,h),M.upVector(h,ar.x,ar.y))}Z&&($e===0||He)&&(Sr.length!==0&&rt(Sr,Sr[0])&&Sr.pop(),this.groundEffect.addData(Sr,_t,w))}let Zt=Lg(Xt,Dt);for(let ir=0;ir<Zt.length;ir+=3)this.footprintIndices.emplaceBack(Ot.vertexOffset+Zt[ir+0],Ot.vertexOffset+Zt[ir+1],Ot.vertexOffset+Zt[ir+2]),this.indexArray.emplaceBack(Mt+Zt[ir],Mt+Zt[ir+2],Mt+Zt[ir+1]),zt.primitiveLength++;Ot.indexCount+=Zt.length,Ot.vertexCount+=this.footprintVertices.length-Ot.vertexOffset}for(let Xt=0;Xt<ot.length;Xt++){let Dt=ot[Xt];z.startRing(q,Dt[0]);let Zt=Dt.length>4&&_E(Dt[Dt.length-2],Dt[0],Dt[1]),ir=$e?SF(Dt[Dt.length-2],Dt[0],Dt[1],$e):0,Kt=[],Sr,er,lr;er=Dt[1].sub(Dt[0])._perp()._unit();let Zr=!0;for(let zr=1,Or=0;zr<Dt.length;zr++){let ar=Dt[zr-1],Kr=Dt[zr],vi=Dt[zr===Dt.length-1?1:zr+1];if(z.appendEdge(q,Kr,ar),zb(Kr,ar,_t)){$e&&(er=vi.sub(Kr)._perp()._unit(),Zr=!Zr);continue}let ri=Kr.sub(ar)._perp(),Si=ri.x/(Math.abs(ri.x)+Math.abs(ri.y)),yi=ri.y>0?1:0,Pi=ar.dist(Kr);if(Or+Pi>32768&&(Or=0),$e){lr=vi.sub(Kr)._perp()._unit();let tn=mE(ar,Kr,vi,pE(er,lr),$e);isNaN(tn)&&(tn=0);let Zi=Kr.sub(ar)._unit();ar=ar.add(Zi.mult(ir))._round(),Kr=Kr.add(Zi.mult(-tn))._round(),ir=tn,er=lr,Z&&this.zoom>=17&&(rt(Kt,ar)||Kt.push(ar),rt(Kt,Kr)||Kt.push(Kr))}let ei=zt.vertexLength,Sn=Dt.length>4&&_E(ar,Kr,vi),wn=vE(Or,Zt,Zr);if(zg(this.layoutVertexArray,ar.x,ar.y,Si,yi,0,0,wn),zg(this.layoutVertexArray,ar.x,ar.y,Si,yi,0,1,wn),Or+=Pi,wn=vE(Or,Sn,!Zr),Zt=Sn,zg(this.layoutVertexArray,Kr.x,Kr.y,Si,yi,0,0,wn),zg(this.layoutVertexArray,Kr.x,Kr.y,Si,yi,0,1,wn),zt.vertexLength+=4,this.indexArray.emplaceBack(ei+0,ei+1,ei+2),this.indexArray.emplaceBack(ei+1,ei+3,ei+2),zt.primitiveLength+=2,$e){let tn=Mt+(zr===1?Dt.length-2:zr-2),Zi=zr===1?Mt:tn+1;if(this.indexArray.emplaceBack(ei+1,tn,ei+3),this.indexArray.emplaceBack(tn,Zi,ei+3),zt.primitiveLength+=2,Sr===void 0&&(Sr=ei),!zb(vi,Dt[zr],_t)){let rn=zr===Dt.length-1?Sr:zt.vertexLength;this.indexArray.emplaceBack(ei+2,ei+3,rn),this.indexArray.emplaceBack(ei+3,rn+1,rn),this.indexArray.emplaceBack(ei+3,Zi,rn+1),zt.primitiveLength+=3}Zr=!Zr}if(R){let tn=this.layoutVertexExtArray,Zi=M.projectTilePoint(ar.x,ar.y,h),rn=M.projectTilePoint(Kr.x,Kr.y,h),jn=M.upVector(h,ar.x,ar.y),Mn=M.upVector(h,Kr.x,Kr.y);jg(tn,Zi,jn),jg(tn,Zi,jn),jg(tn,rn,Mn),jg(tn,rn,Mn)}}N&&(Mt+=Dt.length-1),Z&&$e&&this.zoom>=17&&(Kt.length!==0&&rt(Kt,Kt[0])&&Kt.pop(),this.groundEffect.addData(Kt,_t,w,$e>0))}this.footprintSegments.push(Ot),Jt.triangleCount=this.indexArray.length-Jt.triangleArrayOffset,this.polygonSegments.push(Jt),++q.footprintSegLen,++q.polygonSegLen}if(q.vertexCount=this.layoutVertexArray.length-q.vertexArrayOffset,q.groundVertexCount=this.groundEffect.vertexArray.length-q.groundVertexArrayOffset,q.vertexCount!==0){if(q.centroidXY=z.borders?lE:this.encodeCentroid(z,q),this.centroidData.push(q),z.borders){this.featuresOnBorder.push(z);let ot=this.featuresOnBorder.length-1;for(let _t=0;_t<z.borders.length;_t++)z.borders[_t][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[_t].push(ot)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,f,p,h,y),this.groundEffect.addPaintPropertiesData(e,l,f,p,h,y),this.maxHeight=Math.max(this.maxHeight,oe)}}sortBorders(){for(let e=0;e<this.borderFeatureIndices.length;e++)this.borderFeatureIndices[e].sort((n,l)=>this.featuresOnBorder[n].borders[e][0]-this.featuresOnBorder[l].borders[e][0])}splitToSubtiles(){let e=[];for(let v=0;v<this.centroidData.length;v++){let y=this.centroidData[v],w=+(y.min.y+y.max.y>it),A=2*w+(+(y.min.x+y.max.x>it)^w);for(let M=0;M<y.polygonSegLen;M++){let R=y.polygonSegIdx+M;e.push({centroidIdx:v,subtile:A,polygonSegmentIdx:R,triangleSegmentIdx:this.polygonSegments[R].triangleSegIdx})}}let n=new No;e.sort((v,y)=>v.triangleSegmentIdx===y.triangleSegmentIdx?v.subtile-y.subtile:v.triangleSegmentIdx-y.triangleSegmentIdx);let l=0,h=0,f=0;for(let v of e){if(v.triangleSegmentIdx!==l)break;f++}let p=e.length;for(;h!==e.length;){l=e[h].triangleSegmentIdx;let v=0,y=h,w=h;for(let A=y;A<f&&e[A].subtile===v;A++)w++;for(;y!==f;){let A=e[y];v=A.subtile;let M=this.centroidData[A.centroidIdx].min.clone(),R=this.centroidData[A.centroidIdx].max.clone(),N={vertexOffset:this.segments.segments[l].vertexOffset,primitiveOffset:n.length,vertexLength:this.segments.segments[l].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let z=y;z<w;z++){let q=e[z],Z=this.polygonSegments[q.polygonSegmentIdx],oe=this.centroidData[q.centroidIdx].min,ye=this.centroidData[q.centroidIdx].max,be=this.indexArray.uint16;for(let we=Z.triangleArrayOffset;we<Z.triangleArrayOffset+Z.triangleCount;we++)n.emplaceBack(be[3*we],be[3*we+1],be[3*we+2]);N.primitiveLength+=Z.triangleCount,M.x=Math.min(M.x,oe.x),M.y=Math.min(M.y,oe.y),R.x=Math.max(R.x,ye.x),R.y=Math.max(R.y,ye.y)}N.primitiveLength>0&&this.triangleSubSegments.push({segment:N,min:M,max:R}),y=w;for(let z=y;z<f&&e[z].subtile===e[y].subtile;z++)w++}h=f;for(let A=h;A<p&&e[A].triangleSegmentIdx===e[h].triangleSegmentIdx;A++)f++}n._trim(),this.indexArray=n}getVisibleSegments(e,n,l){let h=0,f=0,p=1<<e.canonical.z;if(n){let q=n.getMinMaxForTile(e);q&&(h=q.min,f=q.max)}f+=this.maxHeight;let v=e.toUnwrapped(),y,w=[v.canonical.x/p+v.wrap,v.canonical.y/p],A=[(v.canonical.x+1)/p+v.wrap,(v.canonical.y+1)/p],M=new ha,R=(q,Z,oe)=>[q[0]*(1-oe[0])+Z[0]*oe[0],q[1]*(1-oe[1])+Z[1]*oe[1]],N=[],z=[];for(let q of this.triangleSubSegments){N[0]=q.min.x/it,N[1]=q.min.y/it,z[0]=q.max.x/it,z[1]=q.max.y/it;let Z=R(w,A,N),oe=R(w,A,z);if(new da([Z[0],Z[1],h],[oe[0],oe[1],f]).intersectsPrecise(l)===0){y&&(M.segments.push(y),y=void 0);continue}let ye=q.segment;y&&y.vertexOffset!==ye.vertexOffset&&(M.segments.push(y),y=void 0),y?(y.vertexLength+=ye.vertexLength,y.primitiveLength+=ye.primitiveLength):y={vertexOffset:ye.vertexOffset,primitiveLength:ye.primitiveLength,vertexLength:ye.vertexLength,primitiveOffset:ye.primitiveOffset,sortKey:void 0,vaos:{}}}return y&&M.segments.push(y),M}encodeCentroid(e,n){let l=e.centroid(),h=n.span(),f=Math.min(7,Math.round(h.x*this.tileToMeter/10)),p=Math.min(7,Math.round(h.y*this.tileToMeter/10));return new hr(ui(l.x,1,it-1)<<3|f,ui(l.y,1,it-1)<<3|p)}encodeBorderCentroid(e){if(!e.borders)return new hr(0,0);let n=e.borders,l=Number.MAX_VALUE;if(n[0][0]!==l||n[1][0]!==l){let h=n[0][0]!==l?0:1;return new hr(6|(n[0][0]!==l?0:65528),(n[h][0]+n[h][1])/2<<3|6)}{let h=n[2][0]!==l?2:3;return new hr((n[h][0]+n[h][1])/2<<3|6,6|(n[2][0]!==l?0:65528))}}showCentroid(e){let n=this.centroidData[e.centroidDataIndex];n.flags&=qf,n.centroidXY.x=0,n.centroidXY.y=0,this.writeCentroidToBuffer(n)}writeCentroidToBuffer(e){this.groundEffect.updateHiddenByLandmark(e);let n=e.vertexArrayOffset,l=e.vertexCount+e.vertexArrayOffset,h=e.flags&qf?lE:e.centroidXY,f=this.centroidVertexArray.geta_centroid_pos0(n);if(this.centroidVertexArray.geta_centroid_pos1(n)!==h.y||f!==h.x){for(let p=n;p<l;++p)this.centroidVertexArray.emplace(p,h.x,h.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(let e of this.centroidData)this.writeCentroidToBuffer(e)}updateReplacement(e,n,l){if(n.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=n.updateTime;let h=n.getReplacementRegionsForTile(e.toUnwrapped());if(Bb(this.activeReplacements,h))return;if(this.activeReplacements=h,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(let p of this.centroidData)p.flags&=2147483647;let f=[];for(let p of this.activeReplacements){if(p.order<l)continue;let v=Math.pow(2,p.footprintTileId.canonical.z-e.canonical.z);for(let y of this.centroidData)if(!(y.flags&qf||p.min.x>y.max.x||y.min.x>p.max.x||p.min.y>y.max.y||y.min.y>p.max.y))for(let w=0;w<y.footprintSegLen;w++){let A=this.footprintSegments[y.footprintSegIdx+w];if(f.length=0,EF(this.footprintVertices,A.vertexOffset,A.vertexCount,p.footprintTileId.canonical,e.canonical,f),YS(p.footprint,f,this.footprintIndices.uint16,A.indexOffset,A.indexCount,-A.vertexOffset,-v)){y.flags|=qf;break}}}for(let p of this.centroidData)this.writeCentroidToBuffer(p);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(e,n,l){let h=!1;for(let f=0;f<l.footprintSegLen;f++){let p=this.footprintSegments[l.footprintSegIdx+f],v=0;for(let y of p.ringIndices){for(let w=v,A=y+v-1;w<y+v;A=w++){let M=this.footprintVertices.int16[2*(w+p.vertexOffset)+0],R=this.footprintVertices.int16[2*(w+p.vertexOffset)+1],N=this.footprintVertices.int16[2*(A+p.vertexOffset)+1];R>n!=N>n&&e<(this.footprintVertices.int16[2*(A+p.vertexOffset)+0]-M)*(n-R)/(N-R)+M&&(h=!h)}v=y}}return h}getHeightAtTileCoord(e,n){let l=Number.NEGATIVE_INFINITY,h=!0,f=4*(e+it)*it+(n+it);if(this.partLookup.hasOwnProperty(f)){let p=this.partLookup[f];return p?{height:p.height,hidden:!!(p.flags&qf)}:void 0}for(let p of this.centroidData)e>p.max.x||p.min.x>e||n>p.max.y||p.min.y>n||this.footprintContainsPoint(e,n,p)&&p&&p.height>l&&(l=p.height,this.partLookup[f]=p,h=!!(p.flags&qf));if(l!==Number.NEGATIVE_INFINITY)return{height:l,hidden:h};this.partLookup[f]=void 0}}function pE(t,e){let n=t.add(e)._unit();return t.x*n.x+t.y*n.y}function SF(t,e,n,l){let h=e.sub(t)._perp()._unit(),f=n.sub(e)._perp()._unit();return mE(t,e,n,pE(h,f),l)}function mE(t,e,n,l,h){let f=Math.sqrt(1-l*l);return Math.min(t.dist(e)/3,e.dist(n)/3,h*f/l)}function zb(t,e,n){return t.x<n[0].x&&e.x<n[0].x||t.x>n[1].x&&e.x>n[1].x||t.y<n[0].y&&e.y<n[0].y||t.y>n[1].y&&e.y>n[1].y}function gE(t,e){return t.x<e[0].x||t.x>e[1].x||t.y<e[0].y||t.y>e[1].y}function _E(t,e,n){if(t.x<0||t.x>=it||e.x<0||e.x>=it||n.x<0||n.x>=it)return!1;let l=n.sub(e),h=l.perp(),f=t.sub(e);return(l.x*f.x+l.y*f.y)/Math.sqrt((l.x*l.x+l.y*l.y)*(f.x*f.x+f.y*f.y))>-.866&&h.x*f.x+h.y*f.y<0}function vE(t,e,n){let l=e?2|t:-3&t;return n?1|l:-2&l}function yE(){let t=Math.PI/32,e=Math.tan(t),n=Km;return n*Math.sqrt(1+2*e*e)-n}function xE(t,e,n){let l=1<<n.z,h=Nl(n.x/l),f=Nl((n.x+1)/l),p=Zo(n.y/l),v=Zo((n.y+1)/l);return function(y,w,A,M,R=0,N){let z=[];if(!y.length||!A||!M)return z;let q=(He,rt)=>{for(let ot of He)z.push({polygon:ot,bounds:rt})},Z=Math.ceil(Math.log2(A)),oe=Math.ceil(Math.log2(M)),ye=Z-oe,be=[];for(let He=0;He<Math.abs(ye);He++)be.push(ye>0?0:1);for(let He=0;He<Math.min(Z,oe);He++)be.push(0),be.push(1);let we=y;if(we=Y1(we,w[0].y-R,w[1].y+R,1),we=Y1(we,w[0].x-R,w[1].x+R,0),!we.length)return z;let $e=[];for(be.length?$e.push({polygons:we,bounds:w,depth:0}):q(we,w);$e.length;){let He=$e.pop(),rt=He.depth,ot=be[rt],_t=He.bounds[0],Mt=He.bounds[1],At=ot===0?_t.x:_t.y,zt=ot===0?Mt.x:Mt.y,Jt=N?N(ot,At,zt):.5*(At+zt),Ot=Y1(He.polygons,At-R,Jt+R,ot),Xt=Y1(He.polygons,Jt-R,zt+R,ot);if(Ot.length){let Dt=[_t,new hr(ot===0?Jt:Mt.x,ot===1?Jt:Mt.y)];be.length>rt+1?$e.push({polygons:Ot,bounds:Dt,depth:rt+1}):q(Ot,Dt)}if(Xt.length){let Dt=[new hr(ot===0?Jt:_t.x,ot===1?Jt:_t.y),Mt];be.length>rt+1?$e.push({polygons:Xt,bounds:Dt,depth:rt+1}):q(Xt,Dt)}}return z}(t,e,Math.ceil((f-h)/11.25),Math.ceil((p-v)/11.25),1,(y,w,A)=>{if(y===0)return .5*(w+A);{let M=Zo((n.y+w/it)/l);return($h(.5*(Zo((n.y+A/it)/l)+M))*l-n.y)*it}})}function EF(t,e,n,l,h,f){let p=Math.pow(2,l.z-h.z);for(let v=0;v<n;v++){let y=t.int16[2*(v+e)+0],w=t.int16[2*(v+e)+1];y=(y+h.x*it)*p-l.x*it,w=(w+h.y*it)*p-l.y*it,f.push(new hr(y,w))}}Fe(ev,"FillExtrusionBucket",{omit:["layers","features"]}),Fe(uE,"PartData"),Fe(cE,"FootprintSegment"),Fe(hE,"BorderCentroidData"),Fe(fE,"GroundEffect");let AF=new un({visibility:new Ht(vt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Ht(vt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var CF={paint:new un({"fill-extrusion-opacity":new Ht(vt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new _r(vt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ht(vt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ht(vt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new _r(vt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new _r(vt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new _r(vt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ht(vt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Ht(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Ht(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Ht(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Ht(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Ht(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Ht(vt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Ht(vt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new _r(vt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new _r(vt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Ht(vt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Ht(vt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Ht(vt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Ht(vt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Ht(vt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"])}),layout:AF};function Ug(t,e){return t.x*e.x+t.y*e.y}function bE(t,e){if(t.length===1){let n=0,l=e[n++],h;for(;!h||l.equals(h);)if(h=e[n++],!h)return 1/0;for(;n<e.length;n++){let f=e[n],p=t[0],v=h.sub(l),y=f.sub(l),w=p.sub(l),A=Ug(v,v),M=Ug(v,y),R=Ug(y,y),N=Ug(w,v),z=Ug(w,y),q=A*R-M*M,Z=(R*N-M*z)/q,oe=(A*z-M*N)/q,ye=l.z*(1-Z-oe)+h.z*Z+f.z*oe;if(isFinite(ye))return ye}return 1/0}{let n=1/0;for(let l of e)n=Math.min(n,l.z);return n}}function wE(t,e,n,l,h,f,p,v){let y=p*h.getElevationAt(t,e,!0,!0),w=f[0]!==0,A=w?f[1]===0?p*(f[0]/7-450):p*function(M,R,N){let z=Math.floor(R[0]/8),q=Math.floor(R[1]/8),Z=10*(R[0]-8*z),oe=10*(R[1]-8*q),ye=M.getElevationAt(z,q,!0,!0),be=M.getMeterToDEM(N),we=Math.floor(.5*(Z*be-1)),$e=Math.floor(.5*(oe*be-1)),He=M.tileCoordToPixel(z,q),rt=2*we+1,ot=2*$e+1,_t=function(Xt,Dt,Zt,ir,Kt){return[Xt.getElevationAtPixel(Dt,Zt,!0),Xt.getElevationAtPixel(Dt+Kt,Zt,!0),Xt.getElevationAtPixel(Dt,Zt+Kt,!0),Xt.getElevationAtPixel(Dt+ir,Zt+Kt,!0)]}(M,He.x-we,He.y-$e,rt,ot),Mt=Math.abs(_t[0]-_t[1]),At=Math.abs(_t[2]-_t[3]),zt=Math.abs(_t[0]-_t[2])+Math.abs(_t[1]-_t[3]),Jt=Math.min(.25,.5*be*(Mt+At)/rt),Ot=Math.min(.25,.5*be*zt/ot);return ye+Math.max(Jt*Z,Ot*oe)}(h,f,v):y;return{base:y+(n===0)?-1:n,top:w?Math.max(A+l,y+n+2):y+l}}let IF=hn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:kF}=IF,MF=hn([{name:"a_packed",components:4,type:"Float32"}]),{members:DF}=MF,RF=hn([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:FF}=RF,PF=hn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),LF=hn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),OF=hn([{name:"a_projected_pos",components:4,type:"Float32"}],4);hn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);let jb=hn([{name:"a_occlusion_query_opacity",components:1,type:"Float32"}],4),TE=hn([{name:"a_z_offset",components:1,type:"Float32"}],4),NF=hn([{name:"a_texb",components:2,type:"Uint16"}]),BF=hn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),zF=hn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_z_offset",components:1,type:"Float32"}]);hn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);let SE=hn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),jF=hn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);hn([{name:"triangle",components:3,type:"Uint16"}]),hn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),hn([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Float32",name:"occlusionState"},{type:"Float32",name:"occlusionOpacity"},{type:"Uint8",name:"hasIconTextFit"}]),hn([{type:"Float32",name:"offsetX"}]),hn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);class EE{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.image=new Hf({width:e,height:n}),this.positions={},this.uploaded=!1}getDash(e,n){let l=this.getKey(e,n);return this.positions[l]}trim(){let e=this.width,n=this.height=Du(this.nextRow);this.image.resize({width:e,height:n})}getKey(e,n){return e.join(",")+n}getDashRanges(e,n,l){let h=[],f=e.length%2==1?-e[e.length-1]*l:0,p=e[0]*l,v=!0;h.push({left:f,right:p,isDash:v,zeroLength:e[0]===0});let y=e[0];for(let w=1;w<e.length;w++){v=!v;let A=e[w];f=y*l,y+=A,p=y*l,h.push({left:f,right:p,isDash:v,zeroLength:A===0})}return h}addRoundDash(e,n,l){let h=n/2;for(let f=-l;f<=l;f++){let p=this.width*(this.nextRow+l+f),v=0,y=e[v];for(let w=0;w<this.width;w++){w/y.right>1&&(y=e[++v]);let A=Math.abs(w-y.left),M=Math.abs(w-y.right),R=Math.min(A,M),N,z=f/l*(h+1);if(y.isDash){let q=h-Math.abs(z);N=Math.sqrt(R*R+q*q)}else N=h-Math.sqrt(R*R+z*z);this.image.data[p+w]=Math.max(0,Math.min(255,N+128))}}}addRegularDash(e,n){for(let y=e.length-1;y>=0;--y){let w=e[y],A=e[y+1];w.zeroLength?e.splice(y,1):A&&A.isDash===w.isDash&&(A.left=w.left,e.splice(y,1))}let l=e[0],h=e[e.length-1];l.isDash===h.isDash&&(l.left=h.left-this.width,h.right=l.right+this.width);let f=this.width*this.nextRow,p=0,v=e[p];for(let y=0;y<this.width;y++){y/v.right>1&&(v=e[++p]);let w=Math.abs(y-v.left),A=Math.abs(y-v.right),M=Math.min(w,A);this.image.data[f+y]=Math.max(0,Math.min(255,(v.isDash?M:-M)+n+128))}}addDash(e,n){let l=this.getKey(e,n);if(this.positions[l])return this.positions[l];let h=n==="round",f=h?7:0,p=2*f+1;if(this.nextRow+p>this.height)return Wn("LineAtlas out of space"),null;e.length===0&&e.push(1);let v=0;for(let A=0;A<e.length;A++)e[A]<0&&(Wn("Negative value is found in line dasharray, replacing values with 0"),e[A]=0),v+=e[A];if(v!==0){let A=this.width/v,M=this.getDashRanges(e,this.width,A);h?this.addRoundDash(M,A,f):this.addRegularDash(M,n==="square"?.5*A:0)}let y=this.nextRow+f;this.nextRow+=p;let w={tl:[y,f],br:[v,0]};return this.positions[l]=w,w}}Fe(EE,"LineAtlas");let UF=Z1.types,VF=Math.cos(Math.PI/180*37.5),GF=Math.cos(Math.PI/180*5);class tv{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.fqid),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.hasZOffset=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new Hx,this.layoutVertexArray2=new Of,this.patternVertexArray=new Nf,this.indexArray=new No,this.programConfigurations=new Uf(e.layers,{zoom:e.zoom,lut:e.lut}),this.segments=new ha,this.maxLineLength=0,this.zOffsetVertexArray=new Hp,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.tessellationStep=e.tessellationStep?e.tessellationStep:it/64}updateFootprints(e,n){}populate(e,n,l,h){this.hasPattern=Fb("line",this.layers,n);let f=this.layers[0].layout.get("line-sort-key"),p=this.layers[0].layout.get("line-z-offset");this.hasZOffset=!p.isConstant()||!!p.constantOr(0);let v=[];for(let{feature:M,id:R,index:N,sourceLayerIndex:z}of e){let q=this.layers[0]._featureFilter.needGeometry,Z=Vd(M,q);if(!this.layers[0]._featureFilter.filter(new ni(this.zoom),Z,l))continue;let oe=f?f.evaluate(Z,{},l):void 0,ye={id:R,properties:M.properties,type:M.type,sourceLayerIndex:z,index:N,geometry:q?Z.geometry:eh(M,l,h),patterns:{},sortKey:oe};v.push(ye)}f&&v.sort((M,R)=>M.sortKey-R.sortKey);let{lineAtlas:y,featureIndex:w}=n,A=this.addConstantDashes(y);for(let M of v){let{geometry:R,index:N,sourceLayerIndex:z}=M;if(A&&this.addFeatureDashes(M,y),this.hasPattern){let q=Pb("line",this.layers,M,this.zoom,n);this.patternFeatures.push(q)}else this.addFeature(M,R,N,l,y.positions,n.availableImages,n.brightness);w.insert(e[N].feature,R,N,z,this.index)}}addConstantDashes(e){let n=!1;for(let l of this.layers){let h=l.paint.get("line-dasharray").value,f=l.layout.get("line-cap").value;if(h.kind!=="constant"||f.kind!=="constant")n=!0;else{let p=f.value,v=h.value;if(!v)continue;e.addDash(v,p)}}return n}addFeatureDashes(e,n){let l=this.zoom;for(let h of this.layers){let f=h.paint.get("line-dasharray").value,p=h.layout.get("line-cap").value;if(f.kind==="constant"&&p.kind==="constant")continue;let v,y;if(f.kind==="constant"){if(v=f.value,!v)continue}else v=f.evaluate({zoom:l},e);y=p.kind==="constant"?p.value:p.evaluate({zoom:l},e),n.addDash(v,y),e.patterns[h.id]=n.getKey(v,y)}}update(e,n,l,h,f){let p=Object.keys(e).length!==0;p&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,n,p?this.stateDependentLayers:this.layers,l,h,f)}addFeatures(e,n,l,h,f,p){for(let v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,n,l,h,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,DF)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=e.createVertexBuffer(this.patternVertexArray,FF)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=e.createVertexBuffer(this.zOffsetVertexArray,TE.members,!0)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,kF),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,n,l,h,f,p,v){let y=this.layers[0].layout,w=y.get("line-join").evaluate(e,{}),A=y.get("line-cap").evaluate(e,{}),M=y.get("line-miter-limit"),R=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(let N of n)this.addLine(N,e,h,w,A,M,R);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,f,p,h,v)}addLine(e,n,l,h,f,p,v){this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.currentVertex=void 0;let y={zoom:this.zoom,lineProgress:void 0},w=this.layers[0].layout,A=h==="none";if(this.patternJoinNone=this.hasPattern&&A,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let He=0;He<e.length-1;He++)this.totalDistance+=e[He].dist(e[He+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let M=UF[n.type]==="Polygon",R=e.length;for(;R>=2&&e[R-1].equals(e[R-2]);)R--;let N=0;for(;N<R-1&&e[N].equals(e[N+1]);)N++;if(R<(M?3:2))return;h==="bevel"&&(p=1.05);let z=this.overscaling<=16?15*it/(512*this.overscaling):0,q=this.segments.prepareSegment(10*R,this.layoutVertexArray,this.indexArray),Z,oe,ye,be,we,$e;this.e1=this.e2=-1,M&&(Z=e[R-2],we=e[N].sub(Z)._unit()._perp());for(let He=N;He<R;He++){if(ye=He===R-1?M?e[N+1]:void 0:e[He+1],ye&&e[He].equals(ye))continue;if(we&&(be=we),Z&&(oe=Z),Z=e[He],this.hasZOffset){let Dt=w.get("line-z-offset").value;if(Dt.kind==="constant")$e=Dt.value;else{if(this.lineClips){let Zt=this.totalDistance/(this.lineClips.end-this.lineClips.start);y.lineProgress=(Zt*this.lineClips.start+this.distance+(oe?oe.dist(Z):0))/Zt}else Wn(`line-z-offset evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`),y.lineProgress=0;$e=Dt.evaluate(y,n)}$e=$e||0}we=ye?ye.sub(Z)._unit()._perp():be,be=be||we;let rt=oe&&ye,ot=rt?h:M||A?"butt":f,_t=be.x*we.x+be.y*we.y;if(A){let Dt=function(Zt){if(Zt.patternJoinNone){let ir=Zt.segmentPoints.length/2,Kt=Zt.lineSoFar-Zt.segmentStart;for(let Sr=0;Sr<ir;++Sr){let er=Zt.segmentPoints[2*Sr+1],lr=Math.round(Zt.segmentPoints[2*Sr])+.5+.25*er;Zt.patternVertexArray.emplaceBack(lr,Kt,Zt.segmentStart),Zt.patternVertexArray.emplaceBack(lr,Kt,Zt.segmentStart)}Zt.segmentPoints.length=0}Zt.e1=Zt.e2=-1};if(rt&&_t<GF){this.updateDistance(oe,Z),this.addCurrentVertex(Z,be,1,1,q,$e),Dt(this),this.addCurrentVertex(Z,we,-1,-1,q,$e);continue}if(oe){if(!ye){this.updateDistance(oe,Z),this.addCurrentVertex(Z,be,1,1,q,$e),Dt(this);continue}ot="miter"}}let Mt=be.add(we);Mt.x===0&&Mt.y===0||Mt._unit();let At=Mt.x*we.x+Mt.y*we.y,zt=At!==0?1/At:1/0,Jt=2*Math.sqrt(2-2*At),Ot=At<VF&&oe&&ye,Xt=be.x*we.y-be.y*we.x>0;if(Ot&&He>N){let Dt=Z.dist(oe);if(Dt>2*z){let Zt=Z.sub(Z.sub(oe)._mult(z/Dt)._round());this.updateDistance(oe,Zt),this.addCurrentVertex(Zt,be,0,0,q,$e),oe=Zt}}if(rt&&ot==="round"&&(zt<v?ot="miter":zt<=2&&(ot="fakeround")),ot==="miter"&&zt>p&&(ot="bevel"),ot==="bevel"&&(zt>2&&(ot="flipbevel"),zt<p&&(ot="miter")),oe&&this.updateDistance(oe,Z),ot==="miter")Mt._mult(zt),this.addCurrentVertex(Z,Mt,0,0,q,$e);else if(ot==="flipbevel"){if(zt>100)Mt=we.mult(-1);else{let Dt=zt*be.add(we).mag()/be.sub(we).mag();Mt._perp()._mult(Dt*(Xt?-1:1))}this.addCurrentVertex(Z,Mt,0,0,q,$e),this.addCurrentVertex(Z,Mt.mult(-1),0,0,q,$e)}else if(ot==="bevel"||ot==="fakeround"){let Dt=-Math.sqrt(zt*zt-1),Zt=Xt?Dt:0,ir=Xt?0:Dt;if(oe&&this.addCurrentVertex(Z,be,Zt,ir,q,$e),ot==="fakeround"){let Kt=Math.round(180*Jt/Math.PI/20);for(let Sr=1;Sr<Kt;Sr++){let er=Sr/Kt;if(er!==.5){let Zr=er-.5;er+=er*Zr*(er-1)*((1.0904+_t*(_t*(3.55645-1.43519*_t)-3.2452))*Zr*Zr+(.848013+_t*(.215638*_t-1.06021)))}let lr=we.sub(be)._mult(er)._add(be)._unit()._mult(Xt?-1:1);this.addHalfVertex(Z,lr.x,lr.y,!1,Xt,0,q,$e)}}ye&&this.addCurrentVertex(Z,we,-Zt,-ir,q,$e)}else ot==="butt"?this.addCurrentVertex(Z,Mt,0,0,q,$e):ot==="square"?(oe||this.addCurrentVertex(Z,Mt,-1,-1,q,$e),this.addCurrentVertex(Z,Mt,0,0,q,$e),oe&&this.addCurrentVertex(Z,Mt,1,1,q,$e)):ot==="round"&&(oe&&(this.addCurrentVertex(Z,be,0,0,q,$e),this.addCurrentVertex(Z,be,1,1,q,$e,!0)),ye&&(this.addCurrentVertex(Z,we,-1,-1,q,$e,!0),this.addCurrentVertex(Z,we,0,0,q,$e)));if(Ot&&He<R-1){let Dt=Z.dist(ye);if(Dt>2*z){let Zt=Z.add(ye.sub(Z)._mult(z/Dt)._round());this.updateDistance(Z,Zt),this.addCurrentVertex(Zt,we,0,0,q,$e),Z=Zt}}}}addVerticesTo(e,n,l,h,f,p,v,y,w,A){let M=(n.w-e.w)/this.tessellationStep|0;if(M>1){this.lineSoFar=e.w;let R=(n.x-e.x)/M,N=(n.y-e.y)/M,z=(n.z-e.z)/M,q=(n.w-e.w)/M;for(let Z=1;Z<M;++Z)e.x+=R,e.y+=N,e.z+=z,this.lineSoFar+=q,this.addHalfVertex(e,l,h,A,!1,v,w,e.z),this.addHalfVertex(e,f,p,A,!0,-y,w,e.z)}this.lineSoFar=n.w,this.addHalfVertex(n,l,h,A,!1,v,w,n.z),this.addHalfVertex(n,f,p,A,!0,-y,w,n.z)}addCurrentVertex(e,n,l,h,f,p,v=!1){let y=n.x+n.y*l,w=n.y-n.x*l,A=n.y*h-n.x,M=-n.y-n.x*h;if(p!=null){let N=it+10,z=p,q=new WS(e.x,e.y,z,this.lineSoFar),Z=AE(e,-10,N),oe=this.lineSoFar;if(this.currentVertex)if(Z){let ye=this.currentVertexIsOutside,be=this.currentVertex,we=new WS(e.x,e.y,z,this.lineSoFar);$S(be,we,-10,N),AE(we,-10,N)||(ye&&(this.e1=this.e2=-1,this.lineSoFar=be.w,this.addHalfVertex(be,y,w,v,!1,l,f,be.z),this.addHalfVertex(be,A,M,v,!0,-h,f,be.z)),this.addVerticesTo(be,we,y,w,A,M,l,h,f,v))}else{let ye=this.currentVertex;this.currentVertexIsOutside&&($S(ye,q,-10,N),this.e1=this.e2=-1,this.lineSoFar=ye.w,this.addHalfVertex(ye,y,w,v,!1,l,f,ye.z),this.addHalfVertex(ye,A,M,v,!0,-h,f,ye.z)),this.addVerticesTo(ye,q,y,w,A,M,l,h,f,v)}else Z||(this.addHalfVertex(e,y,w,v,!1,l,f,p),this.addHalfVertex(e,A,M,v,!0,-h,f,p));this.currentVertex=q,this.currentVertexIsOutside=Z,this.lineSoFar=oe}else this.addHalfVertex(e,y,w,v,!1,l,f,p),this.addHalfVertex(e,A,M,v,!0,-h,f,p)}addHalfVertex({x:e,y:n},l,h,f,p,v,y,w){this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),p||this.segmentPoints.push(this.lineSoFar-this.segmentStart,v)),this.layoutVertexArray.emplaceBack((e<<1)+(f?1:0),(n<<1)+(p?1:0),Math.round(63*l)+128,Math.round(63*h)+128,1+(v===0?0:v<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);let A=y.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,A),y.primitiveLength++),p?this.e2=A:this.e1=A,w!=null&&this.zOffsetVertexArray.emplaceBack(w)}updateScaledDistance(){if(this.lineClips){let e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,n){this.distance+=e.dist(n),this.updateScaledDistance()}}function AE(t,e,n){return t.x<e||t.x>n||t.y<e||t.y>n}Fe(tv,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});let HF=new un({"line-cap":new _r(vt.layout_line["line-cap"]),"line-join":new _r(vt.layout_line["line-join"]),"line-miter-limit":new Ht(vt.layout_line["line-miter-limit"]),"line-round-limit":new Ht(vt.layout_line["line-round-limit"]),"line-sort-key":new _r(vt.layout_line["line-sort-key"]),"line-z-offset":new _r(vt.layout_line["line-z-offset"]),visibility:new Ht(vt.layout_line.visibility)});var rv={paint:new un({"line-opacity":new _r(vt.paint_line["line-opacity"]),"line-color":new _r(vt.paint_line["line-color"]),"line-translate":new Ht(vt.paint_line["line-translate"]),"line-translate-anchor":new Ht(vt.paint_line["line-translate-anchor"]),"line-width":new _r(vt.paint_line["line-width"]),"line-gap-width":new _r(vt.paint_line["line-gap-width"]),"line-offset":new _r(vt.paint_line["line-offset"]),"line-blur":new _r(vt.paint_line["line-blur"]),"line-dasharray":new _r(vt.paint_line["line-dasharray"]),"line-pattern":new _r(vt.paint_line["line-pattern"]),"line-gradient":new ua(vt.paint_line["line-gradient"]),"line-trim-offset":new Ht(vt.paint_line["line-trim-offset"]),"line-trim-fade-range":new Ht(vt.paint_line["line-trim-fade-range"]),"line-trim-color":new Ht(vt.paint_line["line-trim-color"]),"line-emissive-strength":new Ht(vt.paint_line["line-emissive-strength"]),"line-border-width":new _r(vt.paint_line["line-border-width"]),"line-border-color":new _r(vt.paint_line["line-border-color"]),"line-occlusion-opacity":new Ht(vt.paint_line["line-occlusion-opacity"])}),layout:HF};function CE(t,e,n){return e*(it/(t.tileSize*Math.pow(2,n-t.tileID.overscaledZ)))}function IE(t,e){return 1/CE(t,1,e.tileZoom)}function kE(t,e,n,l){return t.translatePosMatrix(l||e.tileID.projMatrix,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}let ME=t=>{let e=[];DE(t)&&e.push("RENDER_LINE_DASH"),t.paint.get("line-gradient")&&e.push("RENDER_LINE_GRADIENT");let n=t.paint.get("line-trim-offset");n[0]===0&&n[1]===0||e.push("RENDER_LINE_TRIM_OFFSET"),t.paint.get("line-border-width").constantOr(1)!==0&&e.push("RENDER_LINE_BORDER");let l=t.layout.get("line-join").constantOr("miter")==="none",h=!!t.paint.get("line-pattern").constantOr(1);return l&&h&&e.push("LINE_JOIN_NONE"),e};function DE(t){let e=t.paint.get("line-dasharray").value;return e.value||e.kind!=="constant"}class RE{constructor(e){this._stringToNumber={},this._numberToString=[];for(let n=0;n<e.length;n++){let l=e[n];this._stringToNumber[l]=n,this._numberToString[n]=l}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}var WF={read:function(t,e,n,l,h){var f,p,v=8*h-l-1,y=(1<<v)-1,w=y>>1,A=-7,M=n?h-1:0,R=n?-1:1,N=t[e+M];for(M+=R,f=N&(1<<-A)-1,N>>=-A,A+=v;A>0;f=256*f+t[e+M],M+=R,A-=8);for(p=f&(1<<-A)-1,f>>=-A,A+=l;A>0;p=256*p+t[e+M],M+=R,A-=8);if(f===0)f=1-w;else{if(f===y)return p?NaN:1/0*(N?-1:1);p+=Math.pow(2,l),f-=w}return(N?-1:1)*p*Math.pow(2,f-l)},write:function(t,e,n,l,h,f){var p,v,y,w=8*f-h-1,A=(1<<w)-1,M=A>>1,R=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,N=l?0:f-1,z=l?1:-1,q=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(v=isNaN(e)?1:0,p=A):(p=Math.floor(Math.log(e)/Math.LN2),e*(y=Math.pow(2,-p))<1&&(p--,y*=2),(e+=p+M>=1?R/y:R*Math.pow(2,1-M))*y>=2&&(p++,y/=2),p+M>=A?(v=0,p=A):p+M>=1?(v=(e*y-1)*Math.pow(2,h),p+=M):(v=e*Math.pow(2,M-1)*Math.pow(2,h),p=0));h>=8;t[n+N]=255&v,N+=z,v/=256,h-=8);for(p=p<<h|v,w+=h;w>0;t[n+N]=255&p,N+=z,p/=256,w-=8);t[n+N-z]|=128*q}},FE=ra,iv=WF;function ra(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}ra.Varint=0,ra.Fixed64=1,ra.Bytes=2,ra.Fixed32=5;var Ub=4294967296,PE=1/Ub,LE=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Wd(t){return t.type===ra.Bytes?t.readVarint()+t.pos:t.pos+1}function i0(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function OE(t,e,n){var l=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(l);for(var h=n.pos-1;h>=t;h--)n.buf[h+l]=n.buf[h]}function qF(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function $F(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function XF(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function ZF(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function YF(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function KF(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function JF(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function QF(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function eP(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function nv(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function n0(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function NE(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}ra.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var l=this.readVarint(),h=l>>3,f=this.pos;this.type=7&l,t(h,e,this),this.pos===f&&this.skip(l)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=nv(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=NE(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=nv(this.buf,this.pos)+nv(this.buf,this.pos+4)*Ub;return this.pos+=8,t},readSFixed64:function(){var t=nv(this.buf,this.pos)+NE(this.buf,this.pos+4)*Ub;return this.pos+=8,t},readFloat:function(){var t=iv.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=iv.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,l=this.buf;return e=127&(n=l[this.pos++]),n<128?e:(e|=(127&(n=l[this.pos++]))<<7,n<128?e:(e|=(127&(n=l[this.pos++]))<<14,n<128?e:(e|=(127&(n=l[this.pos++]))<<21,n<128?e:function(h,f,p){var v,y,w=p.buf;if(v=(112&(y=w[p.pos++]))>>4,y<128||(v|=(127&(y=w[p.pos++]))<<3,y<128)||(v|=(127&(y=w[p.pos++]))<<10,y<128)||(v|=(127&(y=w[p.pos++]))<<17,y<128)||(v|=(127&(y=w[p.pos++]))<<24,y<128)||(v|=(1&(y=w[p.pos++]))<<31,y<128))return i0(h,v,f);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=l[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&LE?function(n,l,h){return LE.decode(n.subarray(l,h))}(this.buf,e,t):function(n,l,h){for(var f="",p=l;p<h;){var v,y,w,A=n[p],M=null,R=A>239?4:A>223?3:A>191?2:1;if(p+R>h)break;R===1?A<128&&(M=A):R===2?(192&(v=n[p+1]))==128&&(M=(31&A)<<6|63&v)<=127&&(M=null):R===3?(y=n[p+2],(192&(v=n[p+1]))==128&&(192&y)==128&&((M=(15&A)<<12|(63&v)<<6|63&y)<=2047||M>=55296&&M<=57343)&&(M=null)):R===4&&(y=n[p+2],w=n[p+3],(192&(v=n[p+1]))==128&&(192&y)==128&&(192&w)==128&&((M=(15&A)<<18|(63&v)<<12|(63&y)<<6|63&w)<=65535||M>=1114112)&&(M=null)),M===null?(M=65533,R=1):M>65535&&(M-=65536,f+=String.fromCharCode(M>>>10&1023|55296),M=56320|1023&M),f+=String.fromCharCode(M),p+=R}return f}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==ra.Bytes)return t.push(this.readVarint(e));var n=Wd(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==ra.Bytes)return t.push(this.readSVarint());var e=Wd(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==ra.Bytes)return t.push(this.readBoolean());var e=Wd(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==ra.Bytes)return t.push(this.readFloat());var e=Wd(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==ra.Bytes)return t.push(this.readDouble());var e=Wd(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==ra.Bytes)return t.push(this.readFixed32());var e=Wd(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==ra.Bytes)return t.push(this.readSFixed32());var e=Wd(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==ra.Bytes)return t.push(this.readFixed64());var e=Wd(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==ra.Bytes)return t.push(this.readSFixed64());var e=Wd(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===ra.Varint)for(;this.buf[this.pos++]>127;);else if(e===ra.Bytes)this.pos=this.readVarint()+this.pos;else if(e===ra.Fixed32)this.pos+=4;else{if(e!==ra.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),n0(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),n0(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),n0(this.buf,-1&t,this.pos),n0(this.buf,Math.floor(t*PE),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),n0(this.buf,-1&t,this.pos),n0(this.buf,Math.floor(t*PE),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,n){var l,h;if(e>=0?(l=e%4294967296|0,h=e/4294967296|0):(h=~(-e/4294967296),4294967295^(l=~(-e%4294967296))?l=l+1|0:(l=0,h=h+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");n.realloc(10),function(f,p,v){v.buf[v.pos++]=127&f|128,f>>>=7,v.buf[v.pos++]=127&f|128,f>>>=7,v.buf[v.pos++]=127&f|128,f>>>=7,v.buf[v.pos++]=127&f|128,v.buf[v.pos]=127&(f>>>=7)}(l,0,n),function(f,p){var v=(7&f)<<4;p.buf[p.pos++]|=v|((f>>>=3)?128:0),f&&(p.buf[p.pos++]=127&f|((f>>>=7)?128:0),f&&(p.buf[p.pos++]=127&f|((f>>>=7)?128:0),f&&(p.buf[p.pos++]=127&f|((f>>>=7)?128:0),f&&(p.buf[p.pos++]=127&f|((f>>>=7)?128:0),f&&(p.buf[p.pos++]=127&f)))))}(h,n)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(l,h,f){for(var p,v,y=0;y<h.length;y++){if((p=h.charCodeAt(y))>55295&&p<57344){if(!v){p>56319||y+1===h.length?(l[f++]=239,l[f++]=191,l[f++]=189):v=p;continue}if(p<56320){l[f++]=239,l[f++]=191,l[f++]=189,v=p;continue}p=v-55296<<10|p-56320|65536,v=null}else v&&(l[f++]=239,l[f++]=191,l[f++]=189,v=null);p<128?l[f++]=p:(p<2048?l[f++]=p>>6|192:(p<65536?l[f++]=p>>12|224:(l[f++]=p>>18|240,l[f++]=p>>12&63|128),l[f++]=p>>6&63|128),l[f++]=63&p|128)}return f}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&OE(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),iv.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),iv.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var l=this.pos-n;l>=128&&OE(n,l,this),this.pos=n-1,this.writeVarint(l),this.pos+=l},writeMessage:function(t,e,n){this.writeTag(t,ra.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,qF,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,$F,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,YF,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,XF,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,ZF,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,KF,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,JF,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,QF,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,eP,e)},writeBytesField:function(t,e){this.writeTag(t,ra.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,ra.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,ra.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,ra.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,ra.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,ra.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,ra.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,ra.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,ra.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,ra.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,!!e)}};var a0=J(FE);let tP=["id","tile","layer","source","sourceLayer","state"];class BE{constructor(e,n,l,h,f){this.type="Feature",this._vectorTileFeature=e,this._z=n,this._x=l,this._y=h,this.properties=e.properties,this.id=f}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){let e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(let n of tP)this[n]!==void 0&&(e[n]=this[n]);return e}}class rP{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,l){let h=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][h]=this.stateChanges[e][h]||{},Ma(this.stateChanges[e][h],l),this.deletedStates[e]===null){this.deletedStates[e]={};for(let f in this.state[e])f!==h&&(this.deletedStates[e][f]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][h]===null){this.deletedStates[e][h]={};for(let f in this.state[e][h])l[f]||(this.deletedStates[e][h][f]=null)}else for(let f in l)this.deletedStates[e]&&this.deletedStates[e][h]&&this.deletedStates[e][h][f]===null&&delete this.deletedStates[e][h][f]}removeFeatureState(e,n,l){if(this.deletedStates[e]===null)return;let h=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&n!==void 0)this.deletedStates[e][h]!==null&&(this.deletedStates[e][h]=this.deletedStates[e][h]||{},this.deletedStates[e][h][l]=null);else if(n!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][h])for(l in this.deletedStates[e][h]={},this.stateChanges[e][h])this.deletedStates[e][h][l]=null;else this.deletedStates[e][h]=null;else this.deletedStates[e]=null}getState(e,n){let l=String(n),h=Ma({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){let f=this.deletedStates[e][n];if(f===null)return{};for(let p in f)delete h[p]}return h}initializeTileState(e,n){e.setFeatureState(this.state,n)}coalesceChanges(e,n){let l={};for(let h in this.stateChanges){this.state[h]=this.state[h]||{};let f={};for(let p in this.stateChanges[h])this.state[h][p]||(this.state[h][p]={}),Ma(this.state[h][p],this.stateChanges[h][p]),f[p]=this.state[h][p];l[h]=f}for(let h in this.deletedStates){this.state[h]=this.state[h]||{};let f={};if(this.deletedStates[h]===null)for(let p in this.state[h])f[p]={},this.state[h][p]={};else for(let p in this.deletedStates[h]){if(this.deletedStates[h][p]===null)this.state[h][p]={};else if(this.state[h][p])for(let v of Object.keys(this.deletedStates[h][p]))delete this.state[h][p][v];f[p]=this.state[h][p]}l[h]=l[h]||{},Ma(l[h],f)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(let h in e)e[h].setFeatureState(l,n)}}class zE{constructor(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Je(it,16,0),this.featureIndexArray=new KT,this.promoteId=n,this.is3DTile=!1}insert(e,n,l,h,f,p=0,v=0){let y=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,h,f,p);let w=this.grid;for(let A=0;A<n.length;A++){let M=n[A],R=[1/0,1/0,-1/0,-1/0];for(let N=0;N<M.length;N++){let z=M[N];R[0]=Math.min(R[0],z.x),R[1]=Math.min(R[1],z.y),R[2]=Math.max(R[2],z.x),R[3]=Math.max(R[3],z.y)}v!==0&&(R[0]-=v,R[1]-=v,R[2]+=v,R[3]+=v),R[0]<it&&R[1]<it&&R[2]>=0&&R[3]>=0&&w.insert(y,R[0],R[1],R[2],R[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Ob(new a0(this.rawTileData)).layers,this.sourceLayerCoder=new RE(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(let e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,n,l,h){this.loadVTLayers();let f=e.params||{},p=Mo(f.filter),v=e.tileResult,y=e.transform,w=v.bufferedTilespaceBounds,A=this.grid.query(w.min.x,w.min.y,w.max.x,w.max.y,(z,q,Z,oe)=>pS(v.bufferedTilespaceGeometry,z,q,Z,oe));A.sort(iP);let M=null;y.elevation&&A.length>0&&(M=r0.create(y.elevation,this.tileID));let R={},N;for(let z=0;z<A.length;z++){let q=A[z];if(q===N)continue;N=q;let Z=this.featureIndexArray.get(q),oe=null;if(this.is3DTile){let ye=this.bucketLayerIDs[0][0],be=n[ye];if(be.type!=="model")continue;let{queryFeature:we,intersectionZ:$e}=be.queryIntersectsMatchingFeature(v,Z.featureIndex,p,y);we&&this.appendToResult(R,ye,Z.featureIndex,we,$e)}else this.loadMatchingFeature(R,Z,p,f.layers,f.availableImages,n,l,h,(ye,be,we,$e=0)=>(oe||(oe=eh(ye,this.tileID.canonical,e.tileTransform)),be.queryIntersectsFeature(v,ye,we,oe,this.z,e.transform,e.pixelPosMatrix,M,$e)))}return R}loadMatchingFeature(e,n,l,h,f,p,v,y,w){let{featureIndex:A,bucketIndex:M,sourceLayerIndex:R,layoutVertexArrayOffset:N}=n,z=this.bucketLayerIDs[M];if(h&&!function(ye,be){for(let we=0;we<ye.length;we++)if(be.indexOf(ye[we])>=0)return!0;return!1}(h,z))return;let q=this.sourceLayerCoder.decode(R),Z=this.vtLayers[q].feature(A);if(l.needGeometry){let ye=Vd(Z,!0);if(!l.filter(new ni(this.tileID.overscaledZ),ye,this.tileID.canonical))return}else if(!l.filter(new ni(this.tileID.overscaledZ),Z))return;let oe=this.getId(Z,q);for(let ye=0;ye<z.length;ye++){let be=z[ye];if(h&&h.indexOf(be)<0)continue;let we=p[be];if(!we)continue;let $e={};oe!==void 0&&y&&($e=y.getState(we.sourceLayer||"_geojsonTileLayer",oe));let He=!w||w(Z,we,$e,N);if(!He)continue;let rt=new BE(Z,this.z,this.x,this.y,oe),ot=Ma({},v[be]);ot.paint=jE(ot.paint,we.paint,Z,$e,f),ot.layout=jE(ot.layout,we.layout,Z,$e,f),rt.layer=ot,this.appendToResult(e,be,A,rt,He)}}appendToResult(e,n,l,h,f){let p=e[n];p===void 0&&(p=e[n]=[]),p.push({featureIndex:l,feature:h,intersectionZ:f})}lookupSymbolFeatures(e,n,l,h,f,p,v,y){let w={};this.loadVTLayers();let A=Mo(f);for(let M of e)this.loadMatchingFeature(w,{bucketIndex:l,sourceLayerIndex:h,featureIndex:M,layoutVertexArrayOffset:0},A,p,v,y,n);return w}loadFeature(e){let{featureIndex:n,sourceLayerIndex:l}=e;this.loadVTLayers();let h=this.sourceLayerCoder.decode(l),f=this.vtFeatures[h];if(f[n])return f[n];let p=this.vtLayers[h].feature(n);return f[n]=p,p}hasLayer(e){for(let n of this.bucketLayerIDs)for(let l of n)if(e===l)return!0;return!1}getId(e,n){let l=e.id;if(this.promoteId){let h=typeof this.promoteId=="string"?this.promoteId:this.promoteId[n];h!=null&&(l=e.properties[h]),typeof l=="boolean"&&(l=Number(l))}return l}}function jE(t,e,n,l,h){return Jc(t,(f,p)=>{let v=e instanceof bn?e.get(p):null;return v&&v.evaluate?v.evaluate(n,l,h):v})}function iP(t,e){return e-t}Fe(zE,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});var ls=24;let th=128;function Vb(t,e){let{expression:n}=e;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new ni(t+1))};if(n.kind==="source")return{kind:"source"};{let{zoomStops:l,interpolationType:h}=n,f=0;for(;f<l.length&&l[f]<=t;)f++;f=Math.max(0,f-1);let p=f;for(;p<l.length&&l[p]<t+1;)p++;p=Math.min(l.length-1,p);let v=l[f],y=l[p];return n.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:y,interpolationType:h}:{kind:"camera",minZoom:v,maxZoom:y,minSize:n.evaluate(new ni(v)),maxSize:n.evaluate(new ni(y)),interpolationType:h}}}function av(t,{uSize:e,uSizeT:n},{lowerSize:l,upperSize:h}){return t.kind==="source"?l/th:t.kind==="composite"?Xr(l/th,h/th,n):e}function o0(t,e){let n=0,l=0;if(t.kind==="constant")l=t.layoutSize;else if(t.kind!=="source"){let{interpolationType:h,minZoom:f,maxZoom:p}=t,v=h?ui(Es.interpolationFactor(h,e,f,p),0,1):0;t.kind==="camera"?l=Xr(t.minSize,t.maxSize,v):n=v}return{uSizeT:n,uSize:l}}var nP=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:th,evaluateSizeForFeature:av,evaluateSizeForZoom:o0,getSizeData:Vb});function aP(t,e,n){return t.sections.forEach(l=>{l.text=function(h,f,p){let v=f.layout.get("text-transform").evaluate(p,{});return v==="uppercase"?h=h.toLocaleUpperCase():v==="lowercase"&&(h=h.toLocaleLowerCase()),_n.applyArabicShaping&&(h=_n.applyArabicShaping(h)),h}(l.text,e,n)}),t}let Vg={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42","\u2190":"\u2191","\u2192":"\u2193"};function oP(t){return t==="\uFE36"||t==="\uFE48"||t==="\uFE38"||t==="\uFE44"||t==="\uFE42"||t==="\uFE3E"||t==="\uFE3C"||t==="\uFE3A"||t==="\uFE18"||t==="\uFE40"||t==="\uFE10"||t==="\uFE13"||t==="\uFE14"||t==="\uFF40"||t==="\uFFE3"||t==="\uFE11"||t==="\uFE12"}function sP(t){return t==="\uFE35"||t==="\uFE47"||t==="\uFE37"||t==="\uFE43"||t==="\uFE41"||t==="\uFE3D"||t==="\uFE3B"||t==="\uFE39"||t==="\uFE17"||t==="\uFE3F"}let Gb=3;function lP(t,e,n){e.glyphs=[],t===1&&n.readMessage(cP,e)}function cP(t,e,n){if(t===3){let{id:l,bitmap:h,width:f,height:p,left:v,top:y,advance:w}=n.readMessage(uP,{});e.glyphs.push({id:l,bitmap:new Hf({width:f+2*Gb,height:p+2*Gb},h),metrics:{width:f,height:p,left:v,top:y,advance:w}})}else t===4?e.ascender=n.readSVarint():t===5&&(e.descender=n.readSVarint())}function uP(t,e,n){t===1?e.id=n.readVarint():t===2?e.bitmap=n.readBytes():t===3?e.width=n.readVarint():t===4?e.height=n.readVarint():t===5?e.left=n.readSVarint():t===6?e.top=n.readSVarint():t===7&&(e.advance=n.readVarint())}let UE=Gb,jc={horizontal:1,vertical:2,horizontalOnly:3};class Gg{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,n){let l=new Gg;return l.scale=e||1,l.fontStack=n,l}static forImage(e){let n=new Gg;return n.imageName=e,n}}class s0{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,n){let l=new s0;for(let h=0;h<e.sections.length;h++){let f=e.sections[h];f.image?l.addImageSection(f):l.addTextSection(f,n)}return l}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCodePoint(e){return this.text.codePointAt(e)}verticalizePunctuation(e){this.text=function(n,l){let h="";for(let f=0;f<n.length;f++){let p=n.charCodeAt(f+1)||null,v=n.charCodeAt(f-1)||null;h+=!l&&(p&&Vt(p)&&!Vg[n[f+1]]||v&&Vt(v)&&!Vg[n[f-1]])||!Vg[n[f]]?n[f]:Vg[n[f]]}return h}(this.text,e)}trim(){let e=0;for(let l=0;l<this.text.length&&ov[this.text.charCodeAt(l)];l++)e++;let n=this.text.length;for(let l=this.text.length-1;l>=0&&l>=e&&ov[this.text.charCodeAt(l)];l--)n--;this.text=this.text.substring(e,n),this.sectionIndex=this.sectionIndex.slice(e,n)}substring(e,n){let l=new s0;return l.text=this.text.substring(e,n),l.sectionIndex=this.sectionIndex.slice(e,n),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,n)=>Math.max(e,this.sections[n].scale),0)}addTextSection(e,n){this.text+=e.text,this.sections.push(Gg.forText(e.scale,e.fontStack||n));let l=this.sections.length-1;for(let h=0;h<e.text.length;++h)this.sectionIndex.push(l)}addImageSection(e){let n=e.image?e.image.namePrimary:"";if(n.length===0)return void Wn("Can't add FormattedSection with an empty image.");let l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCodePoint(l),this.sections.push(Gg.forImage(n)),this.sectionIndex.push(this.sections.length-1)):Wn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Hb(t,e,n,l,h,f,p,v,y,w,A,M,R,N,z){let q=s0.fromFeature(t,h);M===jc.vertical&&q.verticalizePunctuation(R);let Z=[],oe=function(He,rt,ot,_t,Mt,At){if(!He)return[];let zt=[],Jt=function(Zt,ir,Kt,Sr,er,lr){let Zr=0;for(let zr=0;zr<Zt.length();zr++){let Or=Zt.getSection(zr);Zr+=VE(Zt.getCodePoint(zr),Or,Sr,er,ir,lr)}return Zr/Math.max(1,Math.ceil(Zr/Kt))}(He,rt,ot,_t,Mt,At),Ot=He.text.indexOf("\u200B")>=0,Xt=0;for(let Zt=0;Zt<He.length();Zt++){let ir=He.getSection(Zt),Kt=He.getCodePoint(Zt);if(ov[Kt]||(Xt+=VE(Kt,ir,_t,Mt,rt,At)),Zt<He.length()-1){let Sr=!((Dt=Kt)<11904||!(qe["Bopomofo Extended"](Dt)||qe.Bopomofo(Dt)||qe["CJK Compatibility Forms"](Dt)||qe["CJK Compatibility Ideographs"](Dt)||qe["CJK Compatibility"](Dt)||qe["CJK Radicals Supplement"](Dt)||qe["CJK Strokes"](Dt)||qe["CJK Symbols and Punctuation"](Dt)||qe["CJK Unified Ideographs Extension A"](Dt)||qe["CJK Unified Ideographs"](Dt)||qe["Enclosed CJK Letters and Months"](Dt)||qe["Halfwidth and Fullwidth Forms"](Dt)||qe.Hiragana(Dt)||qe["Ideographic Description Characters"](Dt)||qe["Kangxi Radicals"](Dt)||qe["Katakana Phonetic Extensions"](Dt)||qe.Katakana(Dt)||qe["Vertical Forms"](Dt)||qe["Yi Radicals"](Dt)||qe["Yi Syllables"](Dt)));(hP[Kt]||Sr||ir.imageName)&&zt.push(HE(Zt+1,Xt,Jt,zt,dP(Kt,He.getCodePoint(Zt+1),Sr&&Ot),!1))}}var Dt;return WE(HE(He.length(),Xt,Jt,zt,0,!0))}(q,w,f,e,l,N),{processBidirectionalText:ye,processStyledBidirectionalText:be}=_n;if(ye&&q.sections.length===1){let He=ye(q.toString(),oe);for(let rt of He){let ot=new s0;ot.text=rt,ot.sections=q.sections;for(let _t=0;_t<rt.length;_t++)ot.sectionIndex.push(0);Z.push(ot)}}else if(be){let He=be(q.text,q.sectionIndex,oe);for(let rt of He){let ot=new s0;ot.text=rt[0],ot.sectionIndex=rt[1],ot.sections=q.sections,Z.push(ot)}}else Z=function(He,rt){let ot=[],_t=He.text,Mt=0;for(let At of rt)ot.push(He.substring(Mt,At)),Mt=At;return Mt<_t.length&&ot.push(He.substring(Mt,_t.length)),ot}(q,oe);let we=[],$e={positionedLines:we,text:q.toString(),top:A[1],bottom:A[1],left:A[0],right:A[0],writingMode:M,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(He,rt,ot,_t,Mt,At,zt,Jt,Ot,Xt,Dt,Zt){let ir=0,Kt=0,Sr=0,er=Jt==="right"?1:Jt==="left"?0:.5,lr=!1;for(let vi of Mt){let ri=vi.getSections();for(let Si of ri){if(Si.imageName)continue;let yi=rt[Si.fontStack];if(yi&&(lr=yi.ascender!==void 0&&yi.descender!==void 0,!lr))break}if(!lr)break}let Zr=0;for(let vi of Mt){vi.trim();let ri=vi.getMaxScale(),Si=(ri-1)*ls,yi={positionedGlyphs:[],lineOffset:0};He.positionedLines[Zr]=yi;let Pi=yi.positionedGlyphs,ei=0;if(!vi.length()){Kt+=At,++Zr;continue}let Sn=0,wn=0;for(let Zi=0;Zi<vi.length();Zi++){let rn=vi.getSection(Zi),jn=vi.getSectionIndex(Zi),Mn=vi.getCodePoint(Zi),xa=rn.scale,fa=null,Ms=null,Ba=null,ia=ls,mo=0,Yo=!(Ot===jc.horizontal||!Dt&&!qt(Mn)||Dt&&(ov[Mn]||(zr=Mn,qe.Arabic(zr)||qe["Arabic Supplement"](zr)||qe["Arabic Extended-A"](zr)||qe["Arabic Presentation Forms-A"](zr)||qe["Arabic Presentation Forms-B"](zr))));if(rn.imageName){let Ko=_t[rn.imageName];if(!Ko)continue;Ba=rn.imageName,He.iconsInText=He.iconsInText||!0,Ms=Ko.paddedRect;let Pn=Ko.displaySize;xa=xa*ls/Zt,fa={width:Pn[0],height:Pn[1],left:0,top:-UE,advance:Yo?Pn[1]:Pn[0],localGlyph:!1},mo=lr?-fa.height*xa:ri*ls-17-Pn[1]*xa,ia=fa.advance;let pl=(Yo?Pn[0]:Pn[1])*xa-ls*ri;pl>0&&pl>ei&&(ei=pl)}else{let Ko=ot[rn.fontStack];if(!Ko)continue;Ko[Mn]&&(Ms=Ko[Mn]);let Pn=rt[rn.fontStack];if(!Pn)continue;let pl=Pn.glyphs[Mn];if(!pl)continue;if(fa=pl.metrics,ia=Mn!==8203?ls:0,lr){let $d=Pn.ascender!==void 0?Math.abs(Pn.ascender):0,yu=Pn.descender!==void 0?Math.abs(Pn.descender):0,lh=($d+yu)*xa;Sn<lh&&(Sn=lh,wn=($d-yu)/2*xa),mo=-$d*xa}else mo=(ri-xa)*ls-17}Yo?(He.verticalizable=!0,Pi.push({glyph:Mn,imageName:Ba,x:ir,y:Kt+mo,vertical:Yo,scale:xa,localGlyph:fa.localGlyph,fontStack:rn.fontStack,sectionIndex:jn,metrics:fa,rect:Ms}),ir+=ia*xa+Xt):(Pi.push({glyph:Mn,imageName:Ba,x:ir,y:Kt+mo,vertical:Yo,scale:xa,localGlyph:fa.localGlyph,fontStack:rn.fontStack,sectionIndex:jn,metrics:fa,rect:Ms}),ir+=fa.advance*xa+Xt)}Pi.length!==0&&(Sr=Math.max(ir-Xt,Sr),lr?qE(Pi,er,ei,wn,At*ri/2):qE(Pi,er,ei,0,At/2)),ir=0;let tn=At*ri+ei;yi.lineOffset=Math.max(ei,Si),Kt+=tn,++Zr}var zr;let Or=Kt,{horizontalAlign:ar,verticalAlign:Kr}=Wb(zt);(function(vi,ri,Si,yi,Pi,ei){let Sn=(ri-Si)*Pi,wn=-ei*yi;for(let tn of vi)for(let Zi of tn.positionedGlyphs)Zi.x+=Sn,Zi.y+=wn})(He.positionedLines,er,ar,Kr,Sr,Or),He.top+=-Kr*Or,He.bottom=He.top+Or,He.left+=-ar*Sr,He.right=He.left+Sr,He.hasBaseline=lr}($e,e,n,l,Z,p,v,y,M,w,R,z),!function(He){for(let rt of He)if(rt.positionedGlyphs.length!==0)return!1;return!0}(we)&&$e}let ov={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},hP={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function VE(t,e,n,l,h,f){if(e.imageName){let p=l[e.imageName];return p?p.displaySize[0]*e.scale*ls/f+h:0}{let p=n[e.fontStack],v=p&&p.glyphs[t];return v?v.metrics.advance*e.scale+h:0}}function GE(t,e,n,l){let h=Math.pow(t-e,2);return l?t<e?h/2:2*h:h+Math.abs(n)*n}function dP(t,e,n){let l=0;return t===10&&(l-=1e4),n&&(l+=150),t!==40&&t!==65288||(l+=50),e!==41&&e!==65289||(l+=50),l}function HE(t,e,n,l,h,f){let p=null,v=GE(e,n,h,f);for(let y of l){let w=GE(e-y.x,n,h,f)+y.badness;w<=v&&(p=y,v=w)}return{index:t,x:e,priorBreak:p,badness:v}}function WE(t){return t?WE(t.priorBreak).concat(t.index):[]}function Wb(t){let e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function qE(t,e,n,l,h){if(!(e||n||l||h))return;let f=t.length-1,p=t[f],v=(p.x+p.metrics.advance*p.scale)*e;for(let y=0;y<=f;y++)t[y].x-=v,t[y].y+=n+l+h}function fP(t,e,n,l){let{horizontalAlign:h,verticalAlign:f}=Wb(l),p=n[0]-t.displaySize[0]*h,v=n[1]-t.displaySize[1]*f;return{imagePrimary:t,imageSecondary:e,top:v,bottom:v+t.displaySize[1],left:p,right:p+t.displaySize[0]}}function $E(t,e,n,l,h,f){let p=t.imagePrimary,v;if(p.content){let Z=p.content,oe=p.pixelRatio||1;v=[Z[0]/oe,Z[1]/oe,p.displaySize[0]-Z[2]/oe,p.displaySize[1]-Z[3]/oe]}let y=e.left*f,w=e.right*f,A,M,R,N;n==="width"||n==="both"?(N=h[0]+y-l[3],M=h[0]+w+l[1]):(N=h[0]+(y+w-p.displaySize[0])/2,M=N+p.displaySize[0]);let z=e.top*f,q=e.bottom*f;return n==="height"||n==="both"?(A=h[1]+z-l[0],R=h[1]+q+l[2]):(A=h[1]+(z+q-p.displaySize[1])/2,R=A+p.displaySize[1]),{imagePrimary:p,imageSecondary:void 0,top:A,right:M,bottom:R,left:N,collisionPadding:v}}class qd extends hr{constructor(e,n,l,h,f){super(e,n),this.angle=h,this.z=l,f!==void 0&&(this.segment=f)}clone(){return new qd(this.x,this.y,this.z,this.angle,this.segment)}}function XE(t,e,n,l,h){if(e.segment===void 0)return!0;let f=e,p=e.segment+1,v=0;for(;v>-n/2;){if(p--,p<0)return!1;v-=t[p].dist(f),f=t[p]}v+=t[p].dist(t[p+1]),p++;let y=[],w=0;for(;v<n/2;){let A=t[p],M=t[p+1];if(!M)return!1;let R=t[p-1].angleTo(A)-A.angleTo(M);for(R=Math.abs((R+3*Math.PI)%(2*Math.PI)-Math.PI),y.push({distance:v,angleDelta:R}),w+=R;v-y[0].distance>l;)w-=y.shift().angleDelta;if(w>h)return!1;p++,v+=A.dist(M)}return!0}function ZE(t){let e=0;for(let n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function YE(t,e,n){return t?.6*e*n:0}function KE(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function pP(t,e,n,l,h,f){let p=YE(n,h,f),v=KE(n,l)*f,y=0,w=ZE(t)/2;for(let A=0;A<t.length-1;A++){let M=t[A],R=t[A+1],N=M.dist(R);if(y+N>w){let z=(w-y)/N,q=Xr(M.x,R.x,z),Z=Xr(M.y,R.y,z),oe=new qd(q,Z,0,R.angleTo(M),A);return!p||XE(t,oe,v,p,e)?oe:void 0}y+=N}}function mP(t,e,n,l,h,f,p,v,y){let w=YE(l,f,p),A=KE(l,h),M=A*p,R=t[0].x===0||t[0].x===y||t[0].y===0||t[0].y===y;return e-M<e/4&&(e=M+e/4),JE(t,R?e/2*v%e:(A/2+2*f)*p*v%e,e,w,n,M,R,!1,y)}function JE(t,e,n,l,h,f,p,v,y){let w=f/2,A=ZE(t),M=0,R=e-n,N=[];for(let z=0;z<t.length-1;z++){let q=t[z],Z=t[z+1],oe=q.dist(Z),ye=Z.angleTo(q);for(;R+n<M+oe;){R+=n;let be=(R-M)/oe,we=Xr(q.x,Z.x,be),$e=Xr(q.y,Z.y,be);if(we>=0&&we<y&&$e>=0&&$e<y&&R-w>=0&&R+w<=A){let He=new qd(we,$e,0,ye,z);l&&!XE(t,He,f,l,h)||N.push(He)}}M+=oe}return v||N.length||p||(N=JE(t,M/2,n,l,h,f,p,!0,y)),N}function QE(t,e,n,l,h){let f=[];for(let p=0;p<t.length;p++){let v=t[p],y;for(let w=0;w<v.length-1;w++){let A=v[w],M=v[w+1];A.x<e&&M.x<e||(A.x<e?A=new hr(e,A.y+(e-A.x)/(M.x-A.x)*(M.y-A.y))._round():M.x<e&&(M=new hr(e,A.y+(e-A.x)/(M.x-A.x)*(M.y-A.y))._round()),A.y<n&&M.y<n||(A.y<n?A=new hr(A.x+(n-A.y)/(M.y-A.y)*(M.x-A.x),n)._round():M.y<n&&(M=new hr(A.x+(n-A.y)/(M.y-A.y)*(M.x-A.x),n)._round()),A.x>=l&&M.x>=l||(A.x>=l?A=new hr(l,A.y+(l-A.x)/(M.x-A.x)*(M.y-A.y))._round():M.x>=l&&(M=new hr(l,A.y+(l-A.x)/(M.x-A.x)*(M.y-A.y))._round()),A.y>=h&&M.y>=h||(A.y>=h?A=new hr(A.x+(h-A.y)/(M.y-A.y)*(M.x-A.x),h)._round():M.y>=h&&(M=new hr(A.x+(h-A.y)/(M.y-A.y)*(M.x-A.x),h)._round()),y&&A.equals(y[y.length-1])||(y=[A],f.push(y)),y.push(M)))))}}return f}function eA(t){let e=0,n=0;for(let p of t)e+=p.w*p.h,n=Math.max(n,p.w);t.sort((p,v)=>v.h-p.h);let l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}],h=0,f=0;for(let p of t)for(let v=l.length-1;v>=0;v--){let y=l[v];if(!(p.w>y.w||p.h>y.h)){if(p.x=y.x,p.y=y.y,f=Math.max(f,p.y+p.h),h=Math.max(h,p.x+p.w),p.w===y.w&&p.h===y.h){let w=l.pop();v<l.length&&(l[v]=w)}else p.h===y.h?(y.x+=p.w,y.w-=p.w):p.w===y.w?(y.y+=p.h,y.h-=p.h):(l.push({x:y.x+p.w,y:y.y,w:y.w-p.w,h:p.h}),y.y+=p.h,y.h-=p.h);break}}return{w:h,h:f,fill:e/(h*f)||0}}Fe(qd,"Anchor");let ic=1;class qb{constructor(e,{pixelRatio:n,version:l,stretchX:h,stretchY:f,content:p}){this.paddedRect=e,this.pixelRatio=n,this.stretchX=h,this.stretchY=f,this.content=p,this.version=l}get tl(){return[this.paddedRect.x+ic,this.paddedRect.y+ic]}get br(){return[this.paddedRect.x+this.paddedRect.w-ic,this.paddedRect.y+this.paddedRect.h-ic]}get displaySize(){return[(this.paddedRect.w-2*ic)/this.pixelRatio,(this.paddedRect.h-2*ic)/this.pixelRatio]}}class tA{constructor(e,n,l){let h={},f={};this.haveRenderCallbacks=[];let p=[];this.addImages(e,h,p),this.addImages(n,f,p);let{w:v,h:y}=eA(p),w=new zc({width:v||1,height:y||1});for(let A in e){let M=e[A],R=h[A].paddedRect;zc.copy(M.data,w,{x:0,y:0},{x:R.x+ic,y:R.y+ic},M.data,l,M.sdf)}for(let A in n){let M=n[A],R=f[A].paddedRect,N=R.x+ic,z=R.y+ic,q=M.data.width,Z=M.data.height;zc.copy(M.data,w,{x:0,y:0},{x:N,y:z},M.data,l),zc.copy(M.data,w,{x:0,y:Z-1},{x:N,y:z-1},{width:q,height:1},l),zc.copy(M.data,w,{x:0,y:0},{x:N,y:z+Z},{width:q,height:1},l),zc.copy(M.data,w,{x:q-1,y:0},{x:N-1,y:z},{width:1,height:Z},l),zc.copy(M.data,w,{x:0,y:0},{x:N+q,y:z},{width:1,height:Z},l)}this.image=w,this.iconPositions=h,this.patternPositions=f}addImages(e,n,l){for(let h in e){let f=e[h],p={x:0,y:0,w:f.data.width+2*ic,h:f.data.height+2*ic};l.push(p),n[h]=new qb(p,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(e,n,l){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(h=>e.hasImage(h,l)),e.dispatchRenderCallbacks(this.haveRenderCallbacks,l);for(let h in e.getUpdatedImages(l))this.patchUpdatedImage(this.iconPositions[h],e.getImage(h,l),n),this.patchUpdatedImage(this.patternPositions[h],e.getImage(h,l),n)}patchUpdatedImage(e,n,l){if(!e||!n||e.version===n.version)return;e.version=n.version;let[h,f]=e.tl,p=!!Object.keys(this.patternPositions).length;l.update(n.data,{useMipmap:p},{x:h,y:f})}}Fe(qb,"ImagePosition"),Fe(tA,"ImageAtlas");let Hg=1e20;function rA(t,e,n,l,h,f,p,v,y){for(let w=e;w<e+l;w++)iA(t,n*f+w,f,h,p,v,y);for(let w=n;w<n+h;w++)iA(t,w*f+e,1,l,p,v,y)}function iA(t,e,n,l,h,f,p){f[0]=0,p[0]=-Hg,p[1]=Hg,h[0]=t[e];for(let v=1,y=0,w=0;v<l;v++){h[v]=t[e+v*n];let A=v*v;do{let M=f[y];w=(h[v]-h[M]+A-M*M)/(v-M)/2}while(w<=p[y]&&--y>-1);y++,f[y]=v,p[y]=w,p[y+1]=Hg}for(let v=0,y=0;v<l;v++){for(;p[y+1]<v;)y++;let w=f[y],A=v-w;t[e+v*n]=h[w]+A*A}}let rh=2,$b={none:0,ideographs:1,all:2};class l0{constructor(e,n,l){this.requestManager=e,this.localGlyphMode=n,this.localFontFamily=l,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e,n){this.urls[n]=e}getGlyphs(e,n,l){let h=[],f=this.urls[n]||E.GLYPHS_URL;for(let p in e)for(let v of e[p])h.push({stack:p,id:v});bc(h,({stack:p,id:v},y)=>{let w=this.entries[p];w||(w=this.entries[p]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let A=w.glyphs[v];if(A!==void 0)return void y(null,{stack:p,id:v,glyph:A});if(A=this._tinySDF(w,p,v),A)return w.glyphs[v]=A,void y(null,{stack:p,id:v,glyph:A});let M=Math.floor(v/256);if(256*M>65535)return void y(new Error("glyphs > 65535 not supported"));if(w.ranges[M])return void y(null,{stack:p,id:v,glyph:A});let R=w.requests[M];R||(R=w.requests[M]=[],l0.loadGlyphRange(p,M,f,this.requestManager,(N,z)=>{if(z){w.ascender=z.ascender,w.descender=z.descender;for(let q in z.glyphs)this._doesCharSupportLocalGlyph(+q)||(w.glyphs[+q]=z.glyphs[+q]);w.ranges[M]=!0}for(let q of R)q(N,z);delete w.requests[M]})),R.push((N,z)=>{N?y(N):z&&y(null,{stack:p,id:v,glyph:z.glyphs[v]||null})})},(p,v)=>{if(p)l(p);else if(v){let y={};for(let{stack:w,id:A,glyph:M}of v)y[w]===void 0&&(y[w]={}),y[w].glyphs===void 0&&(y[w].glyphs={}),y[w].glyphs[A]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics},y[w].ascender=this.entries[w].ascender,y[w].descender=this.entries[w].descender;l(null,y)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==$b.none&&(this.localGlyphMode===$b.all?!!this.localFontFamily:!!this.localFontFamily&&(qe["CJK Unified Ideographs"](e)||qe["Hangul Syllables"](e)||qe.Hiragana(e)||qe.Katakana(e)||qe["CJK Symbols and Punctuation"](e)||qe["CJK Unified Ideographs Extension A"](e)||qe["CJK Unified Ideographs Extension B"](e)))}_tinySDF(e,n,l){let h=this.localFontFamily;if(!h||!this._doesCharSupportLocalGlyph(l))return;let f=e.tinySDF;if(!f){let q="400";/bold/i.test(n)?q="900":/medium/i.test(n)?q="500":/light/i.test(n)&&(q="200"),f=e.tinySDF=new l0.TinySDF({fontFamily:h,fontWeight:q,fontSize:24*rh,buffer:3*rh,radius:8*rh}),f.fontWeight=q}if(this.localGlyphs[f.fontWeight][l])return this.localGlyphs[f.fontWeight][l];let p=String.fromCodePoint(l),{data:v,width:y,height:w,glyphWidth:A,glyphHeight:M,glyphLeft:R,glyphTop:N,glyphAdvance:z}=f.draw(p);return this.localGlyphs[f.fontWeight][l]={id:l,bitmap:new Hf({width:y,height:w},v),metrics:{width:A/rh,height:M/rh,left:R/rh,top:N/rh-27,advance:z/rh,localGlyph:!0}}}}l0.loadGlyphRange=function(t,e,n,l,h){let f=256*e,p=f+255,v=l.transformRequest(l.normalizeGlyphsURL(n).replace("{fontstack}",t).replace("{range}",`${f}-${p}`),Ec.Glyphs);ho(v,(y,w)=>{if(y)h(y);else if(w){let A={},M=function(R){return new a0(R).readFields(lP,{})}(w);for(let R of M.glyphs)A[R.id]=R;h(null,{glyphs:A,ascender:M.ascender,descender:M.descender})}})},l0.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:n=8,cutoff:l=.25,fontFamily:h="sans-serif",fontWeight:f="normal",fontStyle:p="normal"}={}){this.buffer=e,this.cutoff=l,this.radius=n;let v=this.size=t+4*e,y=this._createCanvas(v),w=this.ctx=y.getContext("2d",{willReadFrequently:!0});w.font=`${p} ${f} ${t}px ${h}`,w.textBaseline="alphabetic",w.textAlign="left",w.fillStyle="black",this.gridOuter=new Float64Array(v*v),this.gridInner=new Float64Array(v*v),this.f=new Float64Array(v),this.z=new Float64Array(v+1),this.v=new Uint16Array(v)}_createCanvas(t){let e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){let{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:l,actualBoundingBoxLeft:h,actualBoundingBoxRight:f}=this.ctx.measureText(t),p=Math.ceil(n),v=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(f-h))),y=Math.min(this.size-this.buffer,p+Math.ceil(l)),w=v+2*this.buffer,A=y+2*this.buffer,M=Math.max(w*A,0),R=new Uint8ClampedArray(M),N={data:R,width:w,height:A,glyphWidth:v,glyphHeight:y,glyphTop:p,glyphLeft:0,glyphAdvance:e};if(v===0||y===0)return N;let{ctx:z,buffer:q,gridInner:Z,gridOuter:oe}=this;z.clearRect(q,q,v,y),z.fillText(t,q,q+p);let ye=z.getImageData(q,q,v,y);oe.fill(Hg,0,M),Z.fill(0,0,M);for(let be=0;be<y;be++)for(let we=0;we<v;we++){let $e=ye.data[4*(be*v+we)+3]/255;if($e===0)continue;let He=(be+q)*w+we+q;if($e===1)oe[He]=0,Z[He]=Hg;else{let rt=.5-$e;oe[He]=rt>0?rt*rt:0,Z[He]=rt<0?rt*rt:0}}rA(oe,0,0,w,A,w,this.f,this.v,this.z),rA(Z,q,q,v,y,w,this.f,this.v,this.z);for(let be=0;be<M;be++){let we=Math.sqrt(oe[be])-Math.sqrt(Z[be]);R[be]=Math.round(255-255*(we/this.radius+this.cutoff))}return N}};let $f=ic;function nA(t,e,n,l){let h=[],f=t.imagePrimary,p=f.pixelRatio,v=f.paddedRect.w-2*$f,y=f.paddedRect.h-2*$f,w=t.right-t.left,A=t.bottom-t.top,M=f.stretchX||[[0,v]],R=f.stretchY||[[0,y]],N=(At,zt)=>At+zt[1]-zt[0],z=M.reduce(N,0),q=R.reduce(N,0),Z=v-z,oe=y-q,ye=0,be=z,we=0,$e=q,He=0,rt=Z,ot=0,_t=oe;if(f.content&&l){let At=f.content;ye=sv(M,0,At[0]),we=sv(R,0,At[1]),be=sv(M,At[0],At[2]),$e=sv(R,At[1],At[3]),He=At[0]-ye,ot=At[1]-we,rt=At[2]-At[0]-be,_t=At[3]-At[1]-$e}let Mt=(At,zt,Jt,Ot)=>{let Xt=lv(At.stretch-ye,be,w,t.left),Dt=cv(At.fixed-He,rt,At.stretch,z),Zt=lv(zt.stretch-we,$e,A,t.top),ir=cv(zt.fixed-ot,_t,zt.stretch,q),Kt=lv(Jt.stretch-ye,be,w,t.left),Sr=cv(Jt.fixed-He,rt,Jt.stretch,z),er=lv(Ot.stretch-we,$e,A,t.top),lr=cv(Ot.fixed-ot,_t,Ot.stretch,q),Zr=new hr(Xt,Zt),zr=new hr(Kt,Zt),Or=new hr(Kt,er),ar=new hr(Xt,er),Kr=new hr(Dt/p,ir/p),vi=new hr(Sr/p,lr/p),ri=e*Math.PI/180;if(ri){let wn=Math.sin(ri),tn=Math.cos(ri),Zi=[tn,-wn,wn,tn];Zr._matMult(Zi),zr._matMult(Zi),ar._matMult(Zi),Or._matMult(Zi)}let Si=At.stretch+At.fixed,yi=Jt.stretch+Jt.fixed,Pi=zt.stretch+zt.fixed,ei=Ot.stretch+Ot.fixed,Sn=t.imageSecondary;return{tl:Zr,tr:zr,bl:ar,br:Or,texPrimary:{x:f.paddedRect.x+$f+Si,y:f.paddedRect.y+$f+Pi,w:yi-Si,h:ei-Pi},texSecondary:Sn?{x:Sn.paddedRect.x+$f+Si,y:Sn.paddedRect.y+$f+Pi,w:yi-Si,h:ei-Pi}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Kr,pixelOffsetBR:vi,minFontScaleX:rt/p/w,minFontScaleY:_t/p/A,isSDF:n}};if(l&&(f.stretchX||f.stretchY)){let At=aA(M,Z,z),zt=aA(R,oe,q);for(let Jt=0;Jt<At.length-1;Jt++){let Ot=At[Jt],Xt=At[Jt+1];for(let Dt=0;Dt<zt.length-1;Dt++)h.push(Mt(Ot,zt[Dt],Xt,zt[Dt+1]))}}else h.push(Mt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:y+1}));return h}function sv(t,e,n){let l=0;for(let h of t)l+=Math.max(e,Math.min(n,h[1]))-Math.max(e,Math.min(n,h[0]));return l}function aA(t,e,n){let l=[{fixed:-$f,stretch:0}];for(let[h,f]of t){let p=l[l.length-1];l.push({fixed:h-p.stretch,stretch:p.stretch}),l.push({fixed:h-p.stretch,stretch:p.stretch+(f-h)})}return l.push({fixed:e+$f,stretch:n}),l}function lv(t,e,n,l){return t/e*n+l}function cv(t,e,n,l){return t-e*n/l}function gP(t,e,n,l){let h=e+t.positionedLines[l].lineOffset;return l===0?n+h/2:n+(h+(e+t.positionedLines[l-1].lineOffset))/2}function _P(t,e=1,n=!1){let l=1/0,h=1/0,f=-1/0,p=-1/0,v=t[0];for(let N=0;N<v.length;N++){let z=v[N];(!N||z.x<l)&&(l=z.x),(!N||z.y<h)&&(h=z.y),(!N||z.x>f)&&(f=z.x),(!N||z.y>p)&&(p=z.y)}let y=Math.min(f-l,p-h),w=y/2,A=new St([],vP);if(y===0)return new hr(l,h);for(let N=l;N<f;N+=y)for(let z=h;z<p;z+=y)A.push(new c0(N+w,z+w,w,t));let M=function(N){let z=0,q=0,Z=0,oe=N[0];for(let ye=0,be=oe.length,we=be-1;ye<be;we=ye++){let $e=oe[ye],He=oe[we],rt=$e.x*He.y-He.x*$e.y;q+=($e.x+He.x)*rt,Z+=($e.y+He.y)*rt,z+=3*rt}return new c0(q/z,Z/z,0,N)}(t),R=A.length;for(;A.length;){let N=A.pop();(N.d>M.d||!M.d)&&(M=N,n&&console.log("found best %d after %d probes",Math.round(1e4*N.d)/1e4,R)),N.max-M.d<=e||(w=N.h/2,A.push(new c0(N.p.x-w,N.p.y-w,w,t)),A.push(new c0(N.p.x+w,N.p.y-w,w,t)),A.push(new c0(N.p.x-w,N.p.y+w,w,t)),A.push(new c0(N.p.x+w,N.p.y+w,w,t)),R+=4)}return n&&(console.log(`num probes: ${R}`),console.log(`best distance: ${M.d}`)),M.p}function vP(t,e){return e.max-t.max}class c0{constructor(e,n,l,h){this.p=new hr(e,n),this.h=l,this.d=function(f,p){let v=!1,y=1/0;for(let w=0;w<p.length;w++){let A=p[w];for(let M=0,R=A.length,N=R-1;M<R;N=M++){let z=A[M],q=A[N];z.y>f.y!=q.y>f.y&&f.x<(q.x-z.x)*(f.y-z.y)/(q.y-z.y)+z.x&&(v=!v),y=Math.min(y,dS(f,z,q))}}return(v?1:-1)*Math.sqrt(y)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}}let Xb=Number.POSITIVE_INFINITY,yP=Math.sqrt(2);function oA(t,[e,n]){let l=0,h=0;if(n===Xb){e<0&&(e=0);let f=e/yP;switch(t){case"top-right":case"top-left":h=f-7;break;case"bottom-right":case"bottom-left":h=7-f;break;case"bottom":h=7-e;break;case"top":h=e-7}switch(t){case"top-right":case"bottom-right":l=-f;break;case"top-left":case"bottom-left":l=f;break;case"left":l=e;break;case"right":l=-e}}else{switch(e=Math.abs(e),n=Math.abs(n),t){case"top-right":case"top-left":case"top":h=n-7;break;case"bottom-right":case"bottom-left":case"bottom":h=7-n}switch(t){case"top-right":case"bottom-right":case"right":l=-e;break;case"top-left":case"bottom-left":case"left":l=e}}return[l,h]}function Zb(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function xP(t,e,n,l,h,f,p,v,y,w,A,M,R,N,z){let q=f.textMaxSize.evaluate(e,{},M);q===void 0&&(q=p);let Z=t.layers[0].layout,oe=Z.get("icon-offset").evaluate(e,{},M),ye=lA(n.horizontal)||n.vertical,be=R.name==="globe",we=ls,$e=p/we,He=t.tilePixelRatio*q/we,rt=(Xt=t.overscaling,t.zoom>18&&Xt>2&&(Xt>>=1),Math.max(it/(512*Xt),1)*Z.get("symbol-spacing")),ot=Z.get("text-padding")*t.tilePixelRatio,_t=Z.get("icon-padding")*t.tilePixelRatio,Mt=Ai(Z.get("text-max-angle")),At=Z.get("text-rotation-alignment")==="map"&&Z.get("symbol-placement")!=="point",zt=Z.get("icon-rotation-alignment")==="map"&&Z.get("symbol-placement")!=="point",Jt=Z.get("symbol-placement"),Ot=rt/2;var Xt;let Dt=Z.get("icon-text-fit").evaluate(e,{},M),Zt=Z.get("icon-text-fit-padding").evaluate(e,{},M),ir=Dt!=="none",Kt;t.hasAnyIconTextFit===!1&&ir&&(t.hasAnyIconTextFit=!0),l&&ir&&(t.allowVerticalPlacement&&n.vertical&&(Kt=$E(l,n.vertical,Dt,Zt,oe,$e)),ye&&(l=$E(l,ye,Dt,Zt,oe,$e)));let Sr=(er,lr,Zr)=>{if(lr.x<0||lr.x>=it||lr.y<0||lr.y>=it)return;let zr=null;if(be){let{x:Or,y:ar,z:Kr}=R.projectTilePoint(lr.x,lr.y,Zr);zr={anchor:new qd(Or,ar,Kr,0,void 0),up:R.upVector(Zr,lr.x,lr.y)}}(function(Or,ar,Kr,vi,ri,Si,yi,Pi,ei,Sn,wn,tn,Zi,rn,jn,Mn,xa,fa,Ms,Ba,ia,mo,Yo,Ko,Pn,pl,$d){let yu=Or.addToLineVertexArray(ar,vi),lh,ep,tp,im,cC,uC,hC,dC=0,fC=0,pC=0,mC=0,S2=-1,E2=-1,Jh={},gC=ca(""),nm=Kr?Kr.anchor:ar,A2=ei.layout.get("icon-text-fit").evaluate(ia,{},Pn)!=="none",C2=0,I2=0;if(ei._unevaluatedLayout.getValue("text-radial-offset")===void 0?[C2,I2]=ei.layout.get("text-offset").evaluate(ia,{},Pn).map(ac=>ac*ls):(C2=ei.layout.get("text-radial-offset").evaluate(ia,{},Pn)*ls,I2=Xb),Or.allowVerticalPlacement&&ri.vertical){let ac=ri.vertical;if(jn)uC=Yb(ac),Pi&&(hC=Yb(Pi));else{let oc=ei.layout.get("text-rotate").evaluate(ia,{},Pn)+90;tp=uv(Sn,nm,ar,wn,tn,Zi,ac,rn,oc,Mn),Pi&&(im=uv(Sn,nm,ar,wn,tn,Zi,Pi,fa,oc))}}if(Si){let ac=ei.layout.get("icon-rotate").evaluate(ia,{},Pn),oc=nA(Si,ac,Yo,A2),v0=Pi?nA(Pi,ac,Yo,A2):void 0;ep=uv(Sn,nm,ar,wn,tn,Zi,Si,fa,ac),dC=4*oc.length;let _C=Or.iconSizeData,am=null;_C.kind==="source"?(am=[th*ei.layout.get("icon-size").evaluate(ia,{},Pn)],am[0]>Xf&&Wn(`${Or.layerIds[0]}: Value for "icon-size" is >= ${Wg}. Reduce your "icon-size".`)):_C.kind==="composite"&&(am=[th*mo.compositeIconSizes[0].evaluate(ia,{},Pn),th*mo.compositeIconSizes[1].evaluate(ia,{},Pn)],(am[0]>Xf||am[1]>Xf)&&Wn(`${Or.layerIds[0]}: Value for "icon-size" is >= ${Wg}. Reduce your "icon-size".`)),Or.addSymbols(Or.icon,oc,am,Ba,Ms,ia,!1,Kr,ar,yu.lineStartIndex,yu.lineLength,-1,Ko,Pn,pl,$d),S2=Or.icon.placedSymbolArray.length-1,v0&&(fC=4*v0.length,Or.addSymbols(Or.icon,v0,am,Ba,Ms,ia,jc.vertical,Kr,ar,yu.lineStartIndex,yu.lineLength,-1,Ko,Pn,pl,$d),E2=Or.icon.placedSymbolArray.length-1)}for(let ac in ri.horizontal){let oc=ri.horizontal[ac];lh||(gC=ca(oc.text),jn?cC=Yb(oc):lh=uv(Sn,nm,ar,wn,tn,Zi,oc,rn,ei.layout.get("text-rotate").evaluate(ia,{},Pn),Mn));let v0=oc.positionedLines.length===1;if(pC+=sA(Or,Kr,ar,oc,yi,ei,jn,ia,Mn,yu,ri.vertical?jc.horizontal:jc.horizontalOnly,v0?Object.keys(ri.horizontal):[ac],Jh,S2,mo,Ko,Pn,pl),v0)break}ri.vertical&&(mC+=sA(Or,Kr,ar,ri.vertical,yi,ei,jn,ia,Mn,yu,jc.vertical,["vertical"],Jh,E2,mo,Ko,Pn,pl));let rp=-1,k2=(ac,oc)=>ac?Math.max(ac,oc):oc;rp=k2(cC,rp),rp=k2(uC,rp),rp=k2(hC,rp);let zL=rp>-1?1:0;Or.glyphOffsetArray.length>=65535&&Wn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ia.sortKey!==void 0&&Or.addToSortKeyRanges(Or.symbolInstances.length,ia.sortKey),Or.symbolInstances.emplaceBack(ar.x,ar.y,nm.x,nm.y,nm.z,Jh.right>=0?Jh.right:-1,Jh.center>=0?Jh.center:-1,Jh.left>=0?Jh.left:-1,Jh.vertical>=0?Jh.vertical:-1,S2,E2,gC,lh!==void 0?lh:Or.collisionBoxArray.length,lh!==void 0?lh+1:Or.collisionBoxArray.length,tp!==void 0?tp:Or.collisionBoxArray.length,tp!==void 0?tp+1:Or.collisionBoxArray.length,ep!==void 0?ep:Or.collisionBoxArray.length,ep!==void 0?ep+1:Or.collisionBoxArray.length,im||Or.collisionBoxArray.length,im?im+1:Or.collisionBoxArray.length,wn,pC,mC,dC,fC,zL,0,C2,I2,rp,0,1,1,A2?1:0)})(t,lr,zr,er,n,l,h,Kt,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,ot,At,y,0,_t,zt,oe,e,f,w,A,M,N,z)};if(Jt==="line")for(let er of QE(e.geometry,0,0,it,it)){let lr=mP(er,rt,Mt,n.vertical||ye,l,we,He,t.overscaling,it);for(let Zr of lr)ye&&bP(t,ye.text,Ot,Zr)||Sr(er,Zr,M)}else if(Jt==="line-center"){for(let er of e.geometry)if(er.length>1){let lr=pP(er,Mt,n.vertical||ye,l,we,He);lr&&Sr(er,lr,M)}}else if(e.type==="Polygon")for(let er of q1(e.geometry,0)){let lr=_P(er,16);Sr(er[0],new qd(lr.x,lr.y,0,0,void 0),M)}else if(e.type==="LineString")for(let er of e.geometry)Sr(er,new qd(er[0].x,er[0].y,0,0,void 0),M);else if(e.type==="Point")for(let er of e.geometry)for(let lr of er)Sr([lr],new qd(lr.x,lr.y,0,0,void 0),M)}let Wg=255,Xf=Wg*th;function sA(t,e,n,l,h,f,p,v,y,w,A,M,R,N,z,q,Z,oe){let ye=function($e,He,rt,ot,_t,Mt,At,zt){let Jt=[];if(He.positionedLines.length===0)return Jt;let Ot=ot.layout.get("text-rotate").evaluate(Mt,{})*Math.PI/180,Xt=function(Sr){let er=Sr[0],lr=Sr[1],Zr=er*lr;return Zr>0?[er,-lr]:Zr<0?[-er,lr]:er===0?[lr,er]:[lr,-er]}(rt),Dt=Math.abs(He.top-He.bottom);for(let Sr of He.positionedLines)Dt-=Sr.lineOffset;let Zt=He.positionedLines.length,ir=Dt/Zt,Kt=He.top-rt[1];for(let Sr=0;Sr<Zt;++Sr){let er=He.positionedLines[Sr];Kt=gP(He,ir,Kt,Sr);for(let lr of er.positionedGlyphs){if(!lr.rect)continue;let Zr=lr.rect||{},zr=UE+1,Or=!0,ar=1,Kr=0;if(lr.imageName){let Ba=At[lr.imageName];if(!Ba)continue;if(Ba.sdf){Wn("SDF images are not supported in formatted text and will be ignored.");continue}Or=!1,ar=Ba.pixelRatio,zr=ic/ar}let vi=(_t||zt)&&lr.vertical,ri=lr.metrics.advance*lr.scale/2,Si=lr.metrics,yi=lr.rect;if(yi===null)continue;zt&&He.verticalizable&&(Kr=lr.imageName?ri-lr.metrics.width*lr.scale/2:0);let Pi=_t?[lr.x+ri,lr.y]:[0,0],ei=[0,0],Sn=[0,0],wn=!1;_t||(vi?(Sn=[lr.x+ri+Xt[0],lr.y+Xt[1]-Kr],wn=!0):ei=[lr.x+ri+rt[0],lr.y+rt[1]-Kr]);let tn=yi.w*lr.scale/(ar*(lr.localGlyph?rh:1)),Zi=yi.h*lr.scale/(ar*(lr.localGlyph?rh:1)),rn,jn,Mn,xa;if(vi){let Ba=lr.y-Kt,ia=new hr(-ri,ri-Ba),mo=-Math.PI/2,Yo=new hr(...Sn);rn=new hr(-ri+ei[0],ei[1]),rn._rotateAround(mo,ia)._add(Yo),rn.x+=-Ba+ri,rn.y-=(Si.left-zr)*lr.scale;let Ko=lr.imageName?Si.advance*lr.scale:ls*lr.scale,Pn=String.fromCodePoint(lr.glyph);oP(Pn)?rn.x+=(1-zr)*lr.scale:sP(Pn)?rn.x+=Ko-Si.height*lr.scale+(-zr-1)*lr.scale:rn.x+=lr.imageName||Si.width+2*zr===yi.w&&Si.height+2*zr===yi.h?(Ko-Zi)/2:(Ko-(Si.height+2*zr)*lr.scale)/2,jn=new hr(rn.x,rn.y-tn),Mn=new hr(rn.x+Zi,rn.y),xa=new hr(rn.x+Zi,rn.y-tn)}else{let Ba=(Si.left-zr)*lr.scale-ri+ei[0],ia=(-Si.top-zr)*lr.scale+ei[1],mo=Ba+tn,Yo=ia+Zi;rn=new hr(Ba,ia),jn=new hr(mo,ia),Mn=new hr(Ba,Yo),xa=new hr(mo,Yo)}if(Ot){let Ba;Ba=_t?new hr(0,0):wn?new hr(Xt[0],Xt[1]):new hr(rt[0],rt[1]),rn._rotateAround(Ot,Ba),jn._rotateAround(Ot,Ba),Mn._rotateAround(Ot,Ba),xa._rotateAround(Ot,Ba)}let fa=new hr(0,0),Ms=new hr(0,0);Jt.push({tl:rn,tr:jn,bl:Mn,br:xa,texPrimary:Zr,texSecondary:void 0,writingMode:He.writingMode,glyphOffset:Pi,sectionIndex:lr.sectionIndex,isSDF:Or,pixelOffsetTL:fa,pixelOffsetBR:Ms,minFontScaleX:0,minFontScaleY:0})}}return Jt}(0,l,y,f,p,v,h,t.allowVerticalPlacement),be=t.textSizeData,we=null;be.kind==="source"?(we=[th*f.layout.get("text-size").evaluate(v,{},Z)],we[0]>Xf&&Wn(`${t.layerIds[0]}: Value for "text-size" is >= ${Wg}. Reduce your "text-size".`)):be.kind==="composite"&&(we=[th*z.compositeTextSizes[0].evaluate(v,{},Z),th*z.compositeTextSizes[1].evaluate(v,{},Z)],(we[0]>Xf||we[1]>Xf)&&Wn(`${t.layerIds[0]}: Value for "text-size" is >= ${Wg}. Reduce your "text-size".`)),t.addSymbols(t.text,ye,we,y,p,v,A,e,n,w.lineStartIndex,w.lineLength,N,q,Z,oe,!1);for(let $e of M)R[$e]=t.text.placedSymbolArray.length-1;return 4*ye.length}function lA(t){for(let e in t)return t[e];return null}function uv(t,e,n,l,h,f,p,v,y,w){let A=p.top,M=p.bottom,R=p.left,N=p.right,z=p.collisionPadding;if(z&&(R-=z[0],A-=z[1],N+=z[2],M+=z[3]),y){let q=new hr(R,A),Z=new hr(N,A),oe=new hr(R,M),ye=new hr(N,M),be=Ai(y),we=new hr(0,0);w&&(we=new hr(w[0],w[1])),q._rotateAround(be,we),Z._rotateAround(be,we),oe._rotateAround(be,we),ye._rotateAround(be,we),R=Math.min(q.x,Z.x,oe.x,ye.x),N=Math.max(q.x,Z.x,oe.x,ye.x),A=Math.min(q.y,Z.y,oe.y,ye.y),M=Math.max(q.y,Z.y,oe.y,ye.y)}return t.emplaceBack(e.x,e.y,e.z,n.x,n.y,R,A,N,M,v,l,h,f),t.length-1}function Yb(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);let e=t.bottom-t.top;return e>0?Math.max(10,e):null}function bP(t,e,n,l){let h=t.compareText;if(e in h){let f=h[e];for(let p=f.length-1;p>=0;p--)if(l.dist(f[p])<n)return!0}else h[e]=[];return h[e].push(l),!1}function cA(t,e){let n=t.fovAboveCenter,l=t.elevation?t.elevation.getMinElevationBelowMSL()*e:0,h=(t._camera.position[2]*t.worldSize-l)/Math.cos(t._pitch),f=Math.sin(n)*h/Math.sin(Math.max(Math.PI/2-t._pitch-n,.01)),p=Math.sin(t._pitch)*f+h;return Math.min(1.01*p,h*(1/t._horizonShift))}function Jp(t,e){if(!e.isReprojectedInTileSpace)return{scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};let n=Math.pow(2,-t.z),l=t.x*n,h=(t.x+1)*n,f=t.y*n,p=(t.y+1)*n,v=Nl(l),y=Nl(h),w=Zo(f),A=Zo(p),M=e.project(v,w),R=e.project(y,w),N=e.project(y,A),z=e.project(v,A),q=Math.min(M.x,R.x,N.x,z.x),Z=Math.min(M.y,R.y,N.y,z.y),oe=Math.max(M.x,R.x,N.x,z.x),ye=Math.max(M.y,R.y,N.y,z.y),be=n/16;function we(He,rt,ot,_t,Mt,At){let zt=(ot+Mt)/2,Jt=(_t+At)/2,Ot=e.project(Nl(zt),Zo(Jt)),Xt=Math.max(0,q-Ot.x,Z-Ot.y,Ot.x-oe,Ot.y-ye);q=Math.min(q,Ot.x),oe=Math.max(oe,Ot.x),Z=Math.min(Z,Ot.y),ye=Math.max(ye,Ot.y),Xt>be&&(we(He,Ot,ot,_t,zt,Jt),we(Ot,rt,zt,Jt,Mt,At))}we(M,R,l,f,h,f),we(R,N,h,f,h,p),we(N,z,h,p,l,p),we(z,M,l,p,l,f),q-=be,Z-=be,oe+=be,ye+=be;let $e=1/Math.max(oe-q,ye-Z);return{scale:$e,x:q*$e,y:Z*$e,x2:oe*$e,y2:ye*$e,projection:e}}function uA(t,{x:e,y:n},l=0){return new hr(((e-l)*t.scale-t.x)*it,(n*t.scale-t.y)*it)}let wP=r.ad.identity(new Float32Array(16));class Zf{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,n){return{x:0,y:0,z:0}}unproject(e,n){return new en(0,0)}projectTilePoint(e,n,l){return{x:e,y:n,z:0}}locationPoint(e,n,l=!0){return e._coordinatePoint(e.locationCoordinate(n),l)}pixelsPerMeter(e,n){return fl(1,e)*n}pixelSpaceConversion(e,n,l){return 1}farthestPixelDistance(e){return cA(e,e.pixelsPerMeter)}pointCoordinate(e,n,l,h){let f=e.horizonLineFromTop(!1),p=new hr(n,Math.max(f,l));return e.rayIntersectionCoordinate(e.pointRayIntersection(p,h))}pointCoordinate3D(e,n,l){let h=new hr(n,l);if(e.elevation)return e.elevation.pointCoordinate(h);{let f=this.pointCoordinate(e,h.x,h.y,0);return[f.x,f.y,f.z]}}isPointAboveHorizon(e,n){if(e.elevation&&e.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(e,n.x,n.y);let l=e.horizonLineFromTop();return n.y<l}createInversionMatrix(e,n){return wP}createTileMatrix(e,n,l){let h,f,p,v=l.canonical,y=r.ad.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){let w=Jp(v,this);h=1,f=w.x+l.wrap*w.scale,p=w.y,r.ad.scale(y,y,[h/w.scale,h/w.scale,e.pixelsPerMeter/n])}else h=n/e.zoomScale(v.z),f=(v.x+Math.pow(2,v.z)*l.wrap)*h,p=v.y*h;return r.ad.translate(y,y,[f,p,0]),r.ad.scale(y,y,[h/it,h/it,1]),y}upVector(e,n,l){return[0,0,1]}upVectorScale(e,n,l){return{metersToTile:1}}}class TP extends Zf{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];let[n,l]=this.parallels=e.parallels||[29.5,45.5],h=Math.sin(Ai(n));this.n=(h+Math.sin(Ai(l)))/2,this.c=1+h*(2*this.n-h),this.r0=Math.sqrt(this.c)/this.n}project(e,n){let{n:l,c:h,r0:f}=this,p=Ai(e-this.center[0]),v=Ai(n),y=Math.sqrt(h-2*l*Math.sin(v))/l;return{x:y*Math.sin(p*l),y:y*Math.cos(p*l)-f,z:0}}unproject(e,n){let{n:l,c:h,r0:f}=this,p=f+n,v=Math.atan2(e,Math.abs(p))*Math.sign(p);p*l<0&&(v-=Math.PI*Math.sign(e)*Math.sign(p));let y=Ai(this.center[0])*l;v=ql(v,-Math.PI-y,Math.PI-y);let w=ui(ka(v/l)+this.center[0],-180,180),A=Math.asin(ui((h-(e*e+p*p)*l*l)/(2*l),-1,1)),M=ui(ka(A),-$a,$a);return new en(w,M)}}let qg=1.340264,$g=-.081106,Xg=893e-6,Zg=.003796,hv=Math.sqrt(3)/2;class SP extends Zf{project(e,n){n=n/180*Math.PI,e=e/180*Math.PI;let l=Math.asin(hv*Math.sin(n)),h=l*l,f=h*h*h;return{x:.5*(e*Math.cos(l)/(hv*(qg+3*$g*h+f*(7*Xg+9*Zg*h)))/Math.PI+.5),y:1-.5*(l*(qg+$g*h+f*(Xg+Zg*h))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let l=n=(2*(1-n)-1)*Math.PI,h=l*l,f=h*h*h;for(let A,M,R,N=0;N<12&&(M=l*(qg+$g*h+f*(Xg+Zg*h))-n,R=qg+3*$g*h+f*(7*Xg+9*Zg*h),A=M/R,l=ui(l-A,-Math.PI/3,Math.PI/3),h=l*l,f=h*h*h,!(Math.abs(A)<1e-12));++N);let p=hv*e*(qg+3*$g*h+f*(7*Xg+9*Zg*h))/Math.cos(l),v=Math.asin(Math.sin(l)/hv),y=ui(180*p/Math.PI,-180,180),w=ui(180*v/Math.PI,-$a,$a);return new en(y,w)}}class EP extends Zf{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){return{x:.5+e/360,y:.5-n/360,z:0}}unproject(e,n){let l=360*(e-.5),h=ui(360*(.5-n),-$a,$a);return new en(l,h)}}let u0=Math.PI/2;function dv(t){return Math.tan((u0+t)/2)}class AP extends Zf{constructor(e){super(e),this.center=e.center||[0,30];let[n,l]=this.parallels=e.parallels||[30,30],h=Ai(n),f=Ai(l);this.southernCenter=h+f<0,this.southernCenter&&(h=-h,f=-f);let p=Math.cos(h),v=dv(h);this.n=h===f?Math.sin(h):Math.log(p/Math.cos(f))/Math.log(dv(f)/v),this.f=p*Math.pow(dv(h),this.n)/this.n}project(e,n){n=Ai(n),this.southernCenter&&(n=-n),e=Ai(e-this.center[0]);let l=1e-6,{n:h,f}=this;f>0?n<-u0+l&&(n=-u0+l):n>u0-l&&(n=u0-l);let p=f/Math.pow(dv(n),h),v=p*Math.sin(h*e),y=f-p*Math.cos(h*e);return v=.5*(v/Math.PI+.5),y=.5*(y/Math.PI+.5),{x:v,y:this.southernCenter?y:1-y,z:0}}unproject(e,n){e=(2*e-.5)*Math.PI,this.southernCenter&&(n=1-n),n=(2*(1-n)-.5)*Math.PI;let{n:l,f:h}=this,f=h-n,p=Math.sign(f),v=Math.sign(l)*Math.sqrt(e*e+f*f),y=Math.atan2(e,Math.abs(f))*p;f*l<0&&(y-=Math.PI*Math.sign(e)*p);let w=ui(ka(y/l)+this.center[0],-180,180),A=ui(ka(2*Math.atan(Math.pow(h/v,1/l))-u0),-$a,$a);return new en(w,this.southernCenter?-A:A)}}class hA extends Zf{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,n){return{x:qh(e),y:$h(n),z:0}}unproject(e,n){let l=Nl(e),h=Zo(n);return new en(l,h)}}let dA=Ai($a);class CP extends Zf{project(e,n){let l=(n=Ai(n))*n,h=l*l;return{x:.5*((e=Ai(e))*(.8707-.131979*l+h*(h*(.003971*l-.001529*h)-.013791))/Math.PI+.5),y:1-.5*(n*(1.007226+l*(.015085+h*(.028874*l-.044475-.005916*h)))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let l=n=(2*(1-n)-1)*Math.PI,h=25,f=0,p=l*l;do{p=l*l;let w=p*p;f=(l*(1.007226+p*(.015085+w*(.028874*p-.044475-.005916*w)))-n)/(1.007226+p*(.045255+w*(.259866*p-.311325-.005916*11*w))),l=ui(l-f,-dA,dA)}while(Math.abs(f)>1e-6&&--h>0);p=l*l;let v=ui(ka(e/(.8707+p*(p*(p*p*p*(.003971-.001529*p)-.013791)-.131979))),-180,180),y=ka(l);return new en(v,y)}}let fA=Ai($a);class IP extends Zf{project(e,n){n=Ai(n),e=Ai(e);let l=Math.cos(n),h=2/Math.PI,f=Math.acos(l*Math.cos(e/2)),p=Math.sin(f)/f,v=.5*(e*h+2*l*Math.sin(e/2)/p)||0,y=.5*(n+Math.sin(n)/p)||0;return{x:.5*(v/Math.PI+.5),y:1-.5*(y/Math.PI+1),z:0}}unproject(e,n){let l=e=(2*e-.5)*Math.PI,h=n=(2*(1-n)-1)*Math.PI,f=25,p=1e-6,v=0,y=0;do{let w=Math.cos(h),A=Math.sin(h),M=2*A*w,R=A*A,N=w*w,z=Math.cos(l/2),q=Math.sin(l/2),Z=2*z*q,oe=q*q,ye=1-N*z*z,be=ye?1/ye:0,we=ye?Math.acos(w*z)*Math.sqrt(1/ye):0,$e=.5*(2*we*w*q+2*l/Math.PI)-e,He=.5*(we*A+h)-n,rt=.5*be*(N*oe+we*w*z*R)+1/Math.PI,ot=be*(Z*M/4-we*A*q),_t=.125*be*(M*q-we*A*N*Z),Mt=.5*be*(R*z+we*oe*w)+.5,At=ot*_t-Mt*rt;v=(He*ot-$e*Mt)/At,y=($e*_t-He*rt)/At,l=ui(l-v,-Math.PI,Math.PI),h=ui(h-y,-fA,fA)}while((Math.abs(v)>p||Math.abs(y)>p)&&--f>0);return new en(ka(l),ka(h))}}class pA extends Zf{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Ai(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){let{scale:l,cosPhi:h}=this;return{x:Ai(e)*h*l+.5,y:-Math.sin(Ai(n))/h*l+.5,z:0}}unproject(e,n){let{scale:l,cosPhi:h}=this,f=-(n-.5)/l,p=ui(ka((e-.5)/l)/h,-180,180),v=Math.asin(ui(f*h,-1,1)),y=ui(ka(v),-$a,$a);return new en(p,y)}}class kP extends hA{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,n,l){let h=Rg(e,n,l),f=Fg(Xh(l));return r._.transformMat4(h,h,f),{x:h[0],y:h[1],z:h[2]}}locationPoint(e,n){let l=$p(n.lat,n.lng),h=r._.normalize([],l),f=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(n),e._centerAltitude):e._centerAltitude,p=fl(1,0)*it*f;r._.scaleAndAdd(l,l,h,p);let v=r.ad.identity(new Float64Array(16));return r.ad.multiply(v,e.pixelMatrix,e.globeMatrix),r._.transformMat4(l,l,v),new hr(l[0],l[1])}pixelsPerMeter(e,n){return fl(1,0)*n}pixelSpaceConversion(e,n,l){let h=fl(1,e)*n,f=Xr(fl(1,45)*n,h,l);return this.pixelsPerMeter(e,n)/f}createTileMatrix(e,n,l){let h=Cb(Xh(l.canonical));return r.ad.multiply(new Float64Array(16),e.globeMatrix,h)}createInversionMatrix(e,n){let{center:l}=e,h=Fg(Xh(n));return r.ad.rotateY(h,h,Ai(l.lng)),r.ad.rotateX(h,h,Ai(l.lat)),r.ad.scale(h,h,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(h)}pointCoordinate(e,n,l,h){return bS(e,n,l,!0)||new ks(0,0)}pointCoordinate3D(e,n,l){let h=this.pointCoordinate(e,n,l,0);return[h.x,h.y,h.z]}isPointAboveHorizon(e,n){return!bS(e,n.x,n.y,!1)}farthestPixelDistance(e){let n=function(h,f){let p=h.cameraToCenterDistance,v=h._centerAltitude*f,y=h._camera,w=h._camera.forward(),A=r._.add([],r._.scale([],w,-p),[0,0,v]),M=h.worldSize/(2*Math.PI),R=[0,0,-M],N=h.width/h.height,z=Math.tan(h.fovAboveCenter),q=r._.scale([],y.up(),z),Z=r._.scale([],y.right(),z*N),oe=r._.normalize([],r._.add([],r._.add([],w,q),Z)),ye=[],be;if(new wb(A,oe).closestPointOnSphere(R,M,ye)){let we=r._.add([],ye,R),$e=r._.sub([],we,A);be=Math.cos(h.fovAboveCenter)*r._.length($e)}else{let we=r._.sub([],A,R),$e=r._.sub([],R,A);r._.normalize($e,$e);let He=r._.length(we)-M;be=Math.sqrt(He*(He+2*M));let rt=Math.acos(be/(M+He))-Math.acos(r._.dot(w,$e));be*=Math.cos(rt)}return 1.01*be}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),l=Hd(e.zoom);if(l>0){let h=cA(e,fl(1,e.center.lat)*e.worldSize),f=e.worldSize/(2*Math.PI),p=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Xr(n,h+f*(1-Math.cos(p)),Math.pow(l,10))}return n}upVector(e,n,l){return Rg(n,l,e,1)}upVectorScale(e){return{metersToTile:j1(V1(Xh(e)))}}}function mA(t){let e=t.parallels,n=!!e&&Math.abs(e[0]+e[1])<.01;switch(t.name){case"mercator":return new hA(t);case"equirectangular":return new EP(t);case"naturalEarth":return new CP(t);case"equalEarth":return new SP(t);case"winkelTripel":return new IP(t);case"albers":return n?new pA(t):new TP(t);case"lambertConformalConic":return n?new pA(t):new AP(t);case"globe":return new kP(t)}throw new Error(`Invalid projection name: ${t.name}`)}let MP=(()=>{class t{constructor(n,l,h,f){this.id=t.uniqueIdxCounter,t.uniqueIdxCounter++,this.context=n;let p=n.gl;this.buffer=p.createBuffer(),this.dynamicDraw=!!h,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||f||l.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){this.id=t.uniqueIdxCounter,t.uniqueIdxCounter++;let l=this.context.gl;this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}return t.uniqueIdxCounter=0,t})();class h0{constructor(e,n,l){this.func=e,this.mask=n,this.range=l}}h0.ReadOnly=!1,h0.ReadWrite=!0,h0.disabled=new h0(519,h0.ReadOnly,[0,1]);let Kb=7680;class Jb{constructor(e,n,l,h,f,p){this.test=e,this.ref=n,this.mask=l,this.fail=h,this.depthFail=f,this.pass=p}}Jb.disabled=new Jb({func:519,mask:0},0,0,Kb,Kb,Kb);let Yg=771;class nc{constructor(e,n,l,h){this.blendFunction=e,this.blendColor=n,this.mask=l,this.blendEquation=h}}nc.Replace=[1,0,1,0],nc.disabled=new nc(nc.Replace,qi.transparent,[!1,!1,!1,!1]),nc.unblended=new nc(nc.Replace,qi.transparent,[!0,!0,!0,!0]),nc.alphaBlended=new nc([1,Yg,1,Yg],qi.transparent,[!0,!0,!0,!0]),nc.alphaBlendedNonPremultiplied=new nc([770,Yg,770,Yg],qi.transparent,[!0,!0,!0,!0]),nc.multiply=new nc([774,0,774,0],qi.transparent,[!0,!0,!0,!0]);let Qb=1029,e2=2305;class ih{constructor(e,n,l){this.enable=e,this.mode=n,this.frontFace=l}}ih.disabled=new ih(!1,Qb,e2),ih.backCCW=new ih(!0,Qb,e2),ih.backCW=new ih(!0,Qb,2304),ih.frontCW=new ih(!0,1028,2304),ih.frontCCW=new ih(!0,1028,e2);let DP=Z1.types,RP=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function fv(t,e,n,l,h,f,p,v,y,w,A,M,R){let N=v?Math.min(Xf,Math.round(v[0])):0,z=v?Math.min(Xf,Math.round(v[1])):0;t.emplaceBack(e,n,Math.round(32*l),Math.round(32*h),f,p,(N<<1)+(y?1:0),z,16*w,16*A,256*M,256*R)}function pv(t,e,n){t.emplaceBack(e,n)}function mv(t,e,n,l,h,f,p){t.emplaceBack(e,n,l,h,f,p)}function gv(t,e,n,l,h){t.emplaceBack(e,n,l,h),t.emplaceBack(e,n,l,h),t.emplaceBack(e,n,l,h),t.emplaceBack(e,n,l,h)}function FP(t){for(let e of t.sections)if(jt(e.text))return!0;return!1}class t2{constructor(e){this.layoutVertexArray=new Wx,this.indexArray=new No,this.programConfigurations=e,this.segments=new ha,this.dynamicLayoutVertexArray=new Of,this.opacityVertexArray=new $x,this.occlusionQueryOpacityVertexArray=new Hp,this.placedSymbolArray=new WT,this.iconTransitioningVertexArray=new zf,this.globeExtVertexArray=new qx,this.zOffsetVertexArray=new Hp}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(e,n,l,h,f){this.isEmpty()||(l&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,PF.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,OF.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,RP,!0),this.occlusionQueryOpacityVertexBuffer=e.createVertexBuffer(this.occlusionQueryOpacityVertexArray,jb.members,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=e.createVertexBuffer(this.iconTransitioningVertexArray,NF.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,LF.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||f)&&(this.zOffsetVertexBuffer=e.createVertexBuffer(this.zOffsetVertexArray,TE.members,!0)),this.opacityVertexBuffer.itemSize=1),(l||h)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.occlusionQueryOpacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}Fe(t2,"SymbolBuffers");class r2{constructor(e,n,l){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new l,this.segments=new ha,this.collisionVertexArray=new Yx,this.collisionVertexArrayExt=new Of}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,BF.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,zF.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Fe(r2,"CollisionBuffers");class d0{constructor(e){this.queries=new Map,this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.lut=e.lut,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(p=>p.fqid),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=r.ad.identity([]),this.placementViewportMatrix=r.ad.identity([]);let n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Vb(this.zoom,n["text-size"]),this.iconSizeData=Vb(this.zoom,n["icon-size"]);let l=this.layers[0].layout,h=l.get("symbol-sort-key"),f=l.get("symbol-z-order");this.canOverlap=l.get("text-allow-overlap")||l.get("icon-allow-overlap")||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=f!=="viewport-y"&&h.constantOr(1)!==void 0,this.sortFeaturesByY=(f==="viewport-y"||f==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=l.get("text-writing-mode").map(p=>jc[p]),this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id),this.sourceID=e.sourceID,this.projection=e.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=l.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new t2(new Uf(this.layers,{zoom:this.zoom,lut:this.lut},e=>/^text/.test(e))),this.icon=new t2(new Uf(this.layers,{zoom:this.zoom,lut:this.lut},e=>/^icon/.test(e))),this.glyphOffsetArray=new XT,this.lineVertexArray=new ZT,this.symbolInstances=new $T}calculateGlyphDependencies(e,n,l,h,f){for(let p=0;p<e.length;p++){let v=e.codePointAt(p);if(v===void 0)break;if(n[v]=!0,h&&f&&v<=65535){let y=Vg[e.charAt(p)];y&&(n[y.charCodeAt(0)]=!0)}}}updateFootprints(e,n){}updateReplacement(e,n){if(n.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=n.updateTime;let l=n.getReplacementRegionsForTile(e.toUnwrapped(),!0);return!Bb(this.activeReplacements,l)&&(this.activeReplacements=l,!0)}populate(e,n,l,h){let f=this.layers[0],p=f.layout,v=this.projection.name==="globe",y=p.get("text-font"),w=p.get("text-field"),A=p.get("icon-image"),M=(w.value.kind!=="constant"||w.value.value instanceof Ja&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),R=A.value.kind!=="constant"||!!A.value.value||Object.keys(A.parameters).length>0,N=p.get("symbol-sort-key");if(this.features=[],!M&&!R)return;let z=n.iconDependencies,q=n.glyphDependencies,Z=n.availableImages,oe=new ni(this.zoom);for(let{feature:ye,id:be,index:we,sourceLayerIndex:$e}of e){let He=f._featureFilter.needGeometry,rt=Vd(ye,He);if(!f._featureFilter.filter(oe,rt,l))continue;if(He||(rt.geometry=eh(ye,l,h)),v&&ye.type!==1&&l.z<=5){let At=rt.geometry,zt=.98078528056,Jt=(Ot,Xt)=>{let Dt=Rg(Ot.x,Ot.y,l,1),Zt=Rg(Xt.x,Xt.y,l,1);return r._.dot(Dt,Zt)<zt};for(let Ot=0;Ot<At.length;Ot++)At[Ot]=_R(At[Ot],Jt)}let ot,_t;if(M){let At=f.getValueAndResolveTokens("text-field",rt,l,Z),zt=Ja.factory(At);FP(zt)&&(this.hasRTLText=!0),(!this.hasRTLText||Di()==="unavailable"||this.hasRTLText&&_n.isParsed())&&(ot=aP(zt,f,rt))}if(R){let At=f.getValueAndResolveTokens("icon-image",rt,l,Z);_t=At instanceof os?At:os.fromString(At)}if(!ot&&!_t)continue;let Mt=this.sortFeaturesByKey?N.evaluate(rt,{},l):void 0;if(this.features.push({id:be,text:ot,icon:_t,index:we,sourceLayerIndex:$e,geometry:rt.geometry,properties:ye.properties,type:DP[ye.type],sortKey:Mt}),_t&&(z[_t.namePrimary]=!0,_t.nameSecondary&&(z[_t.nameSecondary]=!0)),ot){let At=y.evaluate(rt,{},l).join(","),zt=p.get("text-rotation-alignment")==="map"&&p.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(jc.vertical)>=0;for(let Jt of ot.sections)if(Jt.image)z[Jt.image.namePrimary]=!0;else{let Ot=bt(ot.toString()),Xt=Jt.fontStack||At,Dt=q[Xt]=q[Xt]||{};this.calculateGlyphDependencies(Jt.text,Dt,zt,this.allowVerticalPlacement,Ot)}}}p.get("symbol-placement")==="line"&&(this.features=function(ye){let be={},we={},$e=[],He=0;function rt(At){$e.push(ye[At]),He++}function ot(At,zt,Jt){let Ot=we[At];return delete we[At],we[zt]=Ot,$e[Ot].geometry[0].pop(),$e[Ot].geometry[0]=$e[Ot].geometry[0].concat(Jt[0]),Ot}function _t(At,zt,Jt){let Ot=be[zt];return delete be[zt],be[At]=Ot,$e[Ot].geometry[0].shift(),$e[Ot].geometry[0]=Jt[0].concat($e[Ot].geometry[0]),Ot}function Mt(At,zt,Jt){let Ot=Jt?zt[0][zt[0].length-1]:zt[0][0];return`${At}:${Ot.x}:${Ot.y}`}for(let At=0;At<ye.length;At++){let zt=ye[At],Jt=zt.geometry,Ot=zt.text?zt.text.toString():null;if(!Ot){rt(At);continue}let Xt=Mt(Ot,Jt),Dt=Mt(Ot,Jt,!0);if(Xt in we&&Dt in be&&we[Xt]!==be[Dt]){let Zt=_t(Xt,Dt,Jt),ir=ot(Xt,Dt,$e[Zt].geometry);delete be[Xt],delete we[Dt],we[Mt(Ot,$e[ir].geometry,!0)]=ir,$e[Zt].geometry=null}else Xt in we?ot(Xt,Dt,Jt):Dt in be?_t(Xt,Dt,Jt):(rt(At),be[Xt]=He-1,we[Dt]=He-1)}return $e.filter(At=>At.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ye,be)=>ye.sortKey-be.sortKey)}update(e,n,l,h,f){let p=Object.keys(e).length!==0;if(p&&!this.stateDependentLayers.length)return;let v=p?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(e,n,v,l,h,f),this.icon.programConfigurations.updatePaintArrays(e,n,v,l,h,f)}updateOcclusionOpacities(e,n,l){if(!n.useOcclusionQueries)return!1;let h=this;if(h.projection.name==="globe")return!1;let f=!1;h.hasTextData()&&(f=f||h.text.occlusionQueryOpacityVertexArray.length!==0),h.hasIconData()&&(f=f||h.icon.occlusionQueryOpacityVertexArray.length!==0);let p=h.layers[0].paint,v=p.get("icon-occlusion-opacity").constantOr(0),y=p.get("text-occlusion-opacity").constantOr(0);if(!h.layers[0].hasInitialOcclusionOpacityProperties||v===1&&y===1)return!1;let w=!f;for(let N=0;N<h.symbolInstances.length;N++){let z=h.symbolInstances.get(N),q=z.occlusionOpacity;z.occlusionOpacity+=(z.occlusionState>.5?1:-1)*n.fadeSpeed*l*.001,z.occlusionOpacity=ui(z.occlusionOpacity,0,1),w=w||z.occlusionOpacity!==q}if(!w)return!1;let A=0,M=0,R=(N,z,q,Z)=>{let oe=0,ye=0;q?(oe=M,M+=Z,ye=M):(oe=A,A+=Z,ye=A),ye>z.occlusionQueryOpacityVertexArray.length&&z.occlusionQueryOpacityVertexArray.resize(ye);let be=N.occlusionOpacity;for(let we=0;we<Z;we++)z.occlusionQueryOpacityVertexArray.emplace(we+oe,be)};for(let N=0;N<h.symbolInstances.length;N++){let z=h.symbolInstances.get(N),{numHorizontalGlyphVertices:q,numVerticalGlyphVertices:Z,numIconVertices:oe}=z,ye=oe>0;if((q>0||Z>0)&&(R(z,h.text,!1,q),R(z,h.text,!1,Z)),ye){let{placedIconSymbolIndex:be,verticalPlacedIconSymbolIndex:we}=z;be>=0&&R(z,h.icon,!0,oe),we>=0&&R(z,h.icon,!0,z.numVerticalIconVertices)}}return h.hasTextData()&&h.text.occlusionQueryOpacityVertexBuffer&&(h.text.occlusionQueryOpacityVertexBuffer.length<h.text.occlusionQueryOpacityVertexArray.length?h.text.occlusionQueryOpacityVertexBuffer=e.createVertexBuffer(h.text.occlusionQueryOpacityVertexArray,jb.members,!0):h.text.occlusionQueryOpacityVertexBuffer.updateData(h.text.occlusionQueryOpacityVertexArray)),h.hasIconData()&&h.icon.occlusionQueryOpacityVertexBuffer&&(h.icon.occlusionQueryOpacityVertexBuffer.length<h.icon.occlusionQueryOpacityVertexArray.length?h.icon.occlusionQueryOpacityVertexBuffer=e.createVertexBuffer(h.icon.occlusionQueryOpacityVertexArray,jb.members,!0):h.icon.occlusionQueryOpacityVertexBuffer.updateData(h.icon.occlusionQueryOpacityVertexArray)),!0}updateZOffset(){let e=(f,p,v)=>{l+=p,l>f.length&&f.resize(l);for(let y=-p;y<0;y++)f.emplace(y+l,v)},n=(f,p,v)=>{h+=p,h>f.length&&f.resize(h);for(let y=-p;y<0;y++)f.emplace(y+h,v)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let l=0,h=0;for(let f=0;f<this.symbolInstances.length;f++){let p=this.symbolInstances.get(f),{numHorizontalGlyphVertices:v,numVerticalGlyphVertices:y,numIconVertices:w}=p,A=p.zOffset,M=w>0;if((v>0||y>0)&&(e(this.text.zOffsetVertexArray,v,A),e(this.text.zOffsetVertexArray,y,A)),M){let{placedIconSymbolIndex:R,verticalPlacedIconSymbolIndex:N}=p;R>=0&&n(this.icon.zOffsetVertexArray,w,A),N>=0&&n(this.icon.zOffsetVertexArray,p.numVerticalIconVertices,A)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=mA(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData();for(let e of this.queries.values())e.destroy()}addToLineVertexArray(e,n){let l=this.lineVertexArray.length;if(e.segment!==void 0)for(let{x:h,y:f}of n)this.lineVertexArray.emplaceBack(h,f);return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(e,n,l,h,f,p,v,y,w,A,M,R,N,z,q,Z){let oe=e.indexArray,ye=e.layoutVertexArray,be=e.globeExtVertexArray,we=e.segments.prepareSegment(4*n.length,ye,oe,this.canOverlap?p.sortKey:void 0),$e=this.glyphOffsetArray.length,He=we.vertexLength,rt=this.allowVerticalPlacement&&v===jc.vertical?Math.PI/2:0,ot=p.text&&p.text.sections;for(let Mt=0;Mt<n.length;Mt++){let{tl:At,tr:zt,bl:Jt,br:Ot,texPrimary:Xt,texSecondary:Dt,pixelOffsetTL:Zt,pixelOffsetBR:ir,minFontScaleX:Kt,minFontScaleY:Sr,glyphOffset:er,isSDF:lr,sectionIndex:Zr}=n[Mt],zr=we.vertexLength,Or=er[1];if(fv(ye,w.x,w.y,At.x,Or+At.y,Xt.x,Xt.y,l,lr,Zt.x,Zt.y,Kt,Sr),fv(ye,w.x,w.y,zt.x,Or+zt.y,Xt.x+Xt.w,Xt.y,l,lr,ir.x,Zt.y,Kt,Sr),fv(ye,w.x,w.y,Jt.x,Or+Jt.y,Xt.x,Xt.y+Xt.h,l,lr,Zt.x,ir.y,Kt,Sr),fv(ye,w.x,w.y,Ot.x,Or+Ot.y,Xt.x+Xt.w,Xt.y+Xt.h,l,lr,ir.x,ir.y,Kt,Sr),y){let{x:ar,y:Kr,z:vi}=y.anchor,[ri,Si,yi]=y.up;mv(be,ar,Kr,vi,ri,Si,yi),mv(be,ar,Kr,vi,ri,Si,yi),mv(be,ar,Kr,vi,ri,Si,yi),mv(be,ar,Kr,vi,ri,Si,yi),gv(e.dynamicLayoutVertexArray,ar,Kr,vi,rt)}else gv(e.dynamicLayoutVertexArray,w.x,w.y,w.z,rt);if(Z){let ar=Dt||Xt;pv(e.iconTransitioningVertexArray,ar.x,ar.y),pv(e.iconTransitioningVertexArray,ar.x+ar.w,ar.y),pv(e.iconTransitioningVertexArray,ar.x,ar.y+ar.h),pv(e.iconTransitioningVertexArray,ar.x+ar.w,ar.y+ar.h)}oe.emplaceBack(zr,zr+1,zr+2),oe.emplaceBack(zr+1,zr+2,zr+3),we.vertexLength+=4,we.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(er[0]),Mt!==n.length-1&&Zr===n[Mt+1].sectionIndex||e.programConfigurations.populatePaintArrays(ye.length,p,p.index,{},N,z,q,ot&&ot[Zr])}let _t=y?y.anchor:w;e.placedSymbolArray.emplaceBack(_t.x,_t.y,_t.z,w.x,w.y,$e,this.glyphOffsetArray.length-$e,He,A,M,w.segment,l?l[0]:0,l?l[1]:0,h[0],h[1],v,0,!1,0,R,0)}_commitLayoutVertex(e,n,l,h,f,p,v){e.emplaceBack(n,l,h,f,p,Math.round(v.x),Math.round(v.y))}_addCollisionDebugVertices(e,n,l,h,f,p,v){let y=l.segments.prepareSegment(4,l.layoutVertexArray,l.indexArray),w=y.vertexLength,A=v.tileAnchorX,M=v.tileAnchorY;for(let N=0;N<4;N++)l.collisionVertexArray.emplaceBack(0,0,0,0);this._commitDebugCollisionVertexUpdate(l.collisionVertexArrayExt,n,e.padding,v.zOffset),this._commitLayoutVertex(l.layoutVertexArray,h,f,p,A,M,new hr(e.x1,e.y1)),this._commitLayoutVertex(l.layoutVertexArray,h,f,p,A,M,new hr(e.x2,e.y1)),this._commitLayoutVertex(l.layoutVertexArray,h,f,p,A,M,new hr(e.x2,e.y2)),this._commitLayoutVertex(l.layoutVertexArray,h,f,p,A,M,new hr(e.x1,e.y2)),y.vertexLength+=4;let R=l.indexArray;R.emplaceBack(w,w+1),R.emplaceBack(w+1,w+2),R.emplaceBack(w+2,w+3),R.emplaceBack(w+3,w),y.primitiveLength+=4}_addTextDebugCollisionBoxes(e,n,l,h,f,p){for(let v=h;v<f;v++){let y=l.get(v),w=this.getSymbolInstanceTextSize(e,p,n,v);this._addCollisionDebugVertices(y,w,this.textCollisionBox,y.projectedAnchorX,y.projectedAnchorY,y.projectedAnchorZ,p)}}_addIconDebugCollisionBoxes(e,n,l,h,f,p){for(let v=h;v<f;v++){let y=l.get(v),w=this.getSymbolInstanceIconSize(e,n,p.placedIconSymbolIndex);this._addCollisionDebugVertices(y,w,this.iconCollisionBox,y.projectedAnchorX,y.projectedAnchorY,y.projectedAnchorZ,p)}}generateCollisionDebugBuffers(e,n){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new r2(D1,SE.members,zf),this.iconCollisionBox=new r2(D1,SE.members,zf);let l=o0(this.iconSizeData,e),h=o0(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){let p=this.symbolInstances.get(f);this._addTextDebugCollisionBoxes(h,e,n,p.textBoxStartIndex,p.textBoxEndIndex,p),this._addTextDebugCollisionBoxes(h,e,n,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p),this._addIconDebugCollisionBoxes(l,e,n,p.iconBoxStartIndex,p.iconBoxEndIndex,p),this._addIconDebugCollisionBoxes(l,e,n,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex,p)}}getSymbolInstanceTextSize(e,n,l,h){let f=this.text.placedSymbolArray.get(n.rightJustifiedTextSymbolIndex>=0?n.rightJustifiedTextSymbolIndex:n.centerJustifiedTextSymbolIndex>=0?n.centerJustifiedTextSymbolIndex:n.leftJustifiedTextSymbolIndex>=0?n.leftJustifiedTextSymbolIndex:n.verticalPlacedTextSymbolIndex>=0?n.verticalPlacedTextSymbolIndex:h),p=av(this.textSizeData,e,f)/ls;return this.tilePixelRatio*p}getSymbolInstanceIconSize(e,n,l){let h=this.icon.placedSymbolArray.get(l),f=av(this.iconSizeData,e,h);return this.tilePixelRatio*f}_commitDebugCollisionVertexUpdate(e,n,l,h){e.emplaceBack(n,-l,-l,h),e.emplaceBack(n,l,-l,h),e.emplaceBack(n,l,l,h),e.emplaceBack(n,-l,l,h)}_updateTextDebugCollisionBoxes(e,n,l,h,f,p){for(let v=h;v<f;v++){let y=l.get(v),w=this.getSymbolInstanceTextSize(e,p,n,v);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,w,y.padding,p.zOffset)}}_updateIconDebugCollisionBoxes(e,n,l,h,f,p){for(let v=h;v<f;v++){let y=l.get(v),w=this.getSymbolInstanceIconSize(e,n,p.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,w,y.padding,p.zOffset)}}updateCollisionDebugBuffers(e,n){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();let l=o0(this.iconSizeData,e),h=o0(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){let p=this.symbolInstances.get(f);this._updateTextDebugCollisionBoxes(h,e,n,p.textBoxStartIndex,p.textBoxEndIndex,p),this._updateTextDebugCollisionBoxes(h,e,n,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p),this._updateIconDebugCollisionBoxes(l,e,n,p.iconBoxStartIndex,p.iconBoxEndIndex,p),this._updateIconDebugCollisionBoxes(l,e,n,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex,p)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,n,l,h,f,p,v,y,w){let A={};if(n<l){let{x1:M,y1:R,x2:N,y2:z,padding:q,projectedAnchorX:Z,projectedAnchorY:oe,projectedAnchorZ:ye,tileAnchorX:be,tileAnchorY:we,featureIndex:$e}=e.get(n);A.textBox={x1:M,y1:R,x2:N,y2:z,padding:q,projectedAnchorX:Z,projectedAnchorY:oe,projectedAnchorZ:ye,tileAnchorX:be,tileAnchorY:we},A.textFeatureIndex=$e}if(h<f){let{x1:M,y1:R,x2:N,y2:z,padding:q,projectedAnchorX:Z,projectedAnchorY:oe,projectedAnchorZ:ye,tileAnchorX:be,tileAnchorY:we,featureIndex:$e}=e.get(h);A.verticalTextBox={x1:M,y1:R,x2:N,y2:z,padding:q,projectedAnchorX:Z,projectedAnchorY:oe,projectedAnchorZ:ye,tileAnchorX:be,tileAnchorY:we},A.verticalTextFeatureIndex=$e}if(p<v){let{x1:M,y1:R,x2:N,y2:z,padding:q,projectedAnchorX:Z,projectedAnchorY:oe,projectedAnchorZ:ye,tileAnchorX:be,tileAnchorY:we,featureIndex:$e}=e.get(p);A.iconBox={x1:M,y1:R,x2:N,y2:z,padding:q,projectedAnchorX:Z,projectedAnchorY:oe,projectedAnchorZ:ye,tileAnchorX:be,tileAnchorY:we},A.iconFeatureIndex=$e}if(y<w){let{x1:M,y1:R,x2:N,y2:z,padding:q,projectedAnchorX:Z,projectedAnchorY:oe,projectedAnchorZ:ye,tileAnchorX:be,tileAnchorY:we,featureIndex:$e}=e.get(y);A.verticalIconBox={x1:M,y1:R,x2:N,y2:z,padding:q,projectedAnchorX:Z,projectedAnchorY:oe,projectedAnchorZ:ye,tileAnchorX:be,tileAnchorY:we},A.verticalIconFeatureIndex=$e}return A}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){let l=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(e,n){let l=e.placedSymbolArray.get(n),h=l.vertexStartIndex+4*l.numGlyphs;for(let f=l.vertexStartIndex;f<h;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let n=Math.sin(e),l=Math.cos(e),h=[],f=[],p=[];for(let v=0;v<this.symbolInstances.length;++v){p.push(v);let y=this.symbolInstances.get(v);h.push(0|Math.round(n*y.tileAnchorX+l*y.tileAnchorY)),f.push(y.featureIndex)}return p.sort((v,y)=>h[v]-h[y]||f[y]-f[v]),p}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let e=0;e<this.symbolInstances.length;++e)this.symbolInstanceIndexesSortedZOffset.push(e)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((e,n)=>this.symbolInstances.get(n).zOffset-this.symbolInstances.get(e).zOffset)}addToSortKeyRanges(e,n){let l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===n?l.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let n of this.symbolInstanceIndexes){let l=this.symbolInstances.get(n);this.featureSortOrder.push(l.featureIndex);let{rightJustifiedTextSymbolIndex:h,centerJustifiedTextSymbolIndex:f,leftJustifiedTextSymbolIndex:p,verticalPlacedTextSymbolIndex:v,placedIconSymbolIndex:y,verticalPlacedIconSymbolIndex:w}=l;h>=0&&this.addIndicesForPlacedSymbol(this.text,h),f>=0&&f!==h&&this.addIndicesForPlacedSymbol(this.text,f),p>=0&&p!==f&&p!==h&&this.addIndicesForPlacedSymbol(this.text,p),v>=0&&this.addIndicesForPlacedSymbol(this.text,v),y>=0&&this.addIndicesForPlacedSymbol(this.icon,y),w>=0&&this.addIndicesForPlacedSymbol(this.icon,w)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Fe(d0,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),d0.addDynamicAttributes=gv;class _u{constructor(e,n,l,h){this.context=e,this.format=l,this.texture=e.gl.createTexture(),this.update(n,h)}update(e,n,l){let{width:h,height:f}=e,{context:p}=this,{gl:v}=p;if(v.bindTexture(v.TEXTURE_2D,this.texture),p.pixelStoreUnpackFlipY.set(!1),p.pixelStoreUnpack.set(1),p.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA&&(!n||n.premultiply!==!1)),l||this.size&&this.size[0]===h&&this.size[1]===f){let{x:y,y:w}=l||{x:0,y:0};if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||ImageBitmap&&e instanceof ImageBitmap)v.texSubImage2D(v.TEXTURE_2D,0,y,w,v.RGBA,v.UNSIGNED_BYTE,e);else{let A=this.format,M=v.UNSIGNED_BYTE;this.format===v.R32F&&(A=v.RED,M=v.FLOAT),v.texSubImage2D(v.TEXTURE_2D,0,y,w,h,f,A,M,e.data)}}else if(this.size=[h,f],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||ImageBitmap&&e instanceof ImageBitmap){let y=this.format;this.format===v.R8&&(y=v.RED),v.texImage2D(v.TEXTURE_2D,0,this.format,y,v.UNSIGNED_BYTE,e)}else{let y=this.format,w=this.format,A=v.UNSIGNED_BYTE;this.format===v.DEPTH_COMPONENT&&(y=v.DEPTH_COMPONENT16,A=v.UNSIGNED_SHORT),this.format===v.R8&&(w=v.RED),this.format===v.R32F&&(A=v.FLOAT,w=v.RED),v.texImage2D(v.TEXTURE_2D,0,y,h,f,0,w,A,e.data)}this.useMipmap=!!(n&&n.useMipmap),this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(e,n,l=!1){let{context:h}=this,{gl:f}=h;f.bindTexture(f.TEXTURE_2D,this.texture),e!==this.minFilter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,e),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,this.useMipmap&&!l?e===f.NEAREST?f.NEAREST_MIPMAP_NEAREST:f.LINEAR_MIPMAP_LINEAR:e),this.minFilter=e),n!==this.wrapS&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,n),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,n),this.wrapS=n)}bindExtraParam(e,n,l,h){let{context:f}=this,{gl:p}=f;p.bindTexture(p.TEXTURE_2D,this.texture),n!==this.magFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,n),this.magFilter=n),e!==this.minFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.useMipmap?e===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_LINEAR:e),this.minFilter=e),l!==this.wrapS&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,l),this.wrapS=l),h!==this.wrapT&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,h),this.wrapT=h)}destroy(){let{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class _v{constructor(e,n){this.context=e,this.texture=n}bind(e,n){let{context:l}=this,{gl:h}=l;h.bindTexture(h.TEXTURE_2D,this.texture),e!==this.minFilter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,e),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,e),this.minFilter=e),n!==this.wrapS&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,n),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,n),this.wrapS=n)}}let vu=32,Yh=33,Yf=new Uint16Array(8184);for(let t=0;t<2046;t++){let e=t+2,n=0,l=0,h=0,f=0,p=0,v=0;for(1&e?h=f=p=vu:n=l=v=vu;(e>>=1)>1;){let w=n+h>>1,A=l+f>>1;1&e?(h=n,f=l,n=p,l=v):(n=h,l=f,h=p,f=v),p=w,v=A}let y=4*t;Yf[y+0]=n,Yf[y+1]=l,Yf[y+2]=h,Yf[y+3]=f}let Kh=new Uint16Array(2178),Kf=new Uint8Array(1089),vv=new Uint16Array(1089);function gA(t){return t===0?-.03125:t===32?.03125:0}var yv=hn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),PP=hn([{name:"a_index",type:"Int16",components:1}]);let _A={type:2,extent:it,loadGeometry:()=>[[new hr(0,0),new hr(it+1,0),new hr(it+1,it+1),new hr(0,it+1),new hr(0,0)]]};class xv{constructor(e,n,l,h,f){this.tileID=e,this.uid=El(),this.uses=0,this.tileSize=n,this.tileZoom=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=f,h&&h.style&&(this._lastUpdatedBrightness=h.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",h&&h.transform&&(this.projection=h.transform.projection)}registerFadeDuration(e){let n=e+this.timeAdded;n<di.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Jp(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,n,l){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(h,f){let p={};if(!f)return p;for(let v of h){let y=v.layerIds.map(w=>f.getLayer(w)).filter(Boolean);if(y.length!==0){v.layers=y,v.stateDependentLayerIds&&(v.stateDependentLayers=v.stateDependentLayerIds.map(w=>y.filter(A=>A.id===w)[0]));for(let w of y)p[w.fqid]=v}}return p}(e.buckets,n.style),this.hasSymbolBuckets=!1;for(let h in this.buckets){let f=this.buckets[h];if(f instanceof d0){if(this.hasSymbolBuckets=!0,!l)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let h in this.buckets){let f=this.buckets[h];if(f instanceof d0&&f.hasRTLText){this.hasRTLText=!0,_n.isLoading()||_n.isLoaded()||Di()!=="deferred"||Xi();break}}this.queryPadding=0;for(let h in this.buckets){let f=this.buckets[h],p=n.style.getOwnLayer(h);if(!p)continue;let v=p.queryRadius(f);this.queryPadding=Math.max(this.queryPadding,v)}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas),this._lastUpdatedBrightness=e.brightness}else this.collisionBoxArray=new nb}unloadVectorData(){if(this.hasData()){for(let e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.fqid]}upload(e){for(let h in this.buckets){let f=this.buckets[h];f.uploadPending()&&f.upload(e)}let n=e.gl,l=this.imageAtlas;if(l&&!l.uploaded){let h=!!Object.keys(l.patternPositions).length;this.imageAtlasTexture=new _u(e,l.image,n.RGBA,{useMipmap:h}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new _u(e,this.glyphAtlasImage,n.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new _u(e,this.lineAtlas.image,n.R8),this.lineAtlas.uploaded=!0)}prepare(e,n,l){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture,l),!n||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;let h=n.style.getBrightness();(this._lastUpdatedBrightness||h)&&(this._lastUpdatedBrightness&&h&&Math.abs(this._lastUpdatedBrightness-h)<.001||(this._lastUpdatedBrightness=h,this.updateBuckets(void 0,n)))}queryRenderedFeatures(e,n,l,h,f,p,v,y){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:h,pixelPosMatrix:v,transform:p,params:f,tileTransform:this.tileTransform},e,n,l):{}}querySourceFeatures(e,n){let l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;let h=l.loadVTLayers(),f=n?n.sourceLayer:"",p=h._geojsonTileLayer||h[f];if(!p)return;let v=Mo(n&&n.filter),{z:y,x:w,y:A}=this.tileID.canonical,M={z:y,x:w,y:A};for(let R=0;R<p.length;R++){let N=p.feature(R);if(v.needGeometry){let Z=Vd(N,!0);if(!v.filter(new ni(this.tileID.overscaledZ),Z,this.tileID.canonical))continue}else if(!v.filter(new ni(this.tileID.overscaledZ),N))continue;let z=l.getId(N,f),q=new BE(N,y,w,A,z);q.tile=M,e.push(q)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}bucketsLoaded(){for(let e in this.buckets)if(this.buckets[e].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){let n=this.expirationTime;if(e.cacheControl){let l=Qc(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){let l=Date.now(),h=!1;if(this.expirationTime>l)h=!1;else if(n)if(this.expirationTime<n)h=!0;else{let f=this.expirationTime-n;f?this.expirationTime=l+Math.max(f,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,n){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0&&n&&this.updateBuckets(e,n)}updateBuckets(e,n){if(!this.latestFeatureIndex)return;let l=this.latestFeatureIndex.loadVTLayers(),h=n.style.listImages(),f=n.style.getBrightness();for(let p in this.buckets){if(!n.style.hasLayer(p))continue;let v=this.buckets[p],y=v.layers[0].sourceLayer||"_geojsonTileLayer",w=l[y],A={};if(e&&(A=e[y],!w||!A||Object.keys(A).length===0))continue;if(v.update(A,w,h,this.imageAtlas&&this.imageAtlas.patternPositions||{},f),v instanceof tv||v instanceof $1){let R=n.style.getOwnSourceCache(v.layers[0].source);n._terrain&&n._terrain.enabled&&R&&v.programConfigurations.needsUpload&&n._terrain._clearRenderCacheForTile(R.id,this.tileID)}let M=n&&n.style&&n.style.getOwnLayer(p);M&&(this.queryPadding=Math.max(this.queryPadding,M.queryRadius(v)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<di.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=di.now()+e}setTexture(e,n){let l=n.context,h=l.gl;this.texture=this.texture||n.getTileTexture(e.width),this.texture&&this.texture instanceof _u?this.texture.update(e,{useMipmap:!0}):(this.texture=new _u(l,e,h.RGBA,{useMipmap:!0}),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE))}setDependencies(e,n){let l={};for(let h of n)l[h]=!0;this.dependencies[e]=l}hasDependency(e,n){for(let l of e){let h=this.dependencies[l];if(h){for(let f of n)if(h[f])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,n){if(!n||n.name==="mercator"||this._tileDebugBuffer)return;let l=eh(_A,this.tileID.canonical,this.tileTransform)[0],h=new Ju,f=new Eg;for(let p=0;p<l.length;p++){let{x:v,y}=l[p];h.emplaceBack(v,y),f.emplaceBack(p)}f.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(f),this._tileDebugBuffer=e.createVertexBuffer(h,Dg.members),this._tileDebugSegments=ha.simpleSegment(0,0,h.length,f.length)}_makeTileBoundsBuffers(e,n){if(this._tileBoundsBuffer||!n||n.name==="mercator")return;let l=eh(_A,this.tileID.canonical,this.tileTransform)[0],h,f;if(this.isRaster){let p=function(v,y){let w=Jp(v,y),A=Math.pow(2,v.z);for(let Z=0;Z<Yh;Z++)for(let oe=0;oe<Yh;oe++){let ye=Nl((v.x+(oe+gA(oe))/vu)/A),be=Zo((v.y+(Z+gA(Z))/vu)/A),we=y.project(ye,be),$e=Z*Yh+oe;Kh[2*$e+0]=Math.round((we.x*w.scale-w.x)*it),Kh[2*$e+1]=Math.round((we.y*w.scale-w.y)*it)}Kf.fill(0),vv.fill(0);for(let Z=2045;Z>=0;Z--){let oe=4*Z,ye=Yf[oe+0],be=Yf[oe+1],we=Yf[oe+2],$e=Yf[oe+3],He=ye+we>>1,rt=be+$e>>1,ot=He+rt-be,_t=rt+ye-He,Mt=be*Yh+ye,At=$e*Yh+we,zt=rt*Yh+He,Jt=Math.hypot((Kh[2*Mt+0]+Kh[2*At+0])/2-Kh[2*zt+0],(Kh[2*Mt+1]+Kh[2*At+1])/2-Kh[2*zt+1])>=16;Kf[zt]=Kf[zt]||(Jt?1:0),Z<1022&&(Kf[zt]=Kf[zt]||Kf[(be+_t>>1)*Yh+(ye+ot>>1)]||Kf[($e+_t>>1)*Yh+(we+ot>>1)])}let M=new Lf,R=new No,N=0;function z(Z,oe){let ye=oe*Yh+Z;return vv[ye]===0&&(M.emplaceBack(Kh[2*ye+0],Kh[2*ye+1],Z*it/vu,oe*it/vu),vv[ye]=++N),vv[ye]-1}function q(Z,oe,ye,be,we,$e){let He=Z+ye>>1,rt=oe+be>>1;if(Math.abs(Z-we)+Math.abs(oe-$e)>1&&Kf[rt*Yh+He])q(we,$e,Z,oe,He,rt),q(ye,be,we,$e,He,rt);else{let ot=z(Z,oe),_t=z(ye,be),Mt=z(we,$e);R.emplaceBack(ot,_t,Mt)}}return q(0,0,vu,vu,vu,0),q(vu,vu,0,0,0,vu),{vertices:M,indices:R}}(this.tileID.canonical,n);h=p.vertices,f=p.indices}else{h=new Lf,f=new No;for(let{x:v,y}of l)h.emplaceBack(v,y,0,0);let p=Lg(h.int16,void 0,4);for(let v=0;v<p.length;v+=3)f.emplaceBack(p[v],p[v+1],p[v+2])}this._tileBoundsBuffer=e.createVertexBuffer(h,yv.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(f),this._tileBoundsSegments=ha.simpleSegment(0,0,h.length,f.length)}_makeGlobeTileDebugBuffers(e,n){let l=n.projection;if(!l||l.name!=="globe"||n.freezeTileCoverage)return;let h=this.tileID.canonical,f=Fg(wS(h,n)),p=Hd(n.zoom),v;p>0&&(v=r.ad.invert(new Float64Array(16),n.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,h,n,f,v,p),this._makeGlobeTileDebugTextBuffer(e,h,n,f,v,p)}_globePoint(e,n,l,h,f,p,v){let y=Rg(e,n,l);if(p){let w=1<<l.z,A=qh(h.center.lng),M=$h(h.center.lat),R=(l.x+.5)/w-A,N=0;R>.5?N=-1:R<-.5&&(N=1);let z=(e/it+l.x)/w+N,q=(n/it+l.y)/w;z=(z-A)*h._pixelsPerMercatorPixel+A,q=(q-M)*h._pixelsPerMercatorPixel+M;let Z=[z*h.worldSize,q*h.worldSize,0];r._.transformMat4(Z,Z,p),y=Gd(y,Z,v)}return r._.transformMat4(y,y,f)}_makeGlobeTileDebugBorderBuffer(e,n,l,h,f,p){let v=new Ju,y=new Eg,w=new I1,A=(R,N,z,q,Z)=>{let oe=(z-R)/(Z-1),ye=(q-N)/(Z-1),be=v.length;for(let we=0;we<Z;we++){let $e=R+we*oe,He=N+we*ye;v.emplaceBack($e,He);let rt=this._globePoint($e,He,n,l,h,f,p);w.emplaceBack(rt[0],rt[1],rt[2]),y.emplaceBack(be+we)}},M=it;A(0,0,M,0,16),A(M,0,M,M,16),A(M,M,0,M,16),A(0,M,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(y),this._tileDebugBuffer=e.createVertexBuffer(v,Dg.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(w,xS.members),this._tileDebugSegments=ha.simpleSegment(0,0,v.length,y.length)}_makeGlobeTileDebugTextBuffer(e,n,l,h,f,p){let v=it/4,y=new Ju,w=new No,A=new I1,M=25;w.reserve(32),y.reserve(M),A.reserve(M);let R=(N,z)=>M*N+z;for(let N=0;N<M;N++){let z=N*v;for(let q=0;q<M;q++){let Z=q*v;y.emplaceBack(Z,z);let oe=this._globePoint(Z,z,n,l,h,f,p);A.emplaceBack(oe[0],oe[1],oe[2])}}for(let N=0;N<4;N++)for(let z=0;z<4;z++){let q=R(N,z),Z=R(N,z+1),oe=R(N+1,z),ye=R(N+1,z+1);w.emplaceBack(q,Z,oe),w.emplaceBack(oe,Z,ye)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(w),this._tileDebugTextBuffer=e.createVertexBuffer(y,Dg.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(A,xS.members),this._tileDebugTextSegments=ha.simpleSegment(0,0,M,32)}destroy(e=!1){for(let n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!e&&this.texture&&this.texture instanceof _u&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}let fi={read:function(t,e){return t.readFields(fi._readField,{header_length:0,x:0,y:0,z:0,layers:[]},e)},_readField:function(t,e,n){t===1?e.header_length=n.readFixed32():t===2?e.x=n.readVarint():t===3?e.y=n.readVarint():t===4?e.z=n.readVarint():t===5&&e.layers.push(fi.Layer.read(n,n.readVarint()+n.pos))},PixelFormat:{PIXEL_FORMAT_UNKNOWN:{value:0,options:{}},PIXEL_FORMAT_UINT32:{value:1,options:{}},PIXEL_FORMAT_UINT16:{value:2,options:{}},PIXEL_FORMAT_UINT8:{value:3,options:{}}},Filter:{}};fi.Filter.read=function(t,e){return t.readFields(fi.Filter._readField,{delta_filter:null,filter:null,zigzag_filter:null,bitshuffle_filter:null,byteshuffle_filter:null},e)},fi.Filter._readField=function(t,e,n){t===1?(e.delta_filter=fi.Filter.Delta.read(n,n.readVarint()+n.pos),e.filter="delta_filter"):t===2?(e.zigzag_filter=fi.Filter.Zigzag.read(n,n.readVarint()+n.pos),e.filter="zigzag_filter"):t===3?(e.bitshuffle_filter=fi.Filter.BitShuffle.read(n,n.readVarint()+n.pos),e.filter="bitshuffle_filter"):t===4&&(e.byteshuffle_filter=fi.Filter.ByteShuffle.read(n,n.readVarint()+n.pos),e.filter="byteshuffle_filter")},fi.Filter.Delta={},fi.Filter.Delta.read=function(t,e){return t.readFields(fi.Filter.Delta._readField,{block_size:0},e)},fi.Filter.Delta._readField=function(t,e,n){t===1&&(e.block_size=n.readVarint())},fi.Filter.Zigzag={},fi.Filter.Zigzag.read=function(t,e){return t.readFields(fi.Filter.Zigzag._readField,{},e)},fi.Filter.Zigzag._readField=function(t,e,n){},fi.Filter.BitShuffle={},fi.Filter.BitShuffle.read=function(t,e){return t.readFields(fi.Filter.BitShuffle._readField,{},e)},fi.Filter.BitShuffle._readField=function(t,e,n){},fi.Filter.ByteShuffle={},fi.Filter.ByteShuffle.read=function(t,e){return t.readFields(fi.Filter.ByteShuffle._readField,{},e)},fi.Filter.ByteShuffle._readField=function(t,e,n){},fi.Codec={},fi.Codec.read=function(t,e){return t.readFields(fi.Codec._readField,{gzip_data:null,codec:null,jpeg_image:null,webp_image:null,png_image:null},e)},fi.Codec._readField=function(t,e,n){t===1?(e.gzip_data=fi.Codec.GzipData.read(n,n.readVarint()+n.pos),e.codec="gzip_data"):t===2?(e.jpeg_image=fi.Codec.JpegImage.read(n,n.readVarint()+n.pos),e.codec="jpeg_image"):t===3?(e.webp_image=fi.Codec.WebpImage.read(n,n.readVarint()+n.pos),e.codec="webp_image"):t===4&&(e.png_image=fi.Codec.PngImage.read(n,n.readVarint()+n.pos),e.codec="png_image")},fi.Codec.GzipData={},fi.Codec.GzipData.read=function(t,e){return t.readFields(fi.Codec.GzipData._readField,{},e)},fi.Codec.GzipData._readField=function(t,e,n){},fi.Codec.JpegImage={},fi.Codec.JpegImage.read=function(t,e){return t.readFields(fi.Codec.JpegImage._readField,{},e)},fi.Codec.JpegImage._readField=function(t,e,n){},fi.Codec.WebpImage={},fi.Codec.WebpImage.read=function(t,e){return t.readFields(fi.Codec.WebpImage._readField,{},e)},fi.Codec.WebpImage._readField=function(t,e,n){},fi.Codec.PngImage={},fi.Codec.PngImage.read=function(t,e){return t.readFields(fi.Codec.PngImage._readField,{},e)},fi.Codec.PngImage._readField=function(t,e,n){},fi.DataIndexEntry={},fi.DataIndexEntry.read=function(t,e){return t.readFields(fi.DataIndexEntry._readField,{first_byte:0,last_byte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},e)},fi.DataIndexEntry._readField=function(t,e,n){t===1?e.first_byte=n.readFixed64():t===2?e.last_byte=n.readFixed64():t===3?e.filters.push(fi.Filter.read(n,n.readVarint()+n.pos)):t===4?e.codec=fi.Codec.read(n,n.readVarint()+n.pos):t===5?e.offset=n.readFloat():t===6?e.scale=n.readFloat():t===7&&e.bands.push(n.readString())},fi.Layer={},fi.Layer.read=function(t,e){return t.readFields(fi.Layer._readField,{version:0,name:"",units:"",tilesize:0,buffer:0,pixel_format:0,data_index:[]},e)},fi.Layer._readField=function(t,e,n){t===1?e.version=n.readVarint():t===2?e.name=n.readString():t===3?e.units=n.readString():t===4?e.tilesize=n.readVarint():t===5?e.buffer=n.readVarint():t===6?e.pixel_format=n.readVarint():t===7&&e.data_index.push(fi.DataIndexEntry.read(n,n.readVarint()+n.pos))};let nh={read:function(t,e){return t.readFields(nh._readField,{uint32_values:null,values:null,fixed32_values:null},e)},_readField:function(t,e,n){t===2?(e.uint32_values=nh.Uint32Values.read(n,n.readVarint()+n.pos),e.values="uint32_values"):t===3&&(e.fixed32_values=nh.Fixed32Values.read(n,n.readVarint()+n.pos),e.values="fixed32_values")},Uint32Values:{}};nh.Uint32Values.read=function(t,e){return t.readFields(nh.Uint32Values._readField,{values:[]},e)},nh.Uint32Values._readField=function(t,e,n){t===1&&(e.readValuesInto=function(l){if(l.type!==2)throw new Error(`Unsupported pbf type "${l.type}"`);let h=function(p){return p.type===2?p.readVarint()+p.pos:p.pos+1}(l),f=l.pos;return l.pos=h,function(p){l.pos=f;let v=0;for(;l.pos<h;){let y=l.readVarint();p[v++]=y}return p}}(n))},nh.Fixed32Values={},nh.Fixed32Values.read=function(t,e){return t.readFields(nh.Fixed32Values._readField,{values:[]},e)},nh.Fixed32Values._readField=function(t,e,n){throw new Error("Not implemented")};class LP{constructor(e=0,n=0,l=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=e,this.resetTtl=l,this.size=0,this.ttl=n}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(e){if(this.has(e)){let n=this.items[e];delete this.items[e],this.size--,n.prev!==null&&(n.prev.next=n.next),n.next!==null&&(n.next.prev=n.prev),this.first===n&&(this.first=n.next),this.last===n&&(this.last=n.prev)}return this}entries(e=this.keys()){return e.map(n=>[n,this.get(n)])}evict(e=!1){if(e||this.size>0){let n=this.first;delete this.items[n.key],--this.size==0?(this.first=null,this.last=null):(this.first=n.next,this.first.prev=null)}return this}expiresAt(e){let n;return this.has(e)&&(n=this.items[e].expiry),n}get(e){let n;if(this.has(e)){let l=this.items[e];this.ttl>0&&l.expiry<=Date.now()?this.delete(e):(n=l.value,this.set(e,n,!0))}return n}has(e){return e in this.items}keys(){let e=[],n=this.first;for(;n!==null;)e.push(n.key),n=n.next;return e}set(e,n,l=!1,h=this.resetTtl){let f;if(l||this.has(e)){if(f=this.items[e],f.value=n,l===!1&&h&&(f.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.last!==f){let p=this.last,v=f.next,y=f.prev;this.first===f&&(this.first=f.next),f.next=null,f.prev=this.last,p.next=f,y!==null&&(y.next=v),v!==null&&(v.prev=y)}}else this.max>0&&this.size===this.max&&this.evict(!0),f=this.items[e]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:n},++this.size==1?this.first=f:this.last.next=f;return this.last=f,this}values(e=this.keys()){return e.map(n=>this.get(n))}}function OP(t,e){if(e.length!==4)throw new Error(`Expected data of dimension 4 but got ${e.length}.`);let n=e[3];for(let l=2;l>=1;l--){let h=l===1?1:0,f=l===2?1:0;for(let p=0;p<e[0];p++){let v=e[1]*p;for(let y=h;y<e[1];y++){let w=e[2]*(y+v);for(let A=f;A<e[2];A++){let M=e[3]*(A+w);for(let R=0;R<e[3];R++){let N=M+R;t[N]+=t[N-n]}}}}n*=e[l]}return t}function NP(t){for(let e=0,n=t.length;e<n;e++)t[e]=t[e]>>>1^-(1&t[e]);return t}function BP(t,e){switch(e){case"uint32":return t;case"uint16":for(let n=0;n<t.length;n+=2){let l=t[n],h=t[n+1];t[n]=(240&l)>>4|(61440&l)>>8|(240&h)<<4|61440&h,t[n+1]=15&l|(3840&l)>>4|(15&h)<<8|(3840&h)<<4}return t;case"uint8":for(let n=0;n<t.length;n+=4){let l=t[n],h=t[n+1],f=t[n+2],p=t[n+3];t[n+0]=(192&l)>>6|(192&h)>>4|(192&f)>>2|192&p,t[n+1]=(48&l)>>4|(48&h)>>2|48&f|(48&p)<<2,t[n+2]=(12&l)>>2|12&h|(12&f)<<2|(12&p)<<4,t[n+3]=3&l|(3&h)<<2|(3&f)<<4|(3&p)<<6}return t;default:throw new Error(`Invalid pixel format, "${e}"`)}}class Jf extends Error{constructor(e){super(e),this.name="MRTError"}}var Uc=Uint8Array,f0=Uint16Array,zP=Int32Array,vA=new Uc([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),yA=new Uc([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),jP=new Uc([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),xA=function(t,e){for(var n=new f0(31),l=0;l<31;++l)n[l]=e+=1<<t[l-1];var h=new zP(n[30]);for(l=1;l<30;++l)for(var f=n[l];f<n[l+1];++f)h[f]=f-n[l]<<5|l;return{b:n,r:h}},bA=xA(vA,2),wA=bA.b,UP=bA.r;wA[28]=258,UP[258]=28;for(var VP=xA(yA,0).b,i2=new f0(32768),ro=0;ro<32768;++ro){var p0=(43690&ro)>>1|(21845&ro)<<1;i2[ro]=((65280&(p0=(61680&(p0=(52428&p0)>>2|(13107&p0)<<2))>>4|(3855&p0)<<4))>>8|(255&p0)<<8)>>1}var Kg=function(t,e,n){for(var l=t.length,h=0,f=new f0(e);h<l;++h)t[h]&&++f[t[h]-1];var p,v=new f0(e);for(h=1;h<e;++h)v[h]=v[h-1]+f[h-1]<<1;if(n){p=new f0(1<<e);var y=15-e;for(h=0;h<l;++h)if(t[h])for(var w=h<<4|t[h],A=e-t[h],M=v[t[h]-1]++<<A,R=M|(1<<A)-1;M<=R;++M)p[i2[M]>>y]=w}else for(p=new f0(l),h=0;h<l;++h)t[h]&&(p[h]=i2[v[t[h]-1]++]>>15-t[h]);return p},Jg=new Uc(288);for(ro=0;ro<144;++ro)Jg[ro]=8;for(ro=144;ro<256;++ro)Jg[ro]=9;for(ro=256;ro<280;++ro)Jg[ro]=7;for(ro=280;ro<288;++ro)Jg[ro]=8;var TA=new Uc(32);for(ro=0;ro<32;++ro)TA[ro]=5;var GP=Kg(Jg,9,1),HP=Kg(TA,5,1),n2=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},ah=function(t,e,n){var l=e/8|0;return(t[l]|t[l+1]<<8)>>(7&e)&n},a2=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(7&e)},WP=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],oh=function(t,e,n){var l=new Error(e||WP[t]);if(l.code=t,Error.captureStackTrace&&Error.captureStackTrace(l,oh),!n)throw l;return l},qP=new Uc(0),$P=typeof TextDecoder<"u"&&new TextDecoder;try{$P.decode(qP,{stream:!0})}catch{}let XP={gzip_data:"gzip"},ZP={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},YP={uint32:1,uint16:2,uint8:4},KP={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};class o2{constructor(e=1){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=e}getLayer(e){return this.layers[e]}getHeaderLength(e){let n=new Uint8Array(e),l=new DataView(e);if(n[0]!==13)throw new Jf("File is not a valid MRT.");return l.getUint32(1,!0)}parseHeader(e){let n=new Uint8Array(e),l=this.getHeaderLength(e);if(n.length<l)throw new Jf(`Expected header with length >= ${l} but got buffer of length ${n.length}`);let h=new a0(n.subarray(0,l)),f=fi.read(h);if(!isNaN(this.x)&&(this.x!==f.x||this.y!==f.y||this.z!==f.z))throw new Jf(`Invalid attempt to parse header ${f.z}/${f.x}/${f.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=f.x,this.y=f.y,this.z=f.z;for(let p of f.layers)this.layers[p.name]=new JP(p,{cacheSize:this._cacheSize});return this}createDecodingTask(e){let n=[],l=this.getLayer(e.layerName);for(let h=0;h<l.dataIndex.length;h++){let f=l.dataIndex[h],p=f.first_byte-e.firstByte,v=f.last_byte+1-e.firstByte;if(h<e.firstBlock||h>e.lastBlock||l._blocksInProgress.has(h))continue;let y={layerName:l.name,firstByte:p,lastByte:v,pixelFormat:l.pixelFormat,blockIndex:h,blockShape:[f.bands.length].concat(l.bandShape),buffer:l.buffer,codec:f.codec.codec,filters:f.filters.map(w=>w.filter)};l._blocksInProgress.add(h),n.push(y)}return new SA(n,()=>{n.forEach(h=>l._blocksInProgress.delete(h.blockIndex))},(h,f)=>{if(n.forEach(p=>l._blocksInProgress.delete(p.blockIndex)),h)throw h;f.forEach(p=>{this.getLayer(p.layerName).processDecodedData(p)})})}}class JP{constructor({version:e,name:n,units:l,tilesize:h,pixel_format:f,buffer:p,data_index:v},y){if(this.version=e,this.version!==1)throw new Jf(`Cannot parse raster layer encoded with MRT version ${e}`);this.name=n,this.units=l,this.tileSize=h,this.buffer=p,this.pixelFormat=ZP[f],this.dataIndex=v,this.bandShape=[h+2*p,h+2*p,YP[this.pixelFormat]],this._decodedBlocks=function(w=1e3,A=0,M=!1){if(isNaN(w)||w<0)throw new TypeError("Invalid max value");if(isNaN(A)||A<0)throw new TypeError("Invalid ttl value");if(typeof M!="boolean")throw new TypeError("Invalid resetTtl value");return new LP(w,A,M)}(y?y.cacheSize:5),this._blocksInProgress=new Set}processDecodedData(e){let n=e.blockIndex.toString();this._decodedBlocks.get(n)||this._decodedBlocks.set(n,e.data)}getBlockForBand(e){let n=0;switch(typeof e){case"string":for(let[l,h]of this.dataIndex.entries()){for(let[f,p]of h.bands.entries())if(p===e)return{bandIndex:n+f,blockIndex:l,blockBandIndex:f};n+=h.bands.length}break;case"number":for(let[l,h]of this.dataIndex.entries()){if(e>=n&&e<n+h.bands.length)return{bandIndex:e,blockIndex:l,blockBandIndex:e-n};n+=h.bands.length}break;default:throw new Jf(`Invalid band \`${JSON.stringify(e)}\`. Expected string or integer.`)}throw new Jf(`Band not found: ${JSON.stringify(e)}`)}getDataRange(e){let n=1/0,l=-1/0,h=1/0,f=-1/0;for(let p of e){let{blockIndex:v}=this.getBlockForBand(p);if(v<0)throw new Jf(`Invalid band: ${JSON.stringify(p)}`);let y=this.dataIndex[v];h=Math.min(h,v),f=Math.max(f,v),n=Math.min(n,y.first_byte),l=Math.max(l,y.last_byte)}return{layerName:this.name,firstByte:n,lastByte:l,firstBlock:h,lastBlock:f}}hasBand(e){let{blockIndex:n}=this.getBlockForBand(e);return n>=0}hasDataForBand(e){let{blockIndex:n}=this.getBlockForBand(e);return n>=0&&!!this._decodedBlocks.get(n.toString())}getBandView(e){let{blockIndex:n,blockBandIndex:l}=this.getBlockForBand(e),h=this._decodedBlocks.get(n.toString());if(!h)throw new Jf(`Data for band ${JSON.stringify(e)} of layer "${this.name}" not decoded.`);let f=this.dataIndex[n],p=this.bandShape.reduce((w,A)=>w*A,1),v=l*p,y=h.subarray(v,v+p);return{data:y,bytes:new Uint8Array(y.buffer).subarray(y.byteOffset,y.byteOffset+y.byteLength),tileSize:this.tileSize,buffer:this.buffer,offset:f.offset,scale:f.scale}}}class SA{constructor(e,n,l){this.tasks=e,this._onCancel=n,this._onComplete=l,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(e,n){this._finalized||(this._onComplete(e,n),this._finalized=!0)}}o2.performDecoding=function(t,e){return Promise.all(e.tasks.map(n=>{let{layerName:l,firstByte:h,lastByte:f,pixelFormat:p,blockShape:v,blockIndex:y,filters:w,codec:A}=n,M=new Uint8Array(t).subarray(h,f+1),R=new Uint32Array(v[0]*v[1]*v[2]),N;if(A!=="gzip_data")throw new Error(`Unhandled codec: ${A}`);return N=function(z,q){if(!globalThis.DecompressionStream&&q==="gzip_data")return Promise.resolve(((be=function(He){He[0]==31&&He[1]==139&&He[2]==8||oh(6,"invalid gzip data");var rt=He[3],ot=10;4&rt&&(ot+=2+(He[10]|He[11]<<8));for(var _t=(rt>>3&1)+(rt>>4&1);_t>0;_t-=!He[ot++]);return ot+(2&rt)}(ye=z))+8>ye.length&&oh(6,"invalid gzip data"),function(He,rt,ot,_t){var Mt=He.length;if(!Mt||rt.f&&!rt.l)return ot||new Uc(0);var At=!ot,zt=At||rt.i!=2,Jt=rt.i;At&&(ot=new Uc(3*Mt));var Ot,Xt,Dt=function(ep){var tp=ot.length;if(ep>tp){var im=new Uc(Math.max(2*tp,ep));im.set(ot),ot=im}},Zt=rt.f||0,ir=rt.p||0,Kt=rt.b||0,Sr=rt.l,er=rt.d,lr=rt.m,Zr=rt.n,zr=8*Mt;do{if(!Sr){Zt=ah(He,ir,1);var Or=ah(He,ir+1,3);if(ir+=3,!Or){var ar=He[(Zi=4+((ir+7)/8|0))-4]|He[Zi-3]<<8,Kr=Zi+ar;if(Kr>Mt){Jt&&oh(0);break}zt&&Dt(Kt+ar),ot.set(He.subarray(Zi,Kr),Kt),rt.b=Kt+=ar,rt.p=ir=8*Kr,rt.f=Zt;continue}if(Or==1)Sr=GP,er=HP,lr=9,Zr=5;else if(Or==2){var vi=ah(He,ir,31)+257,ri=ah(He,ir+10,15)+4,Si=vi+ah(He,ir+5,31)+1;ir+=14;for(var yi=new Uc(Si),Pi=new Uc(19),ei=0;ei<ri;++ei)Pi[jP[ei]]=ah(He,ir+3*ei,7);ir+=3*ri;var Sn=n2(Pi),wn=(1<<Sn)-1,tn=Kg(Pi,Sn,1);for(ei=0;ei<Si;){var Zi,rn=tn[ah(He,ir,wn)];if(ir+=15&rn,(Zi=rn>>4)<16)yi[ei++]=Zi;else{var jn=0,Mn=0;for(Zi==16?(Mn=3+ah(He,ir,3),ir+=2,jn=yi[ei-1]):Zi==17?(Mn=3+ah(He,ir,7),ir+=3):Zi==18&&(Mn=11+ah(He,ir,127),ir+=7);Mn--;)yi[ei++]=jn}}var xa=yi.subarray(0,vi),fa=yi.subarray(vi);lr=n2(xa),Zr=n2(fa),Sr=Kg(xa,lr,1),er=Kg(fa,Zr,1)}else oh(1);if(ir>zr){Jt&&oh(0);break}}zt&&Dt(Kt+131072);for(var Ms=(1<<lr)-1,Ba=(1<<Zr)-1,ia=ir;;ia=ir){var mo=(jn=Sr[a2(He,ir)&Ms])>>4;if((ir+=15&jn)>zr){Jt&&oh(0);break}if(jn||oh(2),mo<256)ot[Kt++]=mo;else{if(mo==256){ia=ir,Sr=null;break}var Yo=mo-254;mo>264&&(Yo=ah(He,ir,(1<<(pl=vA[ei=mo-257]))-1)+wA[ei],ir+=pl);var Ko=er[a2(He,ir)&Ba],Pn=Ko>>4;if(Ko||oh(3),ir+=15&Ko,fa=VP[Pn],Pn>3){var pl=yA[Pn];fa+=a2(He,ir)&(1<<pl)-1,ir+=pl}if(ir>zr){Jt&&oh(0);break}zt&&Dt(Kt+131072);var $d=Kt+Yo;if(Kt<fa){var yu=0-fa,lh=Math.min(fa,$d);for(yu+Kt<0&&oh(3);Kt<lh;++Kt)ot[Kt]=(void 0)[yu+Kt]}for(;Kt<$d;++Kt)ot[Kt]=ot[Kt-fa]}}rt.l=Sr,rt.p=ia,rt.b=Kt,rt.f=Zt,Sr&&(Zt=1,rt.m=lr,rt.d=er,rt.n=Zr)}while(!Zt);return Kt!=ot.length&&At?(Ot=ot,((Xt=Kt)==null||Xt>Ot.length)&&(Xt=Ot.length),new Uc(Ot.subarray(0,Xt))):ot.subarray(0,Kt)}(ye.subarray(be,-8),{i:2},new Uc(((Z=ye)[(oe=Z.length)-4]|Z[oe-3]<<8|Z[oe-2]<<16|Z[oe-1]<<24)>>>0))));var Z,oe,ye,be;let we=XP[q];if(!we)throw new Error(`Unhandled codec: ${q}`);let $e=new globalThis.DecompressionStream(we);return new Response(new Blob([z]).stream().pipeThrough($e)).arrayBuffer().then(He=>new Uint8Array(He))}(M,A).then(z=>{let q=nh.read(new a0(z));if(q.values==="uint32_values")return q.uint32_values.readValuesInto(R),new KP[p](R.buffer);throw new Error(`Unhandled numeric data "${q.values}"`)}),N.then(z=>{for(let q=w.length-1;q>=0;q--)switch(w[q]){case"delta_filter":OP(z,v);break;case"zigzag_filter":NP(z);break;case"bitshuffle_filter":BP(z,p);break;default:throw new Error(`Unhandled filter "${w[q]}"`)}return{layerName:l,blockIndex:y,data:z}}).catch(z=>{throw z})}))};class EA extends xv{constructor(e,n,l,h,f){super(e,n,l,h,f),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(e,n){let l=n.context,h=l.gl;this.texture=this.texture||n.getTileTexture(e.width),this.texture&&this.texture instanceof _u?this.texture.update(e,{useMipmap:!1,premultiply:!1}):this.texture=new _u(l,e,h.RGBA,{useMipmap:!1,premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(e=16384,n){let l=this._mrt=new o2(30),h=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(e-1)}});return this.entireBuffer=null,this.request=ho(h,(f,p,v,y)=>{if(f)n(f);else try{let w=l.getHeaderLength(p);if(w>e)return void(this.request=this.fetchHeader(w,n));l.parseHeader(p),this._isHeaderLoaded=!0;let A=0;for(let M of Object.values(l.layers))A=Math.max(A,M.dataIndex[M.dataIndex.length-1].last_byte);p.byteLength>=A&&(this.entireBuffer=p),n(null,this.entireBuffer||p,v,y)}catch(w){n(w)}}),this.request}fetchBand(e,n,l){let h=this._mrt;if(!this._isHeaderLoaded||!h)return void l(new Error("Tile header is not ready"));let f=this.actor;if(!f)return void l(new Error("Can't fetch tile band without an actor"));let p,v=(M,R)=>{p.complete(M,R),M?l(M):(this.updateTextureDescriptor(e,n),l(null,this.textureDescriptor&&this.textureDescriptor.img))},y=(M,R)=>{if(M)return l(M);let N=f.send("decodeRasterArray",{buffer:R,task:p},v,void 0,!0);this._workQueue.push(()=>{N&&N.cancel(),p.cancel()})},w=h.getLayer(e);if(!w)return void l(new Error(`Unknown sourceLayer "${e}"`));if(w.hasDataForBand(n))return this.updateTextureDescriptor(e,n),void l(null,this.textureDescriptor?this.textureDescriptor.img:null);let A=w.getDataRange([n]);if(p=h.createDecodingTask(A),!p||p.tasks.length)if(this.flushQueues(),this.entireBuffer)y(null,this.entireBuffer.slice(A.firstByte,A.lastByte+1));else{let M=Object.assign({},this.requestParams,{headers:{Range:`bytes=${A.firstByte}-${A.lastByte}`}}),R=ho(M,y);this._fetchQueue.push(()=>{R.cancel(),p.cancel()})}else l(null)}updateNeeded(e,n){return(!this.textureDescriptor||this.textureDescriptor.band!==n||this.textureDescriptor.layer!==e)&&this.state!=="errored"}updateTextureDescriptor(e,n){if(!this._mrt)return;let l=this._mrt.getLayer(e);if(!l||!l.hasBand(n)||!l.hasDataForBand(n))return;let{bytes:h,tileSize:f,buffer:p,offset:v,scale:y}=l.getBandView(n),w=f+2*p,A={data:h,width:w,height:w},M=this.texture;M&&M instanceof _u&&M.update(A,{useMipmap:!1,premultiply:!1}),this.textureDescriptor={layer:e,band:n,img:A,buffer:p,offset:v,tileSize:f,format:l.pixelFormat,mix:[y,256*y,65536*y,16777216*y]}}}class QP{constructor(e,n){this.max=e,this.onRemove=n,this.reset()}reset(){for(let e in this.data)for(let n of this.data[e])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(e,n,l){let h=e.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);let f={value:n,timeout:void 0};if(l!==void 0&&(f.timeout=setTimeout(()=>{this.remove(e,f)},l)),this.data[h].push(f),this.order.push(h),this.order.length>this.max){let p=this._getAndRemoveByKey(this.order[0]);p&&this.onRemove(p)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){let n=this.data[e].shift();return n.timeout&&clearTimeout(n.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),n.value}getByKey(e){let n=this.data[e];return n?n[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,n){if(!this.has(e))return this;let l=e.wrapped().key,h=n===void 0?0:this.data[l].indexOf(n),f=this.data[l][h];return this.data[l].splice(h,1),f.timeout&&clearTimeout(f.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(f.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){let n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(e){let n=[];for(let l in this.data)for(let h of this.data[l])e(h.value)||n.push(h);for(let l of n)this.remove(l.value.tileID,l)}}class Qp extends Kl{constructor(e,n,l){super(),this.id=e,this._onlySymbols=l,n.on("data",h=>{h.dataType==="source"&&h.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&h.dataType==="source"&&h.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),n.on("error",()=>{this._sourceErrored=!0}),this._source=n,this._tiles={},this._cache=new QP(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=n.minTileCacheSize,this._maxTileCacheSize=n.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new rP,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(let e in this._tiles){let n=this._tiles[e];if(n.state!=="errored"&&(n.state!=="loaded"||!n.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,n){return e.isSymbolTile=this._onlySymbols,e.isExtraShadowCaster=this._shadowCasterTiles[e.tileID.key],this._source.loadTile(e,n)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e)}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e)}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let n in this._tiles){let l=this._tiles[n];l.upload(e),l.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return lo(this._tiles).map(e=>e.tileID).sort(AA).map(e=>e.key)}getRenderableIds(e,n){let l=[];for(let h in this._tiles)this._isIdRenderable(+h,e,n)&&l.push(this._tiles[h]);return e?l.sort((h,f)=>{let p=h.tileID,v=f.tileID,y=new hr(p.canonical.x,p.canonical.y)._rotate(this.transform.angle),w=new hr(v.canonical.x,v.canonical.y)._rotate(this.transform.angle);return p.overscaledZ-v.overscaledZ||w.y-y.y||w.x-y.x}).map(h=>h.tileID.key):l.map(h=>h.tileID).sort(AA).map(h=>h.key)}hasRenderableParent(e){let n=this.findLoadedParent(e,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(e,n,l){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(n||!this._tiles[e].holdingForFade())&&(l||!this._shadowCasterTiles[e])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(let e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,n){let l=this._tiles[e];l&&(l.state!=="loading"&&(l.state=n),this._loadTile(l,this._tileLoaded.bind(this,l,e,n)))}_tileLoaded(e,n,l,h){if(h)if(e.state="errored",h.status!==404)this._source.fire(new Mc(h,{tile:e}));else{if(!(e.tileID.key in this._loadedParentTiles))return void this._source.fire(new Ha("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id}));if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){let f=this.map.painter.terrain;this.update(this.transform,f.getScaledDemTileSize(),!0),f.resetTileLookupCache(this.id)}else this.update(this.transform)}else e.timeAdded=di.now(),l==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Ha("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){let n=this.getRenderableIds();for(let h=0;h<n.length;h++){let f=n[h];if(e.neighboringTiles&&e.neighboringTiles[f]){let p=this.getTileByID(f);l(e,p),l(p,e)}}function l(h,f){if(!h.dem||h.dem.borderReady)return;h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0;let p=f.tileID.canonical.x-h.tileID.canonical.x,v=f.tileID.canonical.y-h.tileID.canonical.y,y=Math.pow(2,h.tileID.canonical.z),w=f.tileID.key;p===0&&v===0||Math.abs(v)>1||(Math.abs(p)>1&&(Math.abs(p+y)===1?p+=y:Math.abs(p-y)===1&&(p-=y)),f.dem&&h.dem&&(h.dem.backfillBorder(f.dem,p,v),h.neighboringTiles&&h.neighboringTiles[w]&&(h.neighboringTiles[w].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,n,l,h){for(let f in this._tiles){let p=this._tiles[f];if(h[f]||!p.hasData()||p.tileID.overscaledZ<=n||p.tileID.overscaledZ>l)continue;let v=p.tileID;for(;p&&p.tileID.overscaledZ>n+1;){let w=p.tileID.scaledTo(p.tileID.overscaledZ-1);p=this._tiles[w.key],p&&p.hasData()&&(v=w)}let y=v;for(;y.overscaledZ>n;)if(y=y.scaledTo(y.overscaledZ-1),e[y.key]){h[v.key]=v;break}}}findLoadedParent(e,n){if(e.key in this._loadedParentTiles){let l=this._loadedParentTiles[e.key];return l&&l.tileID.overscaledZ>=n?l:null}for(let l=e.overscaledZ-1;l>=n;l--){let h=e.scaledTo(l),f=this._getLoadedTile(h);if(f)return f}}_getLoadedTile(e){let n=this._tiles[e.key];return n&&n.hasData()?n:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,n){n=n||this._source.tileSize;let l=Math.ceil(e.width/n)+1,h=Math.ceil(e.height/n)+1,f=Math.floor(l*h*5),p=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,f):f,v=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(v)}handleWrapJump(e){let n=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,n){let l={};for(let h in this._tiles){let f=this._tiles[h];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+n),l[f.tileID.key]=f}this._tiles=l;for(let h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(let h in this._tiles)this._setTileReloadTimer(+h,this._tiles[h])}}update(e,n,l,h){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!l)return;let f;if(this.updateCacheSize(e,n),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain){if(this._source.tileID)f=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(y=>new wo(y.canonical.z,y.wrap,y.canonical.z,y.canonical.x,y.canonical.y));else if(this.tileCoverLift!==0){let y=e.clone();y.tileCoverLift=this.tileCoverLift,f=y.coveringTiles({tileSize:n||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!l,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.minzoom<=1&&e.projection.name==="globe"&&(f.push(new wo(1,0,1,0,0)),f.push(new wo(1,0,1,1,0)),f.push(new wo(1,0,1,0,1)),f.push(new wo(1,0,1,1,1)))}else if(f=e.coveringTiles({tileSize:n||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!l,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile){let y=this._source.hasTile.bind(this._source);f=f.filter(w=>y(w))}}else f=[];if(f.length>0&&this.castsShadows&&h&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!s2(this._source.type)){let y=e.coveringZoomLevel({tileSize:n||this._source.tileSize,roundZoom:this._source.roundZoom&&!l}),w=Math.min(y,this._source.maxzoom),A=e.extendTileCoverForShadows(f,h,w);for(let M of A)this._shadowCasterTiles[M.key]=!0,f.push(M)}let p=this._updateRetainedTiles(f);if(s2(this._source.type)&&f.length!==0){let y={},w={},A=Object.keys(p);for(let R of A){let N=p[R],z=this._tiles[R];if(!z||z.fadeEndTime&&z.fadeEndTime<=di.now())continue;let q=this.findLoadedParent(N,Math.max(N.overscaledZ-Qp.maxOverzooming,this._source.minzoom));q&&(this._addTile(q.tileID),y[q.tileID.key]=q.tileID),w[R]=N}let M=f[f.length-1].overscaledZ;for(let R in this._tiles){let N=this._tiles[R];if(p[R]||!N.hasData())continue;let z=N.tileID;for(;z.overscaledZ>M;){z=z.scaledTo(z.overscaledZ-1);let q=this._tiles[z.key];if(q&&q.hasData()&&w[z.key]){p[R]=N.tileID;break}}}for(let R in y)p[R]||(this._coveredTiles[R]=!0,p[R]=y[R])}for(let y in p)this._tiles[y].clearFadeHold();let v=function(y,w){let A=[];for(let M in y)M in w||A.push(M);return A}(this._tiles,p);for(let y of v){let w=this._tiles[y];w.hasSymbolBuckets&&!w.holdingForFade()?w.setHoldDuration(this.map._fadeDuration):w.hasSymbolBuckets&&!w.symbolFadeFinished()||this._removeTile(+y)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(let e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){let n={};if(e.length===0)return n;let l={},h=e.reduce((w,A)=>Math.min(w,A.overscaledZ),1/0),f=e[0].overscaledZ,p=Math.max(f-Qp.maxOverzooming,this._source.minzoom),v=Math.max(f+Qp.maxUnderzooming,this._source.minzoom),y={};for(let w of e){let A=this._addTile(w);n[w.key]=w,A.hasData()||h<this._source.maxzoom&&(y[w.key]=w)}this._retainLoadedChildren(y,h,v,n);for(let w of e){let A=this._tiles[w.key];if(A.hasData())continue;if(w.canonical.z>=this._source.maxzoom){let R=w.children(this._source.maxzoom)[0],N=this.getTile(R);if(N&&N.hasData()){n[R.key]=R;continue}}else{let R=w.children(this._source.maxzoom);if(n[R[0].key]&&n[R[1].key]&&n[R[2].key]&&n[R[3].key])continue}let M=A.wasRequested();for(let R=w.overscaledZ-1;R>=p;--R){let N=w.scaledTo(R);if(l[N.key]||(l[N.key]=!0,A=this.getTile(N),!A&&M&&(A=this._addTile(N)),A&&(n[N.key]=N,M=A.wasRequested(),A.hasData())))break}}return n}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(let e in this._tiles){let n=[],l,h=this._tiles[e].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){l=this._loadedParentTiles[h.key];break}n.push(h.key);let f=h.scaledTo(h.overscaledZ-1);if(l=this._getLoadedTile(f),l)break;h=f}for(let f of n)this._loadedParentTiles[f]=l}}_addTile(e){let n=this._tiles[e.key];if(n)return n.isExtraShadowCaster!==!0||this._shadowCasterTiles[e.key]||this._reloadTile(e.key,"reloading"),n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));let l=!!n;if(!l){let h=this.map?this.map.painter:null,f=this._source.tileSize*e.overscaleFactor();n=this._source.type==="raster-array"?new EA(e,f,this.transform.tileZoom,h,this._isRaster):new xv(e,f,this.transform.tileZoom,h,this._isRaster),this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))}return n?(n.uses++,this._tiles[e.key]=n,l||this._source.fire(new Ha("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null}_setTileReloadTimer(e,n){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);let l=n.getExpiryTimeout();l&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},l))}_removeTile(e){let n=this._tiles[e];n&&(n.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),n.uses>0||(n.hasData()&&n.state!=="reloading"||n.state==="empty"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,n,l){let h=[],f=this.transform;if(!f)return h;let p=f.projection.name==="globe",v=qh(f.center.lng);for(let y in this._tiles){let w=this._tiles[y];if(l&&w.clearQueryDebugViz(),w.holdingForFade())continue;let A;if(p){let M=w.tileID.canonical;if(M.z===0){let R=[Math.abs(ui(v,...Qg(M,-1))-v),Math.abs(ui(v,...Qg(M,1))-v)];A=[0,2*R.indexOf(Math.min(...R))-1]}else{let R=[Math.abs(ui(v,...Qg(M,-1))-v),Math.abs(ui(v,...Qg(M,0))-v),Math.abs(ui(v,...Qg(M,1))-v)];A=[R.indexOf(Math.min(...R))-1]}}else A=[0];for(let M of A){let R=e.containsTile(w,f,n,M);R&&h.push(R)}}return h}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(e){return this._getRenderableCoordinates(e)}_getRenderableCoordinates(e,n){let l=this.getRenderableIds(e,n).map(f=>this._tiles[f].tileID),h=this.transform.projection.name==="globe";for(let f of l)f.projMatrix=this.transform.calculateProjMatrix(f.toUnwrapped()),f.expandedProjMatrix=h?this.transform.calculateProjMatrix(f.toUnwrapped(),!1,!0):f.projMatrix;return l}sortCoordinatesByDistance(e){let n=e.slice(),l=this.transform._camera.position,h=this.transform._camera.forward(),f={};for(let p of n){let v=1/(1<<p.canonical.z);f[p.key]=((p.canonical.x+.5)*v+p.wrap-l[0])*h[0]+((p.canonical.y+.5)*v-l[1])*h[1]-l[2]*h[2]}return n.sort((p,v)=>f[p.key]-f[v.key]),n}hasTransition(){if(this._source.hasTransition())return!0;if(s2(this._source.type))for(let e in this._tiles){let n=this._tiles[e];if(n.fadeEndTime!==void 0&&n.fadeEndTime>=di.now())return!0}return!1}setFeatureState(e,n,l){this._state.updateState(e=e||"_geojsonTileLayer",n,l)}removeFeatureState(e,n,l){this._state.removeFeatureState(e=e||"_geojsonTileLayer",n,l)}getFeatureState(e,n){return this._state.getState(e=e||"_geojsonTileLayer",n)}setDependencies(e,n,l){let h=this._tiles[e];h&&h.setDependencies(n,l)}reloadTilesForDependencies(e,n){for(let l in this._tiles)this._tiles[l].hasDependency(e,n)&&this._reloadTile(+l,"reloading");this._cache.filter(l=>!l.hasDependency(e,n))}_preloadTiles(e,n){if(!this._sourceLoaded){let v=()=>{this._sourceLoaded&&(this._source.off("data",v),this._preloadTiles(e,n))};return void this._source.on("data",v)}let l=new Map,h=Array.isArray(e)?e:[e],f=this.map.painter.terrain,p=this.usedForTerrain&&f?f.getScaledDemTileSize():this._source.tileSize;for(let v of h){let y=v.coveringTiles({tileSize:p,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(let w of y)l.set(w.key,w);this.usedForTerrain&&v.updateElevation(!1)}bc(Array.from(l.values()),(v,y)=>{let w=new xv(v,this._source.tileSize*v.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(w,A=>{this._source.type==="raster-dem"&&w.dem&&this._backfillDEM(w),y(A,w)})},n)}}function AA(t,e){let n=Math.abs(2*t.wrap)-+(t.wrap<0),l=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||l-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function s2(t){return t==="raster"||t==="image"||t==="video"||t==="custom"}function Qg(t,e){let n=1<<t.z;return[t.x/n+e,(t.x+1)/n+e]}Qp.maxOverzooming=10,Qp.maxUnderzooming=3;let CA=new class extends _r{possiblyEvaluate(t,e){return e=new ni(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,n,l){return e=Ma({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,n,l)}}(rv.paint.properties["line-width"].specification);function IA(t,e){return e>0?e+2*t:t}CA.useIntegerZoom=!0;let eL=new un({"symbol-placement":new Ht(vt.layout_symbol["symbol-placement"]),"symbol-spacing":new Ht(vt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ht(vt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new _r(vt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ht(vt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Ht(vt.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new Ht(vt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ht(vt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ht(vt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ht(vt.layout_symbol["icon-rotation-alignment"]),"icon-size":new _r(vt.layout_symbol["icon-size"]),"icon-text-fit":new _r(vt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new _r(vt.layout_symbol["icon-text-fit-padding"]),"icon-image":new _r(vt.layout_symbol["icon-image"]),"icon-rotate":new _r(vt.layout_symbol["icon-rotate"]),"icon-padding":new Ht(vt.layout_symbol["icon-padding"]),"icon-keep-upright":new Ht(vt.layout_symbol["icon-keep-upright"]),"icon-offset":new _r(vt.layout_symbol["icon-offset"]),"icon-anchor":new _r(vt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ht(vt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ht(vt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ht(vt.layout_symbol["text-rotation-alignment"]),"text-field":new _r(vt.layout_symbol["text-field"]),"text-font":new _r(vt.layout_symbol["text-font"]),"text-size":new _r(vt.layout_symbol["text-size"]),"text-max-width":new _r(vt.layout_symbol["text-max-width"]),"text-line-height":new _r(vt.layout_symbol["text-line-height"]),"text-letter-spacing":new _r(vt.layout_symbol["text-letter-spacing"]),"text-justify":new _r(vt.layout_symbol["text-justify"]),"text-radial-offset":new _r(vt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ht(vt.layout_symbol["text-variable-anchor"]),"text-anchor":new _r(vt.layout_symbol["text-anchor"]),"text-max-angle":new Ht(vt.layout_symbol["text-max-angle"]),"text-writing-mode":new Ht(vt.layout_symbol["text-writing-mode"]),"text-rotate":new _r(vt.layout_symbol["text-rotate"]),"text-padding":new Ht(vt.layout_symbol["text-padding"]),"text-keep-upright":new Ht(vt.layout_symbol["text-keep-upright"]),"text-transform":new _r(vt.layout_symbol["text-transform"]),"text-offset":new _r(vt.layout_symbol["text-offset"]),"text-allow-overlap":new Ht(vt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ht(vt.layout_symbol["text-ignore-placement"]),"text-optional":new Ht(vt.layout_symbol["text-optional"]),visibility:new Ht(vt.layout_symbol.visibility)});var l2={paint:new un({"icon-opacity":new _r(vt.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new _r(vt.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new _r(vt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new _r(vt.paint_symbol["text-emissive-strength"]),"icon-color":new _r(vt.paint_symbol["icon-color"]),"icon-halo-color":new _r(vt.paint_symbol["icon-halo-color"]),"icon-halo-width":new _r(vt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new _r(vt.paint_symbol["icon-halo-blur"]),"icon-translate":new Ht(vt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ht(vt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new _r(vt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new _r(vt.paint_symbol["text-opacity"]),"text-occlusion-opacity":new _r(vt.paint_symbol["text-occlusion-opacity"]),"text-color":new _r(vt.paint_symbol["text-color"],{runtimeType:Po,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new _r(vt.paint_symbol["text-halo-color"]),"text-halo-width":new _r(vt.paint_symbol["text-halo-width"]),"text-halo-blur":new _r(vt.paint_symbol["text-halo-blur"]),"text-translate":new Ht(vt.paint_symbol["text-translate"]),"text-translate-anchor":new Ht(vt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Ht(vt.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Ht(vt.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Ht(vt.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Ht(vt.paint_symbol["icon-color-brightness-max"])}),layout:eL};class kA{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Dc,this.defaultValue=e}evaluate(e){if(e.formattedSection){let n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Fe(kA,"FormatSectionOverride",{omit:["defaultValue"]});class bv extends bo{constructor(e,n,l,h){super(e,l2,n,l,h),this._colorAdjustmentMatrix=r.ad.identity([]),this.hasInitialOcclusionOpacityProperties=e.paint!==void 0&&("icon-occlusion-opacity"in e.paint||"text-occlusion-opacity"in e.paint)}recalculate(e,n){super.recalculate(e,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));let l=this.layout.get("text-writing-mode");if(l){let h=[];for(let f of l)h.indexOf(f)<0&&h.push(f);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(e,n,l,h){return this._saturation===e&&this._contrast===n&&this._brightnessMin===l&&this._brightnessMax===h||(this._colorAdjustmentMatrix=function(f,p,v,y){f=hi(f),p=Yr(p);let w=r.ad.create(),A=f/3,M=1-2*A,R=[M,A,A,0,A,M,A,0,A,A,M,0,0,0,0,1],N=.5-.5*p,z=y-v;return r.ad.multiply(w,[z,0,0,0,0,z,0,0,0,0,z,0,v,v,v,1],[p,0,0,0,0,p,0,0,0,0,p,0,N,N,N,1]),r.ad.multiply(w,w,R),w}(e,n,l,h),this._saturation=e,this._contrast=n,this._brightnessMin=l,this._brightnessMax=h),this._colorAdjustmentMatrix}getValueAndResolveTokens(e,n,l,h){let f=this.layout.get(e).evaluate(n,{},l,h),p=this._unevaluatedLayout._values[e];return p.isDataDriven()||X(p.value)||!f?f:function(v,y){return y.replace(/{([^{}]+)}/g,(w,A)=>A in v?String(v[A]):"")}(n.properties,f)}createBucket(e){return new d0(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(let e of l2.paint.overridableProperties){if(!bv.hasPaintOverride(this.layout,e))continue;let n=this.paint.get(e),l=new kA(n),h=new V(l,n.property.specification,this.scope,this.options),f=null;f=n.value.kind==="constant"||n.value.kind==="source"?new ae("source",h):new ue("composite",h,n.value.zoomStops,n.value._interpolationType),this.paint._values[e]=new $n(n.property,f,n.parameters)}}_handleOverridablePaintPropertyUpdate(e,n,l){return!(!this.layout||n.isDataDriven()||l.isDataDriven())&&bv.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,n){let l=e.get("text-field"),h=l2.paint.properties[n],f=!1,p=v=>{for(let y of v)if(h.overrides&&h.overrides.hasOverride(y))return void(f=!0)};if(l.value.kind==="constant"&&l.value.value instanceof Ja)p(l.value.value.sections);else if(l.value.kind==="source"){let v=w=>{f||(w instanceof Fc&&Wa(w.value)===Ph?p(w.value.sections):w instanceof Ws?p(w.sections):w.eachChild(v))},y=l.value;y._styleExpression&&v(y._styleExpression.expression)}return f}getProgramIds(){let e=this.paint.get("icon-opacity").constantOr(1)!==0,n=this.paint.get("text-opacity").constantOr(1)!==0,l=[];return e&&l.push("symbolIcon"),n&&l.push("symbolSDF"),l}getDefaultProgramParams(e,n,l){return{config:new qp(this,{zoom:n,lut:l}),overrideFog:!1}}}let tL=new un({visibility:new Ht(vt.layout_background.visibility)});var rL={paint:new un({"background-color":new Ht(vt.paint_background["background-color"]),"background-pattern":new Ht(vt.paint_background["background-pattern"]),"background-opacity":new Ht(vt.paint_background["background-opacity"]),"background-emissive-strength":new Ht(vt.paint_background["background-emissive-strength"])}),layout:tL};let iL=new un({visibility:new Ht(vt.layout_raster.visibility)});var nL={paint:new un({"raster-opacity":new Ht(vt.paint_raster["raster-opacity"]),"raster-color":new ua(vt.paint_raster["raster-color"]),"raster-color-mix":new Ht(vt.paint_raster["raster-color-mix"]),"raster-color-range":new Ht(vt.paint_raster["raster-color-range"]),"raster-hue-rotate":new Ht(vt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ht(vt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ht(vt.paint_raster["raster-brightness-max"]),"raster-saturation":new Ht(vt.paint_raster["raster-saturation"]),"raster-contrast":new Ht(vt.paint_raster["raster-contrast"]),"raster-resampling":new Ht(vt.paint_raster["raster-resampling"]),"raster-fade-duration":new Ht(vt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Ht(vt.paint_raster["raster-emissive-strength"]),"raster-array-band":new Ht(vt.paint_raster["raster-array-band"]),"raster-elevation":new Ht(vt.paint_raster["raster-elevation"])}),layout:iL};function wv(t,e,n,l,h,f,p,v){let y=[t,e,1,n,l,1,h,f,1],w=[p,v,1],A=r.bC.adjoint([],y),[M,R,N]=r._.transformMat3(w,w,A);return r.bC.multiply(y,y,[M,0,0,0,R,0,0,0,N])}function MA(t,e,n,l,h,f,p,v){let y=function(w,A,M,R,N,z,q,Z){let oe=wv(0,0,1,0,1,1,0,1),ye=wv(w,A,M,R,N,z,q,Z),be=r.bC.adjoint([],oe);return r.bC.multiply(ye,ye,be)}(t,e,n,l,h,f,p,v);return[y[2]/y[8]/it,y[5]/y[8]/it]}function Tv(t){return[t[0],Math.min(Math.max(t[1],-$a),$a)]}class DA extends Kl{constructor(e,n,l,h){super(),this.id=e,this.dispatcher=l,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(h),this.options=n,this._dirty=!1}load(e,n){if(this._loaded=n||!1,this.fire(new Ha("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return e&&(this.coordinates=e),this._loaded=!0,void this._finishLoading();this._imageRequest=nl(this.map._requestManager.transformRequest(this.url,Ec.Image),(l,h)=>{this._imageRequest=null,this._loaded=!0,l?this.fire(new Mc(l)):h&&(this.image=h instanceof HTMLImageElement?di.getImageData(h):h,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,e&&(this.coordinates=e),this._finishLoading())})}loaded(){return this._loaded}updateImage(e){return e.url?(this._imageRequest&&e.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=e.url,this.load(e.coordinates,this._loaded),this):this}setTexture(e){if(!(e.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new _v(this.map.painter.context,e.handle),this.width=e.dimensions[0],this.height=e.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Ha("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(e){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof _v||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(e){if(this.coordinates=e,this._boundsArray=void 0,this._unsupportedCoords=!1,!e.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let n=e[0][1],l=e[0][1];for(let f of e)f[1]>l&&(l=f[1]),f[1]<n&&(n=f[1]);let h=(l+n)/2;if(h>$a?this.onNorthPole=!0:h<-$a&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){let f=e.map(ks.fromLngLat);this.tileID=function(p){let v=1/0,y=1/0,w=-1/0,A=-1/0;for(let q of p)v=Math.min(v,q.x),y=Math.min(y,q.y),w=Math.max(w,q.x),A=Math.max(A,q.y);let M=Math.max(w-v,A-y),R=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),N=Math.pow(2,R),z=Math.floor((v+w)/2*N);return z>1&&(z-=1),new Xp(R,z,Math.floor((y+A)/2*N))}(f),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Ha("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(e){for(let Z in this.tiles){let oe=this.tiles[Z];oe.state!=="loaded"&&(oe.state="loaded",oe.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;let n=Jp(new Xp(0,0,0),this.map.transform.projection),l=[n.projection.project(this.coordinates[0][0],this.coordinates[0][1]),n.projection.project(this.coordinates[1][0],this.coordinates[1][1]),n.projection.project(this.coordinates[2][0],this.coordinates[2][1]),n.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(Z){let oe=Z[1].x-Z[0].x,ye=Z[1].y-Z[0].y,be=Z[2].x-Z[1].x,we=Z[2].y-Z[1].y,$e=Z[3].x-Z[2].x,He=Z[3].y-Z[2].y,rt=Z[0].x-Z[3].x,ot=Z[0].y-Z[3].y,_t=oe*we-be*ye,Mt=be*He-$e*we,At=$e*ot-rt*He,zt=rt*ye-oe*ot;return _t>0&&Mt>0&&At>0&&zt>0||_t<0&&Mt<0&&At<0&&zt<0}(l))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);let h=Jp(this.tileID,this.map.transform.projection),[f,p,v,y]=this.coordinates.map(Z=>{let oe=h.projection.project(Z[0],Z[1]);return uA(h,oe)._round()});this.perspectiveTransform=MA(f.x,f.y,p.x,p.y,v.x,v.y,y.x,y.y);let w=this._boundsArray=new Lf;w.emplaceBack(f.x,f.y,0,0),w.emplaceBack(p.x,p.y,it,0),w.emplaceBack(y.x,y.y,0,it),w.emplaceBack(v.x,v.y,it,it),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=e.createVertexBuffer(w,yv.members),this.boundsSegments=ha.simpleSegment(0,0,4,2);let A=[],M=function(Z){return[Tv(Z[0]),Tv(Z[1]),Tv(Z[2]),Tv(Z[3])]}(this.coordinates),[R,N,z,q]=function(Z){let oe=Z[0][0],ye=oe,be=Z[0][1],we=be;for(let $e=1;$e<Z.length;$e++)Z[$e][0]<oe?oe=Z[$e][0]:Z[$e][0]>ye&&(ye=Z[$e][0]),Z[$e][1]<be?be=Z[$e][1]:Z[$e][1]>we&&(we=Z[$e][1]);return[oe,be,ye-oe,we-be]}(M);{let Z=new Lf,[oe,ye,be,we]=function(Dt){let Zt=Dt[0].x,ir=Zt,Kt=Dt[0].y,Sr=Kt;for(let er=1;er<Dt.length;er++)Dt[er].x<Zt?Zt=Dt[er].x:Dt[er].x>ir&&(ir=Dt[er].x),Dt[er].y<Kt?Kt=Dt[er].y:Dt[er].y>Sr&&(Sr=Dt[er].y);return[Zt,Kt,ir-Zt,Sr-Kt]}(l),$e=Dt=>[(Dt.x-oe)/be,(Dt.y-ye)/we],[He,rt,ot,_t]=l.map($e),Mt=function(Dt,Zt,ir,Kt,Sr,er,lr,Zr){let zr=wv(0,0,1,0,1,1,0,1),Or=wv(Dt,Zt,ir,Kt,Sr,er,lr,Zr),ar=r.bC.adjoint([],Or);return r.bC.multiply(zr,zr,ar)}(He[0],He[1],rt[0],rt[1],ot[0],ot[1],_t[0],_t[1]);this.elevatedGlobePerspectiveTransform=MA(He[0],He[1],rt[0],rt[1],ot[0],ot[1],_t[0],_t[1]);let At=(Dt,Zt)=>{A.push(Dt.lng);let ir=Math.round((Dt.lng-R)/z*it),Kt=Math.round((Dt.lat-N)/q*it),Sr=$e(Zt),er=r._.transformMat3([],[Sr[0],Sr[1],1],Mt),lr=Math.round(er[0]/er[2]*it),Zr=Math.round(er[1]/er[2]*it);Z.emplaceBack(ir,Kt,lr,Zr)},zt=l[3].x-l[0].x,Jt=l[3].y-l[0].y,Ot=l[2].x-l[1].x,Xt=l[2].y-l[1].y;for(let Dt=0;Dt<65;Dt++){let Zt=Dt/64,ir=[l[0].x+Zt*zt,l[0].y+Zt*Jt],Kt=[l[1].x+Zt*Ot,l[1].y+Zt*Xt],Sr=Kt[0]-ir[0],er=Kt[1]-ir[1];for(let lr=0;lr<65;lr++){let Zr=lr/64,zr={x:ir[0]+Sr*Zr,y:ir[1]+er*Zr,z:0};At(n.projection.unproject(zr.x,zr.y),zr)}}this.elevatedGlobeVertexBuffer=e.createVertexBuffer(Z,yv.members)}{this.maxLongitudeTriangleSize=0;let Z=[],oe=new No,ye=(be,we,$e)=>{oe.emplaceBack(be,we,$e);let He=A[be],rt=A[we],ot=A[$e],_t=Math.min(Math.min(He,rt),ot),Mt=Math.max(Math.max(He,rt),ot)-_t;Mt>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Mt),Z.push(_t+Mt/2)};for(let be=0;be<64;be++)for(let we=0;we<64;we++){let $e=65*be+we,He=$e+1,rt=$e+65,ot=rt+1;ye($e,rt,He),ye(He,rt,ot)}[Z,oe]=function(be,we){let $e=Array.from({length:be.length},(ot,_t)=>_t);$e.sort((ot,_t)=>be[ot]-be[_t]);let He=[],rt=new No;for(let ot=0;ot<$e.length;ot++){let _t=$e[ot];He.push(be[_t]);let Mt=3*_t,At=Mt+1;rt.emplaceBack(we.uint16[Mt],we.uint16[At],we.uint16[At+1])}return[He,rt]}(Z,oe),this.elevatedGlobeTrianglesCenterLongitudes=Z,this.elevatedGlobeIndexBuffer=e.createIndexBuffer(oe)}this.elevatedGlobeSegments=ha.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,z/it,0,q/it,0,0,N,R,0])}prepare(){let e=Object.keys(this.tiles).length!==0;if(this.tileID&&!e)return;let n=this.map.painter.context,l=n.gl;!this._dirty||this.texture instanceof _v||(this.texture?this.texture.update(this.image):(this.texture=new _u(n,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this._dirty=!1),e&&this._prepareData(n)}loadTile(e,n){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},n(null)):(e.state="errored",n(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(e){let n=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!n)return null;let l=this.elevatedGlobeTrianglesCenterLongitudes,h=(f=e+180)+360*Math.round((l[0]-f)/360);var f;let p=new ha,v=(M,R)=>{p.segments.push({vertexOffset:0,primitiveOffset:M,vertexLength:n.segments[0].vertexLength,primitiveLength:R,sortKey:void 0,vaos:{}})},y=.51*this.maxLongitudeTriangleSize;if(Math.abs(l[0]-h)<=y){let M=Mr(l,0,l.length,h+y);return M===l.length||v(M,sr(l,M+1,l.length,h+360-y)-M),p}h<l[0]&&(h+=360);let w=sr(l,0,l.length,h-y);if(w===l.length)return v(0,l.length),p;v(0,w-0);let A=Mr(l,w+1,l.length,h+y);return A!==l.length&&v(A,l.length-A),p}}let aL=(Math.pow(256,2)-1)/16907520;class RA extends bo{constructor(e,n,l,h){super(e,nL,n,l,h),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(e){return!(e&&e._source instanceof DA&&(e._source.onNorthPole||e._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(e){e!=="raster-color"&&e!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(e){if(!this.hasColorMap()||!this._curRampRange)return;let n=this._transitionablePaint._values["raster-color"].value.expression,[l,h]=e||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(l)&&isNaN(h)||l===this._curRampRange[0]&&h===this._curRampRange[1]||(this.colorRamp=Pg({expression:n,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:l,end:h}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[l,h])}}let oL=new un({visibility:new Ht(vt["layout_raster-particle"].visibility)});var sL={paint:new un({"raster-particle-array-band":new Ht(vt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Ht(vt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new ua(vt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Ht(vt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Ht(vt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Ht(vt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Ht(vt["paint_raster-particle"]["raster-particle-reset-rate-factor"])}),layout:oL};class FA extends bo{constructor(e,n,l,h){super(e,sL,n,l,h),this._updateColorRamp(),this.lastInvalidatedAt=di.now()}onRemove(e){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(e){return!1}_handleSpecialPaintPropertyUpdate(e){e!=="raster-particle-color"&&e!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),e==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;let e=this._transitionablePaint._values["raster-particle-color"].value.expression,n=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Pg({expression:e,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:n}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=di.now()}}class lL extends bo{constructor(e,n){super(e,{},n,null),this.implementation=e,e.slot&&(this.slot=e.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(e){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}let cL=new un({visibility:new Ht(vt.layout_sky.visibility)});var uL={paint:new un({"sky-type":new Ht(vt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Ht(vt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Ht(vt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Ht(vt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Ht(vt.paint_sky["sky-gradient-radius"]),"sky-gradient":new ua(vt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Ht(vt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Ht(vt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Ht(vt.paint_sky["sky-opacity"])}),layout:cL};function c2(t,e,n){let l=[0,0,1],h=r.av.identity([]);return r.av.rotateY(h,h,n?-Ai(t)+Math.PI:Ai(t)),r.av.rotateX(h,h,-Ai(e)),r._.transformQuat(l,l,h),r._.normalize(l,l)}var hL={paint:new un({})};function PA(t,e){let n=Sv(t.projection,t.zoom,t.width,t.height),l=function(f,p,v,y,w){let A=new en(v.lng-180*Qf,v.lat),M=new en(v.lng+180*Qf,v.lat),R=f.project(A.lng,A.lat),N=f.project(M.lng,M.lat),z=-Math.atan2(N.y-R.y,N.x-R.x),q=ks.fromLngLat(v);q.y=ui(q.y,-1+Qf,1-Qf);let Z=q.toLngLat(),oe=f.project(Z.lng,Z.lat),ye=ks.fromLngLat(Z);ye.x+=Qf;let be=ye.toLngLat(),we=f.project(be.lng,be.lat),$e=NA(we.x-oe.x,we.y-oe.y,z),He=ks.fromLngLat(Z);He.y+=Qf;let rt=He.toLngLat(),ot=f.project(rt.lng,rt.lat),_t=NA(ot.x-oe.x,ot.y-oe.y,z),Mt=Math.abs($e.x)/Math.abs(_t.y),At=r.ad.identity([]);r.ad.rotateZ(At,At,-z*(1-(w?0:y)));let zt=r.ad.identity([]);return r.ad.scale(zt,zt,[1,1-(1-Mt)*y,1]),zt[4]=-_t.x/_t.y*y,r.ad.rotateZ(zt,zt,z),r.ad.multiply(zt,At,zt),zt}(t.projection,0,t.center,n,e),h=LA(t);return r.ad.scale(l,l,[h,h,1]),l}function LA(t){let e=t.projection,n=Sv(t.projection,t.zoom,t.width,t.height),l=OA(e,t.center),h=OA(e,en.convert(e.center));return Math.pow(2,l*n+(1-n)*h)}function Sv(t,e,n,l,h=1/0){let f=t.range;if(!f)return 0;let p=Math.min(h,Math.max(n,l)),v=Math.log(p/1024)/Math.LN2;return Wl(f[0]+v,f[1]+v,e)}let Qf=1/4e4;function OA(t,e){let n=ui(e.lat,-$a,$a),l=new en(e.lng-180*Qf,n),h=new en(e.lng+180*Qf,n),f=t.project(l.lng,n),p=t.project(h.lng,n),v=ks.fromLngLat(l),y=ks.fromLngLat(h),w=p.x-f.x,A=p.y-f.y,M=y.x-v.x,R=y.y-v.y,N=Math.sqrt((M*M+R*R)/(w*w+A*A));return Math.log(N)/Math.LN2}function NA(t,e,n){let l=Math.cos(n),h=Math.sin(n);return{x:t*l-e*h,y:t*h+e*l}}function BA(t,e,n){r.ad.identity(t),r.ad.rotateZ(t,t,Ai(e[2])),r.ad.rotateX(t,t,Ai(e[0])),r.ad.rotateY(t,t,Ai(e[1])),r.ad.scale(t,t,n),r.ad.multiply(t,t,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Ev(t,e,n,l,h,f,p,v){let y=[n[0]-e[0],n[1]-e[1],0],w=[l[0]-e[0],l[1]-e[1],0];if(r._.length(y)<1e-12||r._.length(w)<1e-12)return r.av.identity(t);let A=r._.cross([],y,w);r._.normalize(A,A),r._.subtract(w,l,e),y[2]=(f-h)*v,w[2]=(p-h)*v;let M=y;return r._.cross(M,y,w),r._.normalize(M,M),r.av.rotationTo(t,A,M)}function u2(t,e,n=!1){let l=Hd(e.zoom),h=function(f,p,v){let y=p.worldSize,w=[f[12],f[13],f[14]],A=Zo(w[1]/y),M=Nl(w[0]/y),R=r.ad.identity([]),N=fl(1,A)*y,z=fl(1,0)*y*Zp(A,p.zoom),q=1/Ib(y),Z=z*q;if(v){let we=Sv(p.projection,p.zoom,p.width,p.height,1024);Z=q*p.projection.pixelSpaceConversion(p.center.lat,y,we)}let oe=$p(A,M);r._.add(oe,oe,r._.scale([],r._.normalize([],oe),N*Z*w[2]));let ye=function(we){let $e=[we[0],we[1],we[2]],He=[0,1,0],rt=r._.cross([],He,$e);return r._.cross(He,$e,rt),r._.squaredLength(He)===0&&(He=[0,1,0],r._.cross(rt,$e,He)),r._.normalize(rt,rt),r._.normalize(He,He),r._.normalize($e,$e),[rt[0],rt[1],rt[2],0,He[0],He[1],He[2],0,$e[0],$e[1],$e[2],0,we[0],we[1],we[2],1]}(oe);r.ad.scale(R,R,[Z,Z,Z*N]),r.ad.translate(R,R,[-w[0],-w[1],-w[2]]);let be=r.ad.multiply([],p.globeMatrix,ye);return r.ad.multiply(be,be,R),r.ad.multiply(be,be,f),be}(t,e,n);if(l>0){let f=function(p,v){let y=v.worldSize,w=fl(1,0)*y*Zp(v.center.lat,v.zoom)/Ib(y),A=fl(1,v.center.lat)*y,M=r.ad.identity([]);return r.ad.rotateY(M,M,Ai(v.center.lng)),r.ad.rotateX(M,M,Ai(v.center.lat)),r.ad.translate(M,M,[0,0,dl]),r.ad.scale(M,M,[w,w,w*A]),r.ad.translate(M,M,[v.point.x-.5*y,v.point.y-.5*y,0]),r.ad.multiply(M,M,p),r.ad.multiply(M,v.globeMatrix,M)}(t,e);return function(p,v,y){let w=(z,q,Z)=>{let oe=r._.length(z),ye=r._.length(q),be=Gd(z,q,Z);return r._.scale(be,be,1/r._.length(be)*Xr(oe,ye,Z))},A=w([p[0],p[1],p[2]],[v[0],v[1],v[2]],y),M=w([p[4],p[5],p[6]],[v[4],v[5],v[6]],y),R=w([p[8],p[9],p[10]],[v[8],v[9],v[10]],y),N=Gd([p[12],p[13],p[14]],[v[12],v[13],v[14]],y);return[A[0],A[1],A[2],0,M[0],M[1],M[2],0,R[0],R[1],R[2],0,N[0],N[1],N[2],1]}(h,f,l)}return h}function zA(t,e,n,l){let h=da.projectAabbCorners(l,n),f=Number.MAX_VALUE,p=-1;for(let w=0;w<h.length;++w){let A=h[w];A[0]=(.5*A[0]+.5)*e.width,A[1]=(.5-.5*A[1])*e.height,A[2]<f&&(p=w,f=A[2])}let v=w=>new hr(h[w][0],h[w][1]),y;switch(p){case 0:case 6:y=[v(1),v(5),v(4),v(7),v(3),v(2),v(1)];break;case 1:case 7:y=[v(0),v(4),v(5),v(6),v(2),v(3),v(0)];break;case 3:case 5:y=[v(1),v(0),v(4),v(7),v(6),v(2),v(1)];break;default:y=[v(1),v(5),v(6),v(7),v(3),v(0),v(1)]}if(vb(t,y))return f}let dL=hn([{name:"a_pos_3f",components:3,type:"Float32"}]),fL=hn([{name:"a_color_3f",components:3,type:"Float32"}]),pL=hn([{name:"a_color_4f",components:4,type:"Float32"}]),mL=hn([{name:"a_uv_2f",components:2,type:"Float32"}]),gL=hn([{name:"a_normal_3f",components:3,type:"Float32"}]),_L=hn([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),vL=hn([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class Av{constructor(e,n,l,h){this.message=(e?`${e}: `:"")+l,h&&(this.identifier=h),n!=null&&n.__line__&&(this.line=n.__line__)}}function jA(t,e){let n=t.indexOf("://")===-1;try{return new URL(t,n&&e?"http://example.com":void 0),!0}catch{return!1}}class UA{constructor(e,n){this.feature=e,this.instancedDataOffset=n,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class VA{constructor(){this.instancedDataArray=new tb,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class h2{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.fqid),this.projection=e.projection,this.index=e.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(e,n){}populate(e,n,l,h){this.tileToMeter=L1(l);let f=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(let{feature:p,id:v,index:y,sourceLayerIndex:w}of e){let A=v??(p.properties&&p.properties.hasOwnProperty("id")?p.properties.id:void 0),M=Vd(p,f);if(!this.layers[0]._featureFilter.filter(new ni(this.zoom),M,l))continue;let R={id:A,sourceLayerIndex:w,index:y,geometry:f?M.geometry:eh(p,l,h),properties:p.properties,type:p.type,patterns:{}},N=this.addFeature(R,R.geometry,M);N&&n.featureIndex.insert(p,R.geometry,y,w,this.index,this.instancesPerModel[N].instancedDataArray.length,it/32)}this.lookup=null}update(e,n,l,h){for(let f in this.instancesPerModel){let p=this.instancesPerModel[f];for(let v in e)p.idToFeaturesIndex.hasOwnProperty(v)&&(this.evaluate(p.features[p.idToFeaturesIndex[v]],e[v],p,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let e=!1;for(let n in this.instancesPerModel){let l=this.instancesPerModel[n];for(let h of l.features){let f=this.layers[0],p=h.feature,v=this.canonical,y=f.paint.get("model-rotation").evaluate(p,{},v),w=f.paint.get("model-scale").evaluate(p,{},v),A=f.paint.get("model-translation").evaluate(p,{},v);r._.exactEquals(h.rotation,y)&&r._.exactEquals(h.scale,w)&&r._.exactEquals(h.translation,A)||(this.evaluate(h,h.featureStates,l,!0),e=!0)}}return e}updateReplacement(e,n,l){if(n.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=n.updateTime;let h=n.getReplacementRegionsForTile(e.toUnwrapped(),!0);if(Bb(this.activeReplacements,h))return!1;this.activeReplacements=h;let f=!1;for(let p in this.instancesPerModel){let v=this.instancesPerModel[p],y=v.instancedDataArray;for(let w of v.features){let A=w.instancedDataOffset,M=w.instancedDataCount;for(let R=0;R<M;R++){let N=16*(R+A),z=y.float32[N+0];z=z>it?z-it:z;let q=Math.floor(z),Z=y.float32[N+1],oe=!1;for(let ye of this.activeReplacements)if(!(ye.order<l||ye.order===1/0)&&ye.clipMask&sE.Model&&!(ye.min.x>q||q>ye.max.x||ye.min.y>Z||Z>ye.max.y)&&(oe=QS(JS(q,Z,e.canonical,ye.footprintTileId.canonical),ye),oe))break;y.float32[N]=oe?z+it:z,f=f||oe}}}return f}isEmpty(){for(let e in this.instancesPerModel)if(this.instancesPerModel[e].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(e){if(!this.uploaded)for(let n in this.instancesPerModel){let l=this.instancesPerModel[n];l.instancedDataArray.length<0||l.instancedDataArray.length===0||(l.instancedDataBuffer?l.instancedDataBuffer.updateData(l.instancedDataArray):l.instancedDataBuffer=e.createVertexBuffer(l.instancedDataArray,_L.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(let n in this.instancesPerModel){let l=this.instancesPerModel[n];l.instancedDataArray.length!==0&&l.instancedDataBuffer&&l.instancedDataBuffer.destroy()}let e=this.layers[0].modelManager;if(e&&this.modelUris)for(let n of this.modelUris)e.removeModel(n,"")}addFeature(e,n,l){let h=this.layers[0],f=h.layout.get("model-id").evaluate(l,{},this.canonical);if(!f)return Wn(`modelId is not evaluated for layer ${h.id} and it is not going to get rendered.`),f;jA(f,!1)&&(this.modelUris.includes(f)||this.modelUris.push(f)),this.instancesPerModel[f]||(this.instancesPerModel[f]=new VA);let p=this.instancesPerModel[f],v=p.instancedDataArray,y=new UA(l,v.length);for(let w of n)for(let A of w){if(A.x<0||A.x>=it||A.y<0||A.y>=it)continue;let M=(this.lookupDim-1)/it,R=this.lookupDim*(A.y*M|0)+A.x*M|0;if(this.lookup){if(this.lookup[R]!==0)continue;this.lookup[R]=1}this.instanceCount++;let N=v.length;v.resize(N+1),p.instancesEvaluatedElevation.push(0),v.float32[16*N]=A.x,v.float32[16*N+1]=A.y}return y.instancedDataCount=p.instancedDataArray.length-y.instancedDataOffset,y.instancedDataCount>0&&(e.id&&(p.idToFeaturesIndex[e.id]=p.features.length),p.features.push(y),this.evaluate(y,{},p,!1)),f}getModelUris(){return this.modelUris}evaluate(e,n,l,h){let f=this.layers[0],p=e.feature,v=this.canonical,y=e.rotation=f.paint.get("model-rotation").evaluate(p,n,v),w=e.scale=f.paint.get("model-scale").evaluate(p,n,v),A=e.translation=f.paint.get("model-translation").evaluate(p,n,v),M=f.paint.get("model-color").evaluate(p,n,v);M.a=f.paint.get("model-color-mix-intensity").evaluate(p,n,v);let R=[];this.maxVerticalOffset<A[2]&&(this.maxVerticalOffset=A[2]),this.maxScale=Math.max(Math.max(this.maxScale,w[0]),Math.max(w[1],w[2])),BA(R,y,w);let N=Math.round(100*M.a)+M.b/1.05;for(let z=0;z<e.instancedDataCount;++z){let q=e.instancedDataOffset+z,Z=16*q,oe=l.instancedDataArray.float32,ye=0;h&&(ye=oe[Z+6]-l.instancesEvaluatedElevation[q]);let be=0|oe[Z+1];oe[Z]=(0|oe[Z])+M.r/1.05,oe[Z+1]=be+M.g/1.05,oe[Z+2]=N,oe[Z+3]=1/(v.z>10?this.tileToMeter:L1(v,be)),oe[Z+4]=A[0],oe[Z+5]=A[1],oe[Z+6]=A[2]+ye,oe[Z+7]=R[0],oe[Z+8]=R[1],oe[Z+9]=R[2],oe[Z+10]=R[4],oe[Z+11]=R[5],oe[Z+12]=R[6],oe[Z+13]=R[8],oe[Z+14]=R[9],oe[Z+15]=R[10],l.instancesEvaluatedElevation[q]=A[2]}}}Fe(h2,"ModelBucket",{omit:["layers"]}),Fe(VA,"PerModelAttributes"),Fe(UA,"ModelFeature");let yL=new un({visibility:new Ht(vt.layout_model.visibility),"model-id":new _r(vt.layout_model["model-id"])});var xL={paint:new un({"model-opacity":new Ht(vt.paint_model["model-opacity"]),"model-rotation":new _r(vt.paint_model["model-rotation"]),"model-scale":new _r(vt.paint_model["model-scale"]),"model-translation":new _r(vt.paint_model["model-translation"]),"model-color":new _r(vt.paint_model["model-color"]),"model-color-mix-intensity":new _r(vt.paint_model["model-color-mix-intensity"]),"model-type":new Ht(vt.paint_model["model-type"]),"model-cast-shadows":new Ht(vt.paint_model["model-cast-shadows"]),"model-receive-shadows":new Ht(vt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Ht(vt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new _r(vt.paint_model["model-emissive-strength"]),"model-roughness":new _r(vt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new _r(vt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Ht(vt.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Ht(vt.paint_model["model-front-cutoff"])}),layout:yL};let em=64,m0={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function GA(t,e,n,l,h,f,p,v,y,w=!1){let A=n.zoom,M=n.project(l),R=Zp(l.lat,A),N=1/R;r.ad.identity(t),r.ad.translate(t,t,[M.x+p[0]*N,M.y+p[1]*N,p[2]]);let z=1,q=1,Z=n.worldSize;if(w){if(n.projection.name==="mercator"){let we=0;n.elevation&&(we=n.elevation.getAtPointOrZero(new ks(M.x/Z,M.y/Z),0));let $e=r.aA.transformMat4([],[M.x,M.y,we,1],n.projMatrix)[3]/n.cameraToCenterDistance;z=$e,q=$e*Zp(n.center.lat,A)}else if(n.projection.name==="globe"){let we=u2(t,n),$e=r.ad.multiply([],n.projMatrix,we),He=[0,0,0,1];r.aA.transformMat4(He,He,$e);let rt=He[3]/n.cameraToCenterDistance,ot=Hd(A),_t=n.projection.pixelsPerMeter(l.lat,Z)*Zp(l.lat,A),Mt=n.projection.pixelsPerMeter(n.center.lat,Z)*Zp(n.center.lat,A);z=rt/Xr(_t,sS(n.center.lat),ot),q=rt*R/_t,z*=Mt,q*=Mt}}else z=N;r.ad.scale(t,t,[z,z,q]);let oe=[...t],ye=e.orientation,be=[];if(BA(be,[ye[0]+h[0],ye[1]+h[1],ye[2]+h[2]],f),r.ad.multiply(t,oe,be),v&&n.elevation){let we=0,$e=[];if(y&&n.elevation){we=function(ot,_t,Mt,At,zt){let Jt=_t.elevation;if(!Jt)return 0;let Ot=da.projectAabbCorners(Mt,At),Xt=fl(1,zt.lat)*_t.worldSize,Dt=function(Kr,vi){let ri=[0,0,1],Si=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(let yi of Si){let Pi=Kr[yi.corners[0]],ei=Kr[yi.corners[1]],Sn=Kr[yi.corners[2]],wn=[ei[0]-Pi[0],ei[1]-Pi[1],vi*(ei[2]-Pi[2])],tn=r._.cross(wn,wn,[Sn[0]-Pi[0],Sn[1]-Pi[1],vi*(Sn[2]-Pi[2])]);r._.normalize(tn,tn),yi.dotProductWithUp=r._.dot(tn,ri)}return Si.sort((yi,Pi)=>yi.dotProductWithUp-Pi.dotProductWithUp),Si[0].corners}(Ot,Xt),Zt=Ot[Dt[0]],ir=Ot[Dt[1]],Kt=Ot[Dt[2]],Sr=Ot[Dt[3]],er=Jt.getAtPointOrZero(new ks(Zt[0]/_t.worldSize,Zt[1]/_t.worldSize),0),lr=Jt.getAtPointOrZero(new ks(ir[0]/_t.worldSize,ir[1]/_t.worldSize),0),Zr=Jt.getAtPointOrZero(new ks(Kt[0]/_t.worldSize,Kt[1]/_t.worldSize),0),zr=Jt.getAtPointOrZero(new ks(Sr[0]/_t.worldSize,Sr[1]/_t.worldSize),0),Or=(er+zr)/2,ar=(lr+Zr)/2;return Or>ar?lr<Zr?Ev(ot,ir,Sr,Zt,lr,zr,er,Xt):Ev(ot,Kt,Zt,Sr,Zr,er,zr,Xt):er<zr?Ev(ot,Zt,ir,Kt,er,lr,Zr,Xt):Ev(ot,Sr,Kt,ir,zr,Zr,lr,Xt),Math.max(Or,ar)}($e,n,e.aabb,t,l);let He=r.ad.fromQuat([],$e),rt=r.ad.multiply([],He,be);r.ad.multiply(t,oe,rt)}else we=n.elevation.getAtPointOrZero(new ks(M.x/Z,M.y/Z),0);we!==0&&(t[14]+=we)}}function e_(t,e,n=!1){t.uploaded||(t.gfxTexture=new _u(e,t.image,n?e.gl.R8:e.gl.RGBA,{useMipmap:t.sampler.minFilter>=e.gl.NEAREST_MIPMAP_NEAREST}),t.uploaded=!0,t.image=null)}function bL(t,e,n){t.indexBuffer=e.createIndexBuffer(t.indexArray,!1,!0),t.vertexBuffer=e.createVertexBuffer(t.vertexArray,dL.members,!1,!0),t.normalArray&&(t.normalBuffer=e.createVertexBuffer(t.normalArray,gL.members,!1,!0)),t.texcoordArray&&(t.texcoordBuffer=e.createVertexBuffer(t.texcoordArray,mL.members,!1,!0)),t.colorArray&&(t.colorBuffer=e.createVertexBuffer(t.colorArray,(t.colorArray.bytesPerElement===12?fL:pL).members,!1,!0)),t.featureArray&&(t.pbrBuffer=e.createVertexBuffer(t.featureArray,vL.members,!0)),t.segments=ha.simpleSegment(0,0,t.vertexArray.length,t.indexArray.length);let l=t.material;l.pbrMetallicRoughness.baseColorTexture&&e_(l.pbrMetallicRoughness.baseColorTexture,e),l.pbrMetallicRoughness.metallicRoughnessTexture&&e_(l.pbrMetallicRoughness.metallicRoughnessTexture,e),l.normalTexture&&e_(l.normalTexture,e),l.occlusionTexture&&e_(l.occlusionTexture,e,n),l.emissionTexture&&e_(l.emissionTexture,e)}function d2(t,e,n){if(t.meshes)for(let l of t.meshes)bL(l,e,n);if(t.children)for(let l of t.children)d2(l,e,n)}function Cv(t){if(t.meshes)for(let e of t.meshes)e.indexArray.destroy(),e.vertexArray.destroy(),e.colorArray&&e.colorArray.destroy(),e.normalArray&&e.normalArray.destroy(),e.texcoordArray&&e.texcoordArray.destroy(),e.featureArray&&e.featureArray.destroy();if(t.children)for(let e of t.children)Cv(e)}function f2(t){if(t.meshes)for(let n of t.meshes)n.vertexBuffer&&(n.vertexBuffer.destroy(),n.indexBuffer.destroy(),n.normalBuffer&&n.normalBuffer.destroy(),n.texcoordBuffer&&n.texcoordBuffer.destroy(),n.colorBuffer&&n.colorBuffer.destroy(),n.pbrBuffer&&n.pbrBuffer.destroy(),n.segments.destroy(),n.material&&((e=n.material).pbrMetallicRoughness.baseColorTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),e.pbrMetallicRoughness.metallicRoughnessTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),e.normalTexture&&e.normalTexture.gfxTexture&&e.normalTexture.gfxTexture.destroy(),e.emissionTexture&&e.emissionTexture.gfxTexture&&e.emissionTexture.gfxTexture.destroy(),e.occlusionTexture&&e.occlusionTexture.gfxTexture&&e.occlusionTexture.gfxTexture.destroy()));var e;if(t.children)for(let n of t.children)f2(n)}class wL{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class TL{constructor(){this.tasks={},this.taskQueue=[],Ih(["process"],this),this.invoker=new wL(this.process),this.nextId=0}add(e,n){let l=this.nextId++,h=function({type:f,isSymbolTile:p,zoom:v}){return v=v||0,f==="message"?0:f!=="maybePrepare"||p?f!=="parseTile"||p?f==="parseTile"&&p?300-v:f==="maybePrepare"&&p?400-v:500:200-v:100-v}(n);if(h===0){try{e()}finally{}return null}return this.tasks[l]={fn:e,metadata:n,priority:h,id:l},this.taskQueue.push(l),this.invoker.trigger(),{cancel:()=>{delete this.tasks[l]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(l=>!!this.tasks[l]),!this.taskQueue.length)return;let e=this.pick();if(e===null)return;let n=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!n)return;n.fn()}finally{}}pick(){let e=null,n=1/0;for(let h=0;h<this.taskQueue.length;h++){let f=this.tasks[this.taskQueue[h]];f.priority<n&&(n=f.priority,e=h)}if(e===null)return null;let l=this.taskQueue[e];return this.taskQueue.splice(e,1),l}remove(){this.invoker.remove()}}class HA{constructor(e,n,l){this.target=e,this.parent=n,this.mapId=l,this.callbacks={},this.cancelCallbacks={},Ih(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new TL}send(e,n,l,h,f=!1,p){let v=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(l.metadata=p,this.callbacks[v]=l);let y=new Set;return this.target.postMessage({id:v,type:e,hasCallback:!!l,targetMapId:h,mustQueue:f,sourceMapId:this.mapId,data:at(n,y)},y),{cancel:()=>{l&&delete this.callbacks[v],this.target.postMessage({id:v,type:"<cancel>",targetMapId:h,sourceMapId:this.mapId})}}}receive(e){let n=e.data,l=n.id;if(l&&(!n.targetMapId||this.mapId===n.targetMapId))if(n.type==="<cancel>"){let h=this.cancelCallbacks[l];delete this.cancelCallbacks[l],h&&h.cancel()}else if(n.mustQueue||uo()){let h=this.callbacks[l],f=this.scheduler.add(()=>this.processTask(l,n),h&&h.metadata||{type:"message"});f&&(this.cancelCallbacks[l]=f)}else this.processTask(l,n)}processTask(e,n){if(delete this.cancelCallbacks[e],n.type==="<response>"){let l=this.callbacks[e];delete this.callbacks[e],l&&(n.error?l(xt(n.error)):l(null,xt(n.data)))}else{let l=new Set,h=n.hasCallback?(p,v)=>{this.target.postMessage({id:e,type:"<response>",sourceMapId:this.mapId,error:p?at(p):null,data:at(v,l)},l)}:p=>{},f=xt(n.data);if(this.parent[n.type])this.parent[n.type](n.sourceMapId,f,h);else if(this.parent.getWorkerSource){let p=n.type.split(".");this.parent.getWorkerSource(n.sourceMapId,p[0],f.source,f.scope)[p[1]](f,h)}else h(new Error(`Could not find function ${n.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}let p2=(()=>{class t{constructor(n,l){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=El();let h=this.workerPool.acquire(this.id);for(let f=0;f<h.length;f++){let p=new t.Actor(h[f],l,this.id);p.name=`Worker ${f}`,this.actors.push(p)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(n,l,h){bc(this.actors,(f,p)=>{f.send(n,l,p)},h=h||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}return t.Actor=HA,t})();var t_={workerUrl:"",workerClass:null,workerParams:void 0};function SL(){return t_.workerClass!=null?new t_.workerClass:new self.Worker(t_.workerUrl,t_.workerParams)}let m2="mapboxgl_preloaded_worker_pool";class r_{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<r_.workerCount;)this.workers.push(new SL);return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.workers&&this.numActive()===0&&(this.workers.forEach(n=>{n.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[m2]}numActive(){return Object.keys(this.active).length}}let i_;function Iv(){return i_||(i_=new r_),i_}r_.workerCount=2;let kv,g2,sh,g0,_2,_0=null;function WA(){return uo()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:g2||E.DRACO_URL}function qA(){if(uo()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(g0)return g0;let t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return g0=WebAssembly.validate(t)?E.MESHOPT_SIMD_URL:E.MESHOPT_URL,g0}let Mv={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},EL={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},n_={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function $A(t,e,n){let l=n.json.bufferViews.length,h=n.buffers.length;e.bufferView=l,n.json.bufferViews[l]={buffer:h,byteLength:t.byteLength},n.buffers[h]=t}let v2="KHR_draco_mesh_compression";function AL(t,e){let n=t.extensions&&t.extensions[v2];if(!n)return;let l=new sh.Decoder,h=KA(e,n.bufferView),f=new sh.Mesh;if(!l.DecodeArrayToMesh(h,h.byteLength,f))throw new Error("Failed to decode Draco mesh");let p=e.json.accessors[t.indices],v=Mv[p.componentType],y=p.count*v.BYTES_PER_ELEMENT,w=sh._malloc(y);v===Uint16Array?l.GetTrianglesUInt16Array(f,y,w):l.GetTrianglesUInt32Array(f,y,w),$A(sh.memory.buffer.slice(w,w+y),p,e),sh._free(w);for(let A of Object.keys(n.attributes)){let M=l.GetAttributeByUniqueId(f,n.attributes[A]),R=e.json.accessors[t.attributes[A]],N=EL[R.componentType],z=R.count*n_[R.type]*Mv[R.componentType].BYTES_PER_ELEMENT,q=sh._malloc(z);l.GetAttributeDataArrayForAllPoints(f,M,sh[N],z,q),$A(sh.memory.buffer.slice(q,q+z),R,e),sh._free(q)}l.destroy(),f.destroy(),delete t.extensions[v2]}let Dv="EXT_meshopt_compression";function CL(t,e){if(!t.extensions||!t.extensions[Dv])return;let n=t.extensions[Dv],l=new Uint8Array(e.buffers[n.buffer],n.byteOffset||0,n.byteLength||0),h=new Uint8Array(n.count*n.byteStride);_2.decodeGltfBuffer(h,n.count,n.byteStride,l,n.mode,n.filter),t.buffer=e.buffers.length,t.byteOffset=0,e.buffers[t.buffer]=h.buffer,delete t.extensions[Dv]}let XA=1179937895,ZA=new TextDecoder("utf8");function YA(t,e){return new URL(t,e).href}function IL(t,e,n,l){return fetch(YA(t.uri,l)).then(h=>h.arrayBuffer()).then(h=>{e.buffers[n]=h})}function KA(t,e){let n=t.json.bufferViews[e];return new Uint8Array(t.buffers[n.buffer],n.byteOffset||0,n.byteLength)}function kL(t,e,n,l){if(t.uri){let h=YA(t.uri,l);return fetch(h).then(f=>f.blob()).then(f=>createImageBitmap(f)).then(f=>{e.images[n]=f})}if(t.bufferView!==void 0){let h=KA(e,t.bufferView),f=new Blob([h],{type:t.mimeType});return createImageBitmap(f).then(p=>{e.images[n]=p})}}function JA(t,e=0,n){let l={json:null,images:[],buffers:[]};if(new Uint32Array(t,e,1)[0]===XA){let A=new Uint32Array(t,e),M=2,R=(A[M++]>>2)-3,N=A[M++]>>2;if(M++,l.json=JSON.parse(ZA.decode(A.subarray(M,M+N))),M+=N,M<R){let z=A[M++];M++;let q=e+(M<<2);l.buffers[0]=t.slice(q,q+z)}}else l.json=JSON.parse(ZA.decode(new Uint8Array(t,e)));let{buffers:h,images:f,meshes:p,extensionsUsed:v,bufferViews:y}=l.json,w=Promise.resolve();if(h){let A=[];for(let M=0;M<h.length;M++){let R=h[M];R.uri?A.push(IL(R,l,M,n)):l.buffers[M]||(l.buffers[M]=null)}w=Promise.all(A)}return w.then(()=>{let A=[],M=v&&v.includes(v2),R=v&&v.includes(Dv);if(M&&A.push(function(){if(!sh)return kv||(kv=function(N){let z,q=null;function Z(){z=new Uint8Array(q.buffer)}function oe(){throw new Error("Unexpected Draco error.")}let ye={a:{a:oe,d:function(be,we,$e){return z.copyWithin(be,we,we+$e)},c:function(be){let we=z.length,$e=Math.max(be>>>0,Math.ceil(1.2*we)),He=Math.ceil(($e-we)/65536);try{return q.grow(He),Z(),!0}catch{return!1}},b:oe}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(N,ye):N.then(be=>be.arrayBuffer()).then(be=>WebAssembly.instantiate(be,ye))).then(be=>{let{Rb:we,Qb:$e,P:He,T:rt,X:ot,Ja:_t,La:Mt,Qa:At,Va:zt,Wa:Jt,eb:Ot,jb:Xt,f:Dt,e:Zt,yb:ir,zb:Kt,Ab:Sr,Bb:er,Db:lr,Gb:Zr}=be.instance.exports;q=Zt;let zr=(()=>{let Or=0,ar=0,Kr=0,vi=0;return ri=>{Kr&&(we(vi),we(Or),ar+=Kr,Kr=Or=0),Or||(ar+=128,Or=$e(ar));let Si=ri.length+7&-8,yi=Or;Si>=ar&&(Kr=Si,yi=vi=$e(Si));for(let Pi=0;Pi<ri.length;Pi++)z[yi+Pi]=ri[Pi];return yi}})();return Z(),Dt(),{memory:Zt,_free:we,_malloc:$e,Mesh:class{constructor(){this.ptr=He()}destroy(){rt(this.ptr)}},Decoder:class{constructor(){this.ptr=_t()}destroy(){Xt(this.ptr)}DecodeArrayToMesh(Or,ar,Kr){let vi=zr(Or),ri=Mt(this.ptr,vi,ar,Kr.ptr);return!!ot(ri)}GetAttributeByUniqueId(Or,ar){return{ptr:At(this.ptr,Or.ptr,ar)}}GetTrianglesUInt16Array(Or,ar,Kr){zt(this.ptr,Or.ptr,ar,Kr)}GetTrianglesUInt32Array(Or,ar,Kr){Jt(this.ptr,Or.ptr,ar,Kr)}GetAttributeDataArrayForAllPoints(Or,ar,Kr,vi,ri){Ot(this.ptr,Or.ptr,ar.ptr,Kr,vi,ri)}},DT_INT8:ir(),DT_UINT8:Kt(),DT_INT16:Sr(),DT_UINT16:er(),DT_UINT32:lr(),DT_FLOAT32:Zr()}})}(fetch(WA())),kv.then(N=>{sh=N,kv=void 0}))}()),R&&A.push(function(){if(_2)return;let N=function(z){let q,Z=WebAssembly.instantiateStreaming(z,{}).then(be=>{q=be.instance,q.exports.__wasm_call_ctors()}),oe={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},ye={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:Z,supported:!0,decodeGltfBuffer(be,we,$e,He,rt,ot){(function(_t,Mt,At,zt,Jt,Ot,Xt){let Dt=_t.exports.sbrk,Zt=zt+3&-4,ir=Dt(Zt*Jt),Kt=Dt(Ot.length),Sr=new Uint8Array(_t.exports.memory.buffer);Sr.set(Ot,Kt);let er=Mt(ir,zt,Jt,Kt,Ot.length);if(er===0&&Xt&&Xt(ir,Zt,Jt),At.set(Sr.subarray(ir,ir+zt*Jt)),Dt(ir-Dt(0)),er!==0)throw new Error(`Malformed buffer data: ${er}`)})(q,q.exports[ye[rt]],be,we,$e,He,q.exports[oe[ot]])}}}(fetch(qA()));return N.ready.then(()=>{_2=N})}()),f)for(let N=0;N<f.length;N++)A.push(kL(f[N],l,N,n));return(A.length?Promise.all(A):Promise.resolve()).then(()=>{if(M&&p)for(let{primitives:N}of p)for(let z of N)AL(z,l);if(R&&p&&y)for(let N of y)CL(N,l);return l})})}function tm(t,e){let n=t.json.bufferViews[e.bufferView],l=Mv[e.componentType];return new l(t.buffers[n.buffer],(e.byteOffset||0)+(n.byteOffset||0),e.count*(n.byteStride&&n.byteStride!==n_[e.type]*l.BYTES_PER_ELEMENT?n.byteStride/l.BYTES_PER_ELEMENT:n_[e.type]))}function y2(t,e,n,l){let h=Mv[e.componentType],f=function(A){switch(A){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(h),p=t.json.bufferViews[e.bufferView],v=p.byteStride?p.byteStride/h.BYTES_PER_ELEMENT:n_[e.type],y=n.float32,w=y.length/n.capacity;for(let A=0,M=0;A<e.count*v;A+=v,M+=w)for(let R=0;R<w;R++)y[M+R]=l[A+R]*f;n._trim()}function ML(t,e,n){let l=t.indices,h=t.attributes,f={};f.indexArray=new No;let p=e.json.accessors[l],v=p.count/3;f.indexArray.reserve(v);let y=tm(e,p);for(let R=0;R<v;R++)f.indexArray.emplaceBack(y[3*R],y[3*R+1],y[3*R+2]);f.indexArray._trim(),f.vertexArray=new Nf;let w=e.json.accessors[h.POSITION];f.vertexArray.reserve(w.count);let A=tm(e,w);for(let R=0;R<w.count;R++)f.vertexArray.emplaceBack(A[3*R],A[3*R+1],A[3*R+2]);if(f.vertexArray._trim(),f.aabb=new da(w.min,w.max),f.centroid=function(R,N){let z=[0,0,0],q=R.length;if(q>0){for(let Z=0;Z<q;Z++){let oe=3*R[Z];z[0]+=N[oe],z[1]+=N[oe+1],z[2]+=N[oe+2]}z[0]/=q,z[1]/=q,z[2]/=q}return z}(y,A),h.COLOR_0!==void 0){let R=e.json.accessors[h.COLOR_0],N=n_[R.type],z=tm(e,R);f.colorArray=N===3?new Nf:new Of,f.colorArray.resize(R.count),y2(e,R,f.colorArray,z)}if(h.NORMAL!==void 0){f.normalArray=new Nf;let R=e.json.accessors[h.NORMAL];f.normalArray.resize(R.count);let N=tm(e,R);y2(e,R,f.normalArray,N)}if(h.TEXCOORD_0!==void 0&&n.length>0){f.texcoordArray=new $m;let R=e.json.accessors[h.TEXCOORD_0];f.texcoordArray.resize(R.count);let N=tm(e,R);y2(e,R,f.texcoordArray,N)}if(h._FEATURE_ID_RGBA4444!==void 0){let R=e.json.accessors[h._FEATURE_ID_RGBA4444];e.json.extensionsUsed&&e.json.extensionsUsed.includes("EXT_meshopt_compression")&&(f.featureData=tm(e,R))}h._FEATURE_RGBA4444!==void 0&&(f.featureData=new Uint32Array(tm(e,e.json.accessors[h._FEATURE_RGBA4444]).buffer));let M=t.material;return f.material=function(R,N){let{emissiveFactor:z=[0,0,0],alphaMode:q="OPAQUE",alphaCutoff:Z=.5,normalTexture:oe,occlusionTexture:ye,emissiveTexture:be,doubleSided:we}=R,{baseColorFactor:$e=[1,1,1,1],metallicFactor:He=1,roughnessFactor:rt=1,baseColorTexture:ot,metallicRoughnessTexture:_t}=R.pbrMetallicRoughness||{},Mt=ye?N[ye.index]:void 0;if(ye&&ye.extensions&&ye.extensions.KHR_texture_transform&&Mt){let At=ye.extensions.KHR_texture_transform;Mt.offsetScale=[At.offset[0],At.offset[1],At.scale[0],At.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new qi(...$e),metallicFactor:He,roughnessFactor:rt,baseColorTexture:ot?N[ot.index]:void 0,metallicRoughnessTexture:_t?N[_t.index]:void 0},doubleSided:we,emissiveFactor:z,alphaMode:q,alphaCutoff:Z,normalTexture:oe?N[oe.index]:void 0,occlusionTexture:Mt,emissionTexture:be?N[be.index]:void 0,defined:R.defined===void 0}}(M!==void 0?e.json.materials[M]:{defined:!1},n),f}function QA(t,e,n){let{matrix:l,rotation:h,translation:f,scale:p,mesh:v,extras:y,children:w}=t,A={};if(A.matrix=l||r.ad.fromRotationTranslationScale([],h||[0,0,0,1],f||[0,0,0],p||[1,1,1]),v!==void 0){A.meshes=n[v];let M=A.anchor=[0,0];for(let R of A.meshes){let{min:N,max:z}=R.aabb;M[0]+=N[0]+z[0],M[1]+=N[1]+z[1]}M[0]=Math.floor(M[0]/A.meshes.length/2),M[1]=Math.floor(M[1]/A.meshes.length/2)}if(y&&(y.id&&(A.id=y.id),y.lights&&(A.lights=function(M){if(!M.length)return[];let R=function(oe){let ye=atob(oe),be=new Uint8Array(ye.length);for(let we=0;we<ye.length;we++)be[we]=ye.codePointAt(we);return be}(M),N=[],z=R.length/24,q=new Uint16Array(R.buffer),Z=new Float32Array(R.buffer);for(let oe=0;oe<z;oe++){let ye=q[2*oe*6]/30,be=q[2*oe*6+1]/30,we=q[2*oe*6+10]/100,$e=Z[6*oe+1],He=Z[6*oe+2],rt=Z[6*oe+3],ot=Z[6*oe+4],_t=rt-$e,Mt=ot-He,At=Math.hypot(_t,Mt);N.push({pos:[$e+.5*_t,He+.5*Mt,be],normal:[Mt/At,-_t/At,0],width:At,height:ye,depth:we,points:[$e,He,rt,ot]})}return N}(y.lights))),w){let M=[];for(let R of w)M.push(QA(e.json.nodes[R],e,n));A.children=M}return A}function DL(t){if(t.vertices.length===0||t.indices.length===0)return null;let e=new Lb(t.vertices,t.indices,8,256),[n,l]=[e.min.clone(),e.max.clone()];return{vertices:t.vertices,indices:t.indices,grid:e,min:n,max:l}}function RL(t){if(!t.extras||!t.extras.ground)return null;let e=t.extras.ground;if(!e||!Array.isArray(e)||e.length===0)return null;let n=e[0];if(!n||!Array.isArray(n)||n.length===0)return null;let l=[];for(let p of n){if(!Array.isArray(p)||p.length!==2)continue;let v=p[0],y=p[1];typeof v=="number"&&typeof y=="number"&&l.push(new hr(v,y))}if(l.length<3)return null;l.length>1&&l[l.length-1].equals(l[0])&&l.pop();let h=0;for(let p=0;p<l.length;p++){let v=l[p],y=l[(p+1)%l.length],w=l[(p+2)%l.length];h+=(v.x-y.x)*(w.y-y.y)-(w.x-y.x)*(v.y-y.y)}h>0&&l.reverse();let f=Lg(l.flatMap(p=>[p.x,p.y]),[]);return f.length===0?null:{vertices:l,indices:f}}function FL(t,e){let n=[],l=[],h=0,f=[];for(let p of t){h=n.length;let v=p.vertexArray.float32,y=p.indexArray.uint16;for(let w=0;w<p.vertexArray.length;w++)f[0]=v[3*w+0],f[1]=v[3*w+1],f[2]=v[3*w+2],r._.transformMat4(f,f,e),n.push(new hr(f[0],f[1]));for(let w=0;w<3*p.indexArray.length;w++)l.push(y[w]+h)}if(l.length%3!=0)return null;for(let p=0;p<l.length;p+=3){let v=n[l[p+0]],y=n[l[p+1]],w=n[l[p+2]];(v.x-y.x)*(w.y-y.y)-(w.x-y.x)*(v.y-y.y)>0&&([l[p+1],l[p+2]]=[l[p+2],l[p+1]])}return{vertices:n,indices:l}}function eC(t){let e=function(y,w){let A=[],M=WebGL2RenderingContext;if(y.json.textures)for(let R of y.json.textures){let N={magFilter:M.LINEAR,minFilter:M.NEAREST,wrapS:M.REPEAT,wrapT:M.REPEAT};R.sampler!==void 0&&Object.assign(N,y.json.samplers[R.sampler]),A.push({image:w[R.source],sampler:N,uploaded:!1})}return A}(t,t.images),n=function(y,w){let A=[];for(let M of y.json.meshes){let R=[];for(let N of M.primitives)R.push(ML(N,y,w));A.push(R)}return A}(t,e),{scenes:l,scene:h,nodes:f}=t.json,p=l?l[h||0].nodes:f,v=[];for(let y of p)v.push(QA(f[y],t,n));return function(y,w,A){let M={},R=new Set;for(let N=0;N<y.length;N++){let z=A[w[N]];if(!z.extras)continue;let q=z.extras["mapbox:footprint:version"],Z=z.extras["mapbox:footprint:id"];(q||Z)&&R.add(N),q==="1.0.0"&&Z&&(M[Z]=N)}for(let N=0;N<y.length;N++){if(R.has(N))continue;let z=y[N],q=A[w[N]];if(!q.extras)continue;let Z=null;z.id in M&&(Z=FL(y[M[z.id]].meshes,z.matrix)),Z||(Z=RL(q)),Z&&(z.footprint=DL(Z))}if(R.size>0){let N=Array.from(R.values()).sort((z,q)=>z-q);for(let z=N.length-1;z>=0;z--)y.splice(N[z],1)}}(v,p,t.json.nodes),v}function PL(t){t.heightmap=new Float32Array(4096),t.heightmap.fill(-1);let e=t.vertexArray.float32,n=t.aabb.min[0]-1,l=t.aabb.min[1]-1,h=em/(t.aabb.max[0]-n+2),f=em/(t.aabb.max[1]-l+2);for(let p=0;p<e.length;p+=3){let v=e[p+2],y=(e[p+0]-n)*h|0,w=(e[p+1]-l)*f|0;v>t.heightmap[w*em+y]&&(t.heightmap[w*em+y]=v)}}function LL(t,e){let n={};n.indexArray=new No,n.indexArray.reserve(4*t.length),n.vertexArray=new Nf,n.vertexArray.reserve(10*t.length),n.colorArray=new Of,n.vertexArray.reserve(10*t.length);let l=0;for(let p of t){let v=Math.min(10,Math.max(4,1.3*p.height))*e,y=[-p.normal[1],p.normal[0],0],w=Math.min(.29,.1*p.width/p.depth),A=p.width-2*p.depth*e*(w+.01),M=r._.scaleAndAdd([],p.pos,y,A/2),R=r._.scaleAndAdd([],p.pos,y,-A/2),N=[M[0],M[1],M[2]+p.height],z=[R[0],R[1],R[2]+p.height],q=r._.scaleAndAdd([],p.normal,y,w);r._.scale(q,q,v);let Z=r._.scaleAndAdd([],p.normal,y,-w);r._.scale(Z,Z,v),r._.add(q,M,q),r._.add(Z,R,Z),M[2]+=.1,R[2]+=.1,n.vertexArray.emplaceBack(q[0],q[1],q[2]),n.vertexArray.emplaceBack(Z[0],Z[1],Z[2]),n.vertexArray.emplaceBack(M[0],M[1],M[2]),n.vertexArray.emplaceBack(R[0],R[1],R[2]),n.vertexArray.emplaceBack(N[0],N[1],N[2]),n.vertexArray.emplaceBack(z[0],z[1],z[2]),n.vertexArray.emplaceBack(M[0],M[1],M[2]),n.vertexArray.emplaceBack(R[0],R[1],R[2]),n.vertexArray.emplaceBack(q[0],q[1],q[2]),n.vertexArray.emplaceBack(Z[0],Z[1],Z[2]);let oe=A/v/2;n.colorArray.emplaceBack(-oe-w,-1,oe,.8),n.colorArray.emplaceBack(oe+w,-1,oe,.8),n.colorArray.emplaceBack(-oe,0,oe,1.3),n.colorArray.emplaceBack(oe,0,oe,1.3),n.colorArray.emplaceBack(oe+w,-.8,oe,.7),n.colorArray.emplaceBack(oe+w,-.8,oe,.7),n.colorArray.emplaceBack(0,0,oe,1.3),n.colorArray.emplaceBack(0,0,oe,1.3),n.colorArray.emplaceBack(oe+w,-1.2,oe,.8),n.colorArray.emplaceBack(oe+w,-1.2,oe,.8),n.indexArray.emplaceBack(6+l,4+l,8+l),n.indexArray.emplaceBack(7+l,9+l,5+l),n.indexArray.emplaceBack(0+l,1+l,2+l),n.indexArray.emplaceBack(1+l,3+l,2+l),l+=10}let h={defined:!0,emissiveFactor:[0,0,0]},f={};return f.baseColorFactor=qi.white,h.pbrMetallicRoughness=f,n.material=h,n.aabb=new da([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),n}let x2=new Float32Array(262144),rm=new Uint8Array(262144);function tC(t){let e=0;if(t.meshes)for(let n of t.meshes)e=Math.max(e,n.aabb.max[2]);if(t.children)for(let n of t.children)e=Math.max(e,tC(n));return e}function rC(t,e,n){if(t.meshes)for(let l of t.meshes)l.aabb.min[0]!==1/0&&n.insert(e,l.aabb.min[0],l.aabb.min[1],l.aabb.max[0],l.aabb.max[1]);if(t.children)for(let l of t.children)rC(l,e,n)}let iC=["","wall","door","roof","window","lamp","logo"];class nC{constructor(e){this.node=e,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:e.id,geometry:[],properties:{height:tC(e)}},this.aabb=this._getLocalBounds()}_getLocalBounds(){if(!this.node.meshes)return new da([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let e=0,n=new da([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(let l of this.node.meshes)this.node.lightMeshIndex!==e&&(l.transformedAabb=da.applyTransform(l.aabb,this.node.matrix),n.encapsulate(l.transformedAabb)),e++;this.aabb=n}return this.aabb}}class Rv{constructor(e,n,l,h,f,p){this.id=n,this.modelTraits|=m0.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,l&&(this.modelTraits|=m0.HasMapboxMeshFeatures),h&&(this.modelTraits|=m0.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=f,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(let v of e)this.nodesInfo.push(new nC(v)),rC(v,p.featureIndexArray.length,p.grid),p.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,p.bucketLayerIDs.length-1,0)}updateFootprints(e,n){for(let l of this.getNodesInfo()){let h=l.node;h.footprint&&n.push({footprint:h.footprint,id:e})}}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(e){if(!this.needsUpload)return;let n=this.getNodesInfo();for(let l of n){let h=l.node;this.uploaded?this.updatePbrBuffer(h):d2(h,e,!0)}for(let l of n)Cv(l.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(e){let n=!1;if(!e.meshes)return n;for(let l of e.meshes)l.pbrBuffer&&(l.pbrBuffer.updateData(l.featureArray),n=!0);return n}needsReEvaluation(e,n,l){let h=e.transform.projectionOptions,f=e.style.getBrightness(),p=this.brightness!==f;return!!(!this.uploaded||this.dirty||h.name!==this.projection.name||a_(l.paint.get("model-color").value,p)||a_(l.paint.get("model-color-mix-intensity").value,p)||a_(l.paint.get("model-roughness").value,p)||a_(l.paint.get("model-emissive-strength").value,p)||a_(l.paint.get("model-height-based-emissive-strength-multiplier").value,p))&&(this.projection=h,this.brightness=f,!0)}evaluateScale(e,n){if(e.transform.zoom===this.zoom)return;this.zoom=e.transform.zoom;let l=this.getNodesInfo(),h=this.id.canonical;for(let f of l){let p=f.feature;f.evaluatedScale=n.paint.get("model-scale").evaluate(p,{},h)}}evaluate(e){let n=this.getNodesInfo();for(let l of n){if(!l.node.meshes)continue;let h=l.feature,f=l.node.meshes&&l.node.meshes[0].featureData,p=l.evaluatedColor[2],v=l.evaluatedRMEA[2],y=this.id.canonical;if(l.hasTranslucentParts=!1,f){for(let w=0;w<iC.length;w++){let A=iC[w];A.length&&(h.properties.part=A);let M=e.paint.get("model-color").evaluate(h,{},y).toRenderColor(null),R=e.paint.get("model-color-mix-intensity").evaluate(h,{},y);l.evaluatedColor[w]=[M.r,M.g,M.b,R],l.evaluatedRMEA[w][0]=e.paint.get("model-roughness").evaluate(h,{},y),l.evaluatedRMEA[w][2]=e.paint.get("model-emissive-strength").evaluate(h,{},y),l.evaluatedRMEA[w][3]=M.a,l.emissionHeightBasedParams[w]=e.paint.get("model-height-based-emissive-strength-multiplier").evaluate(h,{},y),!l.hasTranslucentParts&&M.a<1&&(l.hasTranslucentParts=!0)}delete h.properties.part,NL(l,p!==l.evaluatedColor[2]||v!==l.evaluatedRMEA[2],this.modelTraits)}else l.evaluatedRMEA[0][2]=e.paint.get("model-emissive-strength").evaluate(h,{},y);l.evaluatedScale=e.paint.get("model-scale").evaluate(h,{},y),this.updatePbrBuffer(l.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(e,n,l,h){let f=e.findDEMTileFor(l);if(f&&(f.tileID.canonical!==this.terrainTile||n!==this.terrainExaggeration)){if(f.dem&&f.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=f.tileID.overscaledZ;let p=r0.create(e,l,f);if(!p)return;this.modelTraits&m0.HasMapboxMeshFeatures&&this.updateDEM(e,p,l,h);for(let v of this.getNodesInfo()){let y=v.node;if(!y.footprint||!y.footprint.vertices||!y.footprint.vertices.length)continue;let w=y.footprint.vertices,A=p.getElevationAt(w[0].x,w[0].y,!0,!0);for(let M=1;M<w.length;M++)A=Math.min(A,p.getElevationAt(w[M].x,w[M].y,!0,!0));y.elevation=A}}this.terrainTile=f.tileID.canonical,this.terrainExaggeration=n}}updateDEM(e,n,l,h){let f=n._dem._modifiedForSources[h];if(f===void 0&&(n._dem._modifiedForSources[h]=[],f=n._dem._modifiedForSources[h]),f.includes(l.canonical))return;let p=n._dem.dim;f.push(l.canonical);let v=!1;for(let y of this.getNodesInfo()){let w=y.node;if(!w.footprint||!w.footprint.grid)continue;let A=w.footprint.grid,M=n.tileCoordToPixel(A.min.x,A.min.y),R=n.tileCoordToPixel(A.max.x,A.max.y),N=Math.min(Math.min(p-R.y,M.x),Math.min(M.y,p-R.x));if(N<0)continue;let z=ui(N,2,5),q=Math.max(0,M.x-z),Z=Math.max(0,M.y-z),oe=Math.min(R.x+z,p-1),ye=Math.min(R.y+z,p-1);for(let He=Z;He<=ye;++He)for(let rt=q;rt<=oe;++rt)rm[He*p+rt]=255;let be=0,we=0;for(let He=0;He<A.cellsY;++He)for(let rt=0;rt<A.cellsX;++rt){if(!A.cells[He*A.cellsX+rt])continue;let ot=n.tileCoordToPixel(A.min.x+rt/A.xScale,A.min.y+He/A.yScale),_t=n.tileCoordToPixel(A.min.x+(rt+1)/A.xScale,A.min.y+(He+1)/A.yScale);for(let Mt=ot.y;Mt<=Math.min(_t.y+1,p-1);++Mt)for(let At=ot.x;At<=Math.min(_t.x+1,p-1);++At)rm[Mt*p+At]===255&&(rm[Mt*p+At]=0,be+=n.getElevationAtPixel(At,Mt),we++)}let $e=be/we;q=Math.max(1,M.x-z),Z=Math.max(1,M.y-z),oe=Math.min(R.x+z,p-2),ye=Math.min(R.y+z,p-2),v=!0;for(let He=Z;He<=ye;++He)for(let rt=q;rt<=oe;++rt)rm[He*p+rt]===0&&(x2[He*p+rt]=n._dem.set(rt,He,$e));for(let He=1;He<z;++He){q=Math.max(1,M.x-He),Z=Math.max(1,M.y-He),oe=Math.min(R.x+He,p-2),ye=Math.min(R.y+He,p-2);for(let rt=Z;rt<=ye;++rt)for(let ot=q;ot<=oe;++ot){let _t=rt*p+ot;if(rm[_t]===255){let Mt=0,At=0,zt=-1,Jt=-1;for(let Ot=-1;Ot<=1;++Ot)for(let Xt=-1;Xt<=1;++Xt){let Dt=(rt+Ot)*p+ot+Xt;if(rm[Dt]>=He)continue;let Zt=x2[Dt],ir=Math.abs(Zt);ir>At&&(Mt=Zt,At=ir,zt=Xt,Jt=Ot)}if(At>.1){let Ot=1-(He+.5*Math.abs(zt*Jt))/z,Xt=n._dem.get(ot,rt)+Mt*Ot,Dt=n._dem.get(ot+zt,rt+Jt),Zt=n._dem.get(ot-zt,rt-Jt,!0);(Xt-Dt)*(Xt-Zt)>0&&(Xt=(Dt+Zt)/2),x2[_t]=n._dem.set(ot,rt,Xt),rm[_t]=He}}}}}v&&(n._demTile.needsDEMTextureUpload=!0,n._dem._timestamp=di.now())}getNodesInfo(){return this.nodesInfo}destroy(){let e=this.getNodesInfo();for(let n of e)Cv(n.node),f2(n.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(e,n){if(n.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=n.updateTime;let l=n.getReplacementRegionsForTile(e.toUnwrapped()),h=this.getNodesInfo();for(let f=0;f<this.nodesInfo.length;f++){let p=h[f].node;h[f].hiddenByReplacement=!!p.footprint&&!l.find(v=>v.footprint===p.footprint)}}getHeightAtTileCoord(e,n){let l=this.getNodesInfo(),h=[],f=[0,0,0],p=r.ad.identity([]);for(let v=0;v<this.nodesInfo.length;v++){let y=l[v],w=y.node.meshes[0],A=w.transformedAabb;if(e<A.min[0]||n<A.min[1]||e>A.max[0]||n>A.max[1])continue;if(y.node.hidden===!0)return{height:0,maxHeight:y.feature.properties.height,hidden:!1,verticalScale:y.evaluatedScale[2]};r.ad.invert(p,y.node.matrix),f[0]=e,f[1]=n,r._.transformMat4(f,f,p);let M=(f[0]-w.aabb.min[0])/(w.aabb.max[0]-w.aabb.min[0])*em|0,R=Math.min(63,(f[1]-w.aabb.min[1])/(w.aabb.max[1]-w.aabb.min[1])*em|0)*em+Math.min(63,M),N=w.heightmap[R];if(!(N<0&&y.node.footprint))return y.hiddenByReplacement?void 0:{height:N,maxHeight:y.feature.properties.height,hidden:!1,verticalScale:y.evaluatedScale[2]};if(y.node.footprint.grid.query(new hr(e,n),new hr(e,n),h),h.length>0)return{height:void 0,maxHeight:y.feature.properties.height,hidden:y.hiddenByReplacement,verticalScale:y.evaluatedScale[2]}}}}function a_(t,e){return!t.isLightConstant&&e}function OL(t,e,n,l,h,f,p,v){let y=(61440&e|(61440&e)>>4)>>8,w=(3840&e|(3840&e)>>4)>>4,A=240&e|(240&e)>>4;n[3]>0&&(y=Xr(y,255*n[0],n[3]),w=Xr(w,255*n[1],n[3]),A=Xr(A,255*n[2],n[3]));let M=y<<8|w,R=A<<8|Math.floor(255*l[3]),N=function(He){let rt=ui(He,0,2);return Math.min(Math.round(.5*rt*255),255)}(l[2])<<8|15*l[0]<<4|15*l[1],z=ui(h[0],0,1),q=ui(h[1],0,1),Z=ui(h[2],0,1),oe=ui(h[3],0,1),ye,be,we,$e;if(z!==q&&p!==f&&q!==z){let He=p-f;be=1/(He*(q-z)),we=-(f+He*z)/(He*(q-z));let rt=ui(h[4],-1,1);$e=Math.pow(10,rt),ye=255*Z<<8|255*oe}else ye=65535,be=0,we=1,$e=1;if(t.emplaceBack(M,R,N,ye,be,we,$e),v){let He=v.length;v.clear();for(let rt=0;rt<He;rt++)v.emplaceBack(M,R,N,ye,be,we,$e)}}function NL(t,e,n){let l=t.node,h=0,f=n&m0.HasMeshoptCompression;for(let p of l.meshes){if(l.lights&&l.lightMeshIndex===h||!p.featureData)continue;p.featureArray=new R1,p.featureArray.reserve(p.featureData.length);let v=e;for(let y of p.featureData){let w=f?65535&y:y>>16&65535,A=f?y>>16&65535:65535&y,M=(15&A)<8?15&A:0,R=t.evaluatedRMEA[M],N=t.evaluatedColor[M],z=t.emissionHeightBasedParams[M],q;if(v&&M===2&&l.lights&&(q=new R1,q.resize(10*l.lights.length)),OL(p.featureArray,w,N,R,z,p.aabb.min[2],p.aabb.max[2],q),q&&v){v=!1;let Z=l.meshes[l.lightMeshIndex];Z.featureArray=q,Z.featureArray._trim()}}p.featureArray._trim(),h++}}function aC(t,e,n,l){let h=1<<t.z;e.lat=Zo((l/it+t.y)/h),e.lng=Nl((n/it+t.x)/h)}Fe(Rv,"Tiled3dModelBucket",{omit:["layers"]}),Fe(nC,"Tiled3dModelFeature");let BL={circle:class extends bo{constructor(t,e,n,l){super(t,SR,e,n,l)}createBucket(t){return new _b(t)}queryRadius(t){let e=t;return Qm("circle-radius",this,e)+Qm("circle-stroke-width",this,e)+B1(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,n,l,h,f,p,v){let y=gS(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),f.angle,t.pixelToTileUnitsFactor),w=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n);return DS(t,l,f,p,v,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",y,w)}getProgramIds(){return["circle"]}getDefaultProgramParams(t,e,n){let l=MS(this);return{config:new qp(this,{zoom:e,lut:n}),defines:l,overrideFog:!1}}},heatmap:class extends bo{createBucket(t){return new FS(t)}constructor(t,e,n,l){super(t,LR,e,n,l),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Pg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return Qm("heatmap-radius",this,t)}queryIntersectsFeature(t,e,n,l,h,f,p,v){let y=this.paint.get("heatmap-radius").evaluate(e,n);return DS(t,l,f,p,v,!0,!0,new hr(0,0),y)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(t,e,n){return t==="heatmap"?{config:new qp(this,{zoom:e,lut:n}),overrideFog:!1}:{}}},hillshade:class extends bo{constructor(t,e,n,l){super(t,NR,e,n,l)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(t,e,n){return{overrideFog:!1}}},fill:class extends bo{constructor(t,e,n,l){super(t,KR,e,n,l)}getProgramIds(){let t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),n=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getDefaultProgramParams(t,e,n){return{config:new qp(this,{zoom:e,lut:n}),overrideFog:!1}}recalculate(t,e){super.recalculate(t,e);let n=this.paint._values["fill-outline-color"];n.value.kind==="constant"&&n.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new $1(t)}queryRadius(){return B1(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,n,l,h,f){return!t.queryGeometry.isAboveHorizon&&hS(mS(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),f.angle,t.pixelToTileUnitsFactor),l)}isTileClipped(){return!0}},"fill-extrusion":class extends bo{constructor(t,e,n,l){super(t,CF,e,n,l),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(t){return new ev(t)}queryRadius(){return B1(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(t,e,n,l,h,f,p,v,y){let w=gS(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),f.angle,t.pixelToTileUnitsFactor),A=this.paint.get("fill-extrusion-height").evaluate(e,n),M=this.paint.get("fill-extrusion-base").evaluate(e,n),R=[0,0],N=v&&f.elevation,z=f.elevation?f.elevation.exaggeration():1,q=t.tile.getBucket(this);if(N&&q instanceof ev){let we=q.centroidVertexArray,$e=y+1;$e<we.length&&(R[0]=we.geta_centroid_pos0($e),R[1]=we.geta_centroid_pos1($e))}if(R[0]===0&&R[1]===1)return!1;f.projection.name==="globe"&&(l=xE([l],[new hr(0,0),new hr(it,it)],t.tileID.canonical).map(we=>we.polygon).flat());let Z=N?v:null,[oe,ye]=function(we,$e,He,rt,ot,_t,Mt,At,zt,Jt,Ot){return we.projection.name==="globe"?function(Xt,Dt,Zt,ir,Kt,Sr,er,lr,Zr,zr,Or){let ar=[],Kr=[],vi=Xt.projection.upVectorScale(Or,Xt.center.lat,Xt.worldSize).metersToTile,ri=[0,0,0,1],Si=[0,0,0,1],yi=(ei,Sn,wn,tn)=>{ei[0]=Sn,ei[1]=wn,ei[2]=tn,ei[3]=1},Pi=yE();Zt>0&&(Zt+=Pi),ir+=Pi;for(let ei of Dt){let Sn=[],wn=[];for(let tn of ei){let Zi=tn.x+Kt.x,rn=tn.y+Kt.y,jn=Xt.projection.projectTilePoint(Zi,rn,Or),Mn=Xt.projection.upVector(Or,tn.x,tn.y),xa=Zt,fa=ir;if(er){let Ms=wE(Zi,rn,Zt,ir,er,lr,Zr,zr);xa+=Ms.base,fa+=Ms.top}Zt!==0?yi(ri,jn.x+Mn[0]*vi*xa,jn.y+Mn[1]*vi*xa,jn.z+Mn[2]*vi*xa):yi(ri,jn.x,jn.y,jn.z),yi(Si,jn.x+Mn[0]*vi*fa,jn.y+Mn[1]*vi*fa,jn.z+Mn[2]*vi*fa),r._.transformMat4(ri,ri,Sr),r._.transformMat4(Si,Si,Sr),Sn.push(new Kp(ri[0],ri[1],ri[2])),wn.push(new Kp(Si[0],Si[1],Si[2]))}ar.push(Sn),Kr.push(wn)}return[ar,Kr]}(we,$e,He,rt,ot,_t,Mt,At,zt,Jt,Ot):Mt?function(Xt,Dt,Zt,ir,Kt,Sr,er,lr,Zr){let zr=[],Or=[],ar=[0,0,0,1];for(let Kr of Xt){let vi=[],ri=[];for(let Si of Kr){let yi=Si.x+ir.x,Pi=Si.y+ir.y,ei=wE(yi,Pi,Dt,Zt,Sr,er,lr,Zr);ar[0]=yi,ar[1]=Pi,ar[2]=ei.base,ar[3]=1,r.aA.transformMat4(ar,ar,Kt),ar[3]=Math.max(ar[3],1e-5);let Sn=new Kp(ar[0]/ar[3],ar[1]/ar[3],ar[2]/ar[3]);ar[0]=yi,ar[1]=Pi,ar[2]=ei.top,ar[3]=1,r.aA.transformMat4(ar,ar,Kt),ar[3]=Math.max(ar[3],1e-5);let wn=new Kp(ar[0]/ar[3],ar[1]/ar[3],ar[2]/ar[3]);vi.push(Sn),ri.push(wn)}zr.push(vi),Or.push(ri)}return[zr,Or]}($e,He,rt,ot,_t,Mt,At,zt,Jt):function(Xt,Dt,Zt,ir,Kt){let Sr=[],er=[],lr=Kt[8]*Dt,Zr=Kt[9]*Dt,zr=Kt[10]*Dt,Or=Kt[11]*Dt,ar=Kt[8]*Zt,Kr=Kt[9]*Zt,vi=Kt[10]*Zt,ri=Kt[11]*Zt;for(let Si of Xt){let yi=[],Pi=[];for(let ei of Si){let Sn=ei.x+ir.x,wn=ei.y+ir.y,tn=Kt[0]*Sn+Kt[4]*wn+Kt[12],Zi=Kt[1]*Sn+Kt[5]*wn+Kt[13],rn=Kt[2]*Sn+Kt[6]*wn+Kt[14],jn=Kt[3]*Sn+Kt[7]*wn+Kt[15],Mn=tn+lr,xa=Zi+Zr,fa=rn+zr,Ms=Math.max(jn+Or,1e-5),Ba=tn+ar,ia=Zi+Kr,mo=rn+vi,Yo=Math.max(jn+ri,1e-5);yi.push(new Kp(Mn/Ms,xa/Ms,fa/Ms)),Pi.push(new Kp(Ba/Yo,ia/Yo,mo/Yo))}Sr.push(yi),er.push(Pi)}return[Sr,er]}($e,He,rt,ot,_t)}(f,l,M,A,w,p,Z,R,z,f.center.lat,t.tileID.canonical),be=t.queryGeometry;return function(we,$e,He){let rt=1/0;hS(He,$e)&&(rt=bE(He,$e[0]));for(let ot=0;ot<$e.length;ot++){let _t=$e[ot],Mt=we[ot];for(let At=0;At<_t.length-1;At++){let zt=_t[At],Jt=[zt,_t[At+1],Mt[At+1],Mt[At],zt];vb(He,Jt)&&(rt=Math.min(rt,bE(He,Jt)))}}return rt!==1/0&&rt}(oe,ye,be.isPointQuery()?be.screenBounds:be.screenGeometry)}},line:class extends bo{constructor(t,e,n,l){super(t,rv,e,n,l),rv.layout&&(this.layout=new bn(rv.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){let e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Oc,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=CA.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new tv(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(t,e,n){let l=ME(this);return{config:new qp(this,{zoom:e,lut:n}),defines:l,overrideFog:!1}}queryRadius(t){let e=t,n=IA(Qm("line-width",this,e),Qm("line-gap-width",this,e)),l=Qm("line-offset",this,e);return n/2+Math.abs(l)+B1(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,n,l,h,f){if(t.queryGeometry.isAboveHorizon)return!1;let p=mS(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),f.angle,t.pixelToTileUnitsFactor),v=t.pixelToTileUnitsFactor/2*IA(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),y=this.paint.get("line-offset").evaluate(e,n);return y&&(l=function(w,A){let M=[],R=new hr(0,0);for(let N=0;N<w.length;N++){let z=w[N],q=[];for(let Z=0;Z<z.length;Z++){let oe=z[Z],ye=z[Z+1],be=Z===0?R:oe.sub(z[Z-1])._unit()._perp(),we=Z===z.length-1?R:ye.sub(oe)._unit()._perp(),$e=be._add(we)._unit();$e._mult(1/($e.x*we.x+$e.y*we.y)),q.push($e._mult(A)._add(oe))}M.push(q)}return M}(l,y*t.pixelToTileUnitsFactor)),function(w,A,M){for(let R=0;R<A.length;R++){let N=A[R];if(w.length>=3){for(let z=0;z<N.length;z++)if(Gf(w,N[z]))return!0}if(xR(w,N,M))return!0}return!1}(p,l,v)}isTileClipped(){return!0}isDraped(t){let e=this.layout.get("line-z-offset");return e.isConstant()&&!e.constantOr(0)}},symbol:bv,background:class extends bo{constructor(t,e,n,l){super(t,rL,e,n,l)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(t,e,n){return{overrideFog:!1}}},raster:RA,"raster-particle":FA,sky:class extends bo{constructor(t,e,n,l){super(t,uL,e,n,l),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="sky-gradient"?this._updateColorRamp():t!=="sky-atmosphere-sun"&&t!=="sky-atmosphere-halo-color"&&t!=="sky-atmosphere-color"&&t!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Pg({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){let e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(t,e){if(this.paint.get("sky-type")==="atmosphere"){let l=this.paint.get("sky-atmosphere-sun"),h=!l,f=t.style.light,p=f.properties.get("position");return h&&f.properties.get("anchor")==="viewport"&&Wn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),h?c2(p.azimuthal,90-p.polar,e):c2(l[0],90-l[1],e)}let n=this.paint.get("sky-gradient-center");return c2(n[0],90-n[1],e)}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){let t=this.paint.get("sky-type");return t==="atmosphere"?["skyboxCapture","skybox"]:t==="gradient"?["skyboxGradient"]:null}},slot:class extends bo{constructor(t,e,n,l){super(t,hL,e,null)}},model:class extends bo{constructor(t,e,n,l){super(t,xL,e,n,l),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(t){return new h2(t)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(t){return t instanceof Rv?it-1:0}queryIntersectsFeature(t,e,n,l,h,f){if(!this.modelManager)return!1;let p=this.modelManager,v=t.tile.getBucket(this);if(!(v&&v instanceof h2))return!1;let y=v;for(let w in y.instancesPerModel){let A=y.instancesPerModel[w],M=e.id!==void 0?e.id:e.properties&&e.properties.hasOwnProperty("id")?e.properties.id:void 0;if(A.idToFeaturesIndex.hasOwnProperty(M)){let R=A.features[A.idToFeaturesIndex[M]],N=p.getModel(w,this.scope);if(!N)return!1;let z=r.ad.create(),q=new en(0,0),Z=y.canonical,oe=Number.MAX_VALUE;for(let ye=0;ye<R.instancedDataCount;++ye){let be=16*(R.instancedDataOffset+ye),we=A.instancedDataArray.float32,$e=[we[be+4],we[be+5],we[be+6]];aC(Z,q,we[be],0|we[be+1]),GA(z,N,f,q,R.rotation,R.scale,$e,!1,!1,!1),f.projection.name==="globe"&&(z=u2(z,f));let He=r.ad.multiply([],f.projMatrix,z),rt=t.queryGeometry,ot=zA(rt.isPointQuery()?rt.screenBounds:rt.screenGeometry,f,He,N.aabb);ot!=null&&(oe=Math.min(ot,oe))}return oe!==Number.MAX_VALUE&&oe}}return!1}_handleOverridablePaintPropertyUpdate(t,e,n){return!(!this.layout||e.isDataDriven()||n.isDataDriven()||t!=="model-color"&&t!=="model-color-mix-intensity"&&t!=="model-rotation"&&t!=="model-scale"&&t!=="model-translation"&&t!=="model-emissive-strength")}_isPropertyZoomDependent(t){let e=this._transitionablePaint._values[t];return e!=null&&e.value!=null&&e.value.expression!=null&&e.value.expression instanceof ue}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(t,e,n,l){let h=t.tile,f=h.getBucket(this),p=null,v=Number.MAX_VALUE;if(!(f&&f instanceof Rv))return{queryFeature:p,intersectionZ:v};let y=f.getNodesInfo()[e];if(y.hiddenByReplacement||!y.node.meshes||!n.filter(new ni(h.tileID.overscaledZ),y.feature,h.tileID.canonical))return{queryFeature:p,intersectionZ:v};let w=y.node,A=l.calculatePosMatrix(h.tileID.toUnwrapped(),l.worldSize),M=y.evaluatedScale,R=0;l.elevation&&w.elevation&&(R=w.elevation*l.elevation.exaggeration()),r.ad.translate(A,A,[(w.anchor?w.anchor[0]:0)*(M[0]-1),(w.anchor?w.anchor[1]:0)*(M[1]-1),R]),r.ad.scale(A,A,M),r.ad.multiply(A,A,w.matrix);let N=t.queryGeometry,z=N.isPointQuery()?N.screenBounds:N.screenGeometry,q=function(oe){let ye=r.ad.multiply([],A,oe.matrix),be=r.ad.multiply(ye,l.expandedFarZProjMatrix,ye);for(let we=0;we<oe.meshes.length;++we){let $e=oe.meshes[we];if(we===oe.lightMeshIndex)continue;let He=zA(z,l,be,$e.aabb);He!=null&&(v=Math.min(He,v))}if(oe.children)for(let we of oe.children)q(we)};if(q(w),v===Number.MAX_VALUE)return{queryFeature:p,intersectionZ:v};let Z=new en(0,0);return aC(h.tileID.canonical,Z,y.node.anchor[0],y.node.anchor[1]),p={type:"Feature",geometry:{type:"Point",coordinates:[Z.lng,Z.lat]},properties:y.feature.properties,id:y.feature.id,state:{},layer:this.serialize()},{queryFeature:p,intersectionZ:v}}},clip:class extends bo{constructor(t,e,n,l){super(t,QR,e,n,l)}recalculate(t,e){super.recalculate(t,e)}createBucket(t){return new US(t)}isTileClipped(){return!0}is3D(){return!0}}};Fe(SA,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});let oC=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class b2{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[n,l]=new Uint8Array(e,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");let h=l>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);let f=oC[15&l];if(!f)throw new Error("Unrecognized array type.");let[p]=new Uint16Array(e,2,1),[v]=new Uint32Array(e,4,1);return new b2(v,p,f,e)}constructor(e,n=64,l=Float64Array,h){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=l,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;let f=oC.indexOf(this.ArrayType),p=2*e*this.ArrayType.BYTES_PER_ELEMENT,v=e*this.IndexArrayType.BYTES_PER_ELEMENT,y=(8-v%8)%8;if(f<0)throw new Error(`Unexpected typed array class: ${l}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+v+y,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+p+v+y),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+v+y,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+f]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=e)}add(e,n){let l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=e,this.coords[this._pos++]=n,l}finish(){let e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return w2(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,n,l,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:f,coords:p,nodeSize:v}=this,y=[0,f.length-1,0],w=[];for(;y.length;){let A=y.pop()||0,M=y.pop()||0,R=y.pop()||0;if(M-R<=v){for(let Z=R;Z<=M;Z++){let oe=p[2*Z],ye=p[2*Z+1];oe>=e&&oe<=l&&ye>=n&&ye<=h&&w.push(f[Z])}continue}let N=R+M>>1,z=p[2*N],q=p[2*N+1];z>=e&&z<=l&&q>=n&&q<=h&&w.push(f[N]),(A===0?e<=z:n<=q)&&(y.push(R),y.push(N-1),y.push(1-A)),(A===0?l>=z:h>=q)&&(y.push(N+1),y.push(M),y.push(1-A))}return w}within(e,n,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:h,coords:f,nodeSize:p}=this,v=[0,h.length-1,0],y=[],w=l*l;for(;v.length;){let A=v.pop()||0,M=v.pop()||0,R=v.pop()||0;if(M-R<=p){for(let Z=R;Z<=M;Z++)lC(f[2*Z],f[2*Z+1],e,n)<=w&&y.push(h[Z]);continue}let N=R+M>>1,z=f[2*N],q=f[2*N+1];lC(z,q,e,n)<=w&&y.push(h[N]),(A===0?e-l<=z:n-l<=q)&&(v.push(R),v.push(N-1),v.push(1-A)),(A===0?e+l>=z:n+l>=q)&&(v.push(N+1),v.push(M),v.push(1-A))}return y}}function w2(t,e,n,l,h,f){if(h-l<=n)return;let p=l+h>>1;sC(t,e,p,l,h,f),w2(t,e,n,l,p-1,1-f),w2(t,e,n,p+1,h,1-f)}function sC(t,e,n,l,h,f){for(;h>l;){if(h-l>600){let w=h-l+1,A=n-l+1,M=Math.log(w),R=.5*Math.exp(2*M/3),N=.5*Math.sqrt(M*R*(w-R)/w)*(A-w/2<0?-1:1);sC(t,e,n,Math.max(l,Math.floor(n-A*R/w+N)),Math.min(h,Math.floor(n+(w-A)*R/w+N)),f)}let p=e[2*n+f],v=l,y=h;for(o_(t,e,l,n),e[2*h+f]>p&&o_(t,e,l,h);v<y;){for(o_(t,e,v,y),v++,y--;e[2*v+f]<p;)v++;for(;e[2*y+f]>p;)y--}e[2*l+f]===p?o_(t,e,l,y):(y++,o_(t,e,y,h)),y<=n&&(l=y+1),n<=y&&(h=y-1)}}function o_(t,e,n,l){T2(t,n,l),T2(e,2*n,2*l),T2(e,2*n+1,2*l+1)}function T2(t,e,n){let l=t[e];t[e]=t[n],t[n]=l}function lC(t,e,n,l){let h=t-n,f=e-l;return h*h+f*f}r.$=Wl,r.A=ll,r.B=$o,r.C=qi,r.D=Lo,r.E=Kl,r.G=Is,r.H=d,r.I=MP,r.J=wg,r.K=function(t){let e=t.value,n=[];if(!e)return n;let l=su(e);return l!=="string"?(n=n.concat([new Av(t.key,e,`string expected, "${l}" found`)]),n):(jA(e,!0)||(n=n.concat([new Av(t.key,e,`invalid url "${e}"`)])),n)},r.L=vt,r.M=class{constructor(t,e,n,l){this.id=t,this.position=e!=null?new en(e[0],e[1]):new en(0,0),this.orientation=n??[0,0,0],this.nodes=l,this.uploaded=!1,this.aabb=new da([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(t,e){if(r.ad.multiply(t.matrix,e,t.matrix),t.meshes)for(let n of t.meshes){let l=da.applyTransform(n.aabb,t.matrix);this.aabb.encapsulate(l)}if(t.children)for(let n of t.children)this._applyTransformations(n,t.matrix)}computeBoundsAndApplyParent(){let t=r.ad.identity([]);for(let e of this.nodes)this._applyTransformations(e,t)}computeModelMatrix(t,e,n,l,h,f,p=!1){GA(this.matrix,this,t.transform,this.position,e,n,l,h,f,p)}upload(t){if(!this.uploaded){for(let e of this.nodes)d2(e,t);for(let e of this.nodes)Cv(e);this.uploaded=!0}}destroy(){for(let t of this.nodes)f2(t)}},r.N=un,r.O=Ht,r.P=hr,r.Q=class{constructor(t){this.specification=t}possiblyEvaluate(t,e){return il(t.expression.evaluate(e))}interpolate(t,e,n){return{x:Xr(t.x,e.x,n),y:Xr(t.y,e.y,n),z:Xr(t.z,e.z,n),azimuthal:Xr(t.azimuthal,e.azimuthal,n),polar:Xr(t.polar,e.polar,n)}}},r.R=Ec,r.S=rb,r.T=_u,r.U=mn,r.V=Av,r.W=Ma,r.X=ni,r.Y=ks,r.Z=ue,r.a=nc,r.a$=function(t){let{x:e,y:n}=t.point,{lng:l,lat:h}=t._center;return CS(e,n,t.worldSize,l,h)},r.a0=bn,r.a1=Hd,r.a2=Xr,r.a3=it,r.a4=ws,r.a5=class{constructor(t){this.specification=t}possiblyEvaluate(t,e){return function([n,l]){let h=il([1,n,l]);return{x:h.x,y:h.y,z:h.z}}(t.expression.evaluate(e))}interpolate(t,e,n){return{x:Xr(t.x,e.x,n),y:Xr(t.y,e.y,n),z:Xr(t.z,e.z,n)}}},r.a6=Cg,r.a7=P1,r.a8=jd,r.a9=tS,r.aB=function(t,e){let{x:n,y:l}=t.point,h=CS(n,l,t.worldSize/t._pixelsPerMercatorPixel,0,0);return r.ad.multiply(h,h,Cb(Xh(e)))},r.aD=o0,r.aE=jc,r.aF=av,r.aG=function(t,e,n,l,h){let f=5*e+2;t.float32[f+0]=n,t.float32[f+1]=l,t.float32[f+2]=h},r.aH=gv,r.aI=en,r.aJ=mA,r.aK=aS,r.aL=wo,r.aM=Sb,r.aN=LA,r.aO=Xp,r.aP=SS,r.aQ=function(t,e,n,l,h,f,p,v,y){if(y.name==="globe")return SS(t,e,new Xp(n,l,h),!1);let w=Jp({z:n,x:l,y:h},y);return new da([(f+w.x/w.scale)*e,e*(w.y/w.scale),p],[(f+w.x2/w.scale)*e,e*(w.y2/w.scale),v])},r.aR=function(t,e,n){let l=0;for(let h=0;h<2;++h)t[h]>0&&(l+=(t[h]-0)*(t[h]-0)),e[h]<0&&(l+=(0-e[h])*(0-e[h]));return l},r.aS=$a,r.aT=wb,r.aU=iS,r.aV=function(t){let e=r.ad.identity(new Float64Array(16));r.ad.multiply(e,t.pixelMatrix,t.globeMatrix);let n=[0,mu,0],l=[0,gu,0];return r._.transformMat4(n,n,e),r._.transformMat4(l,l,e),[n[0]>0&&n[0]<=t.width&&n[1]>0&&n[1]<=t.height&&!kb(t,new en(t.center.lat,90)),l[0]>0&&l[0]<=t.width&&l[1]>0&&l[1]<=t.height&&!kb(t,new en(t.center.lat,-90))]},r.aW=function(t,e){let{scale:n}=t.tileTransform,l=n*it/(t.tileSize*Math.pow(2,e.zoom-t.tileID.overscaledZ+t.tileID.canonical.z));return r.aC.scale(new Float32Array(4),e.inverseAdjustmentMatrix,[l,l])},r.aX=Sv,r.aY=PA,r.aZ=function(t){let e=PA(t,!0);return r.aC.invert([],[e[0],e[1],e[4],e[5]])},r.a_=Tb,r.aa=hl,r.ab=Ai,r.ac=function(t,e,n){let l=Math.sqrt(t*t+e*e+n*n),h=l>0?Math.acos(n/l)*vc:0,f=t!==0||e!==0?Math.atan2(-e,-t)*vc+90:0;return f<0&&(f+=360),[l,f,h]},r.ae=h0,r.af=ih,r.ag=Jb,r.ah=function(t,e){let n={};for(let l=0;l<e.length;l++){let h=e[l];h in t&&(n[h]=t[h])}return n},r.ai=Vf,r.aj=qh,r.ak=$h,r.al=Wm,r.am=function(t){Ru++,Ru>Io&&(t.getActor().send("enforceCacheSizeLimit",Va),Ru=0)},r.an=Us,r.ao=class{constructor(t){this.entries={},this.scheduler=t}request(t,e,n,l){let h=this.entries[t]=this.entries[t]||{callbacks:[]};if(h.result){let[f,p]=h.result;return this.scheduler?this.scheduler.add(()=>{l(f,p)},e):l(f,p),()=>{}}return h.callbacks.push(l),h.cancel||(h.cancel=n((f,p)=>{h.result=[f,p];for(let v of h.callbacks)this.scheduler?this.scheduler.add(()=>{v(f,p)},e):v(f,p);setTimeout(()=>delete this.entries[t],3e3)})),()=>{h.result||(h.callbacks=h.callbacks.filter(f=>f!==l),h.callbacks.length||(h.cancel(),delete this.entries[t]))}}},r.ap=function(t,e,n){let l=JSON.stringify(t.request);return t.data&&(this.deduped.entries[l]={result:[null,t.data]}),this.deduped.request(l,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},h=>{let f=ho(t.request,(p,v,y,w)=>{p?h(p):v&&h(null,{vectorTile:n?void 0:new Ob(new a0(v)),rawData:v,cacheControl:y,expires:w})});return()=>{f.cancel(),h()}},e)},r.aq=ob,r.ar=class extends zd{constructor(t){super(t),this.current=oR}set(t,e,n){if(this.fetchUniformLocation(t,e)){for(let l=0;l<9;l++)if(n[l]!==this.current[l]){this.current=n,this.gl.uniformMatrix3fv(this.location,!1,n);break}}}},r.as=sb,r.at=ui,r.au=ql,r.aw=Lt,r.ax=fl,r.ay=Zo,r.az=function(t,e,n){t[4*e+0]=n[0],t[4*e+1]=n[1],t[4*e+2]=n[2],t[4*e+3]=n[3]},r.b=ha,r.b$=qf,r.b0=ka,r.b1=ub,r.b2=function(t){let e=Math.round((t+45+360)%360/90)%4;return yf[e]},r.b3=45,r.b4=fb,r.b5=L1,r.b6=da,r.b7=il,r.b8=function(t){return[Math.pow(t[0],1/2.2),Math.pow(t[1],1/2.2),Math.pow(t[2],1/2.2)]},r.b9=yc,r.bA=function(t,e){return[Math.pow(t[0],2.2)*e,Math.pow(t[1],2.2)*e,Math.pow(t[2],2.2)*e]},r.bB=CE,r.bD=AS,r.bE=hi,r.bF=Yr,r.bG=256,r.bH=function(t,e){let n=[0,0,0],l=Fg(Xh(e.canonical));return r._.transformMat4(n,n,l),r._.transformMat4(n,n,t),n},r.bI=t=>({u_camera_to_center_distance:new hl(t),u_extrude_scale:new lb(t),u_device_pixel_ratio:new hl(t),u_matrix:new Cg(t),u_inv_rot_matrix:new Cg(t),u_merc_center:new jd(t),u_tile_id:new ob(t),u_zoom_transition:new hl(t),u_up_dir:new ob(t),u_emissive_strength:new hl(t)}),r.bJ=t=>({u_matrix:new Cg(t),u_pixels_to_tile_units:new lb(t),u_device_pixel_ratio:new hl(t),u_units_to_pixels:new jd(t),u_dash_image:new P1(t),u_gradient_image:new P1(t),u_image_height:new hl(t),u_texsize:new jd(t),u_tile_units_to_pixels:new hl(t),u_alpha_discard_threshold:new hl(t),u_trim_offset:new jd(t),u_trim_fade_range:new jd(t),u_trim_color:new sb(t),u_emissive_strength:new hl(t)}),r.bK=t=>({u_matrix:new Cg(t),u_texsize:new jd(t),u_pixels_to_tile_units:new lb(t),u_device_pixel_ratio:new hl(t),u_image:new P1(t),u_units_to_pixels:new jd(t),u_tile_units_to_pixels:new hl(t),u_alpha_discard_threshold:new hl(t),u_trim_offset:new jd(t)}),r.bL=Zx,r.bM=jF,r.bN=ls,r.bO=nP,r.bP=oA,r.bQ=Wb,r.bR=MS,r.bS=(t,e,n,l,h,f)=>{let p=t.transform,v=p.projection.name==="globe",y;if(f.paint.get("circle-pitch-alignment")==="map")if(v){let A=AS(p.zoom,e.canonical)*p._pixelsPerMercatorPixel;y=Float32Array.from([A,0,0,A])}else y=p.calculatePixelsToTileUnitsMatrix(n);else y=new Float32Array([p.pixelsToGLUnits[0],0,0,p.pixelsToGLUnits[1]]);let w={u_camera_to_center_distance:t.transform.getCameraToCenterDistance(p.projection),u_matrix:t.translatePosMatrix(e.projMatrix,n,f.paint.get("circle-translate"),f.paint.get("circle-translate-anchor")),u_device_pixel_ratio:di.devicePixelRatio,u_extrude_scale:y,u_inv_rot_matrix:MR,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:f.paint.get("circle-emissive-strength")};if(v){w.u_inv_rot_matrix=l,w.u_merc_center=h,w.u_tile_id=[e.canonical.x,e.canonical.y,1<<e.canonical.z],w.u_zoom_transition=Hd(p.zoom);let A=h[0]*it,M=h[1]*it;w.u_up_dir=p.projection.upVector(new Xp(0,0,0),A,M)}return w},r.bT=ME,r.bU=(t,e,n,l,h,f)=>{let p=t.transform;return{u_matrix:kE(t,e,n,l),u_texsize:e.imageAtlasTexture?e.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:p.calculatePixelsToTileUnitsMatrix(e),u_device_pixel_ratio:h,u_image:0,u_tile_units_to_pixels:IE(e,p),u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:f}},r.bV=(t,e,n,l,h,f,p)=>{let v=t.transform,y=v.calculatePixelsToTileUnitsMatrix(e);return{u_matrix:kE(t,e,n,l),u_pixels_to_tile_units:y,u_device_pixel_ratio:f,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:h,u_texsize:DE(n)&&e.lineAtlasTexture?e.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:IE(e,t.transform),u_alpha_discard_threshold:0,u_trim_offset:p,u_trim_fade_range:n.paint.get("line-trim-fade-range"),u_trim_color:n.paint.get("line-trim-color").toRenderColor(n.lut).toArray01(),u_emissive_strength:n.paint.get("line-emissive-strength")}},r.bW=Du,r.bX=Pg,r.bY=yE,r.bZ=pR,r.b_=ev,r.ba=function(t,e,n){let l=Hd(n.zoom),h=t.style.map._antialias,f=e.options.extStandardDerivativesForceOff||t.terrain&&t.terrain.exaggeration()>0;return l===0&&!h&&!f},r.bb=function(t){let e=t.pixelsPerMeter,n=e/fl(1,t.center.lat),l=r.ad.identity(new Float64Array(16));return r.ad.translate(l,l,[t.point.x,t.point.y,0]),r.ad.scale(l,l,[n,n,e]),Float32Array.from(l)},r.bc=U1,r.bd=function(t){let e=$a-5;t=ui(t,-e,e)/e*90;let n=Math.pow(Math.abs(Math.sin(Ai(t))),3);return Math.round(n*(hb.length-1))},r.be=function(t,e,n,l){let h=e.getNorth(),f=e.getSouth(),p=e.getWest(),v=e.getEast(),y=1<<t.z,w=v-p,A=h-f,M=w/Zm,R=-A/hb[n],N=[0,M,0,R,0,0,h,p,0];if(t.z>0){let z=180/l;r.bC.multiply(N,N,[z/w+1,0,0,0,z/A+1,0,-.5*z/M,.5*z/R,1])}return N[2]=y,N[5]=t.x,N[8]=t.y,N},r.bf=Fg,r.bg=Xh,r.bh=function(t,e,n){let l=r.ad.identity(new Float64Array(16)),h=(e/(1<<t)-.5)*Math.PI*2;return r.ad.rotateY(l,n.globeMatrix,h),Float32Array.from(l)},r.bi=Fi,r.bj=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},r.bk=RA,r.bl=FA,r.bm=DA,r.bn=function(t,e){let n=document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(let l=0;l<t.length;l++){let h=document.createElement("source");xf(t[l])||(n.crossOrigin="Anonymous"),h.src=t[l],n.appendChild(h)}return{cancel:()=>{}}},r.bo=_v,r.bp=Ih,r.bq=class{isDataAvailableAtPoint(t){let e=this._source();if(this.isUsingMockSource()||!e||t.y<0||t.y>1)return!1;let n=e.getSource().maxzoom,l=1<<n,h=Math.floor(t.x),f=Math.floor((t.x-h)*l),p=Math.floor(t.y*l),v=this.findDEMTileFor(new wo(n,h,n,f,p));return!(!v||!v.dem)}getAtPointOrZero(t,e=0){return this.getAtPoint(t,e)||0}getAtPoint(t,e,n=!0){if(this.isUsingMockSource())return null;e==null&&(e=null);let l=this._source();if(!l||t.y<0||t.y>1)return e;let h=l.getSource().maxzoom,f=1<<h,p=Math.floor(t.x),v=t.x-p,y=new wo(h,p,h,Math.floor(v*f),Math.floor(t.y*f)),w=this.findDEMTileFor(y);if(!w||!w.dem)return e;let A=w.dem,M=1<<w.tileID.canonical.z,R=(v*M-w.tileID.canonical.x)*A.dim,N=(t.y*M-w.tileID.canonical.y)*A.dim,z=Math.floor(R),q=Math.floor(N);return(n?this.exaggeration():1)*Xr(Xr(A.get(z,q),A.get(z,q+1),N-q),Xr(A.get(z+1,q),A.get(z+1,q+1),N-q),R-z)}getAtTileOffset(t,e,n){let l=1<<t.canonical.z;return this.getAtPointOrZero(new ks(t.wrap+(t.canonical.x+e/it)/l,(t.canonical.y+n/it)/l))}getAtTileOffsetFunc(t,e,n,l){return h=>{let f=this.getAtTileOffset(t,h.x,h.y),p=l.upVector(t.canonical,h.x,h.y),v=l.upVectorScale(t.canonical,e,n).metersToTile;return r._.scale(p,p,f*v),p}}getForTilePoints(t,e,n,l){if(this.isUsingMockSource())return!1;let h=r0.create(this,t,l);return!!h&&(e.forEach(f=>{f[2]=this.exaggeration()*h.getElevationAt(f[0],f[1],n)}),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;let e=this.findDEMTileFor(t);if(!e||!e.dem)return null;let n=e.dem.tree,l=e.tileID,h=1<<t.canonical.z-l.canonical.z,f=t.canonical.x/h-l.canonical.x,p=t.canonical.y/h-l.canonical.y,v=0;for(let y=0;y<t.canonical.z-l.canonical.z&&!n.leaves[v];y++){f*=2,p*=2;let w=2*Math.floor(p)+Math.floor(f);v=n.childOffsets[v]+w,f%=1,p%=1}return{min:this.exaggeration()*n.minimums[v],max:this.exaggeration()*n.maximums[v]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,n){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){let t=this.visibleDemTiles;if(t.length===0)return null;let e=!1,n=Number.MAX_VALUE,l=Number.MIN_VALUE;for(let h of t){let f=this.getMinMaxForTile(h.tileID);f&&(n=Math.min(n,f.min),l=Math.max(l,f.max),e=!0)}return e?{min:n,max:l}:null}},r.br=Dg,r.bs=j1,r.bt=Ju,r.bu=No,r.bv=Qp,r.bw=p2,r.bx=Iv,r.by=xv,r.bz=OS,r.c=eC,r.c$=Cc,r.c0=450,r.c1=7,r.c2=aL,r.c3=EA,r.c4=256,r.c5=wS,r.c6=Cb,r.c7=hn,r.c8=Nf,r.c9=Wp,r.cA=function(t){let e=1/0,n=1/0,l=-1/0,h=-1/0;for(let f of t)e=Math.min(e,f.x),n=Math.min(n,f.y),l=Math.max(l,f.x),h=Math.max(h,f.y);return{min:new hr(e,n),max:new hr(l,h)}},r.cB=Gf,r.cC=cS,r.cD=dl,r.cE=["type","source","source-layer","minzoom","maxzoom","filter","layout"],r.cF=QE,r.cG=vb,r.cH=JS,r.cI=QS,r.cJ=Zb,r.cK=b2,r.cL=function(t){return t({pluginStatus:Yt,pluginURL:Nt}),oi.on("pluginStateChange",t),t},r.cM=l0,r.cN=$b,r.cO=Ac,r.cP=Pr,r.cQ=D,r.cR=va,r.cS=ca,r.cT=_s,r.cU=function(t){let e=t.indexOf(Ff);return e>=0?t.slice(0,e):t},r.cV=function(t){return t.indexOf(Ff)>=0},r.cW=function(t){let e=t.indexOf(Ff);return e>=0?t.slice(e+1):""},r.cX=function(t){let e=[],n=t.id;return n===void 0&&e.push({message:`layers.${n}: missing required property "id"`}),t.render===void 0&&e.push({message:`layers.${n}: missing required method "render"`}),t.renderingMode&&t.renderingMode!=="2d"&&t.renderingMode!=="3d"&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},r.cY=function(t,e,n,l){return t.type==="custom"?new lL(t,e):new BL[t.type](t,e,n,l)},r.cZ=Al,r.c_=oi,r.ca=1,r.cb=Yg,r.cc=0,r.cd=Qx,r.ce=function(t,e,n,l,h){return ui((t-e)/(n-e)*(h-l)+l,l,h)},r.cf=Gp,r.cg=Zp,r.ch=class{constructor(t,e,n,l){this.context=t,this.format=l,this.size=n,this.texture=t.gl.createTexture();let[h,f,p]=this.size,{gl:v}=t;v.bindTexture(v.TEXTURE_3D,this.texture),t.pixelStoreUnpackFlipY.set(!1),t.pixelStoreUnpack.set(1),t.pixelStoreUnpackPremultiplyAlpha.set(!1);let y=this.format,w=v.UNSIGNED_BYTE;this.format===v.DEPTH_COMPONENT&&(y=v.DEPTH_COMPONENT16,w=v.UNSIGNED_SHORT),this.format===v.R8&&(l=v.RED),this.format===v.R32F&&(w=v.FLOAT,l=v.RED),v.texImage3D(v.TEXTURE_3D,0,y,h,f,p,0,l,w,e.data)}bind(t,e){let{context:n}=this,{gl:l}=n;l.bindTexture(l.TEXTURE_3D,this.texture),t!==this.minFilter&&(l.texParameteri(l.TEXTURE_3D,l.TEXTURE_MAG_FILTER,t),l.texParameteri(l.TEXTURE_3D,l.TEXTURE_MIN_FILTER,t),this.minFilter=t),e!==this.wrapS&&(l.texParameteri(l.TEXTURE_3D,l.TEXTURE_WRAP_S,e),l.texParameteri(l.TEXTURE_3D,l.TEXTURE_WRAP_T,e),this.wrapS=e)}destroy(){let{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}},r.ci=u2,r.cj=[1,1,1],r.ck=r0,r.cl=m0,r.cm=zf,r.cn=$m,r.co=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new hr(1/0,1/0),max:new hr(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(t,e=!1){let n=ZS(new hr(0,0),new hr(it,it),t),l=[];if(e&&!Nb(n,this._globalClipBounds))return l;for(let h of this._activeRegions){if(h.hiddenByOverlap||!Nb(n,h))continue;let f=fF(h.min,h.max,t);l.push({min:f.min,max:f.max,sourceId:this._sourceIds[h.priority],footprint:h.footprint,footprintTileId:h.tileId,order:h.order,clipMask:h.clipMask})}return l}setSources(t){this._setSources(t.map(e=>({getSourceId:()=>e.cache.id,getFootprints:()=>{let n=[];for(let l of e.cache.getVisibleCoordinates()){let h=e.cache.getTile(l).buckets[e.layer];h&&h.updateFootprints(l.toUnwrapped(),n)}return n},getOrder:()=>e.order,getClipMask:()=>e.clipMask})))}_addSource(t){let e=t.getFootprints();if(e.length===0)return;let n=t.getOrder(),l=t.getClipMask();for(let h of e){if(!h.footprint)continue;let f=ZS(h.footprint.min,h.footprint.max,h.id);this._activeRegions.push({min:f.min,max:f.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:h.id,footprint:h.footprint,order:n,clipMask:l})}this._sourceIds.push(t.getSourceId())}_computeReplacement(){this._activeRegions.sort((e,n)=>e.priority-n.priority||K1(e.min,n.min)||K1(e.max,n.max));let t=this._activeRegions.length!==this._prevRegions.length;if(!t){let e=0;for(;!t&&e!==this._activeRegions.length;){let n=this._activeRegions[e],l=this._prevRegions[e];t=n.priority!==l.priority||!XS(n,l)||n.order!==l.order||n.clipMask!==l.clipMask,++e}}if(t){++this._updateTime;for(let n of this._activeRegions)n.order!==1/0&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,n.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,n.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,n.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,n.max.y));let e=n=>{let l=this._activeRegions;if(n>=l.length)return n;let h=l[n].priority;for(;n<l.length&&l[n].priority===h;)++n;return n};if(this._sourceIds.length>1){let n=0,l=e(n);for(;n!==l;){let h=n,f=n;for(;h!==l;){let p=this._activeRegions[h];p.hiddenByOverlap=!1;for(let v=0;v<f;v++){let y=this._activeRegions[v];if(!y.hiddenByOverlap&&p.order===1/0&&Nb(p,y)&&(p.hiddenByOverlap=KS(p.footprint,p.tileId,y.footprint,y.tileId),p.hiddenByOverlap))break}++h}n=l,l=e(n)}}}}_setSources(t){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let e=t.length-1;e>=0;e--)this._addSource(t[e]);this._computeReplacement()}},r.cp=Lf,r.cq=yv,r.cr=Eg,r.cs=class{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(let t of this._poleSegments)t.destroy();for(let t of this._gridSegments)t.withSkirts.destroy(),t.withoutSkirts.destroy()}_fillGridMeshWithLods(t,e){let n=new Ju,l=new No,h=[],f=t+1+2,p=e[0]+1,v=e[0]+1+(1+e.length),y=(w,A,M)=>{let R=w===f-1?w-2:w===0?w:w-1;return R+=M?24575:0,[R,A]};for(let w=0;w<f;++w)n.emplaceBack(...y(w,0,!0));for(let w=0;w<p;++w)for(let A=0;A<f;++A)n.emplaceBack(...y(A,w,(A===0||A===f-1)&&!0));for(let w=0;w<e.length;++w){let A=e[w];for(let M=0;M<f;++M)n.emplaceBack(...y(M,A,!0))}for(let w=0;w<e.length;++w){let A=l.length,M=e[w]+1+2,R=new No;for(let q=0;q<M-1;q++){let Z=q===M-2,oe=Z?f*(v-e.length+w-q):f;for(let ye=0;ye<f-1;ye++){let be=q*f+ye;q===0||Z||ye===0||ye===f-2?(R.emplaceBack(be+1,be,be+oe),R.emplaceBack(be+oe,be+oe+1,be+1)):(l.emplaceBack(be+1,be,be+oe),l.emplaceBack(be+oe,be+oe+1,be+1))}}let N=ha.simpleSegment(0,A,n.length,l.length-A);for(let q=0;q<R.uint16.length;q+=3)l.emplaceBack(R.uint16[q],R.uint16[q+1],R.uint16[q+2]);let z=ha.simpleSegment(0,A,n.length,l.length-A);h.push({withoutSkirts:N,withSkirts:z})}return{vertices:n,indices:l,segments:h}}_createGrid(t){let e=this._fillGridMeshWithLods(Zm,hb);this._gridSegments=e.segments,this._gridBuffer=t.createVertexBuffer(e.vertices,Dg.members),this._gridIndexBuffer=t.createIndexBuffer(e.indices,!0)}_createPoles(t){let e=new No;for(let p=0;p<=Zm;p++)e.emplaceBack(0,p+1,p+2);this._poleIndexBuffer=t.createIndexBuffer(e,!0);let n=new Wp,l=new Wp,h=new Wp,f=new Wp;this._poleSegments=[];for(let p=0,v=0;p<ub;p++){let y=360/(1<<p);n.emplaceBack(0,-dl,0,.5,0),l.emplaceBack(0,-dl,0,.5,1),h.emplaceBack(0,-dl,0,.5,.5),f.emplaceBack(0,-dl,0,.5,.5);for(let w=0;w<=Zm;w++){let A=w/Zm,M=0,R=Xr(0,y,A),[N,z,q]=Ym(IR,kR,R,dl);n.emplaceBack(N,z,q,A,M),l.emplaceBack(N,z,q,A,1-M);let Z=Ai(R);A=.5+.5*Math.sin(Z),M=.5+.5*Math.cos(Z),h.emplaceBack(N,z,q,A,M),f.emplaceBack(N,z,q,A,1-M)}this._poleSegments.push(ha.simpleSegment(v,0,66,64)),v+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(n,z1,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(l,z1,!1),this._texturedPoleNorthVertexBuffer=t.createVertexBuffer(h,z1,!1),this._texturedPoleSouthVertexBuffer=t.createVertexBuffer(f,z1,!1)}getGridBuffers(t,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[t].withSkirts:this._gridSegments[t].withoutSkirts]}getPoleBuffers(t,e){return[e?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,e?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}},r.ct=function(t){return ol.has(t)},r.cu=sE,r.cv=function(t,e,n=0,l=!0){let h=new hr(n,n),f=t.sub(h),p=e.add(h),v=[f,new hr(p.x,f.y),p,new hr(f.x,p.y)];return l&&v.push(f.clone()),v},r.cw=function(t,e){let n=[];for(let l=0;l<t.length;l++){let h=ql(l-1,-1,t.length-1),f=ql(l+1,-1,t.length-1),p=t[l],v=t[f],y=t[h].sub(p).unit(),w=v.sub(p).unit(),A=w.angleWithSep(y.x,y.y),M=y.add(w).unit().mult(-1*e/Math.sin(A/2));n.push(p.add(M))}return n},r.cx=uA,r.cy=pS,r.cz=function(t,e,n=0){return r._.fromValues(((e.x-n)*t.scale-t.x)*it,(e.y*t.scale-t.y)*it,oS(e.z,e.y))},r.d=Mc,r.d$=Kc,r.d0=xc,r.d1=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},r.d2=Sl,r.d3=lS,r.d4=$p,r.d5=function([t,e,n]){let l=Math.hypot(t,e,n),h=Math.atan2(t,n),f=.5*Math.PI-Math.acos(-e/l);return new en(ka(h),ka(f))},r.d6=Nl,r.d7=Km,r.d8=E,r.d9=kb,r.dA=function(t){let e=xs();if(!e)return;let n=e.delete(Na);t&&n.catch(t).then(()=>t())},r.dB=t_,r.dC=WA,r.dD=function(t){g2=di.resolveURL(t),_0||(_0=new p2(Iv(),new Kl)),_0.broadcast("setDracoUrl",g2)},r.dE=qA,r.dF=function(t){g0=di.resolveURL(t),_0||(_0=new p2(Iv(),new Kl)),_0.broadcast("setMeshoptUrl",g0)},r.dG=lo,r.dH=Fe,r.dI=Hf,r.dJ=rh,r.dK=Jp,r.dL=nb,r.dM=RE,r.dN=zE,r.dO=EE,r.dP=Jc,r.dQ=tA,r.dR=d0,r.dS=function(t,e,n,l,h,f,p,v,y,w,A){t.createArrays(),t.tilePixelRatio=it/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;let M=t.layers[0].layout,R=t.layers[0]._unevaluatedLayout._values,N={};if(t.textSizeData.kind==="composite"){let{minZoom:oe,maxZoom:ye}=t.textSizeData;N.compositeTextSizes=[R["text-size"].possiblyEvaluate(new ni(oe),v),R["text-size"].possiblyEvaluate(new ni(ye),v)]}if(t.iconSizeData.kind==="composite"){let{minZoom:oe,maxZoom:ye}=t.iconSizeData;N.compositeIconSizes=[R["icon-size"].possiblyEvaluate(new ni(oe),v),R["icon-size"].possiblyEvaluate(new ni(ye),v)]}N.layoutTextSize=R["text-size"].possiblyEvaluate(new ni(y+1),v),N.layoutIconSize=R["icon-size"].possiblyEvaluate(new ni(y+1),v),N.textMaxSize=R["text-size"].possiblyEvaluate(new ni(18),v);let z=M.get("text-rotation-alignment")==="map"&&M.get("symbol-placement")!=="point",q=M.get("text-size"),Z=!1;for(let oe of t.features)if(oe.icon&&oe.icon.nameSecondary){Z=!0;break}for(let oe of t.features){let ye=M.get("text-font").evaluate(oe,{},v).join(","),be=q.evaluate(oe,{},v),we=N.layoutTextSize.evaluate(oe,{},v),$e=(N.layoutIconSize.evaluate(oe,{},v),{horizontal:{},vertical:void 0}),He=oe.text,rt,ot=[0,0];if(He){let At=He.toString(),zt=M.get("text-letter-spacing").evaluate(oe,{},v)*ls,Jt=M.get("text-line-height").evaluate(oe,{},v)*ls,Ot=Ct(At)?zt:0,Xt=M.get("text-anchor").evaluate(oe,{},v),Dt=M.get("text-variable-anchor");if(!Dt){let er=M.get("text-radial-offset").evaluate(oe,{},v);ot=er?oA(Xt,[er*ls,Xb]):M.get("text-offset").evaluate(oe,{},v).map(lr=>lr*ls)}let Zt=z?"center":M.get("text-justify").evaluate(oe,{},v),ir=M.get("symbol-placement")==="point",Kt=ir?M.get("text-max-width").evaluate(oe,{},v)*ls:1/0,Sr=er=>{t.allowVerticalPlacement&&bt(At)&&($e.vertical=Hb(He,e,n,h,ye,Kt,Jt,Xt,er,Ot,ot,jc.vertical,!0,we,be))};if(!z&&Dt){let er=Zt==="auto"?Dt.map(Zr=>Zb(Zr)):[Zt],lr=!1;for(let Zr=0;Zr<er.length;Zr++){let zr=er[Zr];if(!$e.horizontal[zr])if(lr)$e.horizontal[zr]=$e.horizontal[0];else{let Or=Hb(He,e,n,h,ye,Kt,Jt,"center",zr,Ot,ot,jc.horizontal,!1,we,be);Or&&($e.horizontal[zr]=Or,lr=Or.positionedLines.length===1)}}Sr("left")}else{if(Zt==="auto"&&(Zt=Zb(Xt)),ir||M.get("text-writing-mode").indexOf("horizontal")>=0||!bt(At)){let er=Hb(He,e,n,h,ye,Kt,Jt,Xt,Zt,Ot,ot,jc.horizontal,!1,we,be);er&&($e.horizontal[Zt]=er)}Sr(ir?"left":Zt)}}let _t=!1;if(oe.icon&&oe.icon.namePrimary){let At=l[oe.icon.namePrimary];At&&(rt=fP(h[oe.icon.namePrimary],oe.icon.nameSecondary?h[oe.icon.nameSecondary]:void 0,M.get("icon-offset").evaluate(oe,{},v),M.get("icon-anchor").evaluate(oe,{},v)),_t=At.sdf,t.sdfIcons===void 0?t.sdfIcons=At.sdf:t.sdfIcons!==At.sdf&&Wn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(At.pixelRatio!==t.pixelRatio||M.get("icon-rotate").constantOr(1)!==0)&&(t.iconsNeedLinear=!0))}let Mt=lA($e.horizontal)||$e.vertical;t.iconsInText||(t.iconsInText=!!Mt&&Mt.iconsInText),(Mt||rt)&&xP(t,oe,$e,rt,l,N,we,0,ot,_t,p,v,w,A,Z)}f&&t.generateCollisionDebugBuffers(y,t.collisionBoxArray)},r.dT=tv,r.dU=$1,r.dV=Ob,r.dW=a0,r.dX=J1,r.dY=o2,r.dZ=Z1,r.d_=X1,r.da=IS,r.db=function(t){let e=[0,0,0],n=r.ad.identity(new Float64Array(16));return r.ad.multiply(n,t.pixelMatrix,t.globeMatrix),r._.transformMat4(e,e,n),new hr(e[0],e[1])},r.dc=G,r.dd=ee,r.de=function(t){let e=t.navigator?t.navigator.userAgent:null;return!!function(n){if(ct==null){let l=n.navigator?n.navigator.userAgent:null;ct=!!n.safari||!(!l||!(/\b(iPad|iPhone|iPod)\b/.test(l)||l.match("Safari")&&!l.match("Chrome")))}return ct}(t)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},r.df=El,r.dg=class{constructor(t,e,n){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!n,this._createSkuToken()}_createSkuToken(){let t=function(){let e="";for(let n=0;n<10;n++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",bd,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!D(t))return t;let n=Ga(t);return n.params.push(`sdk=js-${_}`),n.path=`/styles/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!D(t))return t;let n=Ga(t);return n.path=`/fonts/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeModelURL(t,e){if(!D(t))return t;let n=Ga(t);return n.path=`/models/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeSourceURL(t,e,n,l){if(!D(t))return t;let h=Ga(t);return h.path=`/v4/${h.authority}.json`,h.params.push("secure"),n&&h.params.push(`language=${n}`),l&&h.params.push(`worldview=${l}`),this._makeAPIURL(h,this._customAccessToken||e)}normalizeSpriteURL(t,e,n,l){let h=Ga(t);return D(t)?(h.path=`/styles/v1${h.path}/sprite${e}${n}`,this._makeAPIURL(h,this._customAccessToken||l)):(h.path+=`${e}${n}`,Ho(h))}normalizeTileURL(t,e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!D(t))return t;let l=Ga(t);l.path=l.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||n&&l.authority!=="raster"&&n===512?"@2x":""}${tu.supported?".webp":"$1"}`),l.authority==="raster"?l.path=`/${E.RASTER_URL_PREFIX}${l.path}`:l.authority==="rasterarrays"?l.path=`/${E.RASTERARRAYS_URL_PREFIX}${l.path}`:l.authority==="3dtiles"?l.path=`/${E.TILES3D_URL_PREFIX}${l.path}`:(l.path=l.path.replace(/^.+\/v4\//,"/"),l.path=`/${E.TILE_URL_VERSION}${l.path}`);let h=this._customAccessToken||function(f){for(let p of f){let v=p.match(/^access_token=(.*)$/);if(v)return v[1]}return null}(l.params)||E.ACCESS_TOKEN;return E.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&l.params.push(`sku=${this._skuToken}`),this._makeAPIURL(l,h)}canonicalizeTileURL(t,e){let n=Ga(t);if(!n.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!n.path.match(/\.[\w]+$/))return t;let l="mapbox://";n.path.match(/^\/raster\/v1\//)?l+=`raster/${n.path.replace(`/${E.RASTER_URL_PREFIX}/`,"")}`:n.path.match(/^\/rasterarrays\/v1\//)?l+=`rasterarrays/${n.path.replace(`/${E.RASTERARRAYS_URL_PREFIX}/`,"")}`:l+=`tiles/${n.path.replace(`/${E.TILE_URL_VERSION}/`,"")}`;let h=n.params;return e&&(h=h.filter(f=>!f.match(/^access_token=/))),h.length&&(l+=`?${h.join("&")}`),l}canonicalizeTileset(t,e){let n=!!e&&D(e),l=[];for(let h of t.tiles||[])k(h)?l.push(this.canonicalizeTileURL(h,n)):l.push(h);return l}_makeAPIURL(t,e){let n="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",l=Ga(E.API_URL);if(t.protocol=l.protocol,t.authority=l.authority,t.protocol==="http"){let h=t.params.indexOf("secure");h>=0&&t.params.splice(h,1)}if(l.path!=="/"&&(t.path=`${l.path}${t.path}`),!E.REQUIRE_ACCESS_TOKEN)return Ho(t);if(e=e||E.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${n}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${n}`)}return t.params=t.params.filter(h=>h.indexOf("access_token")===-1),t.params.push(`access_token=${e||""}`),Ho(t)}},r.dh=function(t,e){e?ol.add(t):ol.delete(t)},r.di=tu,r.dj=Nu,r.dk=Yl,r.dl=wd,r.dm=Mh,r.dn=Ml,r.dp=function(t){ol.delete(t)},r.dq=Dl,r.dr=Zl,r.ds=bc,r.dt=_,r.du=function(t,e){Va=t,Io=e},r.dv=function(t,e,n=!1){if(Yt===dr||Yt===pr||Yt===Cr)throw new Error("setRTLTextPlugin cannot be called multiple times.");Nt=di.resolveURL(t),Yt=dr,mr=e,_i(),n||Xi()},r.dw=Di,r.dx=function(){Iv().acquire(m2)},r.dy=function(){let t=i_;t&&(t.isPreloaded()&&t.numActive()===1?(t.release(m2),i_=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},r.dz=r_,r.e=di,r.e0=FE,r.e1=J,r.e2=ho,r.e3=function(t){let e=0;if(new Uint32Array(t,0,1)[0]!==XA){let n=new Uint32Array(t,0,7),[,,l,h,f,p]=n;e=n.byteLength+h+f+p+f,(l!==t.byteLength||e>=t.byteLength)&&Wn("Invalid b3dm header information.")}return JA(t,e)},r.e4=function(t,e){let n=eC(t);for(let l of n){for(let h of l.meshes)PL(h);l.lights&&(l.lightMeshIndex=l.meshes.length,l.meshes.push(LL(l.lights,e)))}return n},r.e5=Rv,r.e6=HA,r.e7=_n,r.e8=function(t){zs(),la&&la.then(e=>{e.keys().then(n=>{for(let l=0;l<n.length-t;l++)e.delete(n[l])})})},r.f=Ha,r.g=function(t,e){return Cc(Ma(t,{type:"json"}),e)},r.h=nl,r.i=zc,r.j=eA,r.k=qb,r.l=function(t){return fetch(t).then(e=>e.arrayBuffer()).then(e=>JA(e,0,t))},r.m=class extends Av{},r.n=su,r.o=Fh,r.p=PP,r.q=Nd,r.r=m,r.s=s,r.t=X,r.u=Ll,r.v=Xo,r.w=Wn,r.x=de,r.y=ie,r.z=tc}),c(["./shared"],function(r){function _(te){let U=te?te.url.toString():void 0;return U?performance.getEntriesByName(U):[]}function T(te){if(typeof te=="number"||typeof te=="boolean"||typeof te=="string"||te==null)return JSON.stringify(te);if(Array.isArray(te)){let W="[";for(let Q of te)W+=`${T(Q)},`;return`${W}]`}let U="{";for(let W of Object.keys(te).sort())U+=`${W}:${T(te[W])},`;return`${U}}`}function E(te){let U="";for(let W of r.cE)U+=`/${T(te[W])}`;return U}class k{constructor(U){this.keyCache={},this._layers={},this._layerConfigs={},U&&this.replace(U)}replace(U,W){this._layerConfigs={},this._layers={},this.update(U,[],W)}update(U,W,Q){this._options=Q;for(let le of U)this._layerConfigs[le.id]=le,(this._layers[le.id]=r.cY(le,this.scope,null,this._options)).compileFilter(),this.keyCache[le.id]&&delete this.keyCache[le.id];for(let le of W)delete this.keyCache[le],delete this._layerConfigs[le],delete this._layers[le];this.familiesBySource={};let se=function(le,De){let Ze={};for(let We=0;We<le.length;We++){let nt=De&&De[le[We].id]||E(le[We]);De&&(De[le[We].id]=nt);let dt=Ze[nt];dt||(dt=Ze[nt]=[]),dt.push(le[We])}let ke=[];for(let We in Ze)ke.push(Ze[We]);return ke}(r.dG(this._layerConfigs),this.keyCache);for(let le of se){let De=le.map(Ft=>this._layers[Ft.id]),Ze=De[0];if(Ze.visibility==="none")continue;let ke=Ze.source||"",We=this.familiesBySource[ke];We||(We=this.familiesBySource[ke]={});let nt=Ze.sourceLayer||"_geojsonTileLayer",dt=We[nt];dt||(dt=We[nt]=[]),dt.push(De)}}}let D=1*r.dJ;class j{constructor(U){let W={},Q=[];for(let Ze in U){let ke=U[Ze],We=W[Ze]={};for(let nt in ke.glyphs){let dt=ke.glyphs[+nt];if(!dt||dt.bitmap.width===0||dt.bitmap.height===0)continue;let Ft=dt.metrics.localGlyph?D:1,tr={x:0,y:0,w:dt.bitmap.width+2*Ft,h:dt.bitmap.height+2*Ft};Q.push(tr),We[nt]=tr}}let{w:se,h:le}=r.j(Q),De=new r.dI({width:se||1,height:le||1});for(let Ze in U){let ke=U[Ze];for(let We in ke.glyphs){let nt=ke.glyphs[+We];if(!nt||nt.bitmap.width===0||nt.bitmap.height===0)continue;let dt=W[Ze][We],Ft=nt.metrics.localGlyph?D:1;r.dI.copy(nt.bitmap,De,{x:0,y:0},{x:dt.x+Ft,y:dt.y+Ft},nt.bitmap)}}this.image=De,this.positions=W}}r.dH(j,"GlyphAtlas");class B{constructor(U){this.tileID=new r.aL(U.tileID.overscaledZ,U.tileID.wrap,U.tileID.canonical.z,U.tileID.canonical.x,U.tileID.canonical.y),this.tileZoom=U.tileZoom,this.uid=U.uid,this.zoom=U.zoom,this.lut=U.lut,this.canonical=U.tileID.canonical,this.pixelRatio=U.pixelRatio,this.tileSize=U.tileSize,this.source=U.source,this.scope=U.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=U.showCollisionBoxes,this.collectResourceTiming=!!U.collectResourceTiming,this.promoteId=U.promoteId,this.isSymbolTile=U.isSymbolTile,this.tileTransform=r.dK(U.tileID.canonical,U.projection),this.projection=U.projection,this.brightness=U.brightness,this.extraShadowCaster=!!U.extraShadowCaster,this.tessellationStep=U.tessellationStep}parse(U,W,Q,se,le){this.status="parsing",this.data=U,this.collisionBoxArray=new r.dL;let De=new r.dM(Object.keys(U.layers).sort()),Ze=new r.dN(this.tileID,this.promoteId);Ze.bucketLayerIDs=[];let ke={},We=new r.dO(256,256),nt={featureIndex:Ze,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:We,availableImages:Q,brightness:this.brightness},dt=W.familiesBySource[this.source];for(let wr in dt){let Ei=U.layers[wr];if(!Ei)continue;let mi=!1,Ti=!1,An=!1;for(let Hn of dt[wr])Hn[0].type==="symbol"?mi=!0:Ti=!0,Hn[0].is3D()&&Hn[0].type!=="model"&&(An=!0);if(this.extraShadowCaster&&!An||this.isSymbolTile===!0&&!mi||this.isSymbolTile===!1&&!Ti)continue;Ei.version===1&&r.w(`Vector tile source "${this.source}" layer "${wr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);let ln=De.encode(wr),Rn=[];for(let Hn=0;Hn<Ei.length;Hn++){let fn=Ei.feature(Hn),Gl=Ze.getId(fn,wr);Rn.push({feature:fn,id:Gl,index:Hn,sourceLayerIndex:ln})}for(let Hn of dt[wr]){let fn=Hn[0];(!this.extraShadowCaster||fn.is3D()&&fn.type!=="model")&&(this.isSymbolTile!==void 0&&fn.type==="symbol"!==this.isSymbolTile||fn.minzoom&&this.zoom<Math.floor(fn.minzoom)||fn.maxzoom&&this.zoom>=fn.maxzoom||fn.visibility!=="none"&&(P(Hn,this.zoom,nt.brightness,Q),(ke[fn.id]=fn.createBucket({index:Ze.bucketLayerIDs.length,layers:Hn,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ln,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(Rn,nt,this.tileID.canonical,this.tileTransform),Ze.bucketLayerIDs.push(Hn.map(Gl=>Gl.id))))}}let Ft,tr,Qt,or;We.trim();let Ar={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},qr=()=>{if(Ft)return this.status="done",le(Ft);if(this.extraShadowCaster)this.status="done",le(null,{buckets:r.dG(ke).filter(wr=>!wr.isEmpty()),featureIndex:Ze,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:nt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(tr&&Qt&&or){let wr=new j(tr),Ei=new r.dQ(Qt,or,this.lut);for(let mi in ke){let Ti=ke[mi];Ti instanceof r.dR?(P(Ti.layers,this.zoom,nt.brightness,Q),r.dS(Ti,tr,wr.positions,Qt,Ei.iconPositions,this.showCollisionBoxes,Q,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):Ti.hasPattern&&(Ti instanceof r.dT||Ti instanceof r.dU||Ti instanceof r.b_)&&(P(Ti.layers,this.zoom,nt.brightness,Q),Ti.addFeatures(nt,this.tileID.canonical,Ei.patternPositions,Q,this.tileTransform,this.brightness))}this.status="done",le(null,{buckets:r.dG(ke).filter(mi=>!mi.isEmpty()),featureIndex:Ze,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:wr.image,lineAtlas:We,imageAtlas:Ei,brightness:nt.brightness})}};if(!this.extraShadowCaster){let wr=r.dP(nt.glyphDependencies,Ti=>Object.keys(Ti).map(Number));Object.keys(wr).length?se.send("getGlyphs",{uid:this.uid,stacks:wr,scope:this.scope},(Ti,An)=>{Ft||(Ft=Ti,tr=An,qr())},void 0,!1,Ar):tr={};let Ei=Object.keys(nt.iconDependencies);Ei.length?se.send("getImages",{icons:Ei,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Ti,An)=>{Ft||(Ft=Ti,Qt=An,qr())},void 0,!1,Ar):Qt={};let mi=Object.keys(nt.patternDependencies);mi.length?se.send("getImages",{icons:mi,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Ti,An)=>{Ft||(Ft=Ti,or=An,qr())},void 0,!1,Ar):or={}}qr()}}function P(te,U,W,Q){let se=new r.X(U,{brightness:W});for(let le of te)le.recalculate(se,Q)}class ee extends r.E{constructor(U,W,Q,se,le,De){super(),this.actor=U,this.layerIndex=W,this.availableImages=Q,this.loadVectorData=le||r.ap,this.loading={},this.loaded={},this.deduped=new r.ao(U.scheduler),this.isSpriteLoaded=se,this.scheduler=U.scheduler,this.brightness=De}loadTile(U,W){let Q=U.uid,se=U&&U.request,le=se&&se.collectResourceTiming,De=this.loading[Q]=new B(U);De.abort=this.loadVectorData(U,(Ze,ke)=>{let We=!this.loading[Q];if(delete this.loading[Q],We||Ze||!ke)return De.status="done",We||(this.loaded[Q]=De),W(Ze);let nt=ke.rawData,dt={};ke.expires&&(dt.expires=ke.expires),ke.cacheControl&&(dt.cacheControl=ke.cacheControl),De.vectorTile=ke.vectorTile||new r.dV(new r.dW(nt));let Ft=()=>{De.parse(De.vectorTile,this.layerIndex,this.availableImages,this.actor,(tr,Qt)=>{if(tr||!Qt)return W(tr);let or={};if(le){let Ar=_(se);Ar.length>0&&(or.resourceTiming=JSON.parse(JSON.stringify(Ar)))}W(null,r.W({rawTileData:nt.slice(0)},Qt,dt,or))})};this.isSpriteLoaded?Ft():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Ft,{type:"parseTile",isSymbolTile:U.isSymbolTile,zoom:U.tileZoom}):Ft()}),this.loaded=this.loaded||{},this.loaded[Q]=De})}reloadTile(U,W){let Q=this.loaded,se=U.uid;if(Q&&Q[se]){let le=Q[se];le.showCollisionBoxes=U.showCollisionBoxes,le.projection=U.projection,le.brightness=U.brightness,le.tileTransform=r.dK(U.tileID.canonical,U.projection),le.extraShadowCaster=U.extraShadowCaster,le.lut=U.lut;let De=(Ze,ke)=>{let We=le.reloadCallback;We&&(delete le.reloadCallback,le.parse(le.vectorTile,this.layerIndex,this.availableImages,this.actor,We)),W(Ze,ke)};le.status==="parsing"?le.reloadCallback=De:le.status==="done"&&(le.vectorTile?le.parse(le.vectorTile,this.layerIndex,this.availableImages,this.actor,De):De())}else W(null,void 0)}abortTile(U,W){let Q=U.uid,se=this.loading[Q];se&&(se.abort&&se.abort(),delete this.loading[Q]),W()}removeTile(U,W){let Q=this.loaded,se=U.uid;Q&&Q[se]&&delete Q[se],W()}}class G{loadTile(U,W){let{uid:Q,encoding:se,rawImageData:le,padding:De}=U,Ze=ImageBitmap&&le instanceof ImageBitmap?this.getImageData(le,De):le;W(null,new r.dX(Q,Ze,se,De<1))}getImageData(U,W){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(U.width,U.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=U.width,this.offscreenCanvas.height=U.height,this.offscreenCanvasContext.drawImage(U,0,0,U.width,U.height);let Q=this.offscreenCanvasContext.getImageData(-W,-W,U.width+2*W,U.height+2*W);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Q}}class K{decodeRasterArray({task:U,buffer:W},Q){r.dY.performDecoding(W,U).then(se=>{Q(null,se)},se=>{Q(se)})}}let J=r.dZ.prototype.toGeoJSON,ne=class{constructor(te){this._feature=te,this.extent=r.a3,this.type=te.type,this.properties=te.tags,"id"in te&&!isNaN(te.id)&&(this.id=parseInt(te.id,10))}loadGeometry(){if(this._feature.type===1){let te=[];for(let U of this._feature.geometry)te.push([new r.P(U[0],U[1])]);return te}{let te=[];for(let U of this._feature.geometry){let W=[];for(let Q of U)W.push(new r.P(Q[0],Q[1]));te.push(W)}return te}}toGeoJSON(te,U,W){return J.call(this,te,U,W)}},he=class{constructor(te){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=r.a3,this.length=te.length,this._features=te}feature(te){return new ne(this._features[te])}},Me=64/4096;class Re{constructor(){this.features=new Map}clear(){this.features.clear()}load(U=[],W){for(let Q of U){let se=Q.id;if(se==null)continue;let le=this.features.get(se);le&&this.updateCache(le,W),Q.geometry?(le=Te(Q),this.updateCache(le,W),this.features.set(se,le)):this.features.delete(se),this.updateCache(le,W)}}updateCache(U,W){for(let{canonical:Q,uid:se}of Object.values(W)){let{z:le,x:De,y:Ze}=Q;et(U,Math.pow(2,le),De,Ze)&&delete W[se]}}getTile(U,W,Q){let se=Math.pow(2,U),le=[];for(let De of this.features.values())et(De,se,W,Q)&&le.push(_e(De,se,W,Q));return{features:le}}getFeatures(){return[...this.features.values()]}}function et({minX:te,minY:U,maxX:W,maxY:Q},se,le,De){return te<(le+1+Me)/se&&U<(De+1+Me)/se&&W>(le-Me)/se&&Q>(De-Me)/se}function Te(te){let{id:U,geometry:W,properties:Q}=te;if(!W)return;if(W.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");let{type:se,coordinates:le}=W,De={id:U,type:1,geometry:[],tags:Q,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},Ze=De.geometry;if(se==="Point")ge(le,Ze,De);else if(se==="MultiPoint")for(let ke of le)ge(ke,Ze,De);else if(se==="LineString")De.type=2,Ue(le,Ze,De);else if(se==="MultiLineString")De.type=2,Ae(le,Ze,De);else if(se==="Polygon")De.type=3,Ae(le,Ze,De,!0);else{if(se!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");De.type=3;for(let ke of le)Ae(ke,Ze,De,!0)}return De}function ge([te,U],W,Q){let se=r.aj(te),le=r.ak(U);le=le<0?0:le>1?1:le,W.push(se,le),Q.minX=Math.min(Q.minX,se),Q.minY=Math.min(Q.minY,le),Q.maxX=Math.max(Q.maxX,se),Q.maxY=Math.max(Q.maxY,le)}function Ue(te,U,W,Q=!1,se=!1){let le=[];for(let De of te)ge(De,le,W);U.push(le),Q&&function(De,Ze){let ke=0;for(let We=0,nt=De.length,dt=nt-2;We<nt;dt=We,We+=2)ke+=(De[We]-De[dt])*(De[We+1]+De[dt+1]);if(ke>0===Ze)for(let We=0,nt=De.length;We<nt/2;We+=2){let dt=De[We],Ft=De[We+1];De[We]=De[nt-2-We],De[We+1]=De[nt-1-We],De[nt-2-We]=dt,De[nt-1-We]=Ft}}(le,se)}function Ae(te,U,W,Q=!1){for(let se=0;se<te.length;se++)Ue(te[se],U,W,Q,se===0)}function _e(te,U,W,Q){let{id:se,type:le,geometry:De,tags:Ze}=te,ke=[];if(le===1)ve(De,U,W,Q,ke);else for(let We of De)ke.push(ve(We,U,W,Q));return{id:se,type:le,geometry:ke,tags:Ze}}function ve(te,U,W,Q,se=[]){for(let le=0;le<te.length;le+=2)se.push(Qe(te[le],te[le+1],U,W,Q));return se}function Qe(te,U,W,Q,se){return[Math.round(r.a3*(te*W-Q)),Math.round(r.a3*(U*W-se))]}var Ce={exports:{}},Ye=r.d$,ut=r.d_.VectorTileFeature,st=pt;function pt(te,U){this.options=U||{},this.features=te,this.length=te.length}function Tt(te,U){this.id=typeof te.id=="number"?te.id:void 0,this.type=te.type,this.rawGeometry=te.type===1?[te.geometry]:te.geometry,this.properties=te.tags,this.extent=U||4096}pt.prototype.feature=function(te){return new Tt(this.features[te],this.options.extent)},Tt.prototype.loadGeometry=function(){var te=this.rawGeometry;this.geometry=[];for(var U=0;U<te.length;U++){for(var W=te[U],Q=[],se=0;se<W.length;se++)Q.push(new Ye(W[se][0],W[se][1]));this.geometry.push(Q)}return this.geometry},Tt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var te=this.geometry,U=1/0,W=-1/0,Q=1/0,se=-1/0,le=0;le<te.length;le++)for(var De=te[le],Ze=0;Ze<De.length;Ze++){var ke=De[Ze];U=Math.min(U,ke.x),W=Math.max(W,ke.x),Q=Math.min(Q,ke.y),se=Math.max(se,ke.y)}return[U,Q,W,se]},Tt.prototype.toGeoJSON=ut.prototype.toGeoJSON;var ht=r.e0,Wt=st;function re(te){var U=new ht;return function(W,Q){for(var se in W.layers)Q.writeMessage(3,xe,W.layers[se])}(te,U),U.finish()}function xe(te,U){var W;U.writeVarintField(15,te.version||1),U.writeStringField(1,te.name||""),U.writeVarintField(5,te.extent||4096);var Q={keys:[],values:[],keycache:{},valuecache:{}};for(W=0;W<te.length;W++)Q.feature=te.feature(W),U.writeMessage(2,pe,Q);var se=Q.keys;for(W=0;W<se.length;W++)U.writeStringField(3,se[W]);var le=Q.values;for(W=0;W<le.length;W++)U.writeMessage(4,wt,le[W])}function pe(te,U){var W=te.feature;W.id!==void 0&&U.writeVarintField(1,W.id),U.writeMessage(2,Ie,te),U.writeVarintField(3,W.type),U.writeMessage(4,mt,W)}function Ie(te,U){var W=te.feature,Q=te.keys,se=te.values,le=te.keycache,De=te.valuecache;for(var Ze in W.properties){var ke=W.properties[Ze],We=le[Ze];if(ke!==null){We===void 0&&(Q.push(Ze),le[Ze]=We=Q.length-1),U.writeVarint(We);var nt=typeof ke;nt!=="string"&&nt!=="boolean"&&nt!=="number"&&(ke=JSON.stringify(ke));var dt=nt+":"+ke,Ft=De[dt];Ft===void 0&&(se.push(ke),De[dt]=Ft=se.length-1),U.writeVarint(Ft)}}}function Ve(te,U){return(U<<3)+(7&te)}function gt(te){return te<<1^te>>31}function mt(te,U){for(var W=te.loadGeometry(),Q=te.type,se=0,le=0,De=W.length,Ze=0;Ze<De;Ze++){var ke=W[Ze],We=1;Q===1&&(We=ke.length),U.writeVarint(Ve(1,We));for(var nt=Q===3?ke.length-1:ke.length,dt=0;dt<nt;dt++){dt===1&&Q!==1&&U.writeVarint(Ve(2,nt-1));var Ft=ke[dt].x-se,tr=ke[dt].y-le;U.writeVarint(gt(Ft)),U.writeVarint(gt(tr)),se+=Ft,le+=tr}Q===3&&U.writeVarint(Ve(7,1))}}function wt(te,U){var W=typeof te;W==="string"?U.writeStringField(1,te):W==="boolean"?U.writeBooleanField(7,te):W==="number"&&(te%1!=0?U.writeDoubleField(3,te):te<0?U.writeSVarintField(6,te):U.writeVarintField(5,te))}Ce.exports=re,Ce.exports.fromVectorTileJs=re,Ce.exports.fromGeojsonVt=function(te,U){U=U||{};var W={};for(var Q in te)W[Q]=new Wt(te[Q].features,U),W[Q].name=Q,W[Q].version=U.version,W[Q].extent=U.extent;return re({layers:W})},Ce.exports.GeoJSONWrapper=Wt;var Pt=r.e1(Ce.exports);let fr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:te=>te},xr=Math.fround||(Rr=new Float32Array(1),te=>(Rr[0]=+te,Rr[0]));var Rr;let Fr=3,$t=5,lt=6;class Bt{constructor(U){this.options=Object.assign(Object.create(fr),U),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(U){let{log:W,minZoom:Q,maxZoom:se}=this.options;W&&console.time("total time");let le=`prepare ${U.length} points`;W&&console.time(le),this.points=U;let De=[];for(let ke=0;ke<U.length;ke++){let We=U[ke];if(!We.geometry)continue;let[nt,dt]=We.geometry.coordinates,Ft=xr(kr(nt)),tr=xr(Nr(dt));De.push(Ft,tr,1/0,ke,-1,1),this.options.reduce&&De.push(0)}let Ze=this.trees[se+1]=this._createTree(De);W&&console.timeEnd(le);for(let ke=se;ke>=Q;ke--){let We=+Date.now();Ze=this.trees[ke]=this._createTree(this._cluster(Ze,ke)),W&&console.log("z%d: %d clusters in %dms",ke,Ze.numItems,+Date.now()-We)}return W&&console.timeEnd("total time"),this}getClusters(U,W){let Q=((U[0]+180)%360+360)%360-180,se=Math.max(-90,Math.min(90,U[1])),le=U[2]===180?180:((U[2]+180)%360+360)%360-180,De=Math.max(-90,Math.min(90,U[3]));if(U[2]-U[0]>=360)Q=-180,le=180;else if(Q>le){let dt=this.getClusters([Q,se,180,De],W),Ft=this.getClusters([-180,se,le,De],W);return dt.concat(Ft)}let Ze=this.trees[this._limitZoom(W)],ke=Ze.range(kr(Q),Nr(De),kr(le),Nr(se)),We=Ze.data,nt=[];for(let dt of ke){let Ft=this.stride*dt;nt.push(We[Ft+$t]>1?nr(We,Ft,this.clusterProps):this.points[We[Ft+Fr]])}return nt}getChildren(U){let W=this._getOriginId(U),Q=this._getOriginZoom(U),se="No cluster with the specified id.",le=this.trees[Q];if(!le)throw new Error(se);let De=le.data;if(W*this.stride>=De.length)throw new Error(se);let Ze=this.options.radius/(this.options.extent*Math.pow(2,Q-1)),ke=le.within(De[W*this.stride],De[W*this.stride+1],Ze),We=[];for(let nt of ke){let dt=nt*this.stride;De[dt+4]===U&&We.push(De[dt+$t]>1?nr(De,dt,this.clusterProps):this.points[De[dt+Fr]])}if(We.length===0)throw new Error(se);return We}getLeaves(U,W,Q){let se=[];return this._appendLeaves(se,U,W=W||10,Q=Q||0,0),se}getTile(U,W,Q){let se=this.trees[this._limitZoom(U)],le=Math.pow(2,U),{extent:De,radius:Ze}=this.options,ke=Ze/De,We=(Q-ke)/le,nt=(Q+1+ke)/le,dt={features:[]};return this._addTileFeatures(se.range((W-ke)/le,We,(W+1+ke)/le,nt),se.data,W,Q,le,dt),W===0&&this._addTileFeatures(se.range(1-ke/le,We,1,nt),se.data,le,Q,le,dt),W===le-1&&this._addTileFeatures(se.range(0,We,ke/le,nt),se.data,-1,Q,le,dt),dt.features.length?dt:null}getClusterExpansionZoom(U){let W=this._getOriginZoom(U)-1;for(;W<=this.options.maxZoom;){let Q=this.getChildren(U);if(W++,Q.length!==1)break;U=Q[0].properties.cluster_id}return W}_appendLeaves(U,W,Q,se,le){let De=this.getChildren(W);for(let Ze of De){let ke=Ze.properties;if(ke&&ke.cluster?le+ke.point_count<=se?le+=ke.point_count:le=this._appendLeaves(U,ke.cluster_id,Q,se,le):le<se?le++:U.push(Ze),U.length===Q)break}return le}_createTree(U){let W=new r.cK(U.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Q=0;Q<U.length;Q+=this.stride)W.add(U[Q],U[Q+1]);return W.finish(),W.data=U,W}_addTileFeatures(U,W,Q,se,le,De){for(let Ze of U){let ke=Ze*this.stride,We=W[ke+$t]>1,nt,dt,Ft;if(We)nt=br(W,ke,this.clusterProps),dt=W[ke],Ft=W[ke+1];else{let or=this.points[W[ke+Fr]];nt=or.properties;let[Ar,qr]=or.geometry.coordinates;dt=kr(Ar),Ft=Nr(qr)}let tr={type:1,geometry:[[Math.round(this.options.extent*(dt*le-Q)),Math.round(this.options.extent*(Ft*le-se))]],tags:nt},Qt;Qt=We||this.options.generateId?W[ke+Fr]:this.points[W[ke+Fr]].id,Qt!==void 0&&(tr.id=Qt),De.features.push(tr)}}_limitZoom(U){return Math.max(this.options.minZoom,Math.min(Math.floor(+U),this.options.maxZoom+1))}_cluster(U,W){let{radius:Q,extent:se,reduce:le,minPoints:De}=this.options,Ze=Q/(se*Math.pow(2,W)),ke=U.data,We=[],nt=this.stride;for(let dt=0;dt<ke.length;dt+=nt){if(ke[dt+2]<=W)continue;ke[dt+2]=W;let Ft=ke[dt],tr=ke[dt+1],Qt=U.within(ke[dt],ke[dt+1],Ze),or=ke[dt+$t],Ar=or;for(let qr of Qt){let wr=qr*nt;ke[wr+2]>W&&(Ar+=ke[wr+$t])}if(Ar>or&&Ar>=De){let qr,wr=Ft*or,Ei=tr*or,mi=-1,Ti=(dt/nt<<5)+(W+1)+this.points.length;for(let An of Qt){let ln=An*nt;if(ke[ln+2]<=W)continue;ke[ln+2]=W;let Rn=ke[ln+$t];wr+=ke[ln]*Rn,Ei+=ke[ln+1]*Rn,ke[ln+4]=Ti,le&&(qr||(qr=this._map(ke,dt,!0),mi=this.clusterProps.length,this.clusterProps.push(qr)),le(qr,this._map(ke,ln)))}ke[dt+4]=Ti,We.push(wr/Ar,Ei/Ar,1/0,Ti,-1,Ar),le&&We.push(mi)}else{for(let qr=0;qr<nt;qr++)We.push(ke[dt+qr]);if(Ar>1)for(let qr of Qt){let wr=qr*nt;if(!(ke[wr+2]<=W)){ke[wr+2]=W;for(let Ei=0;Ei<nt;Ei++)We.push(ke[wr+Ei])}}}}return We}_getOriginId(U){return U-this.points.length>>5}_getOriginZoom(U){return(U-this.points.length)%32}_map(U,W,Q){if(U[W+$t]>1){let De=this.clusterProps[U[W+lt]];return Q?Object.assign({},De):De}let se=this.points[U[W+Fr]].properties,le=this.options.map(se);return Q&&le===se?Object.assign({},le):le}}function nr(te,U,W){return{type:"Feature",id:te[U+Fr],properties:br(te,U,W),geometry:{type:"Point",coordinates:[(Q=te[U],360*(Q-.5)),Br(te[U+1])]}};var Q}function br(te,U,W){let Q=te[U+$t],se=Q>=1e4?`${Math.round(Q/1e3)}k`:Q>=1e3?Math.round(Q/100)/10+"k":Q,le=te[U+lt],De=le===-1?{}:Object.assign({},W[le]);return Object.assign(De,{cluster:!0,cluster_id:te[U+Fr],point_count:Q,point_count_abbreviated:se})}function kr(te){return te/360+.5}function Nr(te){let U=Math.sin(te*Math.PI/180),W=.5-.25*Math.log((1+U)/(1-U))/Math.PI;return W<0?0:W>1?1:W}function Br(te){let U=(180-360*te)*Math.PI/180;return 360*Math.atan(Math.exp(U))/Math.PI-90}function ii(te,U,W,Q){let se=Q,le=U+(W-U>>1),De,Ze=W-U,ke=te[U],We=te[U+1],nt=te[W],dt=te[W+1];for(let Ft=U+3;Ft<W;Ft+=3){let tr=si(te[Ft],te[Ft+1],ke,We,nt,dt);if(tr>se)De=Ft,se=tr;else if(tr===se){let Qt=Math.abs(Ft-le);Qt<Ze&&(De=Ft,Ze=Qt)}}se>Q&&(De-U>3&&ii(te,U,De,Q),te[De+2]=se,W-De>3&&ii(te,De,W,Q))}function si(te,U,W,Q,se,le){let De=se-W,Ze=le-Q;if(De!==0||Ze!==0){let ke=((te-W)*De+(U-Q)*Ze)/(De*De+Ze*Ze);ke>1?(W=se,Q=le):ke>0&&(W+=De*ke,Q+=Ze*ke)}return De=te-W,Ze=U-Q,De*De+Ze*Ze}function wi(te,U,W,Q){let se={id:te??null,type:U,geometry:W,tags:Q,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(U==="Point"||U==="MultiPoint"||U==="LineString")Ri(se,W);else if(U==="Polygon")Ri(se,W[0]);else if(U==="MultiLineString")for(let le of W)Ri(se,le);else if(U==="MultiPolygon")for(let le of W)Ri(se,le[0]);return se}function Ri(te,U){for(let W=0;W<U.length;W+=3)te.minX=Math.min(te.minX,U[W]),te.minY=Math.min(te.minY,U[W+1]),te.maxX=Math.max(te.maxX,U[W]),te.maxY=Math.max(te.maxY,U[W+1])}function Ji(te,U,W,Q){if(!U.geometry)return;let se=U.geometry.coordinates;if(se&&se.length===0)return;let le=U.geometry.type,De=Math.pow(W.tolerance/((1<<W.maxZoom)*W.extent),2),Ze=[],ke=U.id;if(W.promoteId?ke=U.properties[W.promoteId]:W.generateId&&(ke=Q||0),le==="Point")an(se,Ze);else if(le==="MultiPoint")for(let We of se)an(We,Ze);else if(le==="LineString")xi(se,Ze,De,!1);else if(le==="MultiLineString"){if(W.lineMetrics){for(let We of se)Ze=[],xi(We,Ze,De,!1),te.push(wi(ke,"LineString",Ze,U.properties));return}Ui(se,Ze,De,!1)}else if(le==="Polygon")Ui(se,Ze,De,!0);else{if(le!=="MultiPolygon"){if(le==="GeometryCollection"){for(let We of U.geometry.geometries)Ji(te,{id:ke,geometry:We,properties:U.properties},W,Q);return}throw new Error("Input data is not a valid GeoJSON object.")}for(let We of se){let nt=[];Ui(We,nt,De,!0),Ze.push(nt)}}te.push(wi(ke,le,Ze,U.properties))}function an(te,U){U.push(Lr(te[0]),Ua(te[1]),0)}function xi(te,U,W,Q){let se,le,De=0;for(let ke=0;ke<te.length;ke++){let We=Lr(te[ke][0]),nt=Ua(te[ke][1]);U.push(We,nt,0),ke>0&&(De+=Q?(se*nt-We*le)/2:Math.sqrt(Math.pow(We-se,2)+Math.pow(nt-le,2))),se=We,le=nt}let Ze=U.length-3;U[2]=1,ii(U,0,Ze,W),U[Ze+2]=1,U.size=Math.abs(De),U.start=0,U.end=U.size}function Ui(te,U,W,Q){for(let se=0;se<te.length;se++){let le=[];xi(te[se],le,W,Q),U.push(le)}}function Lr(te){return te/360+.5}function Ua(te){let U=Math.sin(te*Math.PI/180),W=.5-.25*Math.log((1+U)/(1-U))/Math.PI;return W<0?0:W>1?1:W}function Dr(te,U,W,Q,se,le,De,Ze){if(Q/=U,le>=(W/=U)&&De<Q)return te;if(De<W||le>=Q)return null;let ke=[];for(let We of te){let nt=We.geometry,dt=We.type,Ft=se===0?We.minX:We.minY,tr=se===0?We.maxX:We.maxY;if(Ft>=W&&tr<Q){ke.push(We);continue}if(tr<W||Ft>=Q)continue;let Qt=[];if(dt==="Point"||dt==="MultiPoint")Eo(nt,Qt,W,Q,se);else if(dt==="LineString")gi(nt,Qt,W,Q,se,!1,Ze.lineMetrics);else if(dt==="MultiLineString")Ao(nt,Qt,W,Q,se,!1);else if(dt==="Polygon")Ao(nt,Qt,W,Q,se,!0);else if(dt==="MultiPolygon")for(let or of nt){let Ar=[];Ao(or,Ar,W,Q,se,!0),Ar.length&&Qt.push(Ar)}if(Qt.length){if(Ze.lineMetrics&&dt==="LineString"){for(let or of Qt)ke.push(wi(We.id,dt,or,We.tags));continue}dt!=="LineString"&&dt!=="MultiLineString"||(Qt.length===1?(dt="LineString",Qt=Qt[0]):dt="MultiLineString"),dt!=="Point"&&dt!=="MultiPoint"||(dt=Qt.length===3?"Point":"MultiPoint"),ke.push(wi(We.id,dt,Qt,We.tags))}}return ke.length?ke:null}function Eo(te,U,W,Q,se){for(let le=0;le<te.length;le+=3){let De=te[le+se];De>=W&&De<=Q&&Qi(U,te[le],te[le+1],te[le+2])}}function gi(te,U,W,Q,se,le,De){let Ze=Dn(te),ke=se===0?_o:Gn,We,nt,dt=te.start;for(let Ar=0;Ar<te.length-3;Ar+=3){let qr=te[Ar],wr=te[Ar+1],Ei=te[Ar+2],mi=te[Ar+3],Ti=te[Ar+4],An=se===0?qr:wr,ln=se===0?mi:Ti,Rn=!1;De&&(We=Math.sqrt(Math.pow(qr-mi,2)+Math.pow(wr-Ti,2))),An<W?ln>W&&(nt=ke(Ze,qr,wr,mi,Ti,W),De&&(Ze.start=dt+We*nt)):An>Q?ln<Q&&(nt=ke(Ze,qr,wr,mi,Ti,Q),De&&(Ze.start=dt+We*nt)):Qi(Ze,qr,wr,Ei),ln<W&&An>=W&&(nt=ke(Ze,qr,wr,mi,Ti,W),Rn=!0),ln>Q&&An<=Q&&(nt=ke(Ze,qr,wr,mi,Ti,Q),Rn=!0),!le&&Rn&&(De&&(Ze.end=dt+We*nt),U.push(Ze),Ze=Dn(te)),De&&(dt+=We)}let Ft=te.length-3,tr=te[Ft],Qt=te[Ft+1],or=se===0?tr:Qt;or>=W&&or<=Q&&Qi(Ze,tr,Qt,te[Ft+2]),Ft=Ze.length-3,le&&Ft>=3&&(Ze[Ft]!==Ze[0]||Ze[Ft+1]!==Ze[1])&&Qi(Ze,Ze[0],Ze[1],Ze[2]),Ze.length&&U.push(Ze)}function Dn(te){let U=[];return U.size=te.size,U.start=te.start,U.end=te.end,U}function Ao(te,U,W,Q,se,le){for(let De of te)gi(De,U,W,Q,se,le,!1)}function Qi(te,U,W,Q){te.push(U,W,Q)}function _o(te,U,W,Q,se,le){let De=(le-U)/(Q-U);return Qi(te,le,W+(se-W)*De,1),De}function Gn(te,U,W,Q,se,le){let De=(le-W)/(se-W);return Qi(te,U+(Q-U)*De,le,1),De}function oo(te,U){let W=[];for(let Q=0;Q<te.length;Q++){let se=te[Q],le=se.type,De;if(le==="Point"||le==="MultiPoint"||le==="LineString")De=Co(se.geometry,U);else if(le==="MultiLineString"||le==="Polygon"){De=[];for(let Ze of se.geometry)De.push(Co(Ze,U))}else if(le==="MultiPolygon"){De=[];for(let Ze of se.geometry){let ke=[];for(let We of Ze)ke.push(Co(We,U));De.push(ke)}}W.push(wi(se.id,le,De,se.tags))}return W}function Co(te,U){let W=[];W.size=te.size,te.start!==void 0&&(W.start=te.start,W.end=te.end);for(let Q=0;Q<te.length;Q+=3)W.push(te[Q]+U,te[Q+1],te[Q+2]);return W}function Cn(te,U){if(te.transformed)return te;let W=1<<te.z,Q=te.x,se=te.y;for(let le of te.features){let De=le.geometry,Ze=le.type;if(le.geometry=[],Ze===1)for(let ke=0;ke<De.length;ke+=2)le.geometry.push(ki(De[ke],De[ke+1],U,W,Q,se));else for(let ke=0;ke<De.length;ke++){let We=[];for(let nt=0;nt<De[ke].length;nt+=2)We.push(ki(De[ke][nt],De[ke][nt+1],U,W,Q,se));le.geometry.push(We)}}return te.transformed=!0,te}function ki(te,U,W,Q,se,le){return[Math.round(W*(te*Q-se)),Math.round(W*(U*Q-le))]}function yn(te,U,W,Q,se){let le=U===se.maxZoom?0:se.tolerance/((1<<U)*se.extent),De={features:[],numPoints:0,numSimplified:0,numFeatures:te.length,source:null,x:W,y:Q,z:U,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(let Ze of te)ms(De,Ze,le,se);return De}function ms(te,U,W,Q){let se=U.geometry,le=U.type,De=[];if(te.minX=Math.min(te.minX,U.minX),te.minY=Math.min(te.minY,U.minY),te.maxX=Math.max(te.maxX,U.maxX),te.maxY=Math.max(te.maxY,U.maxY),le==="Point"||le==="MultiPoint")for(let Ze=0;Ze<se.length;Ze+=3)De.push(se[Ze],se[Ze+1]),te.numPoints++,te.numSimplified++;else if(le==="LineString")On(De,se,te,W,!1,!1);else if(le==="MultiLineString"||le==="Polygon")for(let Ze=0;Ze<se.length;Ze++)On(De,se[Ze],te,W,le==="Polygon",Ze===0);else if(le==="MultiPolygon")for(let Ze=0;Ze<se.length;Ze++){let ke=se[Ze];for(let We=0;We<ke.length;We++)On(De,ke[We],te,W,!0,We===0)}if(De.length){let Ze=U.tags||null;if(le==="LineString"&&Q.lineMetrics){Ze={};for(let We in U.tags)Ze[We]=U.tags[We];Ze.mapbox_clip_start=se.start/se.size,Ze.mapbox_clip_end=se.end/se.size}let ke={geometry:De,type:le==="Polygon"||le==="MultiPolygon"?3:le==="LineString"||le==="MultiLineString"?2:1,tags:Ze};U.id!==null&&(ke.id=U.id),te.features.push(ke)}}function On(te,U,W,Q,se,le){let De=Q*Q;if(Q>0&&U.size<(se?De:Q))return void(W.numPoints+=U.length/3);let Ze=[];for(let ke=0;ke<U.length;ke+=3)(Q===0||U[ke+2]>De)&&(W.numSimplified++,Ze.push(U[ke],U[ke+1])),W.numPoints++;se&&function(ke,We){let nt=0;for(let dt=0,Ft=ke.length,tr=Ft-2;dt<Ft;tr=dt,dt+=2)nt+=(ke[dt]-ke[tr])*(ke[dt+1]+ke[tr+1]);if(nt>0===We)for(let dt=0,Ft=ke.length;dt<Ft/2;dt+=2){let tr=ke[dt],Qt=ke[dt+1];ke[dt]=ke[Ft-2-dt],ke[dt+1]=ke[Ft-1-dt],ke[Ft-2-dt]=tr,ke[Ft-1-dt]=Qt}}(Ze,le),te.push(Ze)}let vo={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Oa{constructor(U,W){let Q=(W=this.options=function(le,De){for(let Ze in De)le[Ze]=De[Ze];return le}(Object.create(vo),W)).debug;if(Q&&console.time("preprocess data"),W.maxZoom<0||W.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(W.promoteId&&W.generateId)throw new Error("promoteId and generateId cannot be used together.");let se=function(le,De){let Ze=[];if(le.type==="FeatureCollection")for(let ke=0;ke<le.features.length;ke++)Ji(Ze,le.features[ke],De,ke);else Ji(Ze,le.type==="Feature"?le:{geometry:le},De);return Ze}(U,W);this.tiles={},this.tileCoords=[],Q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",W.indexMaxZoom,W.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),se=function(le,De){let Ze=De.buffer/De.extent,ke=le,We=Dr(le,1,-1-Ze,Ze,0,-1,2,De),nt=Dr(le,1,1-Ze,2+Ze,0,-1,2,De);return(We||nt)&&(ke=Dr(le,1,-Ze,1+Ze,0,-1,2,De)||[],We&&(ke=oo(We,1).concat(ke)),nt&&(ke=ke.concat(oo(nt,-1)))),ke}(se,W),se.length&&this.splitTile(se,0,0,0),Q&&(se.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(U,W,Q,se,le,De,Ze){let ke=[U,W,Q,se],We=this.options,nt=We.debug;for(;ke.length;){se=ke.pop(),Q=ke.pop(),W=ke.pop(),U=ke.pop();let dt=1<<W,Ft=Qr(W,Q,se),tr=this.tiles[Ft];if(!tr&&(nt>1&&console.time("creation"),tr=this.tiles[Ft]=yn(U,W,Q,se,We),this.tileCoords.push({z:W,x:Q,y:se}),nt)){nt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",W,Q,se,tr.numFeatures,tr.numPoints,tr.numSimplified),console.timeEnd("creation"));let Rn=`z${W}`;this.stats[Rn]=(this.stats[Rn]||0)+1,this.total++}if(tr.source=U,le==null){if(W===We.indexMaxZoom||tr.numPoints<=We.indexMaxPoints)continue}else{if(W===We.maxZoom||W===le)continue;if(le!=null){let Rn=le-W;if(Q!==De>>Rn||se!==Ze>>Rn)continue}}if(tr.source=null,U.length===0)continue;nt>1&&console.time("clipping");let Qt=.5*We.buffer/We.extent,or=.5-Qt,Ar=.5+Qt,qr=1+Qt,wr=null,Ei=null,mi=null,Ti=null,An=Dr(U,dt,Q-Qt,Q+Ar,0,tr.minX,tr.maxX,We),ln=Dr(U,dt,Q+or,Q+qr,0,tr.minX,tr.maxX,We);U=null,An&&(wr=Dr(An,dt,se-Qt,se+Ar,1,tr.minY,tr.maxY,We),Ei=Dr(An,dt,se+or,se+qr,1,tr.minY,tr.maxY,We),An=null),ln&&(mi=Dr(ln,dt,se-Qt,se+Ar,1,tr.minY,tr.maxY,We),Ti=Dr(ln,dt,se+or,se+qr,1,tr.minY,tr.maxY,We),ln=null),nt>1&&console.timeEnd("clipping"),ke.push(wr||[],W+1,2*Q,2*se),ke.push(Ei||[],W+1,2*Q,2*se+1),ke.push(mi||[],W+1,2*Q+1,2*se),ke.push(Ti||[],W+1,2*Q+1,2*se+1)}}getTile(U,W,Q){U=+U,W=+W,Q=+Q;let se=this.options,{extent:le,debug:De}=se;if(U<0||U>24)return null;let Ze=1<<U,ke=Qr(U,W=W+Ze&Ze-1,Q);if(this.tiles[ke])return Cn(this.tiles[ke],le);De>1&&console.log("drilling down to z%d-%d-%d",U,W,Q);let We,nt=U,dt=W,Ft=Q;for(;!We&&nt>0;)nt--,dt>>=1,Ft>>=1,We=this.tiles[Qr(nt,dt,Ft)];return We&&We.source?(De>1&&(console.log("found parent tile z%d-%d-%d",nt,dt,Ft),console.time("drilling down")),this.splitTile(We.source,nt,dt,Ft,U,W,Q),De>1&&console.timeEnd("drilling down"),this.tiles[ke]?Cn(this.tiles[ke],le):null):null}}function Qr(te,U,W){return 32*((1<<te)*W+U)+te}function Vo(te,U){let W=te.tileID.canonical;if(!this._geoJSONIndex)return U(null,null);let Q=this._geoJSONIndex.getTile(W.z,W.x,W.y);if(!Q)return U(null,null);let se=new he(Q.features),le=Pt(se);le.byteOffset===0&&le.byteLength===le.buffer.byteLength||(le=new Uint8Array(le)),U(null,{vectorTile:se,rawData:le.buffer})}class so extends ee{constructor(U,W,Q,se,le,De){super(U,W,Q,se,Vo,De),le&&(this.loadGeoJSON=le),this._dynamicIndex=new Re}loadData(U,W){let Q=U&&U.request,se=Q&&Q.collectResourceTiming;this.loadGeoJSON(U,(le,De)=>{if(le||!De)return W(le);if(typeof De!="object")return W(new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`));{try{if(U.filter){let ke=r.y(U.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ke.result==="error")throw new Error(ke.value.map(We=>`${We.key}: ${We.message}`).join(", "));De.features=De.features.filter(We=>ke.value.evaluate({zoom:0},We))}U.dynamic?(De.type==="Feature"&&(De={type:"FeatureCollection",features:[De]}),U.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(De.features,this.loaded),U.cluster&&(De.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=U.cluster?new Bt(function({superclusterOptions:ke,clusterProperties:We}){if(!We||!ke)return ke;let nt={},dt={},Ft={accumulated:null,zoom:0},tr={properties:null},Qt=Object.keys(We);for(let or of Qt){let[Ar,qr]=We[or],wr=r.y(qr),Ei=r.y(typeof Ar=="string"?[Ar,["accumulated"],["get",or]]:Ar);nt[or]=wr.value,dt[or]=Ei.value}return ke.map=or=>{tr.properties=or;let Ar={};for(let qr of Qt)Ar[qr]=nt[qr].evaluate(Ft,tr);return Ar},ke.reduce=(or,Ar)=>{tr.properties=Ar;for(let qr of Qt)Ft.accumulated=or[qr],or[qr]=dt[qr].evaluate(Ft,tr)},ke}(U)).load(De.features):U.dynamic?this._dynamicIndex:function(ke,We){return new Oa(ke,We)}(De,U.geojsonVtOptions)}catch(ke){return W(ke)}let Ze={};if(se){let ke=_(Q);ke&&(Ze.resourceTiming={},Ze.resourceTiming[U.source]=JSON.parse(JSON.stringify(ke)))}W(null,Ze)}})}reloadTile(U,W){let Q=this.loaded;return Q&&Q[U.uid]?U.partial?W(null,void 0):super.reloadTile(U,W):this.loadTile(U,W)}loadGeoJSON(U,W){if(U.request)r.g(U.request,W);else{if(typeof U.data!="string")return W(new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`));try{return W(null,JSON.parse(U.data))}catch{return W(new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(U,W){try{W(null,this._geoJSONIndex.getClusterExpansionZoom(U.clusterId))}catch(Q){W(Q)}}getClusterChildren(U,W){try{W(null,this._geoJSONIndex.getChildren(U.clusterId))}catch(Q){W(Q)}}getClusterLeaves(U,W){try{W(null,this._geoJSONIndex.getLeaves(U.clusterId,U.limit,U.offset))}catch(Q){W(Q)}}}class Za{constructor(U,W){this.tileID=new r.aL(U.tileID.overscaledZ,U.tileID.wrap,U.tileID.canonical.z,U.tileID.canonical.x,U.tileID.canonical.y),this.tileZoom=U.tileZoom,this.uid=U.uid,this.zoom=U.zoom,this.canonical=U.tileID.canonical,this.pixelRatio=U.pixelRatio,this.tileSize=U.tileSize,this.source=U.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=U.projection,this.brightness=W}parse(U,W,Q,se){this.status="parsing";let le=new r.aL(Q.tileID.overscaledZ,Q.tileID.wrap,Q.tileID.canonical.z,Q.tileID.canonical.x,Q.tileID.canonical.y),De={},Ze=W.familiesBySource[Q.source],ke=new r.dN(le,Q.promoteId);return ke.bucketLayerIDs=[],ke.is3DTile=!0,r.e3(U).then(We=>{if(!We)return se(new Error("Could not parse tile"));let nt=r.e4(We,1/r.b5(Q.tileID.canonical)),dt=We.json.extensionsUsed&&We.json.extensionsUsed.includes("MAPBOX_mesh_features")||We.json.asset.extras&&We.json.asset.extras.MAPBOX_mesh_features,Ft=We.json.extensionsUsed&&We.json.extensionsUsed.includes("EXT_meshopt_compression"),tr=new r.X(this.zoom,{brightness:this.brightness});for(let Qt in Ze)for(let or of Ze[Qt]){let Ar=or[0];ke.bucketLayerIDs.push(or.map(wr=>wr.id)),Ar.recalculate(tr,[]);let qr=new r.e5(nt,le,dt,Ft,this.brightness,ke);dt||(qr.needsUpload=!0),De[Ar.fqid]=qr,qr.evaluate(Ar)}this.status="done",se(null,{buckets:De,featureIndex:ke})}).catch(We=>se(new Error(We.message)))}}class _a{constructor(U,W,Q,se,le,De){this.actor=U,this.layerIndex=W,this.brightness=De,this.loading={},this.loaded={}}loadTile(U,W){let Q=U.uid,se=this.loading[Q]=new Za(U,this.brightness);r.e2(U.request,(le,De)=>{let Ze=!this.loading[Q];return delete this.loading[Q],Ze||le?(se.status="done",Ze||(this.loaded[Q]=se),W(le)):De&&De.byteLength!==0?void se.parse(De,this.layerIndex,U,(ke,We)=>{se.status="done",this.loaded=this.loaded||{},this.loaded[Q]=se,ke||!We?W(ke):W(null,We)}):(se.status="done",this.loaded[Q]=se,W())})}reloadTile(U,W){let Q=this.loaded,se=U.uid;if(Q&&Q[se]){let le=Q[se];le.projection=U.projection,le.brightness=U.brightness;let De=(Ze,ke)=>{le.reloadCallback&&(delete le.reloadCallback,this.loadTile(U,W)),W(Ze,ke)};le.status==="parsing"?le.reloadCallback=De:le.status==="done"&&this.loadTile(U,W)}}abortTile(U,W){let Q=U.uid;this.loading[Q]&&delete this.loading[Q],W()}removeTile(U,W){let Q=this.loaded,se=U.uid;Q&&Q[se]&&delete Q[se],W()}}class Jn{constructor(U){this.self=U,this.actor=new r.e6(U,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=r.aJ({name:"mercator"}),this.workerSourceTypes={vector:ee,geojson:so,"batched-model":_a},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(W,Q)=>{if(this.workerSourceTypes[W])throw new Error(`Worker source with name "${W}" already registered.`);this.workerSourceTypes[W]=Q},this.self.registerRTLTextPlugin=W=>{if(r.e7.isParsed())throw new Error("RTL text plugin already registered.");r.e7.applyArabicShaping=W.applyArabicShaping,r.e7.processBidirectionalText=W.processBidirectionalText,r.e7.processStyledBidirectionalText=W.processStyledBidirectionalText}}clearCaches(U,W,Q){delete this.layerIndexes[U],delete this.availableImages[U],delete this.workerSources[U],delete this.demWorkerSources[U],delete this.rasterArrayWorkerSource,Q()}checkIfReady(U,W,Q){Q()}setReferrer(U,W){this.referrer=W}spriteLoaded(U,{scope:W,isLoaded:Q}){if(this.isSpriteLoaded[U]||(this.isSpriteLoaded[U]={}),this.isSpriteLoaded[U][W]=Q,this.workerSources[U]&&this.workerSources[U][W])for(let se in this.workerSources[U][W]){let le=this.workerSources[U][W][se];for(let De in le){let Ze=le[De];Ze instanceof ee&&(Ze.isSpriteLoaded=Q,Ze.fire(new r.f("isSpriteLoaded")))}}}setImages(U,{scope:W,images:Q},se){if(this.availableImages[U]||(this.availableImages[U]={}),this.availableImages[U][W]=Q,this.workerSources[U]&&this.workerSources[U][W]){for(let le in this.workerSources[U][W]){let De=this.workerSources[U][W][le];for(let Ze in De)De[Ze].availableImages=Q}se()}else se()}setProjection(U,W){this.projections[U]=r.aJ(W)}setBrightness(U,W,Q){this.brightness=W,Q()}setLayers(U,W,Q){this.getLayerIndex(U,W.scope).replace(W.layers,W.options),Q()}updateLayers(U,W,Q){this.getLayerIndex(U,W.scope).update(W.layers,W.removedIds,W.options),Q()}loadTile(U,W,Q){W.projection=this.projections[U]||this.defaultProjection,this.getWorkerSource(U,W.type,W.source,W.scope).loadTile(W,Q)}loadDEMTile(U,W,Q){this.getDEMWorkerSource(U,W.source,W.scope).loadTile(W,Q)}decodeRasterArray(U,W,Q){this.getRasterArrayWorkerSource().decodeRasterArray(W,Q)}reloadTile(U,W,Q){W.projection=this.projections[U]||this.defaultProjection,this.getWorkerSource(U,W.type,W.source,W.scope).reloadTile(W,Q)}abortTile(U,W,Q){this.getWorkerSource(U,W.type,W.source,W.scope).abortTile(W,Q)}removeTile(U,W,Q){this.getWorkerSource(U,W.type,W.source,W.scope).removeTile(W,Q)}removeSource(U,W,Q){if(!(this.workerSources[U]&&this.workerSources[U][W.scope]&&this.workerSources[U][W.scope][W.type]&&this.workerSources[U][W.scope][W.type][W.source]))return;let se=this.workerSources[U][W.scope][W.type][W.source];delete this.workerSources[U][W.scope][W.type][W.source],se.removeSource!==void 0?se.removeSource(W,Q):Q()}loadWorkerSource(U,W,Q){try{this.self.importScripts(W.url),Q()}catch(se){Q(se.toString())}}syncRTLPluginState(U,W,Q){try{r.e7.setState(W);let se=r.e7.getPluginURL();if(r.e7.isLoaded()&&!r.e7.isParsed()&&se!=null){this.self.importScripts(se);let le=r.e7.isParsed();Q(le?void 0:new Error(`RTL Text Plugin failed to import scripts from ${se}`),le)}}catch(se){Q(se.toString())}}setDracoUrl(U,W){this.dracoUrl=W}getAvailableImages(U,W){this.availableImages[U]||(this.availableImages[U]={});let Q=this.availableImages[U][W];return Q||(Q=[]),Q}getLayerIndex(U,W){this.layerIndexes[U]||(this.layerIndexes[U]={});let Q=this.layerIndexes[U][W];return Q||(Q=this.layerIndexes[U][W]=new k,Q.scope=W),Q}getWorkerSource(U,W,Q,se){return this.workerSources[U]||(this.workerSources[U]={}),this.workerSources[U][se]||(this.workerSources[U][se]={}),this.workerSources[U][se][W]||(this.workerSources[U][se][W]={}),this.isSpriteLoaded[U]||(this.isSpriteLoaded[U]={}),this.workerSources[U][se][W][Q]||(this.workerSources[U][se][W][Q]=new this.workerSourceTypes[W]({send:(le,De,Ze,ke,We,nt)=>{this.actor.send(le,De,Ze,U,We,nt)},scheduler:this.actor.scheduler},this.getLayerIndex(U,se),this.getAvailableImages(U,se),this.isSpriteLoaded[U][se],void 0,this.brightness)),this.workerSources[U][se][W][Q]}getDEMWorkerSource(U,W,Q){return this.demWorkerSources[U]||(this.demWorkerSources[U]={}),this.demWorkerSources[U][Q]||(this.demWorkerSources[U][Q]={}),this.demWorkerSources[U][Q][W]||(this.demWorkerSources[U][Q][W]=new G),this.demWorkerSources[U][Q][W]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new K),this.rasterArrayWorkerSource}enforceCacheSizeLimit(U,W){r.e8(W)}getWorkerPerformanceMetrics(U,W,Q){Q(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Jn(self)),Jn}),c(["./shared"],function(r){function _(m,s){if(Array.isArray(m)){if(!Array.isArray(s)||m.length!==s.length)return!1;for(let d=0;d<m.length;d++)if(!_(m[d],s[d]))return!1;return!0}if(typeof m=="object"&&m!==null&&s!==null){if(typeof s!="object"||Object.keys(m).length!==Object.keys(s).length)return!1;for(let d in m)if(!_(m[d],s[d]))return!1;return!0}return m===s}var T=E;function E(m){return!function(s){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var g,x,b=new Blob([""],{type:"text/javascript"}),S=URL.createObjectURL(b);try{x=new Worker(S),g=!0}catch{g=!1}return x&&x.terminate(),URL.revokeObjectURL(S),g}()?function(){var g=document.createElement("canvas");g.width=g.height=1;var x=g.getContext("2d");if(!x)return!1;var b=x.getImageData(0,0,1,1);return b&&b.width===g.width}()?(k[d=s&&s.failIfMajorPerformanceCaveat]===void 0&&(k[d]=function(g){var x,b=function(S){var C=document.createElement("canvas"),F=Object.create(E.webGLContextAttributes);return F.failIfMajorPerformanceCaveat=S,C.getContext("webgl2",F)}(g);if(!b)return!1;try{x=b.createShader(b.VERTEX_SHADER)}catch{return!1}return!(!x||b.isContextLost())&&(b.shaderSource(x,"void main() {}"),b.compileShader(x),b.getShaderParameter(x,b.COMPILE_STATUS)===!0)}(d)),k[d]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var d}(m)}var k={};function D(m,s,d){let g=document.createElement(m);return s!=null&&(g.className=s),d&&d.appendChild(g),g}function j(m,s,d){let g=document.createElementNS("http://www.w3.org/2000/svg",m);for(let x of Object.keys(s))g.setAttributeNS(null,x,String(s[x]));return d&&d.appendChild(g),g}E.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};let B=typeof document<"u"?document.documentElement&&document.documentElement.style:null,P=B&&B.userSelect!==void 0?"userSelect":"WebkitUserSelect",ee;function G(){B&&P&&(ee=B[P],B[P]="none")}function K(){B&&P&&(B[P]=ee)}function J(m){m.preventDefault(),m.stopPropagation(),window.removeEventListener("click",J,!0)}function ne(){window.addEventListener("click",J,!0),window.setTimeout(()=>{window.removeEventListener("click",J,!0)},0)}function he(m,s){let d=m.getBoundingClientRect();return et(m,d,s)}function Me(m,s){let d=m.getBoundingClientRect(),g=[];for(let x=0;x<s.length;x++)g.push(et(m,d,s[x]));return g}function Re(m){return window.InstallTrigger!==void 0&&m.button===2&&m.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:m.button}function et(m,s,d){let g=m.offsetWidth===s.width?1:m.offsetWidth/s.width;return new r.P((d.clientX-s.left)*g,(d.clientY-s.top)*g)}class Te{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(s,d){this._updatedSourceCaches[s]=d,this.setDirty()}discardSourceCacheUpdate(s){delete this._updatedSourceCaches[s]}updateLayer(s){let d=s.scope;this._updatedLayers[d]=this._updatedLayers[d]||new Set,this._updatedLayers[d].add(s.id),this.setDirty()}removeLayer(s){let d=s.scope;this._removedLayers[d]=this._removedLayers[d]||{},this._updatedLayers[d]=this._updatedLayers[d]||new Set,this._removedLayers[d][s.id]=s,this._updatedLayers[d].delete(s.id),this._updatedPaintProps.delete(s.fqid),this.setDirty()}getRemovedLayer(s){return this._removedLayers[s.scope]?this._removedLayers[s.scope][s.id]:null}discardLayerRemoval(s){this._removedLayers[s.scope]&&delete this._removedLayers[s.scope][s.id]}getLayerUpdatesByScope(){let s={};for(let d in this._updatedLayers)s[d]=s[d]||{},s[d].updatedIds=Array.from(this._updatedLayers[d].values());for(let d in this._removedLayers)s[d]=s[d]||{},s[d].removedIds=Object.keys(this._removedLayers[d]);return s}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(s){this._updatedPaintProps.add(s.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(s){this._updatedImages.add(s),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}let ge={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ue{constructor(s,d,g,x,b,S){this.length=d.length,this.attributes=g,this.itemSize=d.bytesPerElement,this.dynamicDraw=x,this.instanceCount=S,this.context=s;let C=s.gl;this.buffer=C.createBuffer(),s.bindVertexBuffer.set(this.buffer),C.bufferData(C.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||b||d.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){let d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,d){for(let g=0;g<this.attributes.length;g++){let x=d.attributes[this.attributes[g].name];x!==void 0&&s.enableVertexAttribArray(x)}}setVertexAttribPointers(s,d,g){for(let x=0;x<this.attributes.length;x++){let b=this.attributes[x],S=d.attributes[b.name];S!==void 0&&s.vertexAttribPointer(S,b.components,s[ge[b.type]],!1,this.itemSize,b.offset+this.itemSize*(g||0))}}setVertexAttribDivisor(s,d,g){for(let x=0;x<this.attributes.length;x++){let b=d.attributes[this.attributes[x].name];b!==void 0&&this.instanceCount&&this.instanceCount>0&&s.vertexAttribDivisor(b,g)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ae{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class _e extends Ae{getDefault(){return r.C.transparent}set(s){let d=this.current;(s.r!==d.r||s.g!==d.g||s.b!==d.b||s.a!==d.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class ve extends Ae{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class Qe extends Ae{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class Ce extends Ae{getDefault(){return[!0,!0,!0,!0]}set(s){let d=this.current;(s[0]!==d[0]||s[1]!==d[1]||s[2]!==d[2]||s[3]!==d[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Ye extends Ae{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class ut extends Ae{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class st extends Ae{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){let d=this.current;(s.func!==d.func||s.ref!==d.ref||s.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class pt extends Ae{getDefault(){let s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){let d=this.current;(s[0]!==d[0]||s[1]!==d[1]||s[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class Tt extends Ae{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;let d=this.gl;s?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=s,this.dirty=!1}}class ht extends Ae{getDefault(){return[0,1]}set(s){let d=this.current;(s[0]!==d[0]||s[1]!==d[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class Wt extends Ae{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;let d=this.gl;s?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=s,this.dirty=!1}}class re extends Ae{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class xe extends Ae{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;let d=this.gl;s?d.enable(d.BLEND):d.disable(d.BLEND),this.current=s,this.dirty=!1}}class pe extends Ae{getDefault(){let s=this.gl;return[s.ONE,s.ZERO,s.ONE,s.ZERO]}set(s){let d=this.current;(s[0]!==d[0]||s[1]!==d[1]||s[2]!==d[2]||s[3]!==d[3]||this.dirty)&&(this.gl.blendFuncSeparate(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Ie extends Ae{getDefault(){return r.C.transparent}set(s){let d=this.current;(s.r!==d.r||s.g!==d.g||s.b!==d.b||s.a!==d.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Ve extends Ae{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(s,s),this.current=s,this.dirty=!1)}}class gt extends Ae{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;let d=this.gl;s?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=s,this.dirty=!1}}class mt extends Ae{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class wt extends Ae{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}let Pt=class extends Ae{getDefault(){return null}set(m){(m!==this.current||this.dirty)&&(this.gl.useProgram(m),this.current=m,this.dirty=!1)}};class fr extends Ae{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class xr extends Ae{getDefault(){let s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){let d=this.current;(s[0]!==d[0]||s[1]!==d[1]||s[2]!==d[2]||s[3]!==d[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Rr extends Ae{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;let d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class Fr extends Ae{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;let d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class $t extends Ae{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;let d=this.gl;d.bindTexture(d.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class lt extends Ae{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;let d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class Bt extends Ae{getDefault(){return null}set(s){let d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class nr extends Ae{getDefault(){return null}set(s){this.gl&&(s!==this.current||this.dirty)&&(this.gl.bindVertexArray(s),this.current=s,this.dirty=!1)}}class br extends Ae{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;let d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class kr extends Ae{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;let d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class Nr extends Ae{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;let d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class Br extends Ae{constructor(s,d){super(s),this.context=s,this.parent=d}getDefault(){return null}}class ii extends Br{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class si extends Br{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,this.attachment(),d.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class wi extends Br{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,this.attachment(),d.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class Ri extends si{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Ji{constructor(s,d,g,x,b){this.context=s,this.width=d,this.height=g;let S=this.framebuffer=s.gl.createFramebuffer();x&&(this.colorAttachment=new ii(s,S)),b&&(this.depthAttachmentType=b,this.depthAttachment=b==="renderbuffer"?new si(s,S):new wi(s,S))}destroy(){let s=this.context.gl;if(this.colorAttachment){let d=this.colorAttachment.get();d&&s.deleteTexture(d)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){let d=this.depthAttachment.get();d&&s.deleteRenderbuffer(d)}else{let d=this.depthAttachment.get();d&&s.deleteTexture(d)}s.deleteFramebuffer(this.framebuffer)}}class an{constructor(s,d){this.gl=s,this.clearColor=new _e(this),this.clearDepth=new ve(this),this.clearStencil=new Qe(this),this.colorMask=new Ce(this),this.depthMask=new Ye(this),this.stencilMask=new ut(this),this.stencilFunc=new st(this),this.stencilOp=new pt(this),this.stencilTest=new Tt(this),this.depthRange=new ht(this),this.depthTest=new Wt(this),this.depthFunc=new re(this),this.blend=new xe(this),this.blendFunc=new pe(this),this.blendColor=new Ie(this),this.blendEquation=new Ve(this),this.cullFace=new gt(this),this.cullFaceSide=new mt(this),this.frontFace=new wt(this),this.program=new Pt(this),this.activeTexture=new fr(this),this.viewport=new xr(this),this.bindFramebuffer=new Rr(this),this.bindRenderbuffer=new Fr(this),this.bindTexture=new $t(this),this.bindVertexBuffer=new lt(this),this.bindElementBuffer=new Bt(this),this.bindVertexArrayOES=new nr(this),this.pixelStoreUnpack=new br(this),this.pixelStoreUnpackPremultiplyAlpha=new kr(this),this.pixelStoreUnpackFlipY=new Nr(this),this.options=d?jr({},d):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=s.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=s.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=s.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=s.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=s.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=s.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),this.maxPointSize=s.getParameter(s.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,d,g){return new r.I(this,s,d,g)}createVertexBuffer(s,d,g,x,b){return new Ue(this,s,d,g,x,b)}createRenderbuffer(s,d,g){let x=this.gl,b=x.createRenderbuffer();return this.bindRenderbuffer.set(b),x.renderbufferStorage(x.RENDERBUFFER,s,d,g),this.bindRenderbuffer.set(null),b}createFramebuffer(s,d,g,x){return new Ji(this,s,d,g,x)}clear({color:s,depth:d,stencil:g,colorMask:x}){let b=this.gl,S=0;s&&(S|=b.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set(x||[!0,!0,!0,!0])),d!==void 0&&(S|=b.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),g!==void 0&&(S|=b.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),b.clear(S)}setCullFace(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){_(s.blendFunction,r.a.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor),s.blendEquation?this.blendEquation.set(s.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(s.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}class xi{constructor(s){this._gl=s.gl,this._query=this._gl.createQuery(),this._isFree=!0}begin(){this._gl.beginQuery(this._gl.ANY_SAMPLES_PASSED,this._query),this._isFree=!1}end(){this._gl.endQuery(this._gl.ANY_SAMPLES_PASSED)}isResultAvailable(){return this._gl.getQueryParameter(this._query,this._gl.QUERY_RESULT_AVAILABLE)}consumeResult(){let s=this._gl.getQueryParameter(this._query,this._gl.QUERY_RESULT);return this._isFree=!0,s}isFree(){return this._isFree}destroy(){this._gl.deleteQuery(this._query)}}class Ui{constructor(s){this.useOcclusionQueries=!0,this.visualizeOcclusions="none",this.occlusionQueryFrameWindow=5,this.occluderSize=32,this.fadeSpeed=7,this.depthOffset=-1e-4,s.registerParameter(this,["Symbols"],"useOcclusionQueries"),s.registerParameter(this,["Symbols"],"visualizeOcclusions",{options:{none:"none",zPass:"zPass",zTest:"zTest"}}),s.registerParameter(this,["Symbols"],"occlusionQueryFrameWindow",{min:1,max:30,step:1}),s.registerParameter(this,["Symbols"],"occluderSize",{min:1,max:100,step:1}),s.registerParameter(this,["Symbols"],"fadeSpeed",{min:.1,max:50,step:.1}),s.registerParameter(this,["Symbols"],"depthOffset",{min:-.001,max:0,step:1e-4})}}class Lr{constructor(s,d,g,x){let b={width:g[0],height:g[1],data:null},S=s.gl;this.targetColorTexture=new r.T(s,b,S.RGBA,{useMipmap:!1}),this.backgroundColorTexture=new r.T(s,b,S.RGBA,{useMipmap:!1}),this.context=s,this.updateParticleTexture(d,x),this.lastInvalidatedAt=0}updateParticleTexture(s,d){if(this.particleTextureDimension===d.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());let g=this.context.gl,x=d.width*d.height;this.particleTexture0=new r.T(this.context,d,g.RGBA,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new r.T(this.context,d,g.RGBA,{premultiply:!1,useMipmap:!1});let b=new r.S;b.reserve(x);for(let S=0;S<x;S++)b.emplaceBack(S);this.particleIndexBuffer=this.context.createVertexBuffer(b,r.p.members,!0),this.particleSegment=r.b.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=d.width}update(s){return!(this.lastInvalidatedAt<s&&(this.lastInvalidatedAt=r.e.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}class Ua extends r.E{constructor(s){super(),this.requestManager=s,this.models={"":{}},this.numModelsLoading={}}loadModel(s,d){return r.l(this.requestManager.transformRequest(d,r.R.Model).url).then(g=>{if(!g)return;let x=r.c(g),b=new r.M(s,void 0,void 0,x);return b.computeBoundsAndApplyParent(),b}).catch(g=>{if(g&&g.status===404)return null;this.fire(new r.d(new Error(`Could not load model ${s} from ${d}: ${g.message}`)))})}load(s,d){this.models[d]||(this.models[d]={});let g=Object.keys(s);this.numModelsLoading[d]=(this.numModelsLoading[d]||0)+g.length;let x=[];for(let b of g)x.push(this.loadModel(b,s[b]));Promise.allSettled(x).then(b=>{for(let S=0;S<b.length;S++){let{status:C,value:F}=b[S];C==="fulfilled"&&F&&(this.models[d][g[S]]={model:F,numReferences:1})}this.numModelsLoading[d]-=g.length,this.fire(new r.f("data",{dataType:"style"}))}).catch(b=>{this.fire(new r.d(new Error(`Could not load models: ${b.message}`)))})}isLoaded(){for(let s in this.numModelsLoading)if(this.numModelsLoading[s]>0)return!1;return!0}hasModel(s,d){return!!this.getModel(s,d)}getModel(s,d){return this.models[d]||(this.models[d]={}),this.models[d][s]?this.models[d][s].model:void 0}addModel(s,d,g){this.models[g]||(this.models[g]={}),this.hasModel(s,g)&&this.models[g][s].numReferences++,this.load({[s]:this.requestManager.normalizeModelURL(d)},g)}addModels(s,d){this.models[d]||(this.models[d]={});let g={};for(let x in s)this.models[d][x]={},g[x]=this.requestManager.normalizeModelURL(s[x]);this.load(g,d)}addModelsFromBucket(s,d){this.models[d]||(this.models[d]={});let g={};for(let x of s)this.hasModel(x,d)?this.models[d][x].numReferences++:g[x]=this.requestManager.normalizeModelURL(x);this.load(g,d)}removeModel(s,d){if(this.models[d]&&this.models[d][s]&&(this.models[d][s].numReferences--,this.models[d][s].numReferences===0)){let g=this.models[d][s].model;delete this.models[d][s],g.destroy()}}listModels(s){return this.models[s]||(this.models[s]={}),Object.keys(this.models[s])}upload(s,d){this.models[d]||(this.models[d]={});for(let g in this.models[d])this.models[d][g].model&&this.models[d][g].model.upload(s.context)}}function Dr(m){let{userImage:s}=m;return!!(s&&s.render&&s.render())&&(m.data.replace(new Uint8Array(s.data.buffer)),!0)}class Eo extends r.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(s){this.images[s]={},this.loaded[s]=!1,this.updatedImages[s]={},this.patterns[s]={},this.callbackDispatchedThisFrame[s]={},this.atlasImage[s]=new r.i({width:1,height:1})}isLoaded(){for(let s in this.loaded)if(!this.loaded[s])return!1;return!0}setLoaded(s,d){if(this.loaded[d]!==s&&(this.loaded[d]=s,s)){for(let{ids:g,callback:x}of this.requestors)this._notify(g,d,x);this.requestors=[]}}hasImage(s,d){return!!this.getImage(s,d)}getImage(s,d){return this.images[d][s]}addImage(s,d,g){this._validate(s,g)&&(this.images[d][s]=g)}_validate(s,d){let g=!0;return this._validateStretch(d.stretchX,d.data&&d.data.width)||(this.fire(new r.d(new Error(`Image "${s}" has invalid "stretchX" value`))),g=!1),this._validateStretch(d.stretchY,d.data&&d.data.height)||(this.fire(new r.d(new Error(`Image "${s}" has invalid "stretchY" value`))),g=!1),this._validateContent(d.content,d)||(this.fire(new r.d(new Error(`Image "${s}" has invalid "content" value`))),g=!1),g}_validateStretch(s,d){if(!s)return!0;let g=0;for(let x of s){if(x[0]<g||x[1]<x[0]||d<x[1])return!1;g=x[1]}return!0}_validateContent(s,d){return!(s&&(s.length!==4||s[0]<0||d.data.width<s[0]||s[1]<0||d.data.height<s[1]||s[2]<0||d.data.width<s[2]||s[3]<0||d.data.height<s[3]||s[2]<s[0]||s[3]<s[1]))}updateImage(s,d,g){g.version=this.images[d][s].version+1,this.images[d][s]=g,this.updatedImages[d][s]=!0}removeImage(s,d){let g=this.images[d][s];delete this.images[d][s],delete this.patterns[d][s],g.userImage&&g.userImage.onRemove&&g.userImage.onRemove()}listImages(s){return Object.keys(this.images[s])}getImages(s,d,g){let x=!0,b=!!this.loaded[d];if(!b)for(let S of s)this.images[d][S]||(x=!1);b||x?this._notify(s,d,g):this.requestors.push({ids:s,scope:d,callback:g})}getUpdatedImages(s){return this.updatedImages[s]}_notify(s,d,g){let x={};for(let b of s){this.images[d][b]||this.fire(new r.f("styleimagemissing",{id:b}));let S=this.images[d][b];S?x[b]={data:S.data.clone(),pixelRatio:S.pixelRatio,sdf:S.sdf,version:S.version,stretchX:S.stretchX,stretchY:S.stretchY,content:S.content,hasRenderCallback:!!(S.userImage&&S.userImage.render)}:r.w(`Image "${b}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}g(null,x)}getPixelSize(s){let{width:d,height:g}=this.atlasImage[s];return{width:d,height:g}}getPattern(s,d,g){let x=this.patterns[d][s],b=this.getImage(s,d);if(!b)return null;if(x&&x.position.version===b.version)return x.position;if(x)x.position.version=b.version;else{let S={w:b.data.width+2,h:b.data.height+2,x:0,y:0},C=new r.k(S,b);this.patterns[d][s]={bin:S,position:C}}return this._updatePatternAtlas(d,g),this.patterns[d][s].position}bind(s,d){let g=s.gl,x=this.atlasTexture[d];x?this.dirty&&(x.update(this.atlasImage[d]),this.dirty=!1):(x=new r.T(s,this.atlasImage[d],g.RGBA),this.atlasTexture[d]=x),x.bind(g.LINEAR,g.CLAMP_TO_EDGE)}_updatePatternAtlas(s,d){let g=[];for(let C in this.patterns[s])g.push(this.patterns[s][C].bin);let{w:x,h:b}=r.j(g),S=this.atlasImage[s];S.resize({width:x||1,height:b||1});for(let C in this.patterns[s]){let{bin:F}=this.patterns[s][C],O=F.x+1,V=F.y+1,X=this.images[s][C].data,ie=X.width,ae=X.height;r.i.copy(X,S,{x:0,y:0},{x:O,y:V},{width:ie,height:ae},d),r.i.copy(X,S,{x:0,y:ae-1},{x:O,y:V-1},{width:ie,height:1},d),r.i.copy(X,S,{x:0,y:0},{x:O,y:V+ae},{width:ie,height:1},d),r.i.copy(X,S,{x:ie-1,y:0},{x:O-1,y:V},{width:1,height:ae},d),r.i.copy(X,S,{x:0,y:0},{x:O+ie,y:V},{width:1,height:ae},d)}this.dirty=!0}beginFrame(){for(let s in this.images)this.callbackDispatchedThisFrame[s]={}}dispatchRenderCallbacks(s,d){for(let g of s){if(this.callbackDispatchedThisFrame[d][g])continue;this.callbackDispatchedThisFrame[d][g]=!0;let x=this.images[d][g];Dr(x)&&this.updateImage(g,d,x)}}}function gi(m){let s=m.key,d=m.value,g=m.valueSpec||{},x=m.objectElementValidators||{},b=m.style,S=m.styleSpec,C=[],F=r.n(d);if(F!=="object")return[new r.V(s,d,`object expected, ${F} found`)];for(let O in d){let V=O.split(".")[0],X;x[V]?X=x[V]:g[V]?X=U:x["*"]?X=x["*"]:g["*"]&&(X=U),X?C=C.concat(X({key:(s&&`${s}.`)+O,value:d[O],valueSpec:g[V]||g["*"],style:b,styleSpec:S,object:d,objectKey:O},d)):C.push(new r.m(s,d[O],`unknown property "${O}"`))}for(let O in g)x[O]||g[O].required&&g[O].default===void 0&&d[O]===void 0&&C.push(new r.V(s,d,`missing required property "${O}"`));return C}function Dn(m){let s=m.value,d=m.valueSpec,g=m.style,x=m.styleSpec,b=m.key,S=m.arrayElementValidator||U;if(r.n(s)!=="array")return[new r.V(b,s,`array expected, ${r.n(s)} found`)];if(d.length&&s.length!==d.length)return[new r.V(b,s,`array length ${d.length} expected, length ${s.length} found`)];if(d["min-length"]&&s.length<d["min-length"])return[new r.V(b,s,`array length at least ${d["min-length"]} expected, length ${s.length} found`)];let C={type:d.value,values:d.values,minimum:d.minimum,maximum:d.maximum,function:void 0};x.$version<7&&(C.function=d.function),r.n(d.value)==="object"&&(C=d.value);let F=[];for(let O=0;O<s.length;O++)F=F.concat(S({array:s,arrayIndex:O,value:s[O],valueSpec:C,style:g,styleSpec:x,key:`${b}[${O}]`},!0));return F}function Ao(m){let s=m.key,d=m.value,g=m.valueSpec,x=r.n(d);if(x==="number"&&d!=d&&(x="NaN"),x!=="number")return[new r.V(s,d,`number expected, ${x} found`)];if("minimum"in g){let b=g.minimum;if(r.n(g.minimum)==="array"&&(b=g.minimum[m.arrayIndex]),d<b)return[new r.V(s,d,`${d} is less than the minimum value ${b}`)]}if("maximum"in g){let b=g.maximum;if(r.n(g.maximum)==="array"&&(b=g.maximum[m.arrayIndex]),d>b)return[new r.V(s,d,`${d} is greater than the maximum value ${b}`)]}return[]}function Qi(m){let s=m.valueSpec,d=r.u(m.value.type),g,x,b,S={},C=d!=="categorical"&&m.value.property===void 0,F=!C,O=r.n(m.value.stops)==="array"&&r.n(m.value.stops[0])==="array"&&r.n(m.value.stops[0][0])==="object",V=gi({key:m.key,value:m.value,valueSpec:m.styleSpec.function,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{stops:function(ae){if(d==="identity")return[new r.V(ae.key,ae.value,'identity function may not have a "stops" property')];let ue=[],de=ae.value;return ue=ue.concat(Dn({key:ae.key,value:de,valueSpec:ae.valueSpec,style:ae.style,styleSpec:ae.styleSpec,arrayElementValidator:X})),r.n(de)==="array"&&de.length===0&&ue.push(new r.V(ae.key,de,"array must have at least one stop")),ue},default:function(ae){return U({key:ae.key,value:ae.value,valueSpec:s,style:ae.style,styleSpec:ae.styleSpec})}}});return d==="identity"&&C&&V.push(new r.V(m.key,m.value,'missing required property "property"')),d==="identity"||m.value.stops||V.push(new r.V(m.key,m.value,'missing required property "stops"')),d==="exponential"&&m.valueSpec.expression&&!r.s(m.valueSpec)&&V.push(new r.V(m.key,m.value,"exponential functions not supported")),m.styleSpec.$version>=8&&(F&&!r.q(m.valueSpec)?V.push(new r.V(m.key,m.value,"property functions not supported")):C&&!r.r(m.valueSpec)&&V.push(new r.V(m.key,m.value,"zoom functions not supported"))),d!=="categorical"&&!O||m.value.property!==void 0||V.push(new r.V(m.key,m.value,'"property" property is required')),V;function X(ae){let ue=[],de=ae.value,fe=ae.key;if(r.n(de)!=="array")return[new r.V(fe,de,`array expected, ${r.n(de)} found`)];if(de.length!==2)return[new r.V(fe,de,`array length 2 expected, length ${de.length} found`)];if(O){if(r.n(de[0])!=="object")return[new r.V(fe,de,`object expected, ${r.n(de[0])} found`)];if(de[0].zoom===void 0)return[new r.V(fe,de,"object stop key must have zoom")];if(de[0].value===void 0)return[new r.V(fe,de,"object stop key must have value")];let me=r.u(de[0].zoom);if(typeof me!="number")return[new r.V(fe,de[0].zoom,"stop zoom values must be numbers")];if(b&&b>me)return[new r.V(fe,de[0].zoom,"stop zoom values must appear in ascending order")];me!==b&&(b=me,x=void 0,S={}),ue=ue.concat(gi({key:`${fe}[0]`,value:de[0],valueSpec:{zoom:{}},style:ae.style,styleSpec:ae.styleSpec,objectElementValidators:{zoom:Ao,value:ie}}))}else ue=ue.concat(ie({key:`${fe}[0]`,value:de[0],valueSpec:{},style:ae.style,styleSpec:ae.styleSpec},de));return r.t(r.v(de[1]))?ue.concat([new r.V(`${fe}[1]`,de[1],"expressions are not allowed in function stops.")]):ue.concat(U({key:`${fe}[1]`,value:de[1],valueSpec:s,style:ae.style,styleSpec:ae.styleSpec}))}function ie(ae,ue){let de=r.n(ae.value),fe=r.u(ae.value),me=ae.value!==null?ae.value:ue;if(g){if(de!==g)return[new r.V(ae.key,me,`${de} stop domain type must match previous stop domain type ${g}`)]}else g=de;if(de!=="number"&&de!=="string"&&de!=="boolean"&&typeof fe!="number"&&typeof fe!="string"&&typeof fe!="boolean")return[new r.V(ae.key,me,"stop domain value must be a number, string, or boolean")];if(de!=="number"&&d!=="categorical"){let Pe=`number expected, ${de} found`;return r.q(s)&&d===void 0&&(Pe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new r.V(ae.key,me,Pe)]}return d!=="categorical"||de!=="number"||typeof fe=="number"&&isFinite(fe)&&Math.floor(fe)===fe?d!=="categorical"&&de==="number"&&typeof fe=="number"&&typeof x=="number"&&x!==void 0&&fe<x?[new r.V(ae.key,me,"stop domain values must appear in ascending order")]:(x=fe,d==="categorical"&&fe in S?[new r.V(ae.key,me,"stop domain values must be unique")]:(S[fe]=!0,[])):[new r.V(ae.key,me,`integer expected, found ${String(fe)}`)]}}function _o(m){let s=(m.expressionContext==="property"?r.x:r.y)(r.v(m.value),m.valueSpec);if(s.result==="error")return s.value.map(g=>new r.V(`${m.key}${g.key}`,m.value,g.message));let d=s.value.expression||s.value._styleExpression.expression;if(m.expressionContext==="property"&&m.propertyKey==="text-font"&&!d.outputDefined())return[new r.V(m.key,m.value,`Invalid data expression for "${m.propertyKey}". Output values must be contained as literals within the expression.`)];if(m.expressionContext==="property"&&m.propertyType==="layout"&&!r.z(d))return[new r.V(m.key,m.value,'"feature-state" data expressions are not supported with layout properties.')];if(m.expressionContext==="filter")return Gn(d,m);if(m.expressionContext&&m.expressionContext.indexOf("cluster")===0){if(!r.A(d,["zoom","feature-state"]))return[new r.V(m.key,m.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(m.expressionContext==="cluster-initial"&&!r.B(d))return[new r.V(m.key,m.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Gn(m,s){let d=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(s.valueSpec&&s.valueSpec.expression)for(let x of s.valueSpec.expression.parameters)d.delete(x);if(d.size===0)return[];let g=[];return m instanceof r.D&&d.has(m.name)?[new r.V(s.key,s.value,`["${m.name}"] expression is not supported in a filter for a ${s.object.type} layer with id: ${s.object.id}`)]:(m.eachChild(x=>{g.push(...Gn(x,s))}),g)}function oo(m){let s=m.key,d=m.value,g=m.valueSpec,x=[];return Array.isArray(g.values)?g.values.indexOf(r.u(d))===-1&&x.push(new r.V(s,d,`expected one of [${g.values.join(", ")}], ${JSON.stringify(d)} found`)):Object.keys(g.values).indexOf(r.u(d))===-1&&x.push(new r.V(s,d,`expected one of [${Object.keys(g.values).join(", ")}], ${JSON.stringify(d)} found`)),x}function Co(m){return r.G(r.v(m.value))?_o(r.o({},m,{expressionContext:"filter",valueSpec:m.styleSpec[`filter_${m.layerType||"fill"}`]})):Cn(m)}function Cn(m){let s=m.value,d=m.key;if(r.n(s)!=="array")return[new r.V(d,s,`array expected, ${r.n(s)} found`)];let g=m.styleSpec,x,b=[];if(s.length<1)return[new r.V(d,s,"filter array must have at least 1 element")];switch(b=b.concat(oo({key:`${d}[0]`,value:s[0],valueSpec:g.filter_operator,style:m.style,styleSpec:m.styleSpec})),r.u(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&r.u(s[1])==="$type"&&b.push(new r.V(d,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&b.push(new r.V(d,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(x=r.n(s[1]),x!=="string"&&b.push(new r.V(`${d}[1]`,s[1],`string expected, ${x} found`)));for(let S=2;S<s.length;S++)x=r.n(s[S]),r.u(s[1])==="$type"?b=b.concat(oo({key:`${d}[${S}]`,value:s[S],valueSpec:g.geometry_type,style:m.style,styleSpec:m.styleSpec})):x!=="string"&&x!=="number"&&x!=="boolean"&&b.push(new r.V(`${d}[${S}]`,s[S],`string, number, or boolean expected, ${x} found`));break;case"any":case"all":case"none":for(let S=1;S<s.length;S++)b=b.concat(Cn({key:`${d}[${S}]`,value:s[S],style:m.style,styleSpec:m.styleSpec}));break;case"has":case"!has":x=r.n(s[1]),s.length!==2?b.push(new r.V(d,s,`filter array for "${s[0]}" operator must have 2 elements`)):x!=="string"&&b.push(new r.V(`${d}[1]`,s[1],`string expected, ${x} found`))}return b}function ki(m,s){let d=m.key,g=m.style,x=m.layer,b=m.styleSpec,S=m.value,C=m.objectKey,F=b[`${s}_${m.layerType}`];if(!F)return[];let O=C.match(/^(.*)-transition$/);if(s==="paint"&&O&&F[O[1]]&&F[O[1]].transition)return U({key:d,value:S,valueSpec:b.transition,style:g,styleSpec:b});let V=m.valueSpec||F[C];if(!V)return[new r.m(d,S,`unknown property "${C}"`)];let X;if(r.n(S)==="string"&&r.q(V)&&!V.tokens&&(X=/^{([^}]+)}$/.exec(S))){let ae=`\`{ "type": "identity", "property": ${X?JSON.stringify(X[1]):'"_"'} }\``;return[new r.V(d,S,`"${C}" does not support interpolation syntax
Use an identity property function instead: ${ae}.`)]}let ie=[];if(m.layerType==="symbol")C!=="text-field"||!g||g.glyphs||g.imports||ie.push(new r.V(d,S,'use of "text-field" requires a style "glyphs" property')),C==="text-font"&&r.H(r.v(S))&&r.u(S.type)==="identity"&&ie.push(new r.V(d,S,'"text-font" does not support identity functions'));else if(m.layerType==="model"&&s==="paint"&&x&&x.layout&&x.layout.hasOwnProperty("model-id")&&r.q(V)&&(r.J(V)||r.r(V))){let ae=r.x(r.v(S),V),ue=ae.value.expression||ae.value._styleExpression.expression;ue&&!r.A(ue,["measure-light"])&&(C==="model-emissive-strength"&&r.B(ue)&&r.z(ue)||ie.push(new r.V(d,S,`${C} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return ie.concat(U({key:m.key,value:S,valueSpec:V,style:g,styleSpec:b,expressionContext:"property",propertyType:s,propertyKey:C}))}function yn(m){return ki(m,"paint")}function ms(m){return ki(m,"layout")}function On(m){let s=[],d=m.value,g=m.key,x=m.style,b=m.styleSpec;d.type||d.ref||s.push(new r.V(g,d,'either "type" or "ref" is required'));let S=r.u(d.type),C=r.u(d.ref);if(d.id){let F=r.u(d.id);for(let O=0;O<m.arrayIndex;O++){let V=x.layers[O];r.u(V.id)===F&&s.push(new r.V(g,d.id,`duplicate layer id "${d.id}", previously used at line ${V.id.__line__}`))}}if("ref"in d){let F;["type","source","source-layer","filter","layout"].forEach(O=>{O in d&&s.push(new r.V(g,d[O],`"${O}" is prohibited for ref layers`))}),x.layers.forEach(O=>{r.u(O.id)===C&&(F=O)}),F?F.ref?s.push(new r.V(g,d.ref,"ref cannot reference another ref layer")):S=r.u(F.type):typeof C=="string"&&s.push(new r.V(g,d.ref,`ref layer "${C}" not found`))}else if(S!=="background"&&S!=="sky"&&S!=="slot")if(d.source){let F=x.sources&&x.sources[d.source],O=F&&r.u(F.type);F?O==="vector"&&S==="raster"?s.push(new r.V(g,d.source,`layer "${d.id}" requires a raster source`)):O==="raster"&&S!=="raster"?s.push(new r.V(g,d.source,`layer "${d.id}" requires a vector source`)):O!=="vector"||d["source-layer"]?O==="raster-dem"&&S!=="hillshade"?s.push(new r.V(g,d.source,"raster-dem source can only be used with layer type 'hillshade'.")):O!=="raster-array"||["raster","raster-particle"].includes(S)?S!=="line"||!d.paint||!d.paint["line-gradient"]&&!d.paint["line-trim-offset"]||O==="geojson"&&F.lineMetrics?S==="raster-particle"&&O!=="raster-array"&&s.push(new r.V(g,d.source,`layer "${d.id}" requires a 'raster-array' source.`)):s.push(new r.V(g,d,`layer "${d.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new r.V(g,d.source,"raster-array source can only be used with layer type 'raster'.")):s.push(new r.V(g,d,`layer "${d.id}" must specify a "source-layer"`)):s.push(new r.V(g,d.source,`source "${d.source}" not found`))}else s.push(new r.V(g,d,'missing required property "source"'));return s=s.concat(gi({key:g,value:d,valueSpec:b.layer,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{"*":()=>[],type:()=>U({key:`${g}.type`,value:d.type,valueSpec:b.layer.type,style:m.style,styleSpec:m.styleSpec,object:d,objectKey:"type"}),filter:F=>Co(r.o({layerType:S},F)),layout:F=>gi({layer:d,key:F.key,value:F.value,valueSpec:{},style:F.style,styleSpec:F.styleSpec,objectElementValidators:{"*":O=>ms(r.o({layerType:S},O))}}),paint:F=>gi({layer:d,key:F.key,value:F.value,valueSpec:{},style:F.style,styleSpec:F.styleSpec,objectElementValidators:{"*":O=>yn(r.o({layerType:S,layer:d},O))}})}})),s}function vo(m){let s=m.value,d=m.key,g=r.n(s);return g!=="string"?[new r.V(d,s,`string expected, ${g} found`)]:[]}let Oa={promoteId:function({key:m,value:s}){if(r.n(s)==="string")return vo({key:m,value:s});{let d=[];for(let g in s)d.push(...vo({key:`${m}.${g}`,value:s[g]}));return d}}};function Qr(m){let s=m.value,d=m.key,g=m.styleSpec,x=m.style;if(!s.type)return[new r.V(d,s,'"type" is required')];let b=r.u(s.type),S=[];switch(["vector","raster","raster-dem","raster-array"].includes(b)&&(s.url||s.tiles||S.push(new r.m(d,s,'Either "url" or "tiles" is required.'))),b){case"vector":case"raster":case"raster-dem":case"raster-array":return S=S.concat(gi({key:d,value:s,valueSpec:g[`source_${b.replace("-","_")}`],style:m.style,styleSpec:g,objectElementValidators:Oa})),S;case"geojson":if(S=gi({key:d,value:s,valueSpec:g.source_geojson,style:x,styleSpec:g,objectElementValidators:Oa}),s.cluster)for(let C in s.clusterProperties){let[F,O]=s.clusterProperties[C],V=typeof F=="string"?[F,["accumulated"],["get",C]]:F;S.push(..._o({key:`${d}.${C}.map`,value:O,expressionContext:"cluster-map"})),S.push(..._o({key:`${d}.${C}.reduce`,value:V,expressionContext:"cluster-reduce"}))}return S;case"video":return gi({key:d,value:s,valueSpec:g.source_video,style:x,styleSpec:g});case"image":return gi({key:d,value:s,valueSpec:g.source_image,style:x,styleSpec:g});case"canvas":return[new r.V(d,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return oo({key:`${d}.type`,value:s.type,valueSpec:{values:Vo(g)},style:x,styleSpec:g})}}function Vo(m){return m.source.reduce((s,d)=>{let g=m[d];return g.type.type==="enum"&&(s=s.concat(Object.keys(g.type.values))),s},[])}function so(m){let s=m.value,d=m.styleSpec,g=d.light,x=m.style,b=[],S=r.n(s);if(s===void 0)return b;if(S!=="object")return b=b.concat([new r.V("light",s,`object expected, ${S} found`)]),b;for(let C in s){let F=C.match(/^(.*)-transition$/);b=b.concat(F&&g[F[1]]&&g[F[1]].transition?U({key:C,value:s[C],valueSpec:d.transition,style:x,styleSpec:d}):g[C]?U({key:C,value:s[C],valueSpec:g[C],style:x,styleSpec:d}):[new r.V(C,s[C],`unknown property "${C}"`)])}return b}function Za(m){let s=m.value,d=[];if(!s)return d;let g=r.n(s);if(g!=="object")return d=d.concat([new r.V("light-3d",s,`object expected, ${g} found`)]),d;let x=m.styleSpec,b=x["light-3d"],S=m.key,C=m.style,F=m.style.lights;for(let X of["type","id"])if(!(X in s))return d=d.concat([new r.V("light-3d",s,`missing property ${X} on light`)]),d;if(s.type&&F)for(let X=0;X<m.arrayIndex;X++){let ie=r.u(s.type),ae=F[X];r.u(ae.type)===ie&&d.push(new r.V(S,s.id,`duplicate light type "${s.type}", previously defined at line ${ae.id.__line__}`))}let O=`properties_light_${s.type}`;if(!(O in x))return d=d.concat([new r.V("light-3d",s,`Invalid light type ${s.type}`)]),d;let V=x[O];for(let X in s)if(X==="properties"){let ie=s[X],ae=r.n(ie);if(ae!=="object")return d=d.concat([new r.V("properties",ie,`object expected, ${ae} found`)]),d;for(let ue in ie)d=d.concat(V[ue]?U({key:ue,value:ie[ue],valueSpec:V[ue],style:C,styleSpec:x}):[new r.m(m.key,ie[ue],`unknown property "${ue}"`)])}else{let ie=X.match(/^(.*)-transition$/);d=d.concat(ie&&b[ie[1]]&&b[ie[1]].transition?U({key:X,value:s[X],valueSpec:x.transition,style:C,styleSpec:x}):b[X]?U({key:X,value:s[X],valueSpec:b[X],style:C,styleSpec:x}):[new r.m(X,s[X],`unknown property "${X}"`)])}return d}function _a(m){let s=m.value,d=m.key,g=m.style,x=m.styleSpec,b=x.terrain,S=[],C=r.n(s);if(s===void 0||C==="null")return S;if(C!=="object")return S=S.concat([new r.V("terrain",s,`object expected, ${C} found`)]),S;for(let F in s){let O=F.match(/^(.*)-transition$/);S=S.concat(O&&b[O[1]]&&b[O[1]].transition?U({key:F,value:s[F],valueSpec:x.transition,style:g,styleSpec:x}):b[F]?U({key:F,value:s[F],valueSpec:b[F],style:g,styleSpec:x}):[new r.m(F,s[F],`unknown property "${F}"`)])}if(s.source){let F=g.sources&&g.sources[s.source],O=F&&r.u(F.type);F?O!=="raster-dem"&&S.push(new r.V(d,s.source,`terrain cannot be used with a source of type ${String(O)}, it only be used with a "raster-dem" source type`)):S.push(new r.V(d,s.source,`source "${s.source}" not found`))}else S.push(new r.V(d,s,'terrain is missing required property "source"'));return S}function Jn(m){let s=m.value,d=m.style,g=m.styleSpec,x=g.fog,b=[],S=r.n(s);if(s===void 0)return b;if(S!=="object")return b=b.concat([new r.V("fog",s,`object expected, ${S} found`)]),b;for(let C in s){let F=C.match(/^(.*)-transition$/);b=b.concat(F&&x[F[1]]&&x[F[1]].transition?U({key:C,value:s[C],valueSpec:g.transition,style:d,styleSpec:g}):x[C]?U({key:C,value:s[C],valueSpec:x[C],style:d,styleSpec:g}):[new r.m(C,s[C],`unknown property "${C}"`)])}return b}let te={"*":()=>[],array:Dn,boolean:function(m){let s=m.value,d=m.key,g=r.n(s);return g!=="boolean"?[new r.V(d,s,`boolean expected, ${g} found`)]:[]},number:Ao,color:function(m){let s=m.key,d=m.value,g=r.n(d);return g!=="string"?[new r.V(s,d,`color expected, ${g} found`)]:r.F(d)===null?[new r.V(s,d,`color expected, "${d}" found`)]:[]},enum:oo,filter:Co,function:Qi,layer:On,object:gi,source:Qr,model:r.K,light:so,"light-3d":Za,terrain:_a,fog:Jn,string:vo,formatted:function(m){return vo(m).length===0?[]:_o(m)},resolvedImage:function(m){return vo(m).length===0?[]:_o(m)},projection:function(m){let s=m.value,d=m.styleSpec,g=d.projection,x=m.style,b=[],S=r.n(s);if(S==="object")for(let C in s)b=b.concat(U({key:C,value:s[C],valueSpec:g[C],style:x,styleSpec:d}));else S!=="string"&&(b=b.concat([new r.V("projection",s,`object or string expected, ${S} found`)]));return b},import:function(m){let{value:s,styleSpec:d}=m,S=s,{data:g}=S,x=Fv(S,["data"]);Object.defineProperty(x,"__line__",{value:s.__line__,enumerable:!1});let b=gi(r.o({},m,{value:x,valueSpec:d.import}));return r.u(x.id)===""&&b.push(new r.V(`${m.key}.id`,x,"import id can't be an empty string")),g&&(b=b.concat(Q(g,d,{key:`${m.key}.data`}))),b}};function U(m,s=!1){let d=m.value,g=m.valueSpec,x=m.styleSpec;if(g.expression&&r.H(r.u(d)))return Qi(m);if(g.expression&&r.t(r.v(d)))return _o(m);if(g.type&&te[g.type]){let b=te[g.type](m);return s===!0&&b.length>0&&r.n(m.value)==="array"?_o(m):b}return gi(r.o({},m,{valueSpec:g.type?x[g.type]:g}))}function W(m){let s=m.value,d=m.key,g=vo(m);return g.length||(s.indexOf("{fontstack}")===-1&&g.push(new r.V(d,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&g.push(new r.V(d,s,'"glyphs" url must include a "{range}" token'))),g}function Q(m,s=r.L,d={}){return U({key:d.key||"",value:m,valueSpec:s.$root,styleSpec:s,style:m,objectElementValidators:{glyphs:W,"*":()=>[]}})}function se(m,s=r.L){return or(Q(m,s))}let le=m=>or(Qr(m)),De=m=>or(so(m)),Ze=m=>or(Za(m)),ke=m=>or(_a(m)),We=m=>or(Jn(m)),nt=m=>or(On(m)),dt=m=>or(Co(m)),Ft=m=>or(yn(m)),tr=m=>or(ms(m)),Qt=m=>or(r.K(m));function or(m){return m.slice().sort((s,d)=>s.line&&d.line?s.line-d.line:0)}function Ar(m,s){let d=!1;if(s&&s.length)for(let g of s)g instanceof r.m?r.w(g.message):(m.fire(new r.d(new Error(g.message))),d=!0);return d}let qr=new r.N({anchor:new r.O(r.L.light.anchor),position:new r.Q(r.L.light.position),color:new r.O(r.L.light.color),intensity:new r.O(r.L.light.intensity)});class wr extends r.E{constructor(s,d="flat"){super(),this._transitionable=new r.U(qr),this.setLight(s,d),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,d,g={}){this._validate(De,s,g)||(this._transitionable.setTransitionOrValue(s),this.id=d)}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,d,g){return(!g||g.validate!==!1)&&Ar(this,s.call(se,r.W({value:d,style:{glyphs:!0,sprite:!0},styleSpec:r.L})))}}let Ei=new r.N({source:new r.O(r.L.terrain.source),exaggeration:new r.O(r.L.terrain.exaggeration)}),mi=class extends r.E{constructor(m,s,d,g){super(),this.scope=d,this._transitionable=new r.U(Ei,d,g),this._transitionable.setTransitionOrValue(m,g),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=s}get(){return this._transitionable.serialize()}set(m,s){this._transitionable.setTransitionOrValue(m,s)}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}getExaggeration(m){return this._transitioning.possiblyEvaluate(new r.X(m)).get("exaggeration")}isZoomDependent(){let m=this._transitionable._values.exaggeration;return m!=null&&m.value!=null&&m.value.expression!=null&&m.value.expression instanceof r.Z}},Ti=45,An=65,ln=.05;function Rn(m,s,d,g){let x=r.$(Ti,An,d),[b,S]=Hn(m,g),C=1-Math.min(1,Math.exp((s-b)/(S-b)*-6));return C*=C*C,C=Math.min(1,1.00747*C),C*x*m.alpha}function Hn(m,s){let d=.5/Math.tan(.5*s);return[m.range[0]+d,m.range[1]+d]}function fn(m,s,d,g,x){let b=r._.transformMat4([],[s,d,g],x.mercatorFogMatrix);return Rn(m,r._.length(b),x.pitch,x._fov)}function Gl(m,s,d,g,x,b,S){let C=[[d,g,0],[x,g,0],[x,b,0],[d,b,0]],F=Number.MAX_VALUE,O=-Number.MAX_VALUE;for(let V of C){let X=r._.transformMat4([],V,s),ie=r._.length(X);F=Math.min(F,ie),O=Math.max(O,ie)}return[Rn(m,F,S.pitch,S._fov),Rn(m,O,S.pitch,S._fov)]}let wh=new r.N({range:new r.O(r.L.fog.range),color:new r.O(r.L.fog.color),"high-color":new r.O(r.L.fog["high-color"]),"space-color":new r.O(r.L.fog["space-color"]),"horizon-blend":new r.O(r.L.fog["horizon-blend"]),"star-intensity":new r.O(r.L.fog["star-intensity"]),"vertical-range":new r.O(r.L.fog["vertical-range"])});class md extends r.E{constructor(s,d,g,x){super(),this._transitionable=new r.U(wh,g,new Map(x)),this.set(s,x),this._transitioning=this._transitionable.untransitioned(),this._transform=d,this.properties=new r.a0(wh),this.scope=g}get state(){let s=this._transform,d=s.projection.name==="globe",g=r.a1(s.zoom),x=this.properties.get("range"),b=[.5,3];return{range:d?[r.a2(b[0],x[0],g),r.a2(b[1],x[1],g)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(s,d,g={}){if(this._validate(We,s,g))return;let x=r.W({},s);for(let b of Object.keys(r.L.fog))x[b]===void 0&&(x[b]=r.L.fog[b].default);this._options=x,this._transitionable.setTransitionOrValue(this._options,d)}getOpacity(s){if(!this._transform.projection.supportsFog)return 0;let d=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:r.$(Ti,An,s))*d.a}getOpacityAtLatLng(s,d){return this._transform.projection.supportsFog?function(g,x,b){let S=r.Y.fromLngLat(x),C=b.elevation?b.elevation.getAtPointOrZero(S):0;return fn(g,S.x,S.y,C,b)}(this.state,s,d):0}getOpacityForTile(s){if(!this._transform.projection.supportsFog)return[1,1];let d=this._transform.calculateFogTileMatrix(s.toUnwrapped());return Gl(this.state,d,0,0,r.a3,r.a3,this._transform)}getOpacityForBounds(s,d,g,x,b){return this._transform.projection.supportsFog?Gl(this.state,s,d,g,x,b,this._transform):[1,1]}getFovAdjustedRange(s){return this._transform.projection.supportsFog?Hn(this.state,s):[0,1]}isVisibleOnFrustum(s){if(!this._transform.projection.supportsFog)return!1;let d=[4,5,6,7];for(let g of d){let x=s.points[g],b;if(x[2]>=0)b=x;else{let S=s.points[g-4];b=r.a4(S,x,S[2]/(S[2]-x[2]))}if(fn(this.state,b[0],b[1],0,this._transform)>=ln)return!0}return!1}updateConfig(s){this._transitionable.setTransitionOrValue(this._options,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,d,g){return(!g||g.validate!==!1)&&Ar(this,s.call(se,r.W({value:d,style:{glyphs:!0,sprite:!0},styleSpec:r.L})))}}class gc extends r.E{constructor(s,d,g,x){super(),this.scope=g,this._options=s,this.properties=new r.a0(d),this._transitionable=new r.U(d,g,new Map(x)),this._transitionable.setTransitionOrValue(s.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(s){this._transitionable.setTransitionOrValue(this._options.properties,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(s,d){this._options=s,this._transitionable.setTransitionOrValue(s.properties,d)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}let ci=new r.N({color:new r.O(r.L.properties_light_ambient.color),intensity:new r.O(r.L.properties_light_ambient.intensity)}),Os=new r.N({direction:new r.a5(r.L.properties_light_directional.direction),color:new r.O(r.L.properties_light_directional.color),intensity:new r.O(r.L.properties_light_directional.intensity),"cast-shadows":new r.O(r.L.properties_light_directional["cast-shadows"]),"shadow-intensity":new r.O(r.L.properties_light_directional["shadow-intensity"])});var Ns=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,Go=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,vec2 pos,vec2 lod_coord) {vec2 size=vec2(textureSize(image,0));vec2 dx=dFdx(lod_coord.xy*size);vec2 dy=dFdy(lod_coord.xy*size);float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Cu=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Th="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",gd=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture(u_depth,uv-df.xz)),unpack_depth(texture(u_depth,uv+df.xz)),unpack_depth(texture(u_depth,uv-df.zy)),unpack_depth(texture(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Sh=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,_d=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Eh=`#ifdef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,vd=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec4 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=vec2(u_data_offset+dot(t.rg,u_data_scale.yx),-(u_data_offset+dot(t.ba,u_data_scale.yx)));velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,Iu=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,gf=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef NATIVE
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;let Zc=[];Ya(Ns,Zc),Ya(Cu,Zc),Ya(Go,Zc);let Ah={"_prelude_fog.vertex.glsl":Sh,"_prelude_terrain.vertex.glsl":gd,"_prelude_shadow.vertex.glsl":Iu,"_prelude_fog.fragment.glsl":_d,"_prelude_shadow.fragment.glsl":gf,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Eh,"_prelude_raster_particle.glsl":vd},rl={};Mi("",gd),Mi(_d,Sh),Mi(gf,Iu),Mi(Eh,""),Mi(vd,"");let ku=Mi(Go,Cu),Mu=Ns;var yd={background:Mi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Mi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Mi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Mi("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Mi(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Mi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Mi("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in float a_size_scale;in vec2 a_padding;in float a_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(a_z_offset+elevation(a_anchor_pos)),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Mi("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Mi("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Mi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Mi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Mi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Mi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Mi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
uniform float u_emissive_strength;in float v_height;void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,u_emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=max(0.01,cutoff_opacity(u_cutoff_params,ground.z));if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff < 0.01 && centroid_pos.x !=0.0));gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Mi(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Mi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
out vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Mi(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Mi(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Mi(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Mi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Mi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform lowp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/clamp(u_trim_fade_range[0],1e-4,1.0)));float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/clamp(u_trim_fade_range[1],1e-4,1.0)));float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=out_color.a;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trim_alpha,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED)
in float a_z_offset;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#if defined(ELEVATED)
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);
#else
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Mi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;float x=mod(pattern_x,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}
#endif
#ifdef LINE_JOIN_NONE
float pattern_len=pattern_size/aspect;float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED)
in float a_z_offset;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#if defined(ELEVATED)
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);
#else
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef LINE_JOIN_NONE
v_width=floorwidth+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Mi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Mi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Mi("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-vec2(1.0),0.0,1.0);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Mi("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Mi(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp float speed=velocity==INVALID_VELOCITY ? 0.0 : length(velocity);highp float reset_rate_bump=speed*u_reset_rate;highp vec2 particle_pos_min=-u_particle_pos_offset;highp vec2 particle_pos_max=vec2(1.0)+u_particle_pos_offset;highp vec2 pos_drop_rate=vec2(1.0)-step(particle_pos_min,pos)+step(particle_pos_max,pos);highp float drop_rate=max(u_reset_rate+reset_rate_bump,length(pos_drop_rate));highp float drop=step(1.0-drop_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbolIcon:Mi(`#include "_prelude_lighting.glsl"
uniform sampler2D u_texture;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
in float v_fade_opacity;in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
lowp float alpha=opacity*v_fade_opacity;vec4 out_color;
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
out_color*=alpha;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=globe_occlusion_fade;
#ifdef SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH
occlusion_fade*=occlusionFade(projected_point);
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
v_tex_a=a_tex/u_texsize;
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
v_fade_opacity=out_fade_opacity;
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);v_fade_opacity*=occludedFadeMultiplier;
#endif
}`),symbolSDF:Mi(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;in float v_draw_halo;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=globe_occlusion_fade;
#ifdef SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH
occlusion_fade*=occlusionFade(projected_point);
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}`),symbolTextAndIcon:Mi(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;in float v_draw_halo;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef Z_OFFSET
in float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out float v_draw_halo;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=globe_occlusion_fade;
#ifdef SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH
occlusion_fade*=occlusionFade(projected_point);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+ xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}`),terrainRaster:Mi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Mi("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Mi(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Th),skyboxGradient:Mi(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Th),skyboxCapture:Mi(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Mi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Mi(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Mi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture(u_depthTexture,coord));return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#else
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Mi(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Mi(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),occlusion:Mi("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Ya(m,s){let d=m.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let g of d)if(g=g.trim(),g[0]==="#"&&g.includes("if")&&!g.includes("endif")){g=g.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();let x=g.split(" ");for(let b of x)s.includes(b)||s.push(b)}}function Mi(m,s){let d=/#include\s+"([^"]+)"/g,g=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g,x=s.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);x&&(x=x.map(O=>{let V=O.split(" ");return V[V.length-1]}),x=[...new Set(x)]);let b={},S=[],C=[];if(m=m.replace(d,(O,V)=>(C.push(V),"")),(s=s.replace(d,(O,V)=>(S.push(V),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let F=[...Zc];Ya(m,F),Ya(s,F);for(let O of[...S,...C])Ah[O]||console.error(`Undefined include: ${O}`),rl[O]||(rl[O]=[],Ya(Ah[O],rl[O])),F=[...F,...rl[O]];return{fragmentSource:m=m.replace(g,(O,V,X,ie,ae)=>(b[ae]=!0,V==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
in ${X} ${ie} ${ae};
#else
uniform ${X} ${ie} u_${ae};
#endif
`:V==="initialize"?`
#ifdef HAS_UNIFORM_u_${ae}
    ${X} ${ie} ${ae} = u_${ae};
#endif
`:V==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    in ${X} ${ie} ${ae};
#endif
`:V==="initialize-attribute"?"":void 0)),vertexSource:s=s.replace(g,(O,V,X,ie,ae)=>{let ue=ie==="float"?"vec2":ie,de=ae.match(/color/)?"color":ue;return V==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
in ${X} ${ie} a_${ae};
#endif
`:b[ae]?V==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
uniform lowp float u_${ae}_t;
in ${X} ${ue} a_${ae};
out ${X} ${ie} ${ae};
#else
uniform ${X} ${ie} u_${ae};
#endif
`:V==="initialize"?de==="vec4"?`
#ifndef HAS_UNIFORM_u_${ae}
    ${ae} = a_${ae};
#else
    ${X} ${ie} ${ae} = u_${ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ae}
    ${ae} = unpack_mix_${de}(a_${ae}, u_${ae}_t);
#else
    ${X} ${ie} ${ae} = u_${ae};
#endif
`:V==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    in ${X} ${ie} a_${ae};
    out ${X} ${ie} ${ae};
#endif
`:V==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    ${ae} = a_${ae};
#endif
`:void 0:V==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
uniform lowp float u_${ae}_t;
in ${X} ${ue} a_${ae};
#else
uniform ${X} ${ie} u_${ae};
#endif
`:V==="define-instanced"?de==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${ae}0;
in vec4 a_${ae}1;
in vec4 a_${ae}2;
in vec4 a_${ae}3;
#else
uniform ${X} ${ie} u_${ae};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${X} ${ue} a_${ae};
#else
uniform ${X} ${ie} u_${ae};
#endif
`:V==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    ${X} ${ie} ${ae} = a_${ae};
#endif
`:de==="vec4"?`
#ifndef HAS_UNIFORM_u_${ae}
    ${X} ${ie} ${ae} = a_${ae};
#else
    ${X} ${ie} ${ae} = u_${ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ae}
    ${X} ${ie} ${ae} = unpack_mix_${de}(a_${ae}, u_${ae}_t);
#else
    ${X} ${ie} ${ae} = u_${ae};
#endif
`}),staticAttributes:x,usedDefines:F,vertexIncludes:S,fragmentIncludes:C}}class _f{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(s,d,g,x,b,S,C,F){this.context=s;let O=this.boundPaintVertexBuffers.length!==x.length;for(let X=0;!O&&X<x.length;X++)this.boundPaintVertexBuffers[X]!==x[X]&&(O=!0);let V=this.boundDynamicVertexBuffers.length!==C.length;for(let X=0;!V&&X<C.length;X++)this.boundDynamicVertexBuffers[X]!==C[X]&&(V=!0);if(!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==g||O||V||this.boundIndexBuffer!==b||this.boundVertexOffset!==S)this.freshBind(d,g,x,b,S,C,F);else{s.bindVertexArrayOES.set(this.vao);for(let X of C)X&&(X.bind(),F&&X.instanceCount&&X.setVertexAttribDivisor(s.gl,d,F));b&&b.dynamicDraw&&b.bind()}}freshBind(s,d,g,x,b,S,C){let F=s.numAttributes,O=this.context,V=O.gl;this.vao&&this.destroy(),this.vao=O.gl.createVertexArray(),O.bindVertexArrayOES.set(this.vao),this.boundProgram=s,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=x,this.boundVertexOffset=b,this.boundDynamicVertexBuffers=S,d.enableAttributes(V,s),d.bind(),d.setVertexAttribPointers(V,s,b);for(let X of g)X.enableAttributes(V,s),X.bind(),X.setVertexAttribPointers(V,s,b);for(let X of S)X&&(X.enableAttributes(V,s),X.bind(),X.setVertexAttribPointers(V,s,b),C&&X.instanceCount&&X.setVertexAttribDivisor(V,s,C));x&&x.bind(),O.currentNumAttributes=F}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Vi(m,s){let d=Math.pow(2,s.canonical.z),g=s.canonical.y;return[new r.Y(0,g/d).toLngLat().lat,new r.Y(0,(g+1)/d).toLngLat().lat]}function Cp(m,s,d,g,x,b,S){let C=m.context,F=C.gl,O=d.hillshadeFBO;if(!O)return;m.prepareDrawTile();let V=m.isTileAffectedByFog(s),X=m.getOrCreateProgram("hillshade",{overrideFog:V});C.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,O.colorAttachment.get());let ie=((fe,me,Pe,Oe)=>{let Ne=Pe.paint.get("hillshade-shadow-color"),Je=Pe.paint.get("hillshade-highlight-color"),Ke=Pe.paint.get("hillshade-accent-color"),Fe=Pe.paint.get("hillshade-emissive-strength"),Be=r.ab(Pe.paint.get("hillshade-illumination-direction"));if(Pe.paint.get("hillshade-illumination-anchor")==="viewport")Be-=fe.transform.angle;else if(fe.style&&fe.style.enable3dLights()&&fe.style.directionalLight){let at=fe.style.directionalLight.properties.get("direction"),xt=r.ac(at.x,at.y,at.z);Be=r.ab(xt[1])}let je=!fe.options.moving;return{u_matrix:Oe||fe.transform.calculateProjMatrix(me.tileID.toUnwrapped(),je),u_image:0,u_latrange:Vi(0,me.tileID),u_light:[Pe.paint.get("hillshade-exaggeration"),Be],u_shadow:Ne.toRenderColor(Pe.lut),u_highlight:Je.toRenderColor(Pe.lut),u_emissive_strength:Fe,u_accent:Ke.toRenderColor(Pe.lut)}})(m,d,g,m.terrain?s.projMatrix:null);m.uploadCommonUniforms(C,X,s.toUnwrapped());let{tileBoundsBuffer:ae,tileBoundsIndexBuffer:ue,tileBoundsSegments:de}=m.getTileBoundsBuffers(d);X.draw(m,F.TRIANGLES,x,b,S,r.af.disabled,ie,g.id,ae,ue,de)}function xd(m,s,d){if(!s.needsDEMTextureUpload)return;let g=m.context,x=g.gl;g.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||m.getTileTexture(d.stride);let b=d.getPixels();s.demTexture?s.demTexture.update(b,{premultiply:!1}):s.demTexture=new r.T(g,b,x.R32F,{premultiply:!1}),s.needsDEMTextureUpload=!1}function yo(m,s,d){let g=m.context,x=g.gl;if(!s.dem)return;let b=s.dem;if(g.activeTexture.set(x.TEXTURE1),xd(m,s,b),!s.demTexture)return;s.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE);let S=b.dim;g.activeTexture.set(x.TEXTURE0);let C=s.hillshadeFBO;if(!C){let ie=new r.T(g,{width:S,height:S,data:null},x.RGBA);ie.bind(x.LINEAR,x.CLAMP_TO_EDGE),C=s.hillshadeFBO=g.createFramebuffer(S,S,!0,"renderbuffer"),C.colorAttachment.set(ie.texture)}g.bindFramebuffer.set(C.framebuffer),g.viewport.set([0,0,S,S]);let{tileBoundsBuffer:F,tileBoundsIndexBuffer:O,tileBoundsSegments:V}=m.getMercatorTileBoundsBuffers(),X=[];m.linearFloatFilteringSupported()&&X.push("TERRAIN_DEM_FLOAT_FORMAT"),m.getOrCreateProgram("hillshadePrepare",{defines:X}).draw(m,x.TRIANGLES,r.ae.disabled,r.ag.disabled,r.a.unblended,r.af.disabled,((ie,ae)=>{let ue=ae.stride,de=r.ad.create();return r.ad.ortho(de,0,r.a3,-r.a3,0,0,1),r.ad.translate(de,de,[0,-r.a3,0]),{u_matrix:de,u_image:1,u_dimension:[ue,ue],u_zoom:ie.overscaledZ}})(s.tileID,b),d.id,F,O,V),s.needsHillshadePrepare=!1}function Ch(m,s,d,g,x){let b=function(S,C){if(S)return x(S);if(C){if(m.url&&C.tiles&&m.tiles&&delete m.tiles,C.variants){if(!Array.isArray(C.variants))return x(new Error("variants must be an array"));for(let O of C.variants){if(O==null||typeof O!="object"||O.constructor!==Object)return x(new Error("variant must be an object"));if(!Array.isArray(O.capabilities))return x(new Error("capabilities must be an array"));if(O.capabilities.length===1&&O.capabilities[0]==="meshopt"){C=r.W(C,O);break}}}let F=r.ah(r.W(C,m),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);C.vector_layers&&(F.vectorLayers=C.vector_layers,F.vectorLayerIds=F.vectorLayers.map(O=>O.id)),C.raster_layers&&(F.rasterLayers=C.raster_layers,F.rasterLayerIds=F.rasterLayers.map(O=>O.id)),F.tiles=s.canonicalizeTileset(F,m.url),x(null,F)}};return m.url?r.g(s.transformRequest(s.normalizeSourceURL(m.url,null,d,g),r.R.Source),b):r.e.frame(()=>b(null,m))}class Yc{constructor(s,d,g){this.bounds=r.ai.convert(this.validateBounds(s)),this.minzoom=d||0,this.maxzoom=g||24}validateBounds(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}contains(s){let d=Math.pow(2,s.z),g=Math.floor(r.aj(this.bounds.getWest())*d),x=Math.floor(r.ak(this.bounds.getNorth())*d),b=Math.ceil(r.aj(this.bounds.getEast())*d),S=Math.ceil(r.ak(this.bounds.getSouth())*d);return s.x>=g&&s.x<b&&s.y>=x&&s.y<S}}class Hl extends r.E{constructor(s,d,g,x){super(),this.id=s,this.dispatcher=g,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=r.W({type:"raster"},d),r.W(this,r.ah(d,["url","scheme","tileSize"]))}load(s){this._loaded=!1,this.fire(new r.f("dataloading",{dataType:"source"})),this._tileJSONRequest=Ch(this._options,this.map._requestManager,null,null,(d,g)=>{this._tileJSONRequest=null,this._loaded=!0,d?this.fire(new r.d(d)):g&&(r.W(this,g),g.bounds&&(this.tileBounds=new Yc(g.bounds,this.minzoom,this.maxzoom)),r.an(g.tiles),this.fire(new r.f("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.f("data",{dataType:"source",sourceDataType:"content"}))),s&&s(d)})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();let s=r.al(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return r.W({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s,d){let g=r.e.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),g,this.tileSize);s.request=r.h(this.map._requestManager.transformRequest(x,r.R.Tile),(b,S,C,F)=>(delete s.request,s.aborted?(s.state="unloaded",d(null)):b?(s.state="errored",d(b)):S?(this.map._refreshExpiredTiles&&s.setExpiryData({cacheControl:C,expires:F}),s.setTexture(S,this.map.painter),s.state="loaded",r.am(this.dispatcher),void d(null)):d(null)))}abortTile(s,d){s.request&&(s.request.cancel(),delete s.request),d&&d()}unloadTile(s,d){s.texture&&s.texture instanceof r.T?(s.destroy(!0),s.texture&&s.texture instanceof r.T&&this.map.painter.saveTileTexture(s.texture)):s.destroy(),d&&d()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Kc extends r.E{constructor(s,d,g,x){if(super(),this.id=s,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,r.W(this,r.ah(d,["url","scheme","tileSize","promoteId"])),this._options=r.W({type:"vector"},d),this._collectResourceTiming=!!d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x),this._tileWorkers={},this._deduped=new r.ao}load(s){this._loaded=!1,this.fire(new r.f("dataloading",{dataType:"source"}));let d=Array.isArray(this.map._language)?this.map._language.join():this.map._language,g=this.map._worldview;this._tileJSONRequest=Ch(this._options,this.map._requestManager,d,g,(x,b)=>{this._tileJSONRequest=null,this._loaded=!0,x?(d&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${d}`),g&&g.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${g}`),this.fire(new r.d(x))):b&&(r.W(this,b),b.bounds&&(this.tileBounds=new Yc(b.bounds,this.minzoom,this.maxzoom)),r.an(b.tiles,this.map._requestManager._customAccessToken),this.fire(new r.f("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.f("data",{dataType:"source",sourceDataType:"content"}))),s&&s(x)})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();let s=r.al(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return r.W({},this._options)}loadTile(s,d){let g=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme)),x=this.map._requestManager.transformRequest(g,r.R.Tile),b=this.map.style?this.map.style.getLut(this.scope):null,S={request:x,data:void 0,uid:s.uid,tileID:s.tileID,tileZoom:s.tileZoom,zoom:s.tileID.overscaledZ,lut:b?{image:b.image.clone()}:null,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:r.e.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:s.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:s.isExtraShadowCaster,tessellationStep:this.map._tessellationStep};if(S.request.collectResourceTiming=this._collectResourceTiming,s.actor&&s.state!=="expired")s.state==="loading"?s.reloadCallback=d:s.request=s.actor.send("reloadTile",S,C.bind(this));else if(s.actor=this._tileWorkers[g]=this._tileWorkers[g]||this.dispatcher.getActor(),this.dispatcher.ready)s.request=s.actor.send("loadTile",S,C.bind(this),void 0,!0);else{let F=r.ap.call({deduped:this._deduped},S,(O,V)=>{O||!V?C.call(this,O):(S.data={cacheControl:V.cacheControl,expires:V.expires,rawData:V.rawData.slice(0)},s.actor&&s.actor.send("loadTile",S,C.bind(this),void 0,!0))},!0);s.request={cancel:F}}function C(F,O){return delete s.request,s.aborted?d(null):F&&F.status!==404?d(F):(O&&O.resourceTiming&&(s.resourceTiming=O.resourceTiming),this.map._refreshExpiredTiles&&O&&s.setExpiryData(O),s.loadVectorData(O,this.map.painter),r.am(this.dispatcher),d(null),void(s.reloadCallback&&(this.loadTile(s,s.reloadCallback),s.reloadCallback=null)))}}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(s,d){s.actor&&s.actor.send("removeTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope}),s.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let _c=m=>({u_matrix:new r.a6(m),u_image0:new r.a7(m),u_skirt_height:new r.aa(m),u_ground_shadow_factor:new r.aq(m)}),hr=(m,s,d)=>({u_matrix:m,u_image0:0,u_skirt_height:s,u_ground_shadow_factor:d}),vf=(m,s,d,g,x,b,S,C,F,O,V,X,ie,ae,ue,de)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:s,u_normalize_matrix:Float32Array.from(g),u_merc_matrix:d,u_zoom_transition:x,u_merc_center:b,u_image0:0,u_frustum_tl:S,u_frustum_tr:C,u_frustum_br:F,u_frustum_bl:O,u_globe_pos:V,u_globe_radius:X,u_viewport:ie,u_grid_matrix:de?Float32Array.from(de):new Float32Array(9),u_skirt_height:ae,u_far_z_cutoff:ue});class vc{constructor(s=0,d=0,g=0,x=0){if(isNaN(s)||s<0||isNaN(d)||d<0||isNaN(g)||g<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=d,this.left=g,this.right=x}interpolate(s,d,g){return d.top!=null&&s.top!=null&&(this.top=r.a2(s.top,d.top,g)),d.bottom!=null&&s.bottom!=null&&(this.bottom=r.a2(s.bottom,d.bottom,g)),d.left!=null&&s.left!=null&&(this.left=r.a2(s.left,d.left,g)),d.right!=null&&s.right!=null&&(this.right=r.a2(s.right,d.right,g)),this}getCenter(s,d){let g=r.at((this.left+s-this.right)/2,0,s),x=r.at((this.top+d-this.bottom)/2,0,d);return new r.P(g,x)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new vc(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ai(m,s){let d=r.aw(m,3);r.ad.fromQuat(m,s),r.az(m,3,d)}function ka(m,s){let d=r.av.identity([]);return r.av.rotateZ(d,d,-s),r.av.rotateX(d,d,-m),d}function yf(m,s){let d=[m[0],m[1],0],g=[s[0],s[1],0];if(r._.length(d)>=1e-15){let S=r._.normalize([],d);r._.scale(g,S,r._.dot(g,S)),s[0]=g[0],s[1]=g[1]}let x=r._.cross([],s,m);if(r._.len(x)<1e-15)return null;let b=Math.atan2(-x[1],x[0]);return ka(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),b)}class yc{constructor(s,d){this.position=s,this.orientation=d}get position(){return this._position}set position(s){if(s){let d=s instanceof r.Y?s:new r.Y(s[0],s[1],s[2]);this._renderWorldCopies&&(d.x=r.au(d.x,0,1)),this._position=d}else this._position=null}lookAtPoint(s,d){if(this.orientation=null,!this.position)return;let g=this.position,x=this._elevation?this._elevation.getAtPointOrZero(r.Y.fromLngLat(s)):0,b=r.Y.fromLngLat(s,x),S=[b.x-g.x,b.y-g.y,b.z-g.z];d||(d=[0,0,1]),d[2]=Math.abs(d[2]),this.orientation=yf(S,d)}setPitchBearing(s,d){this.orientation=ka(r.ab(s),r.ab(-d))}}class xc{constructor(s,d){this._transform=r.ad.identity([]),this.orientation=d,this.position=s}get mercatorPosition(){let s=this.position;return new r.Y(s[0],s[1],s[2])}get position(){let s=r.aw(this._transform,3);return[s[0],s[1],s[2]]}set position(s){var d;s&&r.az(this._transform,3,[(d=s)[0],d[1],d[2],1])}get orientation(){return this._orientation}set orientation(s){this._orientation=s||r.av.identity([]),s&&Ai(this._transform,this._orientation)}getPitchBearing(){let s=this.forward(),d=this.right();return{bearing:Math.atan2(-d[1],d[0]),pitch:Math.atan2(Math.sqrt(s[0]*s[0]+s[1]*s[1]),-s[2])}}setPitchBearing(s,d){this._orientation=ka(s,d),Ai(this._transform,this._orientation)}forward(){let s=r.aw(this._transform,2);return[-s[0],-s[1],-s[2]]}up(){let s=r.aw(this._transform,1);return[-s[0],-s[1],-s[2]]}right(){let s=r.aw(this._transform,0);return[s[0],s[1],s[2]]}getCameraToWorld(s,d){let g=new Float64Array(16);return r.ad.invert(g,this.getWorldToCamera(s,d)),g}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(s,d,g){let x=this.position;r._.scale(x,x,-s);let b=new Float64Array(16);return r.ad.fromScaling(b,[g,g,g]),r.ad.translate(b,b,x),b[10]*=d,b}getWorldToCamera(s,d){let g=new Float64Array(16),x=new Float64Array(4),b=this.position;return r.av.conjugate(x,this._orientation),r._.scale(b,b,-s),r.ad.fromQuat(g,x),r.ad.translate(g,g,b),g[1]*=-1,g[5]*=-1,g[9]*=-1,g[13]*=-1,g[8]*=d,g[9]*=d,g[10]*=d,g[11]*=d,g}getCameraToClipPerspective(s,d,g,x){let b=new Float64Array(16);return r.ad.perspective(b,s,d,g,x),b}getCameraToClipOrthographic(s,d,g,x,b,S){let C=new Float64Array(16);return r.ad.ortho(C,s,d,g,x,b,S),C}getDistanceToElevation(s,d=!1){let g=s===0?0:r.ax(s,d?r.ay(this.position[1]):this.position[1]),x=this.forward();return(g-this.position[2])/x[2]}clone(){return new xc([...this.position],[...this.orientation])}}let Sl={unknown:0,flipRequired:1,flipNotRequired:2},ui=Math.tan(85*Math.PI/180);function Wl(m,s,d,g,x,b,S){let C=r.ad.create();if(d)if(b.name==="globe"){let F=r.aB(x,s);r.ad.multiply(C,C,F)}else{let F=r.aC.invert([],S);C[0]=F[0],C[1]=F[1],C[4]=F[2],C[5]=F[3],g||r.ad.rotateZ(C,C,x.angle)}else r.ad.multiply(C,x.labelPlaneMatrix,m);return C}function ql(m,s,d,g,x,b,S){let C=Wl(m,s,d,g,x,b,S);return b.name==="globe"&&d||(C[2]=C[6]=C[10]=C[14]=0),C}function bc(m,s,d,g,x,b,S){if(d){if(b.name==="globe"){let C=Wl(m,s,d,g,x,b,S);return r.ad.invert(C,C),r.ad.multiply(C,m,C),C}{let C=r.ad.clone(m),F=r.ad.identity([]);return F[0]=S[0],F[1]=S[1],F[4]=S[2],F[5]=S[3],r.ad.multiply(C,C,F),g||r.ad.rotateZ(C,C,-x.angle),C}}return x.glCoordMatrix}function lo(m,s,d,g){let x=[m,s,d,1];d?r.aA.transformMat4(x,x,g):_s(x,x,g);let b=x[3];return x[0]/=b,x[1]/=b,x[2]/=b,x}function Ma(m,s){return Math.min(.5+m/s*.5,1.5)}function Ip(m,s){let d=m[0]/m[3],g=m[1]/m[3];return d>=-s[0]&&d<=s[0]&&g>=-s[1]&&g<=s[1]}function El(m,s,d,g,x,b,S,C,F,O){let V=d.transform,X=g?m.textSizeData:m.iconSizeData,ie=r.aD(X,d.transform.zoom),ae=V.projection.name==="globe",ue=[256/d.width*2+1,256/d.height*2+1],de=g?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;de.clear();let fe=null;ae&&(fe=g?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);let me=m.lineVertexArray,Pe=g?m.text.placedSymbolArray:m.icon.placedSymbolArray,Oe=d.transform.width/d.transform.height,Ne,Je=!1;for(let Ke=0;Ke<Pe.length;Ke++){let Fe=Pe.get(Ke),{numGlyphs:Be,writingMode:je}=Fe;if(je!==r.aE.vertical||Je||Ne===r.aE.horizontal||(Je=!0),Ne=je,(Fe.hidden||je===r.aE.vertical)&&!Je){Al(Be,de);continue}Je=!1;let at=new r.P(Fe.tileAnchorX,Fe.tileAnchorY),{x:xt,y:qe,z:bt}=V.projection.projectTilePoint(at.x,at.y,O.canonical);if(F){let[Cr,mr,Yt]=F(at);xt+=Cr,qe+=mr,bt+=Yt}let Ct=[xt,qe,bt,1];if(r.aA.transformMat4(Ct,Ct,s),!Ip(Ct,ue)){Al(Be,de);continue}let Gt=Ct[3],qt=Ma(d.transform.getCameraToCenterDistance(V.projection),Gt),Vt=r.aF(X,ie,Fe),ft=S?Vt/qt:Vt*qt,kt=lo(xt,qe,bt,x);if(kt[3]<=0){Al(Be,de);continue}let jt={},dr=S?null:F,pr=wc(Fe,ft,!1,C,s,x,b,m.glyphOffsetArray,me,de,fe,kt,at,jt,Oe,dr,V.projection,O,S);Je=pr.useVertical,dr&&pr.needsFlipping&&(jt={}),(pr.notEnoughRoom||Je||pr.needsFlipping&&wc(Fe,ft,!0,C,s,x,b,m.glyphOffsetArray,me,de,fe,kt,at,jt,Oe,dr,V.projection,O,S).notEnoughRoom)&&Al(Be,de)}g?(m.text.dynamicLayoutVertexBuffer.updateData(de),fe&&m.text.globeExtVertexBuffer&&m.text.globeExtVertexBuffer.updateData(fe)):(m.icon.dynamicLayoutVertexBuffer.updateData(de),fe&&m.icon.globeExtVertexBuffer&&m.icon.globeExtVertexBuffer.updateData(fe))}function gs(m,s,d,g,x,b,S,C,F,O,V,X,ie,ae,ue,de){let{lineStartIndex:fe,glyphStartIndex:me,segment:Pe}=C,Oe=me+C.numGlyphs,Ne=fe+C.lineLength,Je=s.getoffsetX(me),Ke=s.getoffsetX(Oe-1),Fe=Jc(m*Je,d,g,x,b,S,Pe,fe,Ne,F,O,V,X,ie,!0,ae,ue,de);if(!Fe)return null;let Be=Jc(m*Ke,d,g,x,b,S,Pe,fe,Ne,F,O,V,X,ie,!0,ae,ue,de);return Be?{first:Fe,last:Be}:null}function Du(m,s,d,g){return m===r.aE.horizontal&&Math.abs(g)>Math.abs(d)?{useVertical:!0}:m===r.aE.vertical?g>0?{needsFlipping:!0}:null:s!==Sl.unknown&&function(x,b){return x===0||Math.abs(b/x)>ui}(d,g)?s===Sl.flipRequired?{needsFlipping:!0}:null:d<0?{needsFlipping:!0}:null}function wc(m,s,d,g,x,b,S,C,F,O,V,X,ie,ae,ue,de,fe,me,Pe){let Oe=s/24,Ne=m.lineOffsetX*Oe,Je=m.lineOffsetY*Oe,{lineStartIndex:Ke,glyphStartIndex:Fe,numGlyphs:Be,segment:je,writingMode:at,flipState:xt}=m,qe=Ke+m.lineLength,bt=Ct=>{if(V){let[ft,kt,jt]=Ct.up,dr=O.length;r.aG(V,dr+0,ft,kt,jt),r.aG(V,dr+1,ft,kt,jt),r.aG(V,dr+2,ft,kt,jt),r.aG(V,dr+3,ft,kt,jt)}let[Gt,qt,Vt]=Ct.point;r.aH(O,Gt,qt,Vt,Ct.angle)};if(Be>1){let Ct=gs(Oe,C,Ne,Je,d,X,ie,m,F,b,ae,de,!1,fe,me,Pe);if(!Ct)return{notEnoughRoom:!0};if(g&&!d){let[Gt,qt,Vt]=Ct.first.point,[ft,kt,jt]=Ct.last.point;[Gt,qt]=lo(Gt,qt,Vt,S),[ft,kt]=lo(ft,kt,jt,S);let dr=Du(at,xt,(ft-Gt)*ue,kt-qt);if(m.flipState=dr&&dr.needsFlipping?Sl.flipRequired:Sl.flipNotRequired,dr)return dr}bt(Ct.first);for(let Gt=Fe+1;Gt<Fe+Be-1;Gt++){let qt=Jc(Oe*C.getoffsetX(Gt),Ne,Je,d,X,ie,je,Ke,qe,F,b,ae,de,!1,!1,fe,me,Pe);if(!qt)return O.length-=4*(Gt-Fe),{notEnoughRoom:!0};bt(qt)}bt(Ct.last)}else{if(g&&!d){let Gt=lo(ie.x,ie.y,0,x),qt=Ke+je+1,Vt=new r.P(F.getx(qt),F.gety(qt)),ft=lo(Vt.x,Vt.y,0,x),kt=ft[3]>0?ft:$l(ie,Vt,Gt,1,x,void 0,fe,me.canonical),jt=Du(at,xt,(kt[0]-Gt[0])*ue,kt[1]-Gt[1]);if(m.flipState=jt&&jt.needsFlipping?Sl.flipRequired:Sl.flipNotRequired,jt)return jt}let Ct=Jc(Oe*C.getoffsetX(Fe),Ne,Je,d,X,ie,je,Ke,qe,F,b,ae,de,!1,!1,fe,me,Pe);if(!Ct)return{notEnoughRoom:!0};bt(Ct)}return{}}function Ih(m,s,d,g,x){let{x:b,y:S,z:C}=g.projectTilePoint(m.x,m.y,s);if(!x)return lo(b,S,C,d);let[F,O,V]=x(m);return lo(b+F,S+O,C+V,d)}function $l(m,s,d,g,x,b,S,C){let F=Ih(m.sub(s)._unit()._add(m),C,x,S,b);return r._.sub(F,d,F),r._.normalize(F,F),r._.scaleAndAdd(F,d,F,g)}function Jc(m,s,d,g,x,b,S,C,F,O,V,X,ie,ae,ue,de,fe,me){let Pe=g?m-s:m+s,Oe=Pe>0?1:-1,Ne=0;g&&(Oe*=-1,Ne=Math.PI),Oe<0&&(Ne+=Math.PI);let Je=C+S+(Oe>0?0:1)|0,Ke=x,Fe=x,Be=0,je=0,at=Math.abs(Pe),xt=[],qe=[],bt=b,Ct=bt,Gt=()=>$l(Ct,bt,Fe,at-Be+1,V,ie,de,fe.canonical);for(;Be+je<=at;){if(Je+=Oe,Je<C||Je>=F)return null;if(Fe=Ke,Ct=bt,xt.push(Fe),ae&&qe.push(Ct),bt=new r.P(O.getx(Je),O.gety(Je)),Ke=X[Je],!Ke){let mr=Ih(bt,fe.canonical,V,de,ie);Ke=mr[3]>0?X[Je]=mr:Gt()}Be+=je,je=r._.distance(Fe,Ke)}ue&&ie&&(X[Je]&&(Ke=Gt(),je=r._.distance(Fe,Ke)),X[Je]=Ke);let qt=(at-Be)/je,Vt=bt.sub(Ct)._mult(qt)._add(Ct),ft=r._.sub([],Ke,Fe),kt=r._.scaleAndAdd([],Fe,ft,qt),jt=[0,0,1],dr=ft[0],pr=ft[1];if(me&&(jt=de.upVector(fe.canonical,Vt.x,Vt.y),jt[0]!==0||jt[1]!==0||jt[2]!==1)){let mr=[jt[2],0,-jt[0]],Yt=r._.cross([],jt,mr);r._.normalize(mr,mr),r._.normalize(Yt,Yt),dr=r._.dot(ft,mr),pr=r._.dot(ft,Yt)}if(d){let mr=r._.cross([],jt,ft);r._.normalize(mr,mr),r._.scaleAndAdd(kt,kt,mr,d*Oe)}let Cr=Ne+Math.atan2(pr,dr);return xt.push(kt),ae&&qe.push(Vt),{point:kt,angle:Cr,path:xt,tilePath:qe,up:jt}}function Al(m,s){let d=s.length,g=d+4*m;s.resize(g),s.float32.fill(-1/0,4*d,4*g)}function _s(m,s,d){let g=s[0],x=s[1];return m[0]=d[0]*g+d[4]*x+d[12],m[1]=d[1]*g+d[5]*x+d[13],m[3]=d[3]*g+d[7]*x+d[15],m}let kh=(m,s,d)=>(1-d)*m+d*s,Wn=m=>m*m*m*m*m;class vs{constructor(s,d,g,x,b,S,C){this.tileSize=512,this._renderWorldCopies=b===void 0||b,this._minZoom=s||0,this._maxZoom=d||22,this._minPitch=g??0,this._maxPitch=x??60,this.setProjection(S),this.setMaxBounds(C),this.width=0,this.height=0,this._center=new r.aI(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new vc,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new xc,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){let s=new vs(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return s._elevation=this._elevation,s._centerAltitude=this._centerAltitude,s._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,s.tileSize=this.tileSize,s.mercatorFromTransition=this.mercatorFromTransition,s.width=this.width,s.height=this.height,s.cameraElevationReference=this.cameraElevationReference,s._center=this._center,s._setZoom(this.zoom),s._seaLevelZoom=this._seaLevelZoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._nearZ=this._nearZ,s._farZ=this._farZ,s._averageElevation=this._averageElevation,s._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._camera=this._camera.clone(),s._calcMatrices(),s.freezeTileCoverage=this.freezeTileCoverage,s.frustumCorners=this.frustumCorners,s}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(s){this._elevation!==s&&(this._elevation=s,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(s,d=!1){let g=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||g)&&this._updateCameraOnTerrain(),(s||g)&&this._constrainCamera(d),this._calcMatrices()}getProjection(){return r.ah(this.projection,["name","center","parallels"])}setProjection(s){this.projectionOptions=s||{name:"mercator"};let d=this.projection?this.getProjection():void 0;this.projection=r.aJ(this.projectionOptions);let g=!_(d,this.getProjection());return g&&this._calcMatrices(),this.mercatorFromTransition=!1,g}setOrthographicProjectionAtLowPitch(s){return this._orthographicProjectionAtLowPitch!==s&&(this._orthographicProjectionAtLowPitch=s,this._calcMatrices(),!0)}setMercatorFromTransition(){let s=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=r.aJ({name:"mercator"});let d=s!==this.projection.name;return d&&this._calcMatrices(),d}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){let s=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get cameraWorldSize(){let s=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return r.ax(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new r.P(this.width,this.height)}get bearing(){return r.au(this.rotation,-180,180)}set bearing(s){this.rotation=s}get rotation(){return-this.angle/Math.PI*180}set rotation(s){let d=-s*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=r.aC.create(),r.aC.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){let d=r.at(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){let s=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/s)}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=r.ab(s),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(s){this._averageElevation=s,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(s){let d=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._setZoom(d),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(s){this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(s){this._tileCoverLift!==s&&(this._tileCoverLift=s)}_updateCameraOnTerrain(){let s=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,d=this.elevation&&s===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||s===Number.NEGATIVE_INFINITY&&(!d||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);let g=this._elevation;d||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&g.exaggeration()&&this._centerAltitudeValidForExaggeration!==g.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*g.exaggeration(),this._centerAltitudeValidForExaggeration=g.exaggeration()):(this._centerAltitude=s||0,this._centerAltitudeValidForExaggeration=g.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;let s=this._elevation,d=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],g=this.horizonLineFromTop(),x=0,b=0;for(let S=0;S<d.length;S++){let C=new r.P(d[S][0]*this.width,g+d[S][1]*(this.height-g)),F=s.pointCoordinate(C);if(!F)continue;let O=1/Math.hypot(F[0]-this._camera.position[0],F[1]-this._camera.position[1]);x+=F[3]*O,b+=O}return b===0?NaN:x/b}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;let s=this._seaLevelZoom,d=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),g=this.pixelsPerMeter/this.worldSize*d,x=this._mercatorZfromZoom(s),b=this._mercatorZfromZoom(this._maxZoom),S=Math.max(x-g,b);this._setZoom(this._zoomFromMercatorZ(S))}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}computeZoomRelativeTo(s){let d=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,s.toAltitude())),g;g=s.z<this._camera.position[2]?[d.x,d.y,d.z]:[s.x,s.y,s.z];let x=r._.length(r._.sub([],this._camera.position,g));return r.at(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(s){if(!this.height||!s.position&&!s.orientation)return;this._updateCameraState();let d=!1;if(s.orientation&&!r.av.exactEquals(s.orientation,this._camera.orientation)&&(d=this._setCameraOrientation(s.orientation)),s.position){let g=[s.position.x,s.position.y,s.position.z];r._.exactEquals(g,this._camera.position)||(this._setCameraPosition(g),d=!0)}d&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();let s=this._camera.position,d=new yc;return d.position=new r.Y(s[0],s[1],s[2]),d.orientation=this._camera.orientation,d._elevation=this.elevation,d._renderWorldCopies=this.renderWorldCopies,d}_setCameraOrientation(s){if(!r.av.length(s))return!1;r.av.normalize(s,s);let d=r._.transformQuat([],[0,0,-1],s),g=r._.transformQuat([],[0,-1,0],s);if(g[2]<0)return!1;let x=yf(d,g);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(s){let d=this.zoomScale(this.minZoom)*this.tileSize,g=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;s[2]=r.at(s[2],x/g,x/d),this._camera.position=s}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,d,g){this._unmodified=!1,this._edgeInsets.interpolate(s,d,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){let d=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(s){let d=[new r.aK(0,s)];if(this.renderWorldCopies){let g=this.pointCoordinate(new r.P(0,0)),x=this.pointCoordinate(new r.P(this.width,0)),b=this.pointCoordinate(new r.P(this.width,this.height)),S=this.pointCoordinate(new r.P(0,this.height)),C=Math.floor(Math.min(g.x,x.x,b.x,S.x)),F=Math.floor(Math.max(g.x,x.x,b.x,S.x)),O=1;for(let V=C-O;V<=F+O;V++)V!==0&&d.push(new r.aK(V,s))}return d}isLODDisabled(s){return(!s||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(s,d,g){let x=[];if(d[0]===0&&d[1]===0)return x;for(let S of s){let C=S.canonical,F=S.overscaledZ,O=S.wrap,V=1<<C.z,X=C.x+1<V,ie=C.x>0,ae=C.y+1<V,ue=C.y>0,de=S.wrap-(ie?0:1),fe=S.wrap+(X?0:1),me=ie?C.x-1:V-1,Pe=X?C.x+1:0;d[0]<0?(x.push(new r.aL(F,fe,C.z,Pe,C.y)),d[1]<0&&ae&&(x.push(new r.aL(F,O,C.z,C.x,C.y+1)),x.push(new r.aL(F,fe,C.z,Pe,C.y+1))),d[1]>0&&ue&&(x.push(new r.aL(F,O,C.z,C.x,C.y-1)),x.push(new r.aL(F,fe,C.z,Pe,C.y-1)))):d[0]>0?(x.push(new r.aL(F,de,C.z,me,C.y)),d[1]<0&&ae&&(x.push(new r.aL(F,O,C.z,C.x,C.y+1)),x.push(new r.aL(F,de,C.z,me,C.y+1))),d[1]>0&&ue&&(x.push(new r.aL(F,O,C.z,C.x,C.y-1)),x.push(new r.aL(F,de,C.z,me,C.y-1)))):d[1]<0&&ae?x.push(new r.aL(F,O,C.z,C.x,C.y+1)):ue&&x.push(new r.aL(F,O,C.z,C.x,C.y-1))}if(x.length>1){x.sort((F,O)=>F.overscaledZ-O.overscaledZ||F.wrap-O.wrap||F.canonical.z-O.canonical.z||F.canonical.x-O.canonical.x||F.canonical.y-O.canonical.y);let S=0,C=0;for(;C<x.length;)x[C].equals(x[S])?++C:x[++S]=x[C++];x.length=S+1}let b=[];for(let S of x)x.some(C=>S.isChildOf(C))||b.push(S);return x=b.filter(S=>!s.some(C=>!!(S.overscaledZ<g&&C.isChildOf(S))||S.equals(C)||S.isChildOf(C))),x}coveringTiles(s){let d=this.coveringZoomLevel(s),g=d,x=this.elevation&&this.elevation.exaggeration(),b=x&&!s.isTerrainDEM,S=this.projection.name==="mercator";if(s.minzoom!==void 0&&d<s.minzoom)return[];s.maxzoom!==void 0&&d>s.maxzoom&&(d=s.maxzoom);let C=this.locationCoordinate(this.center),F=this.center.lat,O=1<<d,V=[O*C.x,O*C.y,0],X=this.projection.name==="globe",ie=!X,ae=r.aM.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d,ie),ue=X?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),de=O*r.ax(1,this.center.lat),fe=this._camera.position[2]/r.ax(1,this.center.lat),me=[O*ue.x,O*ue.y,fe*(ie?1:de)],Pe=X||x,Oe=this.cameraToCenterDistance/s.tileSize*(s.roundZoom?1:.502),Ne=this.isLODDisabled(!0)?d:0,Je;if(this._elevation&&s.isTerrainDEM)Je=1e4*this._elevation.exaggeration();else if(this._elevation){let ft=this._elevation.getMinMaxForVisibleTiles();Je=ft?ft.max:this._centerAltitude}else Je=this._centerAltitude;let Ke=s.isTerrainDEM?-Je:this._elevation?this._elevation.getMinElevationBelowMSL():0,Fe=this.projection.isReprojectedInTileSpace?r.aN(this):1,Be=ft=>{let jt=new r.Y(ft.x+25e-6,ft.y,ft.z),dr=new r.Y(ft.x,ft.y+25e-6,ft.z),pr=ft.toLngLat(),Cr=jt.toLngLat(),mr=dr.toLngLat(),Yt=this.locationCoordinate(pr),Nt=this.locationCoordinate(Cr),Pr=this.locationCoordinate(mr),_i=Math.hypot(Nt.x-Yt.x,Nt.y-Yt.y),oi=Math.hypot(Pr.x-Yt.x,Pr.y-Yt.y);return Math.sqrt(_i*oi)*Fe/25e-6},je=ft=>{let kt=Je,jt=Ke;return{aabb:r.aQ(this,O,0,0,0,ft,jt,kt,this.projection),zoom:0,x:0,y:0,minZ:jt,maxZ:kt,wrap:ft,fullyVisible:!1}},at=[],xt=[],qe=d,bt=s.reparseOverscaled?g:d,Ct=ft=>ft*ft,Gt=Ct((fe-this._centerAltitude)*de),qt=ft=>{if(!this._elevation||!ft.tileID||!S)return;let kt=this._elevation.getMinMaxForTile(ft.tileID),jt=ft.aabb;kt?(jt.min[2]=kt.min,jt.max[2]=kt.max,jt.center[2]=(jt.min[2]+jt.max[2])/2):(ft.shouldSplit=Vt(ft),ft.shouldSplit||(jt.min[2]=jt.max[2]=jt.center[2]=this._centerAltitude))},Vt=ft=>{if(ft.zoom<Ne)return!0;if(ft.zoom===qe)return!1;if(ft.shouldSplit!=null)return ft.shouldSplit;let kt=ft.aabb.distanceX(me),jt=ft.aabb.distanceY(me),dr=Gt,pr=1;if(X){dr=Ct(ft.aabb.distanceZ(me));let Yt=Math.pow(2,ft.zoom),Nt=r.ay((ft.y+1)/Yt),Pr=r.ay(ft.y/Yt),_i=Math.min(Math.max(F,Nt),Pr),oi=r.b4(_i)/r.b4(F);if(pr=_i===F?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,oi/this._mercatorScaleRatio),this.zoom<=r.b1&&ft.zoom===qe-1&&oi>=.9)return!0}else if(b&&(dr=Ct(ft.aabb.distanceZ(me)*de)),this.projection.isReprojectedInTileSpace&&g<=5){let Yt=Math.pow(2,ft.zoom),Nt=Be(new r.Y((ft.x+.5)/Yt,(ft.y+.5)/Yt));pr=Nt>.85?1:Nt}let Cr=kt*kt+jt*jt+dr,mr=Ct((1<<qe-ft.zoom)*Oe*pr*((Yt,Nt)=>{if(Nt*Ct(.707)<Yt)return 1;let Pr=Math.sqrt(Nt/Yt);return Pr/(1.4144271570014144+(Math.pow(1.1,Pr-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(dr,Gt),Cr));return Cr<mr};if(this.renderWorldCopies)for(let ft=1;ft<=3;ft++)at.push(je(-ft)),at.push(je(ft));for(at.push(je(0));at.length>0;){let ft=at.pop(),kt=ft.x,jt=ft.y,dr=ft.fullyVisible,pr=()=>this.projection.name==="globe"&&(ft.y===0||ft.y===(1<<ft.zoom)-1);if(!dr){let Cr=Pe?ft.aabb.intersects(ae):ft.aabb.intersectsFlat(ae);if(Cr===0&&pr()){let mr=new r.aO(ft.zoom,kt,jt);Cr=r.aP(this,O,mr,!0).intersects(ae)}if(Cr===0)continue;dr=Cr===2}if(ft.zoom!==qe&&Vt(ft))for(let Cr=0;Cr<4;Cr++){let mr=(kt<<1)+Cr%2,Yt=(jt<<1)+(Cr>>1),Nt={aabb:S?ft.aabb.quadrant(Cr):r.aQ(this,O,ft.zoom+1,mr,Yt,ft.wrap,ft.minZ,ft.maxZ,this.projection),zoom:ft.zoom+1,x:mr,y:Yt,wrap:ft.wrap,fullyVisible:dr,tileID:void 0,shouldSplit:void 0,minZ:ft.minZ,maxZ:ft.maxZ};b&&!X&&(Nt.tileID=new r.aL(ft.zoom+1===qe?bt:ft.zoom+1,ft.wrap,ft.zoom+1,mr,Yt),qt(Nt)),at.push(Nt)}else{let Cr=ft.zoom===qe?bt:ft.zoom;if(s.minzoom&&s.minzoom>Cr)continue;if(!dr){let Pr=Pe?ft.aabb.intersectsPrecise(ae):ft.aabb.intersectsPreciseFlat(ae);if(Pr===0&&pr()){let _i=new r.aO(ft.zoom,kt,jt);Pr=r.aP(this,O,_i,!0).intersectsPrecise(ae)}if(Pr===0)continue}let mr=V[0]-(.5+kt+(ft.wrap<<ft.zoom))*(1<<d-ft.zoom),Yt=V[1]-.5-jt,Nt=ft.tileID?ft.tileID:new r.aL(Cr,ft.wrap,ft.zoom,kt,jt);xt.push({tileID:Nt,distanceSq:mr*mr+Yt*Yt})}}if(this.fogCullDistSq){let ft=this.fogCullDistSq,kt=this.horizonLineFromTop();xt=xt.filter(jt=>{let dr=[0,0,0,1],pr=[r.a3,r.a3,0,1],Cr=this.calculateFogTileMatrix(jt.tileID.toUnwrapped());r.aA.transformMat4(dr,dr,Cr),r.aA.transformMat4(pr,pr,Cr);let mr=r.aA.min([],dr,pr),Yt=r.aA.max([],dr,pr),Nt=r.aR(mr,Yt);if(Nt===0)return!0;let Pr=!1,_i=this._elevation;if(_i&&Nt>ft&&kt!==0){let oi=this.calculateProjMatrix(jt.tileID.toUnwrapped()),Di;s.isTerrainDEM||(Di=_i.getMinMaxForTile(jt.tileID)),Di||(Di={min:Ke,max:Je});let Xi=r.b2(this.rotation),_n=[Xi[0]*r.a3,Xi[1]*r.a3,Di.max];r._.transformMat4(_n,_n,oi),Pr=(1-_n[1])*this.height*.5<kt}return Nt<ft||Pr})}return xt.sort((ft,kt)=>ft.distanceSq-kt.distanceSq).map(ft=>ft.tileID)}resize(s,d){this.width=s,this.height=d,this.pixelsToGLUnits=[2/s,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log(s)/Math.LN2}project(s){let d=r.at(s.lat,-r.aS,r.aS),g=this.projection.project(s.lng,d);return new r.P(g.x*this.worldSize,g.y*this.worldSize)}unproject(s){return this.projection.unproject(s.x/this.worldSize,s.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/r.ax(1,this.center.lat)/this.worldSize}setLocationAtPoint(s,d){let g,x,b=this.centerPoint;if(this.projection.name==="globe"){let C=this.worldSize;g=(d.x-b.x)/C,x=(d.y-b.y)/C}else{let C=this.pointCoordinate(d),F=this.pointCoordinate(b);g=C.x-F.x,x=C.y-F.y}let S=this.locationCoordinate(s);this.setLocation(new r.Y(S.x-g,S.y-x))}setLocation(s){this.center=this.coordinateLocation(s),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(s){return this.projection.locationPoint(this,s)}locationPoint3D(s){return this.projection.locationPoint(this,s,!0)}pointLocation(s){return this.coordinateLocation(this.pointCoordinate(s))}pointLocation3D(s){return this.coordinateLocation(this.pointCoordinate3D(s))}locationCoordinate(s,d){let g=d?r.ax(d,s.lat):void 0,x=this.projection.project(s.lng,s.lat);return new r.Y(x.x,x.y,g)}coordinateLocation(s){return this.projection.unproject(s.x,s.y)}pointRayIntersection(s,d){let g=d??this._centerAltitude,x=[s.x,s.y,0,1],b=[s.x,s.y,1,1];r.aA.transformMat4(x,x,this.pixelMatrixInverse),r.aA.transformMat4(b,b,this.pixelMatrixInverse);let S=b[3];r.aA.scale(x,x,1/x[3]),r.aA.scale(b,b,1/S);let C=x[2],F=b[2];return{p0:x,p1:b,t:C===F?0:(g-C)/(F-C)}}screenPointToMercatorRay(s){let d=[s.x,s.y,0,1],g=[s.x,s.y,1,1];return r.aA.transformMat4(d,d,this.pixelMatrixInverse),r.aA.transformMat4(g,g,this.pixelMatrixInverse),r.aA.scale(d,d,1/d[3]),r.aA.scale(g,g,1/g[3]),d[2]=r.ax(d[2],this._center.lat)*this.worldSize,g[2]=r.ax(g[2],this._center.lat)*this.worldSize,r.aA.scale(d,d,1/this.worldSize),r.aA.scale(g,g,1/this.worldSize),new r.aT([d[0],d[1],d[2]],r._.normalize([],r._.sub([],g,d)))}rayIntersectionCoordinate(s){let{p0:d,p1:g,t:x}=s,b=r.ax(d[2],this._center.lat),S=r.ax(g[2],this._center.lat);return new r.Y(r.a2(d[0],g[0],x)/this.worldSize,r.a2(d[1],g[1],x)/this.worldSize,r.a2(b,S,x))}pointCoordinate(s,d=this._centerAltitude){return this.projection.pointCoordinate(this,s.x,s.y,d)}pointCoordinate3D(s){if(!this.elevation)return this.pointCoordinate(s);let d=this.projection.pointCoordinate3D(this,s.x,s.y);if(d)return new r.Y(d[0],d[1],d[2]);let g=0,x=this.horizonLineFromTop();if(s.y>x)return this.pointCoordinate(s);let b=.02*x,S=s.clone();for(let C=0;C<10&&x-g>b;C++){S.y=r.a2(g,x,.66);let F=this.projection.pointCoordinate3D(this,S.x,S.y);F?(x=S.y,d=F):g=S.y}return d?new r.Y(d[0],d[1],d[2]):this.pointCoordinate(s)}isPointAboveHorizon(s){return this.projection.isPointAboveHorizon(this,s)}isPointOnSurface(s){if(s.y<0||s.y>this.height||s.x<0||s.x>this.width)return!1;if(this.elevation||this.zoom>=r.aU)return!this.isPointAboveHorizon(s);let d=this.pointCoordinate(s);return d.y>=0&&d.y<=1}_coordinatePoint(s,d){let g=d&&this.elevation?this.elevation.getAtPointOrZero(s,this._centerAltitude):this._centerAltitude,x=[s.x*this.worldSize,s.y*this.worldSize,g+s.toAltitude(),1];return r.aA.transformMat4(x,x,this.pixelMatrix),x[3]>0?new r.P(x[0]/x[3],x[1]/x[3]):new r.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){let{top:s,left:d}=this._edgeInsets,g=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,b=this.pointLocation3D(new r.P(d,s)),S=this.pointLocation3D(new r.P(x,s)),C=this.pointLocation3D(new r.P(x,g)),F=this.pointLocation3D(new r.P(d,g)),O=Math.min(b.lng,S.lng,C.lng,F.lng),V=Math.max(b.lng,S.lng,C.lng,F.lng),X=Math.min(b.lat,S.lat,C.lat,F.lat),ie=Math.max(b.lat,S.lat,C.lat,F.lat),ae=Math.pow(2,-this.zoom)/16*270,ue=this.projection.name==="globe"?1:4,de=(fe,me,Pe,Oe,Ne)=>{let Je=(fe+Pe)/2,Ke=(me+Oe)/2,Fe=new r.P(Je,Ke),{lng:Be,lat:je}=this.pointLocation3D(Fe),at=Math.max(0,O-Be,X-je,Be-V,je-ie);O=Math.min(O,Be),V=Math.max(V,Be),X=Math.min(X,je),ie=Math.max(ie,je),(Ne<ue||at>ae)&&(de(fe,me,Je,Ke,Ne+1),de(Je,Ke,Pe,Oe,Ne+1))};if(de(d,s,x,s,1),de(x,s,x,g,1),de(x,g,d,g,1),de(d,g,d,s,1),this.projection.name==="globe"){let[fe,me]=r.aV(this);fe?(ie=90,V=180,O=-180):me&&(X=-90,V=180,O=-180)}return new r.ai(new r.aI(O,X),new r.aI(V,ie))}_getBoundsRectangular(s,d){let{top:g,left:x}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,C=new r.P(x,g),F=new r.P(S,g),O=new r.P(S,b),V=new r.P(x,b),X=this.pointCoordinate(C,s),ie=this.pointCoordinate(F,s),ae=this.pointCoordinate(O,d),ue=this.pointCoordinate(V,d),de=(fe,me)=>(me.y-fe.y)/(me.x-fe.x);return X.y>1&&ie.y>=0?X=new r.Y((1-ue.y)/de(ue,X)+ue.x,1):X.y<0&&ie.y<=1&&(X=new r.Y(-ue.y/de(ue,X)+ue.x,0)),ie.y>1&&X.y>=0?ie=new r.Y((1-ae.y)/de(ae,ie)+ae.x,1):ie.y<0&&X.y<=1&&(ie=new r.Y(-ae.y/de(ae,ie)+ae.x,0)),new r.ai().extend(this.coordinateLocation(X)).extend(this.coordinateLocation(ie)).extend(this.coordinateLocation(ue)).extend(this.coordinateLocation(ae))}_getBoundsRectangularTerrain(){let s=this.elevation;if(!s.visibleDemTiles.length||s.isUsingMockSource())return this._getBoundsRectangular(0,0);let d=s.visibleDemTiles.reduce((g,x)=>{if(x.dem){let b=x.dem.tree;g.min=Math.min(g.min,b.minimums[0]),g.max=Math.max(g.max,b.maximums[0])}return g},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(d.min*s.exaggeration(),d.max*s.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(s=!0){let d=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,g=this.height/2-d*(1-this._horizonShift);return s?Math.max(0,g):g}getMaxBounds(){return this.maxBounds}setMaxBounds(s){this.maxBounds=s,this.minLat=-r.aS,this.maxLat=r.aS,this.minLng=-180,this.maxLng=180,s&&(this.minLat=s.getSouth(),this.maxLat=s.getNorth(),this.minLng=s.getWest(),this.maxLng=s.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=r.aj(this.minLng)*this.tileSize,this.worldMaxX=r.aj(this.maxLng)*this.tileSize,this.worldMinY=r.ak(this.maxLat)*this.tileSize,this.worldMaxY=r.ak(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(s,d){return this.projection.createTileMatrix(this,d,s)}calculateDistanceTileData(s){let d=s.key,g=this._distanceTileDataCache;if(g[d])return g[d];let x=s.canonical,b=1/this.height,S=this.cameraWorldSize,C=S/this.zoomScale(x.z),F=(x.x+Math.pow(2,x.z)*s.wrap)*C,O=x.y*C,V=this.point;V.x*=S/this.worldSize,V.y*=S/this.worldSize;let X=this.angle,ie=Math.sin(-X),ae=-Math.cos(-X);return g[d]={bearing:[ie,ae],center:[(V.x-F)*b,(V.y-O)*b],scale:C/r.a3*b},g[d]}calculateFogTileMatrix(s){let d=s.key,g=this._fogTileMatrixCache;if(g[d])return g[d];let x=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,s);return r.ad.multiply(x,this.worldToFogMatrix,x),g[d]=new Float32Array(x),g[d]}calculateProjMatrix(s,d=!1,g=!1){let x=s.key,b;if(b=g?this._expandedProjMatrixCache:d?this._alignedProjMatrixCache:this._projMatrixCache,b[x])return b[x];let S=this.calculatePosMatrix(s,this.worldSize),C;return C=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:g?this.expandedFarZProjMatrix:d?this.alignedProjMatrix:this.projMatrix,r.ad.multiply(S,C,S),b[x]=new Float32Array(S),b[x]}calculatePixelsToTileUnitsMatrix(s){let d=s.tileID.key,g=this._pixelsToTileUnitsCache;if(g[d])return g[d];let x=r.aW(s,this);return g[d]=x,g[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){let s=1/this.worldSize,d=r.ad.fromScaling([],[s,s,s]);return r.ad.multiply(d,d,this.globeMatrix),d}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;let s=this._elevation;this._updateCameraState();let d=r.ax(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(d),x=this._camera.forward(),b=r.ax(1,this._center.lat);g[2]/=b,x[2]/=b,r._.normalize(x,x);let S=s.raycast(g,x,s.exaggeration());if(S){let C=r._.scaleAndAdd([],g,x,S),F=new r.Y(C[0],C[1],r.ax(C[2],r.ay(C[1]))),O=(F.z+r._.length([F.x-g[0],F.y-g[1],F.z-g[2]*b]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(O),this._centerAltitude=F.toAltitude(),this._center=this.coordinateLocation(F),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(s=!1){if(!this._elevation)return;let d=this._elevation,g=r.ax(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(g),b=d.getAtPointOrZero(new r.Y(...x)),S=this.pixelsPerMeter/this.worldSize*b,C=this._minimumHeightOverTerrain(),F=x[2]-S;if(F<=C)if(F<0||s){let O=this.locationCoordinate(this._center,this._centerAltitude),V=[x[0],x[1],O.z-x[2]],X=r._.length(V);V[2]-=(C-F)/this._pixelsPerMercatorPixel;let ie=r._.length(V);if(ie===0)return;r._.scale(V,V,X/ie*this._pixelsPerMercatorPixel),this._camera.position=[x[0],x[1],O.z*this._pixelsPerMercatorPixel-V[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let s=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||s){let ie=this.center;return ie.lat=r.at(ie.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!s)&&(ie.lng=r.at(ie.lng,this.minLng,this.maxLng)),this.center=ie,void(this._constraining=!1)}let d=this._unmodified,{x:g,y:x}=this.point,b=0,S=g,C=x,F=this.width/2,O=this.height/2,V=this.worldMinY*this.scale,X=this.worldMaxY*this.scale;if(x-O<V&&(C=V+O),x+O>X&&(C=X-O),X-V<this.height&&(b=Math.max(b,this.height/(X-V)),C=(X+V)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){let ie=this.worldMinX*this.scale,ae=this.worldMaxX*this.scale,ue=this.worldSize/2-(ie+ae)/2;S=(g+ue+this.worldSize)%this.worldSize-ue,S-F<ie&&(S=ie+F),S+F>ae&&(S=ae-F),ae-ie<this.width&&(b=Math.max(b,this.width/(ae-ie)),S=(ae+ie)/2)}S===g&&C===x||(this.center=this.unproject(new r.P(S,C))),b&&(this.zoom+=this.scaleZoom(b)),this._constrainCamera(),this._unmodified=d,this._constraining=!1}_minZoomForBounds(){let s=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(s=Math.max(s,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),s}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;let s=this.centerOffset,d=this.projection.name==="globe",g=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=r.ax(1,this.center.lat)/r.ax(1,r.b3));let x=r.aX(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,x),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;let b=this.projection.zAxisUnit==="meters"?g:1,S=this._camera.getWorldToCamera(this.worldSize,b),C,F=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(F[8]=2*-s.x/this.width,F[9]=2*s.y/this.height,this.isOrthographic){let je=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),at=je*this.aspect,xt=-at,qe=-je;at-=s.x,xt-=s.x,je+=s.y,qe+=s.y,C=this._camera.getCameraToClipOrthographic(xt,at,qe,je,this._nearZ,this._farZ),((bt,Ct,Gt,qt)=>{for(let Vt=0;Vt<16;Vt++)bt[Vt]=kh(Ct[Vt],Gt[Vt],qt)})(C,C,F,Wn(this.pitch>=15?1:this.pitch/15))}else C=F;let O=r.ad.mul([],F,S),V=r.ad.mul([],C,S);if(this.projection.isReprojectedInTileSpace){let je=this.locationCoordinate(this.center),at=r.ad.identity([]);r.ad.translate(at,at,[je.x*this.worldSize,je.y*this.worldSize,0]),r.ad.multiply(at,at,r.aY(this)),r.ad.translate(at,at,[-je.x*this.worldSize,-je.y*this.worldSize,0]),r.ad.multiply(V,V,at),r.ad.multiply(O,O,at),this.inverseAdjustmentMatrix=r.aZ(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=r.ad.scale([],V,[this.worldSize,this.worldSize,this.worldSize/b,1]),this.projMatrix=V,this.invProjMatrix=r.ad.invert(new Float64Array(16),this.projMatrix),d){let je=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);je[8]=2*-s.x/this.width,je[9]=2*s.y/this.height,this.expandedFarZProjMatrix=r.ad.mul([],je,S)}else this.expandedFarZProjMatrix=this.projMatrix;let X=r.ad.invert([],C);this.frustumCorners=r.a_.fromInvProjectionMatrix(X,this.horizonLineFromTop(),this.height),this.cameraFrustum=r.aM.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!d);let ie=new Float32Array(16);r.ad.identity(ie),r.ad.scale(ie,ie,[1,-1,1]),r.ad.rotateX(ie,ie,this._pitch),r.ad.rotateZ(ie,ie,this.angle);let ae=r.ad.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=r.ad.clone(ae);let ue=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ae[8]=2*-s.x/this.width,ae[9]=2*(s.y+ue)/this.height,this.skyboxMatrix=r.ad.multiply(ie,ae,ie);let de=this.point,fe=de.x,me=de.y,Pe=this.width%2/2,Oe=this.height%2/2,Ne=Math.cos(this.angle),Je=Math.sin(this.angle),Ke=fe-Math.round(fe)+Ne*Pe+Je*Oe,Fe=me-Math.round(me)+Ne*Oe+Je*Pe,Be=new Float64Array(V);if(r.ad.translate(Be,Be,[Ke>.5?Ke-1:Ke,Fe>.5?Fe-1:Fe,0]),this.alignedProjMatrix=Be,V=r.ad.create(),r.ad.scale(V,V,[this.width/2,-this.height/2,1]),r.ad.translate(V,V,[1,-1,0]),this.labelPlaneMatrix=V,V=r.ad.create(),r.ad.scale(V,V,[1,-1,1]),r.ad.translate(V,V,[-1,-1,0]),r.ad.scale(V,V,[2/this.width,2/this.height,1]),this.glCoordMatrix=V,this.pixelMatrix=r.ad.multiply(new Float64Array(16),this.labelPlaneMatrix,O),this._calcFogMatrices(),this._distanceTileDataCache={},V=r.ad.invert(new Float64Array(16),this.pixelMatrix),!V)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=V,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=r.a$(this);let je=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=r._.transformMat4(je,je,S),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=V;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};let s=this.cameraWorldSizeForFog,d=this.cameraPixelsPerMeter,g=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,b=[s,s,d];r._.scale(b,b,x),r._.scale(g,g,-1),r._.multiply(g,g,b);let S=r.ad.create();r.ad.translate(S,S,g),r.ad.scale(S,S,b),this.mercatorFogMatrix=S,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(s,d,x)}_computeCameraPosition(s){let d=(s=s||this.pixelsPerMeter)/this.pixelsPerMeter,g=this._camera.forward(),x=this.point,b=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*d-s/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-g[0]*b,x.y/this.worldSize-g[1]*b,s/this.worldSize*this._centerAltitude-g[2]*b]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(s){let d=this._maxCameraBoundsDistance()*Math.cos(this._pitch),g=this._camera.position[2],x=s[2],b=1;this.projection.wrap&&(this.center=this.center.wrap()),x>0&&(b=Math.min((d-g)/x,1)),this._camera.position=r._.scaleAndAdd([],this._camera.position,s,b),this._updateStateFromCamera()}_updateStateFromCamera(){let s=this._camera.position,d=this._camera.forward(),{pitch:g,bearing:x}=this._camera.getPitchBearing(),b=r.ax(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,S=this._mercatorZfromZoom(this._maxZoom)*Math.cos(r.ab(this._maxPitch)),C=Math.max((s[2]-b)/Math.cos(g),S),F=this._zoomFromMercatorZ(C);r._.scaleAndAdd(s,s,d,C),this._pitch=r.at(g,r.ab(this.minPitch),r.ab(this.maxPitch)),this.angle=r.au(x,-Math.PI,Math.PI),this._setZoom(r.at(F,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new r.Y(s[0],s[1],s[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(s){return Math.pow(2,s)*this.tileSize}_mercatorZfromZoom(s){return this.cameraToCenterDistance/this._worldSizeFromZoom(s)}_minimumHeightOverTerrain(){let s=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(s)}_zoomFromMercatorZ(s){return this.scaleZoom(this.cameraToCenterDistance/(s*this.tileSize))}zoomFromMercatorZAdjusted(s){let d=0,g=r.aU,x=0,b=1/0;for(;g-d>1e-6&&g>d;){let S=d+.5*(g-d),C=this.tileSize*Math.pow(2,S),F=this.getCameraToCenterDistance(this.projection,S,C),O=this.scaleZoom(F/(s*this.tileSize)),V=Math.abs(S-O);V<b&&(b=V,x=S),S<O?d=S:g=S}return x}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(r.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(s,d){let g=Math.min(s.x,d.x),x=Math.max(s.x,d.x),b=Math.min(s.y,d.y),S=Math.max(s.y,d.y);if(b<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;let C=[new r.P(g,b),new r.P(x,S),new r.P(g,S),new r.P(x,b)],F=this.renderWorldCopies?-3:0,O=this.renderWorldCopies?4:1;for(let V of C){let X=this.pointRayIntersection(V);if(X.t<0)return!0;let ie=this.rayIntersectionCoordinate(X);if(ie.x<F||ie.y<0||ie.x>O||ie.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+r.b0(this.fovAboveCenter)>88||this.anyCornerOffEdge(new r.P(0,0),new r.P(this.width,this.height))}zoomDeltaToMovement(s,d){let g=r._.length(r._.sub([],this._camera.position,s)),x=this._zoomFromMercatorZ(g)+d;return g-this._mercatorZfromZoom(x)}getCameraPoint(){if(this.projection.name==="globe"){let s=function([d,g,x],b){let S=[d,g,x,1];r.aA.transformMat4(S,S,b);let C=S[3]=Math.max(S[3],1e-6);return S[0]/=C,S[1]/=C,S[2]/=C,S}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new r.P(s[0],s[1])}{let s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new r.P(0,s))}}getCameraToCenterDistance(s,d=this.zoom,g=this.worldSize){let x=r.aX(s,d,this.width,this.height,1024),b=s.pixelSpaceConversion(this.center.lat,g,x),S=.5/Math.tan(.5*this._fov)*this.height*b;return this.isOrthographic&&(S=kh(1,S,Wn(this.pitch>=15?1:this.pitch/15))),S}getWorldToCameraMatrix(){let s=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&r.ad.multiply(s,s,this.globeMatrix),s}getFrustum(s){return r.aM.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s,this.projection.zAxisUnit==="meters")}}let co={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11},il=(m,s)=>{if(s>0&&m.terrain&&r.w("Cutoff is currently disabled on terrain"),s<=0||m.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};let d=m.transform,g=Math.max(Math.abs(d._zoom-(m.minCutoffZoom-1)),1),x=d.isLODDisabled(!1)?r.$(60,45,d.pitch):r.$(30,15,d.pitch),b=d._farZ-d._nearZ,S=s*d.height,C=((1-(F=x))*d.cameraToCenterDistance+F*(d._farZ+S))*g;var F;return{shouldRenderCutoff:x<1,uniformValues:{u_cutoff_params:[d._nearZ,d._farZ,(C-d._nearZ)/b,(C-S-d._nearZ)/b]}}},uo={cascadeCount:2,shadowMapResolution:2048};class Qc{constructor(s,d){this.aabb=s,this.lastCascade=d}}class Tc{add(s,d){let g=this.receivers[s.key];g!==void 0?(g.aabb.min[0]=Math.min(g.aabb.min[0],d.min[0]),g.aabb.min[1]=Math.min(g.aabb.min[1],d.min[1]),g.aabb.min[2]=Math.min(g.aabb.min[2],d.min[2]),g.aabb.max[0]=Math.max(g.aabb.max[0],d.max[0]),g.aabb.max[1]=Math.max(g.aabb.max[1],d.max[1]),g.aabb.max[2]=Math.max(g.aabb.max[2],d.max[2])):this.receivers[s.key]=new Qc(d,null)}clear(){this.receivers={}}get(s){return this.receivers[s.key]}computeRequiredCascades(s,d,g){let x=r.b6.fromPoints(s.points),b=0;for(let S in this.receivers){let C=this.receivers[S];if(!C||!x.intersectsAabb(C.aabb))continue;C.aabb.min=x.closestPoint(C.aabb.min),C.aabb.max=x.closestPoint(C.aabb.max);let F=C.aabb.getCorners();for(let O=0;O<g.length;O++){let V=!0;for(let X of F){let ie=[X[0]*d,X[1]*d,X[2]];if(r._.transformMat4(ie,ie,g[O].matrix),ie[0]<-1||ie[0]>1||ie[1]<-1||ie[1]>1){V=!1;break}}if(C.lastCascade=O,b=Math.max(b,O),V)break}}return b+1}}class eu{constructor(s){this.painter=s,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new Tc,this._depthMode=new r.ae(s.context.gl.LEQUAL,r.ae.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,s.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),s.tp.registerParameter(uo,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),s.tp.registerParameter(uo,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),s.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(let s of this._cascades)s.texture.destroy(),s.framebuffer.destroy();this._cascades=[]}updateShadowParameters(s,d){let g=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!d||!d.properties)return;let x=d.properties.get("shadow-intensity");if(!d.shadowsEnabled()||x<=0||(this._shadowLayerCount=g.style.order.reduce((ue,de)=>{let fe=g.style._mergedLayers[de];return ue+(fe.hasShadowPass()&&!fe.isHidden(s.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;let b=g.context,S=uo.shadowMapResolution,C=uo.shadowMapResolution;if(this._cascades.length===0||uo.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ue=0;ue<uo.cascadeCount;++ue){let de=g._shadowMapDebug,fe=b.gl,me=b.createFramebuffer(S,C,de,"texture"),Pe=new r.T(b,{width:S,height:C,data:null},fe.DEPTH_COMPONENT);if(me.depthAttachment.set(Pe.texture),de){let Oe=new r.T(b,{width:S,height:C,data:null},fe.RGBA);me.colorAttachment.set(Oe.texture)}this._cascades.push({framebuffer:me,texture:Pe,matrix:[],far:0,boundingSphereRadius:0,frustum:new r.aM,scale:0})}}this.shadowDirection=Sc(d);let F=0;if(s.elevation){let ue=s.elevation,de=[1e4,-1e4];ue.visibleDemTiles.filter(fe=>fe.dem).forEach(fe=>{let me=fe.dem.tree;de[0]=Math.min(de[0],me.minimums[0]),de[1]=Math.max(de[1],me.maximums[0])}),de[0]!==1e4&&(F=(de[1]-de[0])*ue.exaggeration())}let O=1.5*s.cameraToCenterDistance,V=3*O,X=new Float64Array(16);for(let ue=0;ue<this._cascades.length;++ue){let de=this._cascades[ue],fe=s.height/50,me=1;uo.cascadeCount===1?me=V:ue===0?me=O:(fe=O,me=V);let[Pe,Oe]=Ee(s,this.shadowDirection,fe,me,uo.shadowMapResolution,F);de.scale=s.scale,de.matrix=Pe,de.boundingSphereRadius=Oe,r.ad.invert(X,de.matrix),de.frustum=r.aM.fromInvProjectionMatrix(X,1,0,!0),de.far=me}let ie=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[ie].far,this._cascades[ie].far],this._uniformValues.u_shadow_intensity=x,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/uo.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=uo.shadowMapResolution,this._uniformValues.u_shadowmap_0=co.ShadowMap0,this._uniformValues.u_shadowmap_1=co.ShadowMap0+1,this._groundShadowTiles=g.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});let ae=g.transform.elevation;for(let ue of this._groundShadowTiles){let de={min:0,max:0};if(ae){let fe=ae.getMinMaxForTile(ue);fe&&(de=fe)}this.addShadowReceiver(ue.toUnwrapped(),de.min,de.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(s){this._enabled=s}drawShadowPass(s,d){if(!this.enabled)return;let g=this.painter,x=g.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(g.transform.getFrustum(0),g.transform.worldSize,this._cascades),x.viewport.set([0,0,uo.shadowMapResolution,uo.shadowMapResolution]);for(let b=0;b<this._numCascadesToRender;++b){g.currentShadowCascade=b,x.bindFramebuffer.set(this._cascades[b].framebuffer.framebuffer),x.clear({color:r.C.white,depth:1});for(let S of s.order){let C=s._mergedLayers[S];if(!C.hasShadowPass()||C.isHidden(g.transform.zoom))continue;let F=s.getLayerSourceCache(C),O=F?d[F.id]:void 0;(C.type==="model"||O&&O.length)&&g.renderLayer(g,F,C,O)}}g.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;let s=this.painter,d=s.style,g=s.context,x=d.directionalLight,b=d.ambientLight;if(!x||!b)return;let S=[],C=il(s,s.longestCutoffRange);C.shouldRenderCutoff&&S.push("RENDER_CUTOFF");let F=H(d,x,b),O=new r.ae(g.gl.LEQUAL,r.ae.ReadOnly,s.depthRangeFor3D);for(let V of this._groundShadowTiles){let X=V.toUnwrapped(),ie=s.isTileAffectedByFog(V),ae=s.getOrCreateProgram("groundShadow",{defines:S,overrideFog:ie});this.setupShadows(X,ae),s.uploadCommonUniforms(g,ae,X,null,C);let ue={u_matrix:s.transform.calculateProjMatrix(X),u_ground_shadow_factor:F};ae.draw(s,g.gl.TRIANGLES,O,r.ag.disabled,r.a.multiply,r.af.disabled,ue,"ground_shadow",s.tileExtentBuffer,s.quadTriangleIndexBuffer,s.tileExtentSegments,{},s.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?r.a.unblended:r.a.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(s){let d=this.painter.transform,g=d.calculatePosMatrix(s,d.worldSize);return r.ad.multiply(g,this._cascades[this.painter.currentShadowCascade].matrix,g),Float32Array.from(g)}calculateShadowPassMatrixFromMatrix(s){return r.ad.multiply(s,this._cascades[this.painter.currentShadowCascade].matrix,s),Float32Array.from(s)}setupShadows(s,d,g,x=0){if(!this.enabled)return;let b=this.painter.transform,S=this.painter.context,C=S.gl,F=this._uniformValues,O=new Float64Array(16),V=b.calculatePosMatrix(s,b.worldSize);for(let X=0;X<this._cascades.length;X++)r.ad.multiply(O,this._cascades[X].matrix,V),F[X===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(O),S.activeTexture.set(C.TEXTURE0+co.ShadowMap0+X),this._cascades[X].texture.bind(C.NEAREST,C.CLAMP_TO_EDGE);if(this.useNormalOffset=!!g,this.useNormalOffset){let X=r.b5(s.canonical),ie=2/b.tileSize*r.a3/uo.shadowMapResolution,ae=ie*this._cascades[0].boundingSphereRadius,ue=ie*this._cascades[this._cascades.length-1].boundingSphereRadius,de=(g==="vector-tile"?1:3)/Math.pow(2,x-s.canonical.z-(1-b.zoom+Math.floor(b.zoom)));F.u_shadow_normal_offset=[X,ae*de,ue*de],F.u_shadow_bias=[6e-5,.0012,.012]}else F.u_shadow_bias=[36e-5,.0012,.012];d.setShadowUniformValues(S,F)}setupShadowsFromMatrix(s,d,g=!1){if(!this.enabled)return;let x=this.painter.context,b=x.gl,S=this._uniformValues,C=new Float64Array(16);for(let F=0;F<uo.cascadeCount;F++)r.ad.multiply(C,this._cascades[F].matrix,s),S[F===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(C),x.activeTexture.set(b.TEXTURE0+co.ShadowMap0+F),this._cascades[F].texture.bind(b.NEAREST,b.CLAMP_TO_EDGE);this.useNormalOffset=g,g?(S.u_shadow_normal_offset=[1,5,5],S.u_shadow_bias=[6e-5,.0012,.012]):S.u_shadow_bias=[36e-5,.0012,.012],d.setShadowUniformValues(x,S)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(s,d,g,x){if(x[2]>=0)return{};let b=function(F,O,V){let X=V/(1<<F.canonical.z);return new r.b6([F.canonical.x*X+F.wrap*V,F.canonical.y*X+F.wrap*V,0],[(F.canonical.x+1)*X+F.wrap*V,(F.canonical.y+1)*X+F.wrap*V,O])}(s,d,g).getCorners(),S=d/-x[2];x[0]<0?(r._.add(b[0],b[0],[x[0]*S,0,0]),r._.add(b[3],b[3],[x[0]*S,0,0])):x[0]>0&&(r._.add(b[1],b[1],[x[0]*S,0,0]),r._.add(b[2],b[2],[x[0]*S,0,0])),x[1]<0?(r._.add(b[0],b[0],[0,x[1]*S,0]),r._.add(b[1],b[1],[0,x[1]*S,0])):x[1]>0&&(r._.add(b[2],b[2],[0,x[1]*S,0]),r._.add(b[3],b[3],[0,x[1]*S,0]));let C={};return C.vertices=b,C.planes=[Bs(b[1],b[0],b[4]),Bs(b[2],b[1],b[5]),Bs(b[3],b[2],b[6]),Bs(b[0],b[3],b[7])],C}addShadowReceiver(s,d,g){this._receivers.add(s,r.b6.fromTileIdAndHeight(s,d,g))}getMaxCascadeForTile(s){let d=this._receivers.get(s);return d&&d.lastCascade?d.lastCascade:0}}function Bs(m,s,d){let g=r._.sub([],d,s),x=r._.sub([],m,s),b=r._.cross([],g,x),S=r._.length(b);return S===0?[0,0,1,0]:(r._.scale(b,b,1/S),[b[0],b[1],b[2],-r._.dot(b,s)])}function Sc(m){let s=m.properties.get("direction"),d=r.ac(s.x,s.y,s.z);d[2]=r.at(d[2],0,75);let g=r.b7([d[0],d[1],d[2]]);return r._.fromValues(g.x,g.y,g.z)}function H(m,s,d){let g=s.properties.get("color"),x=s.properties.get("intensity"),b=s.properties.get("direction"),S=[b.x,b.y,b.z],C=d.properties.get("color"),F=d.properties.get("intensity"),O=Math.max(r._.dot([0,0,1],S),0),V=[0,0,0];r._.scale(V,C.toRenderColor(m.getLut(s.scope)).toArray01Linear().slice(0,3),F);let X=[0,0,0];return r._.scale(X,g.toRenderColor(m.getLut(d.scope)).toArray01Linear().slice(0,3),O*x),r.b8([V[0]>0?V[0]/(V[0]+X[0]):0,V[1]>0?V[1]/(V[1]+X[1]):0,V[2]>0?V[2]/(V[2]+X[2]):0])}function Ee(m,s,d,g,x,b){let S=m.zoom,C=m.scale,F=m.worldSize,O=1/F,V=m.aspect,X=Math.sqrt(1+V*V)*Math.tan(.5*m.fovX),ie=X*X,ae=g-d,ue=g+d,de,fe;ie>ae/ue?(de=g,fe=g*X):(de=.5*ue*(1+ie),fe=.5*Math.sqrt(ae*ae+2*(g*g+d*d)*ie+ue*ue*ie*ie));let me=m.projection.pixelsPerMeter(m.center.lat,F),Pe=m._camera.getCameraToWorldMercator(),Oe=[0,0,-de*O];r._.transformMat4(Oe,Oe,Pe);let Ne=fe*O,Je=m._edgeInsets;if(!(Je.left===0&&Je.top===0&&Je.right===0&&Je.bottom===0||Je.left===Je.right&&Je.top===Je.bottom)){let dr=m._camera.getWorldToCamera(m.worldSize,m.projection.zAxisUnit==="meters"?me:1),pr=m._camera.getCameraToClipPerspective(m._fov,m.width/m.height,d,g);pr[8]=2*-m.centerOffset.x/m.width,pr[9]=2*m.centerOffset.y/m.height;let Cr=new Float64Array(16);r.ad.mul(Cr,pr,dr);let mr=new Float64Array(16);r.ad.invert(mr,Cr);let Yt=r.aM.fromInvProjectionMatrix(mr,F,S,!0);for(let Nt of Yt.points){let Pr=((Ke=Nt)[0]/=C,Ke[1]/=C,Ke[2]=r.ax(Ke[2],m._center.lat),Ke);Ne=Math.max(Ne,r._.len(r._.subtract([],Oe,Pr)))}}var Ke;Ne*=x/(x-1);let Fe=Math.acos(s[2]),Be=Math.atan2(-s[0],-s[1]),je=new xc;je.position=Oe,je.setPitchBearing(Fe,Be);let at=je.getWorldToCamera(F,me),xt=Ne*F,qe=Math.min(m._mercatorZfromZoom(17)*F*-2,-2*xt),bt=je.getCameraToClipOrthographic(-xt,xt,-xt,xt,qe,(xt+b*me)/s[2]),Ct=new Float64Array(16);r.ad.multiply(Ct,bt,at);let Gt=r._.fromValues(Math.floor(1e6*Oe[0])/1e6*F,Math.floor(1e6*Oe[1])/1e6*F,0),qt=.5*x,Vt=[0,0,0];r._.transformMat4(Vt,Gt,Ct),r._.scale(Vt,Vt,qt);let ft=[Math.floor(Vt[0]),Math.floor(Vt[1]),Math.floor(Vt[2])],kt=[0,0,0];r._.sub(kt,Vt,ft),r._.scale(kt,kt,-1/qt);let jt=new Float64Array(16);return r.ad.identity(jt),r.ad.translate(jt,jt,kt),r.ad.multiply(Ct,jt,Ct),[Ct,xt]}function ct(m,s){return m!=null&&s!=null&&!(!m.hasData()||!s.hasData())&&m.demTexture!=null&&s.demTexture!=null&&m.tileID.key!==s.tileID.key}let yt=new class{constructor(){this.operations={}}newMorphing(m,s,d,g,x){if(m in this.operations){let b=this.operations[m];b.to.tileID.key!==d.tileID.key&&(b.queued=d)}else this.operations[m]={startTime:g,phase:0,duration:x,from:s,to:d,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;let s=this.operations[m];return{from:s.from,to:s.to,phase:s.phase}}update(m){for(let s in this.operations){let d=this.operations[s];for(d.phase=(m-d.startTime)/d.duration;d.phase>=1||!this._validOp(d);)if(!this._nextOp(d,m)){delete this.operations[s];break}}}_nextOp(m,s){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=s,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},Lt={0:null,1:"TERRAIN_VERTEX_MORPHING"};function sr(m,s,d){if(s===0)return 0;let g=s<1&&d===514?.25/s:1;return 6*Math.pow(1.5,22-m)*Math.max(s,1)*g}function Mr(m,s){let d=1<<m.z;return!s&&(m.x===0||m.x===d-1)||m.y===0||m.y===d-1}let Yr=m=>({u_matrix:m});function hi(m,s,d,g,x){if(x>0){let b=r.e.now(),S=(b-m.timeAdded)/x,C=s?(b-s.timeAdded)/x:-1,F=d.getSource(),O=g.coveringZoomLevel({tileSize:F.tileSize,roundZoom:F.roundZoom}),V=!s||Math.abs(s.tileID.overscaledZ-O)>Math.abs(m.tileID.overscaledZ-O),X=V&&m.refreshedUponExpiration?1:r.at(V?S:1-C,0,1);return m.refreshedUponExpiration&&S>=1&&(m.refreshedUponExpiration=!1),s?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}class Fi extends Hl{constructor(s,d,g,x){super(s,d,g,x),this.type="raster-array",this.maxzoom=22,this._options=r.W({type:"raster-array"},d)}triggerRepaint(s){let d=this.map.painter._terrain,g=this.map.style.getSourceCache(this.id);d&&d.enabled&&g&&d._clearRenderCacheForTile(g.id,s.tileID),this.map.triggerRepaint()}loadTile(s,d){let g=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),x=this.map._requestManager.transformRequest(g,r.R.Tile);s.requestParams=x,s.actor||(s.actor=this.dispatcher.getActor()),s.request=s.fetchHeader(void 0,(b,S,C,F)=>{if(delete s.request,s.aborted)return s.state="unloaded",d(null);if(b)return b.code===20?void 0:(s.state="errored",d(b));this.map._refreshExpiredTiles&&s.setExpiryData({cacheControl:C,expires:F}),s.state="empty",d(null)})}unloadTile(s,d){let g=s.texture;g&&g instanceof r.T?(s.destroy(!0),this.map.painter.saveTileTexture(g)):(s.destroy(),s.flushQueues(),s._isHeaderLoaded=!1,delete s._mrt,delete s.textureDescriptor),s.fbo&&(s.fbo.destroy(),delete s.fbo),delete s.request,delete s.requestParams,delete s.neighboringTiles,s.state="unloaded"}prepareTile(s,d,g){s._isHeaderLoaded&&(s.state!=="empty"&&(s.state="reloading"),s.fetchBand(d,g,(x,b)=>{if(x)return s.state="errored",this.fire(new r.d(x)),void this.triggerRepaint(s);b&&(s.setTexture(b,this.map.painter),s.state="loaded",this.triggerRepaint(s))}))}getInitialBand(s){if(!this.rasterLayers)return 0;let d=this.rasterLayers.find(({id:b})=>b===s),g=d&&d.fields,x=g&&g.bands&&g.bands;return x?x[0]:0}getTextureDescriptor(s,d,g){if(!s)return;let x=d.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!x)return;let b=null;d instanceof r.bk?b=d.paint.get("raster-array-band"):d instanceof r.bl&&(b=d.paint.get("raster-particle-array-band"));let S=b||this.getInitialBand(x);if(S!=null)if(s.textureDescriptor){if(!s.updateNeeded(x,S)||g)return Object.assign({},s.textureDescriptor,{texture:s.texture})}else this.prepareTile(s,x,S)}}let di={vector:Kc,raster:Hl,"raster-dem":class extends Hl{constructor(m,s,d,g){super(m,s,d,g),this.type="raster-dem",this.maxzoom=22,this._options=r.W({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}loadTile(m,s){let d=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function g(x,b){x&&(m.state="errored",s(x)),b&&(m.dem=b,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",s(null))}m.request=r.h(this.map._requestManager.transformRequest(d,r.R.Tile),(function(x,b,S,C){if(delete m.request,m.aborted)m.state="unloaded",s(null);else if(x)m.state="errored",s(x);else if(b){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:S,expires:C});let F=ImageBitmap&&b instanceof ImageBitmap&&r.bi(),O=1-(b.width-r.bj(b.width))/2;O<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));let V=F?b:r.e.getImageData(b,O),X={uid:m.uid,coord:m.tileID,source:this.id,scope:this.scope,rawImageData:V,encoding:this.encoding,padding:O};m.actor&&m.state!=="expired"||(m.actor=this.dispatcher.getActor(),m.actor.send("loadDEMTile",X,g.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(m){let s=m.canonical,d=Math.pow(2,s.z),g=(s.x-1+d)%d,x=s.x===0?m.wrap-1:m.wrap,b=(s.x+1+d)%d,S=s.x+1===d?m.wrap+1:m.wrap,C={};return C[new r.aL(m.overscaledZ,x,s.z,g,s.y).key]={backfilled:!1},C[new r.aL(m.overscaledZ,S,s.z,b,s.y).key]={backfilled:!1},s.y>0&&(C[new r.aL(m.overscaledZ,x,s.z,g,s.y-1).key]={backfilled:!1},C[new r.aL(m.overscaledZ,m.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},C[new r.aL(m.overscaledZ,S,s.z,b,s.y-1).key]={backfilled:!1}),s.y+1<d&&(C[new r.aL(m.overscaledZ,x,s.z,g,s.y+1).key]={backfilled:!1},C[new r.aL(m.overscaledZ,m.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},C[new r.aL(m.overscaledZ,S,s.z,b,s.y+1).key]={backfilled:!1}),C}},"raster-array":Fi,geojson:class extends r.E{constructor(m,s,d,g){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=d.getActor(),this.setEventedParent(g),this._data=s.data,this._options=r.W({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.minzoom!==void 0&&(this.minzoom=s.minzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;let x=r.a3/this.tileSize;this.workerOptions=r.W({source:this.id,scope:this.scope,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*x,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*x,extent:r.a3,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:r.a3,radius:(s.clusterRadius!==void 0?s.clusterRadius:50)*x,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter,dynamic:s.dynamic},s.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}updateData(m){return this._options.dynamic?typeof m!="string"&&(m.type==="Feature"&&(m={type:"FeatureCollection",features:[m]}),m.type!=="FeatureCollection")?this.fire(new r.d(new Error("Data to update should be a feature or a feature collection."))):(this._coalesce&&typeof m!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"?this._data.features.push(...m.features):this._data=m,this._updateWorkerData(!0),this):this.fire(new r.d(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")))}getClusterExpansionZoom(m,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id,scope:this.scope},s),this}getClusterChildren(m,s){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id,scope:this.scope},s),this}getClusterLeaves(m,s,d,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:m,limit:s,offset:d},g),this}_updateWorkerData(m=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new r.f("dataloading",{dataType:"source"})),this._loaded=!1;let s=r.W({append:m},this.workerOptions);s.scope=this.scope;let d=this._data;typeof d=="string"?(s.request=this.map._requestManager.transformRequest(r.e.resolveURL(d),r.R.Source),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(d),this._pendingLoad=this.actor.send(`${this.type}.loadData`,s,(g,x)=>{if(this._loaded=!0,this._pendingLoad=null,g)this.fire(new r.d(g));else{let b={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&x&&x.resourceTiming&&x.resourceTiming[this.id]&&(b.resourceTiming=x.resourceTiming[this.id]),m&&(this._partialReload=!0),this.fire(new r.f("data",b)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(m),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(m,s){let d=m.actor?"reloadTile":"loadTile";m.actor=this.actor;let g=this.map.style?this.map.style.getLut(this.scope):null,x=this._partialReload,b={type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:g?{image:g.image.clone()}:null,scope:this.scope,pixelRatio:r.e.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,partial:x};m.request=this.actor.send(d,b,(S,C)=>x&&!C?(m.state="loaded",s(null)):(delete m.request,m.destroy(),m.aborted?s(null):S?s(S):(m.loadVectorData(C,this.map.painter,d==="reloadTile"),s(null))),void 0,d==="loadTile")}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m,s){this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id,scope:this.scope}),m.destroy()}onRemove(m){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return r.W({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends r.bm{constructor(m,s,d,g){super(m,s,d,g),this.roundZoom=!0,this.type="video",this.options=s}load(){this._loaded=!1;let m=this.options;this.urls=[];for(let s of m.urls)this.urls.push(this.map._requestManager.transformRequest(s,r.R.Source).url);r.bn(this.urls,(s,d)=>{this._loaded=!0,s?this.fire(new r.d(s)):d&&(this.video=d,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){let s=this.video.seekable;m<s.start(0)||m>s.end(0)?this.fire(new r.d(new r.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let m=this.map.painter.context,s=m.gl;this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new r.T(m,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:r.bm,model:class extends r.E{constructor(m,s,d,g){super(),this.id=m,this.type="model",this.models=[],this._loaded=!1,this._options=s}load(){let m=[];for(let s in this._options.models){let d=this._options.models[s],g=r.l(this.map._requestManager.transformRequest(d.uri,r.R.Model).url).then(x=>{if(!x)return;let b=r.c(x),S=new r.M(s,d.position,d.orientation,b);S.computeBoundsAndApplyParent(),this.models.push(S)}).catch(x=>{this.fire(new r.d(new Error(`Could not load model ${s} from ${d.uri}: ${x.message}`)))});m.push(g)}return Promise.allSettled(m).then(()=>{this._loaded=!0,this.fire(new r.f("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(s=>{this.fire(new r.d(new Error(`Could not load models: ${s.message}`)))})}onAdd(m){this.map=m,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(m,s){}serialize(){return{type:"model"}}},"batched-model":class extends r.E{constructor(m,s,d,g){super(),this.type="batched-model",this.id=m,this.tileSize=512,this._options=s,this.tiles=this._options.tiles,this.maxzoom=s.maxzoom||19,this.minzoom=s.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=d,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(g)}onAdd(m){this.map=m,this.load()}load(m){this._loaded=!1,this.fire(new r.f("dataloading",{dataType:"source"}));let s=Array.isArray(this.map._language)?this.map._language.join():this.map._language,d=this.map._worldview;this._tileJSONRequest=Ch(this._options,this.map._requestManager,s,d,(g,x)=>{this._tileJSONRequest=null,this._loaded=!0,g?(s&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${s}`),d&&d.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${d}`),this.fire(new r.d(g))):x&&(r.W(this,x),x.bounds&&(this.tileBounds=new Yc(x.bounds,this.minzoom,this.maxzoom)),r.an(x.tiles,this.map._requestManager._customAccessToken),this.fire(new r.f("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.f("data",{dataType:"source",sourceDataType:"content"}))),m&&m(g)})}hasTransition(){return!1}hasTile(m){return!this.tileBounds||this.tileBounds.contains(m.canonical)}loaded(){return this._loaded}loadTile(m,s){let d=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme)),g={request:this.map._requestManager.transformRequest(d,r.R.Tile),data:void 0,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,tileSize:this.tileSize*m.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:m.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(m.actor&&m.state!=="expired")if(m.state==="loading")m.reloadCallback=s;else{if(m.buckets){let b=Object.values(m.buckets);for(let S of b)S.dirty=!0;return void(m.state="loaded")}m.request=m.actor.send("reloadTile",g,x.bind(this))}else m.actor=this.dispatcher.getActor(),m.request=m.actor.send("loadTile",g,x.bind(this),void 0,!0);function x(b,S){return m.aborted?s(null):b&&b.status!==404?s(b):(S&&(S.resourceTiming&&(m.resourceTiming=S.resourceTiming),this.map._refreshExpiredTiles&&m.setExpiryData(S),m.buckets=jr(jr({},m.buckets),S.buckets),S.featureIndex&&(m.latestFeatureIndex=S.featureIndex)),m.state="loaded",void s(null))}}serialize(){return r.W({},this._options)}},canvas:class extends r.bm{constructor(m,s,d,g){super(m,s,d,g),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(b=>typeof b!="number"))||this.fire(new r.d(new r.V(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new r.d(new r.V(`sources.${m}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new r.d(new r.V(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new r.d(new r.V(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new r.d(new r.V(`sources.${m}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new r.d(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(m){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let s=this.map.painter.context;this.texture?!m&&!this._playing||this.texture instanceof r.bo||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new r.T(s,this.canvas,s.gl.RGBA,{premultiply:!0}),this._prepareData(s)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends r.E{constructor(m,s,d,g){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=d,this._implementation=s,this.setEventedParent(g),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new r.d(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new r.d(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Yc(this._implementation.bounds,this.minzoom,this.maxzoom)),s.update=this._update.bind(this),s.clearTiles=this._clearTiles.bind(this),s.coveringTiles=this._coveringTiles.bind(this),r.W(this,r.ah(s,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return r.ah(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new r.f("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.f("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this._map=m,this._loaded=!1,this.fire(new r.f("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){let{x:s,y:d,z:g}=m.canonical;return this._implementation.hasTile({x:s,y:d,z:g})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,s){let{x:d,y:g,z:x}=m.tileID.canonical,b=new AbortController;m.request=Promise.resolve(this._implementation.loadTile({x:d,y:g,z:x},{signal:b.signal})).then((function(S){return delete m.request,m.aborted?(m.state="unloaded",s(null)):S===void 0?(m.state="errored",s(null)):S===null?(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",s(null)):function(C){return C instanceof ImageData||C instanceof HTMLCanvasElement||C instanceof ImageBitmap||C instanceof HTMLImageElement}(S)?(this.loadTileData(m,S),m.state="loaded",void s(null)):(m.state="errored",s(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(S=>{S.code!==20&&(m.state="errored",s(S))}),m.request.cancel=()=>b.abort()}loadTileData(m,s){m.setTexture(s,this._map.painter)}unloadTile(m,s){if(m.texture&&m.texture instanceof r.T?(m.destroy(!0),m.texture&&m.texture instanceof r.T&&this._map.painter.saveTileTexture(m.texture)):m.destroy(),this._implementation.unloadTile){let{x:d,y:g,z:x}=m.tileID.canonical;this._implementation.unloadTile({x:d,y:g,z:x})}s&&s()}abortTile(m,s){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),s&&s()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z}))}_clearTiles(){let m=r.al(this.id,this.scope);this._map.style.clearSource(m)}_update(){this.fire(new r.f("data",{dataType:"source",sourceDataType:"content"}))}}},pn=function(m,s,d,g){let x=new di[s.type](m,s,d,g);if(x.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${x.id}`);return r.bp(["load","abort","unload","serialize","prepare"],x),x};class va extends r.bv{constructor(s){let d={type:"raster-dem",maxzoom:s.transform.maxZoom},g=new r.bw(r.bx(),null),x=pn("mock-dem",d,g,s.style);super("mock-dem",x,!1),x.setEventedParent(this),this._sourceLoaded=!0}_loadTile(s,d){s.state="loaded",d(null)}}class Na extends r.bv{constructor(s){let d=pn("proxy",{type:"geojson",maxzoom:s.transform.maxZoom},new r.bw(r.bx(),null),s.style);super("proxy",d,!1),d.setEventedParent(this),this.map=this.getSource().map=s,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(s,d,g){if(s.freezeTileCoverage)return;this.transform=s;let x=s.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((b,S)=>{if(b[S.key]="",!this._tiles[S.key]){let C=new r.by(S,this._source.tileSize*S.overscaleFactor(),s.tileZoom);C.state="loaded",this._tiles[S.key]=C}return b},{});for(let b in this._tiles)b in x||(this.freeFBO(b),this._tiles[b].unloadVectorData(),delete this._tiles[b])}freeFBO(s){let d=this.proxyCachedFBO[s];if(d!==void 0){let g=Object.values(d);this.renderCachePool.push(...g),delete this.proxyCachedFBO[s]}}deallocRenderCache(){this.renderCache.forEach(s=>s.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Va extends r.aL{constructor(s,d,g){super(s.overscaledZ,s.wrap,s.canonical.z,s.canonical.x,s.canonical.y),this.proxyTileKey=d,this.projMatrix=g}}class Io extends r.bq{constructor(s,d){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},s.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=s,this.terrainTileForTile={},this.prevTerrainTileForTile={};let[g,x,b]=function(F){let O=new r.bt,V=new r.bu,X=131;O.reserve(17161),V.reserve(33800);let ie=r.a3/128,ae=r.a3+ie/2,ue=ae+ie;for(let fe=-ie;fe<ue;fe+=ie)for(let me=-ie;me<ue;me+=ie){let Pe=me<0||me>ae||fe<0||fe>ae?24575:0,Oe=r.at(Math.round(me),0,r.a3),Ne=r.at(Math.round(fe),0,r.a3);O.emplaceBack(Oe+Pe,Ne)}let de=(fe,me)=>{let Pe=me*X+fe;V.emplaceBack(Pe+1,Pe,Pe+X),V.emplaceBack(Pe+X,Pe+X+1,Pe+1)};for(let fe=1;fe<129;fe++)for(let me=1;me<129;me++)de(me,fe);return[0,129].forEach(fe=>{for(let me=0;me<130;me++)de(me,fe),de(fe,me)}),[O,V,32768]}(),S=s.context;this.gridBuffer=S.createVertexBuffer(g,r.br.members),this.gridIndexBuffer=S.createIndexBuffer(x),this.gridSegments=r.b.simpleSegment(0,0,g.length,x.length),this.gridNoSkirtSegments=r.b.simpleSegment(0,0,g.length,b),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Na(d.map),this.orthoMatrix=r.ad.create(),r.ad.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,r.a3,0,r.a3,0,1);let C=S.gl;this._overlapStencilMode=new r.ag({func:C.GEQUAL,mask:255},0,255,C.KEEP,C.KEEP,C.REPLACE),this._previousZoom=s.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=d,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new va(d.map),this._pendingGroundEffectLayers=[]}set style(s){s.on("data",this._onStyleDataEvent.bind(this)),this._style=s,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(s,d,g){if(s&&s.terrain){this._style!==s&&(this.style=s,this._evaluationZoom=void 0);let x=s.terrain.properties,b=s.terrain.drapeRenderMode===0,S=s.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=r.e.now();let C=s.terrain&&s.terrain.scope,F=x.get("source"),O=b?this._mockSourceCache:s.getSourceCache(F,C);if(!O)return void r.w(`Couldn't find terrain source "${F}".`);if(this.sourceCache=O,this._exaggeration=S?this.calculateExaggeration(d):x.get("exaggeration"),!d.projection.requiresDraping&&S&&this._exaggeration===0)return void this._disable();this.enabled=!0;let V=()=>{this.sourceCache.used&&r.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);let X=this.getScaledDemTileSize();this.sourceCache.update(d,X,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,V(),this._initializing=!0),V(),d.updateElevation(!0,g),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(d),this._emptyDEMTextureDirty=!0,this._previousZoom=d.zoom}else this._disable()}calculateExaggeration(s){let d=this._previousCameraAltitude,g=s.getFreeCameraOptions().position.z/s.pixelsPerMeter*s.worldSize;this._previousCameraAltitude=g;let x=d!=null?g-d:Number.MAX_VALUE;if(Math.abs(x)<2)return this._exaggeration;let b=s.zoom,S=this._style.terrain;if(!this._previousUpdateTimestamp)return S.getExaggeration(b);let C=b-this._previousZoom,F=this._previousUpdateTimestamp,O=b;this._evaluationZoom!=null&&(O=this._evaluationZoom,Math.abs(b-O)>.5&&(C=.5*(b-O+C)),C*x<0&&(O+=C)),this._evaluationZoom=O;let V=S.getExaggeration(O),X=V===S.getExaggeration(Math.max(0,O-.1));if(X&&Math.abs(V-this._exaggeration)<.01)return V;let ie=Math.min(.1,.00375*(this._updateTimestamp-F));return(X||V<.1||Math.abs(C)<1e-4)&&(ie=Math.min(.2,4*ie)),r.a2(this._exaggeration,V,ie)}resetTileLookupCache(s){this._findCoveringTileCache[s]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(s){s.coord&&s.dataType==="source"?this._clearRenderCacheForTile(s.sourceCacheId,s.coord):s.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(let s in this._style._mergedSourceCaches)this._style._mergedSourceCaches[s].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(s=>s.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){let s=2*this.proxySourceCache.getSource().tileSize;return[s,s]}set useVertexMorphing(s){this._useVertexMorphing=s}updateTileBinding(s){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;let d=this.proxySourceCache,g=this.painter.transform;this._initializing&&(this._initializing=g._centerAltitude===0&&this.getAtPointOrZero(r.Y.fromLngLat(g.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);let x=this.proxyCoords=d.getIds().map(F=>{let O=d.getTileByID(F).tileID;return O.projMatrix=g.calculateProjMatrix(O.toUnwrapped()),O});(function(F,O){let V=O.transform.pointCoordinate(O.transform.getCameraPoint()),X=new r.P(V.x,V.y);F.sort((ie,ae)=>{if(ae.overscaledZ-ie.overscaledZ)return ae.overscaledZ-ie.overscaledZ;let ue=new r.P(ie.canonical.x+(1<<ie.canonical.z)*ie.wrap,ie.canonical.y),de=new r.P(ae.canonical.x+(1<<ae.canonical.z)*ae.wrap,ae.canonical.y),fe=X.mult(1<<ie.canonical.z);return fe.x-=.5,fe.y-=.5,fe.distSqr(ue)-fe.distSqr(de)})})(x,this.painter);let b=this.proxyToSource||{};this.proxyToSource={},x.forEach(F=>{this.proxyToSource[F.key]={}}),this.terrainTileForTile={};let S=this._style._mergedSourceCaches;for(let F in S){let O=S[F];if(!O.used||(O!==this.sourceCache&&this.resetTileLookupCache(O.id),this._setupProxiedCoordsForOrtho(O,s[F],b),O.usedForTerrain))continue;let V=s[F];O.getSource().reparseOverscaled&&this._assignTerrainTiles(V)}this.proxiedCoords[d.id]=x.map(F=>new Va(F,F.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(b),this.renderingToTexture=!1;let C={};this._visibleDemTiles=[];for(let F of this.proxyCoords){let O=this.terrainTileForTile[F.key];if(!O)continue;let V=O.tileID.key;V in C||(this._visibleDemTiles.push(O),C[V]=V)}}_assignTerrainTiles(s){this._initializing||s.forEach(d=>{if(this.terrainTileForTile[d.key])return;let g=this._findTileCoveringTileID(d,this.sourceCache);g&&(this.terrainTileForTile[d.key]=g)})}_prepareDEMTextures(){let s=this.painter.context,d=s.gl;for(let g in this.terrainTileForTile){let x=this.terrainTileForTile[g],b=x.dem;!b||x.demTexture&&!x.needsDEMTextureUpload||(s.activeTexture.set(d.TEXTURE1),xd(this.painter,x,b))}}_prepareDemTileUniforms(s,d,g,x){if(!d||d.demTexture==null)return!1;let b=s.tileID.canonical,S=Math.pow(2,d.tileID.canonical.z-b.z),C=x||"";return g[`u_dem_tl${C}`]=[b.x*S%1,b.y*S%1],g[`u_dem_scale${C}`]=S,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){let s=this.painter.context,d=s.gl;if(!this._emptyDepthBufferTexture){let g=new r.i({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new r.T(s,g,d.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let s=0,d=this._visibleDemTiles.reduce((g,x)=>{if(!x.dem)return g;let b=x.dem.tree.minimums[0];return b>0&&s++,g+b},0);return s?d/s:0}_updateEmptyDEMTexture(){let s=this.painter.context,d=s.gl;s.activeTexture.set(d.TEXTURE2);let g=this._getLoadedAreaMinimum(),[x,b]=(()=>{let C=new r.bz({width:1,height:1},new Float32Array([g]));return[d.R32F,C]})();this._emptyDEMTextureDirty=!1;let S=this._emptyDEMTexture;return S?S.update(b,{premultiply:!1}):S=this._emptyDEMTexture=new r.T(s,b,x,{premultiply:!1}),S}setupElevationDraw(s,d,g){let x=this.painter.context,b=x.gl,S={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0};S.u_exaggeration=this.exaggeration();let C=null,F=null,O=1;if(g&&g.morphing&&this._useVertexMorphing){let ae=g.morphing.srcDemTile,ue=g.morphing.dstDemTile;O=g.morphing.phase,ae&&ue&&(this._prepareDemTileUniforms(s,ae,S,"_prev")&&(F=ae),this._prepareDemTileUniforms(s,ue,S)&&(C=ue))}let V=ae=>ae&&ae.demTexture&&this.painter.linearFloatFilteringSupported()?b.LINEAR:b.NEAREST,X=null;var ie;if(this.enabled?F&&C?(X=C.demTexture,x.activeTexture.set(b.TEXTURE4),F.demTexture.bind(V(F),b.CLAMP_TO_EDGE),S.u_dem_lerp=O):(C=this.terrainTileForTile[s.tileID.key],X=this._prepareDemTileUniforms(s,C,S)?C.demTexture:this.emptyDEMTexture):X=this.emptyDEMTexture,x.activeTexture.set(b.TEXTURE2),X&&(S.u_dem_size=(ie=X).size[0]===1?1:ie.size[0]-2,X.bind(V(C),b.CLAMP_TO_EDGE)),x.activeTexture.set(b.TEXTURE3),g&&g.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),this._depthFBO&&(S.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),S.u_depth_size_inv=[1,1]),g&&g.useMeterToDem&&C){let ae=(1<<C.tileID.canonical.z)*r.ax(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;S.u_meter_to_dem=ae}if(g&&g.labelPlaneMatrixInv&&(S.u_label_plane_matrix_inv=g.labelPlaneMatrixInv),d.setTerrainUniformValues(x,S),this.painter.transform.projection.name==="globe"){let ae=this.globeUniformValues(this.painter.transform,s.tileID.canonical,g&&g.useDenormalizedUpVectorScale);d.setGlobeUniformValues(x,ae)}}globeUniformValues(s,d,g){let x=s.projection;return{u_tile_tl_up:x.upVector(d,0,0),u_tile_tr_up:x.upVector(d,r.a3,0),u_tile_br_up:x.upVector(d,r.a3,r.a3),u_tile_bl_up:x.upVector(d,0,r.a3),u_tile_up_scale:g?r.bs(1):x.upVectorScale(d,s.center.lat,s.worldSize).metersToTile}}renderToBackBuffer(s){let d=this.painter,g=this.painter.context;s.length!==0&&(g.bindFramebuffer.set(null),g.viewport.set([0,0,d.width,d.height]),d.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(x,b,S,C,F){if(x.transform.projection.name==="globe")(function(O,V,X,ie,ae){let ue=O.context,de=ue.gl,fe,me,Pe=O.transform,Oe=r.ba(O,ue,Pe),Ne=(bt,Ct)=>{if(me===Ct)return;let Gt=[Lt[Ct],"PROJECTION_GLOBE_VIEW"];Oe&&Gt.push("CUSTOM_ANTIALIASING");let qt=O.isTileAffectedByFog(bt);fe=O.getOrCreateProgram("globeRaster",{defines:Gt,overrideFog:qt}),me=Ct},Je=O.colorModeForRenderPass(),Ke=new r.ae(de.LEQUAL,r.ae.ReadWrite,O.depthRangeFor3D);yt.update(ae);let Fe=r.bb(Pe),Be=[r.aj(Pe.center.lng),r.ak(Pe.center.lat)],je=O.globeSharedBuffers,at=[Pe.width*r.e.devicePixelRatio,Pe.height*r.e.devicePixelRatio],xt=Float32Array.from(Pe.globeMatrix),qe={useDenormalizedUpVectorScale:!0};{let bt=O.transform,Ct=sr(bt.zoom,V.exaggeration(),V.sourceCache._source.tileSize);me=-1;let Gt=de.TRIANGLES;for(let qt of ie){let Vt=X.getTile(qt),ft=r.ag.disabled,kt=V.prevTerrainTileForTile[qt.key],jt=V.terrainTileForTile[qt.key];ct(kt,jt)&&yt.newMorphing(qt.key,kt,jt,ae,250),ue.activeTexture.set(de.TEXTURE0),Vt.texture&&Vt.texture.bind(de.LINEAR,de.CLAMP_TO_EDGE);let dr=yt.getMorphValuesForProxy(qt.key),pr=dr?1:0;dr&&r.o(qe,{morphing:{srcDemTile:dr.from,dstDemTile:dr.to,phase:r.b9(dr.phase)}});let Cr=r.bc(qt.canonical),mr=r.bd(Cr.getCenter().lat),Yt=r.be(qt.canonical,Cr,mr,bt.worldSize/bt._pixelsPerMercatorPixel),Nt=r.bf(r.bg(qt.canonical)),Pr=vf(bt.expandedFarZProjMatrix,xt,Fe,Nt,r.a1(bt.zoom),Be,bt.frustumCorners.TL,bt.frustumCorners.TR,bt.frustumCorners.BR,bt.frustumCorners.BL,bt.globeCenterInViewSpace,bt.globeRadius,at,Ct,bt._farZ,Yt);if(Ne(qt,pr),fe&&(V.setupElevationDraw(Vt,fe,qe),O.uploadCommonUniforms(ue,fe,qt.toUnwrapped()),je)){let[_i,oi,Di]=je.getGridBuffers(mr,Ct!==0);fe.draw(O,Gt,Ke,ft,Je,r.af.backCCW,Pr,"globe_raster",_i,oi,Di)}}}if(je&&(O.renderDefaultNorthPole||O.renderDefaultSouthPole)){let bt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Oe&&bt.push("CUSTOM_ANTIALIASING"),fe=O.getOrCreateProgram("globeRaster",{defines:bt});for(let Ct of ie){let{x:Gt,y:qt,z:Vt}=Ct.canonical,ft=qt===0,kt=qt===(1<<Vt)-1,[jt,dr,pr,Cr]=je.getPoleBuffers(Vt,!1);if(Cr&&(ft||kt)){let mr=X.getTile(Ct);ue.activeTexture.set(de.TEXTURE0),mr.texture&&mr.texture.bind(de.LINEAR,de.CLAMP_TO_EDGE);let Yt=r.bh(Vt,Gt,Pe),Nt=r.bf(r.bg(Ct.canonical)),Pr=(_i,oi)=>_i.draw(O,de.TRIANGLES,Ke,r.ag.disabled,Je,r.af.disabled,vf(Pe.expandedFarZProjMatrix,Yt,Yt,Nt,0,Be,Pe.frustumCorners.TL,Pe.frustumCorners.TR,Pe.frustumCorners.BR,Pe.frustumCorners.BL,Pe.globeCenterInViewSpace,Pe.globeRadius,at,0,Pe._farZ),"globe_pole_raster",oi,pr,Cr);V.setupElevationDraw(mr,fe,qe),O.uploadCommonUniforms(ue,fe,Ct.toUnwrapped()),ft&&O.renderDefaultNorthPole&&Pr(fe,jt),kt&&O.renderDefaultSouthPole&&(Yt=r.ad.scale(r.ad.create(),Yt,[1,-1,1]),Pr(fe,dr))}}}})(x,b,S,C,F);else{let O=x.context,V=O.gl,X,ie,ae=x.shadowRenderer,ue=il(x,x.longestCutoffRange),de=Je=>{if(ie===Je)return;let Ke=[];Ke.push(Lt[Je]),ue.shouldRenderCutoff&&Ke.push("RENDER_CUTOFF"),X=x.getOrCreateProgram("terrainRaster",{defines:Ke}),ie=Je},fe=x.colorModeForRenderPass(),me=new r.ae(V.LEQUAL,r.ae.ReadWrite,x.depthRangeFor3D);yt.update(F);let Pe=x.transform,Oe=sr(Pe.zoom,b.exaggeration(),b.sourceCache._source.tileSize),Ne=[0,0,0];if(ae){let Je=x.style.directionalLight,Ke=x.style.ambientLight;Je&&Ke&&(Ne=H(x.style,Je,Ke))}{ie=-1;let Je=V.TRIANGLES,[Ke,Fe]=[b.gridIndexBuffer,b.gridSegments];for(let Be of C){let je=S.getTile(Be),at=r.ag.disabled,xt=b.prevTerrainTileForTile[Be.key],qe=b.terrainTileForTile[Be.key];ct(xt,qe)&&yt.newMorphing(Be.key,xt,qe,F,250),O.activeTexture.set(V.TEXTURE0),je.texture&&je.texture.bind(V.LINEAR,V.CLAMP_TO_EDGE);let bt=yt.getMorphValuesForProxy(Be.key),Ct=bt?1:0,Gt;bt&&(Gt={morphing:{srcDemTile:bt.from,dstDemTile:bt.to,phase:r.b9(bt.phase)}});let qt=hr(Be.projMatrix,Mr(Be.canonical,Pe.renderWorldCopies)?Oe/10:Oe,Ne);if(de(Ct),!X)continue;b.setupElevationDraw(je,X,Gt);let Vt=Be.toUnwrapped();ae&&ae.setupShadows(Vt,X),x.uploadCommonUniforms(O,X,Vt,null,ue),X.draw(x,Je,me,at,fe,r.af.backCCW,qt,"terrain_raster",b.gridBuffer,Ke,Fe)}}}}(d,this,this.proxySourceCache,s,this._updateTimestamp),this.renderingToTexture=!0,d.gpuTimingDeferredRenderEnd(),s.splice(0,s.length))}renderBatch(s){if(this._drapedRenderBatches.length===0)return s+1;this.renderingToTexture=!0;let d=this.painter,g=this.painter.context,x=this.proxySourceCache,b=this.proxiedCoords[x.id],S=this._drapedRenderBatches.shift(),C=d.style.order,F=[],O=0;for(let V of b){let X=x.getTileByID(V.proxyTileKey),ie=x.proxyCachedFBO[V.key]?x.proxyCachedFBO[V.key][s]:void 0,ae=ie!==void 0?x.renderCache[ie]:this.pool[O++],ue=ie!==void 0;if(X.texture=ae.tex,ue&&!ae.dirty){F.push(X.tileID);continue}let de;g.bindFramebuffer.set(ae.fb.framebuffer),this.renderedToTile=!1,ae.dirty&&(g.clear({color:r.C.transparent,stencil:0}),ae.dirty=!1);for(let fe=S.start;fe<=S.end;++fe){let me=d.style._mergedLayers[C[fe]];if(me.isHidden(d.transform.zoom))continue;let Pe=d.style.getLayerSourceCache(me),Oe=Pe?this.proxyToSource[V.key][Pe.id]:[V];if(!Oe)continue;let Ne=Oe;g.viewport.set([0,0,ae.fb.width,ae.fb.height]),de!==(Pe?Pe.id:null)&&(this._setupStencil(ae,Oe,me,Pe),de=Pe?Pe.id:null),d.renderLayer(d,Pe,me,Ne)}if(this._drapedRenderBatches.length===0)for(let fe of this._pendingGroundEffectLayers){let me=d.style._mergedLayers[C[fe]];if(me.isHidden(d.transform.zoom))continue;let Pe=d.style.getLayerSourceCache(me),Oe=Pe?this.proxyToSource[V.key][Pe.id]:[V];if(!Oe)continue;let Ne=Oe;g.viewport.set([0,0,ae.fb.width,ae.fb.height]),de!==(Pe?Pe.id:null)&&(this._setupStencil(ae,Oe,me,Pe),de=Pe?Pe.id:null),d.renderLayer(d,Pe,me,Ne)}this.renderedToTile?(ae.dirty=!0,F.push(X.tileID)):ue||--O,O===5&&(O=0,this.renderToBackBuffer(F))}return this.renderToBackBuffer(F),this.renderingToTexture=!1,g.bindFramebuffer.set(null),g.viewport.set([0,0,d.width,d.height]),S.end+1}postRender(){}isLayerOrderingCorrect(s){let d=s.order.length,g=-1,x=d;for(let b=0;b<d;++b)this._style.isLayerDraped(s._mergedLayers[s.order[b]])?g=Math.max(g,b):x=Math.min(x,b);return x>g}getMinElevationBelowMSL(){let s=0;return this._visibleDemTiles.filter(d=>d.dem).forEach(d=>{s=Math.min(s,d.dem.tree.minimums[0])}),s===0?s:(s-30)*this._exaggeration}raycast(s,d,g){if(!this._visibleDemTiles)return null;let x=this._visibleDemTiles.filter(b=>b.dem).map(b=>{let S=b.tileID,C=1<<S.overscaledZ,{x:F,y:O}=S.canonical,V=F/C,X=(F+1)/C,ie=O/C,ae=(O+1)/C;return{minx:V,miny:ie,maxx:X,maxy:ae,t:b.dem.tree.raycastRoot(V,ie,X,ae,s,d,g),tile:b}});x.sort((b,S)=>(b.t!==null?b.t:Number.MAX_VALUE)-(S.t!==null?S.t:Number.MAX_VALUE));for(let b of x){if(b.t==null)return null;let S=b.tile.dem.tree.raycast(b.minx,b.miny,b.maxx,b.maxy,s,d,g);if(S!=null)return S}return null}_createFBO(){let s=this.painter.context,d=s.gl,g=this.drapeBufferSize;s.activeTexture.set(d.TEXTURE0);let x=new r.T(s,{width:g[0],height:g[1],data:null},d.RGBA);x.bind(d.LINEAR,d.CLAMP_TO_EDGE);let b=s.createFramebuffer(g[0],g[1],!0,null);return b.colorAttachment.set(x.texture),b.depthAttachment=new Ri(s,b.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=s.createRenderbuffer(s.gl.DEPTH_STENCIL,g[0],g[1]),this._stencilRef=0,b.depthAttachment.set(this._sharedDepthStencil),s.clear({stencil:0})):b.depthAttachment.set(this._sharedDepthStencil),s.extTextureFilterAnisotropic&&d.texParameterf(d.TEXTURE_2D,s.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s.extTextureFilterAnisotropicMax),{fb:b,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(let s in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[s].hasTransition())return!0;return this._style.order.some(s=>{let d=this._style._mergedLayers[s],g=d.isHidden(this.painter.transform.zoom);return d.type==="custom"?!g&&d.shouldRedrape():!g&&d.hasTransition()})}_clearLineLayersFromRenderCache(){let s=!1;for(let g of this._style.getSources())if(g instanceof Kc){s=!0;break}if(!s)return;let d={};for(let g=0;g<this._style.order.length;++g){let x=this._style._mergedLayers[this._style.order[g]],b=this._style.getLayerSourceCache(x);if(b&&!d[b.id]&&!x.isHidden(this.painter.transform.zoom)&&x.type==="line"&&x.widthExpression()instanceof r.Z){d[b.id]=!0;for(let S of this.proxyCoords){let C=this.proxyToSource[S.key][b.id];if(C)for(let F of C)this._clearRenderCacheForTile(b.id,F)}}}}_clearRasterLayersFromRenderCache(){let s=!1;for(let g in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[g]._source instanceof Hl){s=!0;break}if(!s)return;let d={};for(let g=0;g<this._style.order.length;++g){let x=this._style._mergedLayers[this._style.order[g]],b=this._style.getLayerSourceCache(x);if(!b||d[b.id]||x.isHidden(this.painter.transform.zoom)||x.type!=="raster")continue;let S=x.paint.get("raster-fade-duration");for(let C of this.proxyCoords){let F=this.proxyToSource[C.key][b.id];if(F)for(let O of F){let V=hi(b.getTile(O),b.findLoadedParent(O,0),b,this.painter.transform,S);(V.opacity!==1||V.mix!==0)&&this._clearRenderCacheForTile(b.id,O)}}}}_setupDrapedRenderBatches(){let s=this._style.order,d=s.length;if(d===0)return;let g=[];this._pendingGroundEffectLayers=[];let x,b=0,S=this._style._mergedLayers[s[b]];for(;!this._style.isLayerDraped(S)&&S.isHidden(this.painter.transform.zoom)&&++b<d;)S=this._style._mergedLayers[s[b]];for(;b<d;++b){let C=this._style._mergedLayers[s[b]];C.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(C)?x===void 0&&(x=b):(C.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(b),x!==void 0&&(g.push({start:x,end:b-1}),x=void 0)))}if(x!==void 0&&g.push({start:x,end:b-1}),g.length!==0){let C=g[g.length-1];this._pendingGroundEffectLayers.every(F=>F>C.end)||r.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=g}_setupRenderCache(s){let d=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,d.renderCache.length>d.renderCachePool.length){let S=Object.values(d.proxyCachedFBO);d.proxyCachedFBO={};for(let C=0;C<S.length;++C){let F=Object.values(S[C]);d.renderCachePool.push(...F)}}return}this._clearRasterLayersFromRenderCache();let g=this.proxyCoords,x=this._tilesDirty;for(let S=g.length-1;S>=0;S--){let C=g[S];if(d.getTileByID(C.key),d.proxyCachedFBO[C.key]!==void 0){let F=s[C.key],O=this.proxyToSource[C.key],V=0;for(let X in O){let ie=O[X],ae=F[X];if(!ae||ae.length!==ie.length||ie.some((ue,de)=>ue!==ae[de]||x[X]&&x[X].hasOwnProperty(ue.key))){V=-1;break}++V}for(let X in d.proxyCachedFBO[C.key])d.renderCache[d.proxyCachedFBO[C.key][X]].dirty=V<0||V!==Object.values(F).length}}let b=[...this._drapedRenderBatches];b.sort((S,C)=>C.end-C.start-(S.end-S.start));for(let S of b)for(let C of g){if(d.proxyCachedFBO[C.key])continue;let F=d.renderCachePool.pop();F===void 0&&d.renderCache.length<50&&(F=d.renderCache.length,d.renderCache.push(this._createFBO())),F!==void 0&&(d.proxyCachedFBO[C.key]={},d.proxyCachedFBO[C.key][S.start]=F,d.renderCache[F].dirty=!0)}this._tilesDirty={}}_setupStencil(s,d,g,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));let b=this.painter.context,S=b.gl;if(d.length<=1)return void(this._overlapStencilType=!1);let C;if(g.isTileClipped())C=d.length,this._overlapStencilMode.test={func:S.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(d[0].overscaledZ>d[d.length-1].overscaledZ))return void(this._overlapStencilType=!1);C=1,this._overlapStencilMode.test={func:S.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+C>255&&(b.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=C,this._overlapStencilMode.ref=this._stencilRef,g.isTileClipped()&&this._renderTileClippingMasks(d,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(s){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[s.key]),this._overlapStencilMode):r.ag.disabled}_renderTileClippingMasks(s,d){let g=this.painter,x=this.painter.context,b=x.gl;g._tileClippingMaskIDs={},x.setColorMode(r.a.disabled),x.setDepthMode(r.ae.disabled);let S=g.getOrCreateProgram("clippingMask");for(let C of s){let F=g._tileClippingMaskIDs[C.key]=--d;S.draw(g,b.TRIANGLES,r.ae.disabled,new r.ag({func:b.ALWAYS,mask:0},F,255,b.KEEP,b.KEEP,b.REPLACE),r.a.disabled,r.af.disabled,Yr(C.projMatrix),"$clipping",g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}}pointCoordinate(s){let d=this.painter.transform;if(s.x<0||s.x>d.width||s.y<0||s.y>d.height)return null;let g=[s.x,s.y,1,1];r.aA.transformMat4(g,g,d.pixelMatrixInverse),r.aA.scale(g,g,1/g[3]),g[0]/=d.worldSize,g[1]/=d.worldSize;let x=d._camera.position,b=r.ax(1,d.center.lat),S=[x[0],x[1],x[2]/b,0],C=r._.subtract([],g.slice(0,3),S);r._.normalize(C,C);let F=this.raycast(S,C,this._exaggeration);return F!==null&&F?(r._.scaleAndAdd(S,S,C,F),S[3]=S[2],S[2]*=b,S):null}drawDepth(){let s=this.painter,d=s.context,g=this.proxySourceCache,x=Math.ceil(s.width),b=Math.ceil(s.height);if(!this._depthFBO||this._depthFBO.width===x&&this._depthFBO.height===b||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){let S=d.gl,C=d.createFramebuffer(x,b,!0,"renderbuffer");d.activeTexture.set(S.TEXTURE0);let F=new r.T(d,{width:x,height:b,data:null},S.RGBA);F.bind(S.NEAREST,S.CLAMP_TO_EDGE),C.colorAttachment.set(F.texture);let O=d.createRenderbuffer(d.gl.DEPTH_COMPONENT16,x,b);C.depthAttachment.set(O),this._depthFBO=C,this._depthTexture=F}d.bindFramebuffer.set(this._depthFBO.framebuffer),d.viewport.set([0,0,x,b]),function(S,C,F,O){if(S.transform.projection.name==="globe")return;let V=S.context,X=V.gl;V.clear({depth:1});let ie=S.getOrCreateProgram("terrainDepth"),ae=new r.ae(X.LESS,r.ae.ReadWrite,S.depthRangeFor3D);for(let ue of O){let de=F.getTile(ue),fe=hr(ue.projMatrix,0,[0,0,0]);C.setupElevationDraw(de,ie),ie.draw(S,X.TRIANGLES,ae,r.ag.disabled,r.a.unblended,r.af.backCCW,fe,"terrain_depth",C.gridBuffer,C.gridIndexBuffer,C.gridNoSkirtSegments)}}(s,this,g,this.proxyCoords)}_setupProxiedCoordsForOrtho(s,d,g){if(s.getSource()instanceof r.bm)return this._setupProxiedCoordsForImageSource(s,d,g);this._findCoveringTileCache[s.id]=this._findCoveringTileCache[s.id]||{};let x=this.proxiedCoords[s.id]=[],b=this.proxyCoords;for(let F=0;F<b.length;F++){let O=b[F],V=this._findTileCoveringTileID(O,s);if(V){let X=this._createProxiedId(O,V,g[O.key]&&g[O.key][s.id]);x.push(X),this.proxyToSource[O.key][s.id]=[X]}}let S=!1,C=new Set;for(let F=0;F<d.length;F++){let O=s.getTile(d[F]);if(!O||!O.hasData())continue;let V=this._findTileCoveringTileID(O.tileID,this.proxySourceCache);if(V&&V.tileID.canonical.z!==O.tileID.canonical.z){let X=this.proxyToSource[V.tileID.key][s.id],ie=this._createProxiedId(V.tileID,O,g[V.tileID.key]&&g[V.tileID.key][s.id]);X?X.splice(X.length-1,0,ie):this.proxyToSource[V.tileID.key][s.id]=[ie];let ae=this.proxyToSource[V.tileID.key][s.id];C.has(ae)||C.add(ae),x.push(ie),S=!0}}if(this._sourceTilesOverlap[s.id]=S,S&&this._debugParams.sortTilesHiZFirst)for(let F of C)F.sort((O,V)=>V.overscaledZ-O.overscaledZ)}_setupProxiedCoordsForImageSource(s,d,g){if(!s.getSource().loaded())return;let x=this.proxiedCoords[s.id]=[],b=this.proxyCoords,S=s.getSource(),C=S.tileID;if(!C)return;let F=new r.P(C.x,C.y)._div(1<<C.z),O=S.coordinates.map(r.Y.fromLngLat).reduce((X,ie)=>(X.min.x=Math.min(X.min.x,ie.x-F.x),X.min.y=Math.min(X.min.y,ie.y-F.y),X.max.x=Math.max(X.max.x,ie.x-F.x),X.max.y=Math.max(X.max.y,ie.y-F.y),X),{min:new r.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new r.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),V=(X,ie)=>{let ae=X.wrap+X.canonical.x/(1<<X.canonical.z),ue=X.canonical.y/(1<<X.canonical.z),de=r.a3/(1<<X.canonical.z),fe=ie.wrap+ie.canonical.x/(1<<ie.canonical.z),me=ie.canonical.y/(1<<ie.canonical.z);return ae+de<fe+O.min.x||ae>fe+O.max.x||ue+de<me+O.min.y||ue>me+O.max.y};for(let X=0;X<b.length;X++){let ie=b[X];for(let ae=0;ae<d.length;ae++){let ue=s.getTile(d[ae]);if(!ue||!ue.hasData()||V(ie,ue.tileID))continue;let de=this._createProxiedId(ie,ue,g[ie.key]&&g[ie.key][s.id]),fe=this.proxyToSource[ie.key][s.id];fe?fe.push(de):this.proxyToSource[ie.key][s.id]=[de],x.push(de)}}}_createProxiedId(s,d,g){let x=this.orthoMatrix;if(g){let b=g.find(S=>S.key===d.tileID.key);if(b)return b}if(d.tileID.key!==s.key){let b=s.canonical.z-d.tileID.canonical.z,S,C,F;x=r.ad.create();let O=d.tileID.wrap-s.wrap<<s.overscaledZ;b>0?(S=r.a3>>b,C=S*((d.tileID.canonical.x<<b)-s.canonical.x+O),F=S*((d.tileID.canonical.y<<b)-s.canonical.y)):(S=r.a3<<-b,C=r.a3*(d.tileID.canonical.x-(s.canonical.x+O<<-b)),F=r.a3*(d.tileID.canonical.y-(s.canonical.y<<-b))),r.ad.ortho(x,0,S,0,S,0,1),r.ad.translate(x,x,[C,F,0])}return new Va(d.tileID,s.key,x)}_findTileCoveringTileID(s,d){let g=d.getTile(s);if(g&&g.hasData())return g;let x=this._findCoveringTileCache[d.id],b=x[s.key];if(g=b?d.getTileByID(b):null,g&&g.hasData()||b===null)return g;let S=g?g.tileID:s,C=S.overscaledZ,F=d.getSource().minzoom,O=[];if(!b){let X=d.getSource().maxzoom;if(s.canonical.z>=X){let ie=s.canonical.z-X;d.getSource().reparseOverscaled?(C=Math.max(s.canonical.z+2,d.transform.tileZoom),S=new r.aL(C,s.wrap,X,s.canonical.x>>ie,s.canonical.y>>ie)):ie!==0&&(C=X,S=new r.aL(C,s.wrap,X,s.canonical.x>>ie,s.canonical.y>>ie))}S.key!==s.key&&(O.push(S.key),g=d.getTile(S))}let V=X=>{O.forEach(ie=>{x[ie]=X}),O.length=0};for(C-=1;C>=F&&(!g||!g.hasData());C--){g&&V(g.tileID.key);let X=S.calculateScaledKey(C);if(g=d.getTileByID(X),g&&g.hasData())break;let ie=x[X];if(ie===null)break;ie===void 0?O.push(X):g=d.getTileByID(ie)}return V(g?g.tileID.key:null),g&&g.hasData()?g:null}findDEMTileFor(s){return this.enabled?this._findTileCoveringTileID(s,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(s,d){let g=this._tilesDirty[s];g||(g=this._tilesDirty[s]={}),g[d.key]=!0}}function la(m,s,d){let g=function(C,F,O){let V=r._.dot(F,C),X=r._.dot(O,[.2126,.7152,.0722]),ie=(ue,de,fe)=>(1-fe)*ue+fe*de,ae=ie(1-.3*Math.min(X,1),1,Math.min(V+1,1));return ie(.92,1,Math.asin(r.at(F[2],-1,1))/Math.PI+.5)*ae}(m,[0,0,1],s),x=[0,0,0];r._.scale(x,d.slice(0,3),g);let b=[0,0,0];r._.scale(b,s.slice(0,3),m[2]);let S=[0,0,0];return r._.add(S,x,b),r.b8(S)}let ys=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],xs=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class zs{static cacheKey(s,d,g,x){let b=`${d}${x?x.cacheKey:""}`;for(let S of g)s.usedDefines.includes(S)&&(b+=`/${S}`);return b}constructor(s,d,g,x,b,S){let C=s.gl;this.program=C.createProgram(),this.configuration=x,this.name=d,this.fixedDefines=[...S];let F=x?x.getBinderAttributes():[],O=(g.staticAttributes||[]).concat(F),V=x?x.defines():[];V=V.concat(S.map(fe=>`#define ${fe}`));let X=`#version 300 es
`,ie=X+V.concat("precision mediump float;",Mu,ku.fragmentSource).join(`
`);for(let fe of g.fragmentIncludes)ie+=`
${Ah[fe]}`;ie+=`
${g.fragmentSource}`;let ae=X+V.concat("precision highp float;",Mu,ku.vertexSource).join(`
`);for(let fe of g.vertexIncludes)ae+=`
${Ah[fe]}`;ae+=`
${g.vertexSource}`;let ue=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);C.shaderSource(ue,ie),C.compileShader(ue),C.attachShader(this.program,ue);let de=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())this.failedToCreate=!0;else{C.shaderSource(de,ae),C.compileShader(de),C.attachShader(this.program,de),this.attributes={},this.numAttributes=O.length;for(let fe=0;fe<this.numAttributes;fe++)if(O[fe]){let me=O[fe].startsWith("a_")?O[fe]:`a_${O[fe]}`;C.bindAttribLocation(this.program,fe,me),this.attributes[me]=fe}C.linkProgram(this.program),C.deleteShader(de),C.deleteShader(ue),this.fixedUniforms=b(s),this.binderUniforms=x?x.getUniforms(s):[],S.includes("TERRAIN")&&(this.terrainUniforms=(fe=>({u_dem:new r.a7(fe),u_dem_prev:new r.a7(fe),u_dem_tl:new r.a8(fe),u_dem_scale:new r.aa(fe),u_dem_tl_prev:new r.a8(fe),u_dem_scale_prev:new r.aa(fe),u_dem_size:new r.aa(fe),u_dem_lerp:new r.aa(fe),u_exaggeration:new r.aa(fe),u_depth:new r.a7(fe),u_depth_size_inv:new r.a8(fe),u_meter_to_dem:new r.aa(fe),u_label_plane_matrix_inv:new r.a6(fe)}))(s)),S.includes("GLOBE")&&(this.globeUniforms=(fe=>({u_tile_tl_up:new r.aq(fe),u_tile_tr_up:new r.aq(fe),u_tile_br_up:new r.aq(fe),u_tile_bl_up:new r.aq(fe),u_tile_up_scale:new r.aa(fe)}))(s)),S.includes("FOG")&&(this.fogUniforms=(fe=>({u_fog_matrix:new r.a6(fe),u_fog_range:new r.a8(fe),u_fog_color:new r.as(fe),u_fog_horizon_blend:new r.aa(fe),u_fog_vertical_limit:new r.a8(fe),u_fog_temporal_offset:new r.aa(fe),u_frustum_tl:new r.aq(fe),u_frustum_tr:new r.aq(fe),u_frustum_br:new r.aq(fe),u_frustum_bl:new r.aq(fe),u_globe_pos:new r.aq(fe),u_globe_radius:new r.aa(fe),u_globe_transition:new r.aa(fe),u_is_globe:new r.a7(fe),u_viewport:new r.a8(fe)}))(s)),S.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(fe=>({u_cutoff_params:new r.as(fe)}))(s)),S.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(fe=>({u_lighting_ambient_color:new r.aq(fe),u_lighting_directional_dir:new r.aq(fe),u_lighting_directional_color:new r.aq(fe),u_ground_radiance:new r.aq(fe)}))(s)),S.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(fe=>({u_light_matrix_0:new r.a6(fe),u_light_matrix_1:new r.a6(fe),u_fade_range:new r.a8(fe),u_shadow_normal_offset:new r.aq(fe),u_shadow_intensity:new r.aa(fe),u_shadow_texel_size:new r.aa(fe),u_shadow_map_resolution:new r.aa(fe),u_shadow_direction:new r.aq(fe),u_shadow_bias:new r.aq(fe),u_shadowmap_0:new r.a7(fe),u_shadowmap_1:new r.a7(fe)}))(s))}}setTerrainUniformValues(s,d){if(!this.terrainUniforms)return;let g=this.terrainUniforms;if(!this.failedToCreate){s.program.set(this.program);for(let x in d)g[x]&&g[x].set(this.program,x,d[x])}}setGlobeUniformValues(s,d){if(!this.globeUniforms)return;let g=this.globeUniforms;if(!this.failedToCreate){s.program.set(this.program);for(let x in d)g[x]&&g[x].set(this.program,x,d[x])}}setFogUniformValues(s,d){if(!this.fogUniforms)return;let g=this.fogUniforms;if(!this.failedToCreate){s.program.set(this.program);for(let x in d)g[x].set(this.program,x,d[x])}}setCutoffUniformValues(s,d){if(!this.cutoffUniforms)return;let g=this.cutoffUniforms;if(!this.failedToCreate){s.program.set(this.program);for(let x in d)g[x].set(this.program,x,d[x])}}setLightsUniformValues(s,d){if(!this.lightsUniforms)return;let g=this.lightsUniforms;if(!this.failedToCreate){s.program.set(this.program);for(let x in d)g[x].set(this.program,x,d[x])}}setShadowUniformValues(s,d){if(this.failedToCreate||!this.shadowUniforms)return;let g=this.shadowUniforms;s.program.set(this.program);for(let x in d)g[x].set(this.program,x,d[x])}_drawDebugWireframe(s,d,g,x,b,S,C,F,O,V){let X=s.options.wireframe;if(X.terrain===!1&&X.layers2D===!1&&X.layers3D===!1)return;let ie=s.context;if(!(!(!X.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!X.layers2D||s._terrain&&s._terrain.renderingToTexture||!ys.includes(this.name))||!(!X.layers3D||!xs.includes(this.name))))return;let ae=ie.gl,ue=s.wireframeDebugCache.getLinesFromTrianglesBuffer(s.frameCounter,b,ie);if(!ue)return;let de=[...this.fixedDefines];de.push("DEBUG_WIREFRAME");let fe=s.getOrCreateProgram(this.name,{config:this.configuration,defines:de});ie.program.set(fe.program);let me=(Ne,Je,Ke)=>{if(Je[Ne]&&Ke[Ne])for(let Fe in Je[Ne])Ke[Ne][Fe]&&Ke[Ne][Fe].set(Ke.program,Fe,Je[Ne][Fe].current)};O&&O.setUniforms(fe.program,ie,fe.binderUniforms,C,{zoom:F}),me("fixedUniforms",this,fe),me("terrainUniforms",this,fe),me("globeUniforms",this,fe),me("fogUniforms",this,fe),me("lightsUniforms",this,fe),me("shadowUniforms",this,fe),ue.bind(),ie.setColorMode(new r.a([ae.ONE,ae.ONE_MINUS_SRC_ALPHA,ae.ZERO,ae.ONE],r.C.transparent,[!0,!0,!0,!1])),ie.setDepthMode(new r.ae(d.func===ae.LESS?ae.LEQUAL:d.func,r.ae.ReadOnly,d.range)),ie.setStencilMode(r.ag.disabled);let Pe=3*S.primitiveLength*2,Oe=3*S.primitiveOffset*2*2;V&&V>1?ae.drawElementsInstanced(ae.LINES,Pe,ae.UNSIGNED_SHORT,Oe,V):ae.drawElements(ae.LINES,Pe,ae.UNSIGNED_SHORT,Oe),b.bind(),ie.program.set(this.program),ie.setDepthMode(d),ie.setStencilMode(g),ie.setColorMode(x)}draw(s,d,g,x,b,S,C,F,O,V,X,ie,ae,ue,de,fe){let me=s.context,Pe=me.gl;if(this.failedToCreate)return;me.program.set(this.program),me.setDepthMode(g),me.setStencilMode(x),me.setColorMode(b),me.setCullFace(S);for(let Je of Object.keys(this.fixedUniforms))this.fixedUniforms[Je].set(this.program,Je,C[Je]);ue&&ue.setUniforms(this.program,me,this.binderUniforms,ie,{zoom:ae});let Oe={[Pe.POINTS]:1,[Pe.LINES]:2,[Pe.TRIANGLES]:3,[Pe.LINE_STRIP]:1}[d],Ne=fe&&fe>0?1:void 0;for(let Je of X.get()){let Ke=Je.vaos||(Je.vaos={});(Ke[F]||(Ke[F]=new _f)).bind(me,this,O,ue?ue.getPaintVertexBuffers():[],V,Je.vertexOffset,de||[],Ne),fe&&fe>1?Pe.drawElementsInstanced(d,Je.primitiveLength*Oe,Pe.UNSIGNED_SHORT,Je.primitiveOffset*Oe*2,fe):V?Pe.drawElements(d,Je.primitiveLength*Oe,Pe.UNSIGNED_SHORT,Je.primitiveOffset*Oe*2):Pe.drawArrays(d,Je.vertexOffset,Je.vertexLength),d===Pe.TRIANGLES&&V&&this._drawDebugWireframe(s,g,x,b,V,Je,ie,ae,ue,fe)}}}function Ru(m,s){let d=Math.pow(2,s.tileID.overscaledZ),g=s.tileSize*Math.pow(2,m.transform.tileZoom)/d,x=g*(s.tileID.canonical.x+s.tileID.wrap*d),b=g*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture?s.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/r.bB(s,1,m.transform.tileZoom),u_pixel_coord_upper:[x>>16,b>>16],u_pixel_coord_lower:[65535&x,65535&b]}}let tu=r.ad.create(),Xl=(m,s,d,g,x,b,S,C,F,O,V,X,ie,ae,ue,de)=>{let fe=s.style.light,me=fe.properties.get("position"),Pe=[me.x,me.y,me.z],Oe=r.bC.create();fe.properties.get("anchor")==="viewport"&&(r.bC.fromRotation(Oe,-s.transform.angle),r._.transformMat3(Pe,Pe,Oe));let Ne=fe.properties.get("color"),Je=s.transform,Ke={u_matrix:m,u_lightpos:Pe,u_lightintensity:fe.properties.get("intensity"),u_lightcolor:[Ne.r,Ne.g,Ne.b],u_vertical_gradient:+d,u_opacity:g,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:tu,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:x,u_edge_radius:b,u_flood_light_color:X,u_vertical_scale:ie,u_flood_light_intensity:ae,u_ground_shadow_factor:ue,u_emissive_strength:de};return Je.projection.name==="globe"&&(Ke.u_tile_id=[S.canonical.x,S.canonical.y,1<<S.canonical.z],Ke.u_zoom_transition=F,Ke.u_inv_rot_matrix=V,Ke.u_merc_center=O,Ke.u_up_dir=Je.projection.upVector(new r.aO(0,0,0),O[0]*r.a3,O[1]*r.a3),Ke.u_height_lift=C),Ke},Cl=(m,s,d)=>({u_matrix:m,u_edge_radius:s,u_vertical_scale:d}),Fu=(m,s,d,g,x,b,S,C,F,O,V,X,ie,ae)=>{let ue=Xl(m,s,d,g,x,b,S,F,O,V,X,ie,ae,1,[0,0,0],0),de={u_height_factor:-Math.pow(2,S.overscaledZ)/C.tileSize/8};return r.W(ue,Ru(s,C),de)},Pu=(m,s)=>({u_matrix:m,u_emissive_strength:s}),ru=(m,s,d,g)=>r.W(Pu(m,s),Ru(d,g)),rs=(m,s,d)=>({u_matrix:m,u_world:d,u_emissive_strength:s}),Ec=(m,s,d,g,x)=>r.W(ru(m,s,d,g),{u_world:x}),iu=(m,s,d,g)=>{let x=r.a3/d.tileSize;return{u_matrix:m,u_camera_to_center_distance:s.getCameraToCenterDistance(g),u_extrude_scale:[s.pixelsToGLUnits[0]/x,s.pixelsToGLUnits[1]/x]}},Ac=(m,s,d=1)=>({u_matrix:m,u_color:s.toRenderColor(null),u_overlay:0,u_overlay_scale:d}),Cc=r.ad.create(),ho=(m,s,d,g,x,b,S)=>{let C=m.transform,F=C.projection.name==="globe",O=F?r.bD(C.zoom,s.canonical)*C._pixelsPerMercatorPixel:r.bB(d,1,b),V={u_matrix:s.projMatrix,u_extrude_scale:O,u_intensity:S,u_inv_rot_matrix:Cc,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(F){V.u_inv_rot_matrix=g,V.u_merc_center=x,V.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],V.u_zoom_transition=r.a1(C.zoom);let X=x[0]*r.a3,ie=x[1]*r.a3;V.u_up_dir=C.projection.upVector(new r.aO(0,0,0),X,ie)}return V};function xf(m,[s,d,g,x],[b,S]){if(b===S)return[0,0,0,0];let C=255*(m-1)/(m*(S-b));return[s*C,d*C,g*C,x*C]}function Lu(m,s,[d,g]){return d===g?0:.5/m+(s-d)*(m-1)/(m*(g-d))}let nu=(m,s,d,g,x,b,S,C,F,O,V,X,ie,ae,ue,de,fe,me,Pe,Oe,Ne)=>({u_matrix:m,u_normalize_matrix:s,u_globe_matrix:d,u_merc_matrix:g,u_grid_matrix:x,u_tl_parent:b,u_scale_parent:O,u_fade_t:V.mix,u_opacity:V.opacity*X.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:X.paint.get("raster-brightness-min"),u_brightness_high:X.paint.get("raster-brightness-max"),u_saturation_factor:r.bE(X.paint.get("raster-saturation")),u_contrast_factor:r.bF(X.paint.get("raster-contrast")),u_spin_weights:is(X.paint.get("raster-hue-rotate")),u_perspective_transform:ie,u_raster_elevation:ae,u_zoom_transition:S,u_merc_center:C,u_cutoff_params:F,u_colorization_mix:xf(r.bG,de,me),u_colorization_offset:Lu(r.bG,fe,me),u_color_ramp:ue,u_texture_offset:[Oe/(Pe+2*Oe),Pe/(Pe+2*Oe)],u_texture_res:[Pe+2*Oe,Pe+2*Oe],u_emissive_strength:Ne});function is(m){m*=Math.PI/180;let s=Math.sin(m),d=Math.cos(m);return[(2*d+1)/3,(-Math.sqrt(3)*s-d+1)/3,(Math.sqrt(3)*s-d+1)/3]}let nl=.15,bd=(m,s,d,g,x,b,S,C,F,O,V,X)=>({u_matrix:m,u_normalize_matrix:s,u_globe_matrix:d,u_merc_matrix:g,u_grid_matrix:x,u_tl_parent:b,u_scale_parent:O,u_fade_t:V.mix,u_opacity:V.opacity,u_image0:0,u_image1:1,u_raster_elevation:X,u_zoom_transition:S,u_merc_center:C,u_cutoff_params:F}),wd=(m,s,d,g,x,b,S,C,F,O)=>({u_particle_texture:m,u_particle_texture_side_len:s,u_tile_offset:d,u_velocity:g,u_color_ramp:b,u_velocity_res:x,u_max_speed:S,u_uv_offset:C,u_data_scale:F,u_data_offset:O,u_particle_pos_scale:1.3,u_particle_pos_offset:[nl,nl]}),au=(m,s,d,g,x,b,S,C,F,O)=>({u_particle_texture:m,u_particle_texture_side_len:s,u_velocity:d,u_velocity_res:g,u_max_speed:x,u_speed_factor:b,u_reset_rate:S,u_rand_seed:Math.random(),u_uv_offset:C,u_data_scale:F,u_data_offset:O,u_particle_pos_scale:1.3,u_particle_pos_offset:[nl,nl]}),Ga=r.ad.create(),Ho=(m,s,d,g,x,b,S,C,F,O,V,X,ie,ae,ue,de,fe,me)=>{let Pe=x.transform,Oe={u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Pe.getCameraToCenterDistance(de),u_rotate_symbol:+d,u_aspect_ratio:Pe.width/Pe.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:S,u_coord_matrix:C,u_is_text:+F,u_pitch_with_map:+g,u_texsize:O,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ga,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Ga,u_up_vector:[0,-1,0],u_color_adj_mat:fe,u_icon_transition:me||0};return de.name==="globe"&&(Oe.u_tile_id=[V.canonical.x,V.canonical.y,1<<V.canonical.z],Oe.u_zoom_transition=X,Oe.u_inv_rot_matrix=ae,Oe.u_merc_center=ie,Oe.u_camera_forward=Pe._camera.forward(),Oe.u_ecef_origin=r.bH(Pe.globeMatrix,V.toUnwrapped()),Oe.u_tile_matrix=Float32Array.from(Pe.globeMatrix),Oe.u_up_vector=ue),Oe},Il=(m,s,d,g,x,b,S,C,F,O,V,X,ie,ae,ue,de,fe)=>r.W(Ho(m,s,d,g,x,b,S,C,F,O,X,ie,ae,ue,de,fe),{u_gamma_scale:g?x.transform.getCameraToCenterDistance(fe)*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:r.e.devicePixelRatio,u_is_halo:+V,undefined:void 0}),kl=(m,s,d,g,x,b,S,C,F,O,V,X,ie,ae,ue,de)=>r.W(Il(m,s,d,g,x,b,S,C,!0,F,!0,V,X,ie,ae,ue,de),{u_texsize_icon:O,u_texture_icon:1}),js=(m,s,d,g)=>({u_matrix:m,u_emissive_strength:s,u_opacity:d,u_color:g}),Ou=(m,s,d,g,x,b,S,C)=>r.W(function(F,O,V,X,ie){let{width:ae,height:ue}=X.imageManager.getPixelSize(O),de=Math.pow(2,ie.tileID.overscaledZ),fe=ie.tileSize*Math.pow(2,X.transform.tileZoom)/de,me=fe*(ie.tileID.canonical.x+ie.tileID.wrap*de),Pe=fe*ie.tileID.canonical.y;return{u_image:0,u_pattern_tl:V.tl,u_pattern_br:V.br,u_texsize:[ae,ue],u_pattern_size:V.displaySize,u_tile_units_to_pixels:1/r.bB(ie,1,X.transform.tileZoom),u_pixel_coord_upper:[me>>16,Pe>>16],u_pixel_coord_lower:[65535&me,65535&Pe]}}(0,b,S,g,C),{u_matrix:m,u_emissive_strength:s,u_opacity:d}),Us=new Float32Array(r.ad.identity([])),Zl=(m,s,d,g,x,b,S,C,F,O,V,X,ie,ae=[0,0,0],ue)=>{let de=x.style.light,fe=de.properties.get("position"),me=[-fe.x,-fe.y,fe.z],Pe=r.bC.create();de.properties.get("anchor")==="viewport"&&(r.bC.fromRotation(Pe,-x.transform.angle),r._.transformMat3(me,me,Pe));let Oe=V.alphaMode==="MASK",Ne=de.properties.get("color").toRenderColor(null),Je=ie.paint.get("model-ambient-occlusion-intensity"),Ke=ie.paint.get("model-color").constantOr(r.C.white).toRenderColor(null),Fe=ie.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:m,u_lighting_matrix:s,u_normal_matrix:d,u_node_matrix:g||Us,u_lightpos:me,u_lightintensity:de.properties.get("intensity"),u_lightcolor:[Ne.r,Ne.g,Ne.b],u_camera_pos:ae,u_opacity:b,u_baseTextureIsAlpha:0,u_alphaMask:+Oe,u_alphaCutoff:V.alphaCutoff,u_baseColorFactor:[S.r,S.g,S.b,S.a],u_emissiveFactor:[C[0],C[1],C[2],1],u_metallicFactor:F,u_roughnessFactor:O,u_baseColorTexture:co.BaseColor,u_metallicRoughnessTexture:co.MetallicRoughness,u_normalTexture:co.Normal,u_occlusionTexture:co.Occlusion,u_emissionTexture:co.Emission,u_lutTexture:co.LUT,u_color_mix:[Ke.r,Ke.g,Ke.b,Fe],u_aoIntensity:Je,u_emissive_strength:X,u_occlusionTextureTransform:ue||[0,0,0,0]}},Mh=(m,s=Us,d=Us)=>({u_matrix:m,u_instance:s,u_node_matrix:d}),Ic=(m,s,d,g,x)=>({u_matrix:Float32Array.from(m),u_anchorPos:s,u_screenSizePx:d,u_occluderSizePx:g,u_color:x}),Ml={fillExtrusion:m=>({u_matrix:new r.a6(m),u_lightpos:new r.aq(m),u_lightintensity:new r.aa(m),u_lightcolor:new r.aq(m),u_vertical_gradient:new r.aa(m),u_opacity:new r.aa(m),u_edge_radius:new r.aa(m),u_ao:new r.a8(m),u_tile_id:new r.aq(m),u_zoom_transition:new r.aa(m),u_inv_rot_matrix:new r.a6(m),u_merc_center:new r.a8(m),u_up_dir:new r.aq(m),u_height_lift:new r.aa(m),u_flood_light_color:new r.aq(m),u_vertical_scale:new r.aa(m),u_flood_light_intensity:new r.aa(m),u_ground_shadow_factor:new r.aq(m),u_emissive_strength:new r.aa(m)}),fillExtrusionDepth:m=>({u_matrix:new r.a6(m),u_edge_radius:new r.aa(m),u_vertical_scale:new r.aa(m)}),fillExtrusionPattern:m=>({u_matrix:new r.a6(m),u_lightpos:new r.aq(m),u_lightintensity:new r.aa(m),u_lightcolor:new r.aq(m),u_vertical_gradient:new r.aa(m),u_height_factor:new r.aa(m),u_edge_radius:new r.aa(m),u_ao:new r.a8(m),u_tile_id:new r.aq(m),u_zoom_transition:new r.aa(m),u_inv_rot_matrix:new r.a6(m),u_merc_center:new r.a8(m),u_up_dir:new r.aq(m),u_height_lift:new r.aa(m),u_image:new r.a7(m),u_texsize:new r.a8(m),u_pixel_coord_upper:new r.a8(m),u_pixel_coord_lower:new r.a8(m),u_tile_units_to_pixels:new r.aa(m),u_opacity:new r.aa(m)}),fillExtrusionGroundEffect:m=>({u_matrix:new r.a6(m),u_opacity:new r.aa(m),u_ao_pass:new r.aa(m),u_meter_to_tile:new r.aa(m),u_ao:new r.a8(m),u_flood_light_intensity:new r.aa(m),u_flood_light_color:new r.aq(m),u_attenuation:new r.aa(m),u_edge_radius:new r.aa(m),u_fb:new r.a7(m),u_fb_size:new r.aa(m)}),fill:m=>({u_matrix:new r.a6(m),u_emissive_strength:new r.aa(m)}),fillPattern:m=>({u_matrix:new r.a6(m),u_emissive_strength:new r.aa(m),u_image:new r.a7(m),u_texsize:new r.a8(m),u_pixel_coord_upper:new r.a8(m),u_pixel_coord_lower:new r.a8(m),u_tile_units_to_pixels:new r.aa(m)}),fillOutline:m=>({u_matrix:new r.a6(m),u_emissive_strength:new r.aa(m),u_world:new r.a8(m)}),fillOutlinePattern:m=>({u_matrix:new r.a6(m),u_emissive_strength:new r.aa(m),u_world:new r.a8(m),u_image:new r.a7(m),u_texsize:new r.a8(m),u_pixel_coord_upper:new r.a8(m),u_pixel_coord_lower:new r.a8(m),u_tile_units_to_pixels:new r.aa(m)}),circle:r.bI,collisionBox:m=>({u_matrix:new r.a6(m),u_camera_to_center_distance:new r.aa(m),u_extrude_scale:new r.a8(m)}),collisionCircle:m=>({u_matrix:new r.a6(m),u_inv_matrix:new r.a6(m),u_camera_to_center_distance:new r.aa(m),u_viewport_size:new r.a8(m)}),debug:m=>({u_color:new r.a9(m),u_matrix:new r.a6(m),u_overlay:new r.a7(m),u_overlay_scale:new r.aa(m)}),clippingMask:m=>({u_matrix:new r.a6(m)}),heatmap:m=>({u_extrude_scale:new r.aa(m),u_intensity:new r.aa(m),u_matrix:new r.a6(m),u_inv_rot_matrix:new r.a6(m),u_merc_center:new r.a8(m),u_tile_id:new r.aq(m),u_zoom_transition:new r.aa(m),u_up_dir:new r.aq(m)}),heatmapTexture:m=>({u_image:new r.a7(m),u_color_ramp:new r.a7(m),u_opacity:new r.aa(m)}),hillshade:m=>({u_matrix:new r.a6(m),u_image:new r.a7(m),u_latrange:new r.a8(m),u_light:new r.a8(m),u_shadow:new r.a9(m),u_highlight:new r.a9(m),u_emissive_strength:new r.aa(m),u_accent:new r.a9(m)}),hillshadePrepare:m=>({u_matrix:new r.a6(m),u_image:new r.a7(m),u_dimension:new r.a8(m),u_zoom:new r.aa(m)}),line:r.bJ,linePattern:r.bK,raster:m=>({u_matrix:new r.a6(m),u_normalize_matrix:new r.a6(m),u_globe_matrix:new r.a6(m),u_merc_matrix:new r.a6(m),u_grid_matrix:new r.ar(m),u_tl_parent:new r.a8(m),u_scale_parent:new r.aa(m),u_fade_t:new r.aa(m),u_opacity:new r.aa(m),u_image0:new r.a7(m),u_image1:new r.a7(m),u_brightness_low:new r.aa(m),u_brightness_high:new r.aa(m),u_saturation_factor:new r.aa(m),u_contrast_factor:new r.aa(m),u_spin_weights:new r.aq(m),u_perspective_transform:new r.a8(m),u_raster_elevation:new r.aa(m),u_zoom_transition:new r.aa(m),u_merc_center:new r.a8(m),u_cutoff_params:new r.as(m),u_colorization_mix:new r.as(m),u_colorization_offset:new r.aa(m),u_color_ramp:new r.a7(m),u_texture_offset:new r.a8(m),u_texture_res:new r.a8(m),u_emissive_strength:new r.aa(m)}),rasterParticle:m=>({u_matrix:new r.a6(m),u_normalize_matrix:new r.a6(m),u_globe_matrix:new r.a6(m),u_merc_matrix:new r.a6(m),u_grid_matrix:new r.ar(m),u_tl_parent:new r.a8(m),u_scale_parent:new r.aa(m),u_fade_t:new r.aa(m),u_opacity:new r.aa(m),u_image0:new r.a7(m),u_image1:new r.a7(m),u_raster_elevation:new r.aa(m),u_zoom_transition:new r.aa(m),u_merc_center:new r.a8(m),u_cutoff_params:new r.as(m)}),rasterParticleTexture:m=>({u_texture:new r.a7(m),u_opacity:new r.aa(m)}),rasterParticleDraw:m=>({u_particle_texture:new r.a7(m),u_particle_texture_side_len:new r.aa(m),u_tile_offset:new r.a8(m),u_velocity:new r.a7(m),u_color_ramp:new r.a7(m),u_velocity_res:new r.a8(m),u_max_speed:new r.aa(m),u_uv_offset:new r.a8(m),u_data_scale:new r.as(m),u_data_offset:new r.aa(m),u_particle_pos_scale:new r.aa(m),u_particle_pos_offset:new r.a8(m)}),rasterParticleUpdate:m=>({u_particle_texture:new r.a7(m),u_particle_texture_side_len:new r.aa(m),u_velocity:new r.a7(m),u_velocity_res:new r.a8(m),u_max_speed:new r.aa(m),u_speed_factor:new r.aa(m),u_reset_rate:new r.aa(m),u_rand_seed:new r.aa(m),u_uv_offset:new r.a8(m),u_data_scale:new r.as(m),u_data_offset:new r.aa(m),u_particle_pos_scale:new r.aa(m),u_particle_pos_offset:new r.a8(m)}),symbolIcon:m=>({u_is_size_zoom_constant:new r.a7(m),u_is_size_feature_constant:new r.a7(m),u_size_t:new r.aa(m),u_size:new r.aa(m),u_camera_to_center_distance:new r.aa(m),u_rotate_symbol:new r.a7(m),u_aspect_ratio:new r.aa(m),u_fade_change:new r.aa(m),u_matrix:new r.a6(m),u_label_plane_matrix:new r.a6(m),u_coord_matrix:new r.a6(m),u_is_text:new r.a7(m),u_pitch_with_map:new r.a7(m),u_texsize:new r.a8(m),u_tile_id:new r.aq(m),u_zoom_transition:new r.aa(m),u_inv_rot_matrix:new r.a6(m),u_merc_center:new r.a8(m),u_camera_forward:new r.aq(m),u_tile_matrix:new r.a6(m),u_up_vector:new r.aq(m),u_ecef_origin:new r.aq(m),u_texture:new r.a7(m),u_icon_transition:new r.aa(m),u_color_adj_mat:new r.a6(m)}),symbolSDF:m=>({u_is_size_zoom_constant:new r.a7(m),u_is_size_feature_constant:new r.a7(m),u_size_t:new r.aa(m),u_size:new r.aa(m),u_camera_to_center_distance:new r.aa(m),u_rotate_symbol:new r.a7(m),u_aspect_ratio:new r.aa(m),u_fade_change:new r.aa(m),u_matrix:new r.a6(m),u_label_plane_matrix:new r.a6(m),u_coord_matrix:new r.a6(m),u_is_text:new r.a7(m),u_pitch_with_map:new r.a7(m),u_texsize:new r.a8(m),u_texture:new r.a7(m),u_gamma_scale:new r.aa(m),u_device_pixel_ratio:new r.aa(m),u_tile_id:new r.aq(m),u_zoom_transition:new r.aa(m),u_inv_rot_matrix:new r.a6(m),u_merc_center:new r.a8(m),u_camera_forward:new r.aq(m),u_tile_matrix:new r.a6(m),u_up_vector:new r.aq(m),u_ecef_origin:new r.aq(m),u_is_halo:new r.a7(m)}),symbolTextAndIcon:m=>({u_is_size_zoom_constant:new r.a7(m),u_is_size_feature_constant:new r.a7(m),u_size_t:new r.aa(m),u_size:new r.aa(m),u_camera_to_center_distance:new r.aa(m),u_rotate_symbol:new r.a7(m),u_aspect_ratio:new r.aa(m),u_fade_change:new r.aa(m),u_matrix:new r.a6(m),u_label_plane_matrix:new r.a6(m),u_coord_matrix:new r.a6(m),u_is_text:new r.a7(m),u_pitch_with_map:new r.a7(m),u_texsize:new r.a8(m),u_texsize_icon:new r.a8(m),u_texture:new r.a7(m),u_texture_icon:new r.a7(m),u_gamma_scale:new r.aa(m),u_device_pixel_ratio:new r.aa(m),u_is_halo:new r.a7(m)}),background:m=>({u_matrix:new r.a6(m),u_emissive_strength:new r.aa(m),u_opacity:new r.aa(m),u_color:new r.a9(m)}),backgroundPattern:m=>({u_matrix:new r.a6(m),u_emissive_strength:new r.aa(m),u_opacity:new r.aa(m),u_image:new r.a7(m),u_pattern_tl:new r.a8(m),u_pattern_br:new r.a8(m),u_texsize:new r.a8(m),u_pattern_size:new r.a8(m),u_pixel_coord_upper:new r.a8(m),u_pixel_coord_lower:new r.a8(m),u_tile_units_to_pixels:new r.aa(m)}),terrainRaster:_c,terrainDepth:_c,skybox:m=>({u_matrix:new r.a6(m),u_sun_direction:new r.aq(m),u_cubemap:new r.a7(m),u_opacity:new r.aa(m),u_temporal_offset:new r.aa(m)}),skyboxGradient:m=>({u_matrix:new r.a6(m),u_color_ramp:new r.a7(m),u_center_direction:new r.aq(m),u_radius:new r.aa(m),u_opacity:new r.aa(m),u_temporal_offset:new r.aa(m)}),skyboxCapture:m=>({u_matrix_3f:new r.ar(m),u_sun_direction:new r.aq(m),u_sun_intensity:new r.aa(m),u_color_tint_r:new r.as(m),u_color_tint_m:new r.as(m),u_luminance:new r.aa(m)}),globeRaster:m=>({u_proj_matrix:new r.a6(m),u_globe_matrix:new r.a6(m),u_normalize_matrix:new r.a6(m),u_merc_matrix:new r.a6(m),u_zoom_transition:new r.aa(m),u_merc_center:new r.a8(m),u_image0:new r.a7(m),u_grid_matrix:new r.ar(m),u_skirt_height:new r.aa(m),u_far_z_cutoff:new r.aa(m),u_frustum_tl:new r.aq(m),u_frustum_tr:new r.aq(m),u_frustum_br:new r.aq(m),u_frustum_bl:new r.aq(m),u_globe_pos:new r.aq(m),u_globe_radius:new r.aa(m),u_viewport:new r.a8(m)}),globeAtmosphere:m=>({u_frustum_tl:new r.aq(m),u_frustum_tr:new r.aq(m),u_frustum_br:new r.aq(m),u_frustum_bl:new r.aq(m),u_horizon:new r.aa(m),u_transition:new r.aa(m),u_fadeout_range:new r.aa(m),u_color:new r.as(m),u_high_color:new r.as(m),u_space_color:new r.as(m),u_temporal_offset:new r.aa(m),u_horizon_angle:new r.aa(m)}),model:m=>({u_matrix:new r.a6(m),u_lighting_matrix:new r.a6(m),u_normal_matrix:new r.a6(m),u_node_matrix:new r.a6(m),u_lightpos:new r.aq(m),u_lightintensity:new r.aa(m),u_lightcolor:new r.aq(m),u_camera_pos:new r.aq(m),u_opacity:new r.aa(m),u_baseColorFactor:new r.as(m),u_emissiveFactor:new r.as(m),u_metallicFactor:new r.aa(m),u_roughnessFactor:new r.aa(m),u_baseTextureIsAlpha:new r.a7(m),u_alphaMask:new r.a7(m),u_alphaCutoff:new r.aa(m),u_baseColorTexture:new r.a7(m),u_metallicRoughnessTexture:new r.a7(m),u_normalTexture:new r.a7(m),u_occlusionTexture:new r.a7(m),u_emissionTexture:new r.a7(m),u_lutTexture:new r.a7(m),u_color_mix:new r.as(m),u_aoIntensity:new r.aa(m),u_emissive_strength:new r.aa(m),u_occlusionTextureTransform:new r.as(m)}),modelDepth:m=>({u_matrix:new r.a6(m),u_instance:new r.a6(m),u_node_matrix:new r.a6(m)}),groundShadow:m=>({u_matrix:new r.a6(m),u_ground_shadow_factor:new r.aq(m)}),stars:m=>({u_matrix:new r.a6(m),u_up:new r.aq(m),u_right:new r.aq(m),u_intensity_multiplier:new r.aa(m)}),occlusion:m=>({u_matrix:new r.a6(m),u_anchorPos:new r.aq(m),u_screenSizePx:new r.a8(m),u_occluderSizePx:new r.a8(m),u_color:new r.as(m)})};function al(m,s,d){let g=s.createTileMatrix(m,m.worldSize,d.toUnwrapped());return r.ad.multiply(new Float32Array(16),m.projMatrix,g)}function Nu(m,s,d){if(s.projection.name===d.projection.name)return m.projMatrix;let g=d.clone();return g.setProjection(s.projection),al(g,s.getProjection(),m)}function Dl(m,s,d){return s.name===d.projection.name?m.projMatrix:al(d,s,m)}let Yl;function ol(m,s,d,g,x,b,S){let C=m.context,F=C.gl,O=m.transform,V=m.getOrCreateProgram("collisionBox"),X=[],ie=0,ae=0;for(let Ne=0;Ne<g.length;Ne++){let Je=g[Ne],Ke=s.getTile(Je),Fe=Ke.getBucket(d);if(!Fe)continue;let Be=Nu(Je,Fe,O),je=Be;x[0]===0&&x[1]===0||(je=m.translatePosMatrix(Be,Ke,x,b));let at=S?Fe.textCollisionBox:Fe.iconCollisionBox,xt=Fe.collisionCircleArray;if(xt.length>0){let qe=r.ad.create(),bt=je;r.ad.mul(qe,Fe.placementInvProjMatrix,O.glCoordMatrix),r.ad.mul(qe,qe,Fe.placementViewportMatrix),X.push({circleArray:xt,circleOffset:ae,transform:bt,invTransform:qe,projection:Fe.getProjection()}),ie+=xt.length/4,ae=ie}at&&(m.terrain&&m.terrain.setupElevationDraw(Ke,V),V.draw(m,F.LINES,r.ae.disabled,r.ag.disabled,m.colorModeForRenderPass(),r.af.disabled,iu(je,O,Ke,Fe.getProjection()),d.id,at.layoutVertexBuffer,at.indexBuffer,at.segments,null,O.zoom,null,[at.collisionVertexBuffer,at.collisionVertexBufferExt]))}if(!S||!X.length)return;let ue=m.getOrCreateProgram("collisionCircle"),de=new r.bL;de.resize(4*ie),de._trim();let fe=0;for(let Ne of X)for(let Je=0;Je<Ne.circleArray.length/4;Je++){let Ke=4*Je,Fe=Ne.circleArray[Ke+0],Be=Ne.circleArray[Ke+1],je=Ne.circleArray[Ke+2],at=Ne.circleArray[Ke+3];de.emplace(fe++,Fe,Be,je,at,0),de.emplace(fe++,Fe,Be,je,at,1),de.emplace(fe++,Fe,Be,je,at,2),de.emplace(fe++,Fe,Be,je,at,3)}(!Yl||Yl.length<2*ie)&&(Yl=function(Ne){let Je=2*Ne,Ke=new r.bu;Ke.resize(Je),Ke._trim();for(let Fe=0;Fe<Je;Fe++){let Be=6*Fe;Ke.uint16[Be+0]=4*Fe+0,Ke.uint16[Be+1]=4*Fe+1,Ke.uint16[Be+2]=4*Fe+2,Ke.uint16[Be+3]=4*Fe+2,Ke.uint16[Be+4]=4*Fe+3,Ke.uint16[Be+5]=4*Fe+0}return Ke}(ie));let me=C.createIndexBuffer(Yl,!0),Pe=C.createVertexBuffer(de,r.bM.members,!0);for(let Ne of X){let Je={u_matrix:Ne.transform,u_inv_matrix:Ne.invTransform,u_camera_to_center_distance:(Oe=O).getCameraToCenterDistance(Ne.projection),u_viewport_size:[Oe.width,Oe.height]};ue.draw(m,F.TRIANGLES,r.ae.disabled,r.ag.disabled,m.colorModeForRenderPass(),r.af.disabled,Je,d.id,Pe,me,r.b.simpleSegment(0,2*Ne.circleOffset,Ne.circleArray.length,Ne.circleArray.length/2),null,O.zoom)}var Oe;Pe.destroy(),me.destroy()}let Rl=r.ad.create();function Vs(m){let s=m._camera.getWorldToCamera(m.worldSize,1),d=r.ad.multiply([],s,m.globeMatrix);r.ad.invert(d,d);let g=[0,0,0],x=[0,1,0,0];return r.aA.transformMat4(x,x,d),g[0]=x[0],g[1]=x[1],g[2]=x[2],r._.normalize(g,g),g}function kc({width:m,height:s,anchor:d,textOffset:g,textScale:x},b){let{horizontalAlign:S,verticalAlign:C}=r.bQ(d),F=-(S-.5)*m,O=-(C-.5)*s,V=r.bP(d,g);return new r.P((F/x+V[0])*b,(O/x+V[1])*b)}function Qn(m,s,d,g,x,b,S,C,F,O,V){let X=m.text.placedSymbolArray,ie=m.text.dynamicLayoutVertexArray,ae=m.icon.dynamicLayoutVertexArray,ue={},de=m.getProjection(),fe=Dl(C,de,b),me=b.elevation,Pe=de.upVectorScale(C.canonical,b.center.lat,b.worldSize).metersToTile;ie.clear();for(let Oe=0;Oe<X.length;Oe++){let Ne=X.get(Oe),{tileAnchorX:Je,tileAnchorY:Ke,numGlyphs:Fe}=Ne,Be=Ne.hidden||!Ne.crossTileID||m.allowVerticalPlacement&&!Ne.placedOrientation?null:g[Ne.crossTileID];if(Be){let je=0,at=0,xt=0;if(me){let jt=me?me.getAtTileOffset(C,Je,Ke):0,[dr,pr,Cr]=de.upVector(C.canonical,Je,Ke);je=jt*dr*Pe,at=jt*pr*Pe,xt=jt*Cr*Pe}let[qe,bt,Ct,Gt]=lo(Ne.projectedAnchorX+je,Ne.projectedAnchorY+at,Ne.projectedAnchorZ+xt,d?fe:S),qt=Ma(b.getCameraToCenterDistance(de),Gt),Vt=x.evaluateSizeForFeature(m.textSizeData,O,Ne)*qt/r.bN;d&&(Vt*=m.tilePixelRatio/F);let ft=kc(Be,Vt);d?({x:qe,y:bt,z:Ct}=de.projectTilePoint(Je+ft.x,Ke+ft.y,C.canonical),[qe,bt,Ct]=lo(qe+je,bt+at,Ct+xt,S)):(s&&ft._rotate(-b.angle),qe+=ft.x,bt+=ft.y,Ct=0);let kt=m.allowVerticalPlacement&&Ne.placedOrientation===r.aE.vertical?Math.PI/2:0;for(let jt=0;jt<Fe;jt++)r.aH(ie,qe,bt,Ct,kt);V&&Ne.associatedIconIndex>=0&&(ue[Ne.associatedIconIndex]={x:qe,y:bt,z:Ct,angle:kt})}else Al(Fe,ie)}if(V){ae.clear();let Oe=m.icon.placedSymbolArray;for(let Ne=0;Ne<Oe.length;Ne++){let Je=Oe.get(Ne),{numGlyphs:Ke}=Je,Fe=ue[Ne];if(Je.hidden||!Fe)Al(Ke,ae);else{let{x:Be,y:je,z:at,angle:xt}=Fe;for(let qe=0;qe<Ke;qe++)r.aH(ae,Be,je,at,xt)}}m.icon.dynamicLayoutVertexBuffer.updateData(ae)}m.text.dynamicLayoutVertexBuffer.updateData(ie)}function Yn(m,s,d,g,x,b,S={}){let C=d.paint.get("icon-translate"),F=d.paint.get("text-translate"),O=d.paint.get("icon-translate-anchor"),V=d.paint.get("text-translate-anchor"),X=d.layout.get("icon-rotation-alignment"),ie=d.layout.get("text-rotation-alignment"),ae=d.layout.get("icon-pitch-alignment"),ue=d.layout.get("text-pitch-alignment"),de=d.layout.get("icon-keep-upright"),fe=d.layout.get("text-keep-upright"),me=d.paint.get("icon-color-saturation"),Pe=d.paint.get("icon-color-contrast"),Oe=d.paint.get("icon-color-brightness-min"),Ne=d.paint.get("icon-color-brightness-max"),Je=d.paint.get("icon-occlusion-opacity").constantOr(0),Ke=d.paint.get("text-occlusion-opacity").constantOr(0),Fe=m.context,Be=Fe.gl,je=m.transform,at=X==="map",xt=ie==="map",qe=ae==="map",bt=ue==="map",Ct=Je!==1,Gt=Ke!==1,qt=d.layout.get("symbol-sort-key").constantOr(1)!==void 0,Vt=!1,ft=m.depthModeForSublayer(0,r.ae.ReadOnly),kt=[r.aj(je.center.lng),r.ak(je.center.lat)],jt=d.layout.get("text-variable-anchor"),dr=je.projection.name==="globe",pr=[],Cr=[0,-1,0];for(let mr of g){let Yt=s.getTile(mr),Nt=Yt.getBucket(d);if(!Nt||Nt.projection.name==="mercator"&&dr||Nt.fullyClipped)continue;let Pr=Nt.projection.name==="globe",_i=Pr?r.a1(je.zoom):0,oi=Dl(mr,Nt.getProjection(),je),Di=je.calculatePixelsToTileUnitsMatrix(Yt),Xi=jt&&Nt.hasTextData(),_n=Nt.hasIconTextFit()&&Xi&&Nt.hasIconData(),ni=Nt.getProjection().createInversionMatrix(je,mr.canonical),cn=()=>{let Ht=at&&d.layout.get("symbol-placement")!=="point",_r=[];d.hasInitialOcclusionOpacityProperties&&Ct&&m.symbolParams.useOcclusionQueries&&!Pr&&!dr&&_r.push("OCCLUSION_QUERIES"),d.hasInitialOcclusionOpacityProperties||_r.push("SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH");let ua=Ht||_n,un=d.paint.get("icon-image-cross-fade").constantOr(0);m.terrainRenderModeElevated()&&qe&&_r.push("PITCH_WITH_MAP_TERRAIN"),Pr&&(_r.push("PROJECTION_GLOBE_VIEW"),ua&&_r.push("PROJECTED_POS_ON_VIEWPORT")),un>0&&_r.push("ICON_TRANSITION"),Nt.icon.zOffsetVertexBuffer&&_r.push("Z_OFFSET"),me===0&&Pe===0&&Oe===0&&Ne===1||_r.push("COLOR_ADJUSTMENT");let vt=Nt.icon.programConfigurations.get(d.id),Ll=m.getOrCreateProgram(Nt.sdfIcons?"symbolSDF":"symbolIcon",{config:vt,defines:_r}),Xo,Is=Yt.imageAtlasTexture?Yt.imageAtlasTexture.size:[0,0],Mo=Nt.iconSizeData,qs=r.aD(Mo,je.zoom),Bc=qe||je.pitch!==0,Ol=Wl(oi,Yt.tileID.canonical,qe,at,je,Nt.getProjection(),Di),Hh=bc(oi,Yt.tileID.canonical,qe,at,je,Nt.getProjection(),Di),Wh=m.translatePosMatrix(Hh,Yt,C,O,!0),Yu=m.translatePosMatrix(oi,Yt,C,O),pu=ua?Rl:Ol,Ku=at&&!qe&&!Ht,Df=Cr;!dr&&!je.mercatorFromTransition||at||(Df=Vs(je));let Rf=Pr?Df:Cr;if(Nt.sdfIcons&&!Nt.iconsInText)Xo=Il(Mo.kind,qs,Ku,qe,m,Yu,pu,Wh,!1,Is,!0,mr,_i,kt,ni,Rf,Nt.getProjection());else{let bo=d.getColorAdjustmentMatrix(me,Pe,Oe,Ne);Xo=Ho(Mo.kind,qs,Ku,qe,m,Yu,pu,Wh,!1,Is,mr,_i,kt,ni,Rf,Nt.getProjection(),bo,un)}let Bd=Yt.imageAtlasTexture?Yt.imageAtlasTexture:null,Ff=d.layout.get("icon-size").constantOr(0)!==1||Nt.iconsNeedLinear,Wm=Nt.sdfIcons||m.options.rotating||m.options.zooming||Ff||Bc?Be.LINEAR:Be.NEAREST,qm=Nt.sdfIcons&&d.paint.get("icon-halo-width").constantOr(1)!==0,Tg=m.terrain&&qe&&Ht?r.ad.invert(r.ad.create(),Ol):Rl;if(Ht&&Nt.icon){let bo=je.elevation,Sg=bo?bo.getAtTileOffsetFunc(mr,je.center.lat,je.worldSize,Nt.getProjection()):null,Pf=ql(oi,Yt.tileID.canonical,qe,at,je,Nt.getProjection(),Di);El(Nt,oi,m,!1,Pf,Hh,qe,de,Sg,mr)}return{program:Ll,buffers:Nt.icon,uniformValues:Xo,atlasTexture:Bd,atlasTextureIcon:null,atlasInterpolation:Wm,atlasInterpolationIcon:null,isSDF:Nt.sdfIcons,hasHalo:qm,tile:Yt,labelPlaneMatrixInv:Tg}},kn=()=>{let Ht=xt&&d.layout.get("symbol-placement")!=="point",_r=[],ua=Ht||jt||_n;d.hasInitialOcclusionOpacityProperties&&Gt&&m.symbolParams.useOcclusionQueries&&!Pr&&!dr&&_r.push("OCCLUSION_QUERIES"),d.hasInitialOcclusionOpacityProperties||_r.push("SYMBOL_OCCLUSION_BY_TERRAIN_DEPTH"),m.terrainRenderModeElevated()&&bt&&_r.push("PITCH_WITH_MAP_TERRAIN"),Pr&&(_r.push("PROJECTION_GLOBE_VIEW"),ua&&_r.push("PROJECTED_POS_ON_VIEWPORT")),Nt.text.zOffsetVertexBuffer&&_r.push("Z_OFFSET");let un=Nt.text.programConfigurations.get(d.id),vt=m.getOrCreateProgram(Nt.iconsInText?"symbolTextAndIcon":"symbolSDF",{config:un,defines:_r}),Ll,Xo=[0,0],Is=null,Mo=Nt.textSizeData;Nt.iconsInText&&(Xo=Yt.imageAtlasTexture?Yt.imageAtlasTexture.size:[0,0],Is=Yt.imageAtlasTexture?Yt.imageAtlasTexture:null,Ll=bt||je.pitch!==0||m.options.rotating||m.options.zooming||Mo.kind==="composite"||Mo.kind==="camera"?Be.LINEAR:Be.NEAREST);let qs=Yt.glyphAtlasTexture?Yt.glyphAtlasTexture.size:[0,0],Bc=r.aD(Mo,je.zoom),Ol=Wl(oi,Yt.tileID.canonical,bt,xt,je,Nt.getProjection(),Di),Hh=bc(oi,Yt.tileID.canonical,bt,xt,je,Nt.getProjection(),Di),Wh=m.translatePosMatrix(Hh,Yt,F,V,!0),Yu=m.translatePosMatrix(oi,Yt,F,V),pu=ua?Rl:Ol,Ku=xt&&!bt&&!Ht,Df=Cr;!dr&&!je.mercatorFromTransition||xt||(Df=Vs(je));let Rf=Pr?Df:Cr,Bd;Bd=Nt.iconsInText?kl(Mo.kind,Bc,Ku,bt,m,Yu,pu,Wh,qs,Xo,mr,_i,kt,ni,Rf,Nt.getProjection()):Il(Mo.kind,Bc,Ku,bt,m,Yu,pu,Wh,!0,qs,!0,mr,_i,kt,ni,Rf,Nt.getProjection());let Ff=Yt.glyphAtlasTexture?Yt.glyphAtlasTexture:null,Wm=Be.LINEAR,qm=d.paint.get("text-halo-width").constantOr(1)!==0,Tg=m.terrain&&bt&&Ht?r.ad.invert(r.ad.create(),Ol):Rl;if(Ht&&Nt.text){let bo=je.elevation,Sg=bo?bo.getAtTileOffsetFunc(mr,je.center.lat,je.worldSize,Nt.getProjection()):null,Pf=ql(oi,Yt.tileID.canonical,bt,xt,je,Nt.getProjection(),Di);El(Nt,oi,m,!0,Pf,Hh,bt,fe,Sg,mr)}return{program:vt,buffers:Nt.text,uniformValues:Bd,atlasTexture:Ff,atlasTextureIcon:Is,atlasInterpolation:Wm,atlasInterpolationIcon:Ll,isSDF:!0,hasHalo:qm,tile:Yt,labelPlaneMatrixInv:Tg}},mn=Nt.icon.segments.get().length,Ni=Nt.text.segments.get().length,li=mn&&!S.onlyText?cn():null,zn=Ni&&!S.onlyIcons?kn():null,$n=d.paint.get("icon-opacity").constantOr(1),bn=d.paint.get("text-opacity").constantOr(1);if(qt&&Nt.canOverlap){Vt=!0;let Ht=$n&&!S.onlyText?Nt.icon.segments.get():[],_r=bn&&!S.onlyIcons?Nt.text.segments.get():[];for(let ua of Ht)pr.push({segments:new r.b([ua]),sortKey:ua.sortKey,state:li});for(let ua of _r)pr.push({segments:new r.b([ua]),sortKey:ua.sortKey,state:zn})}else S.onlyText||pr.push({segments:$n?Nt.icon.segments:new r.b([]),sortKey:0,state:li}),S.onlyIcons||pr.push({segments:bn?Nt.text.segments:new r.b([]),sortKey:0,state:zn})}Vt&&pr.sort((mr,Yt)=>mr.sortKey-Yt.sortKey);for(let mr of pr){let Yt=mr.state;if(Yt)if(m.terrain&&m.terrain.setupElevationDraw(Yt.tile,Yt.program,{useDepthForOcclusion:!d.hasInitialOcclusionOpacityProperties&&je.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Yt.labelPlaneMatrixInv}),Fe.activeTexture.set(Be.TEXTURE0),Yt.atlasTexture&&Yt.atlasTexture.bind(Yt.atlasInterpolation,Be.CLAMP_TO_EDGE,!0),Yt.atlasTextureIcon&&(Fe.activeTexture.set(Be.TEXTURE1),Yt.atlasTextureIcon&&Yt.atlasTextureIcon.bind(Yt.atlasInterpolationIcon,Be.CLAMP_TO_EDGE,!0)),m.uploadCommonLightUniforms(m.context,Yt.program),Yt.hasHalo){let Nt=Yt.uniformValues;Nt.u_is_halo=1,ca(Yt.buffers,mr.segments,d,m,Yt.program,ft,x,b,Nt,2),Nt.u_is_halo=0}else{if(Yt.isSDF){let Nt=Yt.uniformValues;Yt.hasHalo&&(Nt.u_is_halo=1,ca(Yt.buffers,mr.segments,d,m,Yt.program,ft,x,b,Nt,1)),Nt.u_is_halo=0}ca(Yt.buffers,mr.segments,d,m,Yt.program,ft,x,b,Yt.uniformValues,1)}}}function ca(m,s,d,g,x,b,S,C,F,O){let V=g.context.gl,X=[m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.iconTransitioningVertexBuffer,m.globeExtVertexBuffer,m.zOffsetVertexBuffer];m.occlusionQueryOpacityVertexBuffer.length>0&&X.push(m.occlusionQueryOpacityVertexBuffer),x.draw(g,V.TRIANGLES,b,S,C,r.af.disabled,F,d.id,m.layoutVertexBuffer,m.indexBuffer,s,d.paint,g.transform.zoom,m.programConfigurations.get(d.id),X,O)}function Ka(m,s,d,g,x,b,S){let C=m.context.gl,F=d.paint.get("fill-pattern"),O=F&&F.constantOr(1),V,X,ie,ae,ue;S?(X=O&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",V=C.LINES):(X=O?"fillPattern":"fill",V=C.TRIANGLES);for(let de of g){let fe=s.getTile(de);if(O&&!fe.patternsLoaded())continue;let me=fe.getBucket(d);if(!me)continue;m.prepareDrawTile();let Pe=me.programConfigurations.get(d.id),Oe=m.isTileAffectedByFog(de),Ne=m.getOrCreateProgram(X,{config:Pe,overrideFog:Oe});O&&(m.context.activeTexture.set(C.TEXTURE0),fe.imageAtlasTexture&&fe.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),Pe.updatePaintBuffers());let Je=F.constantOr(null);if(Je&&fe.imageAtlas){let Be=fe.imageAtlas.patternPositions[Je.toString()];Be&&Pe.setConstantPatternPositions(Be)}let Ke=m.translatePosMatrix(de.projMatrix,fe,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor")),Fe=d.paint.get("fill-emissive-strength");if(S){ae=me.indexBuffer2,ue=me.segments2;let Be=m.terrain&&m.terrain.renderingToTexture?m.terrain.drapeBufferSize:[C.drawingBufferWidth,C.drawingBufferHeight];ie=X==="fillOutlinePattern"&&O?Ec(Ke,Fe,m,fe,Be):rs(Ke,Fe,Be)}else ae=me.indexBuffer,ue=me.segments,ie=O?ru(Ke,Fe,m,fe):Pu(Ke,Fe);m.uploadCommonUniforms(m.context,Ne,de.toUnwrapped()),Ne.draw(m,V,x,m.stencilModeForClipping(de),b,r.af.disabled,ie,d.id,me.layoutVertexBuffer,ae,ue,d.paint,m.transform.zoom,Pe,void 0)}}function bs(m,s,d,g,x,b,S,C){d.resetLayerRenderingStats(m);let F=m.context,O=F.gl,V=m.transform,X=d.paint.get("fill-extrusion-pattern"),ie=X.constantOr(1),ae=d.paint.get("fill-extrusion-opacity"),ue=m.style.enable3dLights(),de=d.paint.get(ue&&!ie?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),fe=[d.paint.get("fill-extrusion-ambient-occlusion-intensity"),de],me=d.layout.get("fill-extrusion-edge-radius"),Pe=me>0&&!d.paint.get("fill-extrusion-rounded-roof"),Oe=Pe?0:me,Ne=V.projection.name==="globe"?r.bY():0,Je=V.projection.name==="globe",Ke=Je?r.a1(V.zoom):0,Fe=[r.aj(V.center.lng),r.ak(V.center.lat)],Be=d.paint.get("fill-extrusion-flood-light-color").toRenderColor(d.lut).toArray01().slice(0,3),je=d.paint.get("fill-extrusion-flood-light-intensity"),at=d.paint.get("fill-extrusion-vertical-scale"),xt=il(m,d.paint.get("fill-extrusion-cutoff-fade-range")),qe=d.paint.get("fill-extrusion-emissive-strength"),bt=[],Ct;Je&&bt.push("PROJECTION_GLOBE_VIEW"),fe[0]>0&&bt.push("FAUX_AO"),Pe&&bt.push("ZERO_ROOF_RADIUS"),C&&bt.push("HAS_CENTROID"),je>0&&bt.push("FLOOD_LIGHT"),xt.shouldRenderCutoff&&bt.push("RENDER_CUTOFF");let Gt=m.renderPass==="shadow",qt=m.shadowRenderer,Vt=Gt&&!!qt;m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!0);let ft=[0,0,0];if(qt){let dr=m.style.directionalLight,pr=m.style.ambientLight;dr&&pr&&(ft=H(m.style,dr,pr)),Ct=bt.concat(["SHADOWS_SINGLE_CASCADE"])}let kt=Vt?"fillExtrusionDepth":ie?"fillExtrusionPattern":"fillExtrusion",jt=d.getLayerRenderingStats();for(let dr of g){let pr=s.getTile(dr),Cr=pr.getBucket(d);if(!Cr||Cr.projection.name!==V.projection.name)continue;let mr=!1;qt&&(mr=qt.getMaxCascadeForTile(dr.toUnwrapped())===0);let Yt=m.isTileAffectedByFog(dr),Nt=Cr.programConfigurations.get(d.id),Pr=m.getOrCreateProgram(kt,{config:Nt,defines:mr?Ct:bt,overrideFog:Yt});if(m.terrain&&m.terrain.setupElevationDraw(pr,Pr,{useMeterToDem:!0}),!Cr.centroidVertexBuffer){let ni=Pr.attributes.a_centroid_pos;ni!==void 0&&O.vertexAttrib2f(ni,0,0)}!Gt&&qt&&qt.setupShadows(pr.tileID.toUnwrapped(),Pr,"vector-tile",pr.tileID.overscaledZ),ie&&(m.context.activeTexture.set(O.TEXTURE0),pr.imageAtlasTexture&&pr.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),Nt.updatePaintBuffers());let _i=X.constantOr(null);if(_i&&pr.imageAtlas){let ni=pr.imageAtlas.patternPositions[_i.toString()];ni&&Nt.setConstantPatternPositions(ni)}let oi=d.paint.get("fill-extrusion-vertical-gradient"),Di;if(Gt&&qt){if(bf(pr.tileID,Cr,m))continue;let ni=qt.calculateShadowPassMatrixFromTile(pr.tileID.toUnwrapped());Di=Cl(ni,Oe,at)}else{let ni=m.translatePosMatrix(dr.expandedProjMatrix,pr,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),cn=V.projection.createInversionMatrix(V,dr.canonical);Di=ie?Fu(ni,m,oi,ae,fe,Oe,dr,pr,Ne,Ke,Fe,cn,Be,at):Xl(ni,m,oi,ae,fe,Oe,dr,Ne,Ke,Fe,cn,Be,at,je,ft,qe)}m.uploadCommonUniforms(F,Pr,dr.toUnwrapped(),null,xt);let Xi=Cr.segments;if(V.projection.name==="mercator"&&!Gt&&(Xi=Cr.getVisibleSegments(pr.tileID,m.terrain,m.transform.getFrustum(0)),!Xi.get().length))continue;if(jt)if(Gt)for(let ni of Xi.get())jt.numRenderedVerticesInShadowPass+=ni.primitiveLength;else for(let ni of Xi.get())jt.numRenderedVerticesInTransparentPass+=ni.primitiveLength;let _n=[];(m.terrain||C)&&_n.push(Cr.centroidVertexBuffer),Je&&_n.push(Cr.layoutVertexExtBuffer),Pr.draw(m,F.gl.TRIANGLES,x,b,S,r.af.backCCW,Di,d.id,Cr.layoutVertexBuffer,Cr.indexBuffer,Xi,d.paint,m.transform.zoom,Nt,_n)}m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!1)}function Ha(m,s,d,g,x,b,S,C,F,O,V,X,ie,ae,ue,de,fe,me,Pe){let Oe=m.context,Ne=Oe.gl,Je=m.transform,Ke=m.transform.zoom,Fe=[],Be=il(m,d.paint.get("fill-extrusion-cutoff-fade-range"));O==="clear"?(Fe.push("CLEAR_SUBPASS"),Pe&&(Fe.push("CLEAR_FROM_TEXTURE"),Oe.activeTexture.set(Ne.TEXTURE0),Pe.bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE))):O==="sdf"&&Fe.push("SDF_SUBPASS"),fe&&Fe.push("HAS_CENTROID"),Be.shouldRenderCutoff&&Fe.push("RENDER_CUTOFF");let je=d.layout.get("fill-extrusion-edge-radius"),at=(xt,qe,bt,Ct,Gt)=>{let qt=qe.programConfigurations.get(d.id),Vt=m.isTileAffectedByFog(xt),ft=m.getOrCreateProgram("fillExtrusionGroundEffect",{config:qt,defines:Fe,overrideFog:Vt}),kt=((dr,pr,Cr,mr,Yt,Nt,Pr,_i,oi,Di,Xi)=>({u_matrix:pr,u_opacity:Cr,u_ao_pass:mr?1:0,u_meter_to_tile:Yt,u_ao:Nt,u_flood_light_intensity:Pr,u_flood_light_color:_i,u_attenuation:oi,u_edge_radius:Di,u_fb:0,u_fb_size:Xi}))(0,Ct,V,F,Gt,[X,ie*Gt],ae,ue,de,Ke>=17?0:je*Gt,Pe?Pe.size[0]:0),jt=[];fe&&jt.push(qe.hiddenByLandmarkVertexBuffer),m.uploadCommonUniforms(Oe,ft,xt.toUnwrapped(),null,Be),ft.draw(m,Oe.gl.TRIANGLES,x,b,S,C,kt,d.id,qe.vertexBuffer,qe.indexBuffer,bt,d.paint,Ke,qt,jt)};for(let xt of g){let qe=s.getTile(xt),bt=qe.getBucket(d);if(!bt||bt.projection.name!==Je.projection.name||!bt.groundEffect||bt.groundEffect&&!bt.groundEffect.hasData())continue;let Ct=bt.groundEffect,Gt=1/bt.tileToMeter;{let qt=m.translatePosMatrix(xt.projMatrix,qe,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Vt=Ct.getDefaultSegment();at(xt,Ct,Vt,qt,Gt)}if(me)for(let qt=0;qt<4;qt++){let Vt=r.bZ[qt](xt),ft=s.getTile(Vt);if(!ft)continue;let kt=ft.getBucket(d);if(!kt||kt.projection.name!==Je.projection.name||!kt.groundEffect||kt.groundEffect&&!kt.groundEffect.hasData())continue;let jt=kt.groundEffect,dr,pr;qt===0?(dr=[-r.a3,0,0],pr=1):qt===1?(dr=[r.a3,0,0],pr=0):qt===2?(dr=[0,-r.a3,0],pr=3):(dr=[0,r.a3,0],pr=2);let Cr=jt.regionSegments[pr];if(!Cr)continue;let mr=new Float32Array(16);r.ad.translate(mr,xt.projMatrix,dr),at(xt,jt,Cr,m.translatePosMatrix(mr,qe,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Gt)}}}function Mc(m,s,d,g,x,b,S){g.centroidVertexArray.length===0&&g.createCentroidsBuffer();let C=b?b.findDEMTileFor(d):null;if(!(C&&C.dem||S))return;let F=me=>new r.P(Math.ceil((me+r.c0)*r.c1),0),O=me=>{let Pe=s.getSource().minzoom,Oe=Je=>{let Ke=s.getTileByID(Je);if(Ke&&Ke.hasData())return Ke.getBucket(x)},Ne=[0,-1,1];for(let Je of Ne){if(me.overscaledZ+Je<Pe)continue;let Ke=Oe(me.calculateScaledKey(me.overscaledZ+Je));if(Ke)return Ke}},V=[0,0,0],X=(me,Pe)=>(V[0]=Math.min(me.min.y,Pe.min.y),V[1]=Math.max(me.max.y,Pe.max.y),V[2]=r.a3-Pe.min.x>me.max.x?Pe.min.x-r.a3:me.max.x,V),ie=(me,Pe)=>(V[0]=Math.min(me.min.x,Pe.min.x),V[1]=Math.max(me.max.x,Pe.max.x),V[2]=r.a3-Pe.min.y>me.max.y?Pe.min.y-r.a3:me.max.y,V),ae=[(me,Pe)=>X(me,Pe),(me,Pe)=>X(Pe,me),(me,Pe)=>ie(me,Pe),(me,Pe)=>ie(Pe,me)],ue=(me,Pe,Oe,Ne,Je,Ke,Fe)=>{if(!b)return 0;let Be=[[Ke?Oe:me,Ke?me:Oe,0],[Ke?Oe:Pe,Ke?Pe:Oe,0]],je=Fe<0?r.a3+Fe:Fe,at=[Ke?je:(me+Pe)/2,Ke?(me+Pe)/2:je,0];return Oe===0&&Fe<0||Oe!==0&&Fe>0?b.getForTilePoints(Je,[at],!0,Ne):Be.push(at),b.getForTilePoints(d,Be,!0,C),Math.max(Be[0][2],Be[1][2],at[2])/b.exaggeration()};for(let me=0;me<4;me++){let Pe=g.borderFeatureIndices[me];if(Pe.length===0)continue;let Oe=r.bZ[me](d),Ne=O(Oe);if(!(Ne&&Ne instanceof r.b_)||g.borderDoneWithNeighborZ[me]===Ne.canonical.z)continue;Ne.centroidVertexArray.length===0&&Ne.createCentroidsBuffer();let Je=b?b.findDEMTileFor(Oe):null;if(!(Je&&Je.dem||S))continue;let Ke=(me<2?1:5)-me,Fe=Ne.borderDoneWithNeighborZ[Ke]!==g.canonical.z,Be=Ne.borderFeatureIndices[Ke],je=0;if(g.canonical.z!==Ne.canonical.z){for(let at of Pe)g.showCentroid(g.featuresOnBorder[at]);if(Fe)for(let at of Be)Ne.showCentroid(Ne.featuresOnBorder[at]);g.borderDoneWithNeighborZ[me]=Ne.canonical.z,Ne.borderDoneWithNeighborZ[Ke]=g.canonical.z}for(let at of Pe){let xt=g.featuresOnBorder[at],qe=g.centroidData[xt.centroidDataIndex],bt=xt.borders[me],Ct;for(;je<Be.length;){Ct=Ne.featuresOnBorder[Be[je]];let Gt=Ct.borders[Ke];if(Gt[1]>bt[0]+3||Gt[0]>bt[0]-3)break;Ne.showCentroid(Ct),je++}if(Ct&&je<Be.length){let Gt=je,qt=0;for(;!(Ct.borders[Ke][0]>bt[1]-3)&&(qt++,++je!==Be.length);)Ct=Ne.featuresOnBorder[Be[je]];if(Ct=Ne.featuresOnBorder[Be[Gt]],qt>1){let kt=Ct.borders[Ke];Math.abs(bt[0]-kt[0])<3&&Math.abs(bt[1]-kt[1])<3&&(qt=1,je=Gt+1)}else if(qt===0){g.showCentroid(xt);continue}let Vt=Ne.centroidData[Ct.centroidDataIndex];S&&qt===1&&(((de=qe).flags|(fe=Vt).flags)&r.b$?(de.flags|=r.b$,fe.flags|=r.b$):(de.flags&=~r.b$,fe.flags&=~r.b$));let ft=xt.intersectsCount()>1||Ct.intersectsCount()>1;if(qt>1)je=Gt,qe.centroidXY=Vt.centroidXY=new r.P(0,0);else if(Je&&Je.dem&&!ft){let kt=ae[me](qe,Vt),jt=me%2?r.a3-1:0,dr=ue(kt[0],Math.min(r.a3-1,kt[1]),jt,Je,Oe,me<2,kt[2]);qe.centroidXY=Vt.centroidXY=F(dr)}else ft?qe.centroidXY=Vt.centroidXY=new r.P(0,0):(qe.centroidXY=g.encodeBorderCentroid(xt),Vt.centroidXY=Ne.encodeBorderCentroid(Ct));g.writeCentroidToBuffer(qe),Ne.writeCentroidToBuffer(Vt)}else g.showCentroid(xt)}g.borderDoneWithNeighborZ[me]=Ne.canonical.z,Ne.borderDoneWithNeighborZ[Ke]=g.canonical.z}var de,fe;(g.needsCentroidUpdate||!g.centroidVertexBuffer&&g.centroidVertexArray.length!==0)&&g.uploadCentroid(m)}let Kl=[1,0,0],kp=[0,1,0],Td=[0,0,1];function bf(m,s,d){let g=d.transform,x=d.shadowRenderer;if(!x)return!0;let b=m.toUnwrapped(),S=g.tileSize*x._cascades[d.currentShadowCascade].scale,C=s.maxHeight;if(g.elevation){let de=g.elevation.getMinMaxForTile(m);de&&(C+=de.max)}let F=[...x.shadowDirection];F[2]=-F[2];let O=x.computeSimplifiedTileShadowVolume(b,C,S,F);if(!O)return!1;let V=[Kl,kp,Td,F,[F[0],0,F[2]],[0,F[1],F[2]]],X=g.projection.name==="globe",ie=g.scaleZoom(S),ae=r.aM.fromInvProjectionMatrix(g.invProjMatrix,g.worldSize,ie,!X),ue=x.getCurrentCascadeFrustum();return ae.intersectsPrecise(O.vertices,O.planes,V)===0||ue.intersectsPrecise(O.vertices,O.planes,V)===0}function Dh(m){return[m[0]*r.c2,m[1]*r.c2,m[2]*r.c2,0]}function Rh(m,s,d,g,x,b,S,C,F){let O=g.getSource(),V=d.globeSharedBuffers;if(!V)return;let X,ie,ae;if(s&&(X=g.getTile(s)),O instanceof r.bm?(ie=O.texture,ae=r.bh(0,0,d.transform)):X&&s&&(ie=X.texture,ae=r.bh(s.canonical.z,s.canonical.x,d.transform)),!ie||!ae)return;m||(ae=r.ad.scale(r.ad.create(),ae,[1,-1,1]));let ue=d.context,de=ue.gl,fe=x.paint.get("raster-resampling")==="nearest"?de.NEAREST:de.LINEAR,me=d.colorModeForDrapableLayerRenderPass(b),Pe=S.defines;Pe.push("GLOBE_POLES");let Oe=new r.ae(de.LEQUAL,r.ae.ReadWrite,d.depthRangeFor3D),Ne=Float32Array.from(d.transform.expandedFarZProjMatrix),Je=Float32Array.from(r.bf(r.bg(new r.aO(0,0,0))));d.terrain&&d.terrain.prepareDrawTile(),ue.activeTexture.set(de.TEXTURE0),ie.bind(fe,de.CLAMP_TO_EDGE),ue.activeTexture.set(de.TEXTURE1),ie.bind(fe,de.CLAMP_TO_EDGE),ie.useMipmap&&ue.extTextureFilterAnisotropic&&d.transform.pitch>20&&de.texParameterf(de.TEXTURE_2D,ue.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ue.extTextureFilterAnisotropicMax);let[Ke,Fe,Be,je]=s?V.getPoleBuffers(s.canonical.z,!1):V.getPoleBuffers(0,!0),at=x.paint.get("raster-elevation"),xt;m?(xt=Ke,d.renderDefaultNorthPole=at!==0):(xt=Fe,d.renderDefaultSouthPole=at!==0);let qe=Dh(S.mix),bt=((Gt,qt,Vt,ft,kt,jt,dr,pr,Cr,mr,Yt,Nt,Pr)=>nu(Gt,qt,Vt,new Float32Array(16),new Float32Array(9),[0,0],ft,[0,0],[0,0,0,0],1,{opacity:1,mix:0},jt,[0,0],pr,2,mr,Yt,Nt,1,0,Pr))(Ne,Je,ae,r.a1(d.transform.zoom),0,x,0,at,0,qe,S.offset,S.range,b),Ct=d.getOrCreateProgram("raster",{defines:Pe});d.uploadCommonUniforms(ue,Ct,null),Ct.draw(d,de.TRIANGLES,Oe,F,me,C,bt,x.id,xt,Be,je)}function qi(m){let s=m._nearZ,d=m.projection.farthestPixelDistance(m),g=d-s,x=.2*m.height,b=s+x;return[s,d,(b-x-s)/g,(b-s)/g]}function Mp(m,s,d,g){if(m)return s instanceof Fi&&m instanceof r.c3?s.getTextureDescriptor(m,d,!0):{texture:m.texture,mix:Dh(g.mix),offset:g.offset,buffer:0,tileSize:1}}function Xr(m,s,d){if(!m)return null;let g=s.getTextureDescriptor(m,d,!0);if(!g)return null;let{texture:x,mix:b,offset:S,tileSize:C,buffer:F,format:O}=g;if(!x||!O)return null;let V=!1;return O==="uint32"&&(V=!0,b[3]=0,b=xf(r.c4,b,[0,d.paint.get("raster-particle-max-speed")]),S=Lu(r.c4,S,[0,d.paint.get("raster-particle-max-speed")])),{texture:x,textureOffset:[F/(C+2*F),C/(C+2*F)],tileSize:C,scalarData:V,scale:b,offset:S,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[O]]}}function ws(m){let s=m._nearZ,d=m.projection.farthestPixelDistance(m),g=d-s,x=.2*m.height,b=s+x;return[s,d,(b-x-s)/g,(b-s)/g]}let ns=new r.C(1,0,0,1),Fh=new r.C(0,1,0,1),Gs=new r.C(0,0,1,1),wf=new r.C(1,0,1,1),Dc=new r.C(0,1,1,1);function Tr(m,s,d,g,x,b,S){let C=m.context,F=m.transform,O=C.gl,V=F.projection.name==="globe",X=V?["PROJECTION_GLOBE_VIEW"]:[],ie=r.ad.clone(d.projMatrix);if(V&&r.a1(F.zoom)>0){let qe=r.c5(d.canonical,F),bt=r.c6(qe);ie=r.ad.multiply(new Float32Array(16),F.globeMatrix,bt),r.ad.multiply(ie,F.projMatrix,ie)}let ae=r.ad.create();ae[12]+=2*x/(r.e.devicePixelRatio*F.width),ae[13]+=2*b/(r.e.devicePixelRatio*F.height),r.ad.multiply(ie,ae,ie);let ue=m.getOrCreateProgram("debug",{defines:X}),de=s.getTileByID(d.key);m.terrain&&m.terrain.setupElevationDraw(de,ue);let fe=r.ae.disabled,me=r.ag.disabled,Pe=m.colorModeForRenderPass(),Oe="$debug";C.activeTexture.set(O.TEXTURE0),m.emptyTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),V?de._makeGlobeTileDebugBuffers(m.context,F):de._makeDebugTileBoundsBuffers(m.context,F.projection);let Ne=de._tileDebugBuffer||m.debugBuffer,Je=de._tileDebugIndexBuffer||m.debugIndexBuffer,Ke=de._tileDebugSegments||m.debugSegments;if(ue.draw(m,O.LINE_STRIP,fe,me,Pe,r.af.disabled,Ac(ie,g),Oe,Ne,Je,Ke,null,null,null,[de._globeTileDebugBorderBuffer]),S){let qe=de.latestRawTileData,bt=Math.floor((qe&&qe.byteLength||0)/1024),Ct=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(Ct+=` => ${d.overscaledZ}`),Ct+=` ${de.state}`,Ct+=` ${bt}kb`,function(Gt,qt){Gt.initDebugOverlayCanvas();let Vt=Gt.debugOverlayCanvas,ft=Gt.context.gl,kt=Gt.debugOverlayCanvas.getContext("2d");kt.clearRect(0,0,Vt.width,Vt.height),kt.shadowColor="white",kt.shadowBlur=2,kt.lineWidth=1.5,kt.strokeStyle="white",kt.textBaseline="top",kt.font="bold 36px Open Sans, sans-serif",kt.fillText(qt,5,5),kt.strokeText(qt,5,5),Gt.debugOverlayTexture.update(Vt),Gt.debugOverlayTexture.bind(ft.LINEAR,ft.CLAMP_TO_EDGE)}(m,Ct)}let Fe=s.getTile(d).tileSize,Be=512/Math.min(Fe,512)*(d.overscaledZ/F.zoom)*.5,je=de._tileDebugTextBuffer||m.debugBuffer,at=de._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,xt=de._tileDebugTextSegments||m.debugSegments;ue.draw(m,O.TRIANGLES,fe,me,r.a.alphaBlended,r.af.disabled,Ac(ie,r.C.transparent,Be),Oe,je,at,xt,null,null,null,[de._globeTileDebugTextBuffer])}function Gi(m,s,d,g){Po(m,0,s+d/2,m.transform.width,d,g)}function $i(m,s,d,g){Po(m,s-d/2,0,d,m.transform.height,g)}function Po(m,s,d,g,x,b){let S=m.context,C=S.gl;C.enable(C.SCISSOR_TEST),C.scissor(s*r.e.devicePixelRatio,d*r.e.devicePixelRatio,g*r.e.devicePixelRatio,x*r.e.devicePixelRatio),S.clear({color:b}),C.disable(C.SCISSOR_TEST)}let ou=r.c7([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Oi}=ou;function Hs(m,s,d,g){m.emplaceBack(s,d,g)}class Ph{constructor(s){this.vertexArray=new r.c8,this.indices=new r.bu,Hs(this.vertexArray,-1,-1,1),Hs(this.vertexArray,1,-1,1),Hs(this.vertexArray,-1,1,1),Hs(this.vertexArray,1,1,1),Hs(this.vertexArray,-1,-1,-1),Hs(this.vertexArray,1,-1,-1),Hs(this.vertexArray,-1,1,-1),Hs(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=s.createVertexBuffer(this.vertexArray,Oi),this.indexBuffer=s.createIndexBuffer(this.indices),this.segment=r.b.simpleSegment(0,0,36,12)}}function Jl(m,s,d,g,x,b){let S=m.context.gl,C=s.paint.get("sky-atmosphere-color"),F=s.paint.get("sky-atmosphere-halo-color"),O=s.paint.get("sky-atmosphere-sun-intensity"),V=((X,ie,ae,ue,de)=>({u_matrix_3f:X,u_sun_direction:ie,u_sun_intensity:ae,u_color_tint_r:[ue.r,ue.g,ue.b,ue.a],u_color_tint_m:[de.r,de.g,de.b,de.a],u_luminance:5e-5}))(r.bC.fromMat4(r.bC.create(),g),x,O,C,F);S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,S.TEXTURE_CUBE_MAP_POSITIVE_X+b,s.skyboxTexture,0),d.draw(m,S.TRIANGLES,r.ae.disabled,r.ag.disabled,r.a.unblended,r.af.frontCW,V,"skyboxCapture",s.skyboxGeometry.vertexBuffer,s.skyboxGeometry.indexBuffer,s.skyboxGeometry.segment)}let as=r.c7([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Da{constructor(s){let d=new r.c9;d.emplaceBack(-1,1,1,0,0),d.emplaceBack(1,1,1,1,0),d.emplaceBack(1,-1,1,1,1),d.emplaceBack(-1,-1,1,0,1);let g=new r.bu;g.emplaceBack(0,1,2),g.emplaceBack(2,3,0),this.vertexBuffer=s.createVertexBuffer(d,as.members),this.indexBuffer=s.createIndexBuffer(g),this.segments=r.b.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}let vg=r.c7([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Sd{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Dp{constructor(s){this.colorModeAlphaBlendedWriteRGB=new r.a([r.ca,r.cb,r.ca,r.cb],r.C.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new r.a([r.ca,r.cc,r.ca,r.cc],r.C.transparent,[!1,!1,!1,!0]),this.params=new Sd,this.updateNeeded=!0,s.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),s.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(s){let d=s.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Da(d);let g=this.params.sizeRange,x=this.params.intensityRange,b=function(V){let X=r.cf(30),ie=[];for(let ae=0;ae<V;++ae){let ue=2*Math.PI*X(),de=Math.acos(1-2*X())-.5*Math.PI;ie.push(r._.fromValues(Math.cos(de)*Math.cos(ue),Math.cos(de)*Math.sin(ue),Math.sin(de)))}return ie}(this.params.starsCount),S=r.cf(300),C=new r.cd,F=new r.bu,O=0;for(let V=0;V<b.length;++V){let X=r._.scale([],b[V],200),ie=Math.max(0,1+.01*g*(1*S()-.5)),ae=Math.max(0,1+.01*x*(1*S()-.5));C.emplaceBack(X[0],X[1],X[2],-1,-1,ie,ae),C.emplaceBack(X[0],X[1],X[2],1,-1,ie,ae),C.emplaceBack(X[0],X[1],X[2],1,1,ie,ae),C.emplaceBack(X[0],X[1],X[2],-1,1,ie,ae),F.emplaceBack(O+0,O+1,O+2),F.emplaceBack(O+0,O+2,O+3),O+=4}this.starsVx=d.createVertexBuffer(C,vg.members),this.starsIdx=d.createIndexBuffer(F),this.starsSegments=r.b.simpleSegment(0,0,C.length,F.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(s,d){let g=s.context,x=g.gl,b=s.transform,S=new r.ae(x.LEQUAL,r.ae.ReadOnly,[0,1]),C=r.a1(b.zoom),F=s.style.getLut(d.scope),O=d.properties.get("color").toRenderColor(F).toArray01(),V=d.properties.get("high-color").toRenderColor(F).toArray01(),X=d.properties.get("space-color").toRenderColor(F).toArray01PremultipliedAlpha(),ie=5e-4,ae=r.ce(d.properties.get("horizon-blend"),0,1,ie,.25),ue=r.ba(s,g,b)&&ae===ie?b.worldSize/(2*Math.PI*1.025)-1:b.globeRadius,de=s.frameCounter/1e3%1,fe=r._.length(b.globeCenterInViewSpace),me=Math.sqrt(Math.pow(fe,2)-Math.pow(ue,2)),Pe=Math.acos(me/fe),Oe=Ne=>{let Je=b.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Ne&&Je.push("ALPHA_PASS");let Ke=s.getOrCreateProgram("globeAtmosphere",{defines:Je}),Fe=((je,at,xt,qe,bt,Ct,Gt,qt,Vt,ft,kt,jt)=>({u_frustum_tl:je,u_frustum_tr:at,u_frustum_br:xt,u_frustum_bl:qe,u_horizon:bt,u_transition:Ct,u_fadeout_range:Gt,u_color:qt,u_high_color:Vt,u_space_color:ft,u_temporal_offset:kt,u_horizon_angle:jt}))(b.frustumCorners.TL,b.frustumCorners.TR,b.frustumCorners.BR,b.frustumCorners.BL,b.frustumCorners.horizon,C,ae,O,V,X,de,Pe);s.uploadCommonUniforms(g,Ke);let Be=this.atmosphereBuffer;Be&&Ke.draw(s,x.TRIANGLES,S,r.ag.disabled,Ne?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,r.af.backCW,Fe,Ne?"atmosphere_glow_alpha":"atmosphere_glow",Be.vertexBuffer,Be.indexBuffer,Be.segments)};Oe(!1),Oe(!0)}drawStars(s,d){let g=r.at(d.properties.get("star-intensity"),0,1);if(g===0)return;let x=s.context,b=x.gl,S=s.transform,C=s.getOrCreateProgram("stars"),F=r.av.identity([]);r.av.rotateX(F,F,-S._pitch),r.av.rotateZ(F,F,-S.angle),r.av.rotateX(F,F,r.ab(S._center.lat)),r.av.rotateY(F,F,-r.ab(S._center.lng));let O=r.ad.fromQuat(new Float32Array(16),F),V=r.ad.multiply([],S.starsProjMatrix,O),X=r.bC.fromMat4([],O),ie=r.bC.invert([],X),ae=[0,1,0];r._.transformMat3(ae,ae,ie),r._.scale(ae,ae,this.params.sizeMultiplier);let ue=[1,0,0];r._.transformMat3(ue,ue,ie),r._.scale(ue,ue,this.params.sizeMultiplier);let de=(fe=ae,me=ue,Pe=g,{u_matrix:Float32Array.from(V),u_up:fe,u_right:me,u_intensity_multiplier:Pe});var fe,me,Pe;s.uploadCommonUniforms(x,C),this.starsVx&&this.starsIdx&&C.draw(s,b.TRIANGLES,r.ae.disabled,r.ag.disabled,this.colorModeAlphaBlendedWriteRGB,r.af.disabled,de,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Lh(m,s){let d=[...m],g=s.cameraWorldSizeForFog/s.worldSize,x=r.ad.identity([]);return r.ad.scale(x,x,[g,g,1]),r.ad.multiply(d,x,d),r.ad.multiply(d,s.worldToFogMatrix,d),d}function Bu(m,s,d,g,x){let b=d.material,S=g.context,{baseColorTexture:C,metallicRoughnessTexture:F}=b.pbrMetallicRoughness,{normalTexture:O,occlusionTexture:V,emissionTexture:X}=b;function ie(ae,ue,de){if(ae&&(m.push(ue),S.activeTexture.set(S.gl.TEXTURE0+de),ae.gfxTexture)){let{minFilter:fe,magFilter:me,wrapS:Pe,wrapT:Oe}=ae.sampler;ae.gfxTexture.bindExtraParam(fe,me,Pe,Oe)}}ie(C,"HAS_TEXTURE_u_baseColorTexture",co.BaseColor),ie(F,"HAS_TEXTURE_u_metallicRoughnessTexture",co.MetallicRoughness),ie(O,"HAS_TEXTURE_u_normalTexture",co.Normal),ie(V,"HAS_TEXTURE_u_occlusionTexture",co.Occlusion),ie(X,"HAS_TEXTURE_u_emissionTexture",co.Emission),x&&(x.texture||(x.texture=new r.ch(g.context,x.image,[x.image.height,x.image.height,x.image.height],S.gl.RGBA)),S.activeTexture.set(S.gl.TEXTURE0+co.LUT),x.texture&&x.texture.bind(S.gl.LINEAR,S.gl.CLAMP_TO_EDGE),m.push("APPLY_LUT_ON_GPU")),d.texcoordBuffer&&(m.push("HAS_ATTRIBUTE_a_uv_2f"),s.push(d.texcoordBuffer)),d.colorBuffer&&(m.push(d.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),s.push(d.colorBuffer)),d.normalBuffer&&(m.push("HAS_ATTRIBUTE_a_normal_3f"),s.push(d.normalBuffer)),d.pbrBuffer&&(m.push("HAS_ATTRIBUTE_a_pbr"),m.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),s.push(d.pbrBuffer)),b.alphaMode!=="OPAQUE"&&b.alphaMode!=="MASK"||m.push("UNPREMULT_TEXTURE_IN_SHADER"),b.defined||m.push("DIFFUSE_SHADED"),m.push("USE_STANDARD_DERIVATIVES")}function Rc(m,s,d,g,x,b){let S=d.paint.get("model-opacity"),C=s.context,F=new r.ae(s.context.gl.LEQUAL,r.ae.ReadWrite,s.depthRangeFor3D),O=s.transform,V=m.mesh,X=V.material,ie=X.pbrMetallicRoughness,ae=s.style.fog,ue;ue=s.transform.projection.zAxisUnit==="pixels"?[...m.nodeModelMatrix]:r.ad.multiply([],g.zScaleMatrix,m.nodeModelMatrix),r.ad.multiply(ue,g.negCameraPosMatrix,ue);let de=r.ad.invert([],ue);r.ad.transpose(de,de);let fe=d.paint.get("model-emissive-strength").constantOr(0),me=Zl(new Float32Array(m.worldViewProjection),new Float32Array(ue),new Float32Array(de),null,s,S,ie.baseColorFactor.toRenderColor(null),X.emissiveFactor,ie.metallicFactor,ie.roughnessFactor,X,fe,d),Pe={defines:[]},Oe=[];Bu(Pe.defines,Oe,V,s,d.lut);let Ne=s.shadowRenderer;Ne&&(Ne.useNormalOffset=!1);let Je=null;if(ae){let Be=Lh(m.nodeModelMatrix,s.transform);if(Je=new Float32Array(Be),O.projection.name!=="globe"){let je=V.aabb.min,at=V.aabb.max,[xt,qe]=ae.getOpacityForBounds(Be,je[0],je[1],at[0],at[1]);Pe.overrideFog=xt>=ln||qe>=ln}}let Ke=il(s,d.paint.get("model-cutoff-fade-range"));Ke.shouldRenderCutoff&&Pe.defines.push("RENDER_CUTOFF");let Fe=s.getOrCreateProgram("model",Pe);s.uploadCommonUniforms(C,Fe,null,Je,Ke),s.renderPass!=="shadow"&&Ne&&Ne.setupShadowsFromMatrix(m.nodeModelMatrix,Fe),Fe.draw(s,C.gl.TRIANGLES,F,x,b,V.material.doubleSided?r.af.disabled:r.af.backCCW,me,d.id,V.vertexBuffer,V.indexBuffer,V.segments,d.paint,s.transform.zoom,void 0,Oe)}function Ja(m,s,d,g,x,b,S){let C;C=m.projection.name==="globe"?r.ci(d,m):[...d],r.ad.multiply(C,C,s.matrix);let F=r.ad.multiply([],g,C);if(s.meshes)for(let O of s.meshes){if(O.material.alphaMode!=="BLEND"){S.push({mesh:O,depth:0,modelIndex:x,worldViewProjection:F,nodeModelMatrix:C});continue}let V=r._.transformMat4([],O.centroid,F);V[2]>0&&b.push({mesh:O,depth:V[2],modelIndex:x,worldViewProjection:F,nodeModelMatrix:C})}if(s.children)for(let O of s.children)Ja(m,O,d,g,x,b,S)}function os(m,s,d,g){let x=d.shadowRenderer;if(!x)return;let b=x.getShadowPassDepthMode(),S=x.getShadowPassColorMode(),C=x.calculateShadowPassMatrixFromMatrix(s),F=Mh(C);d.getOrCreateProgram("modelDepth",{defines:d._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(d,d.context.gl.TRIANGLES,b,r.ag.disabled,S,r.af.backCCW,F,g.id,m.vertexBuffer,m.indexBuffer,m.segments,g.paint,d.transform.zoom,void 0,void 0)}function Nm(m,s,d){let g=s.updateZoomBasedPaintProperties(),x=function(b,S,C){let F,O,V,X=b.terrain?b.terrain.exaggeration():0;if(b.terrain&&X>0){let ie=b.terrain,ae=ie.findDEMTileFor(C);ae&&ae.dem?F=r.ck.create(ie,C,ae):X=0}if(X===0&&(S.terrainElevationMin=0,S.terrainElevationMax=0),X===S.validForExaggeration&&(X===0||F&&F._demTile&&F._demTile.tileID===S.validForDEMTile.id&&F._dem._timestamp===S.validForDEMTile.timestamp))return!1;for(let ie in S.instancesPerModel){let ae=S.instancesPerModel[ie];for(let ue=0;ue<ae.instancedDataArray.length;++ue){let de=(F?X*F.getElevationAt(0|ae.instancedDataArray.float32[16*ue],0|ae.instancedDataArray.float32[16*ue+1],!0,!0):0)+ae.instancesEvaluatedElevation[ue];ae.instancedDataArray.float32[16*ue+6]=de,O=O?Math.min(S.terrainElevationMin,de):de,V=V?Math.max(S.terrainElevationMax,de):de}}return S.terrainElevationMin=O||0,S.terrainElevationMax=V||0,S.validForExaggeration=X,S.validForDEMTile=F&&F._demTile?{id:F._demTile.tileID,timestamp:F._dem._timestamp}:{id:void 0,timestamp:0},!0}(m,s,d);(g||x)&&(s.uploaded=!1,s.upload(m.context))}let Wo={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new r.b6([0,0,0],[r.a3,r.a3,0])};function Wa(m,s){let d=1<<m.canonical.z,g=s.getFreeCameraOptions().position,x=s.elevation,b=m.canonical.x/d,S=(m.canonical.x+1)/d,C=m.canonical.y/d,F=(m.canonical.y+1)/d,O=s._centerAltitude;if(x){let ae=x.getMinMaxForTile(m);ae&&ae.max>O&&(O=ae.max)}let V=r.at(g.x,b,S)-g.x,X=r.at(g.y,C,F)-g.y,ie=r.ax(O,s.center.lat)-g.z;return s._zoomFromMercatorZ(Math.sqrt(V*V+X*X+ie*ie))}function sl(m,s,d,g,x,b,S){let C=m.context,F=m.renderPass==="shadow",O=m.shadowRenderer,V=F&&O?O.getShadowPassDepthMode():new r.ae(C.gl.LEQUAL,r.ae.ReadWrite,m.depthRangeFor3D),X=m.isTileAffectedByFog(b);if(d.meshes)for(let ie of d.meshes){let ae=["MODEL_POSITION_ON_GPU"],ue=[],de,fe,me;g.instancedDataArray.length>20&&ae.push("INSTANCED_ARRAYS");let Pe=il(m,s.paint.get("model-cutoff-fade-range"));if(Pe.shouldRenderCutoff&&ae.push("RENDER_CUTOFF"),F&&O)de=m.getOrCreateProgram("modelDepth",{defines:ae}),fe=Mh(S.shadowTileMatrix,S.shadowTileMatrix,Float32Array.from(d.matrix)),me=O.getShadowPassColorMode();else{Bu(ae,ue,ie,m,s.lut),de=m.getOrCreateProgram("model",{defines:ae,overrideFog:X});let Ne=ie.material,Je=Ne.pbrMetallicRoughness,Ke=s.paint.get("model-opacity"),Fe=s.paint.get("model-emissive-strength").constantOr(0);fe=Zl(b.expandedProjMatrix,Float32Array.from(d.matrix),new Float32Array(16),null,m,Ke,Je.baseColorFactor.toRenderColor(null),Ne.emissiveFactor,Je.metallicFactor,Je.roughnessFactor,Ne,Fe,s,x),O&&(S.shadowUniformsInitialized?de.setShadowUniformValues(C,O.getShadowUniformValues()):(O.setupShadows(b.toUnwrapped(),de,"model-tile",b.overscaledZ),S.shadowUniformsInitialized=!0)),me=Pe.shouldRenderCutoff||Ke<1||Ne.alphaMode!=="OPAQUE"?r.a.alphaBlended:r.a.unblended}m.uploadCommonUniforms(C,de,b.toUnwrapped(),null,Pe);let Oe=ie.material.doubleSided?r.af.disabled:r.af.backCCW;if(g.instancedDataArray.length>20)ue.push(g.instancedDataBuffer),de.draw(m,C.gl.TRIANGLES,V,r.ag.disabled,me,Oe,fe,s.id,ie.vertexBuffer,ie.indexBuffer,ie.segments,s.paint,m.transform.zoom,void 0,ue,g.instancedDataArray.length);else{let Ne=F?"u_instance":"u_normal_matrix";for(let Je=0;Je<g.instancedDataArray.length;++Je)fe[Ne]=new Float32Array(g.instancedDataArray.arrayBuffer,64*Je,16),de.draw(m,C.gl.TRIANGLES,V,r.ag.disabled,me,Oe,fe,s.id,ie.vertexBuffer,ie.indexBuffer,ie.segments,s.paint,m.transform.zoom,void 0,ue)}}if(d.children)for(let ie of d.children)sl(m,s,ie,g,x,b,S)}let Fc=[1,-1,1];function fo(m,s,d,g){if(!d.modelManager)return!0;let x=d.modelManager;if(!d.shadowRenderer)return!0;let b=d.shadowRenderer,S=s.aabb,C=!0,F=m.maxHeight;if(F===0){let V=0;for(let X in m.instancesPerModel){let ie=x.getModel(X,g);ie?V=Math.max(V,Math.max(Math.max(ie.aabb.max[0],ie.aabb.max[1]),ie.aabb.max[2])):C=!1}F=m.maxScale*V*1.41+m.maxVerticalOffset,C&&(m.maxHeight=F)}S.max[2]=F,S.min[2]+=m.terrainElevationMin,S.max[2]+=m.terrainElevationMax,r._.transformMat4(S.min,S.min,s.tileMatrix),r._.transformMat4(S.max,S.max,s.tileMatrix);let O=S.intersects(b.getCurrentCascadeFrustum());return d.currentShadowCascade===0&&(m.isInsideFirstShadowMapFrustum=O===2),O===0}function Ql(m,s){let d=m.uniformValues.u_cutoff_params[0],g=m.uniformValues.u_cutoff_params[1],x=m.uniformValues.u_cutoff_params[2],b=m.uniformValues.u_cutoff_params[3];return g===d||b===x?1:r.at(((s-d)/(g-d)-x)/(b-x),0,1)}function Qa(m,s,d,g){if(s.pitch<20)return 1;let x=s.getWorldToCameraMatrix(),b=r.ad.multiply([],x,m),S=[...d.min,1],C=r.aA.transformMat4([],S,b),F=C,O=C;S[1]=d.max[1],C=r.aA.transformMat4([],S,b),F=C[1]<F[1]?C:F,O=C[1]>O[1]?C:O,S[0]=d.max[0],C=r.aA.transformMat4([],S,b),F=C[1]<F[1]?C:F,O=C[1]>O[1]?C:O,S[1]=d.min[1],C=r.aA.transformMat4([],S,b),F=C[1]<F[1]?C:F,O=C[1]>O[1]?C:O;let V=r.at(g[0],0,1),X=100*s.pixelsPerMeter*r.at(g[1],0,1),ie=r.at(g[2],0,1),ae=r._.lerp([],F,O,V),ue=Math.tan(.5*s.fovX),de=-ae[2]*ue;if(X===0)return ae[1]<-Math.abs(de)?ie:1;let fe=(-Math.abs(de)-ae[1])/X,me=(Oe,Ne,Je)=>(1-Je)*Oe+Je*Ne,Pe=r.at(me(1,ie,fe),ie,1);return me(1,Pe,r.at((s.pitch-20)/20,0,1))}class Ws{}class Ed{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(s,d,g){{let X=this._storage.get(d.id);if(X)return X.lastUsedFrameIdx=s,X.buf}let x=g.gl,b=x.getBufferParameter(x.ELEMENT_ARRAY_BUFFER,x.BUFFER_SIZE),S=new ArrayBuffer(b),C=new Int16Array(S);x.getBufferSubData(x.ELEMENT_ARRAY_BUFFER,0,new Int16Array(S));let F=new r.cm;for(let X=0;X<b/2;X+=3){let ie=C[X],ae=C[X+1],ue=C[X+2];F.emplaceBack(ie,ae),F.emplaceBack(ae,ue),F.emplaceBack(ue,ie)}let O=g.bindVertexArrayOES.current,V=new Ws;return V.buf=new r.I(g,F),V.lastUsedFrameIdx=s,this._storage.set(d.id,V),g.bindVertexArrayOES.set(O),V.buf}update(s){for(let[d,g]of this._storage)s-g.lastUsedFrameIdx>30&&(g.buf.destroy(),this._storage.delete(d))}destroy(){for(let[s,d]of this._storage)d.buf.destroy(),this._storage.delete(s)}}let su=r.c7([{type:"Float32",name:"a_offset_xy",components:2}]);class lu{constructor(s){let d=new r.cn,g=new r.bu;d.emplaceBack(-1,-1),d.emplaceBack(1,-1),d.emplaceBack(1,1),d.emplaceBack(-1,1),g.emplaceBack(0,1,2),g.emplaceBack(0,2,3),this.segments=r.b.simpleSegment(0,0,d.length,g.length),this.vx=s.createVertexBuffer(d,su.members),this.idx=s.createIndexBuffer(g)}destroy(){this.vx.destroy(),this.idx.destroy()}}let qa={symbol:function(m,s,d,g,x){if(m.renderPass!=="translucent")return;let b=r.ag.disabled,S=m.colorModeForRenderPass();d.layout.get("text-variable-anchor")&&function(O,V,X,ie,ae,ue,de){let fe=V.transform,me=ae==="map",Pe=ue==="map";for(let Oe of O){let Ne=ie.getTile(Oe),Je=Ne.getBucket(X);if(!Je||!Je.text||!Je.text.segments.get().length)continue;let Ke=r.aD(Je.textSizeData,fe.zoom),Fe=Dl(Oe,Je.getProjection(),fe),Be=fe.calculatePixelsToTileUnitsMatrix(Ne),je=Wl(Fe,Ne.tileID.canonical,Pe,me,fe,Je.getProjection(),Be),at=Je.hasIconTextFit()&&Je.hasIconData();if(Ke){let xt=Math.pow(2,fe.zoom-Ne.tileID.overscaledZ);Qn(Je,me,Pe,de,r.bO,fe,je,Oe,xt,Ke,at)}}}(g,m,d,s,d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),x);let C=d.paint.get("icon-opacity").constantOr(1)!==0,F=d.paint.get("text-opacity").constantOr(1)!==0;d.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(C||F)?Yn(m,s,d,g,b,S):(C&&Yn(m,s,d,g,b,S,{onlyIcons:!0}),F&&Yn(m,s,d,g,b,S,{onlyText:!0}),function(O,V,X,ie){if(!O.symbolParams.useOcclusionQueries)return;let ae=O.context.gl,ue=O.transform,de=X.paint,fe=de.get("icon-occlusion-opacity").constantOr(0),me=de.get("text-occlusion-opacity").constantOr(0);if(!X.hasInitialOcclusionOpacityProperties||fe===1&&me===1)return;let Pe=ue.projection.name==="globe";for(let Oe of ie){let Ne=V.getTile(Oe),Je=Ne.getBucket(X);if(!Je||Je.projection.name==="mercator"&&Pe||Je.fullyClipped)continue;if(Je.projection.name==="globe"){r.w(`Occlusion not supported for globe mode. Layer: ${X.type}`);continue}let Ke=Dl(Oe,Je.getProjection(),ue),Fe=r.ad.fromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,O.symbolParams.depthOffset,1),Be=r.ad.multiply([],Fe,Ke),je=O.symbolParams.visualizeOcclusions!=="none"?1:O.symbolParams.occlusionQueryFrameWindow;for(let at=0;at<Je.symbolInstances.length;at++){let xt=Je.symbolInstances.get(at),qe=O.style.placement.opacities[xt.crossTileID];if(qe&&qe.isHidden()||(O.frameCounter+at)%je!=0)continue;let bt=xt.tileAnchorX,Ct=xt.tileAnchorY,Gt=xt.zOffset,qt;if(O.symbolParams.visualizeOcclusions==="none"){let dr=Je.queries.get(at);if(dr){if(!dr.isFree()){if(!dr.isResultAvailable())continue;let pr=dr.consumeResult();xt.occlusionState=pr===0?0:1;continue}qt=dr}else qt=new xi(O.context),Je.queries.set(at,qt)}let Vt=O.getOrCreateProgram("occlusion"),ft=O.symbolParams.occluderSize,kt=Ic(Be,[bt,Ct,Gt],[ue.width,ue.height],[ft,ft],O.symbolParams.visualizeOcclusions==="zPass"?[1,0,0,.8]:[1,.4,.2,.9]);O.terrain&&O.terrain.setupElevationDraw(Ne,Vt,{useDepthForOcclusion:!1,labelPlaneMatrixInv:void 0}),O.symbolParams.visualizeOcclusions==="none"&&qt&&qt.begin();let jt=new r.ae(O.symbolParams.visualizeOcclusions==="zPass"?O.context.gl.ALWAYS:O.context.gl.LEQUAL,r.ae.ReadOnly,O.depthRangeFor3D);Vt.draw(O,ae.TRIANGLES,jt,r.ag.disabled,O.symbolParams.visualizeOcclusions!=="none"?r.a.alphaBlendedNonPremultiplied:r.a.disabled,r.af.disabled,kt,"occlusion",O.occlusionBuffers.vx,O.occlusionBuffers.idx,O.occlusionBuffers.segments),O.symbolParams.visualizeOcclusions==="none"&&qt&&qt.end()}}}(m,s,d,g)),s.map.showCollisionBoxes&&(ol(m,s,d,g,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),!0),ol(m,s,d,g,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),!1))},circle:function(m,s,d,g){if(m.renderPass!=="translucent")return;let x=d.paint.get("circle-opacity"),b=d.paint.get("circle-stroke-width"),S=d.paint.get("circle-stroke-opacity"),C=d.layout.get("circle-sort-key").constantOr(1)!==void 0,F=d.paint.get("circle-emissive-strength");if(x.constantOr(1)===0&&(b.constantOr(1)===0||S.constantOr(1)===0))return;let O=m.context,V=O.gl,X=m.transform,ie=m.depthModeForSublayer(0,r.ae.ReadOnly),ae=r.ag.disabled,ue=m.colorModeForDrapableLayerRenderPass(F),de=X.projection.name==="globe",fe=[r.aj(X.center.lng),r.ak(X.center.lat)],me=[];for(let Oe=0;Oe<g.length;Oe++){let Ne=g[Oe],Je=s.getTile(Ne),Ke=Je.getBucket(d);if(!Ke||Ke.projection.name!==X.projection.name)continue;let Fe=Ke.programConfigurations.get(d.id),Be=r.bR(d),je=m.isTileAffectedByFog(Ne);de&&Be.push("PROJECTION_GLOBE_VIEW");let at=m.getOrCreateProgram("circle",{config:Fe,defines:Be,overrideFog:je}),xt=Ke.layoutVertexBuffer,qe=Ke.globeExtVertexBuffer,bt=Ke.indexBuffer,Ct=X.projection.createInversionMatrix(X,Ne.canonical),Gt={programConfiguration:Fe,program:at,layoutVertexBuffer:xt,globeExtVertexBuffer:qe,indexBuffer:bt,uniformValues:r.bS(m,Ne,Je,Ct,fe,d),tile:Je};if(C){let qt=Ke.segments.get();for(let Vt of qt)me.push({segments:new r.b([Vt]),sortKey:Vt.sortKey,state:Gt})}else me.push({segments:Ke.segments,sortKey:0,state:Gt})}C&&me.sort((Oe,Ne)=>Oe.sortKey-Ne.sortKey);let Pe={useDepthForOcclusion:X.depthOcclusionForSymbolsAndCircles};for(let Oe of me){let{programConfiguration:Ne,program:Je,layoutVertexBuffer:Ke,globeExtVertexBuffer:Fe,indexBuffer:Be,uniformValues:je,tile:at}=Oe.state,xt=Oe.segments;m.terrain&&m.terrain.setupElevationDraw(at,Je,Pe),m.uploadCommonUniforms(O,Je,at.tileID.toUnwrapped()),Je.draw(m,V.TRIANGLES,ie,ae,ue,r.af.disabled,je,d.id,Ke,Be,xt,d.paint,X.zoom,Ne,[Fe])}},heatmap:function(m,s,d,g){if(d.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){let x=m.context,b=x.gl,S=r.ag.disabled,C=new r.a([b.ONE,b.ONE,b.ONE,b.ONE],r.C.transparent,[!0,!0,!0,!0]);(function(ae,ue,de,fe){let me=ae.gl,Pe=ue.width*fe,Oe=ue.height*fe;ae.activeTexture.set(me.TEXTURE1),ae.viewport.set([0,0,Pe,Oe]);let Ne=de.heatmapFbo;if(!Ne||Ne&&(Ne.width!==Pe||Ne.height!==Oe)){Ne&&Ne.destroy();let Je=me.createTexture();me.bindTexture(me.TEXTURE_2D,Je),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_WRAP_S,me.CLAMP_TO_EDGE),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_WRAP_T,me.CLAMP_TO_EDGE),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_MIN_FILTER,me.LINEAR),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_MAG_FILTER,me.LINEAR),Ne=de.heatmapFbo=ae.createFramebuffer(Pe,Oe,!0,null),function(Ke,Fe,Be,je,at,xt){let qe=Ke.gl;qe.texImage2D(qe.TEXTURE_2D,0,Ke.extRenderToTextureHalfFloat?qe.RGBA16F:qe.RGBA,at,xt,0,qe.RGBA,Ke.extRenderToTextureHalfFloat?qe.HALF_FLOAT:qe.UNSIGNED_BYTE,null),je.colorAttachment.set(Be)}(ae,0,Je,Ne,Pe,Oe)}else me.bindTexture(me.TEXTURE_2D,Ne.colorAttachment.get()),ae.bindFramebuffer.set(Ne.framebuffer)})(x,m,d,m.transform.projection.name==="globe"?.5:.25),x.clear({color:r.C.transparent});let F=m.transform,O=F.projection.name==="globe",V=O?["PROJECTION_GLOBE_VIEW"]:[],X=O?r.af.frontCCW:r.af.disabled,ie=[r.aj(F.center.lng),r.ak(F.center.lat)];for(let ae=0;ae<g.length;ae++){let ue=g[ae];if(s.hasRenderableParent(ue))continue;let de=s.getTile(ue),fe=de.getBucket(d);if(!fe||fe.projection.name!==F.projection.name)continue;let me=m.isTileAffectedByFog(ue),Pe=fe.programConfigurations.get(d.id),Oe=m.getOrCreateProgram("heatmap",{config:Pe,defines:V,overrideFog:me}),{zoom:Ne}=m.transform;m.terrain&&m.terrain.setupElevationDraw(de,Oe),m.uploadCommonUniforms(x,Oe,ue.toUnwrapped());let Je=F.projection.createInversionMatrix(F,ue.canonical);Oe.draw(m,b.TRIANGLES,r.ae.disabled,S,C,X,ho(m,ue,de,Je,ie,Ne,d.paint.get("heatmap-intensity")),d.id,fe.layoutVertexBuffer,fe.indexBuffer,fe.segments,d.paint,m.transform.zoom,Pe,O?[fe.globeExtVertexBuffer]:null)}x.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),function(x,b){let S=x.context,C=S.gl,F=b.heatmapFbo;if(!F)return;S.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,F.colorAttachment.get()),S.activeTexture.set(C.TEXTURE1);let O=b.colorRampTexture;O||(O=b.colorRampTexture=new r.T(S,b.colorRamp,C.RGBA)),O.bind(C.LINEAR,C.CLAMP_TO_EDGE),x.getOrCreateProgram("heatmapTexture").draw(x,C.TRIANGLES,r.ae.disabled,r.ag.disabled,x.colorModeForRenderPass(),r.af.disabled,((V,X,ie,ae)=>({u_image:0,u_color_ramp:1,u_opacity:X.paint.get("heatmap-opacity")}))(0,b),b.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,b.paint,x.transform.zoom)}(m,d))},line:function(m,s,d,g){if(m.renderPass!=="translucent")return;let x=d.paint.get("line-opacity"),b=d.paint.get("line-width");if(x.constantOr(1)===0||b.constantOr(1)===0)return;let S=d.paint.get("line-emissive-strength"),C=d.paint.get("line-occlusion-opacity"),F=m.context,O=F.gl,V=d.layout.get("line-z-offset"),X=!V.isConstant()||!!V.constantOr(0),ie=X?new r.ae(m.depthOcclusion?O.GREATER:O.LEQUAL,r.ae.ReadOnly,m.depthRangeFor3D):m.depthModeForSublayer(0,r.ae.ReadOnly),ae=m.colorModeForDrapableLayerRenderPass(S),ue=m.terrain&&m.terrain.renderingToTexture,de=ue?1:r.e.devicePixelRatio,fe=d.paint.get("line-dasharray"),me=fe.constantOr(1),Pe=d.layout.get("line-cap"),Oe=fe.constantOr(null),Ne=Pe.constantOr(null),Je=d.paint.get("line-pattern"),Ke=Je.constantOr(1),Fe=Je.constantOr(null),Be=d.paint.get("line-opacity").constantOr(1),je=!Ke&&Be!==1||m.depthOcclusion&&C>0&&C<1,at=d.paint.get("line-gradient"),xt=Ke?"linePattern":"line",qe=r.bT(d),bt;if(ue&&m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(je=!1),C!==0&&m.depthOcclusion){let Gt=d.paint._values["line-opacity"];Gt&&Gt.value&&Gt.value.kind==="constant"?bt=Gt.value:r.w(`Occlusion opacity for layer ${d.id} is supported only when line-opacity isn't data-driven.`)}if(X&&(m.forceTerrainMode=!0),!X&&C!==0&&m.terrain&&!ue)return void r.w(`Occlusion opacity for layer ${d.id} is supported on terrain only if the layer has non-zero line-z-offset.`);let Ct=je&&X?m.stencilModeFor3D():r.ag.disabled;for(let Gt of g){let qt=s.getTile(Gt);if(Ke&&!qt.patternsLoaded())continue;let Vt=qt.getBucket(d);if(!Vt)continue;m.prepareDrawTile();let ft=Vt.programConfigurations.get(d.id),kt=m.isTileAffectedByFog(Gt),jt=m.getOrCreateProgram(xt,{config:ft,defines:X?[...qe,"ELEVATED"]:qe,overrideFog:kt});if(Fe&&qt.imageAtlas){let Nt=qt.imageAtlas.patternPositions[Fe.toString()];Nt&&ft.setConstantPatternPositions(Nt)}if(!Ke&&Oe&&Ne&&qt.lineAtlas){let Nt=qt.lineAtlas.getDash(Oe,Ne);Nt&&ft.setConstantPatternPositions(Nt)}let[dr,pr]=d.paint.get("line-trim-offset");(Ne==="round"||Ne==="square")&&dr!==pr&&(dr===0&&(dr-=1),pr===1&&(pr+=1));let Cr=ue?Gt.projMatrix:null,mr=Ke?r.bU(m,qt,d,Cr,de,[dr,pr]):r.bV(m,qt,d,Cr,Vt.lineClipsArray.length,de,[dr,pr]);if(at){let Nt=Vt.gradients[d.id],Pr=Nt.texture;if(d.gradientVersion!==Nt.version){let _i=256;if(d.stepInterpolant){let oi=s.getSource().maxzoom,Di=Gt.canonical.z===oi?Math.ceil(1<<m.transform.maxZoom-Gt.canonical.z):1;_i=r.at(r.bW(Vt.maxLineLength/r.a3*1024*Di),256,F.maxTextureSize)}Nt.gradient=r.bX({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:_i,image:Nt.gradient||void 0,clips:Vt.lineClipsArray}),Nt.texture?Nt.texture.update(Nt.gradient):Nt.texture=new r.T(F,Nt.gradient,O.RGBA),Nt.version=d.gradientVersion,Pr=Nt.texture}F.activeTexture.set(O.TEXTURE1),Pr.bind(d.stepInterpolant?O.NEAREST:O.LINEAR,O.CLAMP_TO_EDGE)}me&&(F.activeTexture.set(O.TEXTURE0),qt.lineAtlasTexture&&qt.lineAtlasTexture.bind(O.LINEAR,O.REPEAT),ft.updatePaintBuffers()),Ke&&(F.activeTexture.set(O.TEXTURE0),qt.imageAtlasTexture&&qt.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),ft.updatePaintBuffers()),X&&m.terrain.setupElevationDraw(qt,jt),m.uploadCommonUniforms(F,jt,Gt.toUnwrapped());let Yt=Nt=>{bt!=null&&(bt.value=Be*C),jt.draw(m,O.TRIANGLES,ie,Nt,ae,r.af.disabled,mr,d.id,Vt.layoutVertexBuffer,Vt.indexBuffer,Vt.segments,d.paint,m.transform.zoom,ft,[Vt.layoutVertexBuffer2,Vt.patternVertexBuffer,Vt.zOffsetVertexBuffer]),bt!=null&&(bt.value=Be)};if(je&&!X){let Nt=m.stencilModeForClipping(Gt).ref;Nt===0&&ue&&F.clear({stencil:0});let Pr={func:O.EQUAL,mask:255};mr.u_alpha_discard_threshold=.8,Yt(new r.ag(Pr,Nt,255,O.KEEP,O.KEEP,O.INVERT)),mr.u_alpha_discard_threshold=0,Yt(new r.ag(Pr,Nt,255,O.KEEP,O.KEEP,O.KEEP))}else je&&X&&(mr.u_alpha_discard_threshold=.001),Yt(X?Ct:m.stencilModeForClipping(Gt))}je&&(m.resetStencilClippingMasks(),ue&&F.clear({stencil:0})),C===0||m.depthOcclusion||ue||m.layersWithOcclusionOpacity.push(m.currentLayer),X&&(m.forceTerrainMode=!1)},fill:function(m,s,d,g){let x=d.paint.get("fill-color"),b=d.paint.get("fill-opacity");if(b.constantOr(1)===0)return;let S=d.paint.get("fill-emissive-strength"),C=m.colorModeForDrapableLayerRenderPass(S),F=d.paint.get("fill-pattern"),O=m.opaquePassEnabledForLayer()&&!F.constantOr(1)&&x.constantOr(r.C.transparent).a===1&&b.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===O){let V=m.depthModeForSublayer(1,m.renderPass==="opaque"?r.ae.ReadWrite:r.ae.ReadOnly);Ka(m,s,d,g,V,C,!1)}if(m.renderPass==="translucent"&&d.paint.get("fill-antialias")){let V=m.depthModeForSublayer(d.getPaintProperty("fill-outline-color")?2:0,r.ae.ReadOnly);Ka(m,s,d,g,V,C,!0)}},"fill-extrusion":function(m,s,d,g){let x=d.paint.get("fill-extrusion-opacity"),b=m.context,S=b.gl,C=m.terrain,F=C&&C.renderingToTexture;if(x===0)return;let O=m.conflationActive&&m.style.isLayerClipped(d,s.getSource()),V=m.style.order.indexOf(d.fqid);if(O&&function(X,ie,ae,ue,de){for(let fe of ue){let me=ie.getTile(fe).getBucket(ae);me&&(me.updateReplacement(fe,X.replacementSource,de),me.uploadCentroid(X.context))}}(m,s,d,g,V),C||O)for(let X of g){let ie=s.getTile(X).getBucket(d);ie&&Mc(m.context,s,X,ie,d,C,O)}if(m.renderPass==="shadow"&&m.shadowRenderer){let X=m.shadowRenderer;if(C&&x<.65&&d._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof r.Z)return;let ie=X.getShadowPassDepthMode(),ae=X.getShadowPassColorMode();bs(m,s,d,g,ie,r.ag.disabled,ae,O)}else if(m.renderPass==="translucent"){let X=!d.paint.get("fill-extrusion-pattern").constantOr(1),ie=d.paint.get("fill-extrusion-color").constantOr(r.C.white);if(!F&&ie.a!==0){let ae=new r.ae(m.context.gl.LEQUAL,r.ae.ReadWrite,m.depthRangeFor3D);x===1&&X?bs(m,s,d,g,ae,r.ag.disabled,r.a.unblended,O):(bs(m,s,d,g,ae,r.ag.disabled,r.a.disabled,O),bs(m,s,d,g,ae,m.stencilModeFor3D(),m.colorModeForRenderPass(),O),m.resetStencilClippingMasks())}if(m.style.enable3dLights()&&X&&(!C&&m.transform.projection.name!=="globe"||F)){let ae=d.paint.get("fill-extrusion-opacity"),ue=d.paint.get("fill-extrusion-ambient-occlusion-intensity"),de=d.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),fe=d.paint.get("fill-extrusion-flood-light-intensity"),me=d.paint.get("fill-extrusion-flood-light-color").toRenderColor(d.lut).toArray01().slice(0,3),Pe=ue>0&&de>0,Oe=fe>0,Ne=(Ke,Fe,Be)=>(1-Be)*Ke+Be*Fe,Je=Ke=>{let Fe=m.depthModeForSublayer(1,r.ae.ReadOnly,S.LEQUAL,!0),Be=d.paint.get(Ke?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),je=Ne(.1,3,Be),at=m._showOverdrawInspector;if(!at){let xt=new r.ag({func:S.ALWAYS,mask:255},255,255,S.KEEP,S.KEEP,S.REPLACE),qe=new r.a([S.ONE,S.ONE,S.ONE,S.ONE],r.C.transparent,[!1,!1,!1,!0],S.MIN);Ha(m,s,d,g,Fe,xt,qe,r.af.disabled,Ke,"sdf",ae,ue,de,fe,me,je,O,!1)}{let xt=at?r.ag.disabled:new r.ag({func:S.EQUAL,mask:255},255,255,S.KEEP,S.DECR,S.DECR),qe=at?m.colorModeForRenderPass():new r.a([S.ONE_MINUS_DST_ALPHA,S.DST_ALPHA,S.ONE,S.ONE],r.C.transparent,[!0,!0,!0,!0]);Ha(m,s,d,g,Fe,xt,qe,r.af.disabled,Ke,"color",ae,ue,de,fe,me,je,O,!1)}};if(F){let Ke=(Fe,Be,je)=>{let at=m.depthModeForSublayer(1,r.ae.ReadOnly,S.LEQUAL,!1),xt=d.paint.get(Fe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),qe=Ne(.1,3,xt);{let bt=new r.a([S.ONE,S.ONE,S.ONE,S.ONE],r.C.transparent,[!1,!1,!1,!0]);Ha(m,s,d,g,at,r.ag.disabled,bt,r.af.disabled,Fe,"clear",ae,ue,de,fe,me,qe,O,Be)}{let bt=new r.ag({func:S.ALWAYS,mask:255},255,255,S.KEEP,S.KEEP,S.REPLACE),Ct=new r.a([S.ONE,S.ONE,S.ONE,S.ONE],r.C.transparent,[!1,!1,!1,!0],S.MIN);Ha(m,s,d,g,at,bt,Ct,r.af.disabled,Fe,"sdf",ae,ue,de,fe,me,qe,O,Be)}{let bt=Fe?S.ZERO:S.ONE_MINUS_DST_ALPHA,Ct=new r.ag({func:S.EQUAL,mask:255},255,255,S.KEEP,S.DECR,S.DECR),Gt=new r.a([bt,S.DST_ALPHA,S.ONE_MINUS_DST_ALPHA,S.ZERO],r.C.transparent,[!0,!0,!0,!0]);Ha(m,s,d,g,at,Ct,Gt,r.af.disabled,Fe,"color",ae,ue,de,fe,me,qe,O,Be)}{let bt=new r.a([S.ONE,S.ONE,S.ONE,Fe?S.ZERO:S.ONE],r.C.transparent,[!1,!1,!1,!0],Fe?S.FUNC_ADD:S.MAX);Ha(m,s,d,g,at,r.ag.disabled,bt,r.af.disabled,Fe,"clear",ae,ue,de,fe,me,qe,O,Be,je)}};if(Pe||Oe){let Fe;if(m.prepareDrawTile(),C){let Be=C.drapeBufferSize[0],je=C.drapeBufferSize[1];Fe=C.framebufferCopyTexture,Fe&&(!Fe||Fe.size[0]===Be&&Fe.size[1]===je)||(Fe&&Fe.destroy(),Fe=C.framebufferCopyTexture=new r.T(b,new r.i({width:Be,height:je}),S.RGBA)),Fe.bind(S.LINEAR,S.CLAMP_TO_EDGE),S.copyTexImage2D(S.TEXTURE_2D,0,S.RGBA,0,0,Be,je,0)}Pe&&Ke(!0,!1,Fe),Oe&&Ke(!1,!0,Fe)}}else Pe&&Je(!0),Oe&&Je(!1)}}},hillshade:function(m,s,d,g){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent"||m.style.disableElevatedTerrain)return;let x=m.context,b=m.terrain&&m.terrain.renderingToTexture,[S,C]=m.renderPass!=="translucent"||b?[{},g]:m.stencilConfigForOverlap(g);for(let F of C){let O=s.getTile(F);if(O.needsHillshadePrepare&&m.renderPass==="offscreen")yo(m,O,d);else if(m.renderPass==="translucent"){let V=m.depthModeForSublayer(0,r.ae.ReadOnly),X=d.paint.get("hillshade-emissive-strength"),ie=m.colorModeForDrapableLayerRenderPass(X),ae=b&&m.terrain?m.terrain.stencilModeForRTTOverlap(F):S[F.overscaledZ];Cp(m,F,O,d,V,ae,ie)}}x.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,s,d,g,x,b){if(m.renderPass!=="translucent"||d.paint.get("raster-opacity")===0)return;let S=m.transform.projection.name==="globe",C=d.paint.get("raster-elevation")!==0,F=C&&S;if(m.renderElevatedRasterBackface&&!F)return;let O=m.context,V=O.gl,X=s.getSource(),ie=function(Ke,Fe,Be,je){let at=Fe.paint.get("raster-color"),xt=Ke.type==="raster-array",qe=[],bt=Fe.paint.get("raster-resampling"),Ct=Fe.paint.get("raster-color-mix"),Gt=Fe.paint.get("raster-color-range"),qt=[Ct[0],Ct[1],Ct[2],0],Vt=Ct[3],ft=bt==="nearest"?je.NEAREST:je.LINEAR;if(xt&&(qe.push("RASTER_ARRAY"),at||qe.push("RASTER_COLOR"),bt==="linear"&&qe.push("RASTER_ARRAY_LINEAR"),ft=je.NEAREST,!Gt&&Ke.rasterLayers)){let kt=Ke.rasterLayers.find(({id:jt})=>jt===Fe.sourceLayer);kt&&kt.fields&&kt.fields.range&&(Gt=kt.fields.range)}if(Gt=Gt||[0,1],at){qe.push("RASTER_COLOR"),Be.activeTexture.set(je.TEXTURE2),Fe.updateColorRamp(Gt);let kt=Fe.colorRampTexture;kt||(kt=Fe.colorRampTexture=new r.T(Be,Fe.colorRamp,je.RGBA)),kt.bind(je.LINEAR,je.CLAMP_TO_EDGE)}return{mix:qt,range:Gt,offset:Vt,defines:qe,resampling:ft}}(X,d,O,V);if(X instanceof r.bm&&!g.length&&!S)return;let ae=d.paint.get("raster-emissive-strength"),ue=m.colorModeForDrapableLayerRenderPass(ae),de=m.terrain&&m.terrain.renderingToTexture,fe=!m.options.moving,me=d.paint.get("raster-resampling")==="nearest"?V.NEAREST:V.LINEAR;if(X instanceof r.bm&&!g.length&&(X.onNorthPole||X.onSouthPole)){let Ke=C?m.stencilModeFor3D():r.ag.disabled;return void Rh(!!X.onNorthPole,null,m,s,d,ae,ie,r.af.disabled,Ke)}if(!g.length)return;let[Pe,Oe]=X instanceof r.bm||de?[{},g]:m.stencilConfigForOverlap(g),Ne=Oe[Oe.length-1].overscaledZ;F&&ie.defines.push("PROJECTION_GLOBE_VIEW"),C&&ie.defines.push("RENDER_CUTOFF");let Je=(Ke,Fe,Be)=>{for(let je of Ke){let at=je.toUnwrapped(),xt=s.getTile(je);if(de&&(!xt||!xt.hasData()))continue;O.activeTexture.set(V.TEXTURE0);let qe=Mp(xt,X,d,ie);if(!qe||!qe.texture)continue;let{texture:bt,mix:Ct,offset:Gt,tileSize:qt,buffer:Vt}=qe,ft,kt;de?(ft=r.ae.disabled,kt=je.projMatrix):C?(ft=new r.ae(V.LEQUAL,r.ae.ReadWrite,m.depthRangeFor3D),kt=S?Float32Array.from(m.transform.expandedFarZProjMatrix):m.transform.calculateProjMatrix(at,fe)):(ft=m.depthModeForSublayer(je.overscaledZ-Ne,d.paint.get("raster-opacity")===1?r.ae.ReadWrite:r.ae.ReadOnly,V.LESS),kt=m.transform.calculateProjMatrix(at,fe));let jt=m.terrain&&de?m.terrain.stencilModeForRTTOverlap(je):Pe[je.overscaledZ],dr=b?0:d.paint.get("raster-fade-duration");xt.registerFadeDuration(dr);let pr=s.findLoadedParent(je,0),Cr=hi(xt,pr,s,m.transform,dr),mr,Yt;m.terrain&&m.terrain.prepareDrawTile(),O.activeTexture.set(V.TEXTURE0),bt.bind(me,V.CLAMP_TO_EDGE),O.activeTexture.set(V.TEXTURE1),pr?(pr.texture&&pr.texture.bind(me,V.CLAMP_TO_EDGE),mr=Math.pow(2,pr.tileID.overscaledZ-xt.tileID.overscaledZ),Yt=[xt.tileID.canonical.x*mr%1,xt.tileID.canonical.y*mr%1]):bt.bind(me,V.CLAMP_TO_EDGE),bt.useMipmap&&O.extTextureFilterAnisotropic&&m.transform.pitch>20&&V.texParameterf(V.TEXTURE_2D,O.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,O.extTextureFilterAnisotropicMax);let Nt=m.transform,Pr,_i=C?qi(Nt):[0,0,0,0],oi,Di,Xi,_n,ni,cn=0;if(F&&X instanceof r.bm&&X.coordinates.length>3)oi=Float32Array.from(r.bf(r.bg(new r.aO(0,0,0)))),Di=Float32Array.from(Nt.globeMatrix),Xi=Float32Array.from(r.bb(Nt)),_n=[r.aj(Nt.center.lng),r.ak(Nt.center.lat)],Pr=X.elevatedGlobePerspectiveTransform,ni=X.elevatedGlobeGridMatrix||new Float32Array(9);else if(F){let li=r.bc(je.canonical);cn=r.bd(li.getCenter().lat),oi=Float32Array.from(r.bf(r.bg(je.canonical))),Di=Float32Array.from(Nt.globeMatrix),Xi=Float32Array.from(r.bb(Nt)),_n=[r.aj(Nt.center.lng),r.ak(Nt.center.lat)],Pr=[0,0],ni=Float32Array.from(r.be(je.canonical,li,cn,Nt.worldSize/Nt._pixelsPerMercatorPixel))}else Pr=X instanceof r.bm?X.perspectiveTransform:[0,0],oi=new Float32Array(16),Di=new Float32Array(9),Xi=new Float32Array(16),_n=[0,0],ni=new Float32Array(9);let kn=nu(kt,oi,Di,Xi,ni,Yt||[0,0],r.a1(m.transform.zoom),_n,_i,mr||1,Cr,d,Pr,C?d.paint.get("raster-elevation"):0,2,Ct,Gt,ie.range,qt,Vt,ae),mn=m.isTileAffectedByFog(je),Ni=m.getOrCreateProgram("raster",{defines:ie.defines,overrideFog:mn});if(m.uploadCommonUniforms(O,Ni,at),X instanceof r.bm){let li=X.elevatedGlobeVertexBuffer,zn=X.elevatedGlobeIndexBuffer;if(de||!S)X.boundsBuffer&&X.boundsSegments&&Ni.draw(m,V.TRIANGLES,ft,r.ag.disabled,ue,r.af.disabled,kn,d.id,X.boundsBuffer,m.quadTriangleIndexBuffer,X.boundsSegments);else if(li&&zn){let $n=Nt.zoom<=r.b1?X.elevatedGlobeSegments:X.getSegmentsForLongitude(Nt.center.lng);$n&&Ni.draw(m,V.TRIANGLES,ft,r.ag.disabled,ue,Fe,kn,d.id,li,zn,$n)}}else if(F){ft=new r.ae(V.LEQUAL,r.ae.ReadOnly,m.depthRangeFor3D);let li=m.globeSharedBuffers;if(li){let[zn,$n,bn]=li.getGridBuffers(cn,!1);Ni.draw(m,V.TRIANGLES,ft,Be||jt,m.colorModeForRenderPass(),Fe,kn,d.id,zn,$n,bn)}}else{let{tileBoundsBuffer:li,tileBoundsIndexBuffer:zn,tileBoundsSegments:$n}=m.getTileBoundsBuffers(xt);Ni.draw(m,V.TRIANGLES,ft,jt,ue,r.af.disabled,kn,d.id,li,zn,$n)}}if(!(X instanceof r.bm)&&F)for(let je of Ke){let at=je.canonical.y===(1<<je.canonical.z)-1;je.canonical.y===0&&Rh(!0,je,m,s,d,ae,ie,Fe,Be||r.ag.disabled),at&&Rh(!1,je,m,s,d,ae,ie,Fe===r.af.frontCW?r.af.backCW:r.af.frontCW,Be||r.ag.disabled)}};F?Je(Oe,m.renderElevatedRasterBackface?r.af.backCW:r.af.frontCW,m.stencilModeFor3D()):Je(Oe,r.af.disabled,void 0),m.resetStencilClippingMasks()},"raster-particle":function(m,s,d,g,x,b){m.renderPass==="offscreen"&&function(S,C,F,O){if(!O.length)return;let V=S.context,X=V.gl,ie=C.getSource();if(!(ie instanceof Fi))return;let ae=Math.ceil(Math.sqrt(F.paint.get("raster-particle-count"))),ue=F.particlePositionRGBAImage;if(!ue||ue.width!==ae){let Oe=function(Ne){let Je=Ne*Ne,Ke=new Uint8Array(4*Je),Fe=function(je){return je|=0,je=Math.imul(2747636419^je,2654435769),je=Math.imul(je^je>>>16,2654435769),((je=Math.imul(je^je>>>16,2654435769))>>>0)/4294967296},Be=1/1.3;for(let je=0;je<Je;je++){let at=Be*(Fe(2*je+0)+nl),xt=Be*(Fe(2*je+1)+nl),qe=255*at%1,bt=255*xt%1,Ct=qe,Gt=xt-bt/255,qt=bt;Ke[4*je+0]=255*(at-qe/255),Ke[4*je+1]=255*Ct,Ke[4*je+2]=255*Gt,Ke[4*je+3]=255*qt}return Ke}(ae);ue=F.particlePositionRGBAImage=new r.i({width:ae,height:ae},Oe)}let de=F.particleFramebuffer;de?de.width!==ae&&(de.destroy(),de=F.particleFramebuffer=V.createFramebuffer(ae,ae,!0,null)):de=F.particleFramebuffer=V.createFramebuffer(ae,ae,!0,null);let fe=[];for(let Oe of O){let Ne=C.getTile(Oe);if(!(Ne instanceof r.c3))continue;let Je=Xr(Ne,ie,F);if(!Je)continue;let Ke=[Ne.tileSize,Ne.tileSize],Fe=F.tileFramebuffer;Fe||(Fe=F.tileFramebuffer=V.createFramebuffer(Ke[0],Ke[1],!0,null));let Be=Ne.rasterParticleState;Be||(Be=Ne.rasterParticleState=new Lr(V,Oe,Ke,ue));let je=Be.update(F.lastInvalidatedAt);Be.particleTextureDimension!==ae&&Be.updateParticleTexture(Oe,ue);let at=Be.targetColorTexture;Be.targetColorTexture=Be.backgroundColorTexture,Be.backgroundColorTexture=at;let xt=Be.particleTexture0;Be.particleTexture0=Be.particleTexture1,Be.particleTexture1=xt,fe.push([Oe,Je,Be,je])}if(fe.length===0)return;let me=r.e.now(),Pe=F.previousDrawTimestamp?.001*(me-F.previousDrawTimestamp):.0167;if(F.previousDrawTimestamp=me,F.hasColorMap()){V.activeTexture.set(X.TEXTURE0+2);let Oe=F.colorRampTexture;Oe||(Oe=F.colorRampTexture=new r.T(V,F.colorRamp,X.RGBA)),Oe.bind(X.LINEAR,X.CLAMP_TO_EDGE)}V.bindFramebuffer.set(F.tileFramebuffer.framebuffer),function(Oe,Ne,Je){let Ke=Oe.context,Fe=Ke.gl,Be=Ne.tileFramebuffer;Ke.activeTexture.set(Fe.TEXTURE0);let je={u_texture:0,u_opacity:1.05*(xt=Ne.paint.get("raster-particle-fade-opacity-factor"))/(xt+.05)},at=Oe.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var xt;for(let qe of Je){let[,,bt,Ct]=qe;Be.colorAttachment.set(bt.targetColorTexture.texture),Ke.viewport.set([0,0,Be.width,Be.height]),Ke.clear({color:r.C.transparent}),Ct&&(bt.backgroundColorTexture.bind(Fe.NEAREST,Fe.CLAMP_TO_EDGE),at.draw(Oe,Fe.TRIANGLES,r.ae.disabled,r.ag.disabled,r.a.alphaBlended,r.af.disabled,je,Ne.id,Oe.viewportBuffer,Oe.quadTriangleIndexBuffer,Oe.viewportSegments))}}(S,F,fe),function(Oe,Ne,Je,Ke){let Fe=Oe.context,Be=Fe.gl,je=Je.tileFramebuffer,at=Oe.transform.projection.name==="globe",xt=Je.paint.get("raster-particle-max-speed");for(let qe of Ke){let[bt,Ct,Gt]=qe;Fe.activeTexture.set(Be.TEXTURE0+0),Ct.texture.bind(Be.LINEAR,Be.CLAMP_TO_EDGE),je.colorAttachment.set(Gt.targetColorTexture.texture);let qt=Oe.getOrCreateProgram("rasterParticleDraw",{defines:Ct.defines,overrideFog:!1});Fe.activeTexture.set(Be.TEXTURE0+1);let Vt=Ct.scalarData?[]:[0,1,2,3].map(jt=>r.bZ[jt](bt));Vt.push(bt);let ft=bt.canonical.x,kt=bt.canonical.y;for(let jt of Vt){let dr=Ne.getTile(at?jt.wrapped():jt);if(!dr)continue;let pr=dr.rasterParticleState;if(!pr)continue;let Cr=jt.canonical.x+(1<<jt.canonical.z)*(jt.wrap-bt.wrap),mr=jt.canonical.y;pr.particleTexture0.bind(Be.NEAREST,Be.CLAMP_TO_EDGE);let Yt=wd(1,pr.particleTexture0.size[0],[Cr-ft,mr-kt],0,Ct.texture.size,2,xt,Ct.textureOffset,Ct.scale,Ct.offset);qt.draw(Oe,Be.POINTS,r.ae.disabled,r.ag.disabled,r.a.alphaBlended,r.af.disabled,Yt,Je.id,pr.particleIndexBuffer,void 0,pr.particleSegment)}}}(S,C,F,fe),V.bindFramebuffer.set(F.particleFramebuffer.framebuffer),function(Oe,Ne,Je,Ke){let Fe=Oe.context,Be=Fe.gl,je=Ne.paint.get("raster-particle-max-speed"),at=Ke*Ne.paint.get("raster-particle-speed-factor")*.15,xt=function(bt){return Math.pow(bt,6)}(.01+1*Ne.paint.get("raster-particle-reset-rate-factor")),qe=Ne.particleFramebuffer;Fe.viewport.set([0,0,qe.width,qe.height]);for(let bt of Je){let[,Ct,Gt]=bt;Fe.activeTexture.set(Be.TEXTURE0+0),Ct.texture.bind(Be.LINEAR,Be.CLAMP_TO_EDGE),Fe.activeTexture.set(Be.TEXTURE0+1);let qt=Gt.particleTexture0;qt.bind(Be.NEAREST,Be.CLAMP_TO_EDGE);let Vt=au(1,qt.size[0],0,Ct.texture.size,je,at,xt,Ct.textureOffset,Ct.scale,Ct.offset);qe.colorAttachment.set(Gt.particleTexture1.texture),Fe.clear({color:r.C.transparent}),Oe.getOrCreateProgram("rasterParticleUpdate",{defines:Ct.defines}).draw(Oe,Be.TRIANGLES,r.ae.disabled,r.ag.disabled,r.a.unblended,r.af.disabled,Vt,Ne.id,Oe.viewportBuffer,Oe.quadTriangleIndexBuffer,Oe.viewportSegments)}}(S,F,fe,Pe)}(m,s,d,g),m.renderPass==="translucent"&&(function(S,C,F,O,V){let X=S.context,ie=X.gl,ae=!S.options.moving,ue=S.transform.projection.name==="globe";if(!O.length)return;let[de,fe]=S.stencilConfigForOverlap(O),me=[];ue&&me.push("PROJECTION_GLOBE_VIEW");let Pe=S.stencilModeFor3D();for(let Oe of fe){let Ne=Oe.toUnwrapped(),Je=C.getTile(Oe);if(!Je.rasterParticleState)continue;let Ke=Je.rasterParticleState,Fe=100;Je.registerFadeDuration(Fe);let Be=C.findLoadedParent(Oe,0),je=hi(Je,Be,C,S.transform,Fe),at,xt;S.terrain&&S.terrain.prepareDrawTile(),X.activeTexture.set(ie.TEXTURE0),Ke.targetColorTexture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE),X.activeTexture.set(ie.TEXTURE1),Be&&Be.rasterParticleState?(Be.rasterParticleState.targetColorTexture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE),at=Math.pow(2,Be.tileID.overscaledZ-Je.tileID.overscaledZ),xt=[Je.tileID.canonical.x*at%1,Je.tileID.canonical.y*at%1]):Ke.targetColorTexture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE);let qe=ue?Float32Array.from(S.transform.expandedFarZProjMatrix):S.transform.calculateProjMatrix(Ne,ae),bt=S.transform,Ct=ws(bt),Gt=r.bc(Oe.canonical),qt=r.bd(Gt.getCenter().lat),Vt,ft,kt,jt,dr;ue?(Vt=Float32Array.from(r.bf(r.bg(Oe.canonical))),ft=Float32Array.from(bt.globeMatrix),kt=Float32Array.from(r.bb(bt)),jt=[r.aj(bt.center.lng),r.ak(bt.center.lat)],dr=Float32Array.from(r.be(Oe.canonical,Gt,qt,bt.worldSize/bt._pixelsPerMercatorPixel))):(Vt=new Float32Array(16),ft=new Float32Array(9),kt=new Float32Array(16),jt=[0,0],dr=new Float32Array(9));let pr=bd(qe,Vt,ft,kt,dr,xt||[0,0],r.a1(S.transform.zoom),jt,Ct,at||1,je,250),Cr=S.isTileAffectedByFog(Oe),mr=S.getOrCreateProgram("rasterParticle",{defines:me,overrideFog:Cr});if(S.uploadCommonUniforms(X,mr,Ne),ue){let Yt=new r.ae(ie.LEQUAL,r.ae.ReadWrite,S.depthRangeFor3D),Nt=0,Pr=S.globeSharedBuffers;if(Pr){let[_i,oi,Di]=Pr.getGridBuffers(qt,Nt!==0);mr.draw(S,ie.TRIANGLES,Yt,Pe,r.a.alphaBlended,r.af.backCCW,pr,F.id,_i,oi,Di)}}else{let Yt=S.depthModeForSublayer(0,r.ae.ReadOnly),Nt=de[Oe.overscaledZ],{tileBoundsBuffer:Pr,tileBoundsIndexBuffer:_i,tileBoundsSegments:oi}=S.getTileBoundsBuffers(Je);mr.draw(S,ie.TRIANGLES,Yt,Nt,r.a.alphaBlended,r.af.disabled,pr,F.id,Pr,_i,oi)}}S.resetStencilClippingMasks()}(m,s,d,g),m.style.map.triggerRepaint())},background:function(m,s,d,g){let x=d.paint.get("background-color"),b=d.paint.get("background-opacity"),S=d.paint.get("background-emissive-strength");if(b===0)return;let C=m.context,F=C.gl,O=m.transform,V=O.tileSize,X=d.paint.get("background-pattern"),ie;if(X!==void 0&&(X===null||(ie=m.imageManager.getPattern(X.toString(),d.scope,m.style.getLut(d.scope)),!ie)))return;let ae=!X&&x.a===1&&b===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==ae)return;let ue=r.ag.disabled,de=m.depthModeForSublayer(0,ae==="opaque"?r.ae.ReadWrite:r.ae.ReadOnly),fe=m.colorModeForDrapableLayerRenderPass(S),me=X?"backgroundPattern":"background",Pe,Oe=g;Oe||(Pe=m.getBackgroundTiles(),Oe=Object.values(Pe).map(Ne=>Ne.tileID)),X&&(C.activeTexture.set(F.TEXTURE0),m.imageManager.bind(m.context,d.scope));for(let Ne of Oe){let Je=m.isTileAffectedByFog(Ne),Ke=m.getOrCreateProgram(me,{overrideFog:Je}),Fe=Ne.toUnwrapped(),Be=g?Ne.projMatrix:m.transform.calculateProjMatrix(Fe);m.prepareDrawTile();let je=s?s.getTile(Ne):Pe?Pe[Ne.key]:new r.by(Ne,V,O.zoom,m),at=X?Ou(Be,S,b,m,0,d.scope,ie,{tileID:Ne,tileSize:V}):js(Be,S,b,x.toRenderColor(d.lut));m.uploadCommonUniforms(C,Ke,Fe);let{tileBoundsBuffer:xt,tileBoundsIndexBuffer:qe,tileBoundsSegments:bt}=m.getTileBoundsBuffers(je);Ke.draw(m,F.TRIANGLES,de,ue,fe,r.af.disabled,at,d.id,xt,qe,bt)}},sky:function(m,s,d){let g=m._atmosphere?r.a1(m.transform.zoom):1,x=d.paint.get("sky-opacity")*g;if(x===0)return;let b=m.context,S=d.paint.get("sky-type"),C=new r.ae(b.gl.LEQUAL,r.ae.ReadOnly,[0,1]),F=m.frameCounter/1e3%1;S==="atmosphere"?m.renderPass==="offscreen"?d.needsSkyboxCapture(m)&&(function(O,V,X,ie){let ae=O.context,ue=ae.gl,de=V.skyboxFbo;if(!de){de=V.skyboxFbo=ae.createFramebuffer(32,32,!0,null),V.skyboxGeometry=new Ph(ae),V.skyboxTexture=ae.gl.createTexture(),ue.bindTexture(ue.TEXTURE_CUBE_MAP,V.skyboxTexture),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_WRAP_S,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_WRAP_T,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_MIN_FILTER,ue.LINEAR),ue.texParameteri(ue.TEXTURE_CUBE_MAP,ue.TEXTURE_MAG_FILTER,ue.LINEAR);for(let Oe=0;Oe<6;++Oe)ue.texImage2D(ue.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,0,ue.RGBA,32,32,0,ue.RGBA,ue.UNSIGNED_BYTE,null)}ae.bindFramebuffer.set(de.framebuffer),ae.viewport.set([0,0,32,32]);let fe=V.getCenter(O,!0),me=O.getOrCreateProgram("skyboxCapture"),Pe=new Float64Array(16);r.ad.identity(Pe),r.ad.rotateY(Pe,Pe,.5*-Math.PI),Jl(O,V,me,Pe,fe,0),r.ad.identity(Pe),r.ad.rotateY(Pe,Pe,.5*Math.PI),Jl(O,V,me,Pe,fe,1),r.ad.identity(Pe),r.ad.rotateX(Pe,Pe,.5*-Math.PI),Jl(O,V,me,Pe,fe,2),r.ad.identity(Pe),r.ad.rotateX(Pe,Pe,.5*Math.PI),Jl(O,V,me,Pe,fe,3),r.ad.identity(Pe),Jl(O,V,me,Pe,fe,4),r.ad.identity(Pe),r.ad.rotateY(Pe,Pe,Math.PI),Jl(O,V,me,Pe,fe,5),ae.viewport.set([0,0,O.width,O.height])}(m,d),d.markSkyboxValid(m)):m.renderPass==="sky"&&function(O,V,X,ie,ae){let ue=O.context,de=ue.gl,fe=O.transform,me=O.getOrCreateProgram("skybox");ue.activeTexture.set(de.TEXTURE0),de.bindTexture(de.TEXTURE_CUBE_MAP,V.skyboxTexture);let Pe=((Oe,Ne,Je,Ke,Fe)=>({u_matrix:Oe,u_sun_direction:Ne,u_cubemap:0,u_opacity:Ke,u_temporal_offset:Fe}))(fe.skyboxMatrix,V.getCenter(O,!1),0,ie,ae);O.uploadCommonUniforms(ue,me),me.draw(O,de.TRIANGLES,X,r.ag.disabled,O.colorModeForRenderPass(),r.af.backCW,Pe,"skybox",V.skyboxGeometry.vertexBuffer,V.skyboxGeometry.indexBuffer,V.skyboxGeometry.segment)}(m,d,C,x,F):S==="gradient"&&m.renderPass==="sky"&&function(O,V,X,ie,ae){let ue=O.context,de=ue.gl,fe=O.transform,me=O.getOrCreateProgram("skyboxGradient");V.skyboxGeometry||(V.skyboxGeometry=new Ph(ue)),ue.activeTexture.set(de.TEXTURE0);let Pe=V.colorRampTexture;Pe||(Pe=V.colorRampTexture=new r.T(ue,V.colorRamp,de.RGBA)),Pe.bind(de.LINEAR,de.CLAMP_TO_EDGE);let Oe=((Ne,Je,Ke,Fe,Be)=>({u_matrix:Ne,u_color_ramp:0,u_center_direction:Je,u_radius:r.ab(Ke),u_opacity:Fe,u_temporal_offset:Be}))(fe.skyboxMatrix,V.getCenter(O,!1),V.paint.get("sky-gradient-radius"),ie,ae);O.uploadCommonUniforms(ue,me),me.draw(O,de.TRIANGLES,X,r.ag.disabled,O.colorModeForRenderPass(),r.af.backCW,Oe,"skyboxGradient",V.skyboxGeometry.vertexBuffer,V.skyboxGeometry.indexBuffer,V.skyboxGeometry.segment)}(m,d,C,x,F)},debug:function(m,s,d,g,x,b){for(let S=0;S<d.length;S++)if(x){let O=new r.C(g.r*.8,g.g*.8,g.b*.8,1);Tr(m,s,d[S],g,-1,-1,b),Tr(m,s,d[S],g,-1,1,b),Tr(m,s,d[S],g,1,1,b),Tr(m,s,d[S],g,1,-1,b),Tr(m,s,d[S],O,0,0,b)}else Tr(m,s,d[S],g,0,0,b)},custom:function(m,s,d,g){let x=m.context,b=d.implementation;if(!m.transform.projection.unsupportedLayers||!m.transform.projection.unsupportedLayers.includes("custom")||m.terrain&&(m.terrain.renderingToTexture||m.renderPass==="offscreen")&&d.isDraped(s)){if(m.renderPass==="offscreen"){let S=b.prerender;if(S){if(m.setCustomLayerDefaults(),x.setColorMode(m.colorModeForRenderPass()),m.transform.projection.name==="globe"){let C=m.transform.pointMerc;S.call(b,x.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),r.a1(m.transform.zoom),[C.x,C.y],m.transform.pixelsPerMeterRatio)}else S.call(b,x.gl,m.transform.customLayerMatrix());x.setDirty(),m.setBaseState()}}else if(m.renderPass==="translucent"){if(m.terrain&&m.terrain.renderingToTexture){let C=b.renderToTile;if(C){let F=g[0].canonical,O=new r.Y(F.x+g[0].wrap*(1<<F.z),F.y,F.z);x.setDepthMode(r.ae.disabled),x.setStencilMode(r.ag.disabled),x.setColorMode(m.colorModeForRenderPass()),m.setCustomLayerDefaults(),C.call(b,x.gl,O),x.setDirty(),m.setBaseState()}return}m.setCustomLayerDefaults(),x.setColorMode(m.colorModeForRenderPass()),x.setStencilMode(r.ag.disabled);let S=b.renderingMode==="3d"?new r.ae(m.context.gl.LEQUAL,r.ae.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,r.ae.ReadOnly);if(x.setDepthMode(S),m.transform.projection.name==="globe"){let C=m.transform.pointMerc;b.render(x.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),r.a1(m.transform.zoom),[C.x,C.y],m.transform.pixelsPerMeterRatio)}else b.render(x.gl,m.transform.customLayerMatrix());x.setDirty(),m.setBaseState(),x.bindFramebuffer.set(null)}}else r.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(m,s,d,g){if(m.renderPass==="opaque")return;let x=d.paint.get("model-opacity");if(x===0)return;let b=d.paint.get("model-cast-shadows");if(m.renderPass==="shadow"&&(!b||m.terrain&&x<.65&&d._transitionablePaint._values["model-opacity"].value.expression instanceof r.Z))return;let S=m.shadowRenderer,C=d.paint.get("model-receive-shadows");S&&(S.useNormalOffset=!0,C||(S.enabled=!1));let F=()=>{S&&(S.useNormalOffset=!0,C||(S.enabled=!0))},O=s.getSource();if(m.renderPass==="light-beam"&&O.type!=="batched-model")return;if(O.type==="vector"||O.type==="geojson")return function(me,Pe,Oe,Ne,Je){let Ke=me.transform;if(Ke.projection.name!=="mercator")return void r.w(`Drawing 3D models for ${Ke.projection.name} projection is not yet implemented`);let Fe=Ke.getFreeCameraOptions().position;if(!me.modelManager)return;let Be=me.modelManager;Oe.modelManager=Be;let je=me.shadowRenderer;if(!Oe._unevaluatedLayout._values.hasOwnProperty("model-id"))return;let at=Oe._unevaluatedLayout._values["model-id"],xt=jr({},Oe.layout.get("model-id").parameters),qe=me.style.order.indexOf(Oe.fqid);for(let bt of Ne){let Ct=Pe.getTile(bt).getBucket(Oe);if(!Ct||Ct.projection.name!==Ke.projection.name)continue;let Gt=Ct.getModelUris();Gt&&!Ct.modelsRequested&&(Be.addModelsFromBucket(Gt,Je),Ct.modelsRequested=!0);let qt=Wa(bt,Ke);xt.zoom=qt;let Vt=at.possiblyEvaluate(xt);if(Nm(me,Ct,bt),Wo.shadowUniformsInitialized=!1,Wo.useSingleShadowCascade=!!je&&je.getMaxCascadeForTile(bt.toUnwrapped())===0,me.renderPass==="shadow"&&je){if(me.currentShadowCascade===1&&Ct.isInsideFirstShadowMapFrustum)continue;let jt=Ke.calculatePosMatrix(bt.toUnwrapped(),Ke.worldSize);if(Wo.tileMatrix.set(jt),Wo.shadowTileMatrix=Float32Array.from(je.calculateShadowPassMatrixFromMatrix(jt)),Wo.aabb.min.fill(0),Wo.aabb.max[0]=Wo.aabb.max[1]=r.a3,Wo.aabb.max[2]=0,fo(Ct,Wo,me,Oe.scope))continue}let ft=1<<bt.canonical.z,kt=[((Fe.x-bt.wrap)*ft-bt.canonical.x)*r.a3,(Fe.y*ft-bt.canonical.y)*r.a3,Fe.z*ft*r.a3];me.conflationActive&&Object.keys(Ct.instancesPerModel).length>0&&me.style.isLayerClipped(Oe,Pe.getSource())&&Ct.updateReplacement(bt,me.replacementSource,qe)&&(Ct.uploaded=!1,Ct.upload(me.context));for(let jt in Ct.instancesPerModel){let dr=Ct.instancesPerModel[jt];dr.features.length>0&&(jt=Vt.evaluate(dr.features[0].feature,{}));let pr=Be.getModel(jt,Je);if(pr&&pr.uploaded)for(let Cr of pr.nodes)sl(me,Oe,Cr,dr,kt,bt,Wo)}}}(m,s,d,g,O.type==="vector"?d.scope:""),void F();if(!O.loaded())return;if(O.type==="batched-model")return function(me,Pe,Oe,Ne){Oe.resetLayerRenderingStats(me);let Je=me.context,Ke=me.transform,Fe=me.style.fog,Be=me.shadowRenderer;if(Ke.projection.name!=="mercator")return void r.w(`Drawing 3D landmark models for ${Ke.projection.name} projection is not yet implemented`);let je=me.transform.getFreeCameraOptions().position,at=r._.scale([],[je.x,je.y,je.z],me.transform.worldSize);r._.negate(at,at);let xt=r.ad.identity([]),qe=r.cg(Ke.center.lat,Ke.zoom),bt=r.ad.fromScaling([],[1,1,1/qe]);r.ad.translate(xt,xt,at);let Ct=Oe.paint.get("model-opacity"),Gt=new r.ae(Je.gl.LEQUAL,r.ae.ReadWrite,me.depthRangeFor3D),qt=new r.ae(Je.gl.LEQUAL,r.ae.ReadOnly,me.depthRangeFor3D),Vt=new r.b6([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),ft=me.renderPass==="shadow",kt=ft&&Be?Be.getCurrentCascadeFrustum():Ke.getFrustum(Ke.scaleZoom(Ke.worldSize)),jt=Oe.paint.get("model-front-cutoff"),dr=jt[2]<1,pr=il(me,Oe.paint.get("model-cutoff-fade-range")),Cr=Oe.getLayerRenderingStats();(function(mr,Yt,Nt,Pr){let _i=mr.terrain?mr.terrain.exaggeration():0,oi=mr.transform.zoom;for(let Di of Pr){let Xi=Yt.getTile(Di).getBucket(Nt);Xi&&(mr.conflationActive&&Xi.updateReplacement(Di,mr.replacementSource),Xi.evaluateScale(mr,Nt),mr.terrain&&_i>0&&Xi.elevationUpdate(mr.terrain,_i,Di,Nt.source),Xi.needsReEvaluation(mr,oi,Nt)&&Xi.evaluate(Nt))}})(me,Pe,Oe,Ne),function(){let mr,Yt,Nt;dr?(mr=Ne.length-1,Yt=-1,Nt=-1):(mr=0,Yt=Ne.length,Nt=1);for(let Pr=mr;Pr!==Yt;Pr+=Nt){let _i=Ne[Pr],oi=Pe.getTile(_i).getBucket(Oe);if(!oi||!oi.uploaded)continue;let Di=!1;Be&&(Di=Be.getMaxCascadeForTile(_i.toUnwrapped())===0);let Xi=Ke.calculatePosMatrix(_i.toUnwrapped(),Ke.worldSize),_n=oi.modelTraits,ni=[];for(let cn of oi.getNodesInfo()){if(cn.hiddenByReplacement||!cn.node.meshes)continue;let kn=cn.node,mn=0;me.terrain&&kn.elevation&&(mn=kn.elevation*me.terrain.exaggeration());let Ni=cn.evaluatedScale;if(Ni[0]<=1&&Ni[1]<=1&&Ni[2]<=1&&(()=>{let vt=cn.aabb;return Vt.min=[...vt.min],Vt.max=[...vt.max],Vt.min[2]+=mn,Vt.max[2]+=mn,r._.transformMat4(Vt.min,Vt.min,Xi),r._.transformMat4(Vt.max,Vt.max,Xi),Vt})().intersects(kt)===0)continue;let li=[...Xi],zn=kn.anchor?kn.anchor[0]:0,$n=kn.anchor?kn.anchor[1]:0;r.ad.translate(li,li,[zn*(Ni[0]-1),$n*(Ni[1]-1),mn]),r._.exactEquals(Ni,r.cj)||r.ad.scale(li,li,Ni);let bn=r.ad.multiply([],li,kn.matrix),Ht=r.ad.multiply([],Ke.expandedFarZProjMatrix,bn),_r=r.ad.multiply([],Ke.expandedFarZProjMatrix,li),ua=r.aA.transformMat4([],[zn,$n,mn,1],Ht)[2];kn.hidden=!1;let un=Ct;ft||(dr&&(un*=Qa(li,Ke,cn.aabb,jt)),un*=Ql(pr,ua)),un!==0?ni.push({nodeInfo:cn,depth:ua,opacity:un,wvpForNode:Ht,wvpForTile:_r,nodeModelMatrix:bn,tileModelMatrix:li}):kn.hidden=!0}ft||ni.sort((cn,kn)=>!dr||cn.opacity===1&&kn.opacity===1?cn.depth<kn.depth?-1:1:cn.opacity===1?-1:kn.opacity===1?1:cn.depth>kn.depth?-1:1);for(let cn of ni){let kn=cn.nodeInfo,mn=kn.node,Ni=r.ad.multiply([],bt,cn.tileModelMatrix);r.ad.multiply(Ni,xt,Ni);let li=r.ad.invert([],Ni);r.ad.transpose(li,li),r.ad.scale(li,li,Fc),Ni=r.ad.multiply(Ni,Ni,mn.matrix);let zn=me.renderPass==="light-beam",$n=_n&r.cl.HasMapboxMeshFeatures,bn=$n?0:kn.evaluatedRMEA[0][2];for(let Ht=0;Ht<mn.meshes.length;++Ht){let _r=mn.meshes[Ht],ua=Ht===mn.lightMeshIndex,un=cn.wvpForNode;if(ua){if(!zn&&!me.terrain&&me.shadowRenderer){me.currentLayer<me.firstLightBeamLayer&&(me.firstLightBeamLayer=me.currentLayer);continue}un=cn.wvpForTile}else if(zn)continue;let vt={defines:[]},Ll=[];if(Bu(vt.defines,Ll,_r,me,Oe.lut),$n||vt.defines.push("DIFFUSE_SHADED"),Di&&vt.defines.push("SHADOWS_SINGLE_CASCADE"),Cr&&(ft?Cr.numRenderedVerticesInShadowPass+=_r.vertexArray.length:Cr.numRenderedVerticesInTransparentPass+=_r.vertexArray.length),ft){os(_r,cn.nodeModelMatrix,me,Oe);continue}let Xo=null;if(Fe){let Hh=Lh(cn.nodeModelMatrix,me.transform);if(Xo=new Float32Array(Hh),Ke.projection.name!=="globe"){let Wh=_r.aabb.min,Yu=_r.aabb.max,[pu,Ku]=Fe.getOpacityForBounds(Hh,Wh[0],Wh[1],Yu[0],Yu[1]);vt.overrideFog=pu>=ln||Ku>=ln}}let Is=_r.material,Mo;Is.occlusionTexture&&Is.occlusionTexture.offsetScale&&(Mo=Is.occlusionTexture.offsetScale,vt.defines.push("OCCLUSION_TEXTURE_TRANSFORM")),!ft&&Be&&(Be.useNormalOffset=!!_r.normalBuffer);let qs=me.getOrCreateProgram("model",vt);!ft&&Be&&Be.setupShadowsFromMatrix(cn.tileModelMatrix,qs,Be.useNormalOffset),me.uploadCommonUniforms(Je,qs,null,Xo);let Bc=Is.pbrMetallicRoughness;Bc.metallicFactor=.9,Bc.roughnessFactor=.5;let Ol=Zl(new Float32Array(un),new Float32Array(Ni),new Float32Array(li),new Float32Array(mn.matrix),me,cn.opacity,Bc.baseColorFactor.toRenderColor(null),Is.emissiveFactor,Bc.metallicFactor,Bc.roughnessFactor,Is,bn,Oe,[0,0,0],Mo);!ua&&(kn.hasTranslucentParts||cn.opacity<1)&&qs.draw(me,Je.gl.TRIANGLES,Gt,r.ag.disabled,r.a.disabled,r.af.backCCW,Ol,Oe.id,_r.vertexBuffer,_r.indexBuffer,_r.segments,Oe.paint,me.transform.zoom,void 0,Ll),qs.draw(me,Je.gl.TRIANGLES,ua?qt:Gt,r.ag.disabled,ua||cn.opacity<1||kn.hasTranslucentParts?r.a.alphaBlended:r.a.unblended,r.af.backCCW,Ol,Oe.id,_r.vertexBuffer,_r.indexBuffer,_r.segments,Oe.paint,me.transform.zoom,void 0,Ll)}}}}()}(m,s,d,g),void F();let V=O.getModels(),X=[],ie=m.transform.getFreeCameraOptions().position,ae=r._.scale([],[ie.x,ie.y,ie.z],m.transform.worldSize);r._.negate(ae,ae);let ue=[],de=[],fe=0;for(let me of V){let Pe=d.paint.get("model-rotation").constantOr(null),Oe=d.paint.get("model-scale").constantOr(null),Ne=d.paint.get("model-translation").constantOr(null);me.computeModelMatrix(m,Pe,Oe,Ne,!0,!0,!1);let Je=r.ad.identity([]),Ke=r.cg(me.position.lat,m.transform.zoom),Fe=r.ad.fromScaling([],[1,1,1/Ke]);r.ad.translate(Je,Je,ae),X.push({zScaleMatrix:Fe,negCameraPosMatrix:Je});for(let Be of me.nodes)Ja(m.transform,Be,me.matrix,m.transform.expandedFarZProjMatrix,fe,ue,de);fe++}if(ue.sort((me,Pe)=>Pe.depth-me.depth),m.renderPass!=="shadow"){if(x===1)for(let me of de)Rc(me,m,d,X[me.modelIndex],r.ag.disabled,m.colorModeForRenderPass());else{for(let me of de)Rc(me,m,d,X[me.modelIndex],r.ag.disabled,r.a.disabled);for(let me of de)Rc(me,m,d,X[me.modelIndex],m.stencilModeFor3D(),m.colorModeForRenderPass());m.resetStencilClippingMasks()}for(let me of ue)Rc(me,m,d,X[me.modelIndex],r.ag.disabled,m.colorModeForRenderPass());F()}else{for(let me of de)os(me.mesh,me.nodeModelMatrix,m,d);for(let me of ue)os(me.mesh,me.nodeModelMatrix,m,d);F()}}},Bm={model:function(m,s,d){let g=s.getSource();if(!g.loaded())return;if(g.type==="vector"||g.type==="geojson")return void(d.modelManager&&d.modelManager.upload(d,g.type==="vector"?m.scope:""));if(g.type==="batched-model")return;let x=g.getModels();for(let b of x)b.upload(d.context)},raster:function(m,s,d){let g=s.getSource();if(!(g instanceof Fi&&g.loaded()))return;let x=m.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!x)return;let b=m.paint.get("raster-array-band")||g.getInitialBand(x);if(b==null)return;let S=s.getIds().map(C=>s.getTileByID(C));for(let C of S)C.updateNeeded(x,b)&&g.prepareTile(C,x,b)},"raster-particle":function(m,s,d){let g=s.getSource();if(!(g instanceof Fi&&g.loaded()))return;let x=m.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!x)return;let b=m.paint.get("raster-particle-array-band")||g.getInitialBand(x);if(b==null)return;let S=s.getIds().map(C=>s.getTileByID(C));for(let C of S)C.updateNeeded(x,b)&&g.prepareTile(C,x,b)}};class zm{constructor(s,d,g,x){this.context=new an(s,d),this.occlusionBuffers=new lu(this.context),this.transform=g,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=x,this._timeStamp=r.e.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};let b=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(let S of b)this._debugParams.enabledLayers[S]=!0;x.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),x.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),x.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),x.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),x.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(let S of b)x.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],S);this.symbolParams=new Ui(x),this.setup(),this.numSublayers=r.bv.maxUnderzooming+r.bv.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new r.co,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new eu(this),this._wireframeDebugCache=new Ed,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[]}updateTerrain(s,d){let g=!!s&&!!s.terrain&&this.transform.projection.supportsTerrain;if(!(g||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Io(this,s));let x=this._terrain;this.transform.elevation=g?x:null,x.update(s,this.transform,d),this.transform.elevation&&!x.enabled&&(this.transform.elevation=null)}_updateFog(s){let d=s.fog;if(!d||this.transform.projection.name==="globe"||d.getOpacity(this.transform.pitch)<1||d.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);let[g,x]=d.getFovAdjustedRange(this.transform._fov);if(g>x)return void(this.transform.fogCullDistSq=null);let b=g+.78*(x-g);this.transform.fogCullDistSq=b*b}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(s){s&&!this._terrain&&(this._terrain=new Io(this,this.style)),this._forceTerrainMode=s}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(s,d){if(this.width=s*r.e.devicePixelRatio,this.height=d*r.e.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let g of this.style.order)this.style._mergedLayers[g].resize()}setup(){let s=this.context,d=new r.bt;d.emplaceBack(0,0),d.emplaceBack(r.a3,0),d.emplaceBack(0,r.a3),d.emplaceBack(r.a3,r.a3),this.tileExtentBuffer=s.createVertexBuffer(d,r.br.members),this.tileExtentSegments=r.b.simpleSegment(0,0,4,2);let g=new r.bt;g.emplaceBack(0,0),g.emplaceBack(r.a3,0),g.emplaceBack(0,r.a3),g.emplaceBack(r.a3,r.a3),this.debugBuffer=s.createVertexBuffer(g,r.br.members),this.debugSegments=r.b.simpleSegment(0,0,4,5);let x=new r.bt;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(x,r.br.members),this.viewportSegments=r.b.simpleSegment(0,0,4,2);let b=new r.cp;b.emplaceBack(0,0,0,0),b.emplaceBack(r.a3,0,r.a3,0),b.emplaceBack(0,r.a3,0,r.a3),b.emplaceBack(r.a3,r.a3,r.a3,r.a3),this.mercatorBoundsBuffer=s.createVertexBuffer(b,r.cq.members),this.mercatorBoundsSegments=r.b.simpleSegment(0,0,4,2);let S=new r.bu;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(S);let C=new r.cr;for(let O of[0,1,3,2,0])C.emplaceBack(O);this.debugIndexBuffer=s.createIndexBuffer(C),this.emptyTexture=new r.T(s,new r.i({width:1,height:1},Uint8Array.of(0,0,0,0)),s.gl.RGBA),this.identityMat=r.ad.create();let F=this.context.gl;this.stencilClearMode=new r.ag({func:F.ALWAYS,mask:0},0,255,F.ZERO,F.ZERO,F.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(s){return s._makeTileBoundsBuffers(this.context,this.transform.projection),s._tileBoundsBuffer?{tileBoundsBuffer:s._tileBoundsBuffer,tileBoundsIndexBuffer:s._tileBoundsIndexBuffer,tileBoundsSegments:s._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){let s=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,s.TRIANGLES,r.ae.disabled,this.stencilClearMode,r.a.disabled,r.af.disabled,Yr(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(s,d,g){if(!d||this.currentStencilSource===d.id||!s.isTileClipped()||!g||g.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let C=!1;for(let F of g)if(this._tileClippingMaskIDs[F.key]===void 0){C=!0;break}if(!C)return}this.currentStencilSource=d.id;let x=this.context,b=x.gl;this.nextStencilID+g.length>256&&this.clearStencil(),x.setColorMode(r.a.disabled),x.setDepthMode(r.ae.disabled);let S=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(let C of g){let F=d.getTile(C),O=this._tileClippingMaskIDs[C.key]=this.nextStencilID++,{tileBoundsBuffer:V,tileBoundsIndexBuffer:X,tileBoundsSegments:ie}=this.getTileBoundsBuffers(F);S.draw(this,b.TRIANGLES,r.ae.disabled,new r.ag({func:b.ALWAYS,mask:0},O,255,b.KEEP,b.KEEP,b.REPLACE),r.a.disabled,r.af.disabled,Yr(C.projMatrix),"$clipping",V,X,ie)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let s=this.nextStencilID++,d=this.context.gl;return new r.ag({func:d.NOTEQUAL,mask:255},s,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(s){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(s);let d=this.context.gl;return new r.ag({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(s){let d=this.context.gl,g=s.sort((S,C)=>C.overscaledZ-S.overscaledZ),x=g[g.length-1].overscaledZ,b=g[0].overscaledZ-x+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();let S={};for(let C=0;C<b;C++)S[C+x]=new r.ag({func:d.GEQUAL,mask:255},C+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=b,[S,g]}return[{[x]:r.ag.disabled},g]}colorModeForRenderPass(){let s=this.context.gl;return this._showOverdrawInspector?new r.a([s.CONSTANT_COLOR,s.ONE,s.CONSTANT_COLOR,s.ONE],new r.C(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?r.a.unblended:r.a.alphaBlended}colorModeForDrapableLayerRenderPass(s){let d=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new r.a([d.ONE,d.ONE_MINUS_SRC_ALPHA,d.CONSTANT_ALPHA,d.ONE_MINUS_SRC_ALPHA],new r.C(0,0,0,s===void 0?0:s),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(s,d,g,x=!1){if(this.depthOcclusion)return new r.ae(this.context.gl.GREATER,r.ae.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!x)return r.ae.disabled;let b=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new r.ae(g||this.context.gl.LEQUAL,d,[b,b])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((s,d)=>s+d/this._fpsHistory.length,0))}render(s,d){let g=r.e.now();this._dt=g-this._timeStamp,this._timeStamp=g,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=s.map.repaint,this.style=s,this.options=d;let x=this.style._mergedLayers,b=this.style.order.filter(Be=>{let je=x[Be];return!(je.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[je.type]}),S=b.map(Be=>x[Be]),C=this.style._mergedSourceCaches;this.imageManager=s.imageManager,this.modelManager=s.modelManager,this.symbolFadeChange=s.placement.symbolFadeChange(r.e.now()),this.imageManager.beginFrame();let F=0,O=!1;for(let Be in C){let je=C[Be];je.used&&(je.prepare(this.context),je.getSource().usedInConflation&&++F)}let V=!1;for(let Be of S)Be.isHidden(this.transform.zoom)||(Be.type==="clip"&&(V=!0),this.prepareLayer(Be));let X={},ie={},ae={},ue={},de={};for(let Be in C){let je=C[Be];X[Be]=je.getVisibleCoordinates(),ie[Be]=X[Be].slice().reverse(),ae[Be]=je.getVisibleCoordinates(!0).reverse(),ue[Be]=je.getShadowCasterCoordinates(),de[Be]=je.sortCoordinatesByDistance(X[Be])}let fe=Be=>{let je=this.style.getLayerSourceCache(Be);return je&&je.used?je.getSource():null};if(F||V){let Be=[],je=[],at=0;for(let xt of S)this.isSourceForClippingOrConflation(xt,fe(xt))&&(Be.push(xt),je.push(at)),at++;if(Be&&(V||Be.length>1)){let xt=[];for(let qe=0;qe<Be.length;qe++){let bt=Be[qe],Ct=je[qe],Gt=this.style.getLayerSourceCache(bt);if(!Gt||!Gt.used||!Gt.getSource().usedInConflation&&bt.type!=="clip")continue;let qt=1/0,Vt=r.cu.None;if(bt.type==="clip"){qt=Ct;for(let ft of bt.layout.get("clip-layer-types"))Vt|=ft==="model"?r.cu.Model:ft==="symbol"?r.cu.Symbol:r.cu.FillExtrusion}xt.push({layer:bt.fqid,cache:Gt,order:qt,clipMask:Vt})}this.replacementSource.setSources(xt),O=!0}}O||this.replacementSource.clear(),this.conflationActive=O,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let Be=0;Be<S.length;Be++){let je=S[Be],at=je.cutoffRange();if(this.longestCutoffRange=Math.max(at,this.longestCutoffRange),at>0){let xt=fe(je);xt&&(this.minCutoffZoom=Math.max(xt.minzoom,this.minCutoffZoom)),je.minzoom&&(this.minCutoffZoom=Math.max(je.minzoom,this.minCutoffZoom))}je.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=Be),this._lastOcclusionLayer=Be)}let me=this.style&&this.style.fog;me?(this._fogVisible=me.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=me.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(ae),this.opaquePassCutoff=0);let Pe=this._shadowRenderer;if(Pe){Pe.updateShadowParameters(this.transform,this.style.directionalLight);for(let Be in C)for(let je of X[Be]){let at={min:0,max:0};this.terrain&&(at=this.terrain.getMinMaxForTile(je)||at),Pe.addShadowReceiver(je.toUnwrapped(),at.min,at.max)}}if(this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new r.cs(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Dp(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!r.ct(this.context.gl))return;this.renderPass="offscreen";for(let Be of S){let je=s.getLayerSourceCache(Be);if(!Be.hasOffscreenPass()||Be.isHidden(this.transform.zoom))continue;let at=je?ie[je.id]:void 0;(Be.type==="custom"||Be.type==="raster"||Be.type==="raster-particle"||Be.isSky()||at&&at.length)&&this.renderLayer(this,je,Be,at)}this.depthRangeFor3D=[0,1-(S.length+2)*this.numSublayers*this.depthEpsilon];let Oe=this.terrain;Oe&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&Oe.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,ue)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let Ne=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Je=(()=>{if(d.showOverdrawInspector)return r.C.black;let Be=this.style.fog;if(Be&&this.transform.projection.supportsFog){let je=this.style.getLut(Be.scope);if(!Ne){let at=Be.properties.get("color").toRenderColor(je).toArray01();return new r.C(...at)}if(Ne){let at=Be.properties.get("space-color").toRenderColor(je).toArray01();return new r.C(...at)}}return r.C.transparent})();if(this.context.clear({color:Je,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ne&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=b.length-1;this.currentLayer>=0;this.currentLayer--){let Be=S[this.currentLayer],je=s.getLayerSourceCache(Be);if(Be.isSky())continue;let at=je?(Be.is3D()?de:ie)[je.id]:void 0;this._renderTileClippingMasks(Be,je,at),this.renderLayer(this,je,Be,at)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ne&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||r.a1(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<b.length;this.currentLayer++){let Be=S[this.currentLayer],je=s.getLayerSourceCache(Be);Be.isSky()&&this.renderLayer(this,je,Be,je?ie[je.id]:void 0)}function Ke(Be,je){let at;return je&&(at=(Be.type==="symbol"?ae:Be.is3D()?de:ie)[je.id]),at}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<b.length;){let Be=S[this.currentLayer];if(Be.type==="raster"){let je=s.getLayerSourceCache(Be);this.renderLayer(this,je,Be,Ke(Be,je))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Fe=0;for(Pe&&(Fe=Pe.getShadowCastingLayerCount());this.currentLayer<b.length;){let Be=S[this.currentLayer],je=s.getLayerSourceCache(Be);if(Be.isSky())++this.currentLayer;else if(Oe&&this.style.isLayerDraped(Be)){if(Be.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=Oe.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(Be.is3D()||this.terrain||this._renderTileClippingMasks(Be,je,je?X[je.id]:void 0),this.renderLayer(this,je,Be,Ke(Be,je)),!Oe&&Pe&&Fe>0&&Be.hasShadowPass()&&--Fe==0&&(Pe.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){let at=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=at;this.currentLayer++){let xt=S[this.currentLayer];if(!xt.hasLightBeamPass())continue;let qe=s.getLayerSourceCache(xt);this.renderLayer(this,qe,xt,qe?ie[qe.id]:void 0)}this.currentLayer=at,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){let at=this.currentLayer;this.depthOcclusion=!0;for(let xt of this.layersWithOcclusionOpacity){this.currentLayer=xt;let qe=S[this.currentLayer],bt=s.getLayerSourceCache(qe),Ct=bt?ie[bt.id]:void 0;qe.is3D()||this.terrain||this._renderTileClippingMasks(qe,bt,bt?X[bt.id]:void 0),this.renderLayer(this,bt,qe,Ct)}this.depthOcclusion=!1,this.currentLayer=at,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let Be=null;S.forEach(je=>{let at=s.getLayerSourceCache(je);at&&!je.isHidden(this.transform.zoom)&&at.getVisibleCoordinates().length&&(!Be||Be.getSource().maxzoom<at.getSource().maxzoom)&&(Be=at)}),Be&&this.options.showTileBoundaries&&qa.debug(this,Be,Be.getVisibleCoordinates(),r.C.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&qa.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new r.C(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(Be){let je=Be.transform.padding;Gi(Be,Be.transform.height-(je.top||0),3,ns),Gi(Be,je.bottom||0,3,Fh),$i(Be,je.left||0,3,Gs),$i(Be,Be.transform.width-(je.right||0),3,wf);let at=Be.transform.centerPoint;(function(xt,qe,bt,Ct){Po(xt,qe-1,bt-10,2,20,Ct),Po(xt,qe-10,bt-1,20,2,Ct)})(Be,at.x,Be.transform.height-at.y,Dc)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),O||(this.conflationActive=!1)}prepareLayer(s){this.gpuTimingStart(s);let{unsupportedLayers:d}=this.transform.projection,g=!d||!d.includes(s.type);if(Bm[s.type]&&(g||this.terrain&&s.type==="custom")){let x=this.style.getLayerSourceCache(s);Bm[s.type](s,x,this)}this.gpuTimingEnd()}renderLayer(s,d,g,x){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="sky"||g.type==="custom"||g.type==="model"||g.type==="raster"||g.type==="raster-particle"||x&&x.length)&&(this.id=g.id,this.gpuTimingStart(g),s.transform.projection.unsupportedLayers&&s.transform.projection.unsupportedLayers.includes(g.type)&&(!s.terrain||g.type!=="custom")||g.type==="clip"||qa[g.type](s,d,g,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(s){if(!this.options.gpuTiming)return;let d=this.context.extTimerQuery,g=this.context.gl,x=this.gpuTimers[s.id];x||(x=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:g.createQuery()}),x.calls++,g.beginQuery(d.TIME_ELAPSED_EXT,x.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){let s=this.context.extTimerQuery,d=this.context.gl,g=d.createQuery();this.deferredRenderGpuTimeQueries.push(g),d.beginQuery(s.TIME_ELAPSED_EXT,g)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){let s=this.gpuTimers;return this.gpuTimers={},s}collectDeferredRenderGpuQueries(){let s=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],s}queryGpuTimers(s){let d={};for(let g in s){let x=s[g],b=this.context.extTimerQuery,S=b.getQueryParameter(x.query,this.context.gl.QUERY_RESULT)/1e6;b.deleteQueryEXT(x.query),d[g]=S}return d}queryGpuTimeDeferredRender(s){if(!this.options.gpuTimingDeferredRender)return 0;let d=this.context.extTimerQuery,g=this.context.gl,x=0;for(let b of s)x+=d.getQueryParameter(b,g.QUERY_RESULT)/1e6,d.deleteQueryEXT(b);return x}translatePosMatrix(s,d,g,x,b){if(!g[0]&&!g[1])return s;let S=b?x==="map"?this.transform.angle:0:x==="viewport"?-this.transform.angle:0;if(S){let O=Math.sin(S),V=Math.cos(S);g=[g[0]*V-g[1]*O,g[0]*O+g[1]*V]}let C=[b?g[0]:r.bB(d,g[0],this.transform.zoom),b?g[1]:r.bB(d,g[1],this.transform.zoom),0],F=new Float32Array(16);return r.ad.translate(F,s,C),F}saveTileTexture(s){let d=s.size[0],g=this._tileTextures[d];g?g.push(s):this._tileTextures[d]=[s]}getTileTexture(s){let d=this._tileTextures[s];return d&&d.length>0?d.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(s,d,g){let x=g===void 0?this.terrain&&this.terrain.renderingToTexture:g,b=[];return this.style&&this.style.enable3dLights()&&(s==="globeRaster"||s==="terrainRaster"?(b.push("LIGHTING_3D_MODE"),b.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):x||b.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||b.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?b.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):b.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(b.push("TERRAIN"),this.linearFloatFilteringSupported()&&b.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&b.push("GLOBE"),!this._fogVisible||x||d!==void 0&&!d||b.push("FOG","FOG_DITHERING"),x&&b.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&b.push("OVERDRAW_INSPECTOR"),b}getOrCreateProgram(s,d){this.cache=this.cache||{};let g=d&&d.defines||[],x=d&&d.config,b=this.currentGlobalDefines(s,d&&d.overrideFog,d&&d.overrideRtt).concat(g),S=zs.cacheKey(yd[s],s,b,x);return this.cache[S]||(this.cache[S]=new zs(this.context,s,yd[s],x,Ml[s],b)),this.cache[S]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new r.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(s,d){if(this.style.enable3dLights()){let g=this.style.directionalLight,x=this.style.ambientLight;if(g&&x){let b=((S,C,F)=>{let O=S.properties.get("direction"),V=S.properties.get("color").toRenderColor(F.getLut(S.scope)).toArray01(),X=S.properties.get("intensity"),ie=C.properties.get("color").toRenderColor(F.getLut(C.scope)).toArray01(),ae=C.properties.get("intensity"),ue=[O.x,O.y,O.z],de=r.bA(ie,ae),fe=r.bA(V,X);return{u_lighting_ambient_color:de,u_lighting_directional_dir:ue,u_lighting_directional_color:fe,u_ground_radiance:la(ue,fe,de)}})(g,x,this.style);d.setLightsUniformValues(s,b)}}}uploadCommonUniforms(s,d,g,x,b){if(this.uploadCommonLightUniforms(s,d),this.terrain&&this.terrain.renderingToTexture)return;let S=this.style.fog;if(S){let C=S.getOpacity(this.transform.pitch),F=((O,V,X,ie,ae,ue,de,fe,me,Pe,Oe,Ne)=>{let Je=O.transform,Ke=V.properties.get("color").toRenderColor(O.style.getLut(V.scope)).toArray01();Ke[3]=ie;let Fe=O.frameCounter/1e3%1,[Be,je]=V.properties.get("vertical-range");return{u_fog_matrix:X?Je.calculateFogTileMatrix(X):Ne||O.identityMat,u_fog_range:V.getFovAdjustedRange(Je._fov),u_fog_color:Ke,u_fog_horizon_blend:V.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Be,je),je],u_fog_temporal_offset:Fe,u_frustum_tl:ae,u_frustum_tr:ue,u_frustum_br:de,u_frustum_bl:fe,u_globe_pos:me,u_globe_radius:Pe,u_viewport:Oe,u_globe_transition:r.a1(Je.zoom),u_is_globe:+(Je.projection.name==="globe")}})(this,S,g,C,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*r.e.devicePixelRatio,this.transform.height*r.e.devicePixelRatio],x);d.setFogUniformValues(s,F)}b&&d.setCutoffUniformValues(s,b.uniformValues)}setTileLoadedFlag(s){this.tileLoaded=s}saveCanvasCopy(){let s=this.canvasCopy();s&&(this.frameCopies.push(s),this.tileLoaded=!1)}canvasCopy(){let s=this.context.gl,d=s.createTexture();return s.bindTexture(s.TEXTURE_2D,d),s.copyTexImage2D(s.TEXTURE_2D,0,s.RGBA,0,0,s.drawingBufferWidth,s.drawingBufferHeight,0),d}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;let s=this.style&&this.style.fog;return!!s&&s.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){let s=this._backgroundTiles,d=this._backgroundTiles={},g=this.transform.coveringTiles({tileSize:512});for(let x of g)d[x.key]=s[x.key]||new r.by(x,512,this.transform.tileZoom,this);return d}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(s,d){return!(!s.is3D()||s.minzoom&&s.minzoom>this.transform.zoom||(this.style._clipLayerIndices.length||s.sourceLayer!=="building")&&s.type!=="clip"&&(!d||d.type!=="batched-model"))}isTileAffectedByFog(s){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let d=this._cachedTileFogOpacities[s.key];return d||(this._cachedTileFogOpacities[s.key]=d=this.style.fog.getOpacityForTile(s)),d[0]>=ln||d[1]>=ln}}class Lo{constructor(s,d,g,x){this.screenBounds=s,this.cameraPoint=d,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=g,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,x)}static createFromScreenPoints(s,d){let g,x;if(s instanceof r.P||typeof s[0]=="number"){let b=r.P.convert(s);g=[b],x=d.isPointAboveHorizon(b)}else{let b=r.P.convert(s[0]),S=r.P.convert(s[1]);g=[b,S],x=r.cv(b,S).every(C=>d.isPointAboveHorizon(C))}return new Lo(g,d.getCameraPoint(),x,d)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(s){return r.cv(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],s)}bufferedCameraGeometry(s){let d=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new r.P(1,1)):this.screenBounds[1],x=r.cv(d,g,0,!1);return this.cameraPoint.y>g.y&&(this.cameraPoint.x>d.x&&this.cameraPoint.x<g.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=g.x?x[2]=this.cameraPoint:this.cameraPoint.x<=d.x&&(x[3]=this.cameraPoint)),r.cw(x,s)}bufferedCameraGeometryGlobe(s){let d=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new r.P(1,1)):this.screenBounds[1],x=r.cv(d,g,s),b=this.cameraPoint.clone();switch(3*((b.y>d.y)+(b.y>g.y))+((b.x>d.x)+(b.x>g.x))){case 0:x[0]=b,x[4]=b.clone();break;case 1:x.splice(1,0,b);break;case 2:x[1]=b;break;case 3:x.splice(4,0,b);break;case 5:x.splice(2,0,b);break;case 6:x[3]=b;break;case 7:x.splice(3,0,b);break;case 8:x[2]=b}return x}containsTile(s,d,g,x=0){let b=s.queryPadding/d._pixelsPerMercatorPixel+1,S=g?this._bufferedCameraMercator(b,d):this._bufferedScreenMercator(b,d),C=s.tileID.wrap+(S.unwrapped?x:0),F=S.polygon.map(fe=>r.cx(s.tileTransform,fe,C));if(!r.cy(F,0,0,r.a3,r.a3))return;C=s.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);let O=this.screenGeometryMercator.polygon.map(fe=>r.cz(s.tileTransform,fe,C)),V=O.map(fe=>new r.P(fe[0],fe[1])),X=d.getFreeCameraOptions().position||new r.Y(0,0,0),ie=r.cz(s.tileTransform,X,C),ae=O.map(fe=>{let me=r._.sub(fe,fe,ie);return r._.normalize(me,me),new r.aT(ie,me)}),ue=r.bB(s,1,d.zoom)*d._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:V,tilespaceRays:ae,bufferedTilespaceGeometry:F,bufferedTilespaceBounds:(de=r.cA(F),de.min.x=r.at(de.min.x,0,r.a3),de.min.y=r.at(de.min.y,0,r.a3),de.max.x=r.at(de.max.x,0,r.a3),de.max.y=r.at(de.max.y,0,r.a3),de),tile:s,tileID:s.tileID,pixelToTileUnitsFactor:ue};var de}_bufferedScreenMercator(s,d){let g=Sf(s);if(this._screenRaycastCache[g])return this._screenRaycastCache[g];{let x;return x=d.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(s),d):{polygon:this.bufferedScreenGeometry(s).map(b=>d.pointCoordinate3D(b)),unwrapped:!0},this._screenRaycastCache[g]=x,x}}_bufferedCameraMercator(s,d){let g=Sf(s);if(this._cameraRaycastCache[g])return this._cameraRaycastCache[g];{let x;return x=d.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(s),d):{polygon:this.bufferedCameraGeometry(s).map(b=>d.pointCoordinate3D(b)),unwrapped:!0},this._cameraRaycastCache[g]=x,x}}_projectAndResample(s,d){let g=function(b,S){let C=r.ad.multiply([],S.pixelMatrix,S.globeMatrix),F=[0,-r.cD,0,1],O=[0,r.cD,0,1],V=[0,0,0,1];r.aA.transformMat4(F,F,C),r.aA.transformMat4(O,O,C),r.aA.transformMat4(V,V,C);let X=new r.P(F[0]/F[3],F[1]/F[3]),ie=new r.P(O[0]/O[3],O[1]/O[3]),ae=r.cB(b,X)&&F[3]<V[3],ue=r.cB(b,ie)&&O[3]<V[3];if(!ae&&!ue)return null;let de=function(Fe,Be,je){for(let at=1;at<Fe.length;at++){let xt=Pc(Be.pointCoordinate3D(Fe[at-1]).x),qe=Pc(Be.pointCoordinate3D(Fe[at]).x);if(je<0){if(xt<qe)return{idx:at,t:-xt/(qe-1-xt)}}else if(qe<xt)return{idx:at,t:(1-xt)/(qe+1-xt)}}return null}(b,S,ae?-1:1);if(!de)return null;let{idx:fe,t:me}=de,Pe=fe>1?Tf(b.slice(0,fe),S):[],Oe=fe<b.length?Tf(b.slice(fe),S):[];Pe=Pe.map(Fe=>new r.P(Pc(Fe.x),Fe.y)),Oe=Oe.map(Fe=>new r.P(Pc(Fe.x),Fe.y));let Ne=[...Pe];Ne.length===0&&Ne.push(Oe[Oe.length-1]);let Je=r.a2(Ne[Ne.length-1].y,(Oe.length===0?Pe[0]:Oe[0]).y,me),Ke;return Ke=ae?[new r.P(0,Je),new r.P(0,0),new r.P(1,0),new r.P(1,Je)]:[new r.P(1,Je),new r.P(1,1),new r.P(0,1),new r.P(0,Je)],Ne.push(...Ke),Oe.length===0?Ne.push(Pe[0]):Ne.push(...Oe),{polygon:Ne.map(Fe=>new r.Y(Fe.x,Fe.y)),unwrapped:!1}}(s,d);if(g)return g;let x=function(b,S){let C=!1,F=-1/0,O=0;for(let X=0;X<b.length-1;X++)b[X].x>F&&(F=b[X].x,O=X);for(let X=0;X<b.length-1;X++){let ie=(O+X)%(b.length-1),ae=b[ie],ue=b[ie+1];Math.abs(ae.x-ue.x)>.5&&(ae.x<ue.x?(ae.x+=1,ie===0&&(b[b.length-1].x+=1)):(ue.x+=1,ie+1===b.length-1&&(b[0].x+=1)),C=!0)}let V=r.aj(S.center.lng);return C&&V<Math.abs(V-1)&&b.forEach(X=>{X.x-=1}),{polygon:b,unwrapped:C}}(Tf(s,d).map(b=>new r.P(Pc(b.x),b.y)),d);return{polygon:x.polygon.map(b=>new r.Y(b.x,b.y)),unwrapped:x.unwrapped}}}function Tf(m,s){return r.cC(m,d=>{let g=s.pointCoordinate3D(d);d.x=g.x,d.y=g.y},1/256)}function Pc(m){return m<0?1+m%1:m%1}function Sf(m){return 100*m|0}function yg(m,s){let d=r.ad.identity([]);return r.ad.scale(d,d,[.5*m.width,.5*-m.height,1]),r.ad.translate(d,d,[1,-1,0]),r.ad.multiply(d,d,m.calculateProjMatrix(s.toUnwrapped())),Float32Array.from(d)}function Ef(m,s,d,g,x,b,S,C=!1){let F=m.tilesIn(g,S,C);F.sort(ec);let O=[];for(let X of F)O.push({wrappedTileID:X.tile.tileID.wrapped().key,queryResults:X.tile.queryRenderedFeatures(s,d,m._state,X,x,b,yg(m.transform,X.tile.tileID),C)});let V=function(X){let ie={},ae={};for(let ue of X){let de=ue.queryResults,fe=ue.wrappedTileID,me=ae[fe]=ae[fe]||{};for(let Pe in de){let Oe=de[Pe],Ne=me[Pe]=me[Pe]||{},Je=ie[Pe]=ie[Pe]||[];for(let Ke of Oe)Ne[Ke.featureIndex]||(Ne[Ke.featureIndex]=!0,Je.push(Ke))}}return ie}(O);for(let X in V)V[X].forEach(ie=>{let ae=ie.feature,ue=ae.layer;ue&&ue.type!=="background"&&ue.type!=="sky"&&ue.type!=="slot"&&(ae.source=ue.source,ue["source-layer"]&&(ae.sourceLayer=ue["source-layer"]),ae.state=ae.id!==void 0?m.getFeatureState(ue["source-layer"],ae.id):{})});return V}function cu(m,s){let d=m.getRenderableIds().map(b=>m.getTileByID(b)),g=[],x={};for(let b=0;b<d.length;b++){let S=d[b],C=S.tileID.canonical.key;x[C]||(x[C]=!0,S.querySourceFeatures(g,s))}return g}function ec(m,s){let d=m.tileID,g=s.tileID;return d.overscaledZ-g.overscaledZ||d.canonical.y-g.canonical.y||d.wrap-g.wrap||d.canonical.x-g.canonical.x}class Rp{constructor(s){this.style=s,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];let s=!1,d=!1;for(let g in this.style._mergedLayers){let x=this.style._mergedLayers[g];if(x.type==="fill-extrusion")this.layers.push({layer:x,visible:s,visibilityChanged:d});else if(x.type==="model"){let b=this.style.getLayerSource(x);b&&b.type==="batched-model"&&this.layers.push({layer:x,visible:s,visibilityChanged:d})}}}onNewFrame(s){this.layersGotHidden=!1;for(let d of this.layers){let g=d.layer,x=!1;g.type==="fill-extrusion"?x=!g.isHidden(s)&&g.paint.get("fill-extrusion-opacity")>0:g.type==="model"&&(x=!g.isHidden(s)&&g.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!x&&d.visible,d.visible=x}}updateZOffset(s,d){this.currentBuildingBuckets=[];for(let x of this.layers){let b=x.layer,S=this.style.getLayerSourceCache(b),C=1;b.type==="fill-extrusion"&&(C=x.visible?b.paint.get("fill-extrusion-vertical-scale"):0);let F=S?S.getTile(d):null;if(!F&&S&&d.canonical.z>S.getSource().minzoom){let O=d.scaledTo(Math.min(S.getSource().maxzoom,d.overscaledZ-1));for(;O.overscaledZ>=S.getSource().minzoom&&(F=S.getTile(O),!F&&O.overscaledZ!==0);)O=O.scaledTo(O.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:F?F.getBucket(b):null,tileID:F?F.tileID:d,verticalScale:C})}s.hasAnyZOffset=!1;let g=!1;for(let x=0;x<s.symbolInstances.length;x++){let b=s.symbolInstances.get(x),S=b.zOffset,C=this._getHeightAtTileOffset(d,b.tileAnchorX,b.tileAnchorY);b.zOffset=C!==Number.NEGATIVE_INFINITY?C:S,g||S===b.zOffset||(g=!0),s.hasAnyZOffset||b.zOffset===0||(s.hasAnyZOffset=!0)}g&&(s.zOffsetBuffersNeedUpload=!0,s.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(s,d,g,x){let b=d,S=g;if(s.canonical.z!==x.canonical.z){let C=x.canonical,F=1/(1<<s.canonical.z-C.z);b=(d+s.canonical.x*r.a3)*F-C.x*r.a3|0,S=(g+s.canonical.y*r.a3)*F-C.y*r.a3|0}return{tileX:b,tileY:S}}_getHeightAtTileOffset(s,d,g){let x,b;for(let S=0;S<this.layers.length;++S){if(this.layers[S].layer.type!=="fill-extrusion")continue;let{bucket:C,tileID:F,verticalScale:O}=this.currentBuildingBuckets[S];if(!C)continue;let{tileX:V,tileY:X}=this._mapCoordToOverlappingTile(s,d,g,F),ie=C.getHeightAtTileCoord(V,X);ie&&ie.height!==void 0&&(ie.hidden?x=ie.height:b=Math.max(ie.height*O,b||0))}if(b!==void 0)return b;for(let S=0;S<this.layers.length;++S){let C=this.layers[S];if(C.layer.type!=="model"||!C.visible)continue;let{bucket:F,tileID:O}=this.currentBuildingBuckets[S];if(!F)continue;let{tileX:V,tileY:X}=this._mapCoordToOverlappingTile(s,d,g,O),ie=F.getHeightAtTileCoord(V,X);if(ie&&!ie.hidden)return ie.height===void 0&&x!==void 0?Math.min(ie.maxHeight,x)*ie.verticalScale:ie.height?ie.height*ie.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function zu(m,s){let d={};for(let g in m)g!=="ref"&&(d[g]=m[g]);return r.cE.forEach(g=>{g in s&&(d[g]=s[g])}),d}function Fp(m){m=m.slice();let s=Object.create(null);for(let d=0;d<m.length;d++)s[m[d].id]=m[d];for(let d=0;d<m.length;d++)"ref"in m[d]&&(m[d]=zu(m[d],s[m[d].ref]));return m}let zi={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function Lc(m,s,d){d.push({command:zi.addSource,args:[m,s[m]]})}function jm(m,s,d){s.push({command:zi.removeSource,args:[m]}),d[m]=!0}function xg(m,s,d,g){jm(m,d,g),Lc(m,s,d)}function bg(m,s,d){let g;for(g in m[d])if(m[d].hasOwnProperty(g)&&g!=="data"&&!_(m[d][g],s[d][g]))return!1;for(g in s[d])if(s[d].hasOwnProperty(g)&&g!=="data"&&!_(m[d][g],s[d][g]))return!1;return!0}function Ad(m,s,d,g,x,b){let S;for(S in s=s||{},m=m||{})m.hasOwnProperty(S)&&(_(m[S],s[S])||d.push({command:b,args:[g,S,s[S],x]}));for(S in s)s.hasOwnProperty(S)&&!m.hasOwnProperty(S)&&(_(m[S],s[S])||d.push({command:b,args:[g,S,s[S],x]}))}function Af(m){return m.id}function ju(m,s){return m[s.id]=s,m}class Cd{constructor(s,d){this.reset(s,d)}reset(s,d){this.points=s||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(this.points.length===1)return this.points[0];s=r.at(s,0,1);let d=1,g=this._distances[d],x=s*this.paddedLength+this.padding;for(;g<x&&d<this._distances.length;)g=this._distances[++d];let b=d-1,S=this._distances[b],C=g-S,F=C>0?(x-S)/C:0;return this.points[b].mult(1-F).add(this.points[d].mult(F))}}class Pp{constructor(s,d,g){let x=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(s/g),this.yCellCount=Math.ceil(d/g);for(let S=0;S<this.xCellCount*this.yCellCount;S++)x.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=d,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,d,g,x,b){this._forEachCell(d,g,x,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(d),this.bboxes.push(g),this.bboxes.push(x),this.bboxes.push(b)}insertCircle(s,d,g,x){this._forEachCell(d-x,g-x,d+x,g+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(d),this.circles.push(g),this.circles.push(x)}_insertBoxCell(s,d,g,x,b,S){this.boxCells[b].push(S)}_insertCircleCell(s,d,g,x,b,S){this.circleCells[b].push(S)}_query(s,d,g,x,b,S){if(g<0||s>this.width||x<0||d>this.height)return!b&&[];let C=[];if(s<=0&&d<=0&&this.width<=g&&this.height<=x){if(b)return!0;for(let F=0;F<this.boxKeys.length;F++)C.push({key:this.boxKeys[F],x1:this.bboxes[4*F],y1:this.bboxes[4*F+1],x2:this.bboxes[4*F+2],y2:this.bboxes[4*F+3]});for(let F=0;F<this.circleKeys.length;F++){let O=this.circles[3*F],V=this.circles[3*F+1],X=this.circles[3*F+2];C.push({key:this.circleKeys[F],x1:O-X,y1:V-X,x2:O+X,y2:V+X})}return S?C.filter(S):C}return this._forEachCell(s,d,g,x,this._queryCell,C,{hitTest:b,seenUids:{box:{},circle:{}}},S),b?C.length>0:C}_queryCircle(s,d,g,x,b){let S=s-g,C=s+g,F=d-g,O=d+g;if(C<0||S>this.width||O<0||F>this.height)return!x&&[];let V=[];return this._forEachCell(S,F,C,O,this._queryCellCircle,V,{hitTest:x,circle:{x:s,y:d,radius:g},seenUids:{box:{},circle:{}}},b),x?V.length>0:V}query(s,d,g,x,b){return this._query(s,d,g,x,!1,b)}hitTest(s,d,g,x,b){return this._query(s,d,g,x,!0,b)}hitTestCircle(s,d,g,x){return this._queryCircle(s,d,g,!0,x)}_queryCell(s,d,g,x,b,S,C,F){let O=C.seenUids,V=this.boxCells[b];if(V!==null){let ie=this.bboxes;for(let ae of V)if(!O.box[ae]){O.box[ae]=!0;let ue=4*ae;if(s<=ie[ue+2]&&d<=ie[ue+3]&&g>=ie[ue+0]&&x>=ie[ue+1]&&(!F||F(this.boxKeys[ae]))){if(C.hitTest)return S.push(!0),!0;S.push({key:this.boxKeys[ae],x1:ie[ue],y1:ie[ue+1],x2:ie[ue+2],y2:ie[ue+3]})}}}let X=this.circleCells[b];if(X!==null){let ie=this.circles;for(let ae of X)if(!O.circle[ae]){O.circle[ae]=!0;let ue=3*ae;if(this._circleAndRectCollide(ie[ue],ie[ue+1],ie[ue+2],s,d,g,x)&&(!F||F(this.circleKeys[ae]))){if(C.hitTest)return S.push(!0),!0;{let de=ie[ue],fe=ie[ue+1],me=ie[ue+2];S.push({key:this.circleKeys[ae],x1:de-me,y1:fe-me,x2:de+me,y2:fe+me})}}}}}_queryCellCircle(s,d,g,x,b,S,C,F){let O=C.circle,V=C.seenUids,X=this.boxCells[b];if(X!==null){let ae=this.bboxes;for(let ue of X)if(!V.box[ue]){V.box[ue]=!0;let de=4*ue;if(this._circleAndRectCollide(O.x,O.y,O.radius,ae[de+0],ae[de+1],ae[de+2],ae[de+3])&&(!F||F(this.boxKeys[ue])))return S.push(!0),!0}}let ie=this.circleCells[b];if(ie!==null){let ae=this.circles;for(let ue of ie)if(!V.circle[ue]){V.circle[ue]=!0;let de=3*ue;if(this._circlesCollide(ae[de],ae[de+1],ae[de+2],O.x,O.y,O.radius)&&(!F||F(this.circleKeys[ue])))return S.push(!0),!0}}}_forEachCell(s,d,g,x,b,S,C,F){let O=this._convertToXCellCoord(s),V=this._convertToYCellCoord(d),X=this._convertToXCellCoord(g),ie=this._convertToYCellCoord(x);for(let ae=O;ae<=X;ae++)for(let ue=V;ue<=ie;ue++)if(b.call(this,s,d,g,x,this.xCellCount*ue+ae,S,C,F))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,d,g,x,b,S){let C=x-s,F=b-d,O=g+S;return O*O>C*C+F*F}_circleAndRectCollide(s,d,g,x,b,S,C){let F=(S-x)/2,O=Math.abs(s-(x+F));if(O>F+g)return!1;let V=(C-b)/2,X=Math.abs(d-(b+V));if(X>V+g)return!1;if(O<=F||X<=V)return!0;let ie=O-F,ae=X-V;return ie*ie+ae*ae<=g*g}}let Fl=100;class Lp{constructor(s,d,g=new Pp(s.width+200,s.height+200,25),x=new Pp(s.width+200,s.height+200,25)){this.transform=s,this.grid=g,this.ignoredGrid=x,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+Fl,this.screenBottomBoundary=s.height+Fl,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.fogState=d}placeCollisionBox(s,d,g,x,b,S,C,F){let O=g.projectedAnchorX,V=g.projectedAnchorY,X=g.projectedAnchorZ,ie=g.elevation,ae=g.tileID,ue=s.getProjection();if(ie&&ae){let[Ke,Fe,Be]=ue.upVector(ae.canonical,g.tileAnchorX,g.tileAnchorY),je=ue.upVectorScale(ae.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;O+=Ke*ie*je,V+=Fe*ie*je,X+=Be*ie*je}let de=this.projectAndGetPerspectiveRatio(C,O,V,X,g.tileID,ue.name==="globe"||!!ie||this.transform.pitch>0,ue),fe=S*de.perspectiveRatio,me=(g.x1*d+x.x-g.padding)*fe+de.point.x,Pe=(g.y1*d+x.y-g.padding)*fe+de.point.y,Oe=(g.x2*d+x.x+g.padding)*fe+de.point.x,Ne=(g.y2*d+x.y+g.padding)*fe+de.point.y,Je=de.perspectiveRatio<=.55||de.occluded;return!this.isInsideGrid(me,Pe,Oe,Ne)||!b&&this.grid.hitTest(me,Pe,Oe,Ne,F)||Je?{box:[],offscreen:!1,occluded:de.occluded}:{box:[me,Pe,Oe,Ne],offscreen:this.isOffscreen(me,Pe,Oe,Ne),occluded:!1}}placeCollisionCircles(s,d,g,x,b,S,C,F,O,V,X,ie,ae,ue,de){let fe=[],me=this.transform.elevation,Pe=s.getProjection(),Oe=me?me.getAtTileOffsetFunc(de,this.transform.center.lat,this.transform.worldSize,Pe):null,Ne=new r.P(g.tileAnchorX,g.tileAnchorY),{x:Je,y:Ke,z:Fe}=Pe.projectTilePoint(Ne.x,Ne.y,de.canonical);if(Oe){let[Vt,ft,kt]=Oe(Ne);Je+=Vt,Ke+=ft,Fe+=kt}let Be=Pe.name==="globe",je=this.projectAndGetPerspectiveRatio(C,Je,Ke,Fe,de,Be||!!me||this.transform.pitch>0,Pe),{perspectiveRatio:at}=je,xt=(X?S/at:S*at)/r.bN,qe=lo(Je,Ke,Fe,F),bt=je.signedDistanceFromCamera>0?gs(xt,b,g.lineOffsetX*xt,g.lineOffsetY*xt,!1,qe,Ne,g,x,F,{},me&&!X?Oe:null,X&&!!me,Pe,de,X):null,Ct=!1,Gt=!1,qt=!0;if(bt&&!je.occluded){let Vt=.5*ae*at+ue,ft=new r.P(-100,-100),kt=new r.P(this.screenRightBoundary,this.screenBottomBoundary),jt=new Cd,{first:dr,last:pr}=bt,Cr=dr.path.length,mr=[];for(let Pr=Cr-1;Pr>=1;Pr--)mr.push(dr.path[Pr]);for(let Pr=1;Pr<pr.path.length;Pr++)mr.push(pr.path[Pr]);let Yt=2.5*Vt;O&&(mr=mr.map(([Pr,_i,oi],Di)=>(Oe&&!Be&&(oi=Oe(Di<Cr-1?dr.tilePath[Cr-1-Di]:pr.tilePath[Di-Cr+2])[2]),lo(Pr,_i,oi,O))),mr.some(Pr=>Pr[3]<=0)&&(mr=[]));let Nt=[];if(mr.length>0){let Pr=1/0,_i=-1/0,oi=1/0,Di=-1/0;for(let Xi of mr)Pr=Math.min(Pr,Xi[0]),oi=Math.min(oi,Xi[1]),_i=Math.max(_i,Xi[0]),Di=Math.max(Di,Xi[1]);_i>=ft.x&&Pr<=kt.x&&Di>=ft.y&&oi<=kt.y&&(Nt=[mr.map(Xi=>new r.P(Xi[0],Xi[1]))],(Pr<ft.x||_i>kt.x||oi<ft.y||Di>kt.y)&&(Nt=r.cF(Nt,ft.x,ft.y,kt.x,kt.y)))}for(let Pr of Nt){jt.reset(Pr,.25*Vt);let _i=0;_i=jt.length<=.5*Vt?1:Math.ceil(jt.paddedLength/Yt)+1;for(let oi=0;oi<_i;oi++){let Di=oi/Math.max(_i-1,1),Xi=jt.lerp(Di),_n=Xi.x+Fl,ni=Xi.y+Fl;fe.push(_n,ni,Vt,0);let cn=_n-Vt,kn=ni-Vt,mn=_n+Vt,Ni=ni+Vt;if(qt=qt&&this.isOffscreen(cn,kn,mn,Ni),Gt=Gt||this.isInsideGrid(cn,kn,mn,Ni),!d&&this.grid.hitTestCircle(_n,ni,Vt,ie)&&(Ct=!0,!V))return{circles:[],offscreen:!1,collisionDetected:Ct,occluded:!1}}}}return{circles:!V&&Ct||!Gt?[]:fe,offscreen:qt,collisionDetected:Ct,occluded:je.occluded}}queryRenderedSymbols(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let d=[],g=1/0,x=1/0,b=-1/0,S=-1/0;for(let V of s){let X=new r.P(V.x+Fl,V.y+Fl);g=Math.min(g,X.x),x=Math.min(x,X.y),b=Math.max(b,X.x),S=Math.max(S,X.y),d.push(X)}let C=this.grid.query(g,x,b,S).concat(this.ignoredGrid.query(g,x,b,S)),F={},O={};for(let V of C){let X=V.key;if(F[X.bucketInstanceId]===void 0&&(F[X.bucketInstanceId]={}),F[X.bucketInstanceId][X.featureIndex])continue;let ie=[new r.P(V.x1,V.y1),new r.P(V.x2,V.y1),new r.P(V.x2,V.y2),new r.P(V.x1,V.y2)];r.cG(d,ie)&&(F[X.bucketInstanceId][X.featureIndex]=!0,O[X.bucketInstanceId]===void 0&&(O[X.bucketInstanceId]=[]),O[X.bucketInstanceId].push(X.featureIndex))}return O}insertCollisionBox(s,d,g,x,b){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:x,collisionGroupID:b},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,d,g,x,b){let S=d?this.ignoredGrid:this.grid,C={bucketInstanceId:g,featureIndex:x,collisionGroupID:b};for(let F=0;F<s.length;F+=4)S.insertCircle(C,s[F],s[F+1],s[F+2])}projectAndGetPerspectiveRatio(s,d,g,x,b,S,C){let F=[d,g,x,1],O=!1;x||this.transform.pitch>0?(r.aA.transformMat4(F,F,s),this.fogState&&b&&C.name!=="globe"&&(O=function(ie,ae,ue,de,fe,me){let Pe=me.calculateFogTileMatrix(fe),Oe=[ae,ue,de];return r._.transformMat4(Oe,Oe,Pe),Rn(ie,r._.length(Oe),me.pitch,me._fov)}(this.fogState,d,g,x,b.toUnwrapped(),this.transform)>.9)):_s(F,F,s);let V=F[3];return{point:new r.P((F[0]/V+1)/2*this.transform.width+Fl,(-F[1]/V+1)/2*this.transform.height+Fl),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(C)/V*.5,1.5),signedDistanceFromCamera:V,occluded:S&&F[2]>V||O}}isOffscreen(s,d,g,x){return g<Fl||s>=this.screenRightBoundary||x<Fl||d>this.screenBottomBoundary}isInsideGrid(s,d,g,x){return g>=0&&s<this.gridRightBoundary&&x>=0&&d<this.gridBottomBoundary}getViewportMatrix(){let s=r.ad.identity([]);return r.ad.translate(s,s,[-100,-100,0]),s}}class I{constructor(s,d,g,x){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?d:-d))):x&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class L{constructor(s,d,g,x,b,S=!1){this.text=new I(s?s.text:null,d,g,b),this.icon=new I(s?s.icon:null,d,x,b),this.clipped=S}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Y{constructor(s,d,g,x=!1){this.text=s,this.icon=d,this.skipFade=g,this.clipped=x}}class ce{constructor(){this.invProjMatrix=r.ad.create(),this.viewportMatrix=r.ad.create(),this.circles=[]}}class Se{constructor(s,d,g,x,b){this.bucketInstanceId=s,this.featureIndex=d,this.sourceLayerIndex=g,this.bucketIndex=x,this.tileID=b}}class Le{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){let d=++this.maxGroupID;this.collisionGroups[s]={ID:d,predicate:g=>g.collisionGroupID===d}}return this.collisionGroups[s]}}function ze(m,s,d,g,x){let{horizontalAlign:b,verticalAlign:S}=r.bQ(m),C=-(b-.5)*s,F=-(S-.5)*d,O=r.bP(m,g);return new r.P(C+O[0]*x,F+O[1]*x)}function Ge(m,s,d,g,x){let b=new r.P(m,s);return d&&b._rotate(g?x:-x),b}class Xe{constructor(s,d,g,x,b,S){this.transform=s.clone(),this.projection=s.projection.name,this.collisionIndex=new Lp(this.transform,b),this.buildingIndex=S,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new Le(g),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,d,g,x){let b=g.getBucket(d),S=g.latestFeatureIndex;if(!b||!S||d.fqid!==b.layerIds[0])return;let C=b.layers[0].layout,F=g.collisionBoxArray,O=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),V=g.tileSize/r.a3,X=g.tileID.toUnwrapped();this.transform.setProjection(b.projection);let ie=(ae=g.tileID,ue=b.getProjection(),de=this.transform,ue.name===this.projection?de.calculateProjMatrix(ae.toUnwrapped()):al(de,ue,ae));var ae,ue,de;let fe=C.get("text-pitch-alignment")==="map",me=C.get("text-rotation-alignment")==="map";d.compileFilter();let Pe=d.dynamicFilter(),Oe=d.dynamicFilterNeedsFeature(),Ne=this.transform.calculatePixelsToTileUnitsMatrix(g),Je=ql(ie,g.tileID.canonical,fe,me,this.transform,b.getProjection(),Ne),Ke=null;if(fe){let je=bc(ie,g.tileID.canonical,fe,me,this.transform,b.getProjection(),Ne);Ke=r.ad.multiply([],this.transform.labelPlaneMatrix,je)}let Fe=null;Pe&&g.latestFeatureIndex&&(Fe={unwrappedTileID:X,dynamicFilter:Pe,dynamicFilterNeedsFeature:Oe,featureIndex:g.latestFeatureIndex}),this.retainedQueryData[b.bucketInstanceId]=new Se(b.bucketInstanceId,S,b.sourceLayerIndex,b.index,g.tileID);let Be={bucket:b,layout:C,posMatrix:ie,textLabelPlaneMatrix:Je,labelToScreenMatrix:Ke,clippingData:Fe,scale:O,textPixelRatio:V,holdingForFade:g.holdingForFade(),collisionBoxArray:F,partiallyEvaluatedTextSize:r.aD(b.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:r.aD(b.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(x)for(let je of b.sortKeyRanges){let{sortKey:at,symbolInstanceStart:xt,symbolInstanceEnd:qe}=je;s.push({sortKey:at,symbolInstanceStart:xt,symbolInstanceEnd:qe,parameters:Be})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:Be})}attemptAnchorPlacement(s,d,g,x,b,S,C,F,O,V,X,ie,ae,ue,de,fe,me,Pe){let{textOffset0:Oe,textOffset1:Ne,crossTileID:Je}=ie,Ke=[Oe,Ne],Fe=ze(s,g,x,Ke,b),Be=this.collisionIndex.placeCollisionBox(ue,b,d,Ge(Fe.x,Fe.y,S,C,this.transform.angle),X,F,O,V.predicate);if(fe){let je=ue.getSymbolInstanceIconSize(Pe,this.transform.zoom,ie.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ue,je,fe,Ge(Fe.x,Fe.y,S,C,this.transform.angle),X,F,O,V.predicate).box.length===0)return}if(Be.box.length>0){let je;return this.prevPlacement&&this.prevPlacement.variableOffsets[Je]&&this.prevPlacement.placements[Je]&&this.prevPlacement.placements[Je].text&&(je=this.prevPlacement.variableOffsets[Je].anchor),this.variableOffsets[Je]={textOffset:Ke,width:g,height:x,anchor:s,textScale:b,prevAnchor:je},this.markUsedJustification(ue,s,ie,de),ue.allowVerticalPlacement&&(this.markUsedOrientation(ue,de,ie),this.placedOrientations[Je]=de),{shift:Fe,placedGlyphBoxes:Be}}}placeLayerBucketPart(s,d,g,x){let{bucket:b,layout:S,posMatrix:C,textLabelPlaneMatrix:F,labelToScreenMatrix:O,clippingData:V,textPixelRatio:X,holdingForFade:ie,collisionBoxArray:ae,partiallyEvaluatedTextSize:ue,partiallyEvaluatedIconSize:de,collisionGroup:fe}=s.parameters,me=S.get("text-optional"),Pe=S.get("icon-optional"),Oe=S.get("text-allow-overlap"),Ne=S.get("icon-allow-overlap"),Je=S.get("text-rotation-alignment")==="map",Ke=S.get("text-pitch-alignment")==="map",Fe=S.get("symbol-z-order")==="viewport-y",Be=S.get("symbol-z-elevate");this.transform.setProjection(b.projection);let je=Oe&&(Ne||!b.hasIconData()||Pe),at=Ne&&(Oe||!b.hasTextData()||me);!b.collisionArrays&&ae&&b.deserializeCollisionBoxes(ae),g&&x&&b.updateCollisionDebugBuffers(this.transform.zoom,ae);let xt=(qe,bt,Ct)=>{let{crossTileID:Gt,numVerticalGlyphVertices:qt}=qe;if(V){let mn={zoom:this.transform.zoom,pitch:this.transform.pitch},Ni=null;if(V.dynamicFilterNeedsFeature){let li=this.retainedQueryData[b.bucketInstanceId];Ni=V.featureIndex.loadFeature({featureIndex:qe.featureIndex,bucketIndex:li.bucketIndex,sourceLayerIndex:li.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,V.dynamicFilter)(mn,Ni,this.retainedQueryData[b.bucketInstanceId].tileID.canonical,new r.P(qe.tileAnchorX,qe.tileAnchorY),this.transform.calculateDistanceTileData(V.unwrappedTileID)))return this.placements[Gt]=new Y(!1,!1,!1,!0),void d.add(Gt)}if(d.has(Gt))return;if(ie)return void(this.placements[Gt]=new Y(!1,!1,!1));let Vt=!1,ft=!1,kt=!0,jt=!1,dr=!1,pr=null,Cr={box:null,offscreen:null,occluded:null},mr={box:null,offscreen:null,occluded:null},Yt=null,Nt=null,Pr=null,_i=0,oi=0,Di=0;Ct.textFeatureIndex?_i=Ct.textFeatureIndex:qe.useRuntimeCollisionCircles&&(_i=qe.featureIndex),Ct.verticalTextFeatureIndex&&(oi=Ct.verticalTextFeatureIndex);let Xi=mn=>{mn.tileID=this.retainedQueryData[b.bucketInstanceId].tileID;let Ni=this.transform.elevation;mn.elevation=qe.zOffset+(Ni?Ni.getAtTileOffset(mn.tileID,mn.tileAnchorX,mn.tileAnchorY):0)},_n=Ct.textBox;if(_n){Xi(_n);let mn=li=>{let zn=r.aE.horizontal;if(b.allowVerticalPlacement&&!li&&this.prevPlacement){let $n=this.prevPlacement.placedOrientations[Gt];$n&&(this.placedOrientations[Gt]=$n,zn=$n,this.markUsedOrientation(b,zn,qe))}return zn},Ni=(li,zn)=>{if(b.allowVerticalPlacement&&qt>0&&Ct.verticalTextBox){for(let $n of b.writingModes)if($n===r.aE.vertical?(Cr=zn(),mr=Cr):Cr=li(),Cr&&Cr.box&&Cr.box.length)break}else Cr=li()};if(S.get("text-variable-anchor")){let li=S.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Gt]){let bn=this.prevPlacement.variableOffsets[Gt];li.indexOf(bn.anchor)>0&&(li=li.filter(Ht=>Ht!==bn.anchor),li.unshift(bn.anchor))}let zn=(bn,Ht,_r)=>{let ua=b.getSymbolInstanceTextSize(ue,qe,this.transform.zoom,bt),un=(bn.x2-bn.x1)*ua+2*bn.padding,vt=(bn.y2-bn.y1)*ua+2*bn.padding,Ll=qe.hasIconTextFit&&!Ne?Ht:null;Ll&&Xi(Ll);let Xo={box:[],offscreen:!1,occluded:!1},Is=Oe?2*li.length:li.length;for(let Mo=0;Mo<Is;++Mo){let qs=this.attemptAnchorPlacement(li[Mo%li.length],bn,un,vt,ua,Je,Ke,X,C,fe,Mo>=li.length,qe,bt,b,_r,Ll,ue,de);if(qs&&(Xo=qs.placedGlyphBoxes,Xo&&Xo.box&&Xo.box.length)){Vt=!0,pr=qs.shift;break}}return Xo};Ni(()=>zn(_n,Ct.iconBox,r.aE.horizontal),()=>{let bn=Ct.verticalTextBox;return bn&&Xi(bn),b.allowVerticalPlacement&&!(Cr&&Cr.box&&Cr.box.length)&&qt>0&&bn?zn(bn,Ct.verticalIconBox,r.aE.vertical):{box:null,offscreen:null,occluded:null}}),Cr&&(Vt=Cr.box,kt=Cr.offscreen,jt=Cr.occluded);let $n=mn(!(!Cr||!Cr.box));if(!Vt&&this.prevPlacement){let bn=this.prevPlacement.variableOffsets[Gt];bn&&(this.variableOffsets[Gt]=bn,this.markUsedJustification(b,bn.anchor,qe,$n))}}else{let li=(zn,$n)=>{let bn=b.getSymbolInstanceTextSize(ue,qe,this.transform.zoom,bt),Ht=this.collisionIndex.placeCollisionBox(b,bn,zn,new r.P(0,0),Oe,X,C,fe.predicate);return Ht&&Ht.box&&Ht.box.length&&(this.markUsedOrientation(b,$n,qe),this.placedOrientations[Gt]=$n),Ht};Ni(()=>li(_n,r.aE.horizontal),()=>{let zn=Ct.verticalTextBox;return b.allowVerticalPlacement&&qt>0&&zn?(Xi(zn),li(zn,r.aE.vertical)):{box:null,offscreen:null,occluded:null}}),mn(!!(Cr&&Cr.box&&Cr.box.length))}}if(Yt=Cr,Vt=Yt&&Yt.box&&Yt.box.length>0,kt=Yt&&Yt.offscreen,jt=Yt&&Yt.occluded,qe.useRuntimeCollisionCircles){let mn=b.text.placedSymbolArray.get(qe.centerJustifiedTextSymbolIndex>=0?qe.centerJustifiedTextSymbolIndex:qe.verticalPlacedTextSymbolIndex),Ni=r.aF(b.textSizeData,ue,mn),li=S.get("text-padding");Nt=this.collisionIndex.placeCollisionCircles(b,Oe,mn,b.lineVertexArray,b.glyphOffsetArray,Ni,C,F,O,g,Ke,fe.predicate,qe.collisionCircleDiameter*Ni/r.bN,li,this.retainedQueryData[b.bucketInstanceId].tileID),Vt=Oe||Nt.circles.length>0&&!Nt.collisionDetected,kt=kt&&Nt.offscreen,jt=Nt.occluded}if(Ct.iconFeatureIndex&&(Di=Ct.iconFeatureIndex),Ct.iconBox){let mn=Ni=>{Xi(Ni);let li=qe.hasIconTextFit&&pr?Ge(pr.x,pr.y,Je,Ke,this.transform.angle):new r.P(0,0),zn=b.getSymbolInstanceIconSize(de,this.transform.zoom,qe.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(b,zn,Ni,li,Ne,X,C,fe.predicate)};mr&&mr.box&&mr.box.length&&Ct.verticalIconBox?(Pr=mn(Ct.verticalIconBox),ft=Pr.box.length>0):(Pr=mn(Ct.iconBox),ft=Pr.box.length>0),kt=kt&&Pr.offscreen,dr=Pr.occluded}let ni=me||qe.numHorizontalGlyphVertices===0&&qt===0,cn=Pe||qe.numIconVertices===0;if(ni||cn?cn?ni||(ft=ft&&Vt):Vt=ft&&Vt:ft=Vt=ft&&Vt,Vt&&Yt&&Yt.box&&this.collisionIndex.insertCollisionBox(Yt.box,S.get("text-ignore-placement"),b.bucketInstanceId,mr&&mr.box&&oi?oi:_i,fe.ID),ft&&Pr&&this.collisionIndex.insertCollisionBox(Pr.box,S.get("icon-ignore-placement"),b.bucketInstanceId,Di,fe.ID),Nt&&(Vt&&this.collisionIndex.insertCollisionCircles(Nt.circles,S.get("text-ignore-placement"),b.bucketInstanceId,_i,fe.ID),g)){let mn=b.bucketInstanceId,Ni=this.collisionCircleArrays[mn];Ni===void 0&&(Ni=this.collisionCircleArrays[mn]=new ce);for(let li=0;li<Nt.circles.length;li+=4)Ni.circles.push(Nt.circles[li+0]),Ni.circles.push(Nt.circles[li+1]),Ni.circles.push(Nt.circles[li+2]),Ni.circles.push(Nt.collisionDetected?1:0)}let kn=b.projection.name!=="globe";je=je&&(kn||!jt),at=at&&(kn||!dr),this.placements[Gt]=new Y(Vt||je,ft||at,kt||b.justReloaded),d.add(Gt)};if(Be&&this.buildingIndex&&(this.buildingIndex.updateZOffset(b,this.retainedQueryData[b.bucketInstanceId].tileID),b.updateZOffset()),Fe){let qe=b.getSortedSymbolIndexes(this.transform.angle);for(let bt=qe.length-1;bt>=0;--bt){let Ct=qe[bt];xt(b.symbolInstances.get(Ct),Ct,b.collisionArrays[Ct])}b.hasAnyZOffset&&r.w(`${b.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(b.hasAnyZOffset){let qe=b.getSortedIndexesByZOffset();for(let bt=0;bt<qe.length;++bt){let Ct=qe[bt];xt(b.symbolInstances.get(Ct),Ct,b.collisionArrays[Ct])}}else for(let qe=s.symbolInstanceStart;qe<s.symbolInstanceEnd;qe++)xt(b.symbolInstances.get(qe),qe,b.collisionArrays[qe]);if(g&&b.bucketInstanceId in this.collisionCircleArrays){let qe=this.collisionCircleArrays[b.bucketInstanceId];r.ad.invert(qe.invProjMatrix,C),qe.viewportMatrix=this.collisionIndex.getViewportMatrix()}b.justReloaded=!1}markUsedJustification(s,d,g,x){let{leftJustifiedTextSymbolIndex:b,centerJustifiedTextSymbolIndex:S,rightJustifiedTextSymbolIndex:C,verticalPlacedTextSymbolIndex:F,crossTileID:O}=g,V=r.cJ(d),X=x===r.aE.vertical?F:V==="left"?b:V==="center"?S:V==="right"?C:-1;b>=0&&(s.text.placedSymbolArray.get(b).crossTileID=X>=0&&b!==X?0:O),S>=0&&(s.text.placedSymbolArray.get(S).crossTileID=X>=0&&S!==X?0:O),C>=0&&(s.text.placedSymbolArray.get(C).crossTileID=X>=0&&C!==X?0:O),F>=0&&(s.text.placedSymbolArray.get(F).crossTileID=X>=0&&F!==X?0:O)}markUsedOrientation(s,d,g){let x=d===r.aE.horizontal||d===r.aE.horizontalOnly?d:0,b=d===r.aE.vertical?d:0,{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:C,rightJustifiedTextSymbolIndex:F,verticalPlacedTextSymbolIndex:O}=g,V=s.text.placedSymbolArray;S>=0&&(V.get(S).placedOrientation=x),C>=0&&(V.get(C).placedOrientation=x),F>=0&&(V.get(F).placedOrientation=x),O>=0&&(V.get(O).placedOrientation=b)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;let d=this.prevPlacement,g=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;let x=d?d.symbolFadeChange(s):1,b=d?d.opacities:{},S=d?d.variableOffsets:{},C=d?d.placedOrientations:{};for(let F in this.placements){let O=this.placements[F],V=b[F];V?(this.opacities[F]=new L(V,x,O.text,O.icon,null,O.clipped),g=g||O.text!==V.text.placed||O.icon!==V.icon.placed):(this.opacities[F]=new L(null,x,O.text,O.icon,O.skipFade,O.clipped),g=g||O.text||O.icon)}for(let F in b){let O=b[F];if(!this.opacities[F]){let V=new L(O,x,!1,!1);V.isHidden()||(this.opacities[F]=V,g=g||O.text.placed||O.icon.placed)}}for(let F in S)this.variableOffsets[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.variableOffsets[F]=S[F]);for(let F in C)this.placedOrientations[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.placedOrientations[F]=C[F]);g?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:s)}updateLayerOpacities(s,d,g,x){let b=new Set;for(let S of d){let C=S.getBucket(s);C&&S.latestFeatureIndex&&s.fqid===C.layerIds[0]&&(this.updateBucketOpacities(C,b,S.collisionBoxArray,g,x,S.tileID),C.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(C,S.tileID),C.updateZOffset()))}}updateBucketOpacities(s,d,g,x,b,S){s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();let C=s.layers[0].layout,F=!!s.layers[0].dynamicFilter(),O=new L(null,0,!1,!1,!0),V=C.get("text-allow-overlap"),X=C.get("icon-allow-overlap"),ie=C.get("text-variable-anchor"),ae=C.get("text-rotation-alignment")==="map",ue=C.get("text-pitch-alignment")==="map",de=new L(null,0,V&&(X||!s.hasIconData()||C.get("icon-optional")),X&&(V||!s.hasTextData()||C.get("text-optional")),!0);!s.collisionArrays&&g&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(g);let fe=(Pe,Oe,Ne)=>{for(let Je=0;Je<Oe/4;Je++)Pe.opacityVertexArray.emplaceBack(Ne)},me=0;b&&s.updateReplacement(S,b);for(let Pe=0;Pe<s.symbolInstances.length;Pe++){let Oe=s.symbolInstances.get(Pe),{numHorizontalGlyphVertices:Ne,numVerticalGlyphVertices:Je,crossTileID:Ke,numIconVertices:Fe,tileAnchorX:Be,tileAnchorY:je}=Oe,at=d.has(Ke),xt=this.opacities[Ke];at?xt=O:xt||(xt=de,this.opacities[Ke]=xt),d.add(Ke);let qe=Ne>0||Je>0,bt=Fe>0,Ct=this.placedOrientations[Ke],Gt=Ct===r.aE.vertical,qt=Ct===r.aE.horizontal||Ct===r.aE.horizontalOnly;!qe&&!bt||xt.isHidden()||me++;let Vt=!1;if((qe||bt)&&b)for(let ft of s.activeReplacements){if(ft.order<x||ft.order===1/0||!(ft.clipMask&r.cu.Symbol)||ft.min.x>Be||Be>ft.max.x||ft.min.y>je||je>ft.max.y)continue;let kt=r.cH(Be,je,S.canonical,ft.footprintTileId.canonical);if(Vt=r.cI(kt,ft),Vt)break}if(qe){let ft=Vt?ur:It(xt.text);fe(s.text,Ne,Gt?ur:ft),fe(s.text,Je,qt?ur:ft);let kt=xt.text.isHidden(),{leftJustifiedTextSymbolIndex:jt,centerJustifiedTextSymbolIndex:dr,rightJustifiedTextSymbolIndex:pr,verticalPlacedTextSymbolIndex:Cr}=Oe,mr=s.text.placedSymbolArray,Yt=kt||Gt?1:0;jt>=0&&(mr.get(jt).hidden=Yt),dr>=0&&(mr.get(dr).hidden=Yt),pr>=0&&(mr.get(pr).hidden=Yt),Cr>=0&&(mr.get(Cr).hidden=kt||qt?1:0);let Nt=this.variableOffsets[Ke];Nt&&this.markUsedJustification(s,Nt.anchor,Oe,Ct);let Pr=this.placedOrientations[Ke];Pr&&(this.markUsedJustification(s,"left",Oe,Pr),this.markUsedOrientation(s,Pr,Oe))}if(bt){let ft=Vt?ur:It(xt.icon),{placedIconSymbolIndex:kt,verticalPlacedIconSymbolIndex:jt}=Oe,dr=s.icon.placedSymbolArray,pr=xt.icon.isHidden()?1:0;kt>=0&&(fe(s.icon,Fe,Gt?ur:ft),dr.get(kt).hidden=pr),jt>=0&&(fe(s.icon,Oe.numVerticalIconVertices,qt?ur:ft),dr.get(jt).hidden=pr)}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){let ft=s.collisionArrays[Pe];if(ft){let kt=new r.P(0,0),jt=!0;if(ft.textBox||ft.verticalTextBox){if(ie){let pr=this.variableOffsets[Ke];pr?(kt=ze(pr.anchor,pr.width,pr.height,pr.textOffset,pr.textScale),ae&&kt._rotate(ue?this.transform.angle:-this.transform.angle)):jt=!1}F&&(jt=!xt.clipped),ft.textBox&&tt(s.textCollisionBox.collisionVertexArray,xt.text.placed,!jt||Gt,kt.x,kt.y),ft.verticalTextBox&&tt(s.textCollisionBox.collisionVertexArray,xt.text.placed,!jt||qt,kt.x,kt.y)}let dr=jt&&!!(!qt&&ft.verticalIconBox);ft.iconBox&&tt(s.iconCollisionBox.collisionVertexArray,xt.icon.placed,dr,Oe.hasIconTextFit?kt.x:0,Oe.hasIconTextFit?kt.y:0),ft.verticalIconBox&&tt(s.iconCollisionBox.collisionVertexArray,xt.icon.placed,!dr,Oe.hasIconTextFit?kt.x:0,Oe.hasIconTextFit?kt.y:0)}}}if(s.fullyClipped=me===0,s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){let Pe=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=Pe.invProjMatrix,s.placementViewportMatrix=Pe.viewportMatrix,s.collisionCircleArray=Pe.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,d){let g=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*g>s}setStale(){this.stale=!0}}function tt(m,s,d,g,x){m.emplaceBack(s?1:0,d?1:0,g||0,x||0),m.emplaceBack(s?1:0,d?1:0,g||0,x||0),m.emplaceBack(s?1:0,d?1:0,g||0,x||0),m.emplaceBack(s?1:0,d?1:0,g||0,x||0)}let St=Math.pow(2,25),it=Math.pow(2,24),Ut=Math.pow(2,17),Rt=Math.pow(2,16),vr=Math.pow(2,9),rr=Math.pow(2,8),Et=Math.pow(2,1);function It(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;let s=m.placed?1:0,d=Math.floor(127*m.opacity);return d*St+s*it+d*Ut+s*Rt+d*vr+s*rr+d*Et+s}let ur=0;class yr{constructor(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&s.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(s,d,g,x,b){let S=this._bucketParts;for(;this._currentTileIndex<s.length;)if(d.getBucketParts(S,x,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((C,F)=>C.sortKey-F.sortKey));this._currentPartIndex<S.length;){let C=S[this._currentPartIndex];if(d.placeLayerBucketPart(C,this._seenCrossTileIDs,g,C.symbolInstanceStart===0),this._currentPartIndex++,b())return!0}return!1}}class gr{constructor(s,d,g,x,b,S,C,F,O){this.placement=new Xe(s,b,S,C,F,O),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(s,d,g,x){let b=r.e.now(),S=()=>{let C=r.e.now()-b;return!this._forceFullPlacement&&C>2};for(;this._currentPlacementIndex>=0;){let C=d[s[this._currentPlacementIndex]],F=this.placement.collisionIndex.transform.zoom;if(C.type==="symbol"&&(!C.minzoom||C.minzoom<=F)&&(!C.maxzoom||C.maxzoom>F)){let O=C,V=O.layout.get("symbol-z-elevate"),X=this._inProgressLayer=this._inProgressLayer||new yr(O),ie=r.al(C.source,C.scope);if(X.continuePlacement(V?x[ie]:g[ie],this.placement,this._showCollisionBoxes,C,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}let $r=512/r.a3/2;class Hr{constructor(s,d,g){this.tileID=s,this.bucketInstanceId=g,this.index=new r.cK(d.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];let x=s.canonical.x*r.a3,b=s.canonical.y*r.a3;for(let S=0;S<d.length;S++){let{key:C,crossTileID:F,tileAnchorX:O,tileAnchorY:V}=d.get(S),X=Math.floor((x+O)*$r),ie=Math.floor((b+V)*$r);this.index.add(X,ie),this.keys.push(C),this.crossTileIDs.push(F)}this.index.finish()}findMatches(s,d,g){let x=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z),b=$r/Math.pow(2,d.canonical.z-this.tileID.canonical.z),S=d.canonical.x*r.a3,C=d.canonical.y*r.a3;for(let F=0;F<s.length;F++){let O=s.get(F);if(O.crossTileID)continue;let{key:V,tileAnchorX:X,tileAnchorY:ie}=O,ae=Math.floor((S+X)*b),ue=Math.floor((C+ie)*b),de=this.index.range(ae-x,ue-x,ae+x,ue+x);for(let fe of de){let me=this.crossTileIDs[fe];if(this.keys[fe]===V&&!g.has(me)){g.add(me),O.crossTileID=me;break}}}}}class Ci{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Wr{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){let d=Math.round((s-this.lng)/360);if(d!==0)for(let g in this.indexes){let x=this.indexes[g],b={};for(let S in x){let C=x[S];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+d),b[C.tileID.key]=C}this.indexes[g]=b}this.lng=s}addBucket(s,d,g){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let b=0;b<d.symbolInstances.length;b++)d.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]=new Set);let x=this.usedCrossTileIDs[s.overscaledZ];for(let b in this.indexes){let S=this.indexes[b];if(Number(b)>s.overscaledZ)for(let C in S){let F=S[C];F.tileID.isChildOf(s)&&F.findMatches(d.symbolInstances,s,x)}else{let C=S[s.scaledTo(Number(b)).key];C&&C.findMatches(d.symbolInstances,s,x)}}for(let b=0;b<d.symbolInstances.length;b++){let S=d.symbolInstances.get(b);S.crossTileID||(S.crossTileID=g.generate(),x.add(S.crossTileID))}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new Hr(s,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(s,d){for(let g of d.crossTileIDs)this.usedCrossTileIDs[s].delete(g)}removeStaleBuckets(s){let d=!1;for(let g in this.indexes){let x=this.indexes[g];for(let b in x)s[x[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,x[b]),delete x[b],d=!0)}return d}}class Fn{constructor(){this.layerIndexes={},this.crossTileIDs=new Ci,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,d,g,x){let b=this.layerIndexes[s.fqid];b===void 0&&(b=this.layerIndexes[s.fqid]=new Wr);let S=!1,C={};x.name!=="globe"&&b.handleWrapJump(g);for(let F of d){let O=F.getBucket(s);O&&s.fqid===O.layerIds[0]&&(O.bucketInstanceId||(O.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(F.tileID,O,this.crossTileIDs)&&(S=!0),C[O.bucketInstanceId]=!0)}return b.removeStaleBuckets(C)&&(S=!0),S}pruneUnusedLayers(s){let d={};s.forEach(g=>{d[g]=!0});for(let g in this.layerIndexes)d[g]||delete this.layerIndexes[g]}}let Nn=new r.N({data:new r.O(r.L.colorTheme.data)}),on=(m,s)=>Ar(m,s&&s.filter(d=>d.identifier!=="source.canvas")),dn=r.ah(zi,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),ea=r.ah(zi,["setCenter","setZoom","setBearing","setPitch"]),qn={version:8,layers:[],sources:{}},Ki={duration:300,delay:0};class Bn extends r.E{constructor(s,d={}){super(),this.map=s,this.scope=d.scope||"",this.globalId=null,this.fragments=[],this.importDepth=d.importDepth||0,this.importsCache=d.importsCache||new Map,this.resolvedImports=d.resolvedImports||new Set,this.transition=r.W({},Ki),this._buildingIndex=new Rp(this),this.crossTileSymbolIndex=new Fn,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerIndices=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=d.styleChanges||new Te,this.dispatcher=d.dispatcher?d.dispatcher:new r.bw(r.bx(),this),d.imageManager?this.imageManager=d.imageManager:(this.imageManager=new Eo,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=d.glyphManager?d.glyphManager:new r.cM(s._requestManager,d.localFontFamily?r.cN.all:d.localIdeographFontFamily?r.cN.ideographs:r.cN.none,d.localFontFamily||d.localIdeographFontFamily),d.modelManager?this.modelManager=d.modelManager:(this.modelManager=new Ua(s._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this._styleColorTheme={lut:null,lutLoading:!1,colorTheme:null},this._styleColorThemeForScope={},this.options=d.configOptions?d.configOptions:new Map,this._configDependentLayers=d.configDependentLayers?d.configDependentLayers:new Set,this._config=d.config,this._initialConfig=d.initialConfig,this.dispatcher.broadcast("setReferrer",r.cO());let g=this;this._rtlTextPluginCallback=Bn.registerForPluginStateChange(x=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(b,S)=>{if(r.cP(b),S&&S.every(C=>C))for(let C in g._sourceCaches){let F=g._sourceCaches[C],O=F.getSource().type;O!=="vector"&&O!=="geojson"||F.reload()}})}),this.on("data",x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;let b=this.getOwnSource(x.sourceId);if(b&&b.vectorLayerIds)for(let S in this._layers){let C=this._layers[S];C.source===b.id&&this._validateLayer(C)}})}load(s){return s?(typeof s=="string"?this.loadURL(s):this.loadJSON(s),this):this}_getGlobalId(s){if(!s)return null;if(typeof s=="string"){if(r.cQ(s))return s;let d=r.cR(s);if(!d.startsWith("http"))try{return new URL(d,location.href).toString()}catch{return d}return d}return`json://${r.cS(JSON.stringify(s))}`}_diffStyle(s,d,g){this.globalId=this._getGlobalId(s);let x=(b,S)=>{try{S(null,this.setState(b,g))}catch(C){S(C,!1)}};if(typeof s=="string"){let b=this.map._requestManager.normalizeStyleURL(s),S=this.map._requestManager.transformRequest(b,r.R.Style);r.g(S,(C,F)=>{C?this.fire(new r.d(C)):F&&x(F,d)})}else typeof s=="object"&&x(s,d)}loadURL(s,d={}){this.fire(new r.f("dataloading",{dataType:"style"}));let g=typeof d.validate=="boolean"?d.validate:!r.cQ(s);this.globalId=this._getGlobalId(s),s=this.map._requestManager.normalizeStyleURL(s,d.accessToken),this.resolvedImports.add(s);let x=this.importsCache.get(s);if(x)return this._load(x,g);let b=this.map._requestManager.transformRequest(s,r.R.Style);this._request=r.g(b,(S,C)=>{if(this._request=null,S)this.fire(new r.d(S));else if(C)return this.importsCache.set(s,C),this._load(C,g)})}loadJSON(s,d={}){this.fire(new r.f("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(s),this._request=r.e.frame(()=>{this._request=null,this._load(s,d.validate!==!1)})}loadEmpty(){this.fire(new r.f("dataloading",{dataType:"style"})),this._load(qn,!1)}_loadImports(s,d,g){if(this.importDepth>=4)return r.w("Style doesn't support nesting deeper than 5"),Promise.resolve();let x=[];for(let b of s){let S=this._createFragmentStyle(b),C=new Promise(V=>{S.once("style.import.load",V),S.once("error",V)}).then(()=>this.mergeAll());if(x.push(C),this.resolvedImports.has(b.url)){S.loadEmpty();continue}let F=b.data||this.importsCache.get(b.url);F?(S.loadJSON(F,{validate:d}),this._isInternalStyle(F)&&(S.globalId=null)):b.url?S.loadURL(b.url,{validate:d}):S.loadEmpty();let O={style:S,id:b.id,config:b.config};if(g){let V=this.fragments.findIndex(({id:X})=>X===g);this.fragments=this.fragments.slice(0,V).concat(O).concat(this.fragments.slice(V))}else this.fragments.push(O)}return Promise.allSettled(x)}getImportGlobalIds(s=this,d=new Set){for(let g of s.fragments)g.style.globalId&&d.add(g.style.globalId),this.getImportGlobalIds(g.style,d);return[...d.values()]}_createFragmentStyle(s){let d=this.scope?r.al(s.id,this.scope):s.id,g,x=this._initialConfig&&this._initialConfig[d];(s.config||x)&&(g=r.W({},s.config,x));let b=new Bn(this.map,{scope:d,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:g,configOptions:this.options,configDependentLayers:this._configDependentLayers});return b.setEventedParent(this.map,{style:b}),b}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.isRootStyle()}_isInternalStyle(s){return this.isRootStyle()&&(s.fragment||!!s.schema&&s.fragment!==!1)}_load(s,d){let g=s.schema;if(this._isInternalStyle(s)){let S=r.W({},qn,{imports:[{id:"basemap",data:s,url:""}]});return void this._load(S,d)}if(this.updateConfig(this._config,g),d&&on(this,se(s)))return;this._loaded=!0,this.stylesheet=r.cT(s);let x=()=>{for(let O in s.sources)this.addSource(O,s.sources[O],{validate:!1,isInitialLoad:!0});s.sprite?this._loadSprite(s.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(s.glyphs,this.scope);let S=Fp(this.stylesheet.layers);if(this._order=S.map(O=>O.id),this.stylesheet.light&&r.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){let O=this.stylesheet.lights[0];this.light=new wr(O.properties,O.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new wr(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(let O of S){let V=r.cY(O,this.scope,this._styleColorTheme.lut,this.options);V.isConfigDependent&&this._configDependentLayers.add(V.fqid),V.setEventedParent(this,{layer:{id:V.id}}),this._layers[V.id]=V,this._serializedLayers[V.id]=V.serialize();let X=this.getOwnLayerSourceCache(V),ie=!!this.directionalLight&&this.directionalLight.shadowsEnabled();X&&V.canCastShadows()&&ie&&(X.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);let C=this.stylesheet.terrain;C&&(this.checkCanvasFingerprintNoise(),this.terrainSetForDrapingOnly()||this._createTerrain(C,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new r.f("data",{dataType:"style"}));let F=this.isRootStyle();s.imports?this._loadImports(s.imports,d).then(()=>{this._reloadImports(),this.fire(new r.f(F?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new r.f(F?"style.load":"style.import.load")))},b=this.stylesheet["color-theme"];if(this._styleColorTheme.colorTheme=b,b){let S=this._evaluateColorThemeData(b);this._loadColorTheme(S).then(()=>{x()}).catch(C=>{r.w(`Couldn't load color theme from the stylesheet: ${C}`),x()})}else this._styleColorTheme.lut=null,x()}isRootStyle(){return this.importDepth===0}mergeAll(){let s,d,g,x,b,S,C,F,O={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(V=>{if(V.stylesheet){if(V.light!=null&&(s=V.light),V.stylesheet.lights)for(let X of V.stylesheet.lights)X.type==="ambient"&&V.ambientLight!=null&&(d=V.ambientLight),X.type==="directional"&&V.directionalLight!=null&&(g=V.directionalLight);x=this._prioritizeTerrain(x,V.terrain,V.stylesheet.terrain),V.stylesheet.fog&&V.fog!=null&&(b=V.fog),V.stylesheet.camera!=null&&(F=V.stylesheet.camera),V.stylesheet.projection!=null&&(S=V.stylesheet.projection),V.stylesheet.transition!=null&&(C=V.stylesheet.transition),O[V.scope]=V._styleColorTheme}}),this.light=s,this.ambientLight=d,this.directionalLight=g,this.fog=b,this._styleColorThemeForScope=O,x===null?delete this.terrain:this.terrain=x,this.camera=F||{"camera-projection":"perspective"},this.projection=S||{name:"mercator"},this.transition=r.W({},Ki,C),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(s){let d=g=>{for(let x of g.fragments)d(x.style);s(g)};d(this)}_prioritizeTerrain(s,d,g){let x=s&&s.drapeRenderMode===0;return g===null?d&&d.drapeRenderMode===0?d:x?s:null:d!=null&&(!s||x||d&&d.drapeRenderMode===1)?d:s}mergeTerrain(){let s;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(d=>{s=this._prioritizeTerrain(s,d.terrain,d.stylesheet.terrain)}),s===null?delete this.terrain:this.terrain=s}mergeProjection(){let s;this.forEachFragmentStyle(d=>{d.stylesheet.projection!=null&&(s=d.stylesheet.projection)}),this.projection=s||{name:"mercator"}}mergeSources(){let s={},d={},g={};this.forEachFragmentStyle(x=>{for(let b in x._sourceCaches){let S=r.al(b,x.scope);s[S]=x._sourceCaches[b]}for(let b in x._otherSourceCaches){let S=r.al(b,x.scope);d[S]=x._otherSourceCaches[b]}for(let b in x._symbolSourceCaches){let S=r.al(b,x.scope);g[S]=x._symbolSourceCaches[b]}}),this._mergedSourceCaches=s,this._mergedOtherSourceCaches=d,this._mergedSymbolSourceCaches=g}mergeLayers(){let s={},d=[],g={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(S=>{for(let C of S._order){let F=S._layers[C];if(F.type==="slot"){let O=r.cU(C);if(s[O])continue;s[O]=[]}F.slot&&s[F.slot]?s[F.slot].push(F):d.push(F)}}),this._mergedOrder=[],this._clipLayerIndices=[];let x=0,b=(S=[])=>{for(let C of S)if(C.type==="slot"){let F=r.cU(C.id);s[F]&&b(s[F]),this._mergedSlots.push(F)}else{let F=r.al(C.id,C.scope);this._mergedOrder.push(F),g[F]=C,C.is3D()&&(this._has3DLayers=!0),C.type==="circle"&&(this._hasCircleLayers=!0),C.type==="symbol"&&(this._hasSymbolLayers=!0),C.type==="clip"&&this._clipLayerIndices.push(x),x++}};b(d),this._mergedLayers=g,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(s){return this.stylesheet.camera=r.W({},this.stylesheet.camera,s),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(s){return s.data?function(d,g,x){let b=r.W({},g);for(let C of Object.keys(r.L.colorTheme))b[C]===void 0&&(b[C]=r.L.colorTheme[C].default);let S=new r.U(Nn,d,new Map(x));return S.setTransitionOrValue(b,x),S.untransitioned().possiblyEvaluate(new r.X(0))}(this.scope,s,this.options).get("data"):null}_loadColorTheme(s){return this._styleColorTheme.lutLoading=!0,new Promise((d,g)=>{let x="data:image/png;base64,";if(s.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void d();s.startsWith(x)||(s=x+s);let b="mapbox-reserved-lut",S=new Image;S.src=s,S.onerror=()=>{this._styleColorTheme.lutLoading=!1,g(new Error("Failed to load image data"))},S.onload=()=>{this._styleColorTheme.lutLoading=!1;let{width:C,height:F,data:O}=r.e.getImageData(S);if(F>32)return void g(new Error("The height of the image must be less than or equal to 32 pixels."));if(C!==F*F)return void g(new Error("The width of the image must be equal to the height squared."));this.getImage(b)&&this.removeImage(b),this.addImage(b,{data:new r.i({width:C,height:F},O),pixelRatio:1,sdf:!1,version:0});let V=this.imageManager.getImage(b,this.scope);V?(this._styleColorTheme.lut={image:V.data,data:s},d()):g(new Error("Missing LUT image."))}})}getLut(s){let d=this._styleColorThemeForScope[s];return d?d.lut:null}setProjection(s){s?this.stylesheet.projection=s:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(s){this._spriteRequest=function(d,g,x){let b,S,C,F=r.e.devicePixelRatio>1?"@2x":"",O=r.g(g.transformRequest(g.normalizeSpriteURL(d,F,".json"),r.R.SpriteJSON),(ie,ae)=>{O=null,C||(C=ie,b=ae,X())}),V=r.h(g.transformRequest(g.normalizeSpriteURL(d,F,".png"),r.R.SpriteImage),(ie,ae)=>{V=null,C||(C=ie,S=ae,X())});function X(){if(C)x(C);else if(b&&S){let ie=r.e.getImageData(S),ae={};for(let ue in b){let{width:de,height:fe,x:me,y:Pe,sdf:Oe,pixelRatio:Ne,stretchX:Je,stretchY:Ke,content:Fe}=b[ue],Be=new r.i({width:de,height:fe});r.i.copy(ie,Be,{x:me,y:Pe},{x:0,y:0},{width:de,height:fe},null),ae[ue]={data:Be,pixelRatio:Ne,sdf:Oe,stretchX:Je,stretchY:Ke,content:Fe}}x(null,ae)}}return{cancel(){O&&(O.cancel(),O=null),V&&(V.cancel(),V=null)}}}(s,this.map._requestManager,(d,g)=>{if(this._spriteRequest=null,d)this.fire(new r.d(d));else if(g)for(let x in g)this.imageManager.addImage(x,this.scope,g[x]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new r.f("data",{dataType:"style"}))})}_validateLayer(s){let d=this.getOwnSource(s.source);if(!d)return;let g=s.sourceLayer;g&&(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(g)===-1)&&this.fire(new r.d(new Error(`Source layer "${g}" does not exist on source "${d.id}" as specified by style layer "${s.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(let s in this._sourceCaches)if(!this._sourceCaches[s].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(let{style:s}of this.fragments)if(!s.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((s,d)=>{let g=this.fragments[d];return g&&g.style&&(s.data=g.style.serialize()),s})}_serializeSources(){let s={};for(let d in this._sourceCaches){let g=this._sourceCaches[d].getSource();s[g.id]||(s[g.id]=g.serialize())}return s}_serializeLayers(s){let d=[];for(let g of s){let x=this._layers[g];x&&x.type!=="custom"&&d.push(x.serialize())}return d}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(let s in this._sourceCaches)if(this._sourceCaches[s].hasTransition())return!0;for(let s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(s){return!!this.terrain&&s.isDraped(this.getLayerSourceCache(s))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(s){let d=this.getOwnLayer(s);if(d)return d;this.fire(new r.d(new Error(`The layer '${s}' does not exist in the map's style.`)))}_checkSource(s){let d=this.getOwnSource(s);if(d)return d;this.fire(new r.d(new Error(`The source '${s}' does not exist in the map's style.`)))}update(s){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(s),this.directionalLight&&this.directionalLight.recalculate(s);let d=this.calculateLightsBrightness();s.brightness=d||0,d!==this._brightness&&(this._brightness=d,this.dispatcher.broadcast("setBrightness",d));let g=this._changes.isDirty(),x=!1;if(this._changes.isDirty()){let S=this._changes.getLayerUpdatesByScope();for(let C in S){let{updatedIds:F,removedIds:O}=S[C];(F||O)&&(this._updateWorkerLayers(C,F,O),x=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(s),this.light&&this.light.updateTransitions(s),this.ambientLight&&this.ambientLight.updateTransitions(s),this.directionalLight&&this.directionalLight.updateTransitions(s),this.fog&&this.fog.updateTransitions(s),this._changes.reset()}let b={};for(let S in this._mergedSourceCaches){let C=this._mergedSourceCaches[S];b[S]=C.used,C.used=!1,C.tileCoverLift=0}for(let S of this._mergedOrder){let C=this._mergedLayers[S];if(C.recalculate(s,this._availableImages),!C.isHidden(s.zoom)){let F=this.getLayerSourceCache(C);F&&(F.used=!0,F.tileCoverLift=Math.max(F.tileCoverLift,C.tileCoverLift()))}if(!this._precompileDone&&this._shouldPrecompile)for(let F=C.minzoom||0;F<(C.maxzoom||25.5);F++){let O=this.map.painter;if(O){let V=C.getProgramIds();if(!V)continue;for(let X of V){let ie=C.getDefaultProgramParams(X,s.zoom,this._styleColorTheme.lut);ie&&(O.style=this,this.fog&&(O._fogVisible=!0,ie.overrideFog=!0,O.getOrCreateProgram(X,ie)),O._fogVisible=!1,ie.overrideFog=!1,O.getOrCreateProgram(X,ie),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(ie.overrideRtt=!0,O.getOrCreateProgram(X,ie)))}}}}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&x&&this.mergeLayers();for(let S in b){let C=this._mergedSourceCaches[S];b[S]!==C.used&&C.getSource().fire(new r.f("data",{sourceDataType:"visibility",dataType:"source",sourceId:C.getSource().id}))}this.light&&this.light.recalculate(s),this.terrain&&this.terrain.recalculate(s),this.fog&&this.fog.recalculate(s),this.z=s.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),g&&this.fire(new r.f("data",{dataType:"style"}))}_updateTilesForChangedImages(){let s=this._changes.getUpdatedImages();if(s.length){for(let d in this._sourceCaches)this._sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],s);this._changes.resetUpdatedImages()}}_updateWorkerLayers(s,d,g){let x=this.getFragmentStyle(s);x&&this.dispatcher.broadcast("updateLayers",{layers:d?x._serializeLayers(d):[],scope:s,removedIds:g||[],options:x.options})}setState(s,d){if(this._checkLoaded(),on(this,se(s)))return!1;(s=r.cT(s)).layers=Fp(s.layers);let g=function(S,C){if(!S)return[{command:zi.setStyle,args:[C]}];let F=[];try{if(!_(S.version,C.version))return[{command:zi.setStyle,args:[C]}];if(_(S.center,C.center)||F.push({command:zi.setCenter,args:[C.center]}),_(S.zoom,C.zoom)||F.push({command:zi.setZoom,args:[C.zoom]}),_(S.bearing,C.bearing)||F.push({command:zi.setBearing,args:[C.bearing]}),_(S.pitch,C.pitch)||F.push({command:zi.setPitch,args:[C.pitch]}),_(S.sprite,C.sprite)||F.push({command:zi.setSprite,args:[C.sprite]}),_(S.glyphs,C.glyphs)||F.push({command:zi.setGlyphs,args:[C.glyphs]}),_(S.imports,C.imports)||function(ae=[],ue=[],de){ue=ue||[];let fe=(ae=ae||[]).map(Af),me=ue.map(Af),Pe=ae.reduce(ju,{}),Oe=ue.reduce(ju,{}),Ne=fe.slice(),Je,Ke,Fe,Be;for(Je=0,Ke=0;Je<fe.length;Je++)Fe=fe[Je],Oe.hasOwnProperty(Fe)?Ke++:(de.push({command:zi.removeImport,args:[Fe]}),Ne.splice(Ne.indexOf(Fe,Ke),1));for(Je=0,Ke=0;Je<me.length;Je++)Fe=me[me.length-1-Je],Ne[Ne.length-1-Je]!==Fe&&(Pe.hasOwnProperty(Fe)?(de.push({command:zi.removeImport,args:[Fe]}),Ne.splice(Ne.lastIndexOf(Fe,Ne.length-Ke),1)):Ke++,Be=Ne[Ne.length-Je],de.push({command:zi.addImport,args:[Oe[Fe],Be]}),Ne.splice(Ne.length-Je,0,Fe));for(let je of ue){let at=Pe[je.id];at&&!_(at,je)&&de.push({command:zi.updateImport,args:[je.id,je]})}}(S.imports,C.imports,F),_(S.transition,C.transition)||F.push({command:zi.setTransition,args:[C.transition]}),_(S.light,C.light)||F.push({command:zi.setLight,args:[C.light]}),_(S.fog,C.fog)||F.push({command:zi.setFog,args:[C.fog]}),_(S.projection,C.projection)||F.push({command:zi.setProjection,args:[C.projection]}),_(S.lights,C.lights)||F.push({command:zi.setLights,args:[C.lights]}),_(S.camera,C.camera)||F.push({command:zi.setCamera,args:[C.camera]}),!_(S["color-theme"],C["color-theme"]))return[{command:zi.setStyle,args:[C]}];let O={},V=[];(function(ae,ue,de,fe){let me;for(me in ue=ue||{},ae=ae||{})ae.hasOwnProperty(me)&&(ue.hasOwnProperty(me)||jm(me,de,fe));for(me in ue){if(!ue.hasOwnProperty(me))continue;let Pe=ue[me];ae.hasOwnProperty(me)?_(ae[me],Pe)||(ae[me].type==="geojson"&&Pe.type==="geojson"&&bg(ae,ue,me)?de.push({command:zi.setGeoJSONSourceData,args:[me,Pe.data]}):xg(me,ue,de,fe)):Lc(me,ue,de)}})(S.sources,C.sources,V,O);let X=[];S.layers&&S.layers.forEach(ae=>{ae.source&&O[ae.source]?F.push({command:zi.removeLayer,args:[ae.id]}):X.push(ae)});let ie=S.terrain;ie&&O[ie.source]&&(F.push({command:zi.setTerrain,args:[void 0]}),ie=void 0),F=F.concat(V),_(ie,C.terrain)||F.push({command:zi.setTerrain,args:[C.terrain]}),function(ae,ue,de){ue=ue||[];let fe=(ae=ae||[]).map(Af),me=ue.map(Af),Pe=ae.reduce(ju,{}),Oe=ue.reduce(ju,{}),Ne=fe.slice(),Je=Object.create(null),Ke,Fe,Be,je,at,xt,qe;for(Ke=0,Fe=0;Ke<fe.length;Ke++)Be=fe[Ke],Oe.hasOwnProperty(Be)?Fe++:(de.push({command:zi.removeLayer,args:[Be]}),Ne.splice(Ne.indexOf(Be,Fe),1));for(Ke=0,Fe=0;Ke<me.length;Ke++)Be=me[me.length-1-Ke],Ne[Ne.length-1-Ke]!==Be&&(Pe.hasOwnProperty(Be)?(de.push({command:zi.removeLayer,args:[Be]}),Ne.splice(Ne.lastIndexOf(Be,Ne.length-Fe),1)):Fe++,xt=Ne[Ne.length-Ke],de.push({command:zi.addLayer,args:[Oe[Be],xt]}),Ne.splice(Ne.length-Ke,0,Be),Je[Be]=!0);for(Ke=0;Ke<me.length;Ke++)if(Be=me[Ke],je=Pe[Be],at=Oe[Be],!Je[Be]&&!_(je,at))if(_(je.source,at.source)&&_(je["source-layer"],at["source-layer"])&&_(je.type,at.type)){for(qe in Ad(je.layout,at.layout,de,Be,null,zi.setLayoutProperty),Ad(je.paint,at.paint,de,Be,null,zi.setPaintProperty),_(je.slot,at.slot)||de.push({command:zi.setSlot,args:[Be,at.slot]}),_(je.filter,at.filter)||de.push({command:zi.setFilter,args:[Be,at.filter]}),_(je.minzoom,at.minzoom)&&_(je.maxzoom,at.maxzoom)||de.push({command:zi.setLayerZoomRange,args:[Be,at.minzoom,at.maxzoom]}),je)je.hasOwnProperty(qe)&&qe!=="layout"&&qe!=="paint"&&qe!=="filter"&&qe!=="metadata"&&qe!=="minzoom"&&qe!=="maxzoom"&&qe!=="slot"&&(qe.indexOf("paint.")===0?Ad(je[qe],at[qe],de,Be,qe.slice(6),zi.setPaintProperty):_(je[qe],at[qe])||de.push({command:zi.setLayerProperty,args:[Be,qe,at[qe]]}));for(qe in at)at.hasOwnProperty(qe)&&!je.hasOwnProperty(qe)&&qe!=="layout"&&qe!=="paint"&&qe!=="filter"&&qe!=="metadata"&&qe!=="minzoom"&&qe!=="maxzoom"&&qe!=="slot"&&(qe.indexOf("paint.")===0?Ad(je[qe],at[qe],de,Be,qe.slice(6),zi.setPaintProperty):_(je[qe],at[qe])||de.push({command:zi.setLayerProperty,args:[Be,qe,at[qe]]}))}else de.push({command:zi.removeLayer,args:[Be]}),xt=Ne[Ne.lastIndexOf(Be)+1],de.push({command:zi.addLayer,args:[at,xt]})}(X,C.layers,F)}catch(O){console.warn("Unable to compute style diff:",O),F=[{command:zi.setStyle,args:[C]}]}return F}(this.serialize(),s).filter(S=>!(S.command in ea));if(g.length===0)return!1;let x=g.filter(S=>!(S.command in dn));if(x.length>0)throw new Error(`Unimplemented: ${x.map(S=>S.command).join(", ")}.`);let b=[];return g.forEach(S=>{b.push(this[S.command].apply(this,S.args))}),d&&Promise.all(b).then(d),this.stylesheet=s,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(s,d){return this.getImage(s)?this.fire(new r.d(new Error("An image with this name already exists."))):(this.imageManager.addImage(s,this.scope,d),this._afterImageUpdated(s),this)}updateImage(s,d){this.imageManager.updateImage(s,this.scope,d)}getImage(s){return this.imageManager.getImage(s,this.scope)}removeImage(s){return this.getImage(s)?(this.imageManager.removeImage(s,this.scope),this._afterImageUpdated(s),this):this.fire(new r.d(new Error("No image with this name exists.")))}_afterImageUpdated(s){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(s),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new r.f("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(s,d,g={}){return this._checkLoaded(),this._validate(Qt,`models.${s}`,d,null,g)||(this.modelManager.addModel(s,d,this.scope),this._changes.setDirty()),this}hasModel(s){return this.modelManager.hasModel(s,this.scope)}removeModel(s){return this.hasModel(s)?(this.modelManager.removeModel(s,this.scope),this):this.fire(new r.d(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(s,d,g={}){if(this._checkLoaded(),this.getOwnSource(s)!==void 0)throw new Error(`There is already a source with ID "${s}".`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(le,`sources.${s}`,d,null,g))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);let x=pn(s,d,this.dispatcher,this);x.scope=this.scope,x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(x.id),source:x.serialize(),sourceId:x.id}));let b=S=>{let C=(S?"symbol:":"other:")+x.id,F=r.al(C,this.scope),O=this._sourceCaches[C]=new r.bv(F,x,S);(S?this._symbolSourceCaches:this._otherSourceCaches)[x.id]=O,O.onAdd(this.map)};b(!1),d.type!=="vector"&&d.type!=="geojson"||b(!0),x.onAdd&&x.onAdd(this.map),g.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(s){this._checkLoaded();let d=this.getOwnSource(s);if(!d)throw new Error("There is no source with this ID");for(let x in this._layers)if(this._layers[x].source===s)return this.fire(new r.d(new Error(`Source "${s}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===s)return this.fire(new r.d(new Error(`Source "${s}" cannot be removed while terrain is using it.`)));let g=this.getOwnSourceCaches(s);for(let x of g){let b=r.cU(x.id);delete this._sourceCaches[b],this._changes.discardSourceCacheUpdate(x.id),x.fire(new r.f("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles()}return delete this._otherSourceCaches[s],delete this._symbolSourceCaches[s],this.mergeSources(),d.setEventedParent(null),d.onRemove&&d.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(s,d){this._checkLoaded(),this.getOwnSource(s).setData(d),this._changes.setDirty()}getOwnSource(s){let d=this.getOwnSourceCache(s);return d&&d.getSource()}getOwnSources(){let s=[];for(let d in this._otherSourceCaches){let g=this.getOwnSourceCache(d);g&&s.push(g.getSource())}return s}areTilesLoaded(){let s=this._mergedSourceCaches;for(let d in s){let g=s[d]._tiles;for(let x in g){let b=g[x];if(b.state!=="loaded"&&b.state!=="errored")return!1}}return!0}setLights(s){if(this._checkLoaded(),!s)return delete this.ambientLight,void delete this.directionalLight;let d=this._getTransitionParameters();for(let x of s){if(this._validate(Ze,"lights",x))return;switch(x.type){case"ambient":if(this.ambientLight){let b=this.ambientLight;b.set(x),b.updateTransitions(d)}else this.ambientLight=new gc(x,ci,this.scope,this.options);break;case"directional":if(this.directionalLight){let b=this.directionalLight;b.set(x),b.updateTransitions(d)}else this.directionalLight=new gc(x,Os,this.scope,this.options)}}let g=new r.X(this.z||0,d);this.ambientLight&&this.ambientLight.recalculate(g),this.directionalLight&&this.directionalLight.recalculate(g),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){let s=this.directionalLight,d=this.ambientLight;if(!s||!d)return;let g=X=>.2126*(X[0]<=.03928?X[0]/12.92:Math.pow((X[0]+.055)/1.055,2.4))+.7152*(X[1]<=.03928?X[1]/12.92:Math.pow((X[1]+.055)/1.055,2.4))+.0722*(X[2]<=.03928?X[2]/12.92:Math.pow((X[2]+.055)/1.055,2.4)),x=s.properties.get("color").toRenderColor(null).toArray01(),b=s.properties.get("intensity"),S=s.properties.get("direction"),C=1-r.ac(S.x,S.y,S.z)[2]/90,F=g(x)*b*C,O=d.properties.get("color").toRenderColor(null).toArray01(),V=d.properties.get("intensity");return(F+g(O)*V)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;let s=[];return this.directionalLight&&s.push(this.directionalLight.get()),this.ambientLight&&s.push(this.ambientLight.get()),s}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(s){if(!s)return this;if(r.cV(s)){let d=r.cW(s),g=this.fragments.find(({id:b})=>b===d);if(!g)throw new Error(`Style import not found: ${s}`);let x=r.cU(s);return g.style.getFragmentStyle(x)}{let d=this.fragments.find(({id:g})=>g===s);if(!d)throw new Error(`Style import not found: ${s}`);return d.style}}getConfigProperty(s,d){let g=this.getFragmentStyle(s);if(!g)return null;let x=r.al(d,g.scope),b=g.options.get(x),S=b?b.value||b.default:null;return S?S.serialize():null}setConfigProperty(s,d,g){let x=this.getFragmentStyle(s);if(!x)return;let b=x.stylesheet.schema;if(!b||!b[d])return;let S=r.y(g);if(S.result!=="success")return void on(this,S.value);let C=S.value.expression,F=r.al(d,x.scope),O=x.options.get(F);if(!O)return;let V,{minValue:X,maxValue:ie,stepValue:ae,type:ue,values:de}=b[d],fe=r.y(b[d].default);fe.result==="success"&&(V=fe.value.expression),V?(this.options.set(F,ba(jr({},O),{value:C,default:V,minValue:X,maxValue:ie,stepValue:ae,type:ue,values:de})),this.updateConfigDependencies()):this.fire(new r.d(new Error(`No schema defined for the config option "${d}" in the "${s}" fragment.`)))}getConfig(s){let d=this.getFragmentStyle(s);if(!d)return null;let g=d.stylesheet.schema;if(!g)return null;let x={};for(let b in g){let S=r.al(b,d.scope),C=d.options.get(S),F=C?C.value||C.default:null;x[b]=F?F.serialize():null}return x}setConfig(s,d){let g=this.getFragmentStyle(s);g&&(g.updateConfig(d,g.stylesheet.schema),this.updateConfigDependencies())}getSchema(s){let d=this.getFragmentStyle(s);return d?d.stylesheet.schema:null}setSchema(s,d){let g=this.getFragmentStyle(s);g&&(g.stylesheet.schema=d,g.updateConfig(g._config,d),this.updateConfigDependencies())}updateConfig(s,d){if(this._config=s,s||d)if(d)for(let g in d){let x,b,S=r.y(d[g].default);if(S.result==="success"&&(x=S.value.expression),s&&s[g]!==void 0){let ie=r.y(s[g]);ie.result==="success"&&(b=ie.value.expression)}let{minValue:C,maxValue:F,stepValue:O,type:V,values:X}=d[g];if(x){let ie=r.al(g,this.scope);this.options.set(ie,{default:x,value:b,minValue:C,maxValue:F,stepValue:O,type:V,values:X})}else this.fire(new r.d(new Error(`No schema defined for config option "${g}".`)))}else this.fire(new r.d(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(){for(let s of this._configDependentLayers){let d=this.getLayer(s);d&&(d.possiblyEvaluateVisibility(),this._updateLayer(d))}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.forEachFragmentStyle(s=>{if(s._styleColorTheme.colorTheme){let d=s._evaluateColorThemeData(s._styleColorTheme.colorTheme);(!s._styleColorTheme.lut||s._styleColorTheme.lut&&d!==s._styleColorTheme.lut.data)&&s.setColorTheme(s._styleColorTheme.colorTheme)}}),this._changes.setDirty()}addLayer(s,d,g={}){this._checkLoaded();let x=s.id;if(this._layers[x])return void this.fire(new r.d(new Error(`Layer with id "${x}" already exists on this map`)));let b;if(s.type==="custom"){if(on(this,r.cX(s)))return;b=r.cY(s,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof s.source=="object"&&(this.addSource(x,s.source),s=r.cT(s),s=r.W(s,{source:x})),this._validate(nt,`layers.${x}`,s,{arrayIndex:-1},g))return;b=r.cY(s,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(b),b.setEventedParent(this,{layer:{id:x}}),this._serializedLayers[b.id]=b.serialize()}b.isConfigDependent&&this._configDependentLayers.add(b.fqid);let S=this._order.length;if(d){let V=this._order.indexOf(d);if(V===-1)return void this.fire(new r.d(new Error(`Layer with id "${d}" does not exist on this map.`)));b.slot===this._layers[d].slot?S=V:r.w(`Layer with id "${d}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(S,0,x),this._layerOrderChanged=!0,this._layers[x]=b;let C=this.getOwnLayerSourceCache(b),F=!!this.directionalLight&&this.directionalLight.shadowsEnabled();C&&b.canCastShadows()&&F&&(C.castsShadows=!0);let O=this._changes.getRemovedLayer(b);if(O&&b.source&&C&&b.type!=="custom"){this._changes.discardLayerRemoval(b);let V=r.al(b.source,b.scope);O.type!==b.type?this._changes.updateSourceCache(V,"clear"):(this._changes.updateSourceCache(V,"reload"),C.pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map),b.scope=this.scope,this.mergeLayers()}moveLayer(s,d){this._checkLoaded();let g=this._checkLayer(s);if(!g||s===d)return;let x=this._order.indexOf(s);this._order.splice(x,1);let b=this._order.length;if(d){let S=this._order.indexOf(d);if(S===-1)return void this.fire(new r.d(new Error(`Layer with id "${d}" does not exist on this map.`)));g.slot===this._layers[d].slot?b=S:r.w(`Layer with id "${d}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(b,0,s),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(s){this._checkLoaded();let d=this._checkLayer(s);if(!d)return;d.setEventedParent(null);let g=this._order.indexOf(s);this._order.splice(g,1),delete this._layers[s],delete this._serializedLayers[s],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(d.fqid),this._changes.removeLayer(d);let x=this.getOwnLayerSourceCache(d);if(x&&x.castsShadows){let b=!1;for(let S in this._layers)if(this._layers[S].source===d.source&&this._layers[S].canCastShadows()){b=!0;break}x.castsShadows=b}d.onRemove&&d.onRemove(this.map),this.mergeLayers()}getOwnLayer(s){return this._layers[s]}hasLayer(s){return s in this._mergedLayers}hasLayerType(s){for(let d in this._layers)if(this._layers[d].type===s)return!0;return!1}setLayerZoomRange(s,d,g){this._checkLoaded();let x=this._checkLayer(s);x&&(x.minzoom===d&&x.maxzoom===g||(d!=null&&(x.minzoom=d),g!=null&&(x.maxzoom=g),this._updateLayer(x)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(s,d){this._checkLoaded();let g=this._checkLayer(s);g&&g.slot!==d&&(g.slot=d,this._updateLayer(g))}setFilter(s,d,g={}){this._checkLoaded();let x=this._checkLayer(s);if(x&&!_(x.filter,d))return d==null?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(dt,`layers.${x.id}.filter`,d,{layerType:x.type},g)||(x.filter=r.cT(d),this._updateLayer(x)))}getFilter(s){let d=this._checkLayer(s);if(d)return r.cT(d.filter)}setLayoutProperty(s,d,g,x={}){this._checkLoaded();let b=this._checkLayer(s);if(b&&!_(b.getLayoutProperty(d),g)){if(g!=null&&(!x||x.validate!==!1)&&on(b,tr.call(se,{key:`layers.${s}.layout.${d}`,layerType:b.type,objectKey:d,value:g,styleSpec:r.L,style:{glyphs:!0,sprite:!0}})))return;b.setLayoutProperty(d,g),b.isConfigDependent&&this._configDependentLayers.add(b.fqid),this._updateLayer(b)}}getLayoutProperty(s,d){let g=this._checkLayer(s);if(g)return g.getLayoutProperty(d)}setPaintProperty(s,d,g,x={}){this._checkLoaded();let b=this._checkLayer(s);if(!b||_(b.getPaintProperty(d),g)||g!=null&&(!x||x.validate!==!1)&&on(b,Ft.call(se,{key:`layers.${s}.paint.${d}`,layerType:b.type,objectKey:d,value:g,styleSpec:r.L})))return;let S=b.setPaintProperty(d,g);b.isConfigDependent&&this._configDependentLayers.add(b.fqid),S&&this._updateLayer(b),this._changes.updatePaintProperties(b)}getPaintProperty(s,d){let g=this._checkLayer(s);if(g)return g.getPaintProperty(d)}setFeatureState(s,d){this._checkLoaded();let g=s.source,x=s.sourceLayer,b=this._checkSource(g);if(!b)return;let S=b.type;if(S==="geojson"&&x)return void this.fire(new r.d(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(S==="vector"&&!x)return void this.fire(new r.d(new Error("The sourceLayer parameter must be provided for vector source types.")));s.id===void 0&&this.fire(new r.d(new Error("The feature id parameter must be provided.")));let C=this.getOwnSourceCaches(g);for(let F of C)F.setFeatureState(x,s.id,d)}removeFeatureState(s,d){this._checkLoaded();let g=s.source,x=this._checkSource(g);if(!x)return;let b=x.type,S=b==="vector"?s.sourceLayer:void 0;if(b==="vector"&&!S)return void this.fire(new r.d(new Error("The sourceLayer parameter must be provided for vector source types.")));if(d&&typeof s.id!="string"&&typeof s.id!="number")return void this.fire(new r.d(new Error("A feature id is required to remove its specific state property.")));let C=this.getOwnSourceCaches(g);for(let F of C)F.removeFeatureState(S,s.id,d)}getFeatureState(s){this._checkLoaded();let d=s.source,g=s.sourceLayer,x=this._checkSource(d);if(x){if(x.type!=="vector"||g)return s.id===void 0&&this.fire(new r.d(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(d)[0].getFeatureState(g,s.id);this.fire(new r.d(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(s){return this.stylesheet.transition=r.W({},this.stylesheet.transition,s),this.transition=this.stylesheet.transition,this}getTransition(){return r.W({},this.stylesheet.transition)}serialize(){this._checkLoaded();let s=this.getTerrain(),d=s&&this.terrain&&this.terrain.scope===this.scope?s:this.stylesheet.terrain;return r.cZ({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:d,fog:this.stylesheet.fog,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},g=>g!==void 0)}_updateLayer(s){this._changes.updateLayer(s);let d=this.getLayerSourceCache(s),g=r.al(s.source,s.scope),x=this._changes.getUpdatedSourceCaches();s.source&&!x[g]&&d&&d.getSource().type!=="raster"&&(this._changes.updateSourceCache(g,"reload"),d.pause()),s.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(s){let d=C=>this._mergedLayers[C].type==="fill-extrusion"||this._mergedLayers[C].type==="model",g=this.order,x={},b=[];for(let C=g.length-1;C>=0;C--){let F=g[C];if(d(F)){x[F]=C;for(let O of s){let V=O[F];if(V)for(let X of V)b.push(X)}}}b.sort((C,F)=>F.intersectionZ-C.intersectionZ);let S=[];for(let C=g.length-1;C>=0;C--){let F=g[C];if(d(F))for(let O=b.length-1;O>=0;O--){let V=b[O].feature;if(V.layer&&x[V.layer.id]<C)break;S.push(V),b.pop()}else for(let O of s){let V=O[F];if(V)for(let X of V)S.push(X.feature)}}return S}queryRenderedFeatures(s,d,g){d&&d.filter&&this._validate(dt,"queryRenderedFeatures.filter",d.filter,null,d),d.scope=this.scope,d.availableImages=this._availableImages,d.serializedLayers=this._serializedLayers;let x={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new r.d(new Error("parameters.layers must be an Array."))),[];for(let O of d.layers){let V=this._mergedLayers[O];if(!V)return this.fire(new r.d(new Error(`The layer '${O}' does not exist in the map's style and cannot be queried for features.`))),[];x[V.source]=!0}}let b=[],S=d.serializedLayers||{},C=d&&d.layers?d.layers.some(O=>{let V=this.getLayer(O);return V&&V.is3D()}):this.has3DLayers(),F=Lo.createFromScreenPoints(s,g);for(let O in this._mergedSourceCaches){let V=this._mergedSourceCaches[O].getSource();if(!V||V.scope!==d.scope)continue;let X=this._mergedSourceCaches[O].getSource().id;d.layers&&!x[X]||b.push(Ef(this._mergedSourceCaches[O],this._mergedLayers,S,F,d,g,C,!!this.map._showQueryGeometry))}return this.placement&&b.push(function(O,V,X,ie,ae,ue,de){let fe={},me=ue.queryRenderedSymbols(ie),Pe=[];for(let Oe of Object.keys(me).map(Number))Pe.push(de[Oe]);Pe.sort(ec);for(let Oe of Pe){let Ne=Oe.featureIndex.lookupSymbolFeatures(me[Oe.bucketInstanceId],V,Oe.bucketIndex,Oe.sourceLayerIndex,ae.filter,ae.layers,ae.availableImages,O);for(let Je in Ne){let Ke=fe[Je]=fe[Je]||[],Fe=Ne[Je];Fe.sort((Be,je)=>{let at=Oe.featureSortOrder;if(at){let xt=at.indexOf(Be.featureIndex);return at.indexOf(je.featureIndex)-xt}return je.featureIndex-Be.featureIndex});for(let Be of Fe)Ke.push(Be)}}for(let Oe in fe)fe[Oe].forEach(Ne=>{let Je=Ne.feature,Ke=X(O[Oe]);if(!Ke)return;let Fe=Ke.getFeatureState(Je.layer["source-layer"],Je.id);Je.source=Je.layer.source,Je.layer["source-layer"]&&(Je.sourceLayer=Je.layer["source-layer"]),Je.state=Fe});return fe}(this._mergedLayers,S,this.getLayerSourceCache.bind(this),F.screenGeometry,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(s,d){d&&d.filter&&this._validate(dt,"querySourceFeatures.filter",d.filter,null,d);let g=this.getOwnSourceCaches(s),x=[];for(let b of g)x=x.concat(cu(b,d));return x}addSourceType(s,d,g){return Bn.getSourceType(s)?g(new Error(`A source type called "${s}" already exists.`)):(Bn.setSourceType(s,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:s,url:d.workerSourceURL},g):g(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(s,d,g={}){this._checkLoaded();let x=this.light.getLight(),b=!1;for(let C in s)if(!_(s[C],x[C])){b=!0;break}if(!b)return;let S=this._getTransitionParameters();this.light.setLight(s,d,g),this.light.updateTransitions(S)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=r.e.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&r.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(s,d=1){if(this._checkLoaded(),!s)return this.terrainSetForDrapingOnly()&&d!==0||delete this.terrain,s===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let g=s,x=s.source==null;if(d===1){if(this.disableElevatedTerrain)return;if(typeof g.source=="object"){let C="terrain-dem-src";this.addSource(C,g.source),g=r.cT(g),g=r.W(g,{source:C})}let b=r.W({},g),S={};if(this.terrain&&x){b.source=this.terrain.get().source;let C=this.terrain?this.getFragmentStyle(this.terrain.scope):null;C&&(S.style=C.serialize())}if(this._validate(ke,"terrain",b,S))return}if(!this.terrain||this.terrain.scope!==this.scope&&!x||this.terrain&&d!==this.terrain.drapeRenderMode){if(!g)return;this._createTerrain(g,d),this.fire(new r.f("data",{dataType:"style"}))}else{let b=this.terrain,S=b.get();for(let C of Object.keys(r.L.terrain))!g.hasOwnProperty(C)&&r.L.terrain[C].default&&(g[C]=r.L.terrain[C].default);for(let C in s)if(!_(s[C],S[C])){b.set(s,this.options),this.stylesheet.terrain=s;let F=this._getTransitionParameters({duration:0});b.updateTransitions(F),this.fire(new r.f("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(s){let d=this.fog=new md(s,this.map.transform,this.scope,this.options);this.stylesheet.fog=d.get();let g=this._getTransitionParameters({duration:0});d.updateTransitions(g)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(let s of this.map._markers)s._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(s){if(this._checkLoaded(),!s)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){let d=this.fog;if(!_(d.get(),s)){d.set(s,this.options),this.stylesheet.fog=d.get();let g=this._getTransitionParameters({duration:0});d.updateTransitions(g)}}else this._createFog(s);this._markersNeedUpdate=!0}setColorTheme(s){this._checkLoaded();let d=()=>{for(let x in this._layers)this._layers[x].lut=this._styleColorTheme.lut;for(let x in this._sourceCaches)this._sourceCaches[x].clearTiles()};if(this._styleColorTheme.colorTheme=s,!s)return this._styleColorTheme.lut=null,void d();let g=this._evaluateColorThemeData(s);this._loadColorTheme(g).then(()=>{d()}).catch(x=>{r.w(`Couldn't set color theme: ${x}`)})}_getTransitionParameters(s){return{now:r.e.now(),transition:r.W(this.transition,s)}}updateDrapeFirstLayers(){if(!this.terrain)return;let s=[],d=[];for(let g in this._mergedLayers)this.isLayerDraped(this._mergedLayers[g])?s.push(g):d.push(g);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...s),this._drapedFirstOrder.push(...d)}_createTerrain(s,d){let g=this.terrain=new mi(s,d,this.scope,this.options);d===1&&(this.stylesheet.terrain=s),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();let x=this._getTransitionParameters({duration:0});g.updateTransitions(x)}_force3DLayerUpdate(){for(let s in this._layers){let d=this._layers[s];d.type==="fill-extrusion"&&this._updateLayer(d)}}_forceSymbolLayerUpdate(){for(let s in this._layers){let d=this._layers[s];d.type==="symbol"&&this._updateLayer(d)}}_validate(s,d,g,x,b={}){if(b&&b.validate===!1)return!1;let S=r.W({},this.serialize());return on(this,s.call(se,r.W({key:d,style:S,value:g,styleSpec:r.L},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),r.c_.off("pluginStateChange",this._rtlTextPluginCallback);for(let s in this._mergedLayers)this._mergedLayers[s].setEventedParent(null);for(let s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles(),this._mergedSourceCaches[s].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(s){let d=this.getSourceCaches(s);for(let g of d)g.clearTiles()}clearSources(){for(let s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles()}reloadSource(s){let d=this.getSourceCaches(s);for(let g of d)g.resume(),g.reload()}reloadSources(){for(let s of this.getSources())s.reload&&s.reload()}updateSources(s){let d;this.directionalLight&&(d=Sc(this.directionalLight));for(let g in this._mergedSourceCaches)this._mergedSourceCaches[g].update(s,void 0,void 0,d)}_generateCollisionBoxes(){for(let s in this._sourceCaches){let d=this._sourceCaches[s];d.resume(),d.reload()}}_updatePlacement(s,d,g,x,b,S,C=!1){let F=!1,O=!1,V={},X={};for(let ae of this._mergedOrder){let ue=this._mergedLayers[ae];if(ue.type!=="symbol")continue;let de=r.al(ue.source,ue.scope),fe=V[de];if(!fe){let Pe=this.getLayerSourceCache(ue);if(!Pe)continue;let Oe=Pe.getRenderableIds(!0).map(Ne=>Pe.getTileByID(Ne));X[de]=Oe.slice(),fe=V[de]=Oe.sort((Ne,Je)=>Je.tileID.overscaledZ-Ne.tileID.overscaledZ||(Ne.tileID.isLessThan(Je.tileID)?-1:1))}let me=this.crossTileSymbolIndex.addLayer(ue,fe,d.center.lng,d.projection);F=F||me}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),C=C||this._layerOrderChanged||x===0,this._layerOrderChanged&&this.fire(new r.f("neworder")),(C||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(r.e.now(),d.zoom))&&(this.pauseablePlacement=new gr(d,this._mergedOrder,C,g,x,b,this.placement,this.fog&&d.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,V,X),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(r.e.now()),O=!0),F&&this.pauseablePlacement.placement.setStale()),O||F){this._buildingIndex.onNewFrame(d.zoom);for(let ae=0;ae<this._mergedOrder.length;ae++){let ue=this._mergedLayers[this._mergedOrder[ae]];if(ue.type!=="symbol")continue;let de=this.isLayerClipped(ue)&&this._clipLayerIndices.some(fe=>ae<fe);this.placement.updateLayerOpacities(ue,V[r.al(ue.source,ue.scope)],ae,de?S:null)}}let ie=!1;for(let ae of this._mergedOrder){let ue=this._mergedLayers[ae];if(ue.type!=="symbol")continue;let de=V[r.al(ue.source,ue.scope)];for(let fe of de){let me=fe.getBucket(ue);me&&fe.latestFeatureIndex&&ue.fqid===me.layerIds[0]&&(ie=me.updateOcclusionOpacities(s.context,s.symbolParams,s._dt)||ie)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(r.e.now())||ie,occlusionQueryBasedOpacityChanged:ie}}_releaseSymbolFadeTiles(){for(let s in this._sourceCaches)this._sourceCaches[s].releaseSymbolFadeTiles()}addImport(s,d){this._checkLoaded();let g=this.stylesheet.imports=this.stylesheet.imports||[];if(g.findIndex(({id:b})=>b===s.id)!==-1)return void this.fire(new r.d(new Error(`Import with id '${s.id}' already exists in the map's style.`)));if(!d)return g.push(s),this._loadImports([s],!0);let x=g.findIndex(({id:b})=>b===d);return x===-1&&this.fire(new r.d(new Error(`Import with id "${d}" does not exist on this map.`))),this.stylesheet.imports=g.slice(0,x).concat(s).concat(g.slice(x)),this._loadImports([s],!0,d)}updateImport(s,d){this._checkLoaded();let g=this.stylesheet.imports||[],x=this.getImportIndex(s);return x===-1?this:typeof d=="string"?(this.setImportUrl(s,d),this):(d.url&&d.url!==g[x].url&&this.setImportUrl(s,d.url),_(d.config,g[x].config)||this.setImportConfig(s,d.config),_(d.data,g[x].data)||this.setImportData(s,d.data),this)}moveImport(s,d){this._checkLoaded();let g=this.stylesheet.imports||[],x=this.getImportIndex(s);if(x===-1)return this;let b=this.getImportIndex(d);if(b===-1)return this;let S=g[x],C=this.fragments[x];return g=g.filter(({id:F})=>F!==s),this.fragments=this.fragments.filter(({id:F})=>F!==s),this.stylesheet.imports=g.slice(0,b).concat(S).concat(g.slice(b)),this.fragments=this.fragments.slice(0,b).concat(C).concat(this.fragments.slice(b)),this.mergeLayers(),this}setImportUrl(s,d){this._checkLoaded();let g=this.stylesheet.imports||[],x=this.getImportIndex(s);if(x===-1)return this;g[x].url=d;let b=this.fragments[x];return b.style=this._createFragmentStyle(g[x]),b.style.on("style.import.load",()=>this.mergeAll()),b.style.loadURL(d),this}setImportData(s,d){this._checkLoaded();let g=this.getImportIndex(s),x=this.stylesheet.imports||[];return g===-1?this:d?(this.fragments[g].style.setState(d),this._reloadImports(),this):(delete x[g].data,this.setImportUrl(s,x[g].url))}setImportConfig(s,d){this._checkLoaded();let g=this.getImportIndex(s),x=this.stylesheet.imports||[];if(g===-1)return this;d?x[g].config=d:delete x[g].config;let b=this.fragments[g],S=b.style.stylesheet&&b.style.stylesheet.schema;return b.config=d,b.style.updateConfig(d,S),this.updateConfigDependencies(),this}removeImport(s){this._checkLoaded();let d=this.stylesheet.imports||[],g=this.getImportIndex(s);g!==-1&&(d.splice(g,1),this.fragments[g].style._remove(),this.fragments.splice(g,1),this._reloadImports())}getImportIndex(s){let d=(this.stylesheet.imports||[]).findIndex(g=>g.id===s);return d===-1&&this.fire(new r.d(new Error(`Import '${s}' does not exist in the map's style and cannot be updated.`))),d}getLayer(s){return this._mergedLayers[s]}getSources(){let s=[];for(let d in this._mergedOtherSourceCaches){let g=this._mergedOtherSourceCaches[d];g&&s.push(g.getSource())}return s}getSource(s,d){let g=this.getSourceCache(s,d);return g&&g.getSource()}getLayerSource(s){let d=this.getLayerSourceCache(s);return d&&d.getSource()}getSourceCache(s,d){let g=r.al(s,d);return this._mergedOtherSourceCaches[g]}getLayerSourceCache(s){let d=r.al(s.source,s.scope);return s.type==="symbol"?this._mergedSymbolSourceCaches[d]:this._mergedOtherSourceCaches[d]}getSourceCaches(s){if(s==null)return Object.values(this._mergedSourceCaches);let d=[];return this._mergedOtherSourceCaches[s]&&d.push(this._mergedOtherSourceCaches[s]),this._mergedSymbolSourceCaches[s]&&d.push(this._mergedSymbolSourceCaches[s]),d}updateSourceCaches(){let s=this._changes.getUpdatedSourceCaches();for(let d in s){let g=s[d];g==="reload"?this.reloadSource(d):g==="clear"&&this.clearSource(d)}}updateLayers(s){let d=this._changes.getUpdatedPaintProperties();for(let g of d){let x=this.getLayer(g);x&&x.updateTransitions(s)}}getImages(s,d,g){this.imageManager.getImages(d.icons,d.scope,g),this._updateTilesForChangedImages();let x=b=>{b&&b.setDependencies(d.tileID.key,d.type,d.icons)};x(this._otherSourceCaches[d.source]),x(this._symbolSourceCaches[d.source])}getGlyphs(s,d,g){this.glyphManager.getGlyphs(d.stacks,d.scope,g)}getResource(s,d,g){return r.c$(d,g)}getOwnSourceCache(s){return this._otherSourceCaches[s]}getOwnLayerSourceCache(s){return s.type==="symbol"?this._symbolSourceCaches[s.source]:this._otherSourceCaches[s.source]}getOwnSourceCaches(s){let d=[];return this._otherSourceCaches[s]&&d.push(this._otherSourceCaches[s]),this._symbolSourceCaches[s]&&d.push(this._symbolSourceCaches[s]),d}_isSourceCacheLoaded(s){let d=this.getOwnSourceCaches(s);return d.length===0?(this.fire(new r.d(new Error(`There is no source with ID '${s}'`))),!1):d.every(g=>g.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(s,d){if(this._clipLayerIndices.length===0&&s.type!=="fill-extrusion")return!1;let g=s.type==="fill-extrusion"&&s.sourceLayer==="building",x=0;if(s.is3D()){if(g||d&&d.type==="batched-model")return!0;s.type==="model"&&(x=r.cu.Model)}else s.type==="symbol"&&(x=r.cu.Symbol);for(let b of this._clipLayerIndices){let S=this._mergedLayers[this._mergedOrder[b]];if(!S)continue;let C=[];for(let F of S.layout.get("clip-layer-types"))C.push(F==="model"?r.cu.Model:F==="symbol"?r.cu.Symbol:r.cu.FillExtrusion);for(let F of C)if(x&F)return!0}return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(s=>{s.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}function qo(m,s){let d=!1,g=null,x=()=>{g=null,d&&(m(),g=setTimeout(x,s),d=!1)};return()=>(d=!0,g||x(),g)}Bn.getSourceType=function(m){return di[m]},Bn.setSourceType=function(m,s){di[m]=s},Bn.registerForPluginStateChange=r.cL;class po{constructor(s){this._hashName=s&&encodeURIComponent(s),r.bp(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=qo(this._updateHashUnthrottled.bind(this),300)}addTo(s){return this._map=s,window.addEventListener("hashchange",this._onHashChange,!1),s.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){let s=this._map;if(!s)return"";let d=ko(s);if(this._hashName){let g=this._hashName,x=!1,b=location.hash.slice(1).split("&").map(S=>{let C=S.split("=")[0];return C===g?(x=!0,`${C}=${d}`):S}).filter(S=>S);return x||b.push(`${g}=${d}`),`#${b.join("&")}`}return`#${d}`}_getCurrentHash(){let s=location.hash.replace("#","");if(this._hashName){let d;return s.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(d=g)}),(d&&d[1]||"").split("/")}return s.split("/")}_onHashChange(){let s=this._map;if(!s)return!1;let d=this._getCurrentHash();if(d.length>=3&&!d.some(g=>isNaN(g))){let g=s.dragRotate.isEnabled()&&s.touchZoomRotate.isEnabled()?+(d[3]||0):s.getBearing();return s.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:g,pitch:+(d[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function ko(m,s){let d=m.getCenter(),g=Math.round(100*m.getZoom())/100,x=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,x),S=Math.round(d.lng*b)/b,C=Math.round(d.lat*b)/b,F=m.getBearing(),O=m.getPitch(),V=s?`/${S}/${C}/${g}`:`${g}/${C}/${S}`;return(F||O)&&(V+="/"+Math.round(10*F)/10),O&&(V+=`/${Math.round(O)}`),V}let In={linearity:.3,easing:r.d0(0,0,.3,1)},Ts=r.W({deceleration:2500,maxSpeed:1400},In),ss=r.W({deceleration:20,maxSpeed:1400},In),eo=r.W({deceleration:1e3,maxSpeed:360},In),xo=r.W({deceleration:1e3,maxSpeed:90},In);class to{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:r.e.now(),settings:s})}_drainInertiaBuffer(){let s=this._inertiaBuffer,d=r.e.now();for(;s.length>0&&d-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;let d={zoom:0,bearing:0,pitch:0,pan:new r.P(0,0),pinchAround:void 0,around:void 0};for(let{settings:b}of this._inertiaBuffer)d.zoom+=b.zoomDelta||0,d.bearing+=b.bearingDelta||0,d.pitch+=b.pitchDelta||0,b.panDelta&&d.pan._add(b.panDelta),b.around&&(d.around=b.around),b.pinchAround&&(d.pinchAround=b.pinchAround);let g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(d.pan.mag()){let b=Ss(d.pan.mag(),g,r.W({},Ts,s||{}));x.offset=d.pan.mult(b.amount/d.pan.mag()),x.center=this._map.transform.center,Oo(x,b)}if(d.zoom){let b=Ss(d.zoom,g,ss);x.zoom=this._map.transform.zoom+b.amount,Oo(x,b)}if(d.bearing){let b=Ss(d.bearing,g,eo);x.bearing=this._map.transform.bearing+r.at(b.amount,-179,179),Oo(x,b)}if(d.pitch){let b=Ss(d.pitch,g,xo);x.pitch=this._map.transform.pitch+b.amount,Oo(x,b)}if(x.zoom||x.bearing){let b=d.pinchAround===void 0?d.around:d.pinchAround;x.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function Oo(m,s){(!m.duration||m.duration<s.duration)&&(m.duration=s.duration,m.easing=s.easing)}function Ss(m,s,d){let{maxSpeed:g,linearity:x,deceleration:b}=d,S=r.at(m*x/(s/1e3),-g,g),C=Math.abs(S)/(b*x);return{easing:d.easing,duration:1e3*C,amount:S*(C/2)}}class xn extends r.f{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,d,g,x={}){let b=he(d.getCanvasContainer(),g),S=d.unproject(b);super(s,r.W({point:b,lngLat:S,originalEvent:g},x)),this._defaultPrevented=!1,this.target=d}}class $o extends r.f{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,d,g){let x=s==="touchend"?g.changedTouches:g.touches,b=Me(d.getCanvasContainer(),x),S=b.map(F=>d.unproject(F)),C=b.reduce((F,O,V,X)=>F.add(O.div(X.length)),new r.P(0,0));super(s,{points:b,point:C,lngLats:S,lngLat:d.unproject(C),originalEvent:g}),this._defaultPrevented=!1}}class tc extends r.f{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,d,g){super(s,{originalEvent:g}),this._defaultPrevented=!1}}class uu{constructor(s,d){this._map=s,this._clickTolerance=d.clickTolerance}reset(){this._mousedownPos=void 0}wheel(s){return this._firePreventable(new tc(s.type,this._map,s))}mousedown(s,d){return this._mousedownPos=d,this._firePreventable(new xn(s.type,this._map,s))}mouseup(s){this._map.fire(new xn(s.type,this._map,s))}preclick(s){let d=r.W({},s);d.type="preclick",this._map.fire(new xn(d.type,this._map,d))}click(s,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||(this.preclick(s),this._map.fire(new xn(s.type,this._map,s)))}dblclick(s){return this._firePreventable(new xn(s.type,this._map,s))}mouseover(s){this._map.fire(new xn(s.type,this._map,s))}mouseout(s){this._map.fire(new xn(s.type,this._map,s))}touchstart(s){return this._firePreventable(new $o(s.type,this._map,s))}touchmove(s){this._map.fire(new $o(s.type,this._map,s))}touchend(s){this._map.fire(new $o(s.type,this._map,s))}touchcancel(s){this._map.fire(new $o(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ll{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(s){this._map.fire(new xn(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new xn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new xn(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ya{constructor(s,d){this._map=s,this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,d){this.isEnabled()&&s.shiftKey&&s.button===0&&(G(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(s,d){if(!this._active)return;let g=d,x=this._startPos,b=this._lastPos;if(!x||!b||b.equals(g)||!this._box&&g.dist(x)<this._clickTolerance)return;this._lastPos=g,this._box||(this._box=D("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));let S=Math.min(x.x,g.x),C=Math.max(x.x,g.x),F=Math.min(x.y,g.y),O=Math.max(x.y,g.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${S}px,${F}px)`,this._box.style.width=C-S+"px",this._box.style.height=O-F+"px")})}mouseupWindow(s,d){if(!this._active)return;let g=this._startPos,x=d;if(g&&s.button===0){if(this.reset(),ne(),g.x!==x.x||g.y!==x.y)return this._map.fire(new r.f("boxzoomend",{originalEvent:s})),{cameraAnimation:b=>b.fitScreenCoordinates(g,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",s)}}keydown(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),K(),delete this._startPos,delete this._lastPos}_fireEvent(s,d){return this._map.fire(new r.f(s,{originalEvent:d}))}}function Uu(m,s){let d={};for(let g=0;g<m.length;g++)d[m[g].identifier]=s[g];return d}class Op{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(s,d,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=s.timeStamp),g.length===this.numTouches&&(this.centroid=function(x){let b=new r.P(0,0);for(let S of x)b._add(S);return b.div(x.length)}(d),this.touches=Uu(g,d)))}touchmove(s,d,g){if(this.aborted||!this.centroid)return;let x=Uu(g,d);for(let b in this.touches){let S=x[b];(!S||S.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(s,d,g){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){let x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class Oh{constructor(s){this.singleTap=new Op(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(s,d,g){this.singleTap.touchstart(s,d,g)}touchmove(s,d,g){this.singleTap.touchmove(s,d,g)}touchend(s,d,g){let x=this.singleTap.touchend(s,d,g);if(x){let b=s.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(x)<30;if(b&&S||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class Vu{constructor(){this._zoomIn=new Oh({numTouches:1,numTaps:2}),this._zoomOut=new Oh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,d,g){this._zoomIn.touchstart(s,d,g),this._zoomOut.touchstart(s,d,g)}touchmove(s,d,g){this._zoomIn.touchmove(s,d,g),this._zoomOut.touchmove(s,d,g)}touchend(s,d,g){let x=this._zoomIn.touchend(s,d,g),b=this._zoomOut.touchend(s,d,g);return x?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(x)},{originalEvent:s})}):b?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(b)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}let Oc={0:1,2:2};class Gu{constructor(s){this.reset(),this._clickTolerance=s.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(s,d){return!1}_move(s,d){return{}}mousedown(s,d){if(this._lastPoint)return;let g=Re(s);this._correctButton(s,g)&&(this._lastPoint=d,this._eventButton=g)}mousemoveWindow(s,d){let g=this._lastPoint;if(g){if(s.preventDefault(),this._eventButton!=null&&function(x,b){let S=Oc[b];return x.buttons===void 0||(x.buttons&S)!==S}(s,this._eventButton))this.reset();else if(this._moved||!(d.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=d,this._move(g,d)}}mouseupWindow(s){this._lastPoint&&Re(s)===this._eventButton&&(this._moved&&ne(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class cl extends Gu{mousedown(s,d){super.mousedown(s,d),this._lastPoint&&(this._active=!0)}_correctButton(s,d){return d===0&&!s.ctrlKey}_move(s,d){return{around:d,panDelta:d.sub(s)}}}class hu extends Gu{_correctButton(s,d){return d===0&&s.ctrlKey||d===2}_move(s,d){let g=.8*(d.x-s.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(s){s.preventDefault()}}class ul extends Gu{_correctButton(s,d){return d===0&&s.ctrlKey||d===2}_move(s,d){let g=-.5*(d.y-s.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(s){s.preventDefault()}}class Np{constructor(s,d){this._map=s,this._el=s.getCanvasContainer(),this._minTouches=1,this._clickTolerance=d.clickTolerance||1,this.reset(),r.bp(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new r.P(0,0)}touchstart(s,d,g){return this._calculateTransform(s,d,g)}touchmove(s,d,g){if(this._active&&!(g.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(g.length===1&&!r.d1())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return s.cancelable&&s.preventDefault(),this._calculateTransform(s,d,g)}}touchend(s,d,g){this._calculateTransform(s,d,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,d,g){g.length>0&&(this._active=!0);let x=Uu(g,d),b=new r.P(0,0),S=new r.P(0,0),C=0;for(let O in x){let V=x[O],X=this._touches[O];X&&(b._add(V),S._add(V.sub(X)),C++,x[O]=V)}if(this._touches=x,C<this._minTouches||!S.mag())return;let F=S.div(C);return this._sum._add(F),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(C),panDelta:F}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=D("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Nh{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(s){}_move(s,d,g){return{}}touchstart(s,d,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([d[0],d[1]]))}touchmove(s,d,g){let x=this._firstTwoTouches;if(!x)return;s.preventDefault();let[b,S]=x,C=Id(g,d,b),F=Id(g,d,S);if(!C||!F)return;let O=this._aroundCenter?null:C.add(F).div(2);return this._move([C,F],O,s)}touchend(s,d,g){if(!this._firstTwoTouches)return;let[x,b]=this._firstTwoTouches,S=Id(g,d,x),C=Id(g,d,b);S&&C||(this._active&&ne(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Id(m,s,d){for(let g=0;g<m.length;g++)if(m[g].identifier===d)return s[g]}function kd(m,s){return Math.log(m/s)/Math.LN2}class Md extends Nh{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,d){let g=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(kd(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:kd(this._distance,g),pinchAround:d}}}function Hu(m,s){return 180*m.angleWith(s)/Math.PI}class Wu extends Nh{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,d){let g=this._vector;if(this._vector=s[0].sub(s[1]),g&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Hu(this._vector,g),pinchAround:d}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());let d=25/(Math.PI*this._minDiameter)*360,g=this._startVector;if(!g)return!1;let x=Hu(s,g);return Math.abs(x)<d}}function Dd(m){return Math.abs(m.y)>Math.abs(m.x)}class Um extends Nh{constructor(s){super(),this._map=s}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(s){this._lastPoints=s,Dd(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,d,g){let x=this._lastPoints;if(!x)return;let b=s[0].sub(x[0]),S=s[1].sub(x[1]);return this._map._cooperativeGestures&&!r.d1()&&g.touches.length<3||(this._valid=this.gestureBeginsVertically(b,S,g.timeStamp),!this._valid)?void 0:(this._lastPoints=s,this._active=!0,{pitchDelta:(b.y+S.y)/2*-.5})}gestureBeginsVertically(s,d,g){if(this._valid!==void 0)return this._valid;let x=s.mag()>=2,b=d.mag()>=2;if(!x&&!b)return;if(!x||!b)return this._firstMove==null&&(this._firstMove=g),g-this._firstMove<100&&void 0;let S=s.y>0==d.y>0;return Dd(s)&&Dd(d)&&S}}let Cf={panStep:100,bearingStep:15,pitchStep:10};class du{constructor(){let s=Cf;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let d=0,g=0,x=0,b=0,S=0;switch(s.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:s.shiftKey?g=-1:(s.preventDefault(),b=-1);break;case 39:s.shiftKey?g=1:(s.preventDefault(),b=1);break;case 38:s.shiftKey?x=1:(s.preventDefault(),S=-1);break;case 40:s.shiftKey?x=-1:(s.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(g=0,x=0),{cameraAnimation:C=>{let F=C.getZoom();C.easeTo({duration:300,easeId:"keyboardHandler",easing:Rd,zoom:d?Math.round(F)+d*(s.shiftKey?2:1):F,bearing:C.getBearing()+g*this._bearingStep,pitch:C.getPitch()+x*this._pitchStep,offset:[-b*this._panStep,-S*this._panStep],center:C.getCenter()},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Rd(m){return m*(2-m)}let Bh=4.000244140625,Vm=1/450;class Es{constructor(s,d){this._map=s,this._el=s.getCanvasContainer(),this._handler=d,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Vm,r.bp(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!s&&s.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(s){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(s.ctrlKey||s.metaKey||this.isZooming()||r.d1()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let d=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY,g=r.e.now(),x=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,d!==0&&d%Bh==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(x*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),s.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=s,this._delta-=d,this._active||this._start(s)),s.preventDefault()}_onTimeout(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let d=he(this._el,s);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:d,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let s=this._map.transform;this._type==="wheel"&&s.projection.wrap&&(s._center.lng>=180||s._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);let d=()=>s._terrainEnabled()&&this._aroundCoord?s.computeZoomRelativeTo(this._aroundCoord):s.zoom;if(this._delta!==0){let O=this._type==="wheel"&&Math.abs(this._delta)>Bh?this._wheelZoomRate:this._defaultZoomRate,V=2/(1+Math.exp(-Math.abs(this._delta*O)));this._delta<0&&V!==0&&(V=1/V);let X=d(),ie=Math.pow(2,X),ae=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):ie;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(ae*V))),this._type==="wheel"&&(this._startZoom=X,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}let g=typeof this._targetZoom=="number"?this._targetZoom:d(),x=this._startZoom,b=this._easing,S,C=!1;if(this._type==="wheel"&&x&&b){let O=Math.min((r.e.now()-this._lastWheelEventTime)/200,1),V=b(O);S=r.a2(x,g,V),O<1?this._frameId||(this._frameId=!0):C=!0}else S=g,C=!0;this._active=!0,C&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let F=S-d();return F*this._lastDelta<0&&(F=0),{noInertia:!0,needsRenderFrame:!C,zoomDelta:F,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let d=r.d2;if(this._prevEase){let g=this._prevEase,x=(r.e.now()-g.start)/g.duration,b=g.easing(x+.01)-g.easing(x),S=.27/Math.sqrt(b*b+1e-4)*.01,C=Math.sqrt(.0729-S*S);d=r.d0(S,C,.25,1)}return this._prevEase={start:r.e.now(),duration:s,easing:d},d}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=D("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class zh{constructor(s,d){this._clickZoom=s,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Fd{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(s,d){return s.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(s.shiftKey?-1:1),around:g.unproject(d)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Pd{constructor(){this._tap=new Oh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(s,d,g){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=d[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(s,d,g))}touchmove(s,d,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;let x=d[0],b=x.y-this._swipePoint.y;return this._swipePoint=x,s.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(s,d,g)}touchend(s,d,g){this._tapTime?this._swipePoint&&g.length===0&&this.reset():this._tap.touchend(s,d,g)&&(this._tapTime=s.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jh{constructor(s,d,g){this._el=s,this._mousePan=d,this._touchPan=g}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ld{constructor(s,d,g){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=d,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class fu{constructor(s,d,g,x){this._el=s,this._touchZoom=d,this._touchRotate=g,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}let qu=m=>m.zoom||m.drag||m.pitch||m.rotate;class Bp extends r.f{}class $u{constructor(){this.constants=[1,1,.01],this.radius=0}setup(s,d){let g=r._.sub([],d,s);this.radius=r._.length(g[2]<0?r._.div([],g,this.constants):[g[0],g[1],0])}projectRay(s){r._.div(s,s,this.constants),r._.normalize(s,s),r._.mul(s,s,this.constants);let d=r._.scale([],s,this.radius);if(d[2]>0){let g=r._.scale([],[0,0,1],r._.dot(d,[0,0,1])),x=r._.scale([],r._.normalize([],[d[0],d[1],0]),this.radius),b=r._.add([],d,r._.scale([],r._.sub([],r._.add([],x,g),d),2));d[0]=b[0],d[1]=b[1]}return d}}function Uh(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class If{constructor(s,d){this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new to(s),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new $u,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(d),r.bp(["handleEvent","handleWindowEvent"],this);let g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(let[x,b,S]of this._listeners){let C=x===document?this.handleWindowEvent:this.handleEvent;x.addEventListener(b,C,S)}}destroy(){for(let[s,d,g]of this._listeners){let x=s===document?this.handleWindowEvent:this.handleEvent;s.removeEventListener(d,x,g)}}_addDefaultHandlers(s){let d=this._map,g=d.getCanvasContainer();this._add("mapEvent",new uu(d,s));let x=d.boxZoom=new ya(d,s);this._add("boxZoom",x);let b=new Vu,S=new Fd;d.doubleClickZoom=new zh(S,b),this._add("tapZoom",b),this._add("clickZoom",S);let C=new Pd;this._add("tapDragZoom",C);let F=d.touchPitch=new Um(d);this._add("touchPitch",F);let O=new hu(s),V=new ul(s);d.dragRotate=new Ld(s,O,V),this._add("mouseRotate",O,["mousePitch"]),this._add("mousePitch",V,["mouseRotate"]);let X=new cl(s),ie=new Np(d,s);d.dragPan=new jh(g,X,ie),this._add("mousePan",X),this._add("touchPan",ie,["touchZoom","touchRotate"]);let ae=new Wu,ue=new Md;d.touchZoomRotate=new fu(g,ue,ae,C),this._add("touchRotate",ae,["touchPan","touchZoom"]),this._add("touchZoom",ue,["touchPan","touchRotate"]),this._add("blockableMapEvent",new ll(d));let de=d.scrollZoom=new Es(d,this);this._add("scrollZoom",de,["mousePan"]);let fe=d.keyboard=new du;this._add("keyboard",fe);for(let me of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])s.interactive&&s[me]&&d[me].enable(s[me])}_add(s,d,g){this._handlers.push({handlerName:s,handler:d,allowed:g}),this._handlersById[s]=d}stop(s){if(!this._updatingCamera){for(let{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[],this._originalZoom=void 0}}isActive(){for(let{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!qu(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(s,d,g){for(let x in s)if(x!==g&&(!d||d.indexOf(x)<0))return!0;return!1}handleWindowEvent(s){this.handleEvent(s,`${s.type}Window`)}_getMapTouches(s){let d=[];for(let g of s)this._el.contains(g.target)&&d.push(g);return d}handleEvent(s,d){this._updatingCamera=!0;let g=s.type==="renderFrame",x=g?void 0:s,b={needsRenderFrame:!1},S={},C={},F=s.touches?this._getMapTouches(s.touches):void 0,O=F?Me(this._el,F):g?void 0:he(this._el,s);for(let{handlerName:ie,handler:ae,allowed:ue}of this._handlers){if(!ae.isEnabled())continue;let de;this._blockedByActive(C,ue,ie)?ae.reset():ae[d||s.type]&&(de=ae[d||s.type](s,O,F),this.mergeHandlerResult(b,S,de,ie,x),de&&de.needsRenderFrame&&this._triggerRenderFrame()),(de||ae.isActive())&&(C[ie]=ae)}let V={};for(let ie in this._previousActiveHandlers)C[ie]||(V[ie]=x);this._previousActiveHandlers=C,(Object.keys(V).length||Uh(b))&&(this._changes.push([b,S,V]),this._triggerRenderFrame()),(Object.keys(C).length||Uh(b))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:X}=b;X&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],X(this._map))}mergeHandlerResult(s,d,g,x,b){if(!g)return;r.W(s,g);let S={handlerName:x,originalEvent:g.originalEvent||b};g.zoomDelta!==void 0&&(d.zoom=S),g.panDelta!==void 0&&(d.drag=S),g.pitchDelta!==void 0&&(d.pitch=S),g.bearingDelta!==void 0&&(d.rotate=S)}_applyChanges(){let s={},d={},g={};for(let[x,b,S]of this._changes)x.panDelta&&(s.panDelta=(s.panDelta||new r.P(0,0))._add(x.panDelta)),x.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+x.pitchDelta),x.around!==void 0&&(s.around=x.around),x.aroundCoord!==void 0&&(s.aroundCoord=x.aroundCoord),x.pinchAround!==void 0&&(s.pinchAround=x.pinchAround),x.noInertia&&(s.noInertia=x.noInertia),r.W(d,b),r.W(g,S);this._updateMapTransform(s,d,g),this._changes=[]}_updateMapTransform(s,d,g){let x=this._map,b=x.transform,S=Pe=>[Pe.x,Pe.y,Pe.z];if((Pe=>{let Oe=this._eventsInProgress.drag;return Oe&&!this._handlersById[Oe.handlerName].isActive()})()&&!Uh(s)){let Pe=b.zoom;b.cameraElevationReference="sea",this._originalZoom!=null&&b._orthographicProjectionAtLowPitch&&b.projection.name!=="globe"&&b.pitch===0?(b.cameraElevationReference="ground",b.zoom=this._originalZoom):(b.recenterOnTerrain(),b.cameraElevationReference="ground"),Pe!==b.zoom&&this._map._update(!0)}if(b._isCameraConstrained&&x._stop(!0),!Uh(s))return void this._fireEvents(d,g,!0);let{panDelta:C,zoomDelta:F,bearingDelta:O,pitchDelta:V,around:X,aroundCoord:ie,pinchAround:ae}=s;b._isCameraConstrained&&(F>0&&(F=0),b._isCameraConstrained=!1),ae!==void 0&&(X=ae),(F||(Pe=>d[Pe]&&!this._eventsInProgress[Pe])("drag"))&&X&&(this._dragOrigin=S(b.pointCoordinate3D(X)),this._originalZoom=b.zoom,this._trackingEllipsoid.setup(b._camera.position,this._dragOrigin)),b.cameraElevationReference="sea",x._stop(!0),X=X||x.transform.centerPoint,O&&(b.bearing+=O),V&&(b.pitch+=V),b._updateCameraState();let ue=[0,0,0];if(C)if(b.projection.name==="mercator"){let Pe=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(X).dir),Oe=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(X.sub(C)).dir);ue[0]=Oe[0]-Pe[0],ue[1]=Oe[1]-Pe[1]}else{let Pe=b.pointCoordinate(X);if(b.projection.name==="globe"){C=C.rotate(-b.angle);let Oe=b._pixelsPerMercatorPixel/b.worldSize;ue[0]=-C.x*r.d3(r.ay(Pe.y))*Oe,ue[1]=-C.y*r.d3(b.center.lat)*Oe}else{let Oe=b.pointCoordinate(X.sub(C));Pe&&Oe&&(ue[0]=Oe.x-Pe.x,ue[1]=Oe.y-Pe.y)}}let de=b.zoom,fe=[0,0,0];if(F){let Pe=S(ie||b.pointCoordinate3D(X)),Oe={dir:r._.normalize([],r._.sub([],Pe,b._camera.position))};if(Oe.dir[2]<0){let Ne=b.zoomDeltaToMovement(Pe,F);r._.scale(fe,Oe.dir,Ne)}}let me=r._.add(ue,ue,fe);b._translateCameraConstrained(me),F&&Math.abs(b.zoom-de)>1e-4&&b.recenterOnTerrain(),b.cameraElevationReference="ground",this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(d,g,!0)}_fireEvents(s,d,g){let x=qu(this._eventsInProgress),b=qu(s),S={};for(let V in s){let{originalEvent:X}=s[V];this._eventsInProgress[V]||(S[`${V}start`]=X),this._eventsInProgress[V]=s[V]}!x&&b&&this._fireEvent("movestart",b.originalEvent);for(let V in S)this._fireEvent(V,S[V]);b&&this._fireEvent("move",b.originalEvent);for(let V in s){let{originalEvent:X}=s[V];this._fireEvent(V,X)}let C={},F;for(let V in this._eventsInProgress){let{handlerName:X,originalEvent:ie}=this._eventsInProgress[V];this._handlersById[X].isActive()||(delete this._eventsInProgress[V],F=d[X]||ie,C[`${V}end`]=F)}for(let V in C)this._fireEvent(V,C[V]);let O=qu(this._eventsInProgress);if(g&&(x||b)&&!O){this._updatingCamera=!0;let V=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),X=ie=>ie!==0&&-this._bearingSnap<ie&&ie<this._bearingSnap;V?(X(V.bearing||this._map.getBearing())&&(V.bearing=0),this._map.easeTo(V,{originalEvent:F})):(this._map.fire(new r.f("moveend",{originalEvent:F})),X(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(s,d){this._map.fire(new r.f(s,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{this._frameId=void 0,this.handleEvent(new Bp("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}let As="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Gm extends r.E{constructor(s,d){super(),this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=d.bearingSnap,this._respectPrefersReducedMotion=d.respectPrefersReducedMotion!==!1,r.bp(["_renderFrameCallback"],this)}getCenter(){return new r.aI(this.transform.center.lng,this.transform.center.lat)}setCenter(s,d){return this.jumpTo({center:s},d)}panBy(s,d,g){return s=r.P.convert(s).mult(-1),this.panTo(this.transform.center,r.W({offset:s},d),g)}panTo(s,d,g){return this.easeTo(r.W({center:s},d),g)}getZoom(){return this.transform.zoom}setZoom(s,d){return this.jumpTo({zoom:s},d),this}zoomTo(s,d,g){return this.easeTo(r.W({zoom:s},d),g)}zoomIn(s,d){return this.zoomTo(this.getZoom()+1,s,d),this}zoomOut(s,d){return this.zoomTo(this.getZoom()-1,s,d),this}getBearing(){return this.transform.bearing}setBearing(s,d){return this.jumpTo({bearing:s},d),this}getPadding(){return this.transform.padding}setPadding(s,d){return this.jumpTo({padding:s},d),this}rotateTo(s,d,g){return this.easeTo(r.W({bearing:s},d),g)}resetNorth(s,d){return this.rotateTo(0,r.W({duration:1e3},s),d),this}resetNorthPitch(s,d){return this.easeTo(r.W({bearing:0,pitch:0,duration:1e3},s),d),this}snapToNorth(s,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,d):this}getPitch(){return this.transform.pitch}setPitch(s,d){return this.jumpTo({pitch:s},d),this}cameraForBounds(s,d){s=r.ai.convert(s);let g=d&&d.bearing||0,x=d&&d.pitch||0,b=s.getNorthWest(),S=s.getSouthEast();return this._cameraForBounds(this.transform,b,S,g,x,d)}_extendPadding(s){let d={top:0,right:0,bottom:0,left:0};return s==null?r.W({},d,this.transform.padding):typeof s=="number"?{top:s,bottom:s,right:s,left:s}:r.W({},d,s)}_extendCameraOptions(s){return(s=r.W({offset:[0,0],maxZoom:this.transform.maxZoom},s)).padding=this._extendPadding(s.padding),s}_minimumAABBFrustumDistance(s,d){let g=d.max[0]-d.min[0],x=d.max[1]-d.min[1];return g/x>s.aspect?g/(2*Math.tan(.5*s.fovX)*s.aspect):x/(2*Math.tan(.5*s.fovY)*s.aspect)}_cameraForBoundsOnGlobe(s,d,g,x,b,S){let C=s.clone(),F=this._extendCameraOptions(S);C.bearing=x,C.pitch=b;let O=r.aI.convert(d),V=r.aI.convert(g),X=.5*(O.lat+V.lat),ie=.5*(O.lng+V.lng),ae=r.d4(X,ie),ue=r._.normalize([],ae),de=r._.normalize([],r._.cross([],ue,[0,1,0])),fe=r._.cross([],de,ue),me=[de[0],de[1],de[2],0,fe[0],fe[1],fe[2],0,ue[0],ue[1],ue[2],0,0,0,0,1],Pe=[ae,r.d4(O.lat,O.lng),r.d4(V.lat,O.lng),r.d4(V.lat,V.lng),r.d4(O.lat,V.lng),r.d4(X,O.lng),r.d4(X,V.lng),r.d4(O.lat,ie),r.d4(V.lat,ie)],Oe=r.b6.fromPoints(Pe.map(jt=>[r._.dot(de,jt),r._.dot(fe,jt),r._.dot(ue,jt)])),Ne=r._.transformMat4([],Oe.center,me);r._.squaredLength(Ne)===0&&r._.set(Ne,0,0,1),r._.normalize(Ne,Ne),r._.scale(Ne,Ne,r.cD),C.center=r.d5(Ne);let Je=C.getWorldToCameraMatrix(),Ke=r.ad.invert(new Float64Array(16),Je);Oe=r.b6.applyTransform(Oe,r.ad.multiply([],Je,me));let Fe=this._extendAABB(Oe,C,F,x);if(!Fe)return void r.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Oe=Fe,r._.transformMat4(Ne,Ne,Je);let Be=.5*(Oe.max[2]-Oe.min[2]),je=this._minimumAABBFrustumDistance(C,Oe),at=r._.scale([],[0,0,1],Be),xt=r._.add(at,Ne,at),qe=je+(C.pitch===0?0:r._.distance(Ne,xt)),bt=C.globeCenterInViewSpace,Ct=r._.sub([],Ne,[bt[0],bt[1],bt[2]]);r._.normalize(Ct,Ct),r._.scale(Ct,Ct,qe);let Gt=r._.add([],Ne,Ct);r._.transformMat4(Gt,Gt,Ke);let qt=r.d7/r.cD,Vt=r._.length(Gt),ft=r.ax(Math.max(Vt*qt-r.d7,Number.EPSILON),0),kt=Math.min(C.zoomFromMercatorZAdjusted(ft),F.maxZoom);return kt>.5*(r.b1+r.aU)?(C.setProjection({name:"mercator"}),C.zoom=kt,this._cameraForBounds(C,d,g,x,b,S)):{center:C.center,zoom:kt,bearing:x,pitch:b}}_extendAABB(s,d,g,x){let b=.5*((g.padding.left||0)+(g.padding.right||0)),S=.5*((g.padding.top||0)+(g.padding.bottom||0)),C=S,F=b,O=b,V=S,X=d.width-(F+O),ie=d.height-(C+V),ae=r._.sub([],s.max,s.min),ue=Math.min(X/ae[0],ie/ae[1]),de=Math.min(d.scaleZoom(d.scale*ue),g.maxZoom);if(isNaN(de))return null;let fe=d.scale/d.zoomScale(de),me=new r.b6([s.min[0]-F*fe,s.min[1]-V*fe,s.min[2]],[s.max[0]+O*fe,s.max[1]+C*fe,s.max[2]]),Pe=(typeof g.offset.x=="number"&&typeof g.offset.y=="number"?new r.P(g.offset.x,g.offset.y):r.P.convert(g.offset)).rotate(-r.ab(x));return me.center[0]-=Pe.x*fe,me.center[1]+=Pe.y*fe,me}queryTerrainElevation(s,d){let g=this.transform.elevation;return g?(d=r.W({},{exaggerated:!0},d),g.getAtPoint(r.Y.fromLngLat(s),null,d.exaggerated)):null}_cameraForBounds(s,d,g,x,b,S){if(s.projection.name==="globe")return this._cameraForBoundsOnGlobe(s,d,g,x,b,S);let C=s.clone(),F=this._extendCameraOptions(S);C.bearing=x,C.pitch=b;let O=r.aI.convert(d),V=r.aI.convert(g),X=new r.aI(O.lng,V.lat),ie=new r.aI(V.lng,O.lat),ae=C.project(O),ue=C.project(V),de=this.queryTerrainElevation(O),fe=this.queryTerrainElevation(V),me=this.queryTerrainElevation(X),Pe=this.queryTerrainElevation(ie),Oe=[[ae.x,ae.y,Math.min(de||0,fe||0,me||0,Pe||0)],[ue.x,ue.y,Math.max(de||0,fe||0,me||0,Pe||0)]],Ne=r.b6.fromPoints(Oe),Je=C.getWorldToCameraMatrix(),Ke=r.ad.invert(new Float64Array(16),Je);Ne=r.b6.applyTransform(Ne,Je);let Fe=this._extendAABB(Ne,C,F,x);if(!Fe)return void r.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ne=Fe;let Be=.5*r._.sub([],Ne.max,Ne.min)[2],je=this._minimumAABBFrustumDistance(C,Ne),at=[0,0,1,0];r.aA.transformMat4(at,at,Je),r.aA.normalize(at,at);let xt=r._.scale([],at,je+Be),qe=r._.add([],Ne.center,xt);r._.transformMat4(Ne.center,Ne.center,Ke),r._.transformMat4(qe,qe,Ke);let bt=[Ne.center[0],Ne.center[1],qe[2]*C.pixelsPerMeter];r._.scale(bt,bt,1/C.worldSize);let Ct=r.d6(bt[0]),Gt=r.ay(bt[1]),qt=Math.min(C._zoomFromMercatorZ(bt[2]),F.maxZoom),Vt=new r.aI(Ct,Gt);return C.mercatorFromTransition&&qt<.5*(r.b1+r.aU)?(C.setProjection({name:"globe"}),C.zoom=qt,this._cameraForBounds(C,d,g,x,b,S)):{center:Vt,zoom:qt,bearing:x,pitch:b}}fitBounds(s,d,g){let x=this.cameraForBounds(s,d);return this._fitInternal(x,d,g)}fitScreenCoordinates(s,d,g,x,b){let S=r.P.convert(s),C=r.P.convert(d),F=new r.P(Math.min(S.x,C.x),Math.min(S.y,C.y)),O=new r.P(Math.max(S.x,C.x),Math.max(S.y,C.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(S,C))return this;let V=this.transform.pointLocation3D(F),X=this.transform.pointLocation3D(O),ie=this.transform.pointLocation3D(new r.P(F.x,O.y)),ae=this.transform.pointLocation3D(new r.P(O.x,F.y)),ue=[Math.min(V.lng,X.lng,ie.lng,ae.lng),Math.min(V.lat,X.lat,ie.lat,ae.lat)],de=[Math.max(V.lng,X.lng,ie.lng,ae.lng),Math.max(V.lat,X.lat,ie.lat,ae.lat)],fe=x&&x.pitch?x.pitch:this.getPitch(),me=this._cameraForBounds(this.transform,ue,de,g,fe,x);return this._fitInternal(me,x,b)}_fitInternal(s,d,g){return s?(d=r.W(s,d)).linear?this.easeTo(d,g):this.flyTo(d,g):this}jumpTo(s,d){this.stop();let g=s.preloadOnly?this.transform.clone():this.transform,x=!1,b=!1,S=!1;return"zoom"in s&&g.zoom!==+s.zoom&&(x=!0,g.zoom=+s.zoom),s.center!==void 0&&(g.center=r.aI.convert(s.center)),"bearing"in s&&g.bearing!==+s.bearing&&(b=!0,g.bearing=+s.bearing),"pitch"in s&&g.pitch!==+s.pitch&&(S=!0,g.pitch=+s.pitch),s.padding==null||g.isPaddingEqual(s.padding)||(g.padding=s.padding),s.preloadOnly?(this._preloadTiles(g),this):(this.fire(new r.f("movestart",d)).fire(new r.f("move",d)),x&&this.fire(new r.f("zoomstart",d)).fire(new r.f("zoom",d)).fire(new r.f("zoomend",d)),b&&this.fire(new r.f("rotatestart",d)).fire(new r.f("rotate",d)).fire(new r.f("rotateend",d)),S&&this.fire(new r.f("pitchstart",d)).fire(new r.f("pitch",d)).fire(new r.f("pitchend",d)),this.fire(new r.f("moveend",d)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||r.w(As),this.transform.getFreeCameraOptions()}setFreeCameraOptions(s,d){let g=this.transform;if(!g.projection.supportsFreeCamera)return r.w(As),this;this.stop();let x=g.zoom,b=g.pitch,S=g.bearing;g.setFreeCameraOptions(s);let C=x!==g.zoom,F=b!==g.pitch,O=S!==g.bearing;return this.fire(new r.f("movestart",d)).fire(new r.f("move",d)),C&&this.fire(new r.f("zoomstart",d)).fire(new r.f("zoom",d)).fire(new r.f("zoomend",d)),O&&this.fire(new r.f("rotatestart",d)).fire(new r.f("rotate",d)).fire(new r.f("rotateend",d)),F&&this.fire(new r.f("pitchstart",d)).fire(new r.f("pitch",d)).fire(new r.f("pitchend",d)),this.fire(new r.f("moveend",d)),this}easeTo(s,d){this._stop(!1,s.easeId),((s=r.W({offset:[0,0],duration:500,easing:r.d2},s)).animate===!1||this._prefersReducedMotion(s))&&(s.duration=0);let g=this.transform,x=this.getZoom(),b=this.getBearing(),S=this.getPitch(),C=this.getPadding(),F="zoom"in s?+s.zoom:x,O="bearing"in s?this._normalizeBearing(s.bearing,b):b,V="pitch"in s?+s.pitch:S,X=this._extendPadding(s.padding),ie=r.P.convert(s.offset),ae,ue,de;if(g.projection.name==="globe"){let je=r.Y.fromLngLat(g.center),at=ie.rotate(-g.angle);je.x+=at.x/g.worldSize,je.y+=at.y/g.worldSize;let xt=je.toLngLat(),qe=r.aI.convert(s.center||xt);this._normalizeCenter(qe),ae=g.centerPoint.add(at),ue=new r.P(je.x,je.y).mult(g.worldSize),de=new r.P(r.aj(qe.lng),r.ak(qe.lat)).mult(g.worldSize).sub(ue)}else{ae=g.centerPoint.add(ie);let je=g.pointLocation(ae),at=r.aI.convert(s.center||je);this._normalizeCenter(at),ue=g.project(je),de=g.project(at).sub(ue)}let fe=g.zoomScale(F-x),me,Pe;s.around&&(me=r.aI.convert(s.around),Pe=g.locationPoint(me));let Oe=this._zooming||F!==x,Ne=this._rotating||b!==O,Je=this._pitching||V!==S,Ke=!g.isPaddingEqual(X),Fe=je=>at=>{if(Oe&&(je.zoom=r.a2(x,F,at)),Ne&&(je.bearing=r.a2(b,O,at)),Je&&(je.pitch=r.a2(S,V,at)),Ke&&(je.interpolatePadding(C,X,at),ae=je.centerPoint.add(ie)),me)je.setLocationAtPoint(me,Pe);else{let xt=je.zoomScale(je.zoom-x),qe=F>x?Math.min(2,fe):Math.max(.5,fe),bt=Math.pow(qe,1-at),Ct=je.unproject(ue.add(de.mult(at*bt)).mult(xt));je.setLocationAtPoint(je.renderWorldCopies?Ct.wrap():Ct,ae)}return s.preloadOnly||this._fireMoveEvents(d),je};if(s.preloadOnly){let je=this._emulate(Fe,s.duration,g);return this._preloadTiles(je),this}let Be={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Oe,this._rotating=Ne,this._pitching=Je,this._padding=Ke,this._easeId=s.easeId,this._prepareEase(d,s.noMoveStart,Be),this._ease(Fe(g),je=>{g.cameraElevationReference==="sea"&&g.recenterOnTerrain(),this._afterEase(d,je)},s),this}_prepareEase(s,d,g={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),d||g.moving||this.fire(new r.f("movestart",s)),this._zooming&&!g.zooming&&this.fire(new r.f("zoomstart",s)),this._rotating&&!g.rotating&&this.fire(new r.f("rotatestart",s)),this._pitching&&!g.pitching&&this.fire(new r.f("pitchstart",s))}_fireMoveEvents(s){this.fire(new r.f("move",s)),this._zooming&&this.fire(new r.f("zoom",s)),this._rotating&&this.fire(new r.f("rotate",s)),this._pitching&&this.fire(new r.f("pitch",s))}_afterEase(s,d){if(this._easeId&&d&&this._easeId===d)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";let g=this._zooming,x=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new r.f("zoomend",s)),x&&this.fire(new r.f("rotateend",s)),b&&this.fire(new r.f("pitchend",s)),this.fire(new r.f("moveend",s))}flyTo(s,d){if(this._prefersReducedMotion(s)){let kt=r.ah(s,["center","zoom","bearing","pitch","around","padding"]);return this.jumpTo(kt,d)}this.stop(),s=r.W({offset:[0,0],speed:1.2,curve:1.42,easing:r.d2},s);let g=this.transform,x=this.getZoom(),b=this.getBearing(),S=this.getPitch(),C=this.getPadding(),F="zoom"in s?r.at(+s.zoom,g.minZoom,g.maxZoom):x,O="bearing"in s?this._normalizeBearing(s.bearing,b):b,V="pitch"in s?+s.pitch:S,X=this._extendPadding(s.padding),ie=g.zoomScale(F-x),ae=r.P.convert(s.offset),ue=g.centerPoint.add(ae),de=g.pointLocation(ue),fe=r.aI.convert(s.center||de);this._normalizeCenter(fe);let me=g.project(de),Pe=g.project(fe).sub(me),Oe=s.curve,Ne=Math.max(g.width,g.height),Je=Ne/ie,Ke=Pe.mag();if("minZoom"in s){let kt=r.at(Math.min(s.minZoom,x,F),g.minZoom,g.maxZoom),jt=Ne/g.zoomScale(kt-x);Oe=Math.sqrt(jt/Ke*2)}let Fe=Oe*Oe;function Be(kt){let jt=(Je*Je-Ne*Ne+(kt?-1:1)*Fe*Fe*Ke*Ke)/(2*(kt?Je:Ne)*Fe*Ke);return Math.log(Math.sqrt(jt*jt+1)-jt)}function je(kt){return(Math.exp(kt)-Math.exp(-kt))/2}function at(kt){return(Math.exp(kt)+Math.exp(-kt))/2}let xt=Be(0),qe=function(kt){return at(xt)/at(xt+Oe*kt)},bt=function(kt){return Ne*((at(xt)*(je(jt=xt+Oe*kt)/at(jt))-je(xt))/Fe)/Ke;var jt},Ct=(Be(1)-xt)/Oe;if(Math.abs(Ke)<1e-6||!isFinite(Ct)){if(Math.abs(Ne-Je)<1e-6)return this.easeTo(s,d);let kt=Je<Ne?-1:1;Ct=Math.abs(Math.log(Je/Ne))/Oe,bt=function(){return 0},qe=function(jt){return Math.exp(kt*Oe*jt)}}s.duration="duration"in s?+s.duration:1e3*Ct/("screenSpeed"in s?+s.screenSpeed/Oe:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0);let Gt=b!==O,qt=V!==S,Vt=!g.isPaddingEqual(X),ft=kt=>jt=>{let dr=jt*Ct,pr=1/qe(dr);kt.zoom=jt===1?F:x+kt.scaleZoom(pr),Gt&&(kt.bearing=r.a2(b,O,jt)),qt&&(kt.pitch=r.a2(S,V,jt)),Vt&&(kt.interpolatePadding(C,X,jt),ue=kt.centerPoint.add(ae));let Cr=jt===1?fe:kt.unproject(me.add(Pe.mult(bt(dr))).mult(pr));return kt.setLocationAtPoint(kt.renderWorldCopies?Cr.wrap():Cr,ue),kt._updateCameraOnTerrain(),s.preloadOnly||this._fireMoveEvents(d),kt};if(s.preloadOnly){let kt=this._emulate(ft,s.duration,g);return this._preloadTiles(kt),this}return this._zooming=!0,this._rotating=Gt,this._pitching=qt,this._padding=Vt,this._prepareEase(d,!1),this._ease(ft(g),()=>this._afterEase(d),s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(s){}_cancelRenderFrame(s){}_stop(s,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){let g=this._onEaseEnd;this._onEaseEnd=void 0,g.call(this,d)}if(!s){let g=this.handlers;g&&g.stop(!1)}return this}_ease(s,d,g){g.animate===!1||g.duration===0?(s(1),d()):(this._easeStart=r.e.now(),this._easeOptions=g,this._onEaseFrame=s,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){let s=Math.min((r.e.now()-this._easeStart)/this._easeOptions.duration,1),d=this._onEaseFrame;d&&d(this._easeOptions.easing(s)),s<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(s,d){s=r.au(s,-180,180);let g=Math.abs(s-d);return Math.abs(s-360-d)<g&&(s-=360),Math.abs(s+360-d)<g&&(s+=360),s}_normalizeCenter(s){let d=this.transform;if(d.maxBounds||d.projection.name!=="globe"&&!d.renderWorldCopies)return;let g=s.lng-d.center.lng;s.lng+=g>180?-360:g<-180?360:0}_prefersReducedMotion(s){return this._respectPrefersReducedMotion&&r.e.prefersReducedMotion&&!(s&&s.essential)}_emulate(s,d,g){let x=Math.ceil(15*d/1e3),b=[],S=s(g.clone());for(let C=0;C<=x;C++){let F=S(C/x);b.push(F.clone())}return b}_preloadTiles(s,d){}}class zp{constructor(s={}){this.options=s,r.bp(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(s){let d=this.options&&this.options.compact;return this._map=s,this._container=D("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=D("button","mapboxgl-ctrl-attrib-button",this._container),D("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=D("div","mapboxgl-ctrl-attrib-inner",this._container),d&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),d===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(s,d){let g=this._map._getUIString(`AttributionControl.${d}`);s.removeAttribute("title"),s.firstElementChild&&s.firstElementChild.setAttribute("title",g)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));let d=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||r.d8.ACCESS_TOKEN}];if(s){let g=d.reduce((x,b,S)=>(b.value&&(x+=`${b.key}=${b.value}${S<d.length-1?"&":""}`),x),"?");s.href=`${r.d8.FEEDBACK_URL}/${g}#${ko(this._map,!0)}`,s.rel="noopener nofollow",this._setElementTitle(s,"MapFeedback")}}_updateData(s){!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let s=[];if(this._map.style.stylesheet){let x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}let d=this._map.style._mergedSourceCaches;for(let x in d){let b=d[x];if(b.used){let S=b.getSource();S.attribution&&s.indexOf(S.attribution)<0&&s.push(S.attribution)}}s.sort((x,b)=>x.length-b.length),s=s.filter((x,b)=>{for(let S=b+1;S<s.length;S++)if(s[S].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=[...this.options.customAttribution,...s]:s.unshift(this.options.customAttribution));let g=s.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,s.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Hm{constructor(){r.bp(["_updateLogo","_updateCompact"],this)}onAdd(s){this._map=s,this._container=D("div","mapboxgl-ctrl");let d=D("a","mapboxgl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://www.mapbox.com/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(s){s&&s.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;let s=this._map.style._sourceCaches;if(Object.entries(s).length===0)return!0;for(let d in s){let g=s[d].getSource();if(g.hasOwnProperty("mapbox_logo")&&!g.mapbox_logo)return!1}return!0}_updateCompact(){let s=this._container.children;if(s.length){let d=s[0];this._map.getCanvasContainer().offsetWidth<250?d.classList.add("mapboxgl-compact"):d.classList.remove("mapboxgl-compact")}}}class jp{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){let d=++this._id;return this._queue.push({callback:s,id:d,cancelled:!1}),d}remove(s){let d=this._currentlyRunning,g=d?this._queue.concat(d):this._queue;for(let x of g)if(x.id===s)return void(x.cancelled=!0)}run(s=0){let d=this._currentlyRunning=this._queue;this._queue=[];for(let g of d)if(!g.cancelled&&(g.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Xu(m,s,d){if(m=new r.aI(m.lng,m.lat),s){let g=new r.aI(m.lng-360,m.lat),x=new r.aI(m.lng+360,m.lat),b=360*Math.ceil(Math.abs(m.lng-d.center.lng)/360),S=d.locationPoint(m).distSqr(s),C=s.x<0||s.y<0||s.x>d.width||s.y>d.height;d.locationPoint(g).distSqr(s)<S&&(C||Math.abs(g.lng-d.center.lng)<b)?m=g:d.locationPoint(x).distSqr(s)<S&&(C||Math.abs(x.lng-d.center.lng)<b)&&(m=x)}for(;Math.abs(m.lng-d.center.lng)>180;){let g=d.locationPoint(m);if(g.x>=0&&g.y>=0&&g.x<=d.width&&g.y<=d.height)break;m.lng>d.center.lng?m.lng-=360:m.lng+=360}return m}let Up={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Vh extends r.E{constructor(s,d){if(super(),(s instanceof HTMLElement||d)&&(s=r.W({element:s},d)),r.bp(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=s&&s.anchor||"center",this._color=s&&s.color||"#3FB1CE",this._scale=s&&s.scale||1,this._draggable=s&&s.draggable||!1,this._clickTolerance=s&&s.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=s&&s.rotation||0,this._rotationAlignment=s&&s.rotationAlignment||"auto",this._pitchAlignment=s&&s.pitchAlignment&&s.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=s&&s.occludedOpacity||.2,s&&s.element)this._element=s.element,this._offset=r.P.convert(s&&s.offset||[0,0]);else{this._defaultMarker=!0,this._element=D("div");let b=41,S=27,C=j("svg",{display:"block",height:b*this._scale+"px",width:S*this._scale+"px",viewBox:`0 0 ${S} ${b}`},this._element),F=j("radialGradient",{id:"shadowGradient"},j("defs",{},C));j("stop",{offset:"10%","stop-opacity":.4},F),j("stop",{offset:"100%","stop-opacity":.05},F),j("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},C),j("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},C),j("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},C),j("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},C),this._offset=r.P.convert(s&&s.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",b=>{b.preventDefault()}),this._element.addEventListener("mousedown",b=>{b.preventDefault()});let g=this._element.classList;for(let b in Up)g.remove(`mapboxgl-marker-anchor-${b}`);g.add(`mapboxgl-marker-anchor-${this._anchor}`);let x=s&&s.className?s.className.trim().split(/\s+/):[];g.add(...x),this._popup=null}addTo(s){return s===this._map||(this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._updateMoving),s.on("moveend",this._update),s.on("remove",this._clearFadeTimer),s._addMarker(this),this.setDraggable(this._draggable),this._update(),s.on("click",this._onMapClick)),this}remove(){let s=this._map;return s&&(s.off("click",this._onMapClick),s.off("move",this._updateMoving),s.off("moveend",this._update),s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler),s.off("mouseup",this._onUp),s.off("touchend",this._onUp),s.off("mousemove",this._onMove),s.off("touchmove",this._onMove),s.off("remove",this._clearFadeTimer),s._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=r.aI.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){let x=Math.sqrt(Math.pow(13.5,2)/2);s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=s,s._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(s){let d=s.code,g=s.charCode||s.keyCode;d!=="Space"&&d!=="Enter"&&g!==32&&g!==13||this.togglePopup()}_onMapClick(s){let d=s.originalEvent.target,g=this._element;this._popup&&(d===g||g.contains(d))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){let s=this._popup;return s?(s.isOpen()?(s.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(s.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){let s=this._map,d=this._pos;if(!s||!d)return!1;let g=s.unproject(d),x=s.getFreeCameraOptions();if(!x.position)return!1;let b=x.position.toLngLat();return b.distanceTo(g)<.9*b.distanceTo(this._lngLat)}_evaluateOpacity(){let s=this._map;if(!s)return;let d=this._pos;if(!d||d.x<0||d.x>s.transform.width||d.y<0||d.y>s.transform.height)return void this._clearFadeTimer();let g=s.unproject(d),x;s._showingGlobe()&&r.d9(s.transform,this._lngLat)?x=0:(x=1-s._queryFogOpacity(g),s.transform._terrainEnabled()&&s.getTerrain()&&this._behindTerrain()&&(x*=this._occludedOpacity)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){let s=this._pos;if(!s||!this._map)return;let d=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${s.x}px,${s.y}px)
            ${Up[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${d.x}px,${d.y}px)
        `}_calculateXYTransform(){let s=this._pos,d=this._map,g=this.getPitchAlignment();if(!d||!s||g!=="map")return"";if(!d._showingGlobe()){let F=d.getPitch();return F?`rotateX(${F}deg)`:""}let x=r.b0(r.da(d.transform,this._lngLat)),b=s.sub(r.db(d.transform)),S=Math.abs(b.x)+Math.abs(b.y);if(S===0)return"";let C=x/S;return`rotateX(${-b.y*C}deg) rotateY(${b.x*C}deg)`}_calculateZTransform(){let s=this._pos,d=this._map;if(!d||!s)return"";let g=0,x=this.getRotationAlignment();if(x==="map")if(d._showingGlobe()){let b=d.project(new r.aI(this._lngLat.lng,this._lngLat.lat+.001)),S=d.project(new r.aI(this._lngLat.lng,this._lngLat.lat-.001)).sub(b);g=r.b0(Math.atan2(S.y,S.x))-90}else g=-d.getBearing();else if(x==="horizon"){let b=r.$(4,6,d.getZoom()),S=r.db(d.transform);S.y+=b*d.transform.height;let C=s.sub(S),F=r.b0(Math.atan2(C.y,C.x));g=(F>90?F-270:F+90)*(1-b)}return g+=this._rotation,g?`rotateZ(${g}deg)`:""}_update(s){cancelAnimationFrame(this._updateFrameId);let d=this._map;d&&(d.transform.renderWorldCopies&&(this._lngLat=Xu(this._lngLat,this._pos,d.transform)),this._pos=d.project(this._lngLat),s===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),d._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(d._showingGlobe()||d.getTerrain()||d.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(s){return this._offset=r.P.convert(s),this._update(),this}addClassName(s){return this._element.classList.add(s),this}removeClassName(s){return this._element.classList.remove(s),this}toggleClassName(s){return this._element.classList.toggle(s)}_onMove(s){let d=this._map;if(!d)return;let g=this._pointerdownPos,x=this._positionDelta;if(g&&x){if(!this._isDragging){let b=this._clickTolerance||d._clickTolerance;if(s.point.dist(g)<b)return;this._isDragging=!0}this._pos=s.point.sub(x),this._lngLat=d.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new r.f("dragstart"))),this.fire(new r.f("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;let s=this._map;s&&(s.off("mousemove",this._onMove),s.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new r.f("dragend")),this._state="inactive"}_addDragHandler(s){let d=this._map,g=this._pos;d&&g&&this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(g),this._pointerdownPos=s.point,this._state="pending",d.on("mousemove",this._onMove),d.on("touchmove",this._onMove),d.once("mouseup",this._onUp),d.once("touchend",this._onUp))}setDraggable(s){this._draggable=!!s;let d=this._map;return d&&(s?(d.on("mousedown",this._addDragHandler),d.on("touchstart",this._addDragHandler)):(d.off("mousedown",this._addDragHandler),d.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(s){return this._occludedOpacity=s||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}let Vp={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Gp=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Zu(m=new r.P(0,0),s="bottom"){if(typeof m=="number"){let d=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(s){case"top":return new r.P(0,m);case"top-left":return new r.P(d,d);case"top-right":return new r.P(-d,d);case"bottom":return new r.P(0,-m);case"bottom-left":return new r.P(d,-d);case"bottom-right":return new r.P(-d,-d);case"left":return new r.P(m,0);case"right":return new r.P(-m,0)}return new r.P(0,0)}return m instanceof r.P||Array.isArray(m)?r.P.convert(m):r.P.convert(m[s]||[0,0])}class Gh{constructor(s){this.jumpTo(s)}getValue(s){if(s<=this._startTime)return this._start;if(s>=this._endTime)return this._end;let d=r.b9((s-this._startTime)/(this._endTime-this._startTime));return this._start*(1-d)+this._end*d}isEasing(s){return s>=this._startTime&&s<=this._endTime}jumpTo(s){this._startTime=-1/0,this._endTime=-1/0,this._start=s,this._end=s}easeTo(s,d,g){this._start=this.getValue(d),this._end=s,this._startTime=d,this._endTime=d+g}}let kf={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class Od{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}let Pl={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1},Cs={showCompass:!0,showZoom:!0,visualizePitch:!1};class Nc{constructor(s,d,g=!1){this._clickTolerance=10,this.element=d,this.mouseRotate=new hu({clickTolerance:s.dragRotate._mouseRotate._clickTolerance}),this.map=s,g&&(this.mousePitch=new ul({clickTolerance:s.dragRotate._mousePitch._clickTolerance})),r.bp(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),d.addEventListener("mousedown",this.mousedown),d.addEventListener("touchstart",this.touchstart,{passive:!1}),d.addEventListener("touchmove",this.touchmove),d.addEventListener("touchend",this.touchend),d.addEventListener("touchcancel",this.reset)}down(s,d){this.mouseRotate.mousedown(s,d),this.mousePitch&&this.mousePitch.mousedown(s,d),G()}move(s,d){let g=this.map,x=this.mouseRotate.mousemoveWindow(s,d),b=x&&x.bearingDelta;if(b&&g.setBearing(g.getBearing()+b),this.mousePitch){let S=this.mousePitch.mousemoveWindow(s,d),C=S&&S.pitchDelta;C&&g.setPitch(g.getPitch()+C)}}off(){let s=this.element;s.removeEventListener("mousedown",this.mousedown),s.removeEventListener("touchstart",this.touchstart,{passive:!1}),s.removeEventListener("touchmove",this.touchmove),s.removeEventListener("touchend",this.touchend),s.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){K(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(s){this.down(r.W({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),he(this.element,s)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(s){this.move(s,he(this.element,s))}mouseup(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()}touchstart(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Me(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>s.preventDefault()},this._startPos))}touchmove(s){s.targetTouches.length!==1?this.reset():(this._lastPos=Me(this.element,s.targetTouches)[0],this.move({preventDefault:()=>s.preventDefault()},this._lastPos))}touchend(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}let rc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Mf={maxWidth:100,unit:"metric"},Nd={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"};return{version:r.dt,supported:T,setRTLTextPlugin:r.dv,getRTLTextPluginStatus:r.dw,Map:class extends Gm{constructor(m){r.dc.mark(r.dd.create);let s=m;if((m=r.W({},Pl,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&r.de(window)&&(m.antialias=!1,r.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new vs(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),m),this._repaint=!!m.repaint,this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._collectResourceTiming=m.collectResourceTiming,this._language=this._parseLanguage(m.language),this._worldview=m.worldview,this._renderTaskQueue=new jp,this._domRenderTaskQueue=new jp,this._controls=[],this._markers=[],this._popups=[],this._mapId=r.df(),this._locale=r.W({},kf,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._performanceMetricsCollection=m.performanceMetricsCollection,this._tessellationStep=m.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Gh(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._lastDirtyFrameId=0,this._requestManager=new r.dg(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,this._contextCreateOptions=m.contextCreateOptions?jr({},m.contextCreateOptions):{},typeof m.container=="string"){let d=document.getElementById(m.container);if(!d)throw new Error(`Container '${m.container.toString()}' not found.`);this._container=d}else{if(!(m.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&r.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),r.bp(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Od),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new If(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,(m.style||!m.testMode)&&this.setStyle(m.style||r.d8.DEFAULT_STYLE,{config:m.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),m.hash&&(this._hash=new po(typeof m.hash=="string"&&m.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){s.center==null&&s.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch});let d=m.bounds;d&&(this.resize(),this.fitBounds(d,r.W({},m.fitBoundsOptions,{duration:0})))}this.resize(),m.attributionControl&&this.addControl(new zp({customAttribution:m.customAttribution})),this._logoControl=new Hm,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",d=>{this._update(d.dataType==="style"),this.fire(new r.f(`${d.dataType}data`,d))}),this.on("dataloading",d=>{this.fire(new r.f(`${d.dataType}dataloading`,d))})}_getMapId(){return this._mapId}addControl(m,s){if(s===void 0&&(s=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new r.d(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let d=m.onAdd(this);this._controls.push(m);let g=this._controlPositions[s];return s.indexOf("bottom")!==-1?g.insertBefore(d,g.firstChild):g.appendChild(d),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new r.d(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let s=this._controls.indexOf(m);return s>-1&&this._controls.splice(s,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));let s=!this._moving;return s&&this.fire(new r.f("movestart",m)).fire(new r.f("move",m)),this.fire(new r.f("resize",m)),s&&this.fire(new r.f("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(r.ai.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new r.f("zoomstart")).fire(new r.f("zoom")).fire(new r.f("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new r.f("zoomstart")).fire(new r.f("zoom")).fire(new r.f("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new r.f("pitchstart")).fire(new r.f("pitch")).fire(new r.f("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new r.f("pitchstart")).fire(new r.f("pitch")).fire(new r.f("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(m){return m==="auto"?navigator.language:Array.isArray(m)?m.length===0?void 0:m.map(s=>s==="auto"?navigator.language:s):m}setLanguage(m){let s=this._parseLanguage(m);if(!this.style||s===this._language)return this;this._language=s,this.style.reloadSources();for(let d of this._controls)d._setLanguage&&d._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){return this.style&&m!==this._worldview?(this._worldview=m,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(m){return this._lazyInitEmptyStyle(),m?typeof m=="string"&&(m={name:m}):m=null,this._useExplicitProjection=!!m,this._prioritizeAndUpdateProjection(m,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;let m=this.transform,s=m.projection.name,d;s==="globe"&&m.zoom>=r.aU?(m.setMercatorFromTransition(),d=!0):s==="mercator"&&m.zoom<r.aU&&(m.setProjection({name:"globe"}),d=!0),d&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(m,s){return this._updateProjection(m||s||{name:"mercator"})}_updateProjection(m){let s;return s=m.name==="globe"&&this.transform.zoom>=r.aU?this.transform.setMercatorFromTransition():this.transform.setProjection(m),this.style.applyProjectionUpdate(),s&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(m){return this.transform.locationPoint3D(r.aI.convert(m))}unproject(m){return this.transform.pointLocation3D(r.P.convert(m))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(m,s,d){if(m==="mouseenter"||m==="mouseover"){let g=!1,x=S=>{let C=s.filter(O=>this.getLayer(O)),F=C.length?this.queryRenderedFeatures(S.point,{layers:C}):[];F.length?g||(g=!0,d.call(this,new xn(m,this,S.originalEvent,{features:F}))):g=!1},b=()=>{g=!1};return{layers:new Set(s),listener:d,delegates:{mousemove:x,mouseout:b}}}if(m==="mouseleave"||m==="mouseout"){let g=!1,x=S=>{let C=s.filter(F=>this.getLayer(F));(C.length?this.queryRenderedFeatures(S.point,{layers:C}):[]).length?g=!0:g&&(g=!1,d.call(this,new xn(m,this,S.originalEvent)))},b=S=>{g&&(g=!1,d.call(this,new xn(m,this,S.originalEvent)))};return{layers:new Set(s),listener:d,delegates:{mousemove:x,mouseout:b}}}{let g=x=>{let b=s.filter(C=>this.getLayer(C)),S=b.length?this.queryRenderedFeatures(x.point,{layers:b}):[];S.length&&(x.features=S,d.call(this,x),delete x.features)};return{layers:new Set(s),listener:d,delegates:{[m]:g}}}}on(m,s,d){if(typeof s=="function"||d===void 0)return super.on(m,s);if(Array.isArray(s)||(s=[s]),s){for(let x of s)if(!this._isValidId(x))return this}let g=this._createDelegatedListener(m,s,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(g);for(let x in g.delegates)this.on(x,g.delegates[x]);return this}once(m,s,d){if(typeof s=="function"||d===void 0)return super.once(m,s);if(Array.isArray(s)||(s=[s]),s){for(let x of s)if(!this._isValidId(x))return this}let g=this._createDelegatedListener(m,s,d);for(let x in g.delegates)this.once(x,g.delegates[x]);return this}off(m,s,d){if(typeof s=="function"||d===void 0)return super.off(m,s);let g=new Set(Array.isArray(s)?s:[s]);for(let S of g)if(!this._isValidId(S))return this;let x=(S,C)=>{if(S.size!==C.size)return!1;for(let F of S)if(!C.has(F))return!1;return!0},b=this._delegatedListeners?this._delegatedListeners[m]:void 0;return b&&(S=>{for(let C=0;C<S.length;C++){let F=S[C];if(F.listener===d&&x(F.layers,g)){for(let O in F.delegates)this.off(O,F.delegates[O]);return S.splice(C,1),this}}})(b),this}queryRenderedFeatures(m,s){if(!this.style)return[];if(s!==void 0||m===void 0||m instanceof r.P||Array.isArray(m)||(s=m,m=void 0),m=m||[[0,0],[this.transform.width,this.transform.height]],(s=s||{}).layers&&Array.isArray(s.layers)){for(let d of s.layers)if(!this._isValidId(d))return[]}return this.style.queryRenderedFeatures(m,s,this.transform)}querySourceFeatures(m,s){return this._isValidId(m)?this.style.querySourceFeatures(m,s):[]}isPointOnSurface(m){let{name:s}=this.transform.projection;return s!=="globe"&&s!=="mercator"&&r.w(`${s} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(r.P.convert(m))}setStyle(m,s){return s=r.W({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},s),this.style&&m&&s.diff!==!1&&s.localFontFamily===this._localFontFamily&&s.localIdeographFontFamily===this._localIdeographFontFamily&&!s.config?(this.style._diffStyle(m,(d,g)=>{d?(r.w(`Unable to perform style diff: ${String(d.message||d.error||d)}. Rebuilding the style from scratch.`),this._updateStyle(m,s)):g&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._localFontFamily=s.localFontFamily,this._updateStyle(m,s))}_getUIString(m){let s=this._locale[m];if(s==null)throw new Error(`Missing UI string '${m}'`);return s}_updateStyle(m,s){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m){let d=r.W({},s);s&&s.config&&(d.initialConfig=s.config,delete d.config),this.style=new Bn(this,d).load(m),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Bn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(r.w("There is no style added to the map."),!1)}_isValidId(m){return m==null?(this.fire(new r.d(new Error("IDs can't be empty."))),!1):!r.cV(m)||(this.fire(new r.d(new Error(`IDs can't contain special symbols: "${m}".`))),!1)}addSource(m,s){return this._isValidId(m)?(this._lazyInitEmptyStyle(),this.style.addSource(m,s),this._update(!0)):this}isSourceLoaded(m){return!!this._isValidId(m)&&!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(m,s,d){this._lazyInitEmptyStyle(),this.style.addSourceType(m,s,d)}removeSource(m){return this._isValidId(m)?(this.style.removeSource(m),this._updateTerrain(),this._update(!0)):this}getSource(m){return this._isValidId(m)?this.style.getOwnSource(m):null}addImage(m,s,{pixelRatio:d=1,sdf:g=!1,stretchX:x,stretchY:b,content:S}={}){if(this._lazyInitEmptyStyle(),s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap){let{width:C,height:F,data:O}=r.e.getImageData(s);this.style.addImage(m,{data:new r.i({width:C,height:F},O),pixelRatio:d,stretchX:x,stretchY:b,content:S,sdf:g,version:0})}else if(s.width===void 0||s.height===void 0)this.fire(new r.d(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{let{width:C,height:F}=s,O=s;this.style.addImage(m,{data:new r.i({width:C,height:F},new Uint8Array(O.data)),pixelRatio:d,stretchX:x,stretchY:b,content:S,sdf:g,version:0,userImage:O}),O.onAdd&&O.onAdd(this,m)}}updateImage(m,s){this._lazyInitEmptyStyle();let d=this.style.getImage(m);if(!d)return void this.fire(new r.d(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let g=s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap?r.e.getImageData(s):s,{width:x,height:b,data:S}=g;if(x===void 0||b===void 0)return void this.fire(new r.d(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(x!==d.data.width||b!==d.data.height)return void this.fire(new r.d(new Error(`The width and height of the updated image (${x}, ${b})
                must be that same as the previous version of the image
                (${d.data.width}, ${d.data.height})`)));let C=!(s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap);d.data.replace(S,C),this.style.updateImage(m,d)}hasImage(m){return m?!!this.style&&!!this.style.getImage(m):(this.fire(new r.d(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,s){r.h(this._requestManager.transformRequest(m,r.R.Image),(d,g)=>{s(d,g instanceof HTMLImageElement?r.e.getImageData(g):g)})}listImages(){return this.style.listImages()}addModel(m,s){this._lazyInitEmptyStyle(),this.style.addModel(m,s)}hasModel(m){return m?this.style.hasModel(m):(this.fire(new r.d(new Error("Missing required model id"))),!1)}removeModel(m){this.style.removeModel(m)}listModels(){return this.style.listModels()}addLayer(m,s){return this._isValidId(m.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(m,s),this._update(!0)):this}getSlot(m){let s=this.getLayer(m);return s&&s.slot||null}setSlot(m,s){return this.style.setSlot(m,s),this.style.mergeLayers(),this._update(!0)}addImport(m,s){return this.style.addImport(m,s),this}updateImport(m,s){return typeof s!="string"&&s.id!==m?(this.removeImport(m),this.addImport(s)):(this.style.updateImport(m,s),this._update(!0))}removeImport(m){return this.style.removeImport(m),this}moveImport(m,s){return this.style.moveImport(m,s),this._update(!0)}moveLayer(m,s){return this._isValidId(m)?(this.style.moveLayer(m,s),this._update(!0)):this}removeLayer(m){return this._isValidId(m)?(this.style.removeLayer(m),this._update(!0)):this}getLayer(m){return this._isValidId(m)?this.style.getOwnLayer(m):null}getSlots(){return this.style.getSlots()}setLayerZoomRange(m,s,d){return this._isValidId(m)?(this.style.setLayerZoomRange(m,s,d),this._update(!0)):this}setFilter(m,s,d={}){return this._isValidId(m)?(this.style.setFilter(m,s,d),this._update(!0)):this}getFilter(m){return this._isValidId(m)?this.style.getFilter(m):null}setPaintProperty(m,s,d,g={}){return this._isValidId(m)?(this.style.setPaintProperty(m,s,d,g),this._update(!0)):this}getPaintProperty(m,s){return this._isValidId(m)?this.style.getPaintProperty(m,s):null}setLayoutProperty(m,s,d,g={}){return this._isValidId(m)?(this.style.setLayoutProperty(m,s,d,g),this._update(!0)):this}getLayoutProperty(m,s){return this._isValidId(m)?this.style.getLayoutProperty(m,s):null}getSchema(m){return this.style.getSchema(m)}setSchema(m,s){return this.style.setSchema(m,s),this._update(!0)}getConfig(m){return this.style.getConfig(m)}setConfig(m,s){return this.style.setConfig(m,s),this._update(!0)}getConfigProperty(m,s){return this.style.getConfigProperty(m,s)}setConfigProperty(m,s,d){return this.style.setConfigProperty(m,s,d),this._update(!0)}setLights(m){if(this._lazyInitEmptyStyle(),m&&m.length===1&&m[0].type==="flat"){let s=m[0];s.properties?this.style.setFlatLight(s.properties,s.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(m),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){let m=this.style.getLights()||[];return m.length===0&&m.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),m}setLight(m,s={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:m}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setColorTheme(m){return this._lazyInitEmptyStyle(),this.style.setColorTheme(m),this._update(!0)}setCamera(m){return this.style.setCamera(m),this._triggerCameraUpdate(m)}_triggerCameraUpdate(m){return this._update(this.transform.setOrthographicProjectionAtLowPitch(m["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(r.aI.convert(m),this.transform):0}setFeatureState(m,s){return this._isValidId(m.source)?(this.style.setFeatureState(m,s),this._update()):this}removeFeatureState(m,s){return this._isValidId(m.source)?(this.style.removeFeatureState(m,s),this._update()):this}getFeatureState(m){return this._isValidId(m.source)?this.style.getFeatureState(m):null}_updateContainerDimensions(){if(!this._container)return;let m=this._container.getBoundingClientRect().width||400,s=this._container.getBoundingClientRect().height||300,d,g,x,b=this._container;for(;b&&(!g||!x);){let S=window.getComputedStyle(b).transform;S&&S!=="none"&&(d=S.match(/matrix.*\((.+)\)/)[1].split(", "),d[0]&&d[0]!=="0"&&d[0]!=="1"&&(g=d[0]),d[3]&&d[3]!=="0"&&d[3]!=="1"&&(x=d[3])),b=b.parentElement}this._containerWidth=g?Math.abs(m/g):m,this._containerHeight=x?Math.abs(s/x):s}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&r.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){let m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=D("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();let s=this._canvasContainer=D("div","mapboxgl-canvas-container",m);this._canvas=D("canvas","mapboxgl-canvas",s),this._interactive&&(s.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);let d=this._controlContainer=D("div","mapboxgl-control-container",m),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{g[x]=D("div",`mapboxgl-ctrl-${x}`,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,s){let d=r.e.devicePixelRatio||1;this._canvas.width=d*Math.ceil(m),this._canvas.height=d*Math.ceil(s),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${s}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){let s=this._markers.indexOf(m);s!==-1&&this._markers.splice(s,1)}_addPopup(m){this._popups.push(m)}_removePopup(m){let s=this._popups.indexOf(m);s!==-1&&this._popups.splice(s,1)}_setupPainter(){let m=r.W({},T.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),s=this._canvas.getContext("webgl2",m);s?(r.dh(s,!0),this.painter=new zm(s,this._contextCreateOptions,this.transform,this._tp),this.on("data",d=>{d.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),r.di.testSupport(s)):this.fire(new r.d(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new r.f("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new r.f("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty&&!this._occlusionOpacityChanged&&this._occlusionCriteriaSatisfied()}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let s;this.fire(new r.f("renderstart")),++this._frameId;let d=this.painter.context.extTimerQuery,g=r.e.now(),x=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(s=x.createQuery(),x.beginQuery(d.TIME_ELAPSED_EXT,s)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this._updateProjectionTransition();let b=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;let O=this.transform.zoom,V=this.transform.pitch,X=r.e.now(),ie=new r.X(O,{now:X,fadeDuration:b,pitch:V,transition:this.style.transition});this.style.update(ie)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let S=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),S=this._updateAverageElevation(g),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):S=this._updateAverageElevation(g);let C=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,b,this._crossSourceCollisions,this.painter.replacementSource);if(C&&(this._placementDirty=C.needsRerender,this._occlusionOpacityChanged=C.occlusionQueryBasedOpacityChanged),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:b,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new r.f("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,r.dc.mark(r.dd.load),this.fire(new r.f("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),s){let O=r.e.now()-g;x.endQuery(d.TIME_ELAPSED_EXT),setTimeout(()=>{let V=x.getQueryParameter(s,x.QUERY_RESULT)/1e6;x.deleteQuery(s),this.fire(new r.f("gpu-timing-frame",{cpuTime:O,gpuTime:V}))},50)}if(this.listens("gpu-timing-layer")){let O=this.painter.collectGpuTimers();setTimeout(()=>{let V=this.painter.queryGpuTimers(O);this.fire(new r.f("gpu-timing-layer",{layerTimes:V}))},50)}if(this.listens("gpu-timing-deferred-render")){let O=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{let V=this.painter.queryGpuTimeDeferredRender(O);this.fire(new r.f("gpu-timing-deferred-render",{gpuTime:V}))},50)}let F=this._sourcesDirty||this._styleDirty||this._placementDirty||this._occlusionOpacityChanged||S;if((this._sourcesDirty||this._styleDirty||S||this._occlusionOpacityChanged)&&(this._lastDirtyFrameId=this._frameId),F||this._repaint||!this._occlusionCriteriaSatisfied())this.triggerRepaint();else{let O=!this.isMoving()&&this.loaded();if(O&&(S=this._updateAverageElevation(g,!0)),S)this.triggerRepaint();else if(this._triggerFrame(!1),O&&(this.fire(new r.f("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){let V=this._calculateSpeedIndex();this.fire(new r.f("speedindexcompleted",{speedIndex:V})),this.speedIndexTiming=!1}}this._loaded&&!this._fullyLoaded&&!F&&this._occlusionCriteriaSatisfied()&&(this._fullyLoaded=!0,r.dc.mark(r.dd.fullLoad),this._performanceMetricsCollection&&r.dj(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(m){for(let s of this._markers)m&&!this.getRenderWorldCopies()&&(s._lngLat=s._lngLat.wrap()),s._update();for(let s of this._popups)!m||this.getRenderWorldCopies()||s._trackPointer||(s._lngLat=s._lngLat.wrap()),s._update()}_updateAverageElevation(m,s=!1){let d=x=>(this.transform.averageElevation=x,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&d(0);let g=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(g||(s||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){let x=this.transform.averageElevation,b=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(b)?b=0:this._averageElevationLastSampledAt=m;let S=Math.abs(x-b);if(S>1){if(this._isInitialLoad||g)return this._averageElevation.jumpTo(b),d(b);this._averageElevation.easeTo(b,m,300)}else if(S>1e-4)return this._averageElevation.jumpTo(b),d(b)}return!!this._averageElevation.isEasing(m)&&d(this._averageElevation.getValue(m))}_authenticate(){r.dk(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,m=>{if(m&&(m.message===r.dl||m.status===401)){let s=this.painter.context.gl;r.dh(s,!1),this._logoControl instanceof Hm&&this._logoControl._updateLogo(),s&&s.clear(s.DEPTH_BUFFER_BIT|s.COLOR_BUFFER_BIT|s.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new r.d(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),r.dm(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&r.dn(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){let m=this._isDragging();this.painter.updateTerrain(this.style,m)}_calculateSpeedIndex(){let m=this.painter.canvasCopy(),s=this.painter.getCanvasCopiesAndTimestamps();s.timeStamps.push(performance.now());let d=this.painter.context.gl,g=d.createFramebuffer();function x(b){d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,b,0);let S=new Uint8Array(d.drawingBufferWidth*d.drawingBufferHeight*4);return d.readPixels(0,0,d.drawingBufferWidth,d.drawingBufferHeight,d.RGBA,d.UNSIGNED_BYTE,S),S}return d.bindFramebuffer(d.FRAMEBUFFER,g),this._canvasPixelComparison(x(m),s.canvasCopies.map(x),s.timeStamps)}_canvasPixelComparison(m,s,d){let g=d[1]-d[0],x=m.length/4;for(let b=0;b<s.length;b++){let S=s[b],C=0;for(let F=0;F<S.length;F+=4)S[F]===m[F]&&S[F+1]===m[F+1]&&S[F+2]===m[F+2]&&S[F+3]===m[F+3]&&(C+=1);g+=(d[b+2]-d[b+1])*(1-C/x)}return g}remove(){this._hash&&this._hash.remove();for(let s of this._controls)s.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);let m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),r.dp(this.painter.context.gl),r.dq.remove(),r.dr.remove(),this._removed=!0,this.fire(new r.f("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=r.e.frame(s=>{let d=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,d&&this._render(s)}))}_preloadTiles(m){let s=this.style?this.style.getSourceCaches():[];return r.ds(s,(d,g)=>d._preloadTiles(m,g),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(m){this._showParseStatus!==m&&(this._showParseStatus=m,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(m){this._showLayers2DWireframe!==m&&(this._showLayers2DWireframe=m,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(m){this._showLayers3DWireframe!==m&&(this._showLayers3DWireframe=m,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,this._tp.refreshUI(),m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(m){this._showTileAABBs!==m&&(this._showTileAABBs=m,this._tp.refreshUI(),m&&this._update())}_setCacheLimits(m,s){r.du(m,s)}_occlusionCriteriaSatisfied(){let m=this.style&&(this.style.has3DLayers()||this.style.terrain&&!this.style.disableElevatedTerrain);return!(this.style&&this.style.hasSymbolLayers()&&m&&this.painter)||this._frameId-this._lastDirtyFrameId>5+2*this.painter.symbolParams.occlusionQueryFrameWindow}get version(){return r.dt}},NavigationControl:class{constructor(m){this.options=r.W({},Cs,m),this._container=D("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(r.bp(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",s=>{this._map&&this._map.zoomIn({},{originalEvent:s})}),D("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",s=>{this._map&&this._map.zoomOut({},{originalEvent:s})}),D("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(r.bp(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",s=>{let d=this._map;d&&(this.options.visualizePitch?d.resetNorthPitch({},{originalEvent:s}):d.resetNorth({},{originalEvent:s}))}),this._compassIcon=D("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){let m=this._map;if(!m)return;let s=m.getZoom(),d=s===m.getMaxZoom(),g=s===m.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())}_rotateCompassArrow(){let m=this._map;if(!m)return;let s=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=s)})}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Nc(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){let m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,s){let d=D("button",m,this._container);return d.type="button",d.addEventListener("click",s),d}_setButtonTitle(m,s){if(!this._map)return;let d=this._map._getUIString(`NavigationControl.${s}`);m.setAttribute("aria-label",d),m.firstElementChild&&m.firstElementChild.setAttribute("title",d)}},GeolocateControl:class extends r.E{constructor(m){super();let s=navigator.geolocation;this.options=r.W({geolocation:s},rc,m),r.bp(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=qo(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=D("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){let s=(d=!!this.options.geolocation)=>{this._supportsGeolocation=d,m(d)};this._supportsGeolocation!==void 0?m(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(d=>s(d.state!=="denied")).catch(()=>s()):s()}_isOutOfMapMaxBounds(m){let s=this._map.getMaxBounds(),d=m.coords;return!!s&&(d.longitude<s.getWest()||d.longitude>s.getEast()||d.latitude<s.getSouth()||d.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new r.f("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new r.f("geolocate",m)),this._finish()}}_updateCamera(m){let s=new r.aI(m.coords.longitude,m.coords.latitude),d=m.coords.accuracy,g=this._map.getBearing(),x=r.W({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(s.toBounds(d),x,{geolocateSource:!0})}_updateMarker(m){if(m){let s=new r.aI(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){let m=this._map.transform,s=r.ax(1,m._center.lat)*m.worldSize,d=Math.ceil(2*this._accuracy*s);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new r.f("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",s=>s.preventDefault()),this._geolocateButton=D("button","mapboxgl-ctrl-geolocate",this._container),D("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",m===!1){r.w("Geolocation support is not available so the GeolocateControl will be disabled.");let s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}else{let s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D("div","mapboxgl-user-location"),this._dotElement.appendChild(D("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(D("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Vh({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=D("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Vh({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new r.f("trackuserlocationend")))})}}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:m.absolute===!0&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return r.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new r.f("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new r.f("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new r.f("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){let m=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(s=>{s==="granted"&&m()}).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:zp,ScaleControl:class{constructor(m){this.options=r.W({},Mf,m),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),r.bp(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){let m=this.options.maxWidth||100,s=this._map,d=s._containerHeight/2,g=s._containerWidth/2-m/2,x=s.unproject([g,d]),b=s.unproject([g+m,d]),S=x.distanceTo(b);if(this.options.unit==="imperial"){let C=3.2808*S;C>5280?this._setScale(m,C/5280,"mile"):this._setScale(m,C,"foot")}else this.options.unit==="nautical"?this._setScale(m,S/1852,"nautical-mile"):S>=1e3?this._setScale(m,S/1e3,"kilometer"):this._setScale(m,S,"meter")}_setScale(m,s,d){this._map._requestDomTask(()=>{let g=function(b){let S=Math.pow(10,`${Math.floor(b)}`.length-1),C=b/S;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(F){let O=Math.pow(10,Math.ceil(-Math.log(F)/Math.LN10));return Math.round(F*O)/O}(C),S*C}(s),x=g/s;this._container.innerHTML=this._isNumberFormatSupported&&d!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:d}).format(g):`${g}&nbsp;${Nd[d]}`,this._container.style.width=m*x+"px"})}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=D("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m){this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:r.w("Full screen control 'container' must be a DOM element.")),r.bp(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=D("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",r.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){let m=this._fullscreenButton=D("button","mapboxgl-ctrl-fullscreen",this._controlContainer);D("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){let m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends r.E{constructor(m){super(),this.options=r.W(Object.create(Vp),m),r.bp(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),m._addPopup(this),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new r.f("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);let m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),m._canvasContainer&&m._canvasContainer.classList.remove("mapboxgl-track-pointer"),m._removePopup(this),this._map=void 0),this.fire(new r.f("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=r.aI.convert(m),this._pos=null,this._trackPointer=!1,this._update();let s=this._map;return s&&(s.on("move",this._update),s.off("mousemove",this._onMouseEvent),s._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();let m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){let s=document.createDocumentFragment(),d=document.createElement("body"),g;for(d.innerHTML=m;g=d.firstChild,g;)s.appendChild(g);return this.setDOMContent(s)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let s=this._content;if(s)for(;s.hasChildNodes();)s.firstChild&&s.removeChild(s.firstChild);else s=this._content=D("div","mapboxgl-popup-content",this._container||void 0);if(s.appendChild(m),this.options.closeButton){let d=this._closeButton=D("button","mapboxgl-popup-close-button",s);d.type="button",d.setAttribute("aria-label","Close popup"),d.setAttribute("aria-hidden","true"),d.innerHTML="&#215;",d.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let s;return this._classList.delete(m)?s=!1:(this._classList.add(m),s=!0),this._updateClassList(),s}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;let s=this._map,d=this._container,g=this._pos;if(!s||!d||!g)return"bottom";let x=d.offsetWidth,b=d.offsetHeight,S=g.x<x/2,C=g.x>s.transform.width-x/2;if(g.y+m<b)return S?"top-left":C?"top-right":"top";if(g.y>s.transform.height-b){if(S)return"bottom-left";if(C)return"bottom-right"}return S?"left":C?"right":"bottom"}_updateClassList(){let m=this._container;if(!m)return;let s=[...this._classList];s.push("mapboxgl-popup"),this._anchor&&s.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&s.push("mapboxgl-popup-track-pointer"),m.className=s.join(" ")}_update(m){let s=this._map,d=this._content;if(!s||!this._lngLat&&!this._trackPointer||!d)return;let g=this._container;if(g||(g=this._container=D("div","mapboxgl-popup",s.getContainer()),this._tip=D("div","mapboxgl-popup-tip",g),g.appendChild(d)),this.options.maxWidth&&g.style.maxWidth!==this.options.maxWidth&&(g.style.maxWidth=this.options.maxWidth),s.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Xu(this._lngLat,this._pos,s.transform)),!this._trackPointer||m){let x=this._pos=this._trackPointer&&m?m:s.project(this._lngLat),b=Zu(this.options.offset),S=this._anchor=this._getAnchor(b.y),C=Zu(this.options.offset,S),F=x.add(C).round();s._requestDomTask(()=>{this._container&&S&&(this._container.style.transform=`${Up[S]} translate(${F.x}px,${F.y}px)`)})}if(!this._marker&&s._showingGlobe()){let x=r.d9(s.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let m=this._container.querySelector(Gp);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:Vh,Style:Bn,LngLat:r.aI,LngLatBounds:r.ai,Point:r.P,MercatorCoordinate:r.Y,FreeCameraOptions:yc,Evented:r.E,config:r.d8,prewarm:r.dx,clearPrewarmedResources:r.dy,get accessToken(){return r.d8.ACCESS_TOKEN},set accessToken(m){r.d8.ACCESS_TOKEN=m},get baseApiUrl(){return r.d8.API_URL},set baseApiUrl(m){r.d8.API_URL=m},get workerCount(){return r.dz.workerCount},set workerCount(m){r.dz.workerCount=m},get maxParallelImageRequests(){return r.d8.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){r.d8.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){r.dA(m)},get workerUrl(){return r.dB.workerUrl},set workerUrl(m){r.dB.workerUrl=m},get workerClass(){return r.dB.workerClass},set workerClass(m){r.dB.workerClass=m},get workerParams(){return r.dB.workerParams},set workerParams(m){r.dB.workerParams=m},get dracoUrl(){return r.dC()},set dracoUrl(m){r.dD(m)},get meshoptUrl(){return r.dE()},set meshoptUrl(m){r.dF(m)},setNow:r.e.setNow,restoreNow:r.e.restoreNow}});var u=o;return u})});function Lx(a,i){i===void 0&&(i={});var o=RH();o.p(a);var c=FH(a,i,2,4);return LH(c,i),PH(c,c.length-4,o.d()),c}function gD(a,i){return IH((OH(a),a.subarray(2,-4)),i)}var Ul,Vl,x1,Fx,Px,xT,hD,dD,fD,bT,pD,TH,lD,wT,pf,sa,hd,bp,sa,sa,sa,sa,b1,sa,SH,EH,AH,CH,_T,vh,vT,ST,mD,IH,mf,v1,yT,TT,cD,y1,Rx,uD,kH,MH,DH,RH,FH,PH,LH,OH,_D=vC(()=>{"use strict";Ul=Uint8Array,Vl=Uint16Array,x1=Uint32Array,Fx=new Ul([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Px=new Ul([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),xT=new Ul([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),hD=function(a,i){for(var o=new Vl(31),c=0;c<31;++c)o[c]=i+=1<<a[c-1];for(var u=new x1(o[30]),c=1;c<30;++c)for(var r=o[c];r<o[c+1];++r)u[r]=r-o[c]<<5|c;return[o,u]},dD=hD(Fx,2),fD=dD[0],bT=dD[1];fD[28]=258,bT[258]=28;pD=hD(Px,0),TH=pD[0],lD=pD[1],wT=new Vl(32768);for(sa=0;sa<32768;++sa)pf=(sa&43690)>>>1|(sa&21845)<<1,pf=(pf&52428)>>>2|(pf&13107)<<2,pf=(pf&61680)>>>4|(pf&3855)<<4,wT[sa]=((pf&65280)>>>8|(pf&255)<<8)>>>1;hd=function(a,i,o){for(var c=a.length,u=0,r=new Vl(i);u<c;++u)++r[a[u]-1];var _=new Vl(i);for(u=0;u<i;++u)_[u]=_[u-1]+r[u-1]<<1;var T;if(o){T=new Vl(1<<i);var E=15-i;for(u=0;u<c;++u)if(a[u])for(var k=u<<4|a[u],D=i-a[u],j=_[a[u]-1]++<<D,B=j|(1<<D)-1;j<=B;++j)T[wT[j]>>>E]=k}else for(T=new Vl(c),u=0;u<c;++u)T[u]=wT[_[a[u]-1]++]>>>15-a[u];return T},bp=new Ul(288);for(sa=0;sa<144;++sa)bp[sa]=8;for(sa=144;sa<256;++sa)bp[sa]=9;for(sa=256;sa<280;++sa)bp[sa]=7;for(sa=280;sa<288;++sa)bp[sa]=8;b1=new Ul(32);for(sa=0;sa<32;++sa)b1[sa]=5;SH=hd(bp,9,0),EH=hd(bp,9,1),AH=hd(b1,5,0),CH=hd(b1,5,1),_T=function(a){for(var i=a[0],o=1;o<a.length;++o)a[o]>i&&(i=a[o]);return i},vh=function(a,i,o){var c=i/8>>0;return(a[c]|a[c+1]<<8)>>>(i&7)&o},vT=function(a,i){var o=i/8>>0;return(a[o]|a[o+1]<<8|a[o+2]<<16)>>>(i&7)},ST=function(a){return(a/8>>0)+(a&7&&1)},mD=function(a,i,o){(i==null||i<0)&&(i=0),(o==null||o>a.length)&&(o=a.length);var c=new(a instanceof Vl?Vl:a instanceof x1?x1:Ul)(o-i);return c.set(a.subarray(i,o)),c},IH=function(a,i,o){var c=a.length,u=!i||o,r=!o||o.i;o||(o={}),i||(i=new Ul(c*3));var _=function(Ve){var gt=i.length;if(Ve>gt){var mt=new Ul(Math.max(gt*2,Ve));mt.set(i),i=mt}},T=o.f||0,E=o.p||0,k=o.b||0,D=o.l,j=o.d,B=o.m,P=o.n,ee=c*8;do{if(!D){o.f=T=vh(a,E,1);var G=vh(a,E+1,3);if(E+=3,G)if(G==1)D=EH,j=CH,B=9,P=5;else if(G==2){var he=vh(a,E,31)+257,Me=vh(a,E+10,15)+4,Re=he+vh(a,E+5,31)+1;E+=14;for(var et=new Ul(Re),Te=new Ul(19),ge=0;ge<Me;++ge)Te[xT[ge]]=vh(a,E+ge*3,7);E+=Me*3;var Ue=_T(Te),Ae=(1<<Ue)-1;if(!r&&E+Re*(Ue+7)>ee)break;for(var _e=hd(Te,Ue,1),ge=0;ge<Re;){var ve=_e[vh(a,E,Ae)];E+=ve&15;var K=ve>>>4;if(K<16)et[ge++]=K;else{var Qe=0,Ce=0;for(K==16?(Ce=3+vh(a,E,3),E+=2,Qe=et[ge-1]):K==17?(Ce=3+vh(a,E,7),E+=3):K==18&&(Ce=11+vh(a,E,127),E+=7);Ce--;)et[ge++]=Qe}}var Ye=et.subarray(0,he),ut=et.subarray(he);B=_T(Ye),P=_T(ut),D=hd(Ye,B,1),j=hd(ut,P,1)}else throw"invalid block type";else{var K=ST(E)+4,J=a[K-4]|a[K-3]<<8,ne=K+J;if(ne>c){if(r)throw"unexpected EOF";break}u&&_(k+J),i.set(a.subarray(K,ne),k),o.b=k+=J,o.p=E=ne*8;continue}if(E>ee)throw"unexpected EOF"}u&&_(k+131072);for(var st=(1<<B)-1,pt=(1<<P)-1,Tt=B+P+18;r||E+Tt<ee;){var Qe=D[vT(a,E)&st],ht=Qe>>>4;if(E+=Qe&15,E>ee)throw"unexpected EOF";if(!Qe)throw"invalid length/literal";if(ht<256)i[k++]=ht;else if(ht==256){D=null;break}else{var Wt=ht-254;if(ht>264){var ge=ht-257,re=Fx[ge];Wt=vh(a,E,(1<<re)-1)+fD[ge],E+=re}var xe=j[vT(a,E)&pt],pe=xe>>>4;if(!xe)throw"invalid distance";E+=xe&15;var ut=TH[pe];if(pe>3){var re=Px[pe];ut+=vT(a,E)&(1<<re)-1,E+=re}if(E>ee)throw"unexpected EOF";u&&_(k+131072);for(var Ie=k+Wt;k<Ie;k+=4)i[k]=i[k-ut],i[k+1]=i[k+1-ut],i[k+2]=i[k+2-ut],i[k+3]=i[k+3-ut];k=Ie}}o.l=D,o.p=E,o.b=k,D&&(T=1,o.m=B,o.d=j,o.n=P)}while(!T);return k==i.length?i:mD(i,0,k)},mf=function(a,i,o){o<<=i&7;var c=i/8>>0;a[c]|=o,a[c+1]|=o>>>8},v1=function(a,i,o){o<<=i&7;var c=i/8>>0;a[c]|=o,a[c+1]|=o>>>8,a[c+2]|=o>>>16},yT=function(a,i){for(var o=[],c=0;c<a.length;++c)a[c]&&o.push({s:c,f:a[c]});var u=o.length,r=o.slice();if(!u)return[new Ul(0),0];if(u==1){var _=new Ul(o[0].s+1);return _[o[0].s]=1,[_,1]}o.sort(function(Re,et){return Re.f-et.f}),o.push({s:-1,f:25001});var T=o[0],E=o[1],k=0,D=1,j=2;for(o[0]={s:-1,f:T.f+E.f,l:T,r:E};D!=u-1;)T=o[o[k].f<o[j].f?k++:j++],E=o[k!=D&&o[k].f<o[j].f?k++:j++],o[D++]={s:-1,f:T.f+E.f,l:T,r:E};for(var B=r[0].s,c=1;c<u;++c)r[c].s>B&&(B=r[c].s);var P=new Vl(B+1),ee=TT(o[D-1],P,0);if(ee>i){var c=0,G=0,K=ee-i,J=1<<K;for(r.sort(function(et,Te){return P[Te.s]-P[et.s]||et.f-Te.f});c<u;++c){var ne=r[c].s;if(P[ne]>i)G+=J-(1<<ee-P[ne]),P[ne]=i;else break}for(G>>>=K;G>0;){var he=r[c].s;P[he]<i?G-=1<<i-P[he]++-1:++c}for(;c>=0&&G;--c){var Me=r[c].s;P[Me]==i&&(--P[Me],++G)}ee=i}return[new Ul(P),ee]},TT=function(a,i,o){return a.s==-1?Math.max(TT(a.l,i,o+1),TT(a.r,i,o+1)):i[a.s]=o},cD=function(a){for(var i=a.length;i&&!a[--i];);for(var o=new Vl(++i),c=0,u=a[0],r=1,_=function(E){o[c++]=E},T=1;T<=i;++T)if(a[T]==u&&T!=i)++r;else{if(!u&&r>2){for(;r>138;r-=138)_(32754);r>2&&(_(r>10?r-11<<5|28690:r-3<<5|12305),r=0)}else if(r>3){for(_(u),--r;r>6;r-=6)_(8304);r>2&&(_(r-3<<5|8208),r=0)}for(;r--;)_(u);r=1,u=a[T]}return[o.subarray(0,c),i]},y1=function(a,i){for(var o=0,c=0;c<i.length;++c)o+=a[c]*i[c];return o},Rx=function(a,i,o){var c=o.length,u=ST(i+2);a[u]=c&255,a[u+1]=c>>>8,a[u+2]=a[u]^255,a[u+3]=a[u+1]^255;for(var r=0;r<c;++r)a[u+r+4]=o[r];return(u+4+c)*8},uD=function(a,i,o,c,u,r,_,T,E,k,D){mf(i,D++,o),++u[256];for(var j=yT(u,15),B=j[0],P=j[1],ee=yT(r,15),G=ee[0],K=ee[1],J=cD(B),ne=J[0],he=J[1],Me=cD(G),Re=Me[0],et=Me[1],Te=new Vl(19),ge=0;ge<ne.length;++ge)Te[ne[ge]&31]++;for(var ge=0;ge<Re.length;++ge)Te[Re[ge]&31]++;for(var Ue=yT(Te,7),Ae=Ue[0],_e=Ue[1],ve=19;ve>4&&!Ae[xT[ve-1]];--ve);var Qe=k+5<<3,Ce=y1(u,bp)+y1(r,b1)+_,Ye=y1(u,B)+y1(r,G)+_+14+3*ve+y1(Te,Ae)+(2*Te[16]+3*Te[17]+7*Te[18]);if(Qe<=Ce&&Qe<=Ye)return Rx(i,D,a.subarray(E,E+k));var ut,st,pt,Tt;if(mf(i,D,1+(Ye<Ce)),D+=2,Ye<Ce){ut=hd(B,P,0),st=B,pt=hd(G,K,0),Tt=G;var ht=hd(Ae,_e,0);mf(i,D,he-257),mf(i,D+5,et-1),mf(i,D+10,ve-4),D+=14;for(var ge=0;ge<ve;++ge)mf(i,D+3*ge,Ae[xT[ge]]);D+=3*ve;for(var Wt=[ne,Re],re=0;re<2;++re)for(var xe=Wt[re],ge=0;ge<xe.length;++ge){var pe=xe[ge]&31;mf(i,D,ht[pe]),D+=Ae[pe],pe>15&&(mf(i,D,xe[ge]>>>5&127),D+=xe[ge]>>>12)}}else ut=SH,st=bp,pt=AH,Tt=b1;for(var ge=0;ge<T;++ge)if(c[ge]>255){var pe=c[ge]>>>18&31;v1(i,D,ut[pe+257]),D+=st[pe+257],pe>7&&(mf(i,D,c[ge]>>>23&31),D+=Fx[pe]);var Ie=c[ge]&31;v1(i,D,pt[Ie]),D+=Tt[Ie],Ie>3&&(v1(i,D,c[ge]>>>5&8191),D+=Px[Ie])}else v1(i,D,ut[c[ge]]),D+=st[c[ge]];return v1(i,D,ut[256]),D+st[256]},kH=new x1([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),MH=new Ul(0),DH=function(a,i,o,c,u,r){var _=a.length,T=new Ul(c+_+5*(1+Math.floor(_/7e3))+u),E=T.subarray(c,T.length-u),k=0;if(!i||_<8)for(var D=0;D<=_;D+=65535){var j=D+65535;j<_?k=Rx(E,k,a.subarray(D,j)):(E[D]=r,k=Rx(E,k,a.subarray(D,_)))}else{for(var B=kH[i-1],P=B>>>13,ee=B&8191,G=(1<<o)-1,K=new Vl(32768),J=new Vl(G+1),ne=Math.ceil(o/3),he=2*ne,Me=function(Fr){return(a[Fr]^a[Fr+1]<<ne^a[Fr+2]<<he)&G},Re=new x1(25e3),et=new Vl(288),Te=new Vl(32),ge=0,Ue=0,D=0,Ae=0,_e=0,ve=0;D<_;++D){var Qe=Me(D),Ce=D&32767,Ye=J[Qe];if(K[Ce]=Ye,J[Qe]=Ce,_e<=D){var ut=_-D;if((ge>7e3||Ae>24576)&&ut>423){k=uD(a,E,0,Re,et,Te,Ue,Ae,ve,D-ve,k),Ae=ge=Ue=0,ve=D;for(var st=0;st<286;++st)et[st]=0;for(var st=0;st<30;++st)Te[st]=0}var pt=2,Tt=0,ht=ee,Wt=Ce-Ye&32767;if(ut>2&&Qe==Me(D-Wt))for(var re=Math.min(P,ut)-1,xe=Math.min(32767,D),pe=Math.min(258,ut);Wt<=xe&&--ht&&Ce!=Ye;){if(a[D+pt]==a[D+pt-Wt]){for(var Ie=0;Ie<pe&&a[D+Ie]==a[D+Ie-Wt];++Ie);if(Ie>pt){if(pt=Ie,Tt=Wt,Ie>re)break;for(var Ve=Math.min(Wt,Ie-2),gt=0,st=0;st<Ve;++st){var mt=D-Wt+st+32768&32767,wt=K[mt],Pt=mt-wt+32768&32767;Pt>gt&&(gt=Pt,Ye=mt)}}}Ce=Ye,Ye=K[Ce],Wt+=Ce-Ye+32768&32767}if(Tt){Re[Ae++]=268435456|bT[pt]<<18|lD[Tt];var fr=bT[pt]&31,xr=lD[Tt]&31;Ue+=Fx[fr]+Px[xr],++et[257+fr],++Te[xr],_e=D+pt,++ge}else Re[Ae++]=a[D],++et[a[D]]}}k=uD(a,E,r,Re,et,Te,Ue,Ae,ve,D-ve,k),r||(k=Rx(E,k,MH))}return mD(T,0,c+ST(k)+u)},RH=function(){var a=1,i=0;return{p:function(o){for(var c=a,u=i,r=o.length,_=0;_!=r;){for(var T=Math.min(_+5552,r);_<T;++_)c+=o[_],u+=c;c%=65521,u%=65521}a=c,i=u},d:function(){return(a>>>8<<16|(i&255)<<8|i>>>8)+((a&255)<<23)*2}}},FH=function(a,i,o,c,u){return DH(a,i.level==null?6:i.level,i.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(a.length)))*1.5):12+i.mem,o,c,!u)},PH=function(a,i,o){for(;o;++i)a[i]=o,o>>>=8},LH=function(a,i){var o=i.level,c=o==0?0:o<6?1:o==9?3:2;a[0]=120,a[1]=c<<6|(c?32-2*c:1)},OH=function(a){if((a[0]&15)!=8||a[0]>>>4>7||(a[0]<<8|a[1])%31)throw"invalid zlib data";if(a[1]&32)throw"invalid zlib data: preset dictionaries not supported"}});var zT={};jL(zT,{AcroForm:()=>KH,AcroFormAppearance:()=>ai,AcroFormButton:()=>ps,AcroFormCheckBox:()=>E1,AcroFormChoiceField:()=>Dm,AcroFormComboBox:()=>Fm,AcroFormEditBox:()=>T1,AcroFormListBox:()=>Rm,AcroFormPasswordField:()=>A1,AcroFormPushButton:()=>S1,AcroFormRadioButton:()=>Pm,AcroFormTextField:()=>Ep,GState:()=>C1,ShadingPattern:()=>Tp,TilingPattern:()=>Mm,default:()=>BT,jsPDF:()=>Bi});function ET(){Wi.console&&typeof Wi.console.log=="function"&&Wi.console.log.apply(Wi.console,arguments)}function AT(a,i,o){var c=new XMLHttpRequest;c.open("GET",a),c.responseType="blob",c.onload=function(){km(c.response,i,o)},c.onerror=function(){ja.error("could not download file")},c.send()}function vD(a){var i=new XMLHttpRequest;i.open("HEAD",a,!1);try{i.send()}catch{}return i.status>=200&&i.status<=299}function Ox(a){try{a.dispatchEvent(new MouseEvent("click"))}catch{var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(i)}}function LD(a){var i;a=a||"",this.ok=!1,a.charAt(0)=="#"&&(a=a.substr(1,6)),a={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[a=(a=a.replace(/ /g,"")).toLowerCase()]||a;for(var o=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(T){return[parseInt(T[1]),parseInt(T[2]),parseInt(T[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(T){return[parseInt(T[1],16),parseInt(T[2],16),parseInt(T[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(T){return[parseInt(T[1]+T[1],16),parseInt(T[2]+T[2],16),parseInt(T[3]+T[3],16)]}}],c=0;c<o.length;c++){var u=o[c].re,r=o[c].process,_=u.exec(a);_&&(i=r(_),this.r=i[0],this.g=i[1],this.b=i[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var T=this.r.toString(16),E=this.g.toString(16),k=this.b.toString(16);return T.length==1&&(T="0"+T),E.length==1&&(E="0"+E),k.length==1&&(k="0"+k),"#"+T+E+k}}function CT(a,i){var o=a[0],c=a[1],u=a[2],r=a[3];o=xl(o,c,u,r,i[0],7,-680876936),r=xl(r,o,c,u,i[1],12,-389564586),u=xl(u,r,o,c,i[2],17,606105819),c=xl(c,u,r,o,i[3],22,-1044525330),o=xl(o,c,u,r,i[4],7,-176418897),r=xl(r,o,c,u,i[5],12,1200080426),u=xl(u,r,o,c,i[6],17,-1473231341),c=xl(c,u,r,o,i[7],22,-45705983),o=xl(o,c,u,r,i[8],7,1770035416),r=xl(r,o,c,u,i[9],12,-1958414417),u=xl(u,r,o,c,i[10],17,-42063),c=xl(c,u,r,o,i[11],22,-1990404162),o=xl(o,c,u,r,i[12],7,1804603682),r=xl(r,o,c,u,i[13],12,-40341101),u=xl(u,r,o,c,i[14],17,-1502002290),o=bl(o,c=xl(c,u,r,o,i[15],22,1236535329),u,r,i[1],5,-165796510),r=bl(r,o,c,u,i[6],9,-1069501632),u=bl(u,r,o,c,i[11],14,643717713),c=bl(c,u,r,o,i[0],20,-373897302),o=bl(o,c,u,r,i[5],5,-701558691),r=bl(r,o,c,u,i[10],9,38016083),u=bl(u,r,o,c,i[15],14,-660478335),c=bl(c,u,r,o,i[4],20,-405537848),o=bl(o,c,u,r,i[9],5,568446438),r=bl(r,o,c,u,i[14],9,-1019803690),u=bl(u,r,o,c,i[3],14,-187363961),c=bl(c,u,r,o,i[8],20,1163531501),o=bl(o,c,u,r,i[13],5,-1444681467),r=bl(r,o,c,u,i[2],9,-51403784),u=bl(u,r,o,c,i[7],14,1735328473),o=wl(o,c=bl(c,u,r,o,i[12],20,-1926607734),u,r,i[5],4,-378558),r=wl(r,o,c,u,i[8],11,-2022574463),u=wl(u,r,o,c,i[11],16,1839030562),c=wl(c,u,r,o,i[14],23,-35309556),o=wl(o,c,u,r,i[1],4,-1530992060),r=wl(r,o,c,u,i[4],11,1272893353),u=wl(u,r,o,c,i[7],16,-155497632),c=wl(c,u,r,o,i[10],23,-1094730640),o=wl(o,c,u,r,i[13],4,681279174),r=wl(r,o,c,u,i[0],11,-358537222),u=wl(u,r,o,c,i[3],16,-722521979),c=wl(c,u,r,o,i[6],23,76029189),o=wl(o,c,u,r,i[9],4,-640364487),r=wl(r,o,c,u,i[12],11,-421815835),u=wl(u,r,o,c,i[15],16,530742520),o=Tl(o,c=wl(c,u,r,o,i[2],23,-995338651),u,r,i[0],6,-198630844),r=Tl(r,o,c,u,i[7],10,1126891415),u=Tl(u,r,o,c,i[14],15,-1416354905),c=Tl(c,u,r,o,i[5],21,-57434055),o=Tl(o,c,u,r,i[12],6,1700485571),r=Tl(r,o,c,u,i[3],10,-1894986606),u=Tl(u,r,o,c,i[10],15,-1051523),c=Tl(c,u,r,o,i[1],21,-2054922799),o=Tl(o,c,u,r,i[8],6,1873313359),r=Tl(r,o,c,u,i[15],10,-30611744),u=Tl(u,r,o,c,i[6],15,-1560198380),c=Tl(c,u,r,o,i[13],21,1309151649),o=Tl(o,c,u,r,i[4],6,-145523070),r=Tl(r,o,c,u,i[11],10,-1120210379),u=Tl(u,r,o,c,i[2],15,718787259),c=Tl(c,u,r,o,i[9],21,-343485551),a[0]=Sp(o,a[0]),a[1]=Sp(c,a[1]),a[2]=Sp(u,a[2]),a[3]=Sp(r,a[3])}function Ux(a,i,o,c,u,r){return i=Sp(Sp(i,a),Sp(c,r)),Sp(i<<u|i>>>32-u,o)}function xl(a,i,o,c,u,r,_){return Ux(i&o|~i&c,a,i,u,r,_)}function bl(a,i,o,c,u,r,_){return Ux(i&c|o&~c,a,i,u,r,_)}function wl(a,i,o,c,u,r,_){return Ux(i^o^c,a,i,u,r,_)}function Tl(a,i,o,c,u,r,_){return Ux(o^(i|~c),a,i,u,r,_)}function OD(a){var i,o=a.length,c=[1732584193,-271733879,-1732584194,271733878];for(i=64;i<=a.length;i+=64)CT(c,NH(a.substring(i-64,i)));a=a.substring(i-64);var u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<a.length;i++)u[i>>2]|=a.charCodeAt(i)<<(i%4<<3);if(u[i>>2]|=128<<(i%4<<3),i>55)for(CT(c,u),i=0;i<16;i++)u[i]=0;return u[14]=8*o,CT(c,u),c}function NH(a){var i,o=[];for(i=0;i<64;i+=4)o[i>>2]=a.charCodeAt(i)+(a.charCodeAt(i+1)<<8)+(a.charCodeAt(i+2)<<16)+(a.charCodeAt(i+3)<<24);return o}function BH(a){for(var i="",o=0;o<4;o++)i+=yD[a>>8*o+4&15]+yD[a>>8*o&15];return i}function zH(a){return String.fromCharCode((255&a)>>0,(65280&a)>>8,(16711680&a)>>16,(4278190080&a)>>24)}function RT(a){return OD(a).map(zH).join("")}function Sp(a,i){if(jH){var o=(65535&a)+(65535&i);return(a>>16)+(i>>16)+(o>>16)<<16|65535&o}return a+i&4294967295}function FT(a,i){var o,c,u,r;if(a!==o){for(var _=(u=a,r=1+(256/a.length>>0),new Array(r+1).join(u)),T=[],E=0;E<256;E++)T[E]=E;var k=0;for(E=0;E<256;E++){var D=T[E];k=(k+D+_.charCodeAt(E))%256,T[E]=T[k],T[k]=D}o=a,c=T}else T=c;var j=i.length,B=0,P=0,ee="";for(E=0;E<j;E++)P=(P+(D=T[B=(B+1)%256]))%256,T[B]=T[P],T[P]=D,_=T[(T[B]+T[P])%256],ee+=String.fromCharCode(i.charCodeAt(E)^_);return ee}function gg(a,i,o,c){this.v=1,this.r=2;var u=192;a.forEach(function(T){if(xD.perm!==void 0)throw new Error("Invalid permission: "+T);u+=xD[T]}),this.padding="(\xBFN^Nu\x8AAd\0NV\xFF\xFA\b..\0\xB6\xD0h>\x80/\f\xA9\xFEdSiz";var r=(i+this.padding).substr(0,32),_=(o+this.padding).substr(0,32);this.O=this.processOwnerPassword(r,_),this.P=-(1+(255^u)),this.encryptionKey=RT(r+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(c)).substr(0,5),this.U=FT(this.encryptionKey,this.padding)}function _g(a){if(/[^\u0000-\u00ff]/.test(a))throw new Error("Invalid PDF Name Object: "+a+", Only accept ASCII characters.");for(var i="",o=a.length,c=0;c<o;c++){var u=a.charCodeAt(c);u<33||u===35||u===37||u===40||u===41||u===47||u===60||u===62||u===91||u===93||u===123||u===125||u>126?i+="#"+("0"+u.toString(16)).slice(-2):i+=a[c]}return i}function bD(a){if(Pa(a)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var i={};this.subscribe=function(o,c,u){if(u=u||!1,typeof o!="string"||typeof c!="function"||typeof u!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");i.hasOwnProperty(o)||(i[o]={});var r=Math.random().toString(35);return i[o][r]=[c,!!u],r},this.unsubscribe=function(o){for(var c in i)if(i[c][o])return delete i[c][o],Object.keys(i[c]).length===0&&delete i[c],!0;return!1},this.publish=function(o){if(i.hasOwnProperty(o)){var c=Array.prototype.slice.call(arguments,1),u=[];for(var r in i[o]){var _=i[o][r];try{_[0].apply(a,c)}catch(T){Wi.console&&ja.error("jsPDF PubSub Error",T.message,T)}_[1]&&u.push(r)}u.length&&u.forEach(this.unsubscribe)}},this.getTopics=function(){return i}}function C1(a){if(!(this instanceof C1))return new C1(a);var i="opacity,stroke-opacity".split(",");for(var o in a)a.hasOwnProperty(o)&&i.indexOf(o)>=0&&(this[o]=a[o]);this.id="",this.objectNumber=-1}function ND(a,i){this.gState=a,this.matrix=i,this.id="",this.objectNumber=-1}function Tp(a,i,o,c,u){if(!(this instanceof Tp))return new Tp(a,i,o,c,u);this.type=a==="axial"?2:3,this.coords=i,this.colors=o,ND.call(this,c,u)}function Mm(a,i,o,c,u){if(!(this instanceof Mm))return new Mm(a,i,o,c,u);this.boundingBox=a,this.xStep=i,this.yStep=o,this.stream="",this.cloneIndex=0,ND.call(this,c,u)}function Bi(a){var i,o=typeof arguments[0]=="string"?arguments[0]:"p",c=arguments[1],u=arguments[2],r=arguments[3],_=[],T=1,E=16,k="S",D=null;Pa(a=a||{})==="object"&&(o=a.orientation,c=a.unit||c,u=a.format||u,r=a.compress||a.compressPdf||r,(D=a.encryption||null)!==null&&(D.userPassword=D.userPassword||"",D.ownerPassword=D.ownerPassword||"",D.userPermissions=D.userPermissions||[]),T=typeof a.userUnit=="number"?Math.abs(a.userUnit):1,a.precision!==void 0&&(i=a.precision),a.floatPrecision!==void 0&&(E=a.floatPrecision),k=a.defaultPathOperation||"S"),_=a.filters||(r===!0?["FlateEncode"]:_),c=c||"mm",o=(""+(o||"P")).toLowerCase();var j=a.putOnlyUsedFonts||!1,B={},P={internal:{},__private__:{}};P.__private__.PubSub=bD;var ee="1.3",G=P.__private__.getPdfVersion=function(){return ee};P.__private__.setPdfVersion=function(H){ee=H};var K={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};P.__private__.getPageFormats=function(){return K};var J=P.__private__.getPageFormat=function(H){return K[H]};u=u||"a4";var ne={COMPAT:"compat",ADVANCED:"advanced"},he=ne.COMPAT;function Me(){this.saveGraphicsState(),lt(new Qr(Lr,0,0,-Lr,0,Bs()*Lr).toString()+" cm"),this.setFontSize(this.getFontSize()/Lr),k="n",he=ne.ADVANCED}function Re(){this.restoreGraphicsState(),k="S",he=ne.COMPAT}var et=P.__private__.combineFontStyleAndFontWeight=function(H,Ee){if(H=="bold"&&Ee=="normal"||H=="bold"&&Ee==400||H=="normal"&&Ee=="italic"||H=="bold"&&Ee=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Ee&&(H=Ee==400||Ee==="normal"?H==="italic"?"italic":"normal":Ee!=700&&Ee!=="bold"||H!=="normal"?(Ee==700?"bold":Ee)+""+H:"bold"),H};P.advancedAPI=function(H){var Ee=he===ne.COMPAT;return Ee&&Me.call(this),typeof H!="function"||(H(this),Ee&&Re.call(this)),this},P.compatAPI=function(H){var Ee=he===ne.ADVANCED;return Ee&&Re.call(this),typeof H!="function"||(H(this),Ee&&Me.call(this)),this},P.isAdvancedAPI=function(){return he===ne.ADVANCED};var Te,ge=function(H){if(he!==ne.ADVANCED)throw new Error(H+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Ue=P.roundToPrecision=P.__private__.roundToPrecision=function(H,Ee){var ct=i||Ee;if(isNaN(H)||isNaN(ct))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return H.toFixed(ct).replace(/0+$/,"")};Te=P.hpf=P.__private__.hpf=typeof E=="number"?function(H){if(isNaN(H))throw new Error("Invalid argument passed to jsPDF.hpf");return Ue(H,E)}:E==="smart"?function(H){if(isNaN(H))throw new Error("Invalid argument passed to jsPDF.hpf");return Ue(H,H>-1&&H<1?16:5)}:function(H){if(isNaN(H))throw new Error("Invalid argument passed to jsPDF.hpf");return Ue(H,16)};var Ae=P.f2=P.__private__.f2=function(H){if(isNaN(H))throw new Error("Invalid argument passed to jsPDF.f2");return Ue(H,2)},_e=P.__private__.f3=function(H){if(isNaN(H))throw new Error("Invalid argument passed to jsPDF.f3");return Ue(H,3)},ve=P.scale=P.__private__.scale=function(H){if(isNaN(H))throw new Error("Invalid argument passed to jsPDF.scale");return he===ne.COMPAT?H*Lr:he===ne.ADVANCED?H:void 0},Qe=function(H){return he===ne.COMPAT?Bs()-H:he===ne.ADVANCED?H:void 0},Ce=function(H){return ve(Qe(H))};P.__private__.setPrecision=P.setPrecision=function(H){typeof parseInt(H,10)=="number"&&(i=parseInt(H,10))};var Ye,ut="00000000000000000000000000000000",st=P.__private__.getFileId=function(){return ut},pt=P.__private__.setFileId=function(H){return ut=H!==void 0&&/^[a-fA-F0-9]{32}$/.test(H)?H.toUpperCase():ut.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),D!==null&&(Ya=new gg(D.userPermissions,D.userPassword,D.ownerPassword,ut)),ut};P.setFileId=function(H){return pt(H),this},P.getFileId=function(){return st()};var Tt=P.__private__.convertDateToPDFDate=function(H){var Ee=H.getTimezoneOffset(),ct=Ee<0?"+":"-",yt=Math.floor(Math.abs(Ee/60)),Lt=Math.abs(Ee%60),sr=[ct,pe(yt),"'",pe(Lt),"'"].join("");return["D:",H.getFullYear(),pe(H.getMonth()+1),pe(H.getDate()),pe(H.getHours()),pe(H.getMinutes()),pe(H.getSeconds()),sr].join("")},ht=P.__private__.convertPDFDateToDate=function(H){var Ee=parseInt(H.substr(2,4),10),ct=parseInt(H.substr(6,2),10)-1,yt=parseInt(H.substr(8,2),10),Lt=parseInt(H.substr(10,2),10),sr=parseInt(H.substr(12,2),10),Mr=parseInt(H.substr(14,2),10);return new Date(Ee,ct,yt,Lt,sr,Mr,0)},Wt=P.__private__.setCreationDate=function(H){var Ee;if(H===void 0&&(H=new Date),H instanceof Date)Ee=Tt(H);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(H))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Ee=H}return Ye=Ee},re=P.__private__.getCreationDate=function(H){var Ee=Ye;return H==="jsDate"&&(Ee=ht(Ye)),Ee};P.setCreationDate=function(H){return Wt(H),this},P.getCreationDate=function(H){return re(H)};var xe,pe=P.__private__.padd2=function(H){return("0"+parseInt(H)).slice(-2)},Ie=P.__private__.padd2Hex=function(H){return("00"+(H=H.toString())).substr(H.length)},Ve=0,gt=[],mt=[],wt=0,Pt=[],fr=[],xr=!1,Rr=mt,Fr=function(){Ve=0,wt=0,mt=[],gt=[],Pt=[],W=Jn(),Q=Jn()};P.__private__.setCustomOutputDestination=function(H){xr=!0,Rr=H};var $t=function(H){xr||(Rr=H)};P.__private__.resetCustomOutputDestination=function(){xr=!1,Rr=mt};var lt=P.__private__.out=function(H){return H=H.toString(),wt+=H.length+1,Rr.push(H),Rr},Bt=P.__private__.write=function(H){return lt(arguments.length===1?H.toString():Array.prototype.join.call(arguments," "))},nr=P.__private__.getArrayBuffer=function(H){for(var Ee=H.length,ct=new ArrayBuffer(Ee),yt=new Uint8Array(ct);Ee--;)yt[Ee]=H.charCodeAt(Ee);return ct},br=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];P.__private__.getStandardFonts=function(){return br};var kr=a.fontSize||16;P.__private__.setFontSize=P.setFontSize=function(H){return kr=he===ne.ADVANCED?H/Lr:H,this};var Nr,Br=P.__private__.getFontSize=P.getFontSize=function(){return he===ne.COMPAT?kr:kr*Lr},ii=a.R2L||!1;P.__private__.setR2L=P.setR2L=function(H){return ii=H,this},P.__private__.getR2L=P.getR2L=function(){return ii};var si,wi=P.__private__.setZoomMode=function(H){var Ee=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(H))Nr=H;else if(isNaN(H)){if(Ee.indexOf(H)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+H+'" is not recognized.');Nr=H}else Nr=parseInt(H,10)};P.__private__.getZoomMode=function(){return Nr};var Ri,Ji=P.__private__.setPageMode=function(H){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(H)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+H+'" is not recognized.');si=H};P.__private__.getPageMode=function(){return si};var an=P.__private__.setLayoutMode=function(H){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(H)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+H+'" is not recognized.');Ri=H};P.__private__.getLayoutMode=function(){return Ri},P.__private__.setDisplayMode=P.setDisplayMode=function(H,Ee,ct){return wi(H),an(Ee),Ji(ct),this};var xi={title:"",subject:"",author:"",keywords:"",creator:""};P.__private__.getDocumentProperty=function(H){if(Object.keys(xi).indexOf(H)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return xi[H]},P.__private__.getDocumentProperties=function(){return xi},P.__private__.setDocumentProperties=P.setProperties=P.setDocumentProperties=function(H){for(var Ee in xi)xi.hasOwnProperty(Ee)&&H[Ee]&&(xi[Ee]=H[Ee]);return this},P.__private__.setDocumentProperty=function(H,Ee){if(Object.keys(xi).indexOf(H)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return xi[H]=Ee};var Ui,Lr,Ua,Dr,Eo,gi={},Dn={},Ao=[],Qi={},_o={},Gn={},oo={},Co=null,Cn=0,ki=[],yn=new bD(P),ms=a.hotfixes||[],On={},vo={},Oa=[],Qr=function H(Ee,ct,yt,Lt,sr,Mr){if(!(this instanceof H))return new H(Ee,ct,yt,Lt,sr,Mr);isNaN(Ee)&&(Ee=1),isNaN(ct)&&(ct=0),isNaN(yt)&&(yt=0),isNaN(Lt)&&(Lt=1),isNaN(sr)&&(sr=0),isNaN(Mr)&&(Mr=0),this._matrix=[Ee,ct,yt,Lt,sr,Mr]};Object.defineProperty(Qr.prototype,"sx",{get:function(){return this._matrix[0]},set:function(H){this._matrix[0]=H}}),Object.defineProperty(Qr.prototype,"shy",{get:function(){return this._matrix[1]},set:function(H){this._matrix[1]=H}}),Object.defineProperty(Qr.prototype,"shx",{get:function(){return this._matrix[2]},set:function(H){this._matrix[2]=H}}),Object.defineProperty(Qr.prototype,"sy",{get:function(){return this._matrix[3]},set:function(H){this._matrix[3]=H}}),Object.defineProperty(Qr.prototype,"tx",{get:function(){return this._matrix[4]},set:function(H){this._matrix[4]=H}}),Object.defineProperty(Qr.prototype,"ty",{get:function(){return this._matrix[5]},set:function(H){this._matrix[5]=H}}),Object.defineProperty(Qr.prototype,"a",{get:function(){return this._matrix[0]},set:function(H){this._matrix[0]=H}}),Object.defineProperty(Qr.prototype,"b",{get:function(){return this._matrix[1]},set:function(H){this._matrix[1]=H}}),Object.defineProperty(Qr.prototype,"c",{get:function(){return this._matrix[2]},set:function(H){this._matrix[2]=H}}),Object.defineProperty(Qr.prototype,"d",{get:function(){return this._matrix[3]},set:function(H){this._matrix[3]=H}}),Object.defineProperty(Qr.prototype,"e",{get:function(){return this._matrix[4]},set:function(H){this._matrix[4]=H}}),Object.defineProperty(Qr.prototype,"f",{get:function(){return this._matrix[5]},set:function(H){this._matrix[5]=H}}),Object.defineProperty(Qr.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Qr.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Qr.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Qr.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Qr.prototype.join=function(H){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(Te).join(H)},Qr.prototype.multiply=function(H){var Ee=H.sx*this.sx+H.shy*this.shx,ct=H.sx*this.shy+H.shy*this.sy,yt=H.shx*this.sx+H.sy*this.shx,Lt=H.shx*this.shy+H.sy*this.sy,sr=H.tx*this.sx+H.ty*this.shx+this.tx,Mr=H.tx*this.shy+H.ty*this.sy+this.ty;return new Qr(Ee,ct,yt,Lt,sr,Mr)},Qr.prototype.decompose=function(){var H=this.sx,Ee=this.shy,ct=this.shx,yt=this.sy,Lt=this.tx,sr=this.ty,Mr=Math.sqrt(H*H+Ee*Ee),Yr=(H/=Mr)*ct+(Ee/=Mr)*yt;ct-=H*Yr,yt-=Ee*Yr;var hi=Math.sqrt(ct*ct+yt*yt);return Yr/=hi,H*(yt/=hi)<Ee*(ct/=hi)&&(H=-H,Ee=-Ee,Yr=-Yr,Mr=-Mr),{scale:new Qr(Mr,0,0,hi,0,0),translate:new Qr(1,0,0,1,Lt,sr),rotate:new Qr(H,Ee,-Ee,H,0,0),skew:new Qr(1,0,Yr,1,0,0)}},Qr.prototype.toString=function(H){return this.join(" ")},Qr.prototype.inversed=function(){var H=this.sx,Ee=this.shy,ct=this.shx,yt=this.sy,Lt=this.tx,sr=this.ty,Mr=1/(H*yt-Ee*ct),Yr=yt*Mr,hi=-Ee*Mr,Fi=-ct*Mr,di=H*Mr;return new Qr(Yr,hi,Fi,di,-Yr*Lt-Fi*sr,-hi*Lt-di*sr)},Qr.prototype.applyToPoint=function(H){var Ee=H.x*this.sx+H.y*this.shx+this.tx,ct=H.x*this.shy+H.y*this.sy+this.ty;return new Wn(Ee,ct)},Qr.prototype.applyToRectangle=function(H){var Ee=this.applyToPoint(H),ct=this.applyToPoint(new Wn(H.x+H.w,H.y+H.h));return new vs(Ee.x,Ee.y,ct.x-Ee.x,ct.y-Ee.y)},Qr.prototype.clone=function(){var H=this.sx,Ee=this.shy,ct=this.shx,yt=this.sy,Lt=this.tx,sr=this.ty;return new Qr(H,Ee,ct,yt,Lt,sr)},P.Matrix=Qr;var Vo=P.matrixMult=function(H,Ee){return Ee.multiply(H)},so=new Qr(1,0,0,1,0,0);P.unitMatrix=P.identityMatrix=so;var Za=function(H,Ee){if(!_o[H]){var ct=(Ee instanceof Tp?"Sh":"P")+(Object.keys(Qi).length+1).toString(10);Ee.id=ct,_o[H]=ct,Qi[ct]=Ee,yn.publish("addPattern",Ee)}};P.ShadingPattern=Tp,P.TilingPattern=Mm,P.addShadingPattern=function(H,Ee){return ge("addShadingPattern()"),Za(H,Ee),this},P.beginTilingPattern=function(H){ge("beginTilingPattern()"),il(H.boundingBox[0],H.boundingBox[1],H.boundingBox[2]-H.boundingBox[0],H.boundingBox[3]-H.boundingBox[1],H.matrix)},P.endTilingPattern=function(H,Ee){ge("endTilingPattern()"),Ee.stream=fr[xe].join(`
`),Za(H,Ee),yn.publish("endTilingPattern",Ee),Oa.pop().restore()};var _a=P.__private__.newObject=function(){var H=Jn();return te(H,!0),H},Jn=P.__private__.newObjectDeferred=function(){return Ve++,gt[Ve]=function(){return wt},Ve},te=function(H,Ee){return Ee=typeof Ee=="boolean"&&Ee,gt[H]=wt,Ee&&lt(H+" 0 obj"),H},U=P.__private__.newAdditionalObject=function(){var H={objId:Jn(),content:""};return Pt.push(H),H},W=Jn(),Q=Jn(),se=P.__private__.decodeColorString=function(H){var Ee=H.split(" ");if(Ee.length!==2||Ee[1]!=="g"&&Ee[1]!=="G")Ee.length===5&&(Ee[4]==="k"||Ee[4]==="K")&&(Ee=[(1-Ee[0])*(1-Ee[3]),(1-Ee[1])*(1-Ee[3]),(1-Ee[2])*(1-Ee[3]),"r"]);else{var ct=parseFloat(Ee[0]);Ee=[ct,ct,ct,"r"]}for(var yt="#",Lt=0;Lt<3;Lt++)yt+=("0"+Math.floor(255*parseFloat(Ee[Lt])).toString(16)).slice(-2);return yt},le=P.__private__.encodeColorString=function(H){var Ee;typeof H=="string"&&(H={ch1:H});var ct=H.ch1,yt=H.ch2,Lt=H.ch3,sr=H.ch4,Mr=H.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ct=="string"&&ct.charAt(0)!=="#"){var Yr=new LD(ct);if(Yr.ok)ct=Yr.toHex();else if(!/^\d*\.?\d*$/.test(ct))throw new Error('Invalid color "'+ct+'" passed to jsPDF.encodeColorString.')}if(typeof ct=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ct)&&(ct="#"+ct[1]+ct[1]+ct[2]+ct[2]+ct[3]+ct[3]),typeof ct=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ct)){var hi=parseInt(ct.substr(1),16);ct=hi>>16&255,yt=hi>>8&255,Lt=255&hi}if(yt===void 0||sr===void 0&&ct===yt&&yt===Lt)if(typeof ct=="string")Ee=ct+" "+Mr[0];else switch(H.precision){case 2:Ee=Ae(ct/255)+" "+Mr[0];break;case 3:default:Ee=_e(ct/255)+" "+Mr[0]}else if(sr===void 0||Pa(sr)==="object"){if(sr&&!isNaN(sr.a)&&sr.a===0)return Ee=["1.","1.","1.",Mr[1]].join(" ");if(typeof ct=="string")Ee=[ct,yt,Lt,Mr[1]].join(" ");else switch(H.precision){case 2:Ee=[Ae(ct/255),Ae(yt/255),Ae(Lt/255),Mr[1]].join(" ");break;default:case 3:Ee=[_e(ct/255),_e(yt/255),_e(Lt/255),Mr[1]].join(" ")}}else if(typeof ct=="string")Ee=[ct,yt,Lt,sr,Mr[2]].join(" ");else switch(H.precision){case 2:Ee=[Ae(ct),Ae(yt),Ae(Lt),Ae(sr),Mr[2]].join(" ");break;case 3:default:Ee=[_e(ct),_e(yt),_e(Lt),_e(sr),Mr[2]].join(" ")}return Ee},De=P.__private__.getFilters=function(){return _},Ze=P.__private__.putStream=function(H){var Ee=(H=H||{}).data||"",ct=H.filters||De(),yt=H.alreadyAppliedFilters||[],Lt=H.addLength1||!1,sr=Ee.length,Mr=H.objectId,Yr=function(Io){return Io};if(D!==null&&Mr===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");D!==null&&(Yr=Ya.encryptor(Mr,0));var hi={};ct===!0&&(ct=["FlateEncode"]);var Fi=H.additionalKeyValues||[],di=(hi=Bi.API.processDataByFilters!==void 0?Bi.API.processDataByFilters(Ee,ct):{data:Ee,reverseChain:[]}).reverseChain+(Array.isArray(yt)?yt.join(" "):yt.toString());if(hi.data.length!==0&&(Fi.push({key:"Length",value:hi.data.length}),Lt===!0&&Fi.push({key:"Length1",value:sr})),di.length!=0)if(di.split("/").length-1==1)Fi.push({key:"Filter",value:di});else{Fi.push({key:"Filter",value:"["+di+"]"});for(var pn=0;pn<Fi.length;pn+=1)if(Fi[pn].key==="DecodeParms"){for(var va=[],Na=0;Na<hi.reverseChain.split("/").length-1;Na+=1)va.push("null");va.push(Fi[pn].value),Fi[pn].value="["+va.join(" ")+"]"}}lt("<<");for(var Va=0;Va<Fi.length;Va++)lt("/"+Fi[Va].key+" "+Fi[Va].value);lt(">>"),hi.data.length!==0&&(lt("stream"),lt(Yr(hi.data)),lt("endstream"))},ke=P.__private__.putPage=function(H){var Ee=H.number,ct=H.data,yt=H.objId,Lt=H.contentsObjId;te(yt,!0),lt("<</Type /Page"),lt("/Parent "+H.rootDictionaryObjId+" 0 R"),lt("/Resources "+H.resourceDictionaryObjId+" 0 R"),lt("/MediaBox ["+parseFloat(Te(H.mediaBox.bottomLeftX))+" "+parseFloat(Te(H.mediaBox.bottomLeftY))+" "+Te(H.mediaBox.topRightX)+" "+Te(H.mediaBox.topRightY)+"]"),H.cropBox!==null&&lt("/CropBox ["+Te(H.cropBox.bottomLeftX)+" "+Te(H.cropBox.bottomLeftY)+" "+Te(H.cropBox.topRightX)+" "+Te(H.cropBox.topRightY)+"]"),H.bleedBox!==null&&lt("/BleedBox ["+Te(H.bleedBox.bottomLeftX)+" "+Te(H.bleedBox.bottomLeftY)+" "+Te(H.bleedBox.topRightX)+" "+Te(H.bleedBox.topRightY)+"]"),H.trimBox!==null&&lt("/TrimBox ["+Te(H.trimBox.bottomLeftX)+" "+Te(H.trimBox.bottomLeftY)+" "+Te(H.trimBox.topRightX)+" "+Te(H.trimBox.topRightY)+"]"),H.artBox!==null&&lt("/ArtBox ["+Te(H.artBox.bottomLeftX)+" "+Te(H.artBox.bottomLeftY)+" "+Te(H.artBox.topRightX)+" "+Te(H.artBox.topRightY)+"]"),typeof H.userUnit=="number"&&H.userUnit!==1&&lt("/UserUnit "+H.userUnit),yn.publish("putPage",{objId:yt,pageContext:ki[Ee],pageNumber:Ee,page:ct}),lt("/Contents "+Lt+" 0 R"),lt(">>"),lt("endobj");var sr=ct.join(`
`);return he===ne.ADVANCED&&(sr+=`
Q`),te(Lt,!0),Ze({data:sr,filters:De(),objectId:Lt}),lt("endobj"),yt},We=P.__private__.putPages=function(){var H,Ee,ct=[];for(H=1;H<=Cn;H++)ki[H].objId=Jn(),ki[H].contentsObjId=Jn();for(H=1;H<=Cn;H++)ct.push(ke({number:H,data:fr[H],objId:ki[H].objId,contentsObjId:ki[H].contentsObjId,mediaBox:ki[H].mediaBox,cropBox:ki[H].cropBox,bleedBox:ki[H].bleedBox,trimBox:ki[H].trimBox,artBox:ki[H].artBox,userUnit:ki[H].userUnit,rootDictionaryObjId:W,resourceDictionaryObjId:Q}));te(W,!0),lt("<</Type /Pages");var yt="/Kids [";for(Ee=0;Ee<Cn;Ee++)yt+=ct[Ee]+" 0 R ";lt(yt+"]"),lt("/Count "+Cn),lt(">>"),lt("endobj"),yn.publish("postPutPages")},nt=function(H){yn.publish("putFont",{font:H,out:lt,newObject:_a,putStream:Ze}),H.isAlreadyPutted!==!0&&(H.objectNumber=_a(),lt("<<"),lt("/Type /Font"),lt("/BaseFont /"+_g(H.postScriptName)),lt("/Subtype /Type1"),typeof H.encoding=="string"&&lt("/Encoding /"+H.encoding),lt("/FirstChar 32"),lt("/LastChar 255"),lt(">>"),lt("endobj"))},dt=function(){for(var H in gi)gi.hasOwnProperty(H)&&(j===!1||j===!0&&B.hasOwnProperty(H))&&nt(gi[H])},Ft=function(H){H.objectNumber=_a();var Ee=[];Ee.push({key:"Type",value:"/XObject"}),Ee.push({key:"Subtype",value:"/Form"}),Ee.push({key:"BBox",value:"["+[Te(H.x),Te(H.y),Te(H.x+H.width),Te(H.y+H.height)].join(" ")+"]"}),Ee.push({key:"Matrix",value:"["+H.matrix.toString()+"]"});var ct=H.pages[1].join(`
`);Ze({data:ct,additionalKeyValues:Ee,objectId:H.objectNumber}),lt("endobj")},tr=function(){for(var H in On)On.hasOwnProperty(H)&&Ft(On[H])},Qt=function(H,Ee){var ct,yt=[],Lt=1/(Ee-1);for(ct=0;ct<1;ct+=Lt)yt.push(ct);if(yt.push(1),H[0].offset!=0){var sr={offset:0,color:H[0].color};H.unshift(sr)}if(H[H.length-1].offset!=1){var Mr={offset:1,color:H[H.length-1].color};H.push(Mr)}for(var Yr="",hi=0,Fi=0;Fi<yt.length;Fi++){for(ct=yt[Fi];ct>H[hi+1].offset;)hi++;var di=H[hi].offset,pn=(ct-di)/(H[hi+1].offset-di),va=H[hi].color,Na=H[hi+1].color;Yr+=Ie(Math.round((1-pn)*va[0]+pn*Na[0]).toString(16))+Ie(Math.round((1-pn)*va[1]+pn*Na[1]).toString(16))+Ie(Math.round((1-pn)*va[2]+pn*Na[2]).toString(16))}return Yr.trim()},or=function(H,Ee){Ee||(Ee=21);var ct=_a(),yt=Qt(H.colors,Ee),Lt=[];Lt.push({key:"FunctionType",value:"0"}),Lt.push({key:"Domain",value:"[0.0 1.0]"}),Lt.push({key:"Size",value:"["+Ee+"]"}),Lt.push({key:"BitsPerSample",value:"8"}),Lt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Lt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ze({data:yt,additionalKeyValues:Lt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ct}),lt("endobj"),H.objectNumber=_a(),lt("<< /ShadingType "+H.type),lt("/ColorSpace /DeviceRGB");var sr="/Coords ["+Te(parseFloat(H.coords[0]))+" "+Te(parseFloat(H.coords[1]))+" ";H.type===2?sr+=Te(parseFloat(H.coords[2]))+" "+Te(parseFloat(H.coords[3])):sr+=Te(parseFloat(H.coords[2]))+" "+Te(parseFloat(H.coords[3]))+" "+Te(parseFloat(H.coords[4]))+" "+Te(parseFloat(H.coords[5])),lt(sr+="]"),H.matrix&&lt("/Matrix ["+H.matrix.toString()+"]"),lt("/Function "+ct+" 0 R"),lt("/Extend [true true]"),lt(">>"),lt("endobj")},Ar=function(H,Ee){var ct=Jn(),yt=_a();Ee.push({resourcesOid:ct,objectOid:yt}),H.objectNumber=yt;var Lt=[];Lt.push({key:"Type",value:"/Pattern"}),Lt.push({key:"PatternType",value:"1"}),Lt.push({key:"PaintType",value:"1"}),Lt.push({key:"TilingType",value:"1"}),Lt.push({key:"BBox",value:"["+H.boundingBox.map(Te).join(" ")+"]"}),Lt.push({key:"XStep",value:Te(H.xStep)}),Lt.push({key:"YStep",value:Te(H.yStep)}),Lt.push({key:"Resources",value:ct+" 0 R"}),H.matrix&&Lt.push({key:"Matrix",value:"["+H.matrix.toString()+"]"}),Ze({data:H.stream,additionalKeyValues:Lt,objectId:H.objectNumber}),lt("endobj")},qr=function(H){var Ee;for(Ee in Qi)Qi.hasOwnProperty(Ee)&&(Qi[Ee]instanceof Tp?or(Qi[Ee]):Qi[Ee]instanceof Mm&&Ar(Qi[Ee],H))},wr=function(H){for(var Ee in H.objectNumber=_a(),lt("<<"),H)switch(Ee){case"opacity":lt("/ca "+Ae(H[Ee]));break;case"stroke-opacity":lt("/CA "+Ae(H[Ee]))}lt(">>"),lt("endobj")},Ei=function(){var H;for(H in Gn)Gn.hasOwnProperty(H)&&wr(Gn[H])},mi=function(){for(var H in lt("/XObject <<"),On)On.hasOwnProperty(H)&&On[H].objectNumber>=0&&lt("/"+H+" "+On[H].objectNumber+" 0 R");yn.publish("putXobjectDict"),lt(">>")},Ti=function(){Ya.oid=_a(),lt("<<"),lt("/Filter /Standard"),lt("/V "+Ya.v),lt("/R "+Ya.r),lt("/U <"+Ya.toHexString(Ya.U)+">"),lt("/O <"+Ya.toHexString(Ya.O)+">"),lt("/P "+Ya.P),lt(">>"),lt("endobj")},An=function(){for(var H in lt("/Font <<"),gi)gi.hasOwnProperty(H)&&(j===!1||j===!0&&B.hasOwnProperty(H))&&lt("/"+H+" "+gi[H].objectNumber+" 0 R");lt(">>")},ln=function(){if(Object.keys(Qi).length>0){for(var H in lt("/Shading <<"),Qi)Qi.hasOwnProperty(H)&&Qi[H]instanceof Tp&&Qi[H].objectNumber>=0&&lt("/"+H+" "+Qi[H].objectNumber+" 0 R");yn.publish("putShadingPatternDict"),lt(">>")}},Rn=function(H){if(Object.keys(Qi).length>0){for(var Ee in lt("/Pattern <<"),Qi)Qi.hasOwnProperty(Ee)&&Qi[Ee]instanceof P.TilingPattern&&Qi[Ee].objectNumber>=0&&Qi[Ee].objectNumber<H&&lt("/"+Ee+" "+Qi[Ee].objectNumber+" 0 R");yn.publish("putTilingPatternDict"),lt(">>")}},Hn=function(){if(Object.keys(Gn).length>0){var H;for(H in lt("/ExtGState <<"),Gn)Gn.hasOwnProperty(H)&&Gn[H].objectNumber>=0&&lt("/"+H+" "+Gn[H].objectNumber+" 0 R");yn.publish("putGStateDict"),lt(">>")}},fn=function(H){te(H.resourcesOid,!0),lt("<<"),lt("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),An(),ln(),Rn(H.objectOid),Hn(),mi(),lt(">>"),lt("endobj")},Gl=function(){var H=[];dt(),Ei(),tr(),qr(H),yn.publish("putResources"),H.forEach(fn),fn({resourcesOid:Q,objectOid:Number.MAX_SAFE_INTEGER}),yn.publish("postPutResources")},wh=function(){yn.publish("putAdditionalObjects");for(var H=0;H<Pt.length;H++){var Ee=Pt[H];te(Ee.objId,!0),lt(Ee.content),lt("endobj")}yn.publish("postPutAdditionalObjects")},md=function(H){Dn[H.fontName]=Dn[H.fontName]||{},Dn[H.fontName][H.fontStyle]=H.id},gc=function(H,Ee,ct,yt,Lt){var sr={id:"F"+(Object.keys(gi).length+1).toString(10),postScriptName:H,fontName:Ee,fontStyle:ct,encoding:yt,isStandardFont:Lt||!1,metadata:{}};return yn.publish("addFont",{font:sr,instance:this}),gi[sr.id]=sr,md(sr),sr.id},ci=function(H){for(var Ee=0,ct=br.length;Ee<ct;Ee++){var yt=gc.call(this,H[Ee][0],H[Ee][1],H[Ee][2],br[Ee][3],!0);j===!1&&(B[yt]=!0);var Lt=H[Ee][0].split("-");md({id:yt,fontName:Lt[0],fontStyle:Lt[1]||""})}yn.publish("addFonts",{fonts:gi,dictionary:Dn})},Os=function(H){return H.foo=function(){try{return H.apply(this,arguments)}catch(yt){var Ee=yt.stack||"";~Ee.indexOf(" at ")&&(Ee=Ee.split(" at ")[1]);var ct="Error in function "+Ee.split(`
`)[0].split("<")[0]+": "+yt.message;if(!Wi.console)throw new Error(ct);Wi.console.error(ct,yt),Wi.alert&&alert(ct)}},H.foo.bar=H,H.foo},Ns=function(H,Ee){var ct,yt,Lt,sr,Mr,Yr,hi,Fi,di;if(Lt=(Ee=Ee||{}).sourceEncoding||"Unicode",Mr=Ee.outputEncoding,(Ee.autoencode||Mr)&&gi[Ui].metadata&&gi[Ui].metadata[Lt]&&gi[Ui].metadata[Lt].encoding&&(sr=gi[Ui].metadata[Lt].encoding,!Mr&&gi[Ui].encoding&&(Mr=gi[Ui].encoding),!Mr&&sr.codePages&&(Mr=sr.codePages[0]),typeof Mr=="string"&&(Mr=sr[Mr]),Mr)){for(hi=!1,Yr=[],ct=0,yt=H.length;ct<yt;ct++)(Fi=Mr[H.charCodeAt(ct)])?Yr.push(String.fromCharCode(Fi)):Yr.push(H[ct]),Yr[ct].charCodeAt(0)>>8&&(hi=!0);H=Yr.join("")}for(ct=H.length;hi===void 0&&ct!==0;)H.charCodeAt(ct-1)>>8&&(hi=!0),ct--;if(!hi)return H;for(Yr=Ee.noBOM?[]:[254,255],ct=0,yt=H.length;ct<yt;ct++){if((di=(Fi=H.charCodeAt(ct))>>8)>>8)throw new Error("Character at position "+ct+" of string '"+H+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Yr.push(di),Yr.push(Fi-(di<<8))}return String.fromCharCode.apply(void 0,Yr)},Go=P.__private__.pdfEscape=P.pdfEscape=function(H,Ee){return Ns(H,Ee).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Cu=P.__private__.beginPage=function(H){fr[++Cn]=[],ki[Cn]={objId:0,contentsObjId:0,userUnit:Number(T),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(H[0]),topRightY:Number(H[1])}},Sh(Cn),$t(fr[xe])},Th=function(H,Ee){var ct,yt,Lt;switch(o=Ee||o,typeof H=="string"&&(ct=J(H.toLowerCase()),Array.isArray(ct)&&(yt=ct[0],Lt=ct[1])),Array.isArray(H)&&(yt=H[0]*Lr,Lt=H[1]*Lr),isNaN(yt)&&(yt=u[0],Lt=u[1]),(yt>14400||Lt>14400)&&(ja.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),yt=Math.min(14400,yt),Lt=Math.min(14400,Lt)),u=[yt,Lt],o.substr(0,1)){case"l":Lt>yt&&(u=[Lt,yt]);break;case"p":yt>Lt&&(u=[Lt,yt])}Cu(u),ui(xc),lt(gs),Al!==0&&lt(Al+" J"),_s!==0&&lt(_s+" j"),yn.publish("addPage",{pageNumber:Cn})},gd=function(H){H>0&&H<=Cn&&(fr.splice(H,1),ki.splice(H,1),Cn--,xe>Cn&&(xe=Cn),this.setPage(xe))},Sh=function(H){H>0&&H<=Cn&&(xe=H)},_d=P.__private__.getNumberOfPages=P.getNumberOfPages=function(){return fr.length-1},Eh=function(H,Ee,ct){var yt,Lt=void 0;return ct=ct||{},H=H!==void 0?H:gi[Ui].fontName,Ee=Ee!==void 0?Ee:gi[Ui].fontStyle,yt=H.toLowerCase(),Dn[yt]!==void 0&&Dn[yt][Ee]!==void 0?Lt=Dn[yt][Ee]:Dn[H]!==void 0&&Dn[H][Ee]!==void 0?Lt=Dn[H][Ee]:ct.disableWarning===!1&&ja.warn("Unable to look up font label for font '"+H+"', '"+Ee+"'. Refer to getFontList() for available fonts."),Lt||ct.noFallback||(Lt=Dn.times[Ee])==null&&(Lt=Dn.times.normal),Lt},vd=P.__private__.putInfo=function(){var H=_a(),Ee=function(yt){return yt};for(var ct in D!==null&&(Ee=Ya.encryptor(H,0)),lt("<<"),lt("/Producer ("+Go(Ee("jsPDF "+Bi.version))+")"),xi)xi.hasOwnProperty(ct)&&xi[ct]&&lt("/"+ct.substr(0,1).toUpperCase()+ct.substr(1)+" ("+Go(Ee(xi[ct]))+")");lt("/CreationDate ("+Go(Ee(Ye))+")"),lt(">>"),lt("endobj")},Iu=P.__private__.putCatalog=function(H){var Ee=(H=H||{}).rootDictionaryObjId||W;switch(_a(),lt("<<"),lt("/Type /Catalog"),lt("/Pages "+Ee+" 0 R"),Nr||(Nr="fullwidth"),Nr){case"fullwidth":lt("/OpenAction [3 0 R /FitH null]");break;case"fullheight":lt("/OpenAction [3 0 R /FitV null]");break;case"fullpage":lt("/OpenAction [3 0 R /Fit]");break;case"original":lt("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ct=""+Nr;ct.substr(ct.length-1)==="%"&&(Nr=parseInt(Nr)/100),typeof Nr=="number"&&lt("/OpenAction [3 0 R /XYZ null null "+Ae(Nr)+"]")}switch(Ri||(Ri="continuous"),Ri){case"continuous":lt("/PageLayout /OneColumn");break;case"single":lt("/PageLayout /SinglePage");break;case"two":case"twoleft":lt("/PageLayout /TwoColumnLeft");break;case"tworight":lt("/PageLayout /TwoColumnRight")}si&&lt("/PageMode /"+si),yn.publish("putCatalog"),lt(">>"),lt("endobj")},gf=P.__private__.putTrailer=function(){lt("trailer"),lt("<<"),lt("/Size "+(Ve+1)),lt("/Root "+Ve+" 0 R"),lt("/Info "+(Ve-1)+" 0 R"),D!==null&&lt("/Encrypt "+Ya.oid+" 0 R"),lt("/ID [ <"+ut+"> <"+ut+"> ]"),lt(">>")},Zc=P.__private__.putHeader=function(){lt("%PDF-"+ee),lt("%\xBA\xDF\xAC\xE0")},Ah=P.__private__.putXRef=function(){var H="0000000000";lt("xref"),lt("0 "+(Ve+1)),lt("0000000000 65535 f ");for(var Ee=1;Ee<=Ve;Ee++)typeof gt[Ee]=="function"?lt((H+gt[Ee]()).slice(-10)+" 00000 n "):gt[Ee]!==void 0?lt((H+gt[Ee]).slice(-10)+" 00000 n "):lt("0000000000 00000 n ")},rl=P.__private__.buildDocument=function(){Fr(),$t(mt),yn.publish("buildDocument"),Zc(),We(),wh(),Gl(),D!==null&&Ti(),vd(),Iu();var H=wt;return Ah(),gf(),lt("startxref"),lt(""+H),lt("%%EOF"),$t(fr[xe]),mt.join(`
`)},ku=P.__private__.getBlob=function(H){return new Blob([nr(H)],{type:"application/pdf"})},Mu=P.output=P.__private__.output=Os(function(H,Ee){switch(typeof(Ee=Ee||{})=="string"?Ee={filename:Ee}:Ee.filename=Ee.filename||"generated.pdf",H){case void 0:return rl();case"save":P.save(Ee.filename);break;case"arraybuffer":return nr(rl());case"blob":return ku(rl());case"bloburi":case"bloburl":if(Wi.URL!==void 0&&typeof Wi.URL.createObjectURL=="function")return Wi.URL&&Wi.URL.createObjectURL(ku(rl()))||void 0;ja.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ct="",yt=rl();try{ct=DT(yt)}catch{ct=DT(unescape(encodeURIComponent(yt)))}return"data:application/pdf;filename="+Ee.filename+";base64,"+ct;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Wi)==="[object Window]"){var Lt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",sr=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Ee.pdfObjectUrl&&(Lt=Ee.pdfObjectUrl,sr="");var Mr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Lt+'"'+sr+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Ee)+");<\/script></body></html>",Yr=Wi.open();return Yr!==null&&Yr.document.write(Mr),Yr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Wi)==="[object Window]"){var hi='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Ee.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Ee.filename+'" width="500px" height="400px" /></body></html>',Fi=Wi.open();if(Fi!==null){Fi.document.write(hi);var di=this;Fi.document.documentElement.querySelector("#pdfViewer").onload=function(){Fi.document.title=Ee.filename,Fi.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(di.output("bloburl"))}}return Fi}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Wi)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var pn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Ee)+'"></iframe></body></html>',va=Wi.open();if(va!==null&&(va.document.write(pn),va.document.title=Ee.filename),va||typeof safari>"u")return va;break;case"datauri":case"dataurl":return Wi.document.location.href=this.output("datauristring",Ee);default:return null}}),yd=function(H){return Array.isArray(ms)===!0&&ms.indexOf(H)>-1};switch(c){case"pt":Lr=1;break;case"mm":Lr=72/25.4;break;case"cm":Lr=72/2.54;break;case"in":Lr=72;break;case"px":Lr=yd("px_scaling")==1?.75:96/72;break;case"pc":case"em":Lr=12;break;case"ex":Lr=6;break;default:if(typeof c!="number")throw new Error("Invalid unit: "+c);Lr=c}var Ya=null;Wt(),pt();var Mi=function(H){return D!==null?Ya.encryptor(H,0):function(Ee){return Ee}},_f=P.__private__.getPageInfo=P.getPageInfo=function(H){if(isNaN(H)||H%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:ki[H].objId,pageNumber:H,pageContext:ki[H]}},Vi=P.__private__.getPageInfoByObjId=function(H){if(isNaN(H)||H%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Ee in ki)if(ki[Ee].objId===H)break;return _f(Ee)},Cp=P.__private__.getCurrentPageInfo=P.getCurrentPageInfo=function(){return{objId:ki[xe].objId,pageNumber:xe,pageContext:ki[xe]}};P.addPage=function(){return Th.apply(this,arguments),this},P.setPage=function(){return Sh.apply(this,arguments),$t.call(this,fr[xe]),this},P.insertPage=function(H){return this.addPage(),this.movePage(xe,H),this},P.movePage=function(H,Ee){var ct,yt;if(H>Ee){ct=fr[H],yt=ki[H];for(var Lt=H;Lt>Ee;Lt--)fr[Lt]=fr[Lt-1],ki[Lt]=ki[Lt-1];fr[Ee]=ct,ki[Ee]=yt,this.setPage(Ee)}else if(H<Ee){ct=fr[H],yt=ki[H];for(var sr=H;sr<Ee;sr++)fr[sr]=fr[sr+1],ki[sr]=ki[sr+1];fr[Ee]=ct,ki[Ee]=yt,this.setPage(Ee)}return this},P.deletePage=function(){return gd.apply(this,arguments),this},P.__private__.text=P.text=function(H,Ee,ct,yt,Lt){var sr,Mr,Yr,hi,Fi,di,pn,va,Na,Va=(yt=yt||{}).scope||this;if(typeof H=="number"&&typeof Ee=="number"&&(typeof ct=="string"||Array.isArray(ct))){var Io=ct;ct=Ee,Ee=H,H=Io}if(arguments[3]instanceof Qr?(ge("The transform parameter of text() with a Matrix value"),Na=Lt):(Yr=arguments[4],hi=arguments[5],Pa(pn=arguments[3])==="object"&&pn!==null||(typeof Yr=="string"&&(hi=Yr,Yr=null),typeof pn=="string"&&(hi=pn,pn=null),typeof pn=="number"&&(Yr=pn,pn=null),yt={flags:pn,angle:Yr,align:hi})),isNaN(Ee)||isNaN(ct)||H==null)throw new Error("Invalid arguments passed to jsPDF.text");if(H.length===0)return Va;var la="",ys=!1,xs=typeof yt.lineHeightFactor=="number"?yt.lineHeightFactor:yc,zs=Va.internal.scaleFactor;function Ru(Qn){return Qn=Qn.split("	").join(Array(yt.TabLen||9).join(" ")),Go(Qn,pn)}function tu(Qn){for(var Yn,ca=Qn.concat(),Ka=[],bs=ca.length;bs--;)typeof(Yn=ca.shift())=="string"?Ka.push(Yn):Array.isArray(Qn)&&(Yn.length===1||Yn[1]===void 0&&Yn[2]===void 0)?Ka.push(Yn[0]):Ka.push([Yn[0],Yn[1],Yn[2]]);return Ka}function Xl(Qn,Yn){var ca;if(typeof Qn=="string")ca=Yn(Qn)[0];else if(Array.isArray(Qn)){for(var Ka,bs,Ha=Qn.concat(),Mc=[],Kl=Ha.length;Kl--;)typeof(Ka=Ha.shift())=="string"?Mc.push(Yn(Ka)[0]):Array.isArray(Ka)&&typeof Ka[0]=="string"&&(bs=Yn(Ka[0],Ka[1],Ka[2]),Mc.push([bs[0],bs[1],bs[2]]));ca=Mc}return ca}var Cl=!1,Fu=!0;if(typeof H=="string")Cl=!0;else if(Array.isArray(H)){var Pu=H.concat();Mr=[];for(var ru,rs=Pu.length;rs--;)(typeof(ru=Pu.shift())!="string"||Array.isArray(ru)&&typeof ru[0]!="string")&&(Fu=!1);Cl=Fu}if(Cl===!1)throw new Error('Type of text must be string or Array. "'+H+'" is not recognized.');typeof H=="string"&&(H=H.match(/[\r?\n]/)?H.split(/\r\n|\r|\n/g):[H]);var Ec=kr/Va.internal.scaleFactor,iu=Ec*(xs-1);switch(yt.baseline){case"bottom":ct-=iu;break;case"top":ct+=Ec-iu;break;case"hanging":ct+=Ec-2*iu;break;case"middle":ct+=Ec/2-iu}if((di=yt.maxWidth||0)>0&&(typeof H=="string"?H=Va.splitTextToSize(H,di):Object.prototype.toString.call(H)==="[object Array]"&&(H=H.reduce(function(Qn,Yn){return Qn.concat(Va.splitTextToSize(Yn,di))},[]))),sr={text:H,x:Ee,y:ct,options:yt,mutex:{pdfEscape:Go,activeFontKey:Ui,fonts:gi,activeFontSize:kr}},yn.publish("preProcessText",sr),H=sr.text,Yr=(yt=sr.options).angle,!(Na instanceof Qr)&&Yr&&typeof Yr=="number"){Yr*=Math.PI/180,yt.rotationDirection===0&&(Yr=-Yr),he===ne.ADVANCED&&(Yr=-Yr);var Ac=Math.cos(Yr),Cc=Math.sin(Yr);Na=new Qr(Ac,Cc,-Cc,Ac,0,0)}else Yr&&Yr instanceof Qr&&(Na=Yr);he!==ne.ADVANCED||Na||(Na=so),(Fi=yt.charSpace||$l)!==void 0&&(la+=Te(ve(Fi))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(va=yt.horizontalScale)!==void 0&&(la+=Te(100*va)+` Tz
`),yt.lang;var ho=-1,xf=yt.renderingMode!==void 0?yt.renderingMode:yt.stroke,Lu=Va.internal.getCurrentPageInfo().pageContext;switch(xf){case 0:case!1:case"fill":ho=0;break;case 1:case!0:case"stroke":ho=1;break;case 2:case"fillThenStroke":ho=2;break;case 3:case"invisible":ho=3;break;case 4:case"fillAndAddForClipping":ho=4;break;case 5:case"strokeAndAddPathForClipping":ho=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ho=6;break;case 7:case"addToPathForClipping":ho=7}var nu=Lu.usedRenderingMode!==void 0?Lu.usedRenderingMode:-1;ho!==-1?la+=ho+` Tr
`:nu!==-1&&(la+=`0 Tr
`),ho!==-1&&(Lu.usedRenderingMode=ho),hi=yt.align||"left";var is,nl=kr*xs,bd=Va.internal.pageSize.getWidth(),wd=gi[Ui];Fi=yt.charSpace||$l,di=yt.maxWidth||0,pn=Object.assign({autoencode:!0,noBOM:!0},yt.flags);var au=[];if(Object.prototype.toString.call(H)==="[object Array]"){var Ga;Mr=tu(H),hi!=="left"&&(is=Mr.map(function(Qn){return Va.getStringUnitWidth(Qn,{font:wd,charSpace:Fi,fontSize:kr,doKerning:!1})*kr/zs}));var Ho,Il=0;if(hi==="right"){Ee-=is[0],H=[],rs=Mr.length;for(var kl=0;kl<rs;kl++)kl===0?(Ho=lo(Ee),Ga=Ma(ct)):(Ho=ve(Il-is[kl]),Ga=-nl),H.push([Mr[kl],Ho,Ga]),Il=is[kl]}else if(hi==="center"){Ee-=is[0]/2,H=[],rs=Mr.length;for(var js=0;js<rs;js++)js===0?(Ho=lo(Ee),Ga=Ma(ct)):(Ho=ve((Il-is[js])/2),Ga=-nl),H.push([Mr[js],Ho,Ga]),Il=is[js]}else if(hi==="left"){H=[],rs=Mr.length;for(var Ou=0;Ou<rs;Ou++)H.push(Mr[Ou])}else{if(hi!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');H=[],rs=Mr.length,di=di!==0?di:bd;for(var Us=0;Us<rs;Us++)Ga=Us===0?Ma(ct):-nl,Ho=Us===0?lo(Ee):0,Us<rs-1?au.push(Te(ve((di-is[Us])/(Mr[Us].split(" ").length-1)))):au.push(0),H.push([Mr[Us],Ho,Ga])}}var Zl=typeof yt.R2L=="boolean"?yt.R2L:ii;Zl===!0&&(H=Xl(H,function(Qn,Yn,ca){return[Qn.split("").reverse().join(""),Yn,ca]})),sr={text:H,x:Ee,y:ct,options:yt,mutex:{pdfEscape:Go,activeFontKey:Ui,fonts:gi,activeFontSize:kr}},yn.publish("postProcessText",sr),H=sr.text,ys=sr.mutex.isHex||!1;var Mh=gi[Ui].encoding;Mh!=="WinAnsiEncoding"&&Mh!=="StandardEncoding"||(H=Xl(H,function(Qn,Yn,ca){return[Ru(Qn),Yn,ca]})),Mr=tu(H),H=[];for(var Ic,Ml,al,Nu=0,Dl=1,Yl=Array.isArray(Mr[0])?Dl:Nu,ol="",Rl=function(Qn,Yn,ca){var Ka="";return ca instanceof Qr?(ca=typeof yt.angle=="number"?Vo(ca,new Qr(1,0,0,1,Qn,Yn)):Vo(new Qr(1,0,0,1,Qn,Yn),ca),he===ne.ADVANCED&&(ca=Vo(new Qr(1,0,0,-1,0,0),ca)),Ka=ca.join(" ")+` Tm
`):Ka=Te(Qn)+" "+Te(Yn)+` Td
`,Ka},Vs=0;Vs<Mr.length;Vs++){switch(ol="",Yl){case Dl:al=(ys?"<":"(")+Mr[Vs][0]+(ys?">":")"),Ic=parseFloat(Mr[Vs][1]),Ml=parseFloat(Mr[Vs][2]);break;case Nu:al=(ys?"<":"(")+Mr[Vs]+(ys?">":")"),Ic=lo(Ee),Ml=Ma(ct)}au!==void 0&&au[Vs]!==void 0&&(ol=au[Vs]+` Tw
`),Vs===0?H.push(ol+Rl(Ic,Ml,Na)+al):Yl===Nu?H.push(ol+al):Yl===Dl&&H.push(ol+Rl(Ic,Ml,Na)+al)}H=Yl===Nu?H.join(` Tj
T* `):H.join(` Tj
`),H+=` Tj
`;var kc=`BT
/`;return kc+=Ui+" "+kr+` Tf
`,kc+=Te(kr*xs)+` TL
`,kc+=wc+`
`,kc+=la,kc+=H,lt(kc+="ET"),B[Ui]=!0,Va};var xd=P.__private__.clip=P.clip=function(H){return lt(H==="evenodd"?"W*":"W"),this};P.clipEvenOdd=function(){return xd("evenodd")},P.__private__.discardPath=P.discardPath=function(){return lt("n"),this};var yo=P.__private__.isValidStyle=function(H){var Ee=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(H)!==-1&&(Ee=!0),Ee};P.__private__.setDefaultPathOperation=P.setDefaultPathOperation=function(H){return yo(H)&&(k=H),this};var Ch=P.__private__.getStyle=P.getStyle=function(H){var Ee=k;switch(H){case"D":case"S":Ee="S";break;case"F":Ee="f";break;case"FD":case"DF":Ee="B";break;case"f":case"f*":case"B":case"B*":Ee=H}return Ee},Yc=P.close=function(){return lt("h"),this};P.stroke=function(){return lt("S"),this},P.fill=function(H){return Hl("f",H),this},P.fillEvenOdd=function(H){return Hl("f*",H),this},P.fillStroke=function(H){return Hl("B",H),this},P.fillStrokeEvenOdd=function(H){return Hl("B*",H),this};var Hl=function(H,Ee){Pa(Ee)==="object"?hr(Ee,H):lt(H)},Kc=function(H){H===null||he===ne.ADVANCED&&H===void 0||(H=Ch(H),lt(H))};function _c(H,Ee,ct,yt,Lt){var sr=new Mm(Ee||this.boundingBox,ct||this.xStep,yt||this.yStep,this.gState,Lt||this.matrix);sr.stream=this.stream;var Mr=H+"$$"+this.cloneIndex+++"$$";return Za(Mr,sr),sr}var hr=function(H,Ee){var ct=_o[H.key],yt=Qi[ct];if(yt instanceof Tp)lt("q"),lt(vf(Ee)),yt.gState&&P.setGState(yt.gState),lt(H.matrix.toString()+" cm"),lt("/"+ct+" sh"),lt("Q");else if(yt instanceof Mm){var Lt=new Qr(1,0,0,-1,0,Bs());H.matrix&&(Lt=Lt.multiply(H.matrix||so),ct=_c.call(yt,H.key,H.boundingBox,H.xStep,H.yStep,Lt).id),lt("q"),lt("/Pattern cs"),lt("/"+ct+" scn"),yt.gState&&P.setGState(yt.gState),lt(Ee),lt("Q")}},vf=function(H){switch(H){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},vc=P.moveTo=function(H,Ee){return lt(Te(ve(H))+" "+Te(Ce(Ee))+" m"),this},Ai=P.lineTo=function(H,Ee){return lt(Te(ve(H))+" "+Te(Ce(Ee))+" l"),this},ka=P.curveTo=function(H,Ee,ct,yt,Lt,sr){return lt([Te(ve(H)),Te(Ce(Ee)),Te(ve(ct)),Te(Ce(yt)),Te(ve(Lt)),Te(Ce(sr)),"c"].join(" ")),this};P.__private__.line=P.line=function(H,Ee,ct,yt,Lt){if(isNaN(H)||isNaN(Ee)||isNaN(ct)||isNaN(yt)||!yo(Lt))throw new Error("Invalid arguments passed to jsPDF.line");return he===ne.COMPAT?this.lines([[ct-H,yt-Ee]],H,Ee,[1,1],Lt||"S"):this.lines([[ct-H,yt-Ee]],H,Ee,[1,1]).stroke()},P.__private__.lines=P.lines=function(H,Ee,ct,yt,Lt,sr){var Mr,Yr,hi,Fi,di,pn,va,Na,Va,Io,la,ys;if(typeof H=="number"&&(ys=ct,ct=Ee,Ee=H,H=ys),yt=yt||[1,1],sr=sr||!1,isNaN(Ee)||isNaN(ct)||!Array.isArray(H)||!Array.isArray(yt)||!yo(Lt)||typeof sr!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(vc(Ee,ct),Mr=yt[0],Yr=yt[1],Fi=H.length,Io=Ee,la=ct,hi=0;hi<Fi;hi++)(di=H[hi]).length===2?(Io=di[0]*Mr+Io,la=di[1]*Yr+la,Ai(Io,la)):(pn=di[0]*Mr+Io,va=di[1]*Yr+la,Na=di[2]*Mr+Io,Va=di[3]*Yr+la,Io=di[4]*Mr+Io,la=di[5]*Yr+la,ka(pn,va,Na,Va,Io,la));return sr&&Yc(),Kc(Lt),this},P.path=function(H){for(var Ee=0;Ee<H.length;Ee++){var ct=H[Ee],yt=ct.c;switch(ct.op){case"m":vc(yt[0],yt[1]);break;case"l":Ai(yt[0],yt[1]);break;case"c":ka.apply(this,yt);break;case"h":Yc()}}return this},P.__private__.rect=P.rect=function(H,Ee,ct,yt,Lt){if(isNaN(H)||isNaN(Ee)||isNaN(ct)||isNaN(yt)||!yo(Lt))throw new Error("Invalid arguments passed to jsPDF.rect");return he===ne.COMPAT&&(yt=-yt),lt([Te(ve(H)),Te(Ce(Ee)),Te(ve(ct)),Te(ve(yt)),"re"].join(" ")),Kc(Lt),this},P.__private__.triangle=P.triangle=function(H,Ee,ct,yt,Lt,sr,Mr){if(isNaN(H)||isNaN(Ee)||isNaN(ct)||isNaN(yt)||isNaN(Lt)||isNaN(sr)||!yo(Mr))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ct-H,yt-Ee],[Lt-ct,sr-yt],[H-Lt,Ee-sr]],H,Ee,[1,1],Mr,!0),this},P.__private__.roundedRect=P.roundedRect=function(H,Ee,ct,yt,Lt,sr,Mr){if(isNaN(H)||isNaN(Ee)||isNaN(ct)||isNaN(yt)||isNaN(Lt)||isNaN(sr)||!yo(Mr))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Yr=4/3*(Math.SQRT2-1);return Lt=Math.min(Lt,.5*ct),sr=Math.min(sr,.5*yt),this.lines([[ct-2*Lt,0],[Lt*Yr,0,Lt,sr-sr*Yr,Lt,sr],[0,yt-2*sr],[0,sr*Yr,-Lt*Yr,sr,-Lt,sr],[2*Lt-ct,0],[-Lt*Yr,0,-Lt,-sr*Yr,-Lt,-sr],[0,2*sr-yt],[0,-sr*Yr,Lt*Yr,-sr,Lt,-sr]],H+Lt,Ee,[1,1],Mr,!0),this},P.__private__.ellipse=P.ellipse=function(H,Ee,ct,yt,Lt){if(isNaN(H)||isNaN(Ee)||isNaN(ct)||isNaN(yt)||!yo(Lt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var sr=4/3*(Math.SQRT2-1)*ct,Mr=4/3*(Math.SQRT2-1)*yt;return vc(H+ct,Ee),ka(H+ct,Ee-Mr,H+sr,Ee-yt,H,Ee-yt),ka(H-sr,Ee-yt,H-ct,Ee-Mr,H-ct,Ee),ka(H-ct,Ee+Mr,H-sr,Ee+yt,H,Ee+yt),ka(H+sr,Ee+yt,H+ct,Ee+Mr,H+ct,Ee),Kc(Lt),this},P.__private__.circle=P.circle=function(H,Ee,ct,yt){if(isNaN(H)||isNaN(Ee)||isNaN(ct)||!yo(yt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(H,Ee,ct,ct,yt)},P.setFont=function(H,Ee,ct){return ct&&(Ee=et(Ee,ct)),Ui=Eh(H,Ee,{disableWarning:!1}),this};var yf=P.__private__.getFont=P.getFont=function(){return gi[Eh.apply(P,arguments)]};P.__private__.getFontList=P.getFontList=function(){var H,Ee,ct={};for(H in Dn)if(Dn.hasOwnProperty(H))for(Ee in ct[H]=[],Dn[H])Dn[H].hasOwnProperty(Ee)&&ct[H].push(Ee);return ct},P.addFont=function(H,Ee,ct,yt,Lt){var sr=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&sr.indexOf(arguments[3])!==-1?Lt=arguments[3]:arguments[3]&&sr.indexOf(arguments[3])==-1&&(ct=et(ct,yt)),Lt=Lt||"Identity-H",gc.call(this,H,Ee,ct,Lt)};var yc,xc=a.lineWidth||.200025,Sl=P.__private__.getLineWidth=P.getLineWidth=function(){return xc},ui=P.__private__.setLineWidth=P.setLineWidth=function(H){return xc=H,lt(Te(ve(H))+" w"),this};P.__private__.setLineDash=Bi.API.setLineDash=Bi.API.setLineDashPattern=function(H,Ee){if(H=H||[],Ee=Ee||0,isNaN(Ee)||!Array.isArray(H))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return H=H.map(function(ct){return Te(ve(ct))}).join(" "),Ee=Te(ve(Ee)),lt("["+H+"] "+Ee+" d"),this};var Wl=P.__private__.getLineHeight=P.getLineHeight=function(){return kr*yc};P.__private__.getLineHeight=P.getLineHeight=function(){return kr*yc};var ql=P.__private__.setLineHeightFactor=P.setLineHeightFactor=function(H){return typeof(H=H||1.15)=="number"&&(yc=H),this},bc=P.__private__.getLineHeightFactor=P.getLineHeightFactor=function(){return yc};ql(a.lineHeight);var lo=P.__private__.getHorizontalCoordinate=function(H){return ve(H)},Ma=P.__private__.getVerticalCoordinate=function(H){return he===ne.ADVANCED?H:ki[xe].mediaBox.topRightY-ki[xe].mediaBox.bottomLeftY-ve(H)},Ip=P.__private__.getHorizontalCoordinateString=P.getHorizontalCoordinateString=function(H){return Te(lo(H))},El=P.__private__.getVerticalCoordinateString=P.getVerticalCoordinateString=function(H){return Te(Ma(H))},gs=a.strokeColor||"0 G";P.__private__.getStrokeColor=P.getDrawColor=function(){return se(gs)},P.__private__.setStrokeColor=P.setDrawColor=function(H,Ee,ct,yt){return gs=le({ch1:H,ch2:Ee,ch3:ct,ch4:yt,pdfColorType:"draw",precision:2}),lt(gs),this};var Du=a.fillColor||"0 g";P.__private__.getFillColor=P.getFillColor=function(){return se(Du)},P.__private__.setFillColor=P.setFillColor=function(H,Ee,ct,yt){return Du=le({ch1:H,ch2:Ee,ch3:ct,ch4:yt,pdfColorType:"fill",precision:2}),lt(Du),this};var wc=a.textColor||"0 g",Ih=P.__private__.getTextColor=P.getTextColor=function(){return se(wc)};P.__private__.setTextColor=P.setTextColor=function(H,Ee,ct,yt){return wc=le({ch1:H,ch2:Ee,ch3:ct,ch4:yt,pdfColorType:"text",precision:3}),this};var $l=a.charSpace,Jc=P.__private__.getCharSpace=P.getCharSpace=function(){return parseFloat($l||0)};P.__private__.setCharSpace=P.setCharSpace=function(H){if(isNaN(H))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return $l=H,this};var Al=0;P.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},P.__private__.setLineCap=P.setLineCap=function(H){var Ee=P.CapJoinStyles[H];if(Ee===void 0)throw new Error("Line cap style of '"+H+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Al=Ee,lt(Ee+" J"),this};var _s=0;P.__private__.setLineJoin=P.setLineJoin=function(H){var Ee=P.CapJoinStyles[H];if(Ee===void 0)throw new Error("Line join style of '"+H+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return _s=Ee,lt(Ee+" j"),this},P.__private__.setLineMiterLimit=P.__private__.setMiterLimit=P.setLineMiterLimit=P.setMiterLimit=function(H){if(H=H||0,isNaN(H))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return lt(Te(ve(H))+" M"),this},P.GState=C1,P.setGState=function(H){(H=typeof H=="string"?Gn[oo[H]]:kh(null,H)).equals(Co)||(lt("/"+H.id+" gs"),Co=H)};var kh=function(H,Ee){if(!H||!oo[H]){var ct=!1;for(var yt in Gn)if(Gn.hasOwnProperty(yt)&&Gn[yt].equals(Ee)){ct=!0;break}if(ct)Ee=Gn[yt];else{var Lt="GS"+(Object.keys(Gn).length+1).toString(10);Gn[Lt]=Ee,Ee.id=Lt}return H&&(oo[H]=Ee.id),yn.publish("addGState",Ee),Ee}};P.addGState=function(H,Ee){return kh(H,Ee),this},P.saveGraphicsState=function(){return lt("q"),Ao.push({key:Ui,size:kr,color:wc}),this},P.restoreGraphicsState=function(){lt("Q");var H=Ao.pop();return Ui=H.key,kr=H.size,wc=H.color,Co=null,this},P.setCurrentTransformationMatrix=function(H){return lt(H.toString()+" cm"),this},P.comment=function(H){return lt("#"+H),this};var Wn=function(H,Ee){var ct=H||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ct},set:function(sr){isNaN(sr)||(ct=parseFloat(sr))}});var yt=Ee||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return yt},set:function(sr){isNaN(sr)||(yt=parseFloat(sr))}});var Lt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Lt},set:function(sr){Lt=sr.toString()}}),this},vs=function(H,Ee,ct,yt){Wn.call(this,H,Ee),this.type="rect";var Lt=ct||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Lt},set:function(Mr){isNaN(Mr)||(Lt=parseFloat(Mr))}});var sr=yt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return sr},set:function(Mr){isNaN(Mr)||(sr=parseFloat(Mr))}}),this},co=function(){this.page=Cn,this.currentPage=xe,this.pages=fr.slice(0),this.pagesContext=ki.slice(0),this.x=Ua,this.y=Dr,this.matrix=Eo,this.width=Tc(xe),this.height=Bs(xe),this.outputDestination=Rr,this.id="",this.objectNumber=-1};co.prototype.restore=function(){Cn=this.page,xe=this.currentPage,ki=this.pagesContext,fr=this.pages,Ua=this.x,Dr=this.y,Eo=this.matrix,eu(xe,this.width),Sc(xe,this.height),Rr=this.outputDestination};var il=function(H,Ee,ct,yt,Lt){Oa.push(new co),Cn=xe=0,fr=[],Ua=H,Dr=Ee,Eo=Lt,Cu([ct,yt])},uo=function(H){if(vo[H])Oa.pop().restore();else{var Ee=new co,ct="Xo"+(Object.keys(On).length+1).toString(10);Ee.id=ct,vo[H]=ct,On[ct]=Ee,yn.publish("addFormObject",Ee),Oa.pop().restore()}};for(var Qc in P.beginFormObject=function(H,Ee,ct,yt,Lt){return il(H,Ee,ct,yt,Lt),this},P.endFormObject=function(H){return uo(H),this},P.doFormObject=function(H,Ee){var ct=On[vo[H]];return lt("q"),lt(Ee.toString()+" cm"),lt("/"+ct.id+" Do"),lt("Q"),this},P.getFormObject=function(H){var Ee=On[vo[H]];return{x:Ee.x,y:Ee.y,width:Ee.width,height:Ee.height,matrix:Ee.matrix}},P.save=function(H,Ee){return H=H||"generated.pdf",(Ee=Ee||{}).returnPromise=Ee.returnPromise||!1,Ee.returnPromise===!1?(km(ku(rl()),H),typeof km.unload=="function"&&Wi.setTimeout&&setTimeout(km.unload,911),this):new Promise(function(ct,yt){try{var Lt=km(ku(rl()),H);typeof km.unload=="function"&&Wi.setTimeout&&setTimeout(km.unload,911),ct(Lt)}catch(sr){yt(sr.message)}})},Bi.API)Bi.API.hasOwnProperty(Qc)&&(Qc==="events"&&Bi.API.events.length?function(H,Ee){var ct,yt,Lt;for(Lt=Ee.length-1;Lt!==-1;Lt--)ct=Ee[Lt][0],yt=Ee[Lt][1],H.subscribe.apply(H,[ct].concat(typeof yt=="function"?[yt]:yt))}(yn,Bi.API.events):P[Qc]=Bi.API[Qc]);var Tc=P.getPageWidth=function(H){return(ki[H=H||xe].mediaBox.topRightX-ki[H].mediaBox.bottomLeftX)/Lr},eu=P.setPageWidth=function(H,Ee){ki[H].mediaBox.topRightX=Ee*Lr+ki[H].mediaBox.bottomLeftX},Bs=P.getPageHeight=function(H){return(ki[H=H||xe].mediaBox.topRightY-ki[H].mediaBox.bottomLeftY)/Lr},Sc=P.setPageHeight=function(H,Ee){ki[H].mediaBox.topRightY=Ee*Lr+ki[H].mediaBox.bottomLeftY};return P.internal={pdfEscape:Go,getStyle:Ch,getFont:yf,getFontSize:Br,getCharSpace:Jc,getTextColor:Ih,getLineHeight:Wl,getLineHeightFactor:bc,getLineWidth:Sl,write:Bt,getHorizontalCoordinate:lo,getVerticalCoordinate:Ma,getCoordinateString:Ip,getVerticalCoordinateString:El,collections:{},newObject:_a,newAdditionalObject:U,newObjectDeferred:Jn,newObjectDeferredBegin:te,getFilters:De,putStream:Ze,events:yn,scaleFactor:Lr,pageSize:{getWidth:function(){return Tc(xe)},setWidth:function(H){eu(xe,H)},getHeight:function(){return Bs(xe)},setHeight:function(H){Sc(xe,H)}},encryptionOptions:D,encryption:Ya,getEncryptor:Mi,output:Mu,getNumberOfPages:_d,pages:fr,out:lt,f2:Ae,f3:_e,getPageInfo:_f,getPageInfoByObjId:Vi,getCurrentPageInfo:Cp,getPDFVersion:G,Point:Wn,Rectangle:vs,Matrix:Qr,hasHotfix:yd},Object.defineProperty(P.internal.pageSize,"width",{get:function(){return Tc(xe)},set:function(H){eu(xe,H)},enumerable:!0,configurable:!0}),Object.defineProperty(P.internal.pageSize,"height",{get:function(){return Bs(xe)},set:function(H){Sc(xe,H)},enumerable:!0,configurable:!0}),ci.call(P,br),Ui="F1",Th(u,o),yn.publish("initialized"),P}function UD(a){return a.reduce(function(i,o,c){return i[o]=c,i},{})}function OT(a){var i=a.family.replace(/"|'/g,"").toLowerCase(),o=function(r){return VD[r=r||"normal"]?r:"normal"}(a.style),c=function(r){if(!r)return 400;if(typeof r=="number")return r>=100&&r<=900&&r%100==0?r:400;if(/^\d00$/.test(r))return parseInt(r);switch(r){case"bold":return 700;case"normal":default:return 400}}(a.weight),u=function(r){return typeof LT[r=r||"normal"]=="number"?r:"normal"}(a.stretch);return{family:i,style:o,weight:c,stretch:u,src:a.src||[],ref:a.ref||{name:i,style:[u,o,c].join(" ")}}}function TD(a,i,o,c){var u;for(u=o;u>=0&&u<i.length;u+=c)if(a[i[u]])return a[i[u]];for(u=o;u>=0&&u<i.length;u-=c)if(a[i[u]])return a[i[u]]}function ED(a){return[a.stretch,a.style,a.weight,a.family].join(" ")}function eW(a,i,o){for(var c=(o=o||{}).defaultFontFamily||"times",u=Object.assign({},QH,o.genericFontFamilies||{}),r=null,_=null,T=0;T<i.length;++T)if(u[(r=OT(i[T])).family]&&(r.family=u[r.family]),a.hasOwnProperty(r.family)){_=a[r.family];break}if(!(_=_||a[c]))throw new Error("Could not find a font-family for the rule '"+ED(r)+"' and default family '"+c+"'.");if(_=function(E,k){if(k[E])return k[E];var D=LT[E],j=D<=LT.normal?-1:1,B=TD(k,GD,D,j);if(!B)throw new Error("Could not find a matching font-stretch value for "+E);return B}(r.stretch,_),_=function(E,k){if(k[E])return k[E];for(var D=VD[E],j=0;j<D.length;++j)if(k[D[j]])return k[D[j]];throw new Error("Could not find a matching font-style for "+E)}(r.style,_),!(_=function(E,k){if(k[E])return k[E];if(E===400&&k[500])return k[500];if(E===500&&k[400])return k[400];var D=JH[E],j=TD(k,HD,D,E<400?-1:1);if(!j)throw new Error("Could not find a matching font-weight for value "+E);return j}(r.weight,_)))throw new Error("Failed to resolve a font for the rule '"+ED(r)+"'.");return _}function AD(a){return a.trimLeft()}function tW(a,i){for(var o=0;o<a.length;){if(a.charAt(o)===i)return[a.substring(0,o),a.substring(o+1)];o+=1}return null}function rW(a){var i=a.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return i===null?null:[i[0],a.substring(i[0].length)]}function nW(a){var i=0;if(a[i++]!==71||a[i++]!==73||a[i++]!==70||a[i++]!==56||(a[i++]+1&253)!=56||a[i++]!==97)throw new Error("Invalid GIF 87a/89a header.");var o=a[i++]|a[i++]<<8,c=a[i++]|a[i++]<<8,u=a[i++],r=u>>7,_=1<<(7&u)+1;a[i++],a[i++];var T=null,E=null;r&&(T=i,E=_,i+=3*_);var k=!0,D=[],j=0,B=null,P=0,ee=null;for(this.width=o,this.height=c;k&&i<a.length;)switch(a[i++]){case 33:switch(a[i++]){case 255:if(a[i]!==11||a[i+1]==78&&a[i+2]==69&&a[i+3]==84&&a[i+4]==83&&a[i+5]==67&&a[i+6]==65&&a[i+7]==80&&a[i+8]==69&&a[i+9]==50&&a[i+10]==46&&a[i+11]==48&&a[i+12]==3&&a[i+13]==1&&a[i+16]==0)i+=14,ee=a[i++]|a[i++]<<8,i++;else for(i+=12;;){if(!((_e=a[i++])>=0))throw Error("Invalid block size");if(_e===0)break;i+=_e}break;case 249:if(a[i++]!==4||a[i+4]!==0)throw new Error("Invalid graphics extension block.");var G=a[i++];j=a[i++]|a[i++]<<8,B=a[i++],!(1&G)&&(B=null),P=G>>2&7,i++;break;case 254:for(;;){if(!((_e=a[i++])>=0))throw Error("Invalid block size");if(_e===0)break;i+=_e}break;default:throw new Error("Unknown graphic control label: 0x"+a[i-1].toString(16))}break;case 44:var K=a[i++]|a[i++]<<8,J=a[i++]|a[i++]<<8,ne=a[i++]|a[i++]<<8,he=a[i++]|a[i++]<<8,Me=a[i++],Re=Me>>6&1,et=1<<(7&Me)+1,Te=T,ge=E,Ue=!1;Me>>7&&(Ue=!0,Te=i,ge=et,i+=3*et);var Ae=i;for(i++;;){var _e;if(!((_e=a[i++])>=0))throw Error("Invalid block size");if(_e===0)break;i+=_e}D.push({x:K,y:J,width:ne,height:he,has_local_palette:Ue,palette_offset:Te,palette_size:ge,data_offset:Ae,data_length:i-Ae,transparent_index:B,interlaced:!!Re,delay:j,disposal:P});break;case 59:k=!1;break;default:throw new Error("Unknown gif block: 0x"+a[i-1].toString(16))}this.numFrames=function(){return D.length},this.loopCount=function(){return ee},this.frameInfo=function(ve){if(ve<0||ve>=D.length)throw new Error("Frame index out of range.");return D[ve]},this.decodeAndBlitFrameBGRA=function(ve,Qe){var Ce=this.frameInfo(ve),Ye=Ce.width*Ce.height,ut=new Uint8Array(Ye);RD(a,Ce.data_offset,ut,Ye);var st=Ce.palette_offset,pt=Ce.transparent_index;pt===null&&(pt=256);var Tt=Ce.width,ht=o-Tt,Wt=Tt,re=4*(Ce.y*o+Ce.x),xe=4*((Ce.y+Ce.height)*o+Ce.x),pe=re,Ie=4*ht;Ce.interlaced===!0&&(Ie+=4*o*7);for(var Ve=8,gt=0,mt=ut.length;gt<mt;++gt){var wt=ut[gt];if(Wt===0&&(Wt=Tt,(pe+=Ie)>=xe&&(Ie=4*ht+4*o*(Ve-1),pe=re+(Tt+ht)*(Ve<<1),Ve>>=1)),wt===pt)pe+=4;else{var Pt=a[st+3*wt],fr=a[st+3*wt+1],xr=a[st+3*wt+2];Qe[pe++]=xr,Qe[pe++]=fr,Qe[pe++]=Pt,Qe[pe++]=255}--Wt}},this.decodeAndBlitFrameRGBA=function(ve,Qe){var Ce=this.frameInfo(ve),Ye=Ce.width*Ce.height,ut=new Uint8Array(Ye);RD(a,Ce.data_offset,ut,Ye);var st=Ce.palette_offset,pt=Ce.transparent_index;pt===null&&(pt=256);var Tt=Ce.width,ht=o-Tt,Wt=Tt,re=4*(Ce.y*o+Ce.x),xe=4*((Ce.y+Ce.height)*o+Ce.x),pe=re,Ie=4*ht;Ce.interlaced===!0&&(Ie+=4*o*7);for(var Ve=8,gt=0,mt=ut.length;gt<mt;++gt){var wt=ut[gt];if(Wt===0&&(Wt=Tt,(pe+=Ie)>=xe&&(Ie=4*ht+4*o*(Ve-1),pe=re+(Tt+ht)*(Ve<<1),Ve>>=1)),wt===pt)pe+=4;else{var Pt=a[st+3*wt],fr=a[st+3*wt+1],xr=a[st+3*wt+2];Qe[pe++]=Pt,Qe[pe++]=fr,Qe[pe++]=xr,Qe[pe++]=255}--Wt}}}function RD(a,i,o,c){for(var u=a[i++],r=1<<u,_=r+1,T=_+1,E=u+1,k=(1<<E)-1,D=0,j=0,B=0,P=a[i++],ee=new Int32Array(4096),G=null;;){for(;D<16&&P!==0;)j|=a[i++]<<D,D+=8,P===1?P=a[i++]:--P;if(D<E)break;var K=j&k;if(j>>=E,D-=E,K!==r){if(K===_)break;for(var J=K<T?K:G,ne=0,he=J;he>r;)he=ee[he]>>8,++ne;var Me=he;if(B+ne+(J!==K?1:0)>c)return void ja.log("Warning, gif stream longer than expected.");o[B++]=Me;var Re=B+=ne;for(J!==K&&(o[B++]=Me),he=J;ne--;)he=ee[he],o[--Re]=255&he,he>>=8;G!==null&&T<4096&&(ee[T++]=G<<8|Me,T>=k+1&&E<12&&(++E,k=k<<1|1)),G=K}else T=_+1,k=(1<<(E=u+1))-1,G=null}return B!==c&&ja.log("Warning, gif stream shorter than expected."),o}function MT(a){var i,o,c,u,r,_=Math.floor,T=new Array(64),E=new Array(64),k=new Array(64),D=new Array(64),j=new Array(65535),B=new Array(65535),P=new Array(64),ee=new Array(64),G=[],K=0,J=7,ne=new Array(64),he=new Array(64),Me=new Array(64),Re=new Array(256),et=new Array(2048),Te=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],ge=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],Ue=[0,1,2,3,4,5,6,7,8,9,10,11],Ae=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],_e=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],ve=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Qe=[0,1,2,3,4,5,6,7,8,9,10,11],Ce=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Ye=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ut(re,xe){for(var pe=0,Ie=0,Ve=new Array,gt=1;gt<=16;gt++){for(var mt=1;mt<=re[gt];mt++)Ve[xe[Ie]]=[],Ve[xe[Ie]][0]=pe,Ve[xe[Ie]][1]=gt,Ie++,pe++;pe*=2}return Ve}function st(re){for(var xe=re[0],pe=re[1]-1;pe>=0;)xe&1<<pe&&(K|=1<<J),pe--,--J<0&&(K==255?(pt(255),pt(0)):pt(K),J=7,K=0)}function pt(re){G.push(re)}function Tt(re){pt(re>>8&255),pt(255&re)}function ht(re,xe,pe,Ie,Ve){for(var gt,mt=Ve[0],wt=Ve[240],Pt=function(br,kr){var Nr,Br,ii,si,wi,Ri,Ji,an,xi,Ui,Lr=0;for(xi=0;xi<8;++xi){Nr=br[Lr],Br=br[Lr+1],ii=br[Lr+2],si=br[Lr+3],wi=br[Lr+4],Ri=br[Lr+5],Ji=br[Lr+6];var Ua=Nr+(an=br[Lr+7]),Dr=Nr-an,Eo=Br+Ji,gi=Br-Ji,Dn=ii+Ri,Ao=ii-Ri,Qi=si+wi,_o=si-wi,Gn=Ua+Qi,oo=Ua-Qi,Co=Eo+Dn,Cn=Eo-Dn;br[Lr]=Gn+Co,br[Lr+4]=Gn-Co;var ki=.707106781*(Cn+oo);br[Lr+2]=oo+ki,br[Lr+6]=oo-ki;var yn=.382683433*((Gn=_o+Ao)-(Cn=gi+Dr)),ms=.5411961*Gn+yn,On=1.306562965*Cn+yn,vo=.707106781*(Co=Ao+gi),Oa=Dr+vo,Qr=Dr-vo;br[Lr+5]=Qr+ms,br[Lr+3]=Qr-ms,br[Lr+1]=Oa+On,br[Lr+7]=Oa-On,Lr+=8}for(Lr=0,xi=0;xi<8;++xi){Nr=br[Lr],Br=br[Lr+8],ii=br[Lr+16],si=br[Lr+24],wi=br[Lr+32],Ri=br[Lr+40],Ji=br[Lr+48];var Vo=Nr+(an=br[Lr+56]),so=Nr-an,Za=Br+Ji,_a=Br-Ji,Jn=ii+Ri,te=ii-Ri,U=si+wi,W=si-wi,Q=Vo+U,se=Vo-U,le=Za+Jn,De=Za-Jn;br[Lr]=Q+le,br[Lr+32]=Q-le;var Ze=.707106781*(De+se);br[Lr+16]=se+Ze,br[Lr+48]=se-Ze;var ke=.382683433*((Q=W+te)-(De=_a+so)),We=.5411961*Q+ke,nt=1.306562965*De+ke,dt=.707106781*(le=te+_a),Ft=so+dt,tr=so-dt;br[Lr+40]=tr+We,br[Lr+24]=tr-We,br[Lr+8]=Ft+nt,br[Lr+56]=Ft-nt,Lr++}for(xi=0;xi<64;++xi)Ui=br[xi]*kr[xi],P[xi]=Ui>0?Ui+.5|0:Ui-.5|0;return P}(re,xe),fr=0;fr<64;++fr)ee[Te[fr]]=Pt[fr];var xr=ee[0]-pe;pe=ee[0],xr==0?st(Ie[0]):(st(Ie[B[gt=32767+xr]]),st(j[gt]));for(var Rr=63;Rr>0&&ee[Rr]==0;)Rr--;if(Rr==0)return st(mt),pe;for(var Fr,$t=1;$t<=Rr;){for(var lt=$t;ee[$t]==0&&$t<=Rr;)++$t;var Bt=$t-lt;if(Bt>=16){Fr=Bt>>4;for(var nr=1;nr<=Fr;++nr)st(wt);Bt&=15}gt=32767+ee[$t],st(Ve[(Bt<<4)+B[gt]]),st(j[gt]),$t++}return Rr!=63&&st(mt),pe}function Wt(re){re=Math.min(Math.max(re,1),100),r!=re&&(function(xe){for(var pe=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Ie=0;Ie<64;Ie++){var Ve=_((pe[Ie]*xe+50)/100);Ve=Math.min(Math.max(Ve,1),255),T[Te[Ie]]=Ve}for(var gt=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],mt=0;mt<64;mt++){var wt=_((gt[mt]*xe+50)/100);wt=Math.min(Math.max(wt,1),255),E[Te[mt]]=wt}for(var Pt=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],fr=0,xr=0;xr<8;xr++)for(var Rr=0;Rr<8;Rr++)k[fr]=1/(T[Te[fr]]*Pt[xr]*Pt[Rr]*8),D[fr]=1/(E[Te[fr]]*Pt[xr]*Pt[Rr]*8),fr++}(re<50?Math.floor(5e3/re):Math.floor(200-2*re)),r=re)}this.encode=function(re,xe){xe&&Wt(xe),G=new Array,K=0,J=7,Tt(65496),Tt(65504),Tt(16),pt(74),pt(70),pt(73),pt(70),pt(0),pt(1),pt(1),pt(0),Tt(1),Tt(1),pt(0),pt(0),function(){Tt(65499),Tt(132),pt(0);for(var Br=0;Br<64;Br++)pt(T[Br]);pt(1);for(var ii=0;ii<64;ii++)pt(E[ii])}(),function(Br,ii){Tt(65472),Tt(17),pt(8),Tt(ii),Tt(Br),pt(3),pt(1),pt(17),pt(0),pt(2),pt(17),pt(1),pt(3),pt(17),pt(1)}(re.width,re.height),function(){Tt(65476),Tt(418),pt(0);for(var Br=0;Br<16;Br++)pt(ge[Br+1]);for(var ii=0;ii<=11;ii++)pt(Ue[ii]);pt(16);for(var si=0;si<16;si++)pt(Ae[si+1]);for(var wi=0;wi<=161;wi++)pt(_e[wi]);pt(1);for(var Ri=0;Ri<16;Ri++)pt(ve[Ri+1]);for(var Ji=0;Ji<=11;Ji++)pt(Qe[Ji]);pt(17);for(var an=0;an<16;an++)pt(Ce[an+1]);for(var xi=0;xi<=161;xi++)pt(Ye[xi])}(),Tt(65498),Tt(12),pt(3),pt(1),pt(0),pt(2),pt(17),pt(3),pt(17),pt(0),pt(63),pt(0);var pe=0,Ie=0,Ve=0;K=0,J=7,this.encode.displayName="_encode_";for(var gt,mt,wt,Pt,fr,xr,Rr,Fr,$t,lt=re.data,Bt=re.width,nr=re.height,br=4*Bt,kr=0;kr<nr;){for(gt=0;gt<br;){for(fr=br*kr+gt,Rr=-1,Fr=0,$t=0;$t<64;$t++)xr=fr+(Fr=$t>>3)*br+(Rr=4*(7&$t)),kr+Fr>=nr&&(xr-=br*(kr+1+Fr-nr)),gt+Rr>=br&&(xr-=gt+Rr-br+4),mt=lt[xr++],wt=lt[xr++],Pt=lt[xr++],ne[$t]=(et[mt]+et[wt+256>>0]+et[Pt+512>>0]>>16)-128,he[$t]=(et[mt+768>>0]+et[wt+1024>>0]+et[Pt+1280>>0]>>16)-128,Me[$t]=(et[mt+1280>>0]+et[wt+1536>>0]+et[Pt+1792>>0]>>16)-128;pe=ht(ne,k,pe,i,c),Ie=ht(he,D,Ie,o,u),Ve=ht(Me,D,Ve,o,u),gt+=32}kr+=8}if(J>=0){var Nr=[];Nr[1]=J+1,Nr[0]=(1<<J+1)-1,st(Nr)}return Tt(65497),new Uint8Array(G)},a=a||50,function(){for(var re=String.fromCharCode,xe=0;xe<256;xe++)Re[xe]=re(xe)}(),i=ut(ge,Ue),o=ut(ve,Qe),c=ut(Ae,_e),u=ut(Ce,Ye),function(){for(var re=1,xe=2,pe=1;pe<=15;pe++){for(var Ie=re;Ie<xe;Ie++)B[32767+Ie]=pe,j[32767+Ie]=[],j[32767+Ie][1]=pe,j[32767+Ie][0]=Ie;for(var Ve=-(xe-1);Ve<=-re;Ve++)B[32767+Ve]=pe,j[32767+Ve]=[],j[32767+Ve][1]=pe,j[32767+Ve][0]=xe-1+Ve;re<<=1,xe<<=1}}(),function(){for(var re=0;re<256;re++)et[re]=19595*re,et[re+256>>0]=38470*re,et[re+512>>0]=7471*re+32768,et[re+768>>0]=-11059*re,et[re+1024>>0]=-21709*re,et[re+1280>>0]=32768*re+8421375,et[re+1536>>0]=-27439*re,et[re+1792>>0]=-5329*re}(),Wt(a)}function yh(a,i){if(this.pos=0,this.buffer=a,this.datav=new DataView(a.buffer),this.is_with_alpha=!!i,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function FD(a){function i(ge){if(!ge)throw Error("assert :P")}function o(ge,Ue,Ae){for(var _e=0;4>_e;_e++)if(ge[Ue+_e]!=Ae.charCodeAt(_e))return!0;return!1}function c(ge,Ue,Ae,_e,ve){for(var Qe=0;Qe<ve;Qe++)ge[Ue+Qe]=Ae[_e+Qe]}function u(ge,Ue,Ae,_e){for(var ve=0;ve<_e;ve++)ge[Ue+ve]=Ae}function r(ge){return new Int32Array(ge)}function _(ge,Ue){for(var Ae=[],_e=0;_e<ge;_e++)Ae.push(new Ue);return Ae}function T(ge,Ue){var Ae=[];return function _e(ve,Qe,Ce){for(var Ye=Ce[Qe],ut=0;ut<Ye&&(ve.push(Ce.length>Qe+1?[]:new Ue),!(Ce.length<Qe+1));ut++)_e(ve[ut],Qe+1,Ce)}(Ae,0,ge),Ae}var E=function(){var ge=this;function Ue(I,L){for(var Y=1<<L-1>>>0;I&Y;)Y>>>=1;return Y?(I&Y-1)+Y:I}function Ae(I,L,Y,ce,Se){i(!(ce%Y));do I[L+(ce-=Y)]=Se;while(0<ce)}function _e(I,L,Y,ce,Se){if(i(2328>=Se),512>=Se)var Le=r(512);else if((Le=r(Se))==null)return 0;return function(ze,Ge,Xe,tt,St,it){var Ut,Rt,vr=Ge,rr=1<<Xe,Et=r(16),It=r(16);for(i(St!=0),i(tt!=null),i(ze!=null),i(0<Xe),Rt=0;Rt<St;++Rt){if(15<tt[Rt])return 0;++Et[tt[Rt]]}if(Et[0]==St)return 0;for(It[1]=0,Ut=1;15>Ut;++Ut){if(Et[Ut]>1<<Ut)return 0;It[Ut+1]=It[Ut]+Et[Ut]}for(Rt=0;Rt<St;++Rt)Ut=tt[Rt],0<tt[Rt]&&(it[It[Ut]++]=Rt);if(It[15]==1)return(tt=new ve).g=0,tt.value=it[0],Ae(ze,vr,1,rr,tt),rr;var ur,yr=-1,gr=rr-1,$r=0,Hr=1,Ci=1,Wr=1<<Xe;for(Rt=0,Ut=1,St=2;Ut<=Xe;++Ut,St<<=1){if(Hr+=Ci<<=1,0>(Ci-=Et[Ut]))return 0;for(;0<Et[Ut];--Et[Ut])(tt=new ve).g=Ut,tt.value=it[Rt++],Ae(ze,vr+$r,St,Wr,tt),$r=Ue($r,Ut)}for(Ut=Xe+1,St=2;15>=Ut;++Ut,St<<=1){if(Hr+=Ci<<=1,0>(Ci-=Et[Ut]))return 0;for(;0<Et[Ut];--Et[Ut]){if(tt=new ve,($r&gr)!=yr){for(vr+=Wr,ur=1<<(yr=Ut)-Xe;15>yr&&!(0>=(ur-=Et[yr]));)++yr,ur<<=1;rr+=Wr=1<<(ur=yr-Xe),ze[Ge+(yr=$r&gr)].g=ur+Xe,ze[Ge+yr].value=vr-Ge-yr}tt.g=Ut-Xe,tt.value=it[Rt++],Ae(ze,vr+($r>>Xe),St,Wr,tt),$r=Ue($r,Ut)}}return Hr!=2*It[15]-1?0:rr}(I,L,Y,ce,Se,Le)}function ve(){this.value=this.g=0}function Qe(){this.value=this.g=0}function Ce(){this.G=_(5,ve),this.H=r(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=_(rs,Qe)}function Ye(I,L,Y,ce){i(I!=null),i(L!=null),i(2147483648>ce),I.Ca=254,I.I=0,I.b=-8,I.Ka=0,I.oa=L,I.pa=Y,I.Jd=L,I.Yc=Y+ce,I.Zc=4<=ce?Y+ce-4+1:Y,gt(I)}function ut(I,L){for(var Y=0;0<L--;)Y|=wt(I,128)<<L;return Y}function st(I,L){var Y=ut(I,L);return mt(I)?-Y:Y}function pt(I,L,Y,ce){var Se,Le=0;for(i(I!=null),i(L!=null),i(4294967288>ce),I.Sb=ce,I.Ra=0,I.u=0,I.h=0,4<ce&&(ce=4),Se=0;Se<ce;++Se)Le+=L[Y+Se]<<8*Se;I.Ra=Le,I.bb=ce,I.oa=L,I.pa=Y}function Tt(I){for(;8<=I.u&&I.bb<I.Sb;)I.Ra>>>=8,I.Ra+=I.oa[I.pa+I.bb]<<Ac-8>>>0,++I.bb,I.u-=8;pe(I)&&(I.h=1,I.u=0)}function ht(I,L){if(i(0<=L),!I.h&&L<=iu){var Y=xe(I)&Ec[L];return I.u+=L,Tt(I),Y}return I.h=1,I.u=0}function Wt(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function re(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function xe(I){return I.Ra>>>(I.u&Ac-1)>>>0}function pe(I){return i(I.bb<=I.Sb),I.h||I.bb==I.Sb&&I.u>Ac}function Ie(I,L){I.u=L,I.h=pe(I)}function Ve(I){I.u>=Cc&&(i(I.u>=Cc),Tt(I))}function gt(I){i(I!=null&&I.oa!=null),I.pa<I.Zc?(I.I=(I.oa[I.pa++]|I.I<<8)>>>0,I.b+=8):(i(I!=null&&I.oa!=null),I.pa<I.Yc?(I.b+=8,I.I=I.oa[I.pa++]|I.I<<8):I.Ka?I.b=0:(I.I<<=8,I.b+=8,I.Ka=1))}function mt(I){return ut(I,1)}function wt(I,L){var Y=I.Ca;0>I.b&&gt(I);var ce=I.b,Se=Y*L>>>8,Le=(I.I>>>ce>Se)+0;for(Le?(Y-=Se,I.I-=Se+1<<ce>>>0):Y=Se+1,ce=Y,Se=0;256<=ce;)Se+=8,ce>>=8;return ce=7^Se+ho[ce],I.b-=ce,I.Ca=(Y<<ce)-1,Le}function Pt(I,L,Y){I[L+0]=Y>>24&255,I[L+1]=Y>>16&255,I[L+2]=Y>>8&255,I[L+3]=Y>>0&255}function fr(I,L){return I[L+0]<<0|I[L+1]<<8}function xr(I,L){return fr(I,L)|I[L+2]<<16}function Rr(I,L){return fr(I,L)|fr(I,L+2)<<16}function Fr(I,L){var Y=1<<L;return i(I!=null),i(0<L),I.X=r(Y),I.X==null?0:(I.Mb=32-L,I.Xa=L,1)}function $t(I,L){i(I!=null),i(L!=null),i(I.Xa==L.Xa),c(L.X,0,I.X,0,1<<L.Xa)}function lt(){this.X=[],this.Xa=this.Mb=0}function Bt(I,L,Y,ce){i(Y!=null),i(ce!=null);var Se=Y[0],Le=ce[0];return Se==0&&(Se=(I*Le+L/2)/L),Le==0&&(Le=(L*Se+I/2)/I),0>=Se||0>=Le?0:(Y[0]=Se,ce[0]=Le,1)}function nr(I,L){return I+(1<<L)-1>>>L}function br(I,L){return((4278255360&I)+(4278255360&L)>>>0&4278255360)+((16711935&I)+(16711935&L)>>>0&16711935)>>>0}function kr(I,L){ge[L]=function(Y,ce,Se,Le,ze,Ge,Xe){var tt;for(tt=0;tt<ze;++tt){var St=ge[I](Ge[Xe+tt-1],Se,Le+tt);Ge[Xe+tt]=br(Y[ce+tt],St)}}}function Nr(){this.ud=this.hd=this.jd=0}function Br(I,L){return((4278124286&(I^L))>>>1)+(I&L)>>>0}function ii(I){return 0<=I&&256>I?I:0>I?0:255<I?255:void 0}function si(I,L){return ii(I+(I-L+.5>>1))}function wi(I,L,Y){return Math.abs(L-Y)-Math.abs(I-Y)}function Ri(I,L,Y,ce,Se,Le,ze){for(ce=Le[ze-1],Y=0;Y<Se;++Y)Le[ze+Y]=ce=br(I[L+Y],ce)}function Ji(I,L,Y,ce,Se){var Le;for(Le=0;Le<Y;++Le){var ze=I[L+Le],Ge=ze>>8&255,Xe=16711935&(Xe=(Xe=16711935&ze)+((Ge<<16)+Ge));ce[Se+Le]=(4278255360&ze)+Xe>>>0}}function an(I,L){L.jd=I>>0&255,L.hd=I>>8&255,L.ud=I>>16&255}function xi(I,L,Y,ce,Se,Le){var ze;for(ze=0;ze<ce;++ze){var Ge=L[Y+ze],Xe=Ge>>>8,tt=Ge,St=255&(St=(St=Ge>>>16)+((I.jd<<24>>24)*(Xe<<24>>24)>>>5));tt=255&(tt=(tt=tt+((I.hd<<24>>24)*(Xe<<24>>24)>>>5))+((I.ud<<24>>24)*(St<<24>>24)>>>5)),Se[Le+ze]=(4278255360&Ge)+(St<<16)+tt}}function Ui(I,L,Y,ce,Se){ge[L]=function(Le,ze,Ge,Xe,tt,St,it,Ut,Rt){for(Xe=it;Xe<Ut;++Xe)for(it=0;it<Rt;++it)tt[St++]=Se(Ge[ce(Le[ze++])])},ge[I]=function(Le,ze,Ge,Xe,tt,St,it){var Ut=8>>Le.b,Rt=Le.Ea,vr=Le.K[0],rr=Le.w;if(8>Ut)for(Le=(1<<Le.b)-1,rr=(1<<Ut)-1;ze<Ge;++ze){var Et,It=0;for(Et=0;Et<Rt;++Et)Et&Le||(It=ce(Xe[tt++])),St[it++]=Se(vr[It&rr]),It>>=Ut}else ge["VP8LMapColor"+Y](Xe,tt,vr,rr,St,it,ze,Ge,Rt)}}function Lr(I,L,Y,ce,Se){for(Y=L+Y;L<Y;){var Le=I[L++];ce[Se++]=Le>>16&255,ce[Se++]=Le>>8&255,ce[Se++]=Le>>0&255}}function Ua(I,L,Y,ce,Se){for(Y=L+Y;L<Y;){var Le=I[L++];ce[Se++]=Le>>16&255,ce[Se++]=Le>>8&255,ce[Se++]=Le>>0&255,ce[Se++]=Le>>24&255}}function Dr(I,L,Y,ce,Se){for(Y=L+Y;L<Y;){var Le=(ze=I[L++])>>16&240|ze>>12&15,ze=ze>>0&240|ze>>28&15;ce[Se++]=Le,ce[Se++]=ze}}function Eo(I,L,Y,ce,Se){for(Y=L+Y;L<Y;){var Le=(ze=I[L++])>>16&248|ze>>13&7,ze=ze>>5&224|ze>>3&31;ce[Se++]=Le,ce[Se++]=ze}}function gi(I,L,Y,ce,Se){for(Y=L+Y;L<Y;){var Le=I[L++];ce[Se++]=Le>>0&255,ce[Se++]=Le>>8&255,ce[Se++]=Le>>16&255}}function Dn(I,L,Y,ce,Se,Le){if(Le==0)for(Y=L+Y;L<Y;)Pt(ce,((Le=I[L++])[0]>>24|Le[1]>>8&65280|Le[2]<<8&16711680|Le[3]<<24)>>>0),Se+=32;else c(ce,Se,I,L,Y)}function Ao(I,L){ge[L][0]=ge[I+"0"],ge[L][1]=ge[I+"1"],ge[L][2]=ge[I+"2"],ge[L][3]=ge[I+"3"],ge[L][4]=ge[I+"4"],ge[L][5]=ge[I+"5"],ge[L][6]=ge[I+"6"],ge[L][7]=ge[I+"7"],ge[L][8]=ge[I+"8"],ge[L][9]=ge[I+"9"],ge[L][10]=ge[I+"10"],ge[L][11]=ge[I+"11"],ge[L][12]=ge[I+"12"],ge[L][13]=ge[I+"13"],ge[L][14]=ge[I+"0"],ge[L][15]=ge[I+"0"]}function Qi(I){return I==Po||I==ou||I==Oi||I==Hs}function _o(){this.eb=[],this.size=this.A=this.fb=0}function Gn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function oo(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new _o,this.f.kb=new Gn,this.sd=null}function Co(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Cn(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ki(I){return alert("todo:WebPSamplerProcessPlane"),I.T}function yn(I,L){var Y=I.T,ce=L.ba.f.RGBA,Se=ce.eb,Le=ce.fb+I.ka*ce.A,ze=qa[L.ba.S],Ge=I.y,Xe=I.O,tt=I.f,St=I.N,it=I.ea,Ut=I.W,Rt=L.cc,vr=L.dc,rr=L.Mc,Et=L.Nc,It=I.ka,ur=I.ka+I.T,yr=I.U,gr=yr+1>>1;for(It==0?ze(Ge,Xe,null,null,tt,St,it,Ut,tt,St,it,Ut,Se,Le,null,null,yr):(ze(L.ec,L.fc,Ge,Xe,Rt,vr,rr,Et,tt,St,it,Ut,Se,Le-ce.A,Se,Le,yr),++Y);It+2<ur;It+=2)Rt=tt,vr=St,rr=it,Et=Ut,St+=I.Rc,Ut+=I.Rc,Le+=2*ce.A,ze(Ge,(Xe+=2*I.fa)-I.fa,Ge,Xe,Rt,vr,rr,Et,tt,St,it,Ut,Se,Le-ce.A,Se,Le,yr);return Xe+=I.fa,I.j+ur<I.o?(c(L.ec,L.fc,Ge,Xe,yr),c(L.cc,L.dc,tt,St,gr),c(L.Mc,L.Nc,it,Ut,gr),Y--):1&ur||ze(Ge,Xe,null,null,tt,St,it,Ut,tt,St,it,Ut,Se,Le+ce.A,null,null,yr),Y}function ms(I,L,Y){var ce=I.F,Se=[I.J];if(ce!=null){var Le=I.U,ze=L.ba.S,Ge=ze==Tr||ze==Oi;L=L.ba.f.RGBA;var Xe=[0],tt=I.ka;Xe[0]=I.T,I.Kb&&(tt==0?--Xe[0]:(--tt,Se[0]-=I.width),I.j+I.ka+I.T==I.o&&(Xe[0]=I.o-I.j-tt));var St=L.eb;tt=L.fb+tt*L.A,I=Kl(ce,Se[0],I.width,Le,Xe,St,tt+(Ge?0:3),L.A),i(Y==Xe),I&&Qi(ze)&&Ha(St,tt,Ge,Le,Xe,L.A)}return 0}function On(I){var L=I.ma,Y=L.ba.S,ce=11>Y,Se=Y==Gs||Y==Dc||Y==Tr||Y==Gi||Y==12||Qi(Y);if(L.memory=null,L.Ib=null,L.Jb=null,L.Nd=null,!Fu(L.Oa,I,Se?11:12))return 0;if(Se&&Qi(Y)&&Mr(),I.da)alert("todo:use_scaling");else{if(ce){if(L.Ib=ki,I.Kb){if(Y=I.U+1>>1,L.memory=r(I.U+2*Y),L.memory==null)return 0;L.ec=L.memory,L.fc=0,L.cc=L.ec,L.dc=L.fc+I.U,L.Mc=L.cc,L.Nc=L.dc+Y,L.Ib=yn,Mr()}}else alert("todo:EmitYUV");Se&&(L.Jb=ms,ce&&Lt())}if(ce&&!zi){for(I=0;256>I;++I)Lc[I]=89858*(I-128)+cu>>Ef,bg[I]=-22014*(I-128)+cu,xg[I]=-45773*(I-128),jm[I]=113618*(I-128)+cu>>Ef;for(I=ec;I<Rp;++I)L=76283*(I-16)+cu>>Ef,Ad[I-ec]=xs(L,255),Af[I-ec]=xs(L+8>>4,15);zi=1}return 1}function vo(I){var L=I.ma,Y=I.U,ce=I.T;return i(!(1&I.ka)),0>=Y||0>=ce?0:(Y=L.Ib(I,L),L.Jb!=null&&L.Jb(I,L,Y),L.Dc+=Y,1)}function Oa(I){I.ma.memory=null}function Qr(I,L,Y,ce){return ht(I,8)!=47?0:(L[0]=ht(I,14)+1,Y[0]=ht(I,14)+1,ce[0]=ht(I,1),ht(I,3)!=0?0:!I.h)}function Vo(I,L){if(4>I)return I+1;var Y=I-2>>1;return(2+(1&I)<<Y)+ht(L,Y)+1}function so(I,L){return 120<L?L-120:1<=(Y=((Y=Sd[L-1])>>4)*I+(8-(15&Y)))?Y:1;var Y}function Za(I,L,Y){var ce=xe(Y),Se=I[L+=255&ce].g-8;return 0<Se&&(Ie(Y,Y.u+8),ce=xe(Y),L+=I[L].value,L+=ce&(1<<Se)-1),Ie(Y,Y.u+I[L].g),I[L].value}function _a(I,L,Y){return Y.g+=I.g,Y.value+=I.value<<L>>>0,i(8>=Y.g),I.g}function Jn(I,L,Y){var ce=I.xc;return i((L=ce==0?0:I.vc[I.md*(Y>>ce)+(L>>ce)])<I.Wb),I.Ya[L]}function te(I,L,Y,ce){var Se=I.ab,Le=I.c*L,ze=I.C;L=ze+L;var Ge=Y,Xe=ce;for(ce=I.Ta,Y=I.Ua;0<Se--;){var tt=I.gc[Se],St=ze,it=L,Ut=Ge,Rt=Xe,vr=(Xe=ce,Ge=Y,tt.Ea);switch(i(St<it),i(it<=tt.nc),tt.hc){case 2:nu(Ut,Rt,(it-St)*vr,Xe,Ge);break;case 0:var rr=St,Et=it,It=Xe,ur=Ge,yr=(Wr=tt).Ea;rr==0&&(xf(Ut,Rt,null,null,1,It,ur),Ri(Ut,Rt+1,0,0,yr-1,It,ur+1),Rt+=yr,ur+=yr,++rr);for(var gr=1<<Wr.b,$r=gr-1,Hr=nr(yr,Wr.b),Ci=Wr.K,Wr=Wr.w+(rr>>Wr.b)*Hr;rr<Et;){var Fn=Ci,Nn=Wr,on=1;for(Lu(Ut,Rt,It,ur-yr,1,It,ur);on<yr;){var dn=(on&~$r)+gr;dn>yr&&(dn=yr),(0,au[Fn[Nn++]>>8&15])(Ut,Rt+ +on,It,ur+on-yr,dn-on,It,ur+on),on=dn}Rt+=yr,ur+=yr,++rr&$r||(Wr+=Hr)}it!=tt.nc&&c(Xe,Ge-vr,Xe,Ge+(it-St-1)*vr,vr);break;case 1:for(vr=Ut,Et=Rt,yr=(Ut=tt.Ea)-(ur=Ut&~(It=(Rt=1<<tt.b)-1)),rr=nr(Ut,tt.b),gr=tt.K,tt=tt.w+(St>>tt.b)*rr;St<it;){for($r=gr,Hr=tt,Ci=new Nr,Wr=Et+ur,Fn=Et+Ut;Et<Wr;)an($r[Hr++],Ci),Ga(Ci,vr,Et,Rt,Xe,Ge),Et+=Rt,Ge+=Rt;Et<Fn&&(an($r[Hr++],Ci),Ga(Ci,vr,Et,yr,Xe,Ge),Et+=yr,Ge+=yr),++St&It||(tt+=rr)}break;case 3:if(Ut==Xe&&Rt==Ge&&0<tt.b){for(Et=Xe,Ut=vr=Ge+(it-St)*vr-(ur=(it-St)*nr(tt.Ea,tt.b)),Rt=Xe,It=Ge,rr=[],ur=(yr=ur)-1;0<=ur;--ur)rr[ur]=Rt[It+ur];for(ur=yr-1;0<=ur;--ur)Et[Ut+ur]=rr[ur];is(tt,St,it,Xe,vr,Xe,Ge)}else is(tt,St,it,Ut,Rt,Xe,Ge)}Ge=ce,Xe=Y}Xe!=Y&&c(ce,Y,Ge,Xe,Le)}function U(I,L){var Y=I.V,ce=I.Ba+I.c*I.C,Se=L-I.C;if(i(L<=I.l.o),i(16>=Se),0<Se){var Le=I.l,ze=I.Ta,Ge=I.Ua,Xe=Le.width;if(te(I,Se,Y,ce),Se=Ge=[Ge],i((Y=I.C)<(ce=L)),i(Le.v<Le.va),ce>Le.o&&(ce=Le.o),Y<Le.j){var tt=Le.j-Y;Y=Le.j,Se[0]+=tt*Xe}if(Y>=ce?Y=0:(Se[0]+=4*Le.v,Le.ka=Y-Le.j,Le.U=Le.va-Le.v,Le.T=ce-Y,Y=1),Y){if(Ge=Ge[0],11>(Y=I.ca).S){var St=Y.f.RGBA,it=(ce=Y.S,Se=Le.U,Le=Le.T,tt=St.eb,St.A),Ut=Le;for(St=St.fb+I.Ma*St.A;0<Ut--;){var Rt=ze,vr=Ge,rr=Se,Et=tt,It=St;switch(ce){case Fh:Ho(Rt,vr,rr,Et,It);break;case Gs:Il(Rt,vr,rr,Et,It);break;case Po:Il(Rt,vr,rr,Et,It),Ha(Et,It,0,rr,1,0);break;case wf:Ou(Rt,vr,rr,Et,It);break;case Dc:Dn(Rt,vr,rr,Et,It,1);break;case ou:Dn(Rt,vr,rr,Et,It,1),Ha(Et,It,0,rr,1,0);break;case Tr:Dn(Rt,vr,rr,Et,It,0);break;case Oi:Dn(Rt,vr,rr,Et,It,0),Ha(Et,It,1,rr,1,0);break;case Gi:kl(Rt,vr,rr,Et,It);break;case Hs:kl(Rt,vr,rr,Et,It),Mc(Et,It,rr,1,0);break;case $i:js(Rt,vr,rr,Et,It);break;default:i(0)}Ge+=Xe,St+=it}I.Ma+=Le}else alert("todo:EmitRescaledRowsYUVA");i(I.Ma<=Y.height)}}I.C=L,i(I.C<=I.i)}function W(I){var L;if(0<I.ua)return 0;for(L=0;L<I.Wb;++L){var Y=I.Ya[L].G,ce=I.Ya[L].H;if(0<Y[1][ce[1]+0].g||0<Y[2][ce[2]+0].g||0<Y[3][ce[3]+0].g)return 0}return 1}function Q(I,L,Y,ce,Se,Le){if(I.Z!=0){var ze=I.qd,Ge=I.rd;for(i(lu[I.Z]!=null);L<Y;++L)lu[I.Z](ze,Ge,ce,Se,ce,Se,Le),ze=ce,Ge=Se,Se+=Le;I.qd=ze,I.rd=Ge}}function se(I,L){var Y=I.l.ma,ce=Y.Z==0||Y.Z==1?I.l.j:I.C;if(ce=I.C<ce?ce:I.C,i(L<=I.l.o),L>ce){var Se=I.l.width,Le=Y.ca,ze=Y.tb+Se*ce,Ge=I.V,Xe=I.Ba+I.c*ce,tt=I.gc;i(I.ab==1),i(tt[0].hc==3),bd(tt[0],ce,L,Ge,Xe,Le,ze),Q(Y,ce,L,Le,ze,Se)}I.C=I.Ma=L}function le(I,L,Y,ce,Se,Le,ze){var Ge=I.$/ce,Xe=I.$%ce,tt=I.m,St=I.s,it=Y+I.$,Ut=it;Se=Y+ce*Se;var Rt=Y+ce*Le,vr=280+St.ua,rr=I.Pb?Ge:16777216,Et=0<St.ua?St.Wa:null,It=St.wc,ur=it<Rt?Jn(St,Xe,Ge):null;i(I.C<Le),i(Rt<=Se);var yr=!1;e:for(;;){for(;yr||it<Rt;){var gr=0;if(Ge>=rr){var $r=it-Y;i((rr=I).Pb),rr.wd=rr.m,rr.xd=$r,0<rr.s.ua&&$t(rr.s.Wa,rr.s.vb),rr=Ge+Lh}if(Xe&It||(ur=Jn(St,Xe,Ge)),i(ur!=null),ur.Qb&&(L[it]=ur.qb,yr=!0),!yr)if(Ve(tt),ur.jc){gr=tt,$r=L;var Hr=it,Ci=ur.pd[xe(gr)&rs-1];i(ur.jc),256>Ci.g?(Ie(gr,gr.u+Ci.g),$r[Hr]=Ci.value,gr=0):(Ie(gr,gr.u+Ci.g-256),i(256<=Ci.value),gr=Ci.value),gr==0&&(yr=!0)}else gr=Za(ur.G[0],ur.H[0],tt);if(tt.h)break;if(yr||256>gr){if(!yr)if(ur.nd)L[it]=(ur.qb|gr<<8)>>>0;else{if(Ve(tt),yr=Za(ur.G[1],ur.H[1],tt),Ve(tt),$r=Za(ur.G[2],ur.H[2],tt),Hr=Za(ur.G[3],ur.H[3],tt),tt.h)break;L[it]=(Hr<<24|yr<<16|gr<<8|$r)>>>0}if(yr=!1,++it,++Xe>=ce&&(Xe=0,++Ge,ze!=null&&Ge<=Le&&!(Ge%16)&&ze(I,Ge),Et!=null))for(;Ut<it;)gr=L[Ut++],Et.X[(506832829*gr&4294967295)>>>Et.Mb]=gr}else if(280>gr){if(gr=Vo(gr-256,tt),$r=Za(ur.G[4],ur.H[4],tt),Ve(tt),$r=so(ce,$r=Vo($r,tt)),tt.h)break;if(it-Y<$r||Se-it<gr)break e;for(Hr=0;Hr<gr;++Hr)L[it+Hr]=L[it+Hr-$r];for(it+=gr,Xe+=gr;Xe>=ce;)Xe-=ce,++Ge,ze!=null&&Ge<=Le&&!(Ge%16)&&ze(I,Ge);if(i(it<=Se),Xe&It&&(ur=Jn(St,Xe,Ge)),Et!=null)for(;Ut<it;)gr=L[Ut++],Et.X[(506832829*gr&4294967295)>>>Et.Mb]=gr}else{if(!(gr<vr))break e;for(yr=gr-280,i(Et!=null);Ut<it;)gr=L[Ut++],Et.X[(506832829*gr&4294967295)>>>Et.Mb]=gr;gr=it,i(!(yr>>>($r=Et).Xa)),L[gr]=$r.X[yr],yr=!0}yr||i(tt.h==pe(tt))}if(I.Pb&&tt.h&&it<Se)i(I.m.h),I.a=5,I.m=I.wd,I.$=I.xd,0<I.s.ua&&$t(I.s.vb,I.s.Wa);else{if(tt.h)break e;ze?.(I,Ge>Le?Le:Ge),I.a=0,I.$=it-Y}return 1}return I.a=3,0}function De(I){i(I!=null),I.vc=null,I.yc=null,I.Ya=null;var L=I.Wa;L!=null&&(L.X=null),I.vb=null,i(I!=null)}function Ze(){var I=new uo;return I==null?null:(I.a=0,I.xb=su,Ao("Predictor","VP8LPredictors"),Ao("Predictor","VP8LPredictors_C"),Ao("PredictorAdd","VP8LPredictorsAdd"),Ao("PredictorAdd","VP8LPredictorsAdd_C"),nu=Ji,Ga=xi,Ho=Lr,Il=Ua,kl=Dr,js=Eo,Ou=gi,ge.VP8LMapColor32b=nl,ge.VP8LMapColor8b=wd,I)}function ke(I,L,Y,ce,Se){var Le=1,ze=[I],Ge=[L],Xe=ce.m,tt=ce.s,St=null,it=0;e:for(;;){if(Y)for(;Le&&ht(Xe,1);){var Ut=ze,Rt=Ge,vr=ce,rr=1,Et=vr.m,It=vr.gc[vr.ab],ur=ht(Et,2);if(vr.Oc&1<<ur)Le=0;else{switch(vr.Oc|=1<<ur,It.hc=ur,It.Ea=Ut[0],It.nc=Rt[0],It.K=[null],++vr.ab,i(4>=vr.ab),ur){case 0:case 1:It.b=ht(Et,3)+2,rr=ke(nr(It.Ea,It.b),nr(It.nc,It.b),0,vr,It.K),It.K=It.K[0];break;case 3:var yr,gr=ht(Et,8)+1,$r=16<gr?0:4<gr?1:2<gr?2:3;if(Ut[0]=nr(It.Ea,$r),It.b=$r,yr=rr=ke(gr,1,0,vr,It.K)){var Hr,Ci=gr,Wr=It,Fn=1<<(8>>Wr.b),Nn=r(Fn);if(Nn==null)yr=0;else{var on=Wr.K[0],dn=Wr.w;for(Nn[0]=Wr.K[0][0],Hr=1;Hr<1*Ci;++Hr)Nn[Hr]=br(on[dn+Hr],Nn[Hr-1]);for(;Hr<4*Fn;++Hr)Nn[Hr]=0;Wr.K[0]=null,Wr.K[0]=Nn,yr=1}}rr=yr;break;case 2:break;default:i(0)}Le=rr}}if(ze=ze[0],Ge=Ge[0],Le&&ht(Xe,1)&&!(Le=1<=(it=ht(Xe,4))&&11>=it)){ce.a=3;break e}var ea;if(ea=Le)t:{var qn,Ki,Bn,qo=ce,po=ze,ko=Ge,In=it,Ts=Y,ss=qo.m,eo=qo.s,xo=[null],to=1,Oo=0,Ss=Dp[In];r:for(;;){if(Ts&&ht(ss,1)){var xn=ht(ss,3)+2,$o=nr(po,xn),tc=nr(ko,xn),uu=$o*tc;if(!ke($o,tc,0,qo,xo))break r;for(xo=xo[0],eo.xc=xn,qn=0;qn<uu;++qn){var ll=xo[qn]>>8&65535;xo[qn]=ll,ll>=to&&(to=ll+1)}}if(ss.h)break r;for(Ki=0;5>Ki;++Ki){var ya=as[Ki];!Ki&&0<In&&(ya+=1<<In),Oo<ya&&(Oo=ya)}var Uu=_(to*Ss,ve),Op=to,Oh=_(Op,Ce);if(Oh==null)var Vu=null;else i(65536>=Op),Vu=Oh;var Oc=r(Oo);if(Vu==null||Oc==null||Uu==null){qo.a=1;break r}var Gu=Uu;for(qn=Bn=0;qn<to;++qn){var cl=Vu[qn],hu=cl.G,ul=cl.H,Np=0,Nh=1,Id=0;for(Ki=0;5>Ki;++Ki){ya=as[Ki],hu[Ki]=Gu,ul[Ki]=Bn,!Ki&&0<In&&(ya+=1<<In);n:{var kd,Md=ya,Hu=qo,Wu=Oc,Dd=Gu,Um=Bn,Cf=0,du=Hu.m,Rd=ht(du,1);if(u(Wu,0,0,Md),Rd){var Bh=ht(du,1)+1,Vm=ht(du,1),Es=ht(du,Vm==0?1:8);Wu[Es]=1,Bh==2&&(Wu[Es=ht(du,8)]=1);var zh=1}else{var Fd=r(19),Pd=ht(du,4)+4;if(19<Pd){Hu.a=3;var jh=0;break n}for(kd=0;kd<Pd;++kd)Fd[vg[kd]]=ht(du,3);var Ld=void 0,fu=void 0,qu=Hu,Bp=Fd,$u=Md,Uh=Wu,If=0,As=qu.m,Gm=8,zp=_(128,ve);i:for(;_e(zp,0,7,Bp,19);){if(ht(As,1)){var Hm=2+2*ht(As,3);if((Ld=2+ht(As,Hm))>$u)break i}else Ld=$u;for(fu=0;fu<$u&&Ld--;){Ve(As);var jp=zp[0+(127&xe(As))];Ie(As,As.u+jp.g);var Xu=jp.value;if(16>Xu)Uh[fu++]=Xu,Xu!=0&&(Gm=Xu);else{var Up=Xu==16,Vh=Xu-16,Vp=Jl[Vh],Gp=ht(As,Ph[Vh])+Vp;if(fu+Gp>$u)break i;for(var Zu=Up?Gm:0;0<Gp--;)Uh[fu++]=Zu}}If=1;break i}If||(qu.a=3),zh=If}(zh=zh&&!du.h)&&(Cf=_e(Dd,Um,8,Wu,Md)),zh&&Cf!=0?jh=Cf:(Hu.a=3,jh=0)}if(jh==0)break r;if(Nh&&Da[Ki]==1&&(Nh=Gu[Bn].g==0),Np+=Gu[Bn].g,Bn+=jh,3>=Ki){var Gh,kf=Oc[0];for(Gh=1;Gh<ya;++Gh)Oc[Gh]>kf&&(kf=Oc[Gh]);Id+=kf}}if(cl.nd=Nh,cl.Qb=0,Nh&&(cl.qb=(hu[3][ul[3]+0].value<<24|hu[1][ul[1]+0].value<<16|hu[2][ul[2]+0].value)>>>0,Np==0&&256>hu[0][ul[0]+0].value&&(cl.Qb=1,cl.qb+=hu[0][ul[0]+0].value<<8)),cl.jc=!cl.Qb&&6>Id,cl.jc){var Od,Pl=cl;for(Od=0;Od<rs;++Od){var Cs=Od,Nc=Pl.pd[Cs],rc=Pl.G[0][Pl.H[0]+Cs];256<=rc.value?(Nc.g=rc.g+256,Nc.value=rc.value):(Nc.g=0,Nc.value=0,Cs>>=_a(rc,8,Nc),Cs>>=_a(Pl.G[1][Pl.H[1]+Cs],16,Nc),Cs>>=_a(Pl.G[2][Pl.H[2]+Cs],0,Nc),_a(Pl.G[3][Pl.H[3]+Cs],24,Nc))}}}eo.vc=xo,eo.Wb=to,eo.Ya=Vu,eo.yc=Uu,ea=1;break t}ea=0}if(!(Le=ea)){ce.a=3;break e}if(0<it){if(tt.ua=1<<it,!Fr(tt.Wa,it)){ce.a=1,Le=0;break e}}else tt.ua=0;var Mf=ce,Nd=ze,wg=Ge,m=Mf.s,s=m.xc;if(Mf.c=Nd,Mf.i=wg,m.md=nr(Nd,s),m.wc=s==0?-1:(1<<s)-1,Y){ce.xb=Ed;break e}if((St=r(ze*Ge))==null){ce.a=1,Le=0;break e}Le=(Le=le(ce,St,0,ze,Ge,Ge,null))&&!Xe.h;break e}return Le?(Se!=null?Se[0]=St:(i(St==null),i(Y)),ce.$=0,Y||De(tt)):De(tt),Le}function We(I,L){var Y=I.c*I.i,ce=Y+L+16*L;return i(I.c<=L),I.V=r(ce),I.V==null?(I.Ta=null,I.Ua=0,I.a=1,0):(I.Ta=I.V,I.Ua=I.Ba+Y+L,1)}function nt(I,L){var Y=I.C,ce=L-Y,Se=I.V,Le=I.Ba+I.c*Y;for(i(L<=I.l.o);0<ce;){var ze=16<ce?16:ce,Ge=I.l.ma,Xe=I.l.width,tt=Xe*ze,St=Ge.ca,it=Ge.tb+Xe*Y,Ut=I.Ta,Rt=I.Ua;te(I,ze,Se,Le),kp(Ut,Rt,St,it,tt),Q(Ge,Y,Y+ze,St,it,Xe),ce-=ze,Se+=ze*I.c,Y+=ze}i(Y==L),I.C=I.Ma=L}function dt(){this.ub=this.yd=this.td=this.Rb=0}function Ft(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function tr(){this.Fb=this.Bb=this.Cb=0,this.Zb=r(4),this.Lb=r(4)}function Qt(){this.Yb=function(){var I=[];return function L(Y,ce,Se){for(var Le=Se[ce],ze=0;ze<Le&&(Y.push(Se.length>ce+1?[]:0),!(Se.length<ce+1));ze++)L(Y[ze],ce+1,Se)}(I,0,[3,11]),I}()}function or(){this.jb=r(3),this.Wc=T([4,8],Qt),this.Xc=T([4,17],Qt)}function Ar(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new r(4),this.od=new r(4)}function qr(){this.ld=this.La=this.dd=this.tc=0}function wr(){this.Na=this.la=0}function Ei(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function mi(){this.ad=r(384),this.Za=0,this.Ob=r(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ti(){this.uc=this.M=this.Nb=0,this.wa=Array(new qr),this.Y=0,this.ya=Array(new mi),this.aa=0,this.l=new Rn}function An(){this.y=r(16),this.f=r(8),this.ea=r(8)}function ln(){this.cb=this.a=0,this.sc="",this.m=new Wt,this.Od=new dt,this.Kc=new Ft,this.ed=new Ar,this.Qa=new tr,this.Ic=this.$c=this.Aa=0,this.D=new Ti,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=_(8,Wt),this.ia=0,this.pb=_(4,Ei),this.Pa=new or,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new An),this.Hd=0,this.rb=Array(new wr),this.sb=0,this.wa=Array(new qr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new mi),this.L=this.aa=0,this.gd=T([4,2],qr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Rn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Hn(){var I=new ln;return I!=null&&(I.a=0,I.sc="OK",I.cb=0,I.Xb=0,Ja||(Ja=md)),I}function fn(I,L,Y){return I.a==0&&(I.a=L,I.sc=Y,I.cb=0),0}function Gl(I,L,Y){return 3<=Y&&I[L+0]==157&&I[L+1]==1&&I[L+2]==42}function wh(I,L){if(I==null)return 0;if(I.a=0,I.sc="OK",L==null)return fn(I,2,"null VP8Io passed to VP8GetHeaders()");var Y=L.data,ce=L.w,Se=L.ha;if(4>Se)return fn(I,7,"Truncated header.");var Le=Y[ce+0]|Y[ce+1]<<8|Y[ce+2]<<16,ze=I.Od;if(ze.Rb=!(1&Le),ze.td=Le>>1&7,ze.yd=Le>>4&1,ze.ub=Le>>5,3<ze.td)return fn(I,3,"Incorrect keyframe parameters.");if(!ze.yd)return fn(I,4,"Frame not displayable.");ce+=3,Se-=3;var Ge=I.Kc;if(ze.Rb){if(7>Se)return fn(I,7,"cannot parse picture header");if(!Gl(Y,ce,Se))return fn(I,3,"Bad code word");Ge.c=16383&(Y[ce+4]<<8|Y[ce+3]),Ge.Td=Y[ce+4]>>6,Ge.i=16383&(Y[ce+6]<<8|Y[ce+5]),Ge.Ud=Y[ce+6]>>6,ce+=7,Se-=7,I.za=Ge.c+15>>4,I.Ub=Ge.i+15>>4,L.width=Ge.c,L.height=Ge.i,L.Da=0,L.j=0,L.v=0,L.va=L.width,L.o=L.height,L.da=0,L.ib=L.width,L.hb=L.height,L.U=L.width,L.T=L.height,u((Le=I.Pa).jb,0,255,Le.jb.length),i((Le=I.Qa)!=null),Le.Cb=0,Le.Bb=0,Le.Fb=1,u(Le.Zb,0,0,Le.Zb.length),u(Le.Lb,0,0,Le.Lb)}if(ze.ub>Se)return fn(I,7,"bad partition length");Ye(Le=I.m,Y,ce,ze.ub),ce+=ze.ub,Se-=ze.ub,ze.Rb&&(Ge.Ld=mt(Le),Ge.Kd=mt(Le)),Ge=I.Qa;var Xe,tt=I.Pa;if(i(Le!=null),i(Ge!=null),Ge.Cb=mt(Le),Ge.Cb){if(Ge.Bb=mt(Le),mt(Le)){for(Ge.Fb=mt(Le),Xe=0;4>Xe;++Xe)Ge.Zb[Xe]=mt(Le)?st(Le,7):0;for(Xe=0;4>Xe;++Xe)Ge.Lb[Xe]=mt(Le)?st(Le,6):0}if(Ge.Bb)for(Xe=0;3>Xe;++Xe)tt.jb[Xe]=mt(Le)?ut(Le,8):255}else Ge.Bb=0;if(Le.Ka)return fn(I,3,"cannot parse segment header");if((Ge=I.ed).zd=mt(Le),Ge.Tb=ut(Le,6),Ge.wb=ut(Le,3),Ge.Pc=mt(Le),Ge.Pc&&mt(Le)){for(tt=0;4>tt;++tt)mt(Le)&&(Ge.vd[tt]=st(Le,6));for(tt=0;4>tt;++tt)mt(Le)&&(Ge.od[tt]=st(Le,6))}if(I.L=Ge.Tb==0?0:Ge.zd?1:2,Le.Ka)return fn(I,3,"cannot parse filter header");var St=Se;if(Se=Xe=ce,ce=Xe+St,Ge=St,I.Xb=(1<<ut(I.m,2))-1,St<3*(tt=I.Xb))Y=7;else{for(Xe+=3*tt,Ge-=3*tt,St=0;St<tt;++St){var it=Y[Se+0]|Y[Se+1]<<8|Y[Se+2]<<16;it>Ge&&(it=Ge),Ye(I.Jc[+St],Y,Xe,it),Xe+=it,Ge-=it,Se+=3}Ye(I.Jc[+tt],Y,Xe,Ge),Y=Xe<ce?0:5}if(Y!=0)return fn(I,Y,"cannot parse partitions");for(Y=ut(Xe=I.m,7),Se=mt(Xe)?st(Xe,4):0,ce=mt(Xe)?st(Xe,4):0,Ge=mt(Xe)?st(Xe,4):0,tt=mt(Xe)?st(Xe,4):0,Xe=mt(Xe)?st(Xe,4):0,St=I.Qa,it=0;4>it;++it){if(St.Cb){var Ut=St.Zb[it];St.Fb||(Ut+=Y)}else{if(0<it){I.pb[it]=I.pb[0];continue}Ut=Y}var Rt=I.pb[it];Rt.Sc[0]=Bu[xs(Ut+Se,127)],Rt.Sc[1]=Rc[xs(Ut+0,127)],Rt.Eb[0]=2*Bu[xs(Ut+ce,127)],Rt.Eb[1]=101581*Rc[xs(Ut+Ge,127)]>>16,8>Rt.Eb[1]&&(Rt.Eb[1]=8),Rt.Qc[0]=Bu[xs(Ut+tt,117)],Rt.Qc[1]=Rc[xs(Ut+Xe,127)],Rt.lc=Ut+Xe}if(!ze.Rb)return fn(I,4,"Not a key frame.");for(mt(Le),ze=I.Pa,Y=0;4>Y;++Y){for(Se=0;8>Se;++Se)for(ce=0;3>ce;++ce)for(Ge=0;11>Ge;++Ge)tt=wt(Le,Fc[Y][Se][ce][Ge])?ut(Le,8):Wa[Y][Se][ce][Ge],ze.Wc[Y][Se].Yb[ce][Ge]=tt;for(Se=0;17>Se;++Se)ze.Xc[Y][Se]=ze.Wc[Y][fo[Se]]}return I.kc=mt(Le),I.kc&&(I.Bd=ut(Le,8)),I.cb=1}function md(I,L,Y,ce,Se,Le,ze){var Ge=L[Se].Yb[Y];for(Y=0;16>Se;++Se){if(!wt(I,Ge[Y+0]))return Se;for(;!wt(I,Ge[Y+1]);)if(Ge=L[++Se].Yb[0],Y=0,Se==16)return 16;var Xe=L[Se+1].Yb;if(wt(I,Ge[Y+2])){var tt=I,St=0;if(wt(tt,(Ut=Ge)[(it=Y)+3]))if(wt(tt,Ut[it+6])){for(Ge=0,it=2*(St=wt(tt,Ut[it+8]))+(Ut=wt(tt,Ut[it+9+St])),St=0,Ut=os[it];Ut[Ge];++Ge)St+=St+wt(tt,Ut[Ge]);St+=3+(8<<it)}else wt(tt,Ut[it+7])?(St=7+2*wt(tt,165),St+=wt(tt,145)):St=5+wt(tt,159);else St=wt(tt,Ut[it+4])?3+wt(tt,Ut[it+5]):2;Ge=Xe[2]}else St=1,Ge=Xe[1];Xe=ze+Nm[Se],0>(tt=I).b&&gt(tt);var it,Ut=tt.b,Rt=(it=tt.Ca>>1)-(tt.I>>Ut)>>31;--tt.b,tt.Ca+=Rt,tt.Ca|=1,tt.I-=(it+1&Rt)<<Ut,Le[Xe]=((St^Rt)-Rt)*ce[(0<Se)+0]}return 16}function gc(I){var L=I.rb[I.sb-1];L.la=0,L.Na=0,u(I.zc,0,0,I.zc.length),I.ja=0}function ci(I,L){if(I==null)return 0;if(L==null)return fn(I,2,"NULL VP8Io parameter in VP8Decode().");if(!I.cb&&!wh(I,L))return 0;if(i(I.cb),L.ac==null||L.ac(L)){L.ob&&(I.L=0);var Y=Cd[I.L];if(I.L==2?(I.yb=0,I.zb=0):(I.yb=L.v-Y>>4,I.zb=L.j-Y>>4,0>I.yb&&(I.yb=0),0>I.zb&&(I.zb=0)),I.Va=L.o+15+Y>>4,I.Hb=L.va+15+Y>>4,I.Hb>I.za&&(I.Hb=I.za),I.Va>I.Ub&&(I.Va=I.Ub),0<I.L){var ce=I.ed;for(Y=0;4>Y;++Y){var Se;if(I.Qa.Cb){var Le=I.Qa.Lb[Y];I.Qa.Fb||(Le+=ce.Tb)}else Le=ce.Tb;for(Se=0;1>=Se;++Se){var ze=I.gd[Y][Se],Ge=Le;if(ce.Pc&&(Ge+=ce.vd[0],Se&&(Ge+=ce.od[0])),0<(Ge=0>Ge?0:63<Ge?63:Ge)){var Xe=Ge;0<ce.wb&&(Xe=4<ce.wb?Xe>>2:Xe>>1)>9-ce.wb&&(Xe=9-ce.wb),1>Xe&&(Xe=1),ze.dd=Xe,ze.tc=2*Ge+Xe,ze.ld=40<=Ge?2:15<=Ge?1:0}else ze.tc=0;ze.La=Se}}}Y=0}else fn(I,6,"Frame setup failed"),Y=I.a;if(Y=Y==0){if(Y){I.$c=0,0<I.Aa||(I.Ic=Fl);e:{Y=I.Ic,ce=4*(Xe=I.za);var tt=32*Xe,St=Xe+1,it=0<I.L?Xe*(0<I.Aa?2:1):0,Ut=(I.Aa==2?2:1)*Xe;if((ze=ce+832+(Se=3*(16*Y+Cd[I.L])/2*tt)+(Le=I.Fa!=null&&0<I.Fa.length?I.Kc.c*I.Kc.i:0))!=ze)Y=0;else{if(ze>I.Vb){if(I.Vb=0,I.Ec=r(ze),I.Fc=0,I.Ec==null){Y=fn(I,1,"no memory during frame initialization.");break e}I.Vb=ze}ze=I.Ec,Ge=I.Fc,I.Ac=ze,I.Bc=Ge,Ge+=ce,I.Gd=_(tt,An),I.Hd=0,I.rb=_(St+1,wr),I.sb=1,I.wa=it?_(it,qr):null,I.Y=0,I.D.Nb=0,I.D.wa=I.wa,I.D.Y=I.Y,0<I.Aa&&(I.D.Y+=Xe),i(!0),I.oc=ze,I.pc=Ge,Ge+=832,I.ya=_(Ut,mi),I.aa=0,I.D.ya=I.ya,I.D.aa=I.aa,I.Aa==2&&(I.D.aa+=Xe),I.R=16*Xe,I.B=8*Xe,Xe=(tt=Cd[I.L])*I.R,tt=tt/2*I.B,I.sa=ze,I.ta=Ge+Xe,I.qa=I.sa,I.ra=I.ta+16*Y*I.R+tt,I.Ha=I.qa,I.Ia=I.ra+8*Y*I.B+tt,I.$c=0,Ge+=Se,I.mb=Le?ze:null,I.nb=Le?Ge:null,i(Ge+Le<=I.Fc+I.Vb),gc(I),u(I.Ac,I.Bc,0,ce),Y=1}}if(Y){if(L.ka=0,L.y=I.sa,L.O=I.ta,L.f=I.qa,L.N=I.ra,L.ea=I.Ha,L.Vd=I.Ia,L.fa=I.R,L.Rc=I.B,L.F=null,L.J=0,!qi){for(Y=-255;255>=Y;++Y)Td[255+Y]=0>Y?-Y:Y;for(Y=-1020;1020>=Y;++Y)bf[1020+Y]=-128>Y?-128:127<Y?127:Y;for(Y=-112;112>=Y;++Y)Dh[112+Y]=-16>Y?-16:15<Y?15:Y;for(Y=-255;510>=Y;++Y)Rh[255+Y]=0>Y?0:255<Y?255:Y;qi=1}Us=vd,Zl=gd,Ic=Sh,Ml=_d,al=Eh,Mh=Th,Nu=Du,Dl=wc,Yl=Jc,ol=Al,Rl=Ih,Vs=$l,kc=_s,Qn=kh,Yn=bc,ca=lo,Ka=Ma,bs=Ip,Qa[0]=yo,Qa[1]=gf,Qa[2]=Cp,Qa[3]=xd,Qa[4]=Ch,Qa[5]=Hl,Qa[6]=Yc,Qa[7]=Kc,Qa[8]=hr,Qa[9]=_c,Ql[0]=yd,Ql[1]=Ah,Ql[2]=rl,Ql[3]=ku,Ql[4]=Ya,Ql[5]=Mi,Ql[6]=_f,Ws[0]=ka,Ws[1]=Zc,Ws[2]=vf,Ws[3]=vc,Ws[4]=yc,Ws[5]=yf,Ws[6]=xc,Y=1}else Y=0}Y&&(Y=function(Rt,vr){for(Rt.M=0;Rt.M<Rt.Va;++Rt.M){var rr,Et=Rt.Jc[Rt.M&Rt.Xb],It=Rt.m,ur=Rt;for(rr=0;rr<ur.za;++rr){var yr=It,gr=ur,$r=gr.Ac,Hr=gr.Bc+4*rr,Ci=gr.zc,Wr=gr.ya[gr.aa+rr];if(gr.Qa.Bb?Wr.$b=wt(yr,gr.Pa.jb[0])?2+wt(yr,gr.Pa.jb[2]):wt(yr,gr.Pa.jb[1]):Wr.$b=0,gr.kc&&(Wr.Ad=wt(yr,gr.Bd)),Wr.Za=!wt(yr,145)+0,Wr.Za){var Fn=Wr.Ob,Nn=0;for(gr=0;4>gr;++gr){var on,dn=Ci[0+gr];for(on=0;4>on;++on){dn=sl[$r[Hr+on]][dn];for(var ea=Wo[wt(yr,dn[0])];0<ea;)ea=Wo[2*ea+wt(yr,dn[ea])];dn=-ea,$r[Hr+on]=dn}c(Fn,Nn,$r,Hr,4),Nn+=4,Ci[0+gr]=dn}}else dn=wt(yr,156)?wt(yr,128)?1:3:wt(yr,163)?2:0,Wr.Ob[0]=dn,u($r,Hr,dn,4),u(Ci,0,dn,4);Wr.Dd=wt(yr,142)?wt(yr,114)?wt(yr,183)?1:3:2:0}if(ur.m.Ka)return fn(Rt,7,"Premature end-of-partition0 encountered.");for(;Rt.ja<Rt.za;++Rt.ja){if(ur=Et,yr=(It=Rt).rb[It.sb-1],$r=It.rb[It.sb+It.ja],rr=It.ya[It.aa+It.ja],Hr=It.kc?rr.Ad:0)yr.la=$r.la=0,rr.Za||(yr.Na=$r.Na=0),rr.Hc=0,rr.Gc=0,rr.ia=0;else{var qn,Ki;if(yr=$r,$r=ur,Hr=It.Pa.Xc,Ci=It.ya[It.aa+It.ja],Wr=It.pb[Ci.$b],gr=Ci.ad,Fn=0,Nn=It.rb[It.sb-1],dn=on=0,u(gr,Fn,0,384),Ci.Za)var Bn=0,qo=Hr[3];else{ea=r(16);var po=yr.Na+Nn.Na;if(po=Ja($r,Hr[1],po,Wr.Eb,0,ea,0),yr.Na=Nn.Na=(0<po)+0,1<po)Us(ea,0,gr,Fn);else{var ko=ea[0]+3>>3;for(ea=0;256>ea;ea+=16)gr[Fn+ea]=ko}Bn=1,qo=Hr[0]}var In=15&yr.la,Ts=15&Nn.la;for(ea=0;4>ea;++ea){var ss=1&Ts;for(ko=Ki=0;4>ko;++ko)In=In>>1|(ss=(po=Ja($r,qo,po=ss+(1&In),Wr.Sc,Bn,gr,Fn))>Bn)<<7,Ki=Ki<<2|(3<po?3:1<po?2:gr[Fn+0]!=0),Fn+=16;In>>=4,Ts=Ts>>1|ss<<7,on=(on<<8|Ki)>>>0}for(qo=In,Bn=Ts>>4,qn=0;4>qn;qn+=2){for(Ki=0,In=yr.la>>4+qn,Ts=Nn.la>>4+qn,ea=0;2>ea;++ea){for(ss=1&Ts,ko=0;2>ko;++ko)po=ss+(1&In),In=In>>1|(ss=0<(po=Ja($r,Hr[2],po,Wr.Qc,0,gr,Fn)))<<3,Ki=Ki<<2|(3<po?3:1<po?2:gr[Fn+0]!=0),Fn+=16;In>>=2,Ts=Ts>>1|ss<<5}dn|=Ki<<4*qn,qo|=In<<4<<qn,Bn|=(240&Ts)<<qn}yr.la=qo,Nn.la=Bn,Ci.Hc=on,Ci.Gc=dn,Ci.ia=43690&dn?0:Wr.ia,Hr=!(on|dn)}if(0<It.L&&(It.wa[It.Y+It.ja]=It.gd[rr.$b][rr.Za],It.wa[It.Y+It.ja].La|=!Hr),ur.Ka)return fn(Rt,7,"Premature end-of-file encountered.")}if(gc(Rt),It=vr,ur=1,rr=(Et=Rt).D,yr=0<Et.L&&Et.M>=Et.zb&&Et.M<=Et.Va,Et.Aa==0)e:{if(rr.M=Et.M,rr.uc=yr,Xl(Et,rr),ur=1,rr=(Ki=Et.D).Nb,yr=(dn=Cd[Et.L])*Et.R,$r=dn/2*Et.B,ea=16*rr*Et.R,ko=8*rr*Et.B,Hr=Et.sa,Ci=Et.ta-yr+ea,Wr=Et.qa,gr=Et.ra-$r+ko,Fn=Et.Ha,Nn=Et.Ia-$r+ko,Ts=(In=Ki.M)==0,on=In>=Et.Va-1,Et.Aa==2&&Xl(Et,Ki),Ki.uc)for(ss=(po=Et).D.M,i(po.D.uc),Ki=po.yb;Ki<po.Hb;++Ki){Bn=Ki,qo=ss;var eo=(xo=(ya=po).D).Nb;qn=ya.R;var xo=xo.wa[xo.Y+Bn],to=ya.sa,Oo=ya.ta+16*eo*qn+16*Bn,Ss=xo.dd,xn=xo.tc;if(xn!=0)if(i(3<=xn),ya.L==1)0<Bn&&ca(to,Oo,qn,xn+4),xo.La&&bs(to,Oo,qn,xn),0<qo&&Yn(to,Oo,qn,xn+4),xo.La&&Ka(to,Oo,qn,xn);else{var $o=ya.B,tc=ya.qa,uu=ya.ra+8*eo*$o+8*Bn,ll=ya.Ha,ya=ya.Ia+8*eo*$o+8*Bn;eo=xo.ld,0<Bn&&(Dl(to,Oo,qn,xn+4,Ss,eo),ol(tc,uu,ll,ya,$o,xn+4,Ss,eo)),xo.La&&(Vs(to,Oo,qn,xn,Ss,eo),Qn(tc,uu,ll,ya,$o,xn,Ss,eo)),0<qo&&(Nu(to,Oo,qn,xn+4,Ss,eo),Yl(tc,uu,ll,ya,$o,xn+4,Ss,eo)),xo.La&&(Rl(to,Oo,qn,xn,Ss,eo),kc(tc,uu,ll,ya,$o,xn,Ss,eo))}}if(Et.ia&&alert("todo:DitherRow"),It.put!=null){if(Ki=16*In,In=16*(In+1),Ts?(It.y=Et.sa,It.O=Et.ta+ea,It.f=Et.qa,It.N=Et.ra+ko,It.ea=Et.Ha,It.W=Et.Ia+ko):(Ki-=dn,It.y=Hr,It.O=Ci,It.f=Wr,It.N=gr,It.ea=Fn,It.W=Nn),on||(In-=dn),In>It.o&&(In=It.o),It.F=null,It.J=null,Et.Fa!=null&&0<Et.Fa.length&&Ki<In&&(It.J=Sc(Et,It,Ki,In-Ki),It.F=Et.mb,It.F==null&&It.F.length==0)){ur=fn(Et,3,"Could not decode alpha data.");break e}Ki<It.j&&(dn=It.j-Ki,Ki=It.j,i(!(1&dn)),It.O+=Et.R*dn,It.N+=Et.B*(dn>>1),It.W+=Et.B*(dn>>1),It.F!=null&&(It.J+=It.width*dn)),Ki<In&&(It.O+=It.v,It.N+=It.v>>1,It.W+=It.v>>1,It.F!=null&&(It.J+=It.v),It.ka=Ki-It.j,It.U=It.va-It.v,It.T=In-Ki,ur=It.put(It))}rr+1!=Et.Ic||on||(c(Et.sa,Et.ta-yr,Hr,Ci+16*Et.R,yr),c(Et.qa,Et.ra-$r,Wr,gr+8*Et.B,$r),c(Et.Ha,Et.Ia-$r,Fn,Nn+8*Et.B,$r))}if(!ur)return fn(Rt,6,"Output aborted.")}return 1}(I,L)),L.bc!=null&&L.bc(L),Y&=1}return Y?(I.cb=0,Y):0}function Os(I,L,Y,ce,Se){Se=I[L+Y+32*ce]+(Se>>3),I[L+Y+32*ce]=-256&Se?0>Se?0:255:Se}function Ns(I,L,Y,ce,Se,Le){Os(I,L,0,Y,ce+Se),Os(I,L,1,Y,ce+Le),Os(I,L,2,Y,ce-Le),Os(I,L,3,Y,ce-Se)}function Go(I){return(20091*I>>16)+I}function Cu(I,L,Y,ce){var Se,Le=0,ze=r(16);for(Se=0;4>Se;++Se){var Ge=I[L+0]+I[L+8],Xe=I[L+0]-I[L+8],tt=(35468*I[L+4]>>16)-Go(I[L+12]),St=Go(I[L+4])+(35468*I[L+12]>>16);ze[Le+0]=Ge+St,ze[Le+1]=Xe+tt,ze[Le+2]=Xe-tt,ze[Le+3]=Ge-St,Le+=4,L++}for(Se=Le=0;4>Se;++Se)Ge=(I=ze[Le+0]+4)+ze[Le+8],Xe=I-ze[Le+8],tt=(35468*ze[Le+4]>>16)-Go(ze[Le+12]),Os(Y,ce,0,0,Ge+(St=Go(ze[Le+4])+(35468*ze[Le+12]>>16))),Os(Y,ce,1,0,Xe+tt),Os(Y,ce,2,0,Xe-tt),Os(Y,ce,3,0,Ge-St),Le++,ce+=32}function Th(I,L,Y,ce){var Se=I[L+0]+4,Le=35468*I[L+4]>>16,ze=Go(I[L+4]),Ge=35468*I[L+1]>>16;Ns(Y,ce,0,Se+ze,I=Go(I[L+1]),Ge),Ns(Y,ce,1,Se+Le,I,Ge),Ns(Y,ce,2,Se-Le,I,Ge),Ns(Y,ce,3,Se-ze,I,Ge)}function gd(I,L,Y,ce,Se){Cu(I,L,Y,ce),Se&&Cu(I,L+16,Y,ce+4)}function Sh(I,L,Y,ce){Zl(I,L+0,Y,ce,1),Zl(I,L+32,Y,ce+128,1)}function _d(I,L,Y,ce){var Se;for(I=I[L+0]+4,Se=0;4>Se;++Se)for(L=0;4>L;++L)Os(Y,ce,L,Se,I)}function Eh(I,L,Y,ce){I[L+0]&&Ml(I,L+0,Y,ce),I[L+16]&&Ml(I,L+16,Y,ce+4),I[L+32]&&Ml(I,L+32,Y,ce+128),I[L+48]&&Ml(I,L+48,Y,ce+128+4)}function vd(I,L,Y,ce){var Se,Le=r(16);for(Se=0;4>Se;++Se){var ze=I[L+0+Se]+I[L+12+Se],Ge=I[L+4+Se]+I[L+8+Se],Xe=I[L+4+Se]-I[L+8+Se],tt=I[L+0+Se]-I[L+12+Se];Le[0+Se]=ze+Ge,Le[8+Se]=ze-Ge,Le[4+Se]=tt+Xe,Le[12+Se]=tt-Xe}for(Se=0;4>Se;++Se)ze=(I=Le[0+4*Se]+3)+Le[3+4*Se],Ge=Le[1+4*Se]+Le[2+4*Se],Xe=Le[1+4*Se]-Le[2+4*Se],tt=I-Le[3+4*Se],Y[ce+0]=ze+Ge>>3,Y[ce+16]=tt+Xe>>3,Y[ce+32]=ze-Ge>>3,Y[ce+48]=tt-Xe>>3,ce+=64}function Iu(I,L,Y){var ce,Se=L-32,Le=ws,ze=255-I[Se-1];for(ce=0;ce<Y;++ce){var Ge,Xe=Le,tt=ze+I[L-1];for(Ge=0;Ge<Y;++Ge)I[L+Ge]=Xe[tt+I[Se+Ge]];L+=32}}function gf(I,L){Iu(I,L,4)}function Zc(I,L){Iu(I,L,8)}function Ah(I,L){Iu(I,L,16)}function rl(I,L){var Y;for(Y=0;16>Y;++Y)c(I,L+32*Y,I,L-32,16)}function ku(I,L){var Y;for(Y=16;0<Y;--Y)u(I,L,I[L-1],16),L+=32}function Mu(I,L,Y){var ce;for(ce=0;16>ce;++ce)u(L,Y+32*ce,I,16)}function yd(I,L){var Y,ce=16;for(Y=0;16>Y;++Y)ce+=I[L-1+32*Y]+I[L+Y-32];Mu(ce>>5,I,L)}function Ya(I,L){var Y,ce=8;for(Y=0;16>Y;++Y)ce+=I[L-1+32*Y];Mu(ce>>4,I,L)}function Mi(I,L){var Y,ce=8;for(Y=0;16>Y;++Y)ce+=I[L+Y-32];Mu(ce>>4,I,L)}function _f(I,L){Mu(128,I,L)}function Vi(I,L,Y){return I+2*L+Y+2>>2}function Cp(I,L){var Y,ce=L-32;for(ce=new Uint8Array([Vi(I[ce-1],I[ce+0],I[ce+1]),Vi(I[ce+0],I[ce+1],I[ce+2]),Vi(I[ce+1],I[ce+2],I[ce+3]),Vi(I[ce+2],I[ce+3],I[ce+4])]),Y=0;4>Y;++Y)c(I,L+32*Y,ce,0,ce.length)}function xd(I,L){var Y=I[L-1],ce=I[L-1+32],Se=I[L-1+64],Le=I[L-1+96];Pt(I,L+0,16843009*Vi(I[L-1-32],Y,ce)),Pt(I,L+32,16843009*Vi(Y,ce,Se)),Pt(I,L+64,16843009*Vi(ce,Se,Le)),Pt(I,L+96,16843009*Vi(Se,Le,Le))}function yo(I,L){var Y,ce=4;for(Y=0;4>Y;++Y)ce+=I[L+Y-32]+I[L-1+32*Y];for(ce>>=3,Y=0;4>Y;++Y)u(I,L+32*Y,ce,4)}function Ch(I,L){var Y=I[L-1+0],ce=I[L-1+32],Se=I[L-1+64],Le=I[L-1-32],ze=I[L+0-32],Ge=I[L+1-32],Xe=I[L+2-32],tt=I[L+3-32];I[L+0+96]=Vi(ce,Se,I[L-1+96]),I[L+1+96]=I[L+0+64]=Vi(Y,ce,Se),I[L+2+96]=I[L+1+64]=I[L+0+32]=Vi(Le,Y,ce),I[L+3+96]=I[L+2+64]=I[L+1+32]=I[L+0+0]=Vi(ze,Le,Y),I[L+3+64]=I[L+2+32]=I[L+1+0]=Vi(Ge,ze,Le),I[L+3+32]=I[L+2+0]=Vi(Xe,Ge,ze),I[L+3+0]=Vi(tt,Xe,Ge)}function Yc(I,L){var Y=I[L+1-32],ce=I[L+2-32],Se=I[L+3-32],Le=I[L+4-32],ze=I[L+5-32],Ge=I[L+6-32],Xe=I[L+7-32];I[L+0+0]=Vi(I[L+0-32],Y,ce),I[L+1+0]=I[L+0+32]=Vi(Y,ce,Se),I[L+2+0]=I[L+1+32]=I[L+0+64]=Vi(ce,Se,Le),I[L+3+0]=I[L+2+32]=I[L+1+64]=I[L+0+96]=Vi(Se,Le,ze),I[L+3+32]=I[L+2+64]=I[L+1+96]=Vi(Le,ze,Ge),I[L+3+64]=I[L+2+96]=Vi(ze,Ge,Xe),I[L+3+96]=Vi(Ge,Xe,Xe)}function Hl(I,L){var Y=I[L-1+0],ce=I[L-1+32],Se=I[L-1+64],Le=I[L-1-32],ze=I[L+0-32],Ge=I[L+1-32],Xe=I[L+2-32],tt=I[L+3-32];I[L+0+0]=I[L+1+64]=Le+ze+1>>1,I[L+1+0]=I[L+2+64]=ze+Ge+1>>1,I[L+2+0]=I[L+3+64]=Ge+Xe+1>>1,I[L+3+0]=Xe+tt+1>>1,I[L+0+96]=Vi(Se,ce,Y),I[L+0+64]=Vi(ce,Y,Le),I[L+0+32]=I[L+1+96]=Vi(Y,Le,ze),I[L+1+32]=I[L+2+96]=Vi(Le,ze,Ge),I[L+2+32]=I[L+3+96]=Vi(ze,Ge,Xe),I[L+3+32]=Vi(Ge,Xe,tt)}function Kc(I,L){var Y=I[L+0-32],ce=I[L+1-32],Se=I[L+2-32],Le=I[L+3-32],ze=I[L+4-32],Ge=I[L+5-32],Xe=I[L+6-32],tt=I[L+7-32];I[L+0+0]=Y+ce+1>>1,I[L+1+0]=I[L+0+64]=ce+Se+1>>1,I[L+2+0]=I[L+1+64]=Se+Le+1>>1,I[L+3+0]=I[L+2+64]=Le+ze+1>>1,I[L+0+32]=Vi(Y,ce,Se),I[L+1+32]=I[L+0+96]=Vi(ce,Se,Le),I[L+2+32]=I[L+1+96]=Vi(Se,Le,ze),I[L+3+32]=I[L+2+96]=Vi(Le,ze,Ge),I[L+3+64]=Vi(ze,Ge,Xe),I[L+3+96]=Vi(Ge,Xe,tt)}function _c(I,L){var Y=I[L-1+0],ce=I[L-1+32],Se=I[L-1+64],Le=I[L-1+96];I[L+0+0]=Y+ce+1>>1,I[L+2+0]=I[L+0+32]=ce+Se+1>>1,I[L+2+32]=I[L+0+64]=Se+Le+1>>1,I[L+1+0]=Vi(Y,ce,Se),I[L+3+0]=I[L+1+32]=Vi(ce,Se,Le),I[L+3+32]=I[L+1+64]=Vi(Se,Le,Le),I[L+3+64]=I[L+2+64]=I[L+0+96]=I[L+1+96]=I[L+2+96]=I[L+3+96]=Le}function hr(I,L){var Y=I[L-1+0],ce=I[L-1+32],Se=I[L-1+64],Le=I[L-1+96],ze=I[L-1-32],Ge=I[L+0-32],Xe=I[L+1-32],tt=I[L+2-32];I[L+0+0]=I[L+2+32]=Y+ze+1>>1,I[L+0+32]=I[L+2+64]=ce+Y+1>>1,I[L+0+64]=I[L+2+96]=Se+ce+1>>1,I[L+0+96]=Le+Se+1>>1,I[L+3+0]=Vi(Ge,Xe,tt),I[L+2+0]=Vi(ze,Ge,Xe),I[L+1+0]=I[L+3+32]=Vi(Y,ze,Ge),I[L+1+32]=I[L+3+64]=Vi(ce,Y,ze),I[L+1+64]=I[L+3+96]=Vi(Se,ce,Y),I[L+1+96]=Vi(Le,Se,ce)}function vf(I,L){var Y;for(Y=0;8>Y;++Y)c(I,L+32*Y,I,L-32,8)}function vc(I,L){var Y;for(Y=0;8>Y;++Y)u(I,L,I[L-1],8),L+=32}function Ai(I,L,Y){var ce;for(ce=0;8>ce;++ce)u(L,Y+32*ce,I,8)}function ka(I,L){var Y,ce=8;for(Y=0;8>Y;++Y)ce+=I[L+Y-32]+I[L-1+32*Y];Ai(ce>>4,I,L)}function yf(I,L){var Y,ce=4;for(Y=0;8>Y;++Y)ce+=I[L+Y-32];Ai(ce>>3,I,L)}function yc(I,L){var Y,ce=4;for(Y=0;8>Y;++Y)ce+=I[L-1+32*Y];Ai(ce>>3,I,L)}function xc(I,L){Ai(128,I,L)}function Sl(I,L,Y){var ce=I[L-Y],Se=I[L+0],Le=3*(Se-ce)+Mp[1020+I[L-2*Y]-I[L+Y]],ze=Xr[112+(Le+4>>3)];I[L-Y]=ws[255+ce+Xr[112+(Le+3>>3)]],I[L+0]=ws[255+Se-ze]}function ui(I,L,Y,ce){var Se=I[L+0],Le=I[L+Y];return ns[255+I[L-2*Y]-I[L-Y]]>ce||ns[255+Le-Se]>ce}function Wl(I,L,Y,ce){return 4*ns[255+I[L-Y]-I[L+0]]+ns[255+I[L-2*Y]-I[L+Y]]<=ce}function ql(I,L,Y,ce,Se){var Le=I[L-3*Y],ze=I[L-2*Y],Ge=I[L-Y],Xe=I[L+0],tt=I[L+Y],St=I[L+2*Y],it=I[L+3*Y];return 4*ns[255+Ge-Xe]+ns[255+ze-tt]>ce?0:ns[255+I[L-4*Y]-Le]<=Se&&ns[255+Le-ze]<=Se&&ns[255+ze-Ge]<=Se&&ns[255+it-St]<=Se&&ns[255+St-tt]<=Se&&ns[255+tt-Xe]<=Se}function bc(I,L,Y,ce){var Se=2*ce+1;for(ce=0;16>ce;++ce)Wl(I,L+ce,Y,Se)&&Sl(I,L+ce,Y)}function lo(I,L,Y,ce){var Se=2*ce+1;for(ce=0;16>ce;++ce)Wl(I,L+ce*Y,1,Se)&&Sl(I,L+ce*Y,1)}function Ma(I,L,Y,ce){var Se;for(Se=3;0<Se;--Se)bc(I,L+=4*Y,Y,ce)}function Ip(I,L,Y,ce){var Se;for(Se=3;0<Se;--Se)lo(I,L+=4,Y,ce)}function El(I,L,Y,ce,Se,Le,ze,Ge){for(Le=2*Le+1;0<Se--;){if(ql(I,L,Y,Le,ze))if(ui(I,L,Y,Ge))Sl(I,L,Y);else{var Xe=I,tt=L,St=Y,it=Xe[tt-2*St],Ut=Xe[tt-St],Rt=Xe[tt+0],vr=Xe[tt+St],rr=Xe[tt+2*St],Et=27*(ur=Mp[1020+3*(Rt-Ut)+Mp[1020+it-vr]])+63>>7,It=18*ur+63>>7,ur=9*ur+63>>7;Xe[tt-3*St]=ws[255+Xe[tt-3*St]+ur],Xe[tt-2*St]=ws[255+it+It],Xe[tt-St]=ws[255+Ut+Et],Xe[tt+0]=ws[255+Rt-Et],Xe[tt+St]=ws[255+vr-It],Xe[tt+2*St]=ws[255+rr-ur]}L+=ce}}function gs(I,L,Y,ce,Se,Le,ze,Ge){for(Le=2*Le+1;0<Se--;){if(ql(I,L,Y,Le,ze))if(ui(I,L,Y,Ge))Sl(I,L,Y);else{var Xe=I,tt=L,St=Y,it=Xe[tt-St],Ut=Xe[tt+0],Rt=Xe[tt+St],vr=Xr[112+((rr=3*(Ut-it))+4>>3)],rr=Xr[112+(rr+3>>3)],Et=vr+1>>1;Xe[tt-2*St]=ws[255+Xe[tt-2*St]+Et],Xe[tt-St]=ws[255+it+rr],Xe[tt+0]=ws[255+Ut-vr],Xe[tt+St]=ws[255+Rt-Et]}L+=ce}}function Du(I,L,Y,ce,Se,Le){El(I,L,Y,1,16,ce,Se,Le)}function wc(I,L,Y,ce,Se,Le){El(I,L,1,Y,16,ce,Se,Le)}function Ih(I,L,Y,ce,Se,Le){var ze;for(ze=3;0<ze;--ze)gs(I,L+=4*Y,Y,1,16,ce,Se,Le)}function $l(I,L,Y,ce,Se,Le){var ze;for(ze=3;0<ze;--ze)gs(I,L+=4,1,Y,16,ce,Se,Le)}function Jc(I,L,Y,ce,Se,Le,ze,Ge){El(I,L,Se,1,8,Le,ze,Ge),El(Y,ce,Se,1,8,Le,ze,Ge)}function Al(I,L,Y,ce,Se,Le,ze,Ge){El(I,L,1,Se,8,Le,ze,Ge),El(Y,ce,1,Se,8,Le,ze,Ge)}function _s(I,L,Y,ce,Se,Le,ze,Ge){gs(I,L+4*Se,Se,1,8,Le,ze,Ge),gs(Y,ce+4*Se,Se,1,8,Le,ze,Ge)}function kh(I,L,Y,ce,Se,Le,ze,Ge){gs(I,L+4,1,Se,8,Le,ze,Ge),gs(Y,ce+4,1,Se,8,Le,ze,Ge)}function Wn(){this.ba=new oo,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Cn,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function vs(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function co(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function il(){this.ua=0,this.Wa=new lt,this.vb=new lt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new Ce,this.yc=new ve}function uo(){this.xb=this.a=0,this.l=new Rn,this.ca=new oo,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new re,this.Pb=0,this.wd=new re,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new il,this.ab=0,this.gc=_(4,co),this.Oc=0}function Qc(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Rn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Tc(I,L,Y,ce,Se,Le,ze){for(I=I==null?0:I[L+0],L=0;L<ze;++L)Se[Le+L]=I+Y[ce+L]&255,I=Se[Le+L]}function eu(I,L,Y,ce,Se,Le,ze){var Ge;if(I==null)Tc(null,null,Y,ce,Se,Le,ze);else for(Ge=0;Ge<ze;++Ge)Se[Le+Ge]=I[L+Ge]+Y[ce+Ge]&255}function Bs(I,L,Y,ce,Se,Le,ze){if(I==null)Tc(null,null,Y,ce,Se,Le,ze);else{var Ge,Xe=I[L+0],tt=Xe,St=Xe;for(Ge=0;Ge<ze;++Ge)tt=St+(Xe=I[L+Ge])-tt,St=Y[ce+Ge]+(-256&tt?0>tt?0:255:tt)&255,tt=Xe,Se[Le+Ge]=St}}function Sc(I,L,Y,ce){var Se=L.width,Le=L.o;if(i(I!=null&&L!=null),0>Y||0>=ce||Y+ce>Le)return null;if(!I.Cc){if(I.ga==null){var ze;if(I.ga=new Qc,(ze=I.ga==null)||(ze=L.width*L.o,i(I.Gb.length==0),I.Gb=r(ze),I.Uc=0,I.Gb==null?ze=0:(I.mb=I.Gb,I.nb=I.Uc,I.rc=null,ze=1),ze=!ze),!ze){ze=I.ga;var Ge=I.Fa,Xe=I.P,tt=I.qc,St=I.mb,it=I.nb,Ut=Xe+1,Rt=tt-1,vr=ze.l;if(i(Ge!=null&&St!=null&&L!=null),lu[0]=null,lu[1]=Tc,lu[2]=eu,lu[3]=Bs,ze.ca=St,ze.tb=it,ze.c=L.width,ze.i=L.height,i(0<ze.c&&0<ze.i),1>=tt)L=0;else if(ze.$a=Ge[Xe+0]>>0&3,ze.Z=Ge[Xe+0]>>2&3,ze.Lc=Ge[Xe+0]>>4&3,Xe=Ge[Xe+0]>>6&3,0>ze.$a||1<ze.$a||4<=ze.Z||1<ze.Lc||Xe)L=0;else if(vr.put=vo,vr.ac=On,vr.bc=Oa,vr.ma=ze,vr.width=L.width,vr.height=L.height,vr.Da=L.Da,vr.v=L.v,vr.va=L.va,vr.j=L.j,vr.o=L.o,ze.$a)e:{i(ze.$a==1),L=Ze();t:for(;;){if(L==null){L=0;break e}if(i(ze!=null),ze.mc=L,L.c=ze.c,L.i=ze.i,L.l=ze.l,L.l.ma=ze,L.l.width=ze.c,L.l.height=ze.i,L.a=0,pt(L.m,Ge,Ut,Rt),!ke(ze.c,ze.i,1,L,null)||(L.ab==1&&L.gc[0].hc==3&&W(L.s)?(ze.ic=1,Ge=L.c*L.i,L.Ta=null,L.Ua=0,L.V=r(Ge),L.Ba=0,L.V==null?(L.a=1,L=0):L=1):(ze.ic=0,L=We(L,ze.c)),!L))break t;L=1;break e}ze.mc=null,L=0}else L=Rt>=ze.c*ze.i;ze=!L}if(ze)return null;I.ga.Lc!=1?I.Ga=0:ce=Le-Y}i(I.ga!=null),i(Y+ce<=Le);e:{if(L=(Ge=I.ga).c,Le=Ge.l.o,Ge.$a==0){if(Ut=I.rc,Rt=I.Vc,vr=I.Fa,Xe=I.P+1+Y*L,tt=I.mb,St=I.nb+Y*L,i(Xe<=I.P+I.qc),Ge.Z!=0)for(i(lu[Ge.Z]!=null),ze=0;ze<ce;++ze)lu[Ge.Z](Ut,Rt,vr,Xe,tt,St,L),Ut=tt,Rt=St,St+=L,Xe+=L;else for(ze=0;ze<ce;++ze)c(tt,St,vr,Xe,L),Ut=tt,Rt=St,St+=L,Xe+=L;I.rc=Ut,I.Vc=Rt}else{if(i(Ge.mc!=null),L=Y+ce,i((ze=Ge.mc)!=null),i(L<=ze.i),ze.C>=L)L=1;else if(Ge.ic||Lt(),Ge.ic){Ge=ze.V,Ut=ze.Ba,Rt=ze.c;var rr=ze.i,Et=(vr=1,Xe=ze.$/Rt,tt=ze.$%Rt,St=ze.m,it=ze.s,ze.$),It=Rt*rr,ur=Rt*L,yr=it.wc,gr=Et<ur?Jn(it,tt,Xe):null;i(Et<=It),i(L<=rr),i(W(it));t:for(;;){for(;!St.h&&Et<ur;){if(tt&yr||(gr=Jn(it,tt,Xe)),i(gr!=null),Ve(St),256>(rr=Za(gr.G[0],gr.H[0],St)))Ge[Ut+Et]=rr,++Et,++tt>=Rt&&(tt=0,++Xe<=L&&!(Xe%16)&&se(ze,Xe));else{if(!(280>rr)){vr=0;break t}rr=Vo(rr-256,St);var $r,Hr=Za(gr.G[4],gr.H[4],St);if(Ve(St),!(Et>=(Hr=so(Rt,Hr=Vo(Hr,St)))&&It-Et>=rr)){vr=0;break t}for($r=0;$r<rr;++$r)Ge[Ut+Et+$r]=Ge[Ut+Et+$r-Hr];for(Et+=rr,tt+=rr;tt>=Rt;)tt-=Rt,++Xe<=L&&!(Xe%16)&&se(ze,Xe);Et<ur&&tt&yr&&(gr=Jn(it,tt,Xe))}i(St.h==pe(St))}se(ze,Xe>L?L:Xe);break t}!vr||St.h&&Et<It?(vr=0,ze.a=St.h?5:3):ze.$=Et,L=vr}else L=le(ze,ze.V,ze.Ba,ze.c,ze.i,L,nt);if(!L){ce=0;break e}}Y+ce>=Le&&(I.Cc=1),ce=1}if(!ce)return null;if(I.Cc&&((ce=I.ga)!=null&&(ce.mc=null),I.ga=null,0<I.Ga))return alert("todo:WebPDequantizeLevels"),null}return I.nb+Y*Se}function H(I,L,Y,ce,Se,Le){for(;0<Se--;){var ze,Ge=I,Xe=L+(Y?1:0),tt=I,St=L+(Y?0:3);for(ze=0;ze<ce;++ze){var it=tt[St+4*ze];it!=255&&(it*=32897,Ge[Xe+4*ze+0]=Ge[Xe+4*ze+0]*it>>23,Ge[Xe+4*ze+1]=Ge[Xe+4*ze+1]*it>>23,Ge[Xe+4*ze+2]=Ge[Xe+4*ze+2]*it>>23)}L+=Le}}function Ee(I,L,Y,ce,Se){for(;0<ce--;){var Le;for(Le=0;Le<Y;++Le){var ze=I[L+2*Le+0],Ge=15&(tt=I[L+2*Le+1]),Xe=4369*Ge,tt=(240&tt|tt>>4)*Xe>>16;I[L+2*Le+0]=(240&ze|ze>>4)*Xe>>16&240|(15&ze|ze<<4)*Xe>>16>>4&15,I[L+2*Le+1]=240&tt|Ge}L+=Se}}function ct(I,L,Y,ce,Se,Le,ze,Ge){var Xe,tt,St=255;for(tt=0;tt<Se;++tt){for(Xe=0;Xe<ce;++Xe){var it=I[L+Xe];Le[ze+4*Xe]=it,St&=it}L+=Y,ze+=Ge}return St!=255}function yt(I,L,Y,ce,Se){var Le;for(Le=0;Le<Se;++Le)Y[ce+Le]=I[L+Le]>>8}function Lt(){Ha=H,Mc=Ee,Kl=ct,kp=yt}function sr(I,L,Y){ge[I]=function(ce,Se,Le,ze,Ge,Xe,tt,St,it,Ut,Rt,vr,rr,Et,It,ur,yr){var gr,$r=yr-1>>1,Hr=Ge[Xe+0]|tt[St+0]<<16,Ci=it[Ut+0]|Rt[vr+0]<<16;i(ce!=null);var Wr=3*Hr+Ci+131074>>2;for(L(ce[Se+0],255&Wr,Wr>>16,rr,Et),Le!=null&&(Wr=3*Ci+Hr+131074>>2,L(Le[ze+0],255&Wr,Wr>>16,It,ur)),gr=1;gr<=$r;++gr){var Fn=Ge[Xe+gr]|tt[St+gr]<<16,Nn=it[Ut+gr]|Rt[vr+gr]<<16,on=Hr+Fn+Ci+Nn+524296,dn=on+2*(Fn+Ci)>>3;Wr=dn+Hr>>1,Hr=(on=on+2*(Hr+Nn)>>3)+Fn>>1,L(ce[Se+2*gr-1],255&Wr,Wr>>16,rr,Et+(2*gr-1)*Y),L(ce[Se+2*gr-0],255&Hr,Hr>>16,rr,Et+(2*gr-0)*Y),Le!=null&&(Wr=on+Ci>>1,Hr=dn+Nn>>1,L(Le[ze+2*gr-1],255&Wr,Wr>>16,It,ur+(2*gr-1)*Y),L(Le[ze+2*gr+0],255&Hr,Hr>>16,It,ur+(2*gr+0)*Y)),Hr=Fn,Ci=Nn}1&yr||(Wr=3*Hr+Ci+131074>>2,L(ce[Se+yr-1],255&Wr,Wr>>16,rr,Et+(yr-1)*Y),Le!=null&&(Wr=3*Ci+Hr+131074>>2,L(Le[ze+yr-1],255&Wr,Wr>>16,It,ur+(yr-1)*Y)))}}function Mr(){qa[Fh]=Bm,qa[Gs]=Lo,qa[wf]=zm,qa[Dc]=Tf,qa[Tr]=Pc,qa[Gi]=Sf,qa[$i]=yg,qa[Po]=Lo,qa[ou]=Tf,qa[Oi]=Pc,qa[Hs]=Sf}function Yr(I){return I&~Fp?0>I?0:255:I>>zu}function hi(I,L){return Yr((19077*I>>8)+(26149*L>>8)-14234)}function Fi(I,L,Y){return Yr((19077*I>>8)-(6419*L>>8)-(13320*Y>>8)+8708)}function di(I,L){return Yr((19077*I>>8)+(33050*L>>8)-17685)}function pn(I,L,Y,ce,Se){ce[Se+0]=hi(I,Y),ce[Se+1]=Fi(I,L,Y),ce[Se+2]=di(I,L)}function va(I,L,Y,ce,Se){ce[Se+0]=di(I,L),ce[Se+1]=Fi(I,L,Y),ce[Se+2]=hi(I,Y)}function Na(I,L,Y,ce,Se){var Le=Fi(I,L,Y);L=Le<<3&224|di(I,L)>>3,ce[Se+0]=248&hi(I,Y)|Le>>5,ce[Se+1]=L}function Va(I,L,Y,ce,Se){var Le=240&di(I,L)|15;ce[Se+0]=240&hi(I,Y)|Fi(I,L,Y)>>4,ce[Se+1]=Le}function Io(I,L,Y,ce,Se){ce[Se+0]=255,pn(I,L,Y,ce,Se+1)}function la(I,L,Y,ce,Se){va(I,L,Y,ce,Se),ce[Se+3]=255}function ys(I,L,Y,ce,Se){pn(I,L,Y,ce,Se),ce[Se+3]=255}function xs(I,L){return 0>I?0:I>L?L:I}function zs(I,L,Y){ge[I]=function(ce,Se,Le,ze,Ge,Xe,tt,St,it){for(var Ut=St+(-2&it)*Y;St!=Ut;)L(ce[Se+0],Le[ze+0],Ge[Xe+0],tt,St),L(ce[Se+1],Le[ze+0],Ge[Xe+0],tt,St+Y),Se+=2,++ze,++Xe,St+=2*Y;1&it&&L(ce[Se+0],Le[ze+0],Ge[Xe+0],tt,St)}}function Ru(I,L,Y){return Y==0?I==0?L==0?6:5:L==0?4:0:Y}function tu(I,L,Y,ce,Se){switch(I>>>30){case 3:Zl(L,Y,ce,Se,0);break;case 2:Mh(L,Y,ce,Se);break;case 1:Ml(L,Y,ce,Se)}}function Xl(I,L){var Y,ce,Se=L.M,Le=L.Nb,ze=I.oc,Ge=I.pc+40,Xe=I.oc,tt=I.pc+584,St=I.oc,it=I.pc+600;for(Y=0;16>Y;++Y)ze[Ge+32*Y-1]=129;for(Y=0;8>Y;++Y)Xe[tt+32*Y-1]=129,St[it+32*Y-1]=129;for(0<Se?ze[Ge-1-32]=Xe[tt-1-32]=St[it-1-32]=129:(u(ze,Ge-32-1,127,21),u(Xe,tt-32-1,127,9),u(St,it-32-1,127,9)),ce=0;ce<I.za;++ce){var Ut=L.ya[L.aa+ce];if(0<ce){for(Y=-1;16>Y;++Y)c(ze,Ge+32*Y-4,ze,Ge+32*Y+12,4);for(Y=-1;8>Y;++Y)c(Xe,tt+32*Y-4,Xe,tt+32*Y+4,4),c(St,it+32*Y-4,St,it+32*Y+4,4)}var Rt=I.Gd,vr=I.Hd+ce,rr=Ut.ad,Et=Ut.Hc;if(0<Se&&(c(ze,Ge-32,Rt[vr].y,0,16),c(Xe,tt-32,Rt[vr].f,0,8),c(St,it-32,Rt[vr].ea,0,8)),Ut.Za){var It=ze,ur=Ge-32+16;for(0<Se&&(ce>=I.za-1?u(It,ur,Rt[vr].y[15],4):c(It,ur,Rt[vr+1].y,0,4)),Y=0;4>Y;Y++)It[ur+128+Y]=It[ur+256+Y]=It[ur+384+Y]=It[ur+0+Y];for(Y=0;16>Y;++Y,Et<<=2)It=ze,ur=Ge+ju[Y],Qa[Ut.Ob[Y]](It,ur),tu(Et,rr,16*+Y,It,ur)}else if(It=Ru(ce,Se,Ut.Ob[0]),Ql[It](ze,Ge),Et!=0)for(Y=0;16>Y;++Y,Et<<=2)tu(Et,rr,16*+Y,ze,Ge+ju[Y]);for(Y=Ut.Gc,It=Ru(ce,Se,Ut.Dd),Ws[It](Xe,tt),Ws[It](St,it),Et=rr,It=Xe,ur=tt,255&(Ut=Y>>0)&&(170&Ut?Ic(Et,256,It,ur):al(Et,256,It,ur)),Ut=St,Et=it,255&(Y>>=8)&&(170&Y?Ic(rr,320,Ut,Et):al(rr,320,Ut,Et)),Se<I.Ub-1&&(c(Rt[vr].y,0,ze,Ge+480,16),c(Rt[vr].f,0,Xe,tt+224,8),c(Rt[vr].ea,0,St,it+224,8)),Y=8*Le*I.B,Rt=I.sa,vr=I.ta+16*ce+16*Le*I.R,rr=I.qa,Ut=I.ra+8*ce+Y,Et=I.Ha,It=I.Ia+8*ce+Y,Y=0;16>Y;++Y)c(Rt,vr+Y*I.R,ze,Ge+32*Y,16);for(Y=0;8>Y;++Y)c(rr,Ut+Y*I.B,Xe,tt+32*Y,8),c(Et,It+Y*I.B,St,it+32*Y,8)}}function Cl(I,L,Y,ce,Se,Le,ze,Ge,Xe){var tt=[0],St=[0],it=0,Ut=Xe!=null?Xe.kd:0,Rt=Xe??new vs;if(I==null||12>Y)return 7;Rt.data=I,Rt.w=L,Rt.ha=Y,L=[L],Y=[Y],Rt.gb=[Rt.gb];e:{var vr=L,rr=Y,Et=Rt.gb;if(i(I!=null),i(rr!=null),i(Et!=null),Et[0]=0,12<=rr[0]&&!o(I,vr[0],"RIFF")){if(o(I,vr[0]+8,"WEBP")){Et=3;break e}var It=Rr(I,vr[0]+4);if(12>It||4294967286<It){Et=3;break e}if(Ut&&It>rr[0]-8){Et=7;break e}Et[0]=It,vr[0]+=12,rr[0]-=12}Et=0}if(Et!=0)return Et;for(It=0<Rt.gb[0],Y=Y[0];;){e:{var ur=I;rr=L,Et=Y;var yr=tt,gr=St,$r=vr=[0];if((Wr=it=[it])[0]=0,8>Et[0])Et=7;else{if(!o(ur,rr[0],"VP8X")){if(Rr(ur,rr[0]+4)!=10){Et=3;break e}if(18>Et[0]){Et=7;break e}var Hr=Rr(ur,rr[0]+8),Ci=1+xr(ur,rr[0]+12);if(2147483648<=Ci*(ur=1+xr(ur,rr[0]+15))){Et=3;break e}$r!=null&&($r[0]=Hr),yr!=null&&(yr[0]=Ci),gr!=null&&(gr[0]=ur),rr[0]+=18,Et[0]-=18,Wr[0]=1}Et=0}}if(it=it[0],vr=vr[0],Et!=0)return Et;if(rr=!!(2&vr),!It&&it)return 3;if(Le!=null&&(Le[0]=!!(16&vr)),ze!=null&&(ze[0]=rr),Ge!=null&&(Ge[0]=0),ze=tt[0],vr=St[0],it&&rr&&Xe==null){Et=0;break}if(4>Y){Et=7;break}if(It&&it||!It&&!it&&!o(I,L[0],"ALPH")){Y=[Y],Rt.na=[Rt.na],Rt.P=[Rt.P],Rt.Sa=[Rt.Sa];e:{Hr=I,Et=L,It=Y;var Wr=Rt.gb;yr=Rt.na,gr=Rt.P,$r=Rt.Sa,Ci=22,i(Hr!=null),i(It!=null),ur=Et[0];var Fn=It[0];for(i(yr!=null),i($r!=null),yr[0]=null,gr[0]=null,$r[0]=0;;){if(Et[0]=ur,It[0]=Fn,8>Fn){Et=7;break e}var Nn=Rr(Hr,ur+4);if(4294967286<Nn){Et=3;break e}var on=8+Nn+1&-2;if(Ci+=on,0<Wr&&Ci>Wr){Et=3;break e}if(!o(Hr,ur,"VP8 ")||!o(Hr,ur,"VP8L")){Et=0;break e}if(Fn[0]<on){Et=7;break e}o(Hr,ur,"ALPH")||(yr[0]=Hr,gr[0]=ur+8,$r[0]=Nn),ur+=on,Fn-=on}}if(Y=Y[0],Rt.na=Rt.na[0],Rt.P=Rt.P[0],Rt.Sa=Rt.Sa[0],Et!=0)break}Y=[Y],Rt.Ja=[Rt.Ja],Rt.xa=[Rt.xa];e:if(Wr=I,Et=L,It=Y,yr=Rt.gb[0],gr=Rt.Ja,$r=Rt.xa,Hr=Et[0],ur=!o(Wr,Hr,"VP8 "),Ci=!o(Wr,Hr,"VP8L"),i(Wr!=null),i(It!=null),i(gr!=null),i($r!=null),8>It[0])Et=7;else{if(ur||Ci){if(Wr=Rr(Wr,Hr+4),12<=yr&&Wr>yr-12){Et=3;break e}if(Ut&&Wr>It[0]-8){Et=7;break e}gr[0]=Wr,Et[0]+=8,It[0]-=8,$r[0]=Ci}else $r[0]=5<=It[0]&&Wr[Hr+0]==47&&!(Wr[Hr+4]>>5),gr[0]=It[0];Et=0}if(Y=Y[0],Rt.Ja=Rt.Ja[0],Rt.xa=Rt.xa[0],L=L[0],Et!=0)break;if(4294967286<Rt.Ja)return 3;if(Ge==null||rr||(Ge[0]=Rt.xa?2:1),ze=[ze],vr=[vr],Rt.xa){if(5>Y){Et=7;break}Ge=ze,Ut=vr,rr=Le,I==null||5>Y?I=0:5<=Y&&I[L+0]==47&&!(I[L+4]>>5)?(It=[0],Wr=[0],yr=[0],pt(gr=new re,I,L,Y),Qr(gr,It,Wr,yr)?(Ge!=null&&(Ge[0]=It[0]),Ut!=null&&(Ut[0]=Wr[0]),rr!=null&&(rr[0]=yr[0]),I=1):I=0):I=0}else{if(10>Y){Et=7;break}Ge=vr,I==null||10>Y||!Gl(I,L+3,Y-3)?I=0:(Ut=I[L+0]|I[L+1]<<8|I[L+2]<<16,rr=16383&(I[L+7]<<8|I[L+6]),I=16383&(I[L+9]<<8|I[L+8]),1&Ut||3<(Ut>>1&7)||!(Ut>>4&1)||Ut>>5>=Rt.Ja||!rr||!I?I=0:(ze&&(ze[0]=rr),Ge&&(Ge[0]=I),I=1))}if(!I||(ze=ze[0],vr=vr[0],it&&(tt[0]!=ze||St[0]!=vr)))return 3;Xe!=null&&(Xe[0]=Rt,Xe.offset=L-Xe.w,i(4294967286>L-Xe.w),i(Xe.offset==Xe.ha-Y));break}return Et==0||Et==7&&it&&Xe==null?(Le!=null&&(Le[0]|=Rt.na!=null&&0<Rt.na.length),ce!=null&&(ce[0]=ze),Se!=null&&(Se[0]=vr),0):Et}function Fu(I,L,Y){var ce=L.width,Se=L.height,Le=0,ze=0,Ge=ce,Xe=Se;if(L.Da=I!=null&&0<I.Da,L.Da&&(Ge=I.cd,Xe=I.bd,Le=I.v,ze=I.j,11>Y||(Le&=-2,ze&=-2),0>Le||0>ze||0>=Ge||0>=Xe||Le+Ge>ce||ze+Xe>Se))return 0;if(L.v=Le,L.j=ze,L.va=Le+Ge,L.o=ze+Xe,L.U=Ge,L.T=Xe,L.da=I!=null&&0<I.da,L.da){if(!Bt(Ge,Xe,Y=[I.ib],Le=[I.hb]))return 0;L.ib=Y[0],L.hb=Le[0]}return L.ob=I!=null&&I.ob,L.Kb=I==null||!I.Sd,L.da&&(L.ob=L.ib<3*ce/4&&L.hb<3*Se/4,L.Kb=0),1}function Pu(I){if(I==null)return 2;if(11>I.S){var L=I.f.RGBA;L.fb+=(I.height-1)*L.A,L.A=-L.A}else L=I.f.kb,I=I.height,L.O+=(I-1)*L.fa,L.fa=-L.fa,L.N+=(I-1>>1)*L.Ab,L.Ab=-L.Ab,L.W+=(I-1>>1)*L.Db,L.Db=-L.Db,L.F!=null&&(L.J+=(I-1)*L.lb,L.lb=-L.lb);return 0}function ru(I,L,Y,ce){if(ce==null||0>=I||0>=L)return 2;if(Y!=null){if(Y.Da){var Se=Y.cd,Le=Y.bd,ze=-2&Y.v,Ge=-2&Y.j;if(0>ze||0>Ge||0>=Se||0>=Le||ze+Se>I||Ge+Le>L)return 2;I=Se,L=Le}if(Y.da){if(!Bt(I,L,Se=[Y.ib],Le=[Y.hb]))return 2;I=Se[0],L=Le[0]}}ce.width=I,ce.height=L;e:{var Xe=ce.width,tt=ce.height;if(I=ce.S,0>=Xe||0>=tt||!(I>=Fh&&13>I))I=2;else{if(0>=ce.Rd&&ce.sd==null){ze=Le=Se=L=0;var St=(Ge=Xe*Lp[I])*tt;if(11>I||(Le=(tt+1)/2*(L=(Xe+1)/2),I==12&&(ze=(Se=Xe)*tt)),(tt=r(St+2*Le+ze))==null){I=1;break e}ce.sd=tt,11>I?((Xe=ce.f.RGBA).eb=tt,Xe.fb=0,Xe.A=Ge,Xe.size=St):((Xe=ce.f.kb).y=tt,Xe.O=0,Xe.fa=Ge,Xe.Fd=St,Xe.f=tt,Xe.N=0+St,Xe.Ab=L,Xe.Cd=Le,Xe.ea=tt,Xe.W=0+St+Le,Xe.Db=L,Xe.Ed=Le,I==12&&(Xe.F=tt,Xe.J=0+St+2*Le),Xe.Tc=ze,Xe.lb=Se)}if(L=1,Se=ce.S,Le=ce.width,ze=ce.height,Se>=Fh&&13>Se)if(11>Se)I=ce.f.RGBA,L&=(Ge=Math.abs(I.A))*(ze-1)+Le<=I.size,L&=Ge>=Le*Lp[Se],L&=I.eb!=null;else{I=ce.f.kb,Ge=(Le+1)/2,St=(ze+1)/2,Xe=Math.abs(I.fa),tt=Math.abs(I.Ab);var it=Math.abs(I.Db),Ut=Math.abs(I.lb),Rt=Ut*(ze-1)+Le;L&=Xe*(ze-1)+Le<=I.Fd,L&=tt*(St-1)+Ge<=I.Cd,L=(L&=it*(St-1)+Ge<=I.Ed)&Xe>=Le&tt>=Ge&it>=Ge,L&=I.y!=null,L&=I.f!=null,L&=I.ea!=null,Se==12&&(L&=Ut>=Le,L&=Rt<=I.Tc,L&=I.F!=null)}else L=0;I=L?0:2}}return I!=0||Y!=null&&Y.fd&&(I=Pu(ce)),I}var rs=64,Ec=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],iu=24,Ac=32,Cc=8,ho=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];kr("Predictor0","PredictorAdd0"),ge.Predictor0=function(){return 4278190080},ge.Predictor1=function(I){return I},ge.Predictor2=function(I,L,Y){return L[Y+0]},ge.Predictor3=function(I,L,Y){return L[Y+1]},ge.Predictor4=function(I,L,Y){return L[Y-1]},ge.Predictor5=function(I,L,Y){return Br(Br(I,L[Y+1]),L[Y+0])},ge.Predictor6=function(I,L,Y){return Br(I,L[Y-1])},ge.Predictor7=function(I,L,Y){return Br(I,L[Y+0])},ge.Predictor8=function(I,L,Y){return Br(L[Y-1],L[Y+0])},ge.Predictor9=function(I,L,Y){return Br(L[Y+0],L[Y+1])},ge.Predictor10=function(I,L,Y){return Br(Br(I,L[Y-1]),Br(L[Y+0],L[Y+1]))},ge.Predictor11=function(I,L,Y){var ce=L[Y+0];return 0>=wi(ce>>24&255,I>>24&255,(L=L[Y-1])>>24&255)+wi(ce>>16&255,I>>16&255,L>>16&255)+wi(ce>>8&255,I>>8&255,L>>8&255)+wi(255&ce,255&I,255&L)?ce:I},ge.Predictor12=function(I,L,Y){var ce=L[Y+0];return(ii((I>>24&255)+(ce>>24&255)-((L=L[Y-1])>>24&255))<<24|ii((I>>16&255)+(ce>>16&255)-(L>>16&255))<<16|ii((I>>8&255)+(ce>>8&255)-(L>>8&255))<<8|ii((255&I)+(255&ce)-(255&L)))>>>0},ge.Predictor13=function(I,L,Y){var ce=L[Y-1];return(si((I=Br(I,L[Y+0]))>>24&255,ce>>24&255)<<24|si(I>>16&255,ce>>16&255)<<16|si(I>>8&255,ce>>8&255)<<8|si(I>>0&255,ce>>0&255))>>>0};var xf=ge.PredictorAdd0;ge.PredictorAdd1=Ri,kr("Predictor2","PredictorAdd2"),kr("Predictor3","PredictorAdd3"),kr("Predictor4","PredictorAdd4"),kr("Predictor5","PredictorAdd5"),kr("Predictor6","PredictorAdd6"),kr("Predictor7","PredictorAdd7"),kr("Predictor8","PredictorAdd8"),kr("Predictor9","PredictorAdd9"),kr("Predictor10","PredictorAdd10"),kr("Predictor11","PredictorAdd11"),kr("Predictor12","PredictorAdd12"),kr("Predictor13","PredictorAdd13");var Lu=ge.PredictorAdd2;Ui("ColorIndexInverseTransform","MapARGB","32b",function(I){return I>>8&255},function(I){return I}),Ui("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(I){return I},function(I){return I>>8&255});var nu,is=ge.ColorIndexInverseTransform,nl=ge.MapARGB,bd=ge.VP8LColorIndexInverseTransformAlpha,wd=ge.MapAlpha,au=ge.VP8LPredictorsAdd=[];au.length=16,(ge.VP8LPredictors=[]).length=16,(ge.VP8LPredictorsAdd_C=[]).length=16,(ge.VP8LPredictors_C=[]).length=16;var Ga,Ho,Il,kl,js,Ou,Us,Zl,Mh,Ic,Ml,al,Nu,Dl,Yl,ol,Rl,Vs,kc,Qn,Yn,ca,Ka,bs,Ha,Mc,Kl,kp,Td=r(511),bf=r(2041),Dh=r(225),Rh=r(767),qi=0,Mp=bf,Xr=Dh,ws=Rh,ns=Td,Fh=0,Gs=1,wf=2,Dc=3,Tr=4,Gi=5,$i=6,Po=7,ou=8,Oi=9,Hs=10,Ph=[2,3,7],Jl=[3,3,11],as=[280,256,256,256,40],Da=[0,1,1,1,0],vg=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Sd=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Dp=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Lh=8,Bu=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Rc=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ja=null,os=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Nm=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Wo=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Wa=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],sl=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Fc=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],fo=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ql=[],Qa=[],Ws=[],Ed=1,su=2,lu=[],qa=[];sr("UpsampleRgbLinePair",pn,3),sr("UpsampleBgrLinePair",va,3),sr("UpsampleRgbaLinePair",ys,4),sr("UpsampleBgraLinePair",la,4),sr("UpsampleArgbLinePair",Io,4),sr("UpsampleRgba4444LinePair",Va,2),sr("UpsampleRgb565LinePair",Na,2);var Bm=ge.UpsampleRgbLinePair,zm=ge.UpsampleBgrLinePair,Lo=ge.UpsampleRgbaLinePair,Tf=ge.UpsampleBgraLinePair,Pc=ge.UpsampleArgbLinePair,Sf=ge.UpsampleRgba4444LinePair,yg=ge.UpsampleRgb565LinePair,Ef=16,cu=1<<Ef-1,ec=-227,Rp=482,zu=6,Fp=(256<<zu)-1,zi=0,Lc=r(256),jm=r(256),xg=r(256),bg=r(256),Ad=r(Rp-ec),Af=r(Rp-ec);zs("YuvToRgbRow",pn,3),zs("YuvToBgrRow",va,3),zs("YuvToRgbaRow",ys,4),zs("YuvToBgraRow",la,4),zs("YuvToArgbRow",Io,4),zs("YuvToRgba4444Row",Va,2),zs("YuvToRgb565Row",Na,2);var ju=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Cd=[0,2,8],Pp=[8,7,6,4,4,2,2,2,1,1,1,1],Fl=1;this.WebPDecodeRGBA=function(I,L,Y,ce,Se){var Le=Gs,ze=new Wn,Ge=new oo;ze.ba=Ge,Ge.S=Le,Ge.width=[Ge.width],Ge.height=[Ge.height];var Xe=Ge.width,tt=Ge.height,St=new Co;if(St==null||I==null)var it=2;else i(St!=null),it=Cl(I,L,Y,St.width,St.height,St.Pd,St.Qd,St.format,null);if(it!=0?Xe=0:(Xe!=null&&(Xe[0]=St.width[0]),tt!=null&&(tt[0]=St.height[0]),Xe=1),Xe){Ge.width=Ge.width[0],Ge.height=Ge.height[0],ce!=null&&(ce[0]=Ge.width),Se!=null&&(Se[0]=Ge.height);e:{if(ce=new Rn,(Se=new vs).data=I,Se.w=L,Se.ha=Y,Se.kd=1,L=[0],i(Se!=null),((I=Cl(Se.data,Se.w,Se.ha,null,null,null,L,null,Se))==0||I==7)&&L[0]&&(I=4),(L=I)==0){if(i(ze!=null),ce.data=Se.data,ce.w=Se.w+Se.offset,ce.ha=Se.ha-Se.offset,ce.put=vo,ce.ac=On,ce.bc=Oa,ce.ma=ze,Se.xa){if((I=Ze())==null){ze=1;break e}if(function(Ut,Rt){var vr=[0],rr=[0],Et=[0];t:for(;;){if(Ut==null)return 0;if(Rt==null)return Ut.a=2,0;if(Ut.l=Rt,Ut.a=0,pt(Ut.m,Rt.data,Rt.w,Rt.ha),!Qr(Ut.m,vr,rr,Et)){Ut.a=3;break t}if(Ut.xb=su,Rt.width=vr[0],Rt.height=rr[0],!ke(vr[0],rr[0],1,Ut,null))break t;return 1}return i(Ut.a!=0),0}(I,ce)){if(ce=(L=ru(ce.width,ce.height,ze.Oa,ze.ba))==0){t:{ce=I;r:for(;;){if(ce==null){ce=0;break t}if(i(ce.s.yc!=null),i(ce.s.Ya!=null),i(0<ce.s.Wb),i((Y=ce.l)!=null),i((Se=Y.ma)!=null),ce.xb!=0){if(ce.ca=Se.ba,ce.tb=Se.tb,i(ce.ca!=null),!Fu(Se.Oa,Y,Dc)){ce.a=2;break r}if(!We(ce,Y.width)||Y.da)break r;if((Y.da||Qi(ce.ca.S))&&Lt(),11>ce.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ce.ca.f.kb.F!=null&&Lt()),ce.Pb&&0<ce.s.ua&&ce.s.vb.X==null&&!Fr(ce.s.vb,ce.s.Wa.Xa)){ce.a=1;break r}ce.xb=0}if(!le(ce,ce.V,ce.Ba,ce.c,ce.i,Y.o,U))break r;Se.Dc=ce.Ma,ce=1;break t}i(ce.a!=0),ce=0}ce=!ce}ce&&(L=I.a)}else L=I.a}else{if((I=new Hn)==null){ze=1;break e}if(I.Fa=Se.na,I.P=Se.P,I.qc=Se.Sa,wh(I,ce)){if((L=ru(ce.width,ce.height,ze.Oa,ze.ba))==0){if(I.Aa=0,Y=ze.Oa,i((Se=I)!=null),Y!=null){if(0<(Xe=0>(Xe=Y.Md)?0:100<Xe?255:255*Xe/100)){for(tt=St=0;4>tt;++tt)12>(it=Se.pb[tt]).lc&&(it.ia=Xe*Pp[0>it.lc?0:it.lc]>>3),St|=it.ia;St&&(alert("todo:VP8InitRandom"),Se.ia=1)}Se.Ga=Y.Id,100<Se.Ga?Se.Ga=100:0>Se.Ga&&(Se.Ga=0)}ci(I,ce)||(L=I.a)}}else L=I.a}L==0&&ze.Oa!=null&&ze.Oa.fd&&(L=Pu(ze.ba))}ze=L}Le=ze!=0?null:11>Le?Ge.f.RGBA.eb:Ge.f.kb.y}else Le=null;return Le};var Lp=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function k(ge,Ue){for(var Ae="",_e=0;_e<4;_e++)Ae+=String.fromCharCode(ge[Ue++]);return Ae}function D(ge,Ue){return(ge[Ue+0]<<0|ge[Ue+1]<<8|ge[Ue+2]<<16)>>>0}function j(ge,Ue){return(ge[Ue+0]<<0|ge[Ue+1]<<8|ge[Ue+2]<<16|ge[Ue+3]<<24)>>>0}new E;var B=[0],P=[0],ee=[],G=new E,K=a,J=function(ge,Ue){var Ae={},_e=0,ve=!1,Qe=0,Ce=0;if(Ae.frames=[],!function(xe,pe,Ie,Ve){for(var gt=0;gt<Ve;gt++)if(xe[pe+gt]!=Ie.charCodeAt(gt))return!0;return!1}(ge,Ue,"RIFF",4)){var Ye,ut;for(j(ge,Ue+=4),Ue+=8;Ue<ge.length;){var st=k(ge,Ue),pt=j(ge,Ue+=4);Ue+=4;var Tt=pt+(1&pt);switch(st){case"VP8 ":case"VP8L":Ae.frames[_e]===void 0&&(Ae.frames[_e]={}),(re=Ae.frames[_e]).src_off=ve?Ce:Ue-8,re.src_size=Qe+pt+8,_e++,ve&&(ve=!1,Qe=0,Ce=0);break;case"VP8X":(re=Ae.header={}).feature_flags=ge[Ue];var ht=Ue+4;re.canvas_width=1+D(ge,ht),ht+=3,re.canvas_height=1+D(ge,ht),ht+=3;break;case"ALPH":ve=!0,Qe=Tt+8,Ce=Ue-8;break;case"ANIM":(re=Ae.header).bgcolor=j(ge,Ue),ht=Ue+4,re.loop_count=(Ye=ge)[(ut=ht)+0]<<0|Ye[ut+1]<<8,ht+=2;break;case"ANMF":var Wt,re;(re=Ae.frames[_e]={}).offset_x=2*D(ge,Ue),Ue+=3,re.offset_y=2*D(ge,Ue),Ue+=3,re.width=1+D(ge,Ue),Ue+=3,re.height=1+D(ge,Ue),Ue+=3,re.duration=D(ge,Ue),Ue+=3,Wt=ge[Ue++],re.dispose=1&Wt,re.blend=Wt>>1&1}st!="ANMF"&&(Ue+=Tt)}return Ae}}(K,0);J.response=K,J.rgbaoutput=!0,J.dataurl=!1;var ne=J.header?J.header:null,he=J.frames?J.frames:null;if(ne){ne.loop_counter=ne.loop_count,B=[ne.canvas_height],P=[ne.canvas_width];for(var Me=0;Me<he.length&&he[Me].blend!=0;Me++);}var Re=he[0],et=G.WebPDecodeRGBA(K,Re.src_off,Re.src_size,P,B);Re.rgba=et,Re.imgwidth=P[0],Re.imgheight=B[0];for(var Te=0;Te<P[0]*B[0]*4;Te++)ee[Te]=et[Te];return this.width=P,this.height=B,this.data=ee,this}var Wi,ja,w1,DT,km,yD,jH,xD,Fo,NT,Lm,pg,sn,wp,mc,wD,dd,UH,VH,GH,zo,jo,Uo,HH,WH,PT,Nx,qH,$H,XH,ZH,BD,IT,fd,zD,jD,xh,Dm,Rm,Fm,T1,ps,S1,Pm,jx,E1,Ep,A1,ai,YH,KH,VD,GD,LT,HD,JH,QH,SD,Bx,CD,ID,kT,mg,zx,kD,MD,DD,iW,bh,Ap,aW,oW,pd,sW,PD,WD,lW,cW,uW,hW,dW,fW,pW,qD,mW,gW,_W,vW,yW,BT,Vx=vC(()=>{"use strict";UL();_D();Wi=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();ja={log:ET,warn:function(a){Wi.console&&(typeof Wi.console.warn=="function"?Wi.console.warn.apply(Wi.console,arguments):ET.call(null,arguments))},error:function(a){Wi.console&&(typeof Wi.console.error=="function"?Wi.console.error.apply(Wi.console,arguments):ET(a))}};km=Wi.saveAs||((typeof window>"u"?"undefined":Pa(window))!=="object"||window!==Wi?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(a,i,o){var c=Wi.URL||Wi.webkitURL,u=document.createElement("a");i=i||a.name||"download",u.download=i,u.rel="noopener",typeof a=="string"?(u.href=a,u.origin!==location.origin?vD(u.href)?AT(a,i,o):Ox(u,u.target="_blank"):Ox(u)):(u.href=c.createObjectURL(a),setTimeout(function(){c.revokeObjectURL(u.href)},4e4),setTimeout(function(){Ox(u)},0))}:"msSaveOrOpenBlob"in navigator?function(a,i,o){if(i=i||a.name||"download",typeof a=="string")if(vD(a))AT(a,i,o);else{var c=document.createElement("a");c.href=a,c.target="_blank",setTimeout(function(){Ox(c)})}else navigator.msSaveOrOpenBlob(function(u,r){return r===void 0?r={autoBom:!1}:Pa(r)!=="object"&&(ja.warn("Deprecated: Expected third argument to be a object"),r={autoBom:!r}),r.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}(a,o),i)}:function(a,i,o,c){if((c=c||open("","_blank"))&&(c.document.title=c.document.body.innerText="downloading..."),typeof a=="string")return AT(a,i,o);var u=a.type==="application/octet-stream",r=/constructor/i.test(Wi.HTMLElement)||Wi.safari,_=/CriOS\/[\d]+/.test(navigator.userAgent);if((_||u&&r)&&(typeof FileReader>"u"?"undefined":Pa(FileReader))==="object"){var T=new FileReader;T.onloadend=function(){var D=T.result;D=_?D:D.replace(/^data:[^;]*;/,"data:attachment/file;"),c?c.location.href=D:location=D,c=null},T.readAsDataURL(a)}else{var E=Wi.URL||Wi.webkitURL,k=E.createObjectURL(a);c?c.location=k:location.href=k,c=null,setTimeout(function(){E.revokeObjectURL(k)},4e4)}});w1=Wi.atob.bind(Wi),DT=Wi.btoa.bind(Wi);yD="0123456789abcdef".split("");jH=function(a){for(var i=0;i<a.length;i++)a[i]=BH(a[i]);return a.join("")}(OD("hello"))!="5d41402abc4b2a76b9719d911017c592";xD={print:4,modify:8,copy:16,"annot-forms":32};gg.prototype.lsbFirstWord=function(a){return String.fromCharCode(a>>0&255,a>>8&255,a>>16&255,a>>24&255)},gg.prototype.toHexString=function(a){return a.split("").map(function(i){return("0"+(255&i.charCodeAt(0)).toString(16)).slice(-2)}).join("")},gg.prototype.hexToBytes=function(a){for(var i=[],o=0;o<a.length;o+=2)i.push(String.fromCharCode(parseInt(a.substr(o,2),16)));return i.join("")},gg.prototype.processOwnerPassword=function(a,i){return FT(RT(i).substr(0,5),a)},gg.prototype.encryptor=function(a,i){var o=RT(this.encryptionKey+String.fromCharCode(255&a,a>>8&255,a>>16&255,255&i,i>>8&255)).substr(0,10);return function(c){return FT(o,c)}},C1.prototype.equals=function(a){var i,o="id,objectNumber,equals";if(!a||Pa(a)!==Pa(this))return!1;var c=0;for(i in this)if(!(o.indexOf(i)>=0)){if(this.hasOwnProperty(i)&&!a.hasOwnProperty(i)||this[i]!==a[i])return!1;c++}for(i in a)a.hasOwnProperty(i)&&o.indexOf(i)<0&&c--;return c===0},Bi.API={events:[]},Bi.version="2.5.1";Fo=Bi.API,NT=1,Lm=function(a){return a.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},pg=function(a){return a.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},sn=function(a){return a.toFixed(2)},wp=function(a){return a.toFixed(5)};Fo.__acroform__={};mc=function(a,i){a.prototype=Object.create(i.prototype),a.prototype.constructor=a},wD=function(a){return a*NT},dd=function(a){var i=new zD,o=ai.internal.getHeight(a)||0,c=ai.internal.getWidth(a)||0;return i.BBox=[0,0,Number(sn(c)),Number(sn(o))],i},UH=Fo.__acroform__.setBit=function(a,i){if(a=a||0,i=i||0,isNaN(a)||isNaN(i))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return a|=1<<i},VH=Fo.__acroform__.clearBit=function(a,i){if(a=a||0,i=i||0,isNaN(a)||isNaN(i))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return a&=~(1<<i)},GH=Fo.__acroform__.getBit=function(a,i){if(isNaN(a)||isNaN(i))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return a&1<<i?1:0},zo=Fo.__acroform__.getBitForPdf=function(a,i){if(isNaN(a)||isNaN(i))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return GH(a,i-1)},jo=Fo.__acroform__.setBitForPdf=function(a,i){if(isNaN(a)||isNaN(i))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return UH(a,i-1)},Uo=Fo.__acroform__.clearBitForPdf=function(a,i){if(isNaN(a)||isNaN(i))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return VH(a,i-1)},HH=Fo.__acroform__.calculateCoordinates=function(a,i){var o=i.internal.getHorizontalCoordinate,c=i.internal.getVerticalCoordinate,u=a[0],r=a[1],_=a[2],T=a[3],E={};return E.lowerLeft_X=o(u)||0,E.lowerLeft_Y=c(r+T)||0,E.upperRight_X=o(u+_)||0,E.upperRight_Y=c(r)||0,[Number(sn(E.lowerLeft_X)),Number(sn(E.lowerLeft_Y)),Number(sn(E.upperRight_X)),Number(sn(E.upperRight_Y))]},WH=function(a){if(a.appearanceStreamContent)return a.appearanceStreamContent;if(a.V||a.DV){var i=[],o=a._V||a.DV,c=PT(a,o),u=a.scope.internal.getFont(a.fontName,a.fontStyle).id;i.push("/Tx BMC"),i.push("q"),i.push("BT"),i.push(a.scope.__private__.encodeColorString(a.color)),i.push("/"+u+" "+sn(c.fontSize)+" Tf"),i.push("1 0 0 1 0 0 Tm"),i.push(c.text),i.push("ET"),i.push("Q"),i.push("EMC");var r=dd(a);return r.scope=a.scope,r.stream=i.join(`
`),r}},PT=function(a,i){var o=a.fontSize===0?a.maxFontSize:a.fontSize,c={text:"",fontSize:""},u=(i=(i=i.substr(0,1)=="("?i.substr(1):i).substr(i.length-1)==")"?i.substr(0,i.length-1):i).split(" ");u=a.multiline?u.map(function(_e){return _e.split(`
`)}):u.map(function(_e){return[_e]});var r=o,_=ai.internal.getHeight(a)||0;_=_<0?-_:_;var T=ai.internal.getWidth(a)||0;T=T<0?-T:T;var E=function(_e,ve,Qe){if(_e+1<u.length){var Ce=ve+" "+u[_e+1][0];return Nx(Ce,a,Qe).width<=T-4}return!1};r++;e:for(;r>0;){i="",r--;var k,D,j=Nx("3",a,r).height,B=a.multiline?_-r:(_-j)/2,P=B+=2,ee=0,G=0,K=0;if(r<=0){i=`(...) Tj
`,i+="% Width of Text: "+Nx(i,a,r=12).width+", FieldWidth:"+T+`
`;break}for(var J="",ne=0,he=0;he<u.length;he++)if(u.hasOwnProperty(he)){var Me=!1;if(u[he].length!==1&&K!==u[he].length-1){if((j+2)*(ne+2)+2>_)continue e;J+=u[he][K],Me=!0,G=he,he--}else{J=(J+=u[he][K]+" ").substr(J.length-1)==" "?J.substr(0,J.length-1):J;var Re=parseInt(he),et=E(Re,J,r),Te=he>=u.length-1;if(et&&!Te){J+=" ",K=0;continue}if(et||Te){if(Te)G=Re;else if(a.multiline&&(j+2)*(ne+2)+2>_)continue e}else{if(!a.multiline||(j+2)*(ne+2)+2>_)continue e;G=Re}}for(var ge="",Ue=ee;Ue<=G;Ue++){var Ae=u[Ue];if(a.multiline){if(Ue===G){ge+=Ae[K]+" ",K=(K+1)%Ae.length;continue}if(Ue===ee){ge+=Ae[Ae.length-1]+" ";continue}}ge+=Ae[0]+" "}switch(ge=ge.substr(ge.length-1)==" "?ge.substr(0,ge.length-1):ge,D=Nx(ge,a,r).width,a.textAlign){case"right":k=T-D-2;break;case"center":k=(T-D)/2;break;case"left":default:k=2}i+=sn(k)+" "+sn(P)+` Td
`,i+="("+Lm(ge)+`) Tj
`,i+=-sn(k)+` 0 Td
`,P=-(r+2),D=0,ee=Me?G:G+1,ne++,J=""}break}return c.text=i,c.fontSize=r,c},Nx=function(a,i,o){var c=i.scope.internal.getFont(i.fontName,i.fontStyle),u=i.scope.getStringUnitWidth(a,{font:c,fontSize:parseFloat(o),charSpace:0})*parseFloat(o);return{height:i.scope.getStringUnitWidth("3",{font:c,fontSize:parseFloat(o),charSpace:0})*parseFloat(o)*1.5,width:u}},qH={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},$H=function(a,i){var o={type:"reference",object:a};i.internal.getPageInfo(a.page).pageContext.annotations.find(function(c){return c.type===o.type&&c.object===o.object})===void 0&&i.internal.getPageInfo(a.page).pageContext.annotations.push(o)},XH=function(a,i){for(var o in a)if(a.hasOwnProperty(o)){var c=o,u=a[o];i.internal.newObjectDeferredBegin(u.objId,!0),Pa(u)==="object"&&typeof u.putStream=="function"&&u.putStream(),delete a[c]}},ZH=function(a,i){if(i.scope=a,a.internal!==void 0&&(a.internal.acroformPlugin===void 0||a.internal.acroformPlugin.isInitialized===!1)){if(xh.FieldNum=0,a.internal.acroformPlugin=JSON.parse(JSON.stringify(qH)),a.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");NT=a.internal.scaleFactor,a.internal.acroformPlugin.acroFormDictionaryRoot=new jD,a.internal.acroformPlugin.acroFormDictionaryRoot.scope=a,a.internal.acroformPlugin.acroFormDictionaryRoot._eventID=a.internal.events.subscribe("postPutResources",function(){(function(o){o.internal.events.unsubscribe(o.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete o.internal.acroformPlugin.acroFormDictionaryRoot._eventID,o.internal.acroformPlugin.printedOut=!0})(a)}),a.internal.events.subscribe("buildDocument",function(){(function(o){o.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var c=o.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var u in c)if(c.hasOwnProperty(u)){var r=c[u];r.objId=void 0,r.hasAnnotation&&$H(r,o)}})(a)}),a.internal.events.subscribe("putCatalog",function(){(function(o){if(o.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");o.internal.write("/AcroForm "+o.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(a)}),a.internal.events.subscribe("postPutPages",function(o){(function(c,u){var r=!c;for(var _ in c||(u.internal.newObjectDeferredBegin(u.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),u.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),c=c||u.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(c.hasOwnProperty(_)){var T=c[_],E=[],k=T.Rect;if(T.Rect&&(T.Rect=HH(T.Rect,u)),u.internal.newObjectDeferredBegin(T.objId,!0),T.DA=ai.createDefaultAppearanceStream(T),Pa(T)==="object"&&typeof T.getKeyValueListForStream=="function"&&(E=T.getKeyValueListForStream()),T.Rect=k,T.hasAppearanceStream&&!T.appearanceStreamContent){var D=WH(T);E.push({key:"AP",value:"<</N "+D+">>"}),u.internal.acroformPlugin.xForms.push(D)}if(T.appearanceStreamContent){var j="";for(var B in T.appearanceStreamContent)if(T.appearanceStreamContent.hasOwnProperty(B)){var P=T.appearanceStreamContent[B];if(j+="/"+B+" ",j+="<<",Object.keys(P).length>=1||Array.isArray(P)){for(var _ in P)if(P.hasOwnProperty(_)){var ee=P[_];typeof ee=="function"&&(ee=ee.call(u,T)),j+="/"+_+" "+ee+" ",u.internal.acroformPlugin.xForms.indexOf(ee)>=0||u.internal.acroformPlugin.xForms.push(ee)}}else typeof(ee=P)=="function"&&(ee=ee.call(u,T)),j+="/"+_+" "+ee,u.internal.acroformPlugin.xForms.indexOf(ee)>=0||u.internal.acroformPlugin.xForms.push(ee);j+=">>"}E.push({key:"AP",value:`<<
`+j+">>"})}u.internal.putStream({additionalKeyValues:E,objectId:T.objId}),u.internal.out("endobj")}r&&XH(u.internal.acroformPlugin.xForms,u)})(o,a)}),a.internal.acroformPlugin.isInitialized=!0}},BD=Fo.__acroform__.arrayToPdfArray=function(a,i,o){var c=function(_){return _};if(Array.isArray(a)){for(var u="[",r=0;r<a.length;r++)switch(r!==0&&(u+=" "),Pa(a[r])){case"boolean":case"number":case"object":u+=a[r].toString();break;case"string":a[r].substr(0,1)!=="/"?(i!==void 0&&o&&(c=o.internal.getEncryptor(i)),u+="("+Lm(c(a[r].toString()))+")"):u+=a[r].toString()}return u+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},IT=function(a,i,o){var c=function(u){return u};return i!==void 0&&o&&(c=o.internal.getEncryptor(i)),(a=a||"").toString(),a="("+Lm(c(a))+")"},fd=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(a){this._objId=a}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};fd.prototype.toString=function(){return this.objId+" 0 R"},fd.prototype.putStream=function(){var a=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:a,objectId:this.objId}),this.scope.internal.out("endobj")},fd.prototype.getKeyValueListForStream=function(){var a=[],i=Object.getOwnPropertyNames(this).filter(function(r){return r!="content"&&r!="appearanceStreamContent"&&r!="scope"&&r!="objId"&&r.substring(0,1)!="_"});for(var o in i)if(Object.getOwnPropertyDescriptor(this,i[o]).configurable===!1){var c=i[o],u=this[c];u&&(Array.isArray(u)?a.push({key:c,value:BD(u,this.objId,this.scope)}):u instanceof fd?(u.scope=this.scope,a.push({key:c,value:u.objId+" 0 R"})):typeof u!="function"&&a.push({key:c,value:u}))}return a};zD=function(){fd.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var a,i=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return i},set:function(o){i=o}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(o){a=o.trim()},get:function(){return a||null}})};mc(zD,fd);jD=function(){fd.call(this);var a,i=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return i.length>0?i:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return i}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(a){var o=function(c){return c};return this.scope&&(o=this.scope.internal.getEncryptor(this.objId)),"("+Lm(o(a))+")"}},set:function(o){a=o}})};mc(jD,fd);xh=function a(){fd.call(this);var i=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return i},set:function(J){if(isNaN(J))throw new Error('Invalid value "'+J+'" for attribute F supplied.');i=J}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!zo(i,3)},set:function(J){J?this.F=jo(i,3):this.F=Uo(i,3)}});var o=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return o},set:function(J){if(isNaN(J))throw new Error('Invalid value "'+J+'" for attribute Ff supplied.');o=J}});var c=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(c.length!==0)return c},set:function(J){c=J!==void 0?J:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!c||isNaN(c[0])?0:c[0]},set:function(J){c[0]=J}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!c||isNaN(c[1])?0:c[1]},set:function(J){c[1]=J}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!c||isNaN(c[2])?0:c[2]},set:function(J){c[2]=J}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!c||isNaN(c[3])?0:c[3]},set:function(J){c[3]=J}});var u="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return u},set:function(J){switch(J){case"/Btn":case"/Tx":case"/Ch":case"/Sig":u=J;break;default:throw new Error('Invalid value "'+J+'" for attribute FT supplied.')}}});var r=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!r||r.length<1){if(this instanceof jx)return;r="FieldObject"+a.FieldNum++}var J=function(ne){return ne};return this.scope&&(J=this.scope.internal.getEncryptor(this.objId)),"("+Lm(J(r))+")"},set:function(J){r=J.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return r},set:function(J){r=J}});var _="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return _},set:function(J){_=J}});var T="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return T},set:function(J){T=J}});var E=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return E},set:function(J){E=J}});var k=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return k===void 0?50/NT:k},set:function(J){k=J}});var D="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return D},set:function(J){D=J}});var j="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!j||this instanceof jx||this instanceof Ep))return IT(j,this.objId,this.scope)},set:function(J){J=J.toString(),j=J}});var B=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(B)return this instanceof ps?B:IT(B,this.objId,this.scope)},set:function(J){J=J.toString(),B=this instanceof ps?J:J.substr(0,1)==="("?pg(J.substr(1,J.length-2)):pg(J)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ps?pg(B.substr(1,B.length-1)):B},set:function(J){J=J.toString(),B=this instanceof ps?"/"+J:J}});var P=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(P)return P},set:function(J){this.V=J}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(P)return this instanceof ps?P:IT(P,this.objId,this.scope)},set:function(J){J=J.toString(),P=this instanceof ps?J:J.substr(0,1)==="("?pg(J.substr(1,J.length-2)):pg(J)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ps?pg(P.substr(1,P.length-1)):P},set:function(J){J=J.toString(),P=this instanceof ps?"/"+J:J}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var ee,G=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return G},set:function(J){J=!!J,G=J}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(ee)return ee},set:function(J){ee=J}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!zo(this.Ff,1)},set:function(J){J?this.Ff=jo(this.Ff,1):this.Ff=Uo(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!zo(this.Ff,2)},set:function(J){J?this.Ff=jo(this.Ff,2):this.Ff=Uo(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!zo(this.Ff,3)},set:function(J){J?this.Ff=jo(this.Ff,3):this.Ff=Uo(this.Ff,3)}});var K=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(K!==null)return K},set:function(J){if([0,1,2].indexOf(J)===-1)throw new Error('Invalid value "'+J+'" for attribute Q supplied.');K=J}}),Object.defineProperty(this,"textAlign",{get:function(){var J;switch(K){case 0:default:J="left";break;case 1:J="center";break;case 2:J="right"}return J},configurable:!0,enumerable:!0,set:function(J){switch(J){case"right":case 2:K=2;break;case"center":case 1:K=1;break;case"left":case 0:default:K=0}}})};mc(xh,fd);Dm=function(){xh.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var a=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return a},set:function(o){a=o}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return a},set:function(o){a=o}});var i=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return BD(i,this.objId,this.scope)},set:function(o){var c,u;u=[],typeof(c=o)=="string"&&(u=function(r,_,T){T||(T=1);for(var E,k=[];E=_.exec(r);)k.push(E[T]);return k}(c,/\((.*?)\)/g)),i=u}}),this.getOptions=function(){return i},this.setOptions=function(o){i=o,this.sort&&i.sort()},this.addOption=function(o){o=(o=o||"").toString(),i.push(o),this.sort&&i.sort()},this.removeOption=function(o,c){for(c=c||!1,o=(o=o||"").toString();i.indexOf(o)!==-1&&(i.splice(i.indexOf(o),1),c!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!zo(this.Ff,18)},set:function(o){o?this.Ff=jo(this.Ff,18):this.Ff=Uo(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!zo(this.Ff,19)},set:function(o){this.combo===!0&&(o?this.Ff=jo(this.Ff,19):this.Ff=Uo(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!zo(this.Ff,20)},set:function(o){o?(this.Ff=jo(this.Ff,20),i.sort()):this.Ff=Uo(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!zo(this.Ff,22)},set:function(o){o?this.Ff=jo(this.Ff,22):this.Ff=Uo(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!zo(this.Ff,23)},set:function(o){o?this.Ff=jo(this.Ff,23):this.Ff=Uo(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!zo(this.Ff,27)},set:function(o){o?this.Ff=jo(this.Ff,27):this.Ff=Uo(this.Ff,27)}}),this.hasAppearanceStream=!1};mc(Dm,xh);Rm=function(){Dm.call(this),this.fontName="helvetica",this.combo=!1};mc(Rm,Dm);Fm=function(){Rm.call(this),this.combo=!0};mc(Fm,Rm);T1=function(){Fm.call(this),this.edit=!0};mc(T1,Fm);ps=function(){xh.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!zo(this.Ff,15)},set:function(o){o?this.Ff=jo(this.Ff,15):this.Ff=Uo(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!zo(this.Ff,16)},set:function(o){o?this.Ff=jo(this.Ff,16):this.Ff=Uo(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!zo(this.Ff,17)},set:function(o){o?this.Ff=jo(this.Ff,17):this.Ff=Uo(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!zo(this.Ff,26)},set:function(o){o?this.Ff=jo(this.Ff,26):this.Ff=Uo(this.Ff,26)}});var a,i={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var o=function(r){return r};if(this.scope&&(o=this.scope.internal.getEncryptor(this.objId)),Object.keys(i).length!==0){var c,u=[];for(c in u.push("<<"),i)u.push("/"+c+" ("+Lm(o(i[c]))+")");return u.push(">>"),u.join(`
`)}},set:function(o){Pa(o)==="object"&&(i=o)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return i.CA||""},set:function(o){typeof o=="string"&&(i.CA=o)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return a},set:function(o){a=o}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return a.substr(1,a.length-1)},set:function(o){a="/"+o}})};mc(ps,xh);S1=function(){ps.call(this),this.pushButton=!0};mc(S1,ps);Pm=function(){ps.call(this),this.radio=!0,this.pushButton=!1;var a=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return a},set:function(i){a=i!==void 0?i:[]}})};mc(Pm,ps);jx=function(){var a,i;xh.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return a},set:function(u){a=u}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return i},set:function(u){i=u}});var o,c={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var u=function(T){return T};this.scope&&(u=this.scope.internal.getEncryptor(this.objId));var r,_=[];for(r in _.push("<<"),c)_.push("/"+r+" ("+Lm(u(c[r]))+")");return _.push(">>"),_.join(`
`)},set:function(u){Pa(u)==="object"&&(c=u)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return c.CA||""},set:function(u){typeof u=="string"&&(c.CA=u)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return o},set:function(u){o=u}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return o.substr(1,o.length-1)},set:function(u){o="/"+u}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ai.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};mc(jx,xh),Pm.prototype.setAppearance=function(a){if(!("createAppearanceStream"in a)||!("getCA"in a))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var i in this.Kids)if(this.Kids.hasOwnProperty(i)){var o=this.Kids[i];o.appearanceStreamContent=a.createAppearanceStream(o.optionName),o.caption=a.getCA()}},Pm.prototype.createOption=function(a){var i=new jx;return i.Parent=this,i.optionName=a,this.Kids.push(i),YH.call(this.scope,i),i};E1=function(){ps.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ai.CheckBox.createAppearanceStream()};mc(E1,ps);Ep=function(){xh.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!zo(this.Ff,13)},set:function(i){i?this.Ff=jo(this.Ff,13):this.Ff=Uo(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!zo(this.Ff,21)},set:function(i){i?this.Ff=jo(this.Ff,21):this.Ff=Uo(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!zo(this.Ff,23)},set:function(i){i?this.Ff=jo(this.Ff,23):this.Ff=Uo(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!zo(this.Ff,24)},set:function(i){i?this.Ff=jo(this.Ff,24):this.Ff=Uo(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!zo(this.Ff,25)},set:function(i){i?this.Ff=jo(this.Ff,25):this.Ff=Uo(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!zo(this.Ff,26)},set:function(i){i?this.Ff=jo(this.Ff,26):this.Ff=Uo(this.Ff,26)}});var a=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return a},set:function(i){a=i}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return a},set:function(i){Number.isInteger(i)&&(a=i)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};mc(Ep,xh);A1=function(){Ep.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!zo(this.Ff,14)},set:function(a){a?this.Ff=jo(this.Ff,14):this.Ff=Uo(this.Ff,14)}}),this.password=!0};mc(A1,Ep);ai={CheckBox:{createAppearanceStream:function(){return{N:{On:ai.CheckBox.YesNormal},D:{On:ai.CheckBox.YesPushDown,Off:ai.CheckBox.OffPushDown}}},YesPushDown:function(a){var i=dd(a);i.scope=a.scope;var o=[],c=a.scope.internal.getFont(a.fontName,a.fontStyle).id,u=a.scope.__private__.encodeColorString(a.color),r=PT(a,a.caption);return o.push("0.749023 g"),o.push("0 0 "+sn(ai.internal.getWidth(a))+" "+sn(ai.internal.getHeight(a))+" re"),o.push("f"),o.push("BMC"),o.push("q"),o.push("0 0 1 rg"),o.push("/"+c+" "+sn(r.fontSize)+" Tf "+u),o.push("BT"),o.push(r.text),o.push("ET"),o.push("Q"),o.push("EMC"),i.stream=o.join(`
`),i},YesNormal:function(a){var i=dd(a);i.scope=a.scope;var o=a.scope.internal.getFont(a.fontName,a.fontStyle).id,c=a.scope.__private__.encodeColorString(a.color),u=[],r=ai.internal.getHeight(a),_=ai.internal.getWidth(a),T=PT(a,a.caption);return u.push("1 g"),u.push("0 0 "+sn(_)+" "+sn(r)+" re"),u.push("f"),u.push("q"),u.push("0 0 1 rg"),u.push("0 0 "+sn(_-1)+" "+sn(r-1)+" re"),u.push("W"),u.push("n"),u.push("0 g"),u.push("BT"),u.push("/"+o+" "+sn(T.fontSize)+" Tf "+c),u.push(T.text),u.push("ET"),u.push("Q"),i.stream=u.join(`
`),i},OffPushDown:function(a){var i=dd(a);i.scope=a.scope;var o=[];return o.push("0.749023 g"),o.push("0 0 "+sn(ai.internal.getWidth(a))+" "+sn(ai.internal.getHeight(a))+" re"),o.push("f"),i.stream=o.join(`
`),i}},RadioButton:{Circle:{createAppearanceStream:function(a){var i={D:{Off:ai.RadioButton.Circle.OffPushDown},N:{}};return i.N[a]=ai.RadioButton.Circle.YesNormal,i.D[a]=ai.RadioButton.Circle.YesPushDown,i},getCA:function(){return"l"},YesNormal:function(a){var i=dd(a);i.scope=a.scope;var o=[],c=ai.internal.getWidth(a)<=ai.internal.getHeight(a)?ai.internal.getWidth(a)/4:ai.internal.getHeight(a)/4;c=Number((.9*c).toFixed(5));var u=ai.internal.Bezier_C,r=Number((c*u).toFixed(5));return o.push("q"),o.push("1 0 0 1 "+wp(ai.internal.getWidth(a)/2)+" "+wp(ai.internal.getHeight(a)/2)+" cm"),o.push(c+" 0 m"),o.push(c+" "+r+" "+r+" "+c+" 0 "+c+" c"),o.push("-"+r+" "+c+" -"+c+" "+r+" -"+c+" 0 c"),o.push("-"+c+" -"+r+" -"+r+" -"+c+" 0 -"+c+" c"),o.push(r+" -"+c+" "+c+" -"+r+" "+c+" 0 c"),o.push("f"),o.push("Q"),i.stream=o.join(`
`),i},YesPushDown:function(a){var i=dd(a);i.scope=a.scope;var o=[],c=ai.internal.getWidth(a)<=ai.internal.getHeight(a)?ai.internal.getWidth(a)/4:ai.internal.getHeight(a)/4;c=Number((.9*c).toFixed(5));var u=Number((2*c).toFixed(5)),r=Number((u*ai.internal.Bezier_C).toFixed(5)),_=Number((c*ai.internal.Bezier_C).toFixed(5));return o.push("0.749023 g"),o.push("q"),o.push("1 0 0 1 "+wp(ai.internal.getWidth(a)/2)+" "+wp(ai.internal.getHeight(a)/2)+" cm"),o.push(u+" 0 m"),o.push(u+" "+r+" "+r+" "+u+" 0 "+u+" c"),o.push("-"+r+" "+u+" -"+u+" "+r+" -"+u+" 0 c"),o.push("-"+u+" -"+r+" -"+r+" -"+u+" 0 -"+u+" c"),o.push(r+" -"+u+" "+u+" -"+r+" "+u+" 0 c"),o.push("f"),o.push("Q"),o.push("0 g"),o.push("q"),o.push("1 0 0 1 "+wp(ai.internal.getWidth(a)/2)+" "+wp(ai.internal.getHeight(a)/2)+" cm"),o.push(c+" 0 m"),o.push(c+" "+_+" "+_+" "+c+" 0 "+c+" c"),o.push("-"+_+" "+c+" -"+c+" "+_+" -"+c+" 0 c"),o.push("-"+c+" -"+_+" -"+_+" -"+c+" 0 -"+c+" c"),o.push(_+" -"+c+" "+c+" -"+_+" "+c+" 0 c"),o.push("f"),o.push("Q"),i.stream=o.join(`
`),i},OffPushDown:function(a){var i=dd(a);i.scope=a.scope;var o=[],c=ai.internal.getWidth(a)<=ai.internal.getHeight(a)?ai.internal.getWidth(a)/4:ai.internal.getHeight(a)/4;c=Number((.9*c).toFixed(5));var u=Number((2*c).toFixed(5)),r=Number((u*ai.internal.Bezier_C).toFixed(5));return o.push("0.749023 g"),o.push("q"),o.push("1 0 0 1 "+wp(ai.internal.getWidth(a)/2)+" "+wp(ai.internal.getHeight(a)/2)+" cm"),o.push(u+" 0 m"),o.push(u+" "+r+" "+r+" "+u+" 0 "+u+" c"),o.push("-"+r+" "+u+" -"+u+" "+r+" -"+u+" 0 c"),o.push("-"+u+" -"+r+" -"+r+" -"+u+" 0 -"+u+" c"),o.push(r+" -"+u+" "+u+" -"+r+" "+u+" 0 c"),o.push("f"),o.push("Q"),i.stream=o.join(`
`),i}},Cross:{createAppearanceStream:function(a){var i={D:{Off:ai.RadioButton.Cross.OffPushDown},N:{}};return i.N[a]=ai.RadioButton.Cross.YesNormal,i.D[a]=ai.RadioButton.Cross.YesPushDown,i},getCA:function(){return"8"},YesNormal:function(a){var i=dd(a);i.scope=a.scope;var o=[],c=ai.internal.calculateCross(a);return o.push("q"),o.push("1 1 "+sn(ai.internal.getWidth(a)-2)+" "+sn(ai.internal.getHeight(a)-2)+" re"),o.push("W"),o.push("n"),o.push(sn(c.x1.x)+" "+sn(c.x1.y)+" m"),o.push(sn(c.x2.x)+" "+sn(c.x2.y)+" l"),o.push(sn(c.x4.x)+" "+sn(c.x4.y)+" m"),o.push(sn(c.x3.x)+" "+sn(c.x3.y)+" l"),o.push("s"),o.push("Q"),i.stream=o.join(`
`),i},YesPushDown:function(a){var i=dd(a);i.scope=a.scope;var o=ai.internal.calculateCross(a),c=[];return c.push("0.749023 g"),c.push("0 0 "+sn(ai.internal.getWidth(a))+" "+sn(ai.internal.getHeight(a))+" re"),c.push("f"),c.push("q"),c.push("1 1 "+sn(ai.internal.getWidth(a)-2)+" "+sn(ai.internal.getHeight(a)-2)+" re"),c.push("W"),c.push("n"),c.push(sn(o.x1.x)+" "+sn(o.x1.y)+" m"),c.push(sn(o.x2.x)+" "+sn(o.x2.y)+" l"),c.push(sn(o.x4.x)+" "+sn(o.x4.y)+" m"),c.push(sn(o.x3.x)+" "+sn(o.x3.y)+" l"),c.push("s"),c.push("Q"),i.stream=c.join(`
`),i},OffPushDown:function(a){var i=dd(a);i.scope=a.scope;var o=[];return o.push("0.749023 g"),o.push("0 0 "+sn(ai.internal.getWidth(a))+" "+sn(ai.internal.getHeight(a))+" re"),o.push("f"),i.stream=o.join(`
`),i}}},createDefaultAppearanceStream:function(a){var i=a.scope.internal.getFont(a.fontName,a.fontStyle).id,o=a.scope.__private__.encodeColorString(a.color);return"/"+i+" "+a.fontSize+" Tf "+o}};ai.internal={Bezier_C:.551915024494,calculateCross:function(a){var i=ai.internal.getWidth(a),o=ai.internal.getHeight(a),c=Math.min(i,o);return{x1:{x:(i-c)/2,y:(o-c)/2+c},x2:{x:(i-c)/2+c,y:(o-c)/2},x3:{x:(i-c)/2,y:(o-c)/2},x4:{x:(i-c)/2+c,y:(o-c)/2+c}}}},ai.internal.getWidth=function(a){var i=0;return Pa(a)==="object"&&(i=wD(a.Rect[2])),i},ai.internal.getHeight=function(a){var i=0;return Pa(a)==="object"&&(i=wD(a.Rect[3])),i};YH=Fo.addField=function(a){if(ZH(this,a),!(a instanceof xh))throw new Error("Invalid argument passed to jsPDF.addField.");var i;return(i=a).scope.internal.acroformPlugin.printedOut&&(i.scope.internal.acroformPlugin.printedOut=!1,i.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),i.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(i),a.page=a.scope.internal.getCurrentPageInfo().pageNumber,this};Fo.AcroFormChoiceField=Dm,Fo.AcroFormListBox=Rm,Fo.AcroFormComboBox=Fm,Fo.AcroFormEditBox=T1,Fo.AcroFormButton=ps,Fo.AcroFormPushButton=S1,Fo.AcroFormRadioButton=Pm,Fo.AcroFormCheckBox=E1,Fo.AcroFormTextField=Ep,Fo.AcroFormPasswordField=A1,Fo.AcroFormAppearance=ai,Fo.AcroForm={ChoiceField:Dm,ListBox:Rm,ComboBox:Fm,EditBox:T1,Button:ps,PushButton:S1,RadioButton:Pm,CheckBox:E1,TextField:Ep,PasswordField:A1,Appearance:ai},Bi.AcroForm={ChoiceField:Dm,ListBox:Rm,ComboBox:Fm,EditBox:T1,Button:ps,PushButton:S1,RadioButton:Pm,CheckBox:E1,TextField:Ep,PasswordField:A1,Appearance:ai};KH=Bi.AcroForm;(function(a){a.__addimage__={};var i="UNKNOWN",o={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},c=a.__addimage__.getImageFileTypeByImageData=function(_e,ve){var Qe,Ce,Ye,ut,st,pt=i;if((ve=ve||i)==="RGBA"||_e.data!==void 0&&_e.data instanceof Uint8ClampedArray&&"height"in _e&&"width"in _e)return"RGBA";if(et(_e))for(st in o)for(Ye=o[st],Qe=0;Qe<Ye.length;Qe+=1){for(ut=!0,Ce=0;Ce<Ye[Qe].length;Ce+=1)if(Ye[Qe][Ce]!==void 0&&Ye[Qe][Ce]!==_e[Ce]){ut=!1;break}if(ut===!0){pt=st;break}}else for(st in o)for(Ye=o[st],Qe=0;Qe<Ye.length;Qe+=1){for(ut=!0,Ce=0;Ce<Ye[Qe].length;Ce+=1)if(Ye[Qe][Ce]!==void 0&&Ye[Qe][Ce]!==_e.charCodeAt(Ce)){ut=!1;break}if(ut===!0){pt=st;break}}return pt===i&&ve!==i&&(pt=ve),pt},u=function _e(ve){for(var Qe=this.internal.write,Ce=this.internal.putStream,Ye=(0,this.internal.getFilters)();Ye.indexOf("FlateEncode")!==-1;)Ye.splice(Ye.indexOf("FlateEncode"),1);ve.objectId=this.internal.newObject();var ut=[];if(ut.push({key:"Type",value:"/XObject"}),ut.push({key:"Subtype",value:"/Image"}),ut.push({key:"Width",value:ve.width}),ut.push({key:"Height",value:ve.height}),ve.colorSpace===K.INDEXED?ut.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(ve.palette.length/3-1)+" "+("sMask"in ve&&ve.sMask!==void 0?ve.objectId+2:ve.objectId+1)+" 0 R]"}):(ut.push({key:"ColorSpace",value:"/"+ve.colorSpace}),ve.colorSpace===K.DEVICE_CMYK&&ut.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ut.push({key:"BitsPerComponent",value:ve.bitsPerComponent}),"decodeParameters"in ve&&ve.decodeParameters!==void 0&&ut.push({key:"DecodeParms",value:"<<"+ve.decodeParameters+">>"}),"transparency"in ve&&Array.isArray(ve.transparency)){for(var st="",pt=0,Tt=ve.transparency.length;pt<Tt;pt++)st+=ve.transparency[pt]+" "+ve.transparency[pt]+" ";ut.push({key:"Mask",value:"["+st+"]"})}ve.sMask!==void 0&&ut.push({key:"SMask",value:ve.objectId+1+" 0 R"});var ht=ve.filter!==void 0?["/"+ve.filter]:void 0;if(Ce({data:ve.data,additionalKeyValues:ut,alreadyAppliedFilters:ht,objectId:ve.objectId}),Qe("endobj"),"sMask"in ve&&ve.sMask!==void 0){var Wt="/Predictor "+ve.predictor+" /Colors 1 /BitsPerComponent "+ve.bitsPerComponent+" /Columns "+ve.width,re={width:ve.width,height:ve.height,colorSpace:"DeviceGray",bitsPerComponent:ve.bitsPerComponent,decodeParameters:Wt,data:ve.sMask};"filter"in ve&&(re.filter=ve.filter),_e.call(this,re)}if(ve.colorSpace===K.INDEXED){var xe=this.internal.newObject();Ce({data:ge(new Uint8Array(ve.palette)),objectId:xe}),Qe("endobj")}},r=function(){var _e=this.internal.collections.addImage_images;for(var ve in _e)u.call(this,_e[ve])},_=function(){var _e,ve=this.internal.collections.addImage_images,Qe=this.internal.write;for(var Ce in ve)Qe("/I"+(_e=ve[Ce]).index,_e.objectId,"0","R")},T=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",r),this.internal.events.subscribe("putXobjectDict",_))},E=function(){var _e=this.internal.collections.addImage_images;return T.call(this),_e},k=function(){return Object.keys(this.internal.collections.addImage_images).length},D=function(_e){return typeof a["process"+_e.toUpperCase()]=="function"},j=function(_e){return Pa(_e)==="object"&&_e.nodeType===1},B=function(_e,ve){if(_e.nodeName==="IMG"&&_e.hasAttribute("src")){var Qe=""+_e.getAttribute("src");if(Qe.indexOf("data:image/")===0)return w1(unescape(Qe).split("base64,").pop());var Ce=a.loadFile(Qe,!0);if(Ce!==void 0)return Ce}if(_e.nodeName==="CANVAS"){if(_e.width===0||_e.height===0)throw new Error("Given canvas must have data. Canvas width: "+_e.width+", height: "+_e.height);var Ye;switch(ve){case"PNG":Ye="image/png";break;case"WEBP":Ye="image/webp";break;case"JPEG":case"JPG":default:Ye="image/jpeg"}return w1(_e.toDataURL(Ye,1).split("base64,").pop())}},P=function(_e){var ve=this.internal.collections.addImage_images;if(ve){for(var Qe in ve)if(_e===ve[Qe].alias)return ve[Qe]}},ee=function(_e,ve,Qe){return _e||ve||(_e=-96,ve=-96),_e<0&&(_e=-1*Qe.width*72/_e/this.internal.scaleFactor),ve<0&&(ve=-1*Qe.height*72/ve/this.internal.scaleFactor),_e===0&&(_e=ve*Qe.width/Qe.height),ve===0&&(ve=_e*Qe.height/Qe.width),[_e,ve]},G=function(_e,ve,Qe,Ce,Ye,ut){var st=ee.call(this,Qe,Ce,Ye),pt=this.internal.getCoordinateString,Tt=this.internal.getVerticalCoordinateString,ht=E.call(this);if(Qe=st[0],Ce=st[1],ht[Ye.index]=Ye,ut){ut*=Math.PI/180;var Wt=Math.cos(ut),re=Math.sin(ut),xe=function(Ie){return Ie.toFixed(4)},pe=[xe(Wt),xe(re),xe(-1*re),xe(Wt),0,0,"cm"]}this.internal.write("q"),ut?(this.internal.write([1,"0","0",1,pt(_e),Tt(ve+Ce),"cm"].join(" ")),this.internal.write(pe.join(" ")),this.internal.write([pt(Qe),"0","0",pt(Ce),"0","0","cm"].join(" "))):this.internal.write([pt(Qe),"0","0",pt(Ce),pt(_e),Tt(ve+Ce),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Ye.index+" Do"),this.internal.write("Q")},K=a.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};a.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var J=a.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},ne=a.__addimage__.sHashCode=function(_e){var ve,Qe,Ce=0;if(typeof _e=="string")for(Qe=_e.length,ve=0;ve<Qe;ve++)Ce=(Ce<<5)-Ce+_e.charCodeAt(ve),Ce|=0;else if(et(_e))for(Qe=_e.byteLength/2,ve=0;ve<Qe;ve++)Ce=(Ce<<5)-Ce+_e[ve],Ce|=0;return Ce},he=a.__addimage__.validateStringAsBase64=function(_e){(_e=_e||"").toString().trim();var ve=!0;return _e.length===0&&(ve=!1),_e.length%4!=0&&(ve=!1),/^[A-Za-z0-9+/]+$/.test(_e.substr(0,_e.length-2))===!1&&(ve=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(_e.substr(-2))===!1&&(ve=!1),ve},Me=a.__addimage__.extractImageFromDataUrl=function(_e){var ve=(_e=_e||"").split("base64,"),Qe=null;if(ve.length===2){var Ce=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(ve[0]);Array.isArray(Ce)&&(Qe={mimeType:Ce[1],charset:Ce[2],data:ve[1]})}return Qe},Re=a.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};a.__addimage__.isArrayBuffer=function(_e){return Re()&&_e instanceof ArrayBuffer};var et=a.__addimage__.isArrayBufferView=function(_e){return Re()&&typeof Uint32Array<"u"&&(_e instanceof Int8Array||_e instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&_e instanceof Uint8ClampedArray||_e instanceof Int16Array||_e instanceof Uint16Array||_e instanceof Int32Array||_e instanceof Uint32Array||_e instanceof Float32Array||_e instanceof Float64Array)},Te=a.__addimage__.binaryStringToUint8Array=function(_e){for(var ve=_e.length,Qe=new Uint8Array(ve),Ce=0;Ce<ve;Ce++)Qe[Ce]=_e.charCodeAt(Ce);return Qe},ge=a.__addimage__.arrayBufferToBinaryString=function(_e){for(var ve="",Qe=et(_e)?_e:new Uint8Array(_e),Ce=0;Ce<Qe.length;Ce+=8192)ve+=String.fromCharCode.apply(null,Qe.subarray(Ce,Ce+8192));return ve};a.addImage=function(){var _e,ve,Qe,Ce,Ye,ut,st,pt,Tt;if(typeof arguments[1]=="number"?(ve=i,Qe=arguments[1],Ce=arguments[2],Ye=arguments[3],ut=arguments[4],st=arguments[5],pt=arguments[6],Tt=arguments[7]):(ve=arguments[1],Qe=arguments[2],Ce=arguments[3],Ye=arguments[4],ut=arguments[5],st=arguments[6],pt=arguments[7],Tt=arguments[8]),Pa(_e=arguments[0])==="object"&&!j(_e)&&"imageData"in _e){var ht=_e;_e=ht.imageData,ve=ht.format||ve||i,Qe=ht.x||Qe||0,Ce=ht.y||Ce||0,Ye=ht.w||ht.width||Ye,ut=ht.h||ht.height||ut,st=ht.alias||st,pt=ht.compression||pt,Tt=ht.rotation||ht.angle||Tt}var Wt=this.internal.getFilters();if(pt===void 0&&Wt.indexOf("FlateEncode")!==-1&&(pt="SLOW"),isNaN(Qe)||isNaN(Ce))throw new Error("Invalid coordinates passed to jsPDF.addImage");T.call(this);var re=Ue.call(this,_e,ve,st,pt);return G.call(this,Qe,Ce,Ye,ut,re,Tt),this};var Ue=function(_e,ve,Qe,Ce){var Ye,ut,st;if(typeof _e=="string"&&c(_e)===i){_e=unescape(_e);var pt=Ae(_e,!1);(pt!==""||(pt=a.loadFile(_e,!0))!==void 0)&&(_e=pt)}if(j(_e)&&(_e=B(_e,ve)),ve=c(_e,ve),!D(ve))throw new Error("addImage does not support files of type '"+ve+"', please ensure that a plugin for '"+ve+"' support is added.");if(((st=Qe)==null||st.length===0)&&(Qe=function(Tt){return typeof Tt=="string"||et(Tt)?ne(Tt):et(Tt.data)?ne(Tt.data):null}(_e)),(Ye=P.call(this,Qe))||(Re()&&(_e instanceof Uint8Array||ve==="RGBA"||(ut=_e,_e=Te(_e))),Ye=this["process"+ve.toUpperCase()](_e,k.call(this),Qe,function(Tt){return Tt&&typeof Tt=="string"&&(Tt=Tt.toUpperCase()),Tt in a.image_compression?Tt:J.NONE}(Ce),ut)),!Ye)throw new Error("An unknown error occurred whilst processing the image.");return Ye},Ae=a.__addimage__.convertBase64ToBinaryString=function(_e,ve){var Qe;ve=typeof ve!="boolean"||ve;var Ce,Ye="";if(typeof _e=="string"){Ce=(Qe=Me(_e))!==null?Qe.data:_e;try{Ye=w1(Ce)}catch(ut){if(ve)throw he(Ce)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ut.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Ye};a.getImageProperties=function(_e){var ve,Qe,Ce="";if(j(_e)&&(_e=B(_e)),typeof _e=="string"&&c(_e)===i&&((Ce=Ae(_e,!1))===""&&(Ce=a.loadFile(_e)||""),_e=Ce),Qe=c(_e),!D(Qe))throw new Error("addImage does not support files of type '"+Qe+"', please ensure that a plugin for '"+Qe+"' support is added.");if(!Re()||_e instanceof Uint8Array||(_e=Te(_e)),!(ve=this["process"+Qe.toUpperCase()](_e)))throw new Error("An unknown error occurred whilst processing the image");return ve.fileType=Qe,ve}})(Bi.API),function(a){var i=function(o){if(o!==void 0&&o!="")return!0};Bi.API.events.push(["addPage",function(o){this.internal.getPageInfo(o.pageNumber).pageContext.annotations=[]}]),a.events.push(["putPage",function(o){for(var c,u,r,_=this.internal.getCoordinateString,T=this.internal.getVerticalCoordinateString,E=this.internal.getPageInfoByObjId(o.objId),k=o.pageContext.annotations,D=!1,j=0;j<k.length&&!D;j++)switch((c=k[j]).type){case"link":(i(c.options.url)||i(c.options.pageNumber))&&(D=!0);break;case"reference":case"text":case"freetext":D=!0}if(D!=0){this.internal.write("/Annots [");for(var B=0;B<k.length;B++){c=k[B];var P=this.internal.pdfEscape,ee=this.internal.getEncryptor(o.objId);switch(c.type){case"reference":this.internal.write(" "+c.object.objId+" 0 R ");break;case"text":var G=this.internal.newAdditionalObject(),K=this.internal.newAdditionalObject(),J=this.internal.getEncryptor(G.objId),ne=c.title||"Note";r="<</Type /Annot /Subtype /Text "+(u="/Rect ["+_(c.bounds.x)+" "+T(c.bounds.y+c.bounds.h)+" "+_(c.bounds.x+c.bounds.w)+" "+T(c.bounds.y)+"] ")+"/Contents ("+P(J(c.contents))+")",r+=" /Popup "+K.objId+" 0 R",r+=" /P "+E.objId+" 0 R",r+=" /T ("+P(J(ne))+") >>",G.content=r;var he=G.objId+" 0 R";r="<</Type /Annot /Subtype /Popup "+(u="/Rect ["+_(c.bounds.x+30)+" "+T(c.bounds.y+c.bounds.h)+" "+_(c.bounds.x+c.bounds.w+30)+" "+T(c.bounds.y)+"] ")+" /Parent "+he,c.open&&(r+=" /Open true"),r+=" >>",K.content=r,this.internal.write(G.objId,"0 R",K.objId,"0 R");break;case"freetext":u="/Rect ["+_(c.bounds.x)+" "+T(c.bounds.y)+" "+_(c.bounds.x+c.bounds.w)+" "+T(c.bounds.y+c.bounds.h)+"] ";var Me=c.color||"#000000";r="<</Type /Annot /Subtype /FreeText "+u+"/Contents ("+P(ee(c.contents))+")",r+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+Me+")",r+=" /Border [0 0 0]",r+=" >>",this.internal.write(r);break;case"link":if(c.options.name){var Re=this.annotations._nameMap[c.options.name];c.options.pageNumber=Re.page,c.options.top=Re.y}else c.options.top||(c.options.top=0);if(u="/Rect ["+c.finalBounds.x+" "+c.finalBounds.y+" "+c.finalBounds.w+" "+c.finalBounds.h+"] ",r="",c.options.url)r="<</Type /Annot /Subtype /Link "+u+"/Border [0 0 0] /A <</S /URI /URI ("+P(ee(c.options.url))+") >>";else if(c.options.pageNumber)switch(r="<</Type /Annot /Subtype /Link "+u+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(c.options.pageNumber).objId+" 0 R",c.options.magFactor=c.options.magFactor||"XYZ",c.options.magFactor){case"Fit":r+=" /Fit]";break;case"FitH":r+=" /FitH "+c.options.top+"]";break;case"FitV":c.options.left=c.options.left||0,r+=" /FitV "+c.options.left+"]";break;case"XYZ":default:var et=T(c.options.top);c.options.left=c.options.left||0,c.options.zoom===void 0&&(c.options.zoom=0),r+=" /XYZ "+c.options.left+" "+et+" "+c.options.zoom+"]"}r!=""&&(r+=" >>",this.internal.write(r))}}this.internal.write("]")}}]),a.createAnnotation=function(o){var c=this.internal.getCurrentPageInfo();switch(o.type){case"link":this.link(o.bounds.x,o.bounds.y,o.bounds.w,o.bounds.h,o);break;case"text":case"freetext":c.pageContext.annotations.push(o)}},a.link=function(o,c,u,r,_){var T=this.internal.getCurrentPageInfo(),E=this.internal.getCoordinateString,k=this.internal.getVerticalCoordinateString;T.pageContext.annotations.push({finalBounds:{x:E(o),y:k(c),w:E(o+u),h:k(c+r)},options:_,type:"link"})},a.textWithLink=function(o,c,u,r){var _,T,E=this.getTextWidth(o),k=this.internal.getLineHeight()/this.internal.scaleFactor;if(r.maxWidth!==void 0){T=r.maxWidth;var D=this.splitTextToSize(o,T).length;_=Math.ceil(k*D)}else T=E,_=k;return this.text(o,c,u,r),u+=.2*k,r.align==="center"&&(c-=E/2),r.align==="right"&&(c-=E),this.link(c,u-k,T,_,r),E},a.getTextWidth=function(o){var c=this.internal.getFontSize();return this.getStringUnitWidth(o)*c/this.internal.scaleFactor}}(Bi.API),function(a){var i={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},o={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},c={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},u=[1570,1571,1573,1575];a.__arabicParser__={};var r=a.__arabicParser__.isInArabicSubstitutionA=function(G){return i[G.charCodeAt(0)]!==void 0},_=a.__arabicParser__.isArabicLetter=function(G){return typeof G=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(G)},T=a.__arabicParser__.isArabicEndLetter=function(G){return _(G)&&r(G)&&i[G.charCodeAt(0)].length<=2},E=a.__arabicParser__.isArabicAlfLetter=function(G){return _(G)&&u.indexOf(G.charCodeAt(0))>=0};a.__arabicParser__.arabicLetterHasIsolatedForm=function(G){return _(G)&&r(G)&&i[G.charCodeAt(0)].length>=1};var k=a.__arabicParser__.arabicLetterHasFinalForm=function(G){return _(G)&&r(G)&&i[G.charCodeAt(0)].length>=2};a.__arabicParser__.arabicLetterHasInitialForm=function(G){return _(G)&&r(G)&&i[G.charCodeAt(0)].length>=3};var D=a.__arabicParser__.arabicLetterHasMedialForm=function(G){return _(G)&&r(G)&&i[G.charCodeAt(0)].length==4},j=a.__arabicParser__.resolveLigatures=function(G){var K=0,J=o,ne="",he=0;for(K=0;K<G.length;K+=1)J[G.charCodeAt(K)]!==void 0?(he++,typeof(J=J[G.charCodeAt(K)])=="number"&&(ne+=String.fromCharCode(J),J=o,he=0),K===G.length-1&&(J=o,ne+=G.charAt(K-(he-1)),K-=he-1,he=0)):(J=o,ne+=G.charAt(K-he),K-=he,he=0);return ne};a.__arabicParser__.isArabicDiacritic=function(G){return G!==void 0&&c[G.charCodeAt(0)]!==void 0};var B=a.__arabicParser__.getCorrectForm=function(G,K,J){return _(G)?r(G)===!1?-1:!k(G)||!_(K)&&!_(J)||!_(J)&&T(K)||T(G)&&!_(K)||T(G)&&E(K)||T(G)&&T(K)?0:D(G)&&_(K)&&!T(K)&&_(J)&&k(J)?3:T(G)||!_(J)?1:2:-1},P=function(G){var K=0,J=0,ne=0,he="",Me="",Re="",et=(G=G||"").split("\\s+"),Te=[];for(K=0;K<et.length;K+=1){for(Te.push(""),J=0;J<et[K].length;J+=1)he=et[K][J],Me=et[K][J-1],Re=et[K][J+1],_(he)?(ne=B(he,Me,Re),Te[K]+=ne!==-1?String.fromCharCode(i[he.charCodeAt(0)][ne]):he):Te[K]+=he;Te[K]=j(Te[K])}return Te.join(" ")},ee=a.__arabicParser__.processArabic=a.processArabic=function(){var G,K=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,J=[];if(Array.isArray(K)){var ne=0;for(J=[],ne=0;ne<K.length;ne+=1)Array.isArray(K[ne])?J.push([P(K[ne][0]),K[ne][1],K[ne][2]]):J.push([P(K[ne])]);G=J}else G=P(K);return typeof arguments[0]=="string"?G:(arguments[0].text=G,arguments[0])};a.events.push(["preProcessText",ee])}(Bi.API),Bi.API.autoPrint=function(a){var i;switch((a=a||{}).variant=a.variant||"non-conform",a.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){i=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+i+" 0 R")})}return this},function(a){var i=function(){var o=void 0;Object.defineProperty(this,"pdf",{get:function(){return o},set:function(T){o=T}});var c=150;Object.defineProperty(this,"width",{get:function(){return c},set:function(T){c=isNaN(T)||Number.isInteger(T)===!1||T<0?150:T,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=c+1)}});var u=300;Object.defineProperty(this,"height",{get:function(){return u},set:function(T){u=isNaN(T)||Number.isInteger(T)===!1||T<0?300:T,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=u+1)}});var r=[];Object.defineProperty(this,"childNodes",{get:function(){return r},set:function(T){r=T}});var _={};Object.defineProperty(this,"style",{get:function(){return _},set:function(T){_=T}}),Object.defineProperty(this,"parentNode",{})};i.prototype.getContext=function(o,c){var u;if((o=o||"2d")!=="2d")return null;for(u in c)this.pdf.context2d.hasOwnProperty(u)&&(this.pdf.context2d[u]=c[u]);return this.pdf.context2d._canvas=this,this.pdf.context2d},i.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},a.events.push(["initialized",function(){this.canvas=new i,this.canvas.pdf=this}])}(Bi.API),function(a){var i={left:0,top:0,bottom:0,right:0},o=!1,c=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},i),this.internal.__cell__.margins.width=this.getPageWidth(),u.call(this))},u=function(){this.internal.__cell__.lastCell=new r,this.internal.__cell__.pages=1},r=function(){var E=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return E},set:function(G){E=G}});var k=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return k},set:function(G){k=G}});var D=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return D},set:function(G){D=G}});var j=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return j},set:function(G){j=G}});var B=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return B},set:function(G){B=G}});var P=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return P},set:function(G){P=G}});var ee=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return ee},set:function(G){ee=G}}),this};r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},r.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},a.setHeaderFunction=function(E){return c.call(this),this.internal.__cell__.headerFunction=typeof E=="function"?E:void 0,this},a.getTextDimensions=function(E,k){c.call(this);var D=(k=k||{}).fontSize||this.getFontSize(),j=k.font||this.getFont(),B=k.scaleFactor||this.internal.scaleFactor,P=0,ee=0,G=0,K=this;if(!Array.isArray(E)&&typeof E!="string"){if(typeof E!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");E=String(E)}var J=k.maxWidth;J>0?typeof E=="string"?E=this.splitTextToSize(E,J):Object.prototype.toString.call(E)==="[object Array]"&&(E=E.reduce(function(he,Me){return he.concat(K.splitTextToSize(Me,J))},[])):E=Array.isArray(E)?E:[E];for(var ne=0;ne<E.length;ne++)P<(G=this.getStringUnitWidth(E[ne],{font:j})*D)&&(P=G);return P!==0&&(ee=E.length),{w:P/=B,h:Math.max((ee*D*this.getLineHeightFactor()-D*(this.getLineHeightFactor()-1))/B,0)}},a.cellAddPage=function(){c.call(this),this.addPage();var E=this.internal.__cell__.margins||i;return this.internal.__cell__.lastCell=new r(E.left,E.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var _=a.cell=function(){var E;E=arguments[0]instanceof r?arguments[0]:new r(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),c.call(this);var k=this.internal.__cell__.lastCell,D=this.internal.__cell__.padding,j=this.internal.__cell__.margins||i,B=this.internal.__cell__.tableHeaderRow,P=this.internal.__cell__.printHeaders;return k.lineNumber!==void 0&&(k.lineNumber===E.lineNumber?(E.x=(k.x||0)+(k.width||0),E.y=k.y||0):k.y+k.height+E.height+j.bottom>this.getPageHeight()?(this.cellAddPage(),E.y=j.top,P&&B&&(this.printHeaderRow(E.lineNumber,!0),E.y+=B[0].height)):E.y=k.y+k.height||E.y),E.text[0]!==void 0&&(this.rect(E.x,E.y,E.width,E.height,o===!0?"FD":void 0),E.align==="right"?this.text(E.text,E.x+E.width-D,E.y+D,{align:"right",baseline:"top"}):E.align==="center"?this.text(E.text,E.x+E.width/2,E.y+D,{align:"center",baseline:"top",maxWidth:E.width-D-D}):this.text(E.text,E.x+D,E.y+D,{align:"left",baseline:"top",maxWidth:E.width-D-D})),this.internal.__cell__.lastCell=E,this};a.table=function(E,k,D,j,B){if(c.call(this),!D)throw new Error("No data for PDF table.");var P,ee,G,K,J=[],ne=[],he=[],Me={},Re={},et=[],Te=[],ge=(B=B||{}).autoSize||!1,Ue=B.printHeaders!==!1,Ae=B.css&&B.css["font-size"]!==void 0?16*B.css["font-size"]:B.fontSize||12,_e=B.margins||Object.assign({width:this.getPageWidth()},i),ve=typeof B.padding=="number"?B.padding:3,Qe=B.headerBackgroundColor||"#c8c8c8",Ce=B.headerTextColor||"#000";if(u.call(this),this.internal.__cell__.printHeaders=Ue,this.internal.__cell__.margins=_e,this.internal.__cell__.table_font_size=Ae,this.internal.__cell__.padding=ve,this.internal.__cell__.headerBackgroundColor=Qe,this.internal.__cell__.headerTextColor=Ce,this.setFontSize(Ae),j==null)ne=J=Object.keys(D[0]),he=J.map(function(){return"left"});else if(Array.isArray(j)&&Pa(j[0])==="object")for(J=j.map(function(ht){return ht.name}),ne=j.map(function(ht){return ht.prompt||ht.name||""}),he=j.map(function(ht){return ht.align||"left"}),P=0;P<j.length;P+=1)Re[j[P].name]=j[P].width*(19.049976/25.4);else Array.isArray(j)&&typeof j[0]=="string"&&(ne=J=j,he=J.map(function(){return"left"}));if(ge||Array.isArray(j)&&typeof j[0]=="string")for(P=0;P<J.length;P+=1){for(Me[K=J[P]]=D.map(function(ht){return ht[K]}),this.setFont(void 0,"bold"),et.push(this.getTextDimensions(ne[P],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),ee=Me[K],this.setFont(void 0,"normal"),G=0;G<ee.length;G+=1)et.push(this.getTextDimensions(ee[G],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);Re[K]=Math.max.apply(null,et)+ve+ve,et=[]}if(Ue){var Ye={};for(P=0;P<J.length;P+=1)Ye[J[P]]={},Ye[J[P]].text=ne[P],Ye[J[P]].align=he[P];var ut=T.call(this,Ye,Re);Te=J.map(function(ht){return new r(E,k,Re[ht],ut,Ye[ht].text,void 0,Ye[ht].align)}),this.setTableHeaderRow(Te),this.printHeaderRow(1,!1)}var st=j.reduce(function(ht,Wt){return ht[Wt.name]=Wt.align,ht},{});for(P=0;P<D.length;P+=1){"rowStart"in B&&B.rowStart instanceof Function&&B.rowStart({row:P,data:D[P]},this);var pt=T.call(this,D[P],Re);for(G=0;G<J.length;G+=1){var Tt=D[P][J[G]];"cellStart"in B&&B.cellStart instanceof Function&&B.cellStart({row:P,col:G,data:Tt},this),_.call(this,new r(E,k,Re[J[G]],pt,Tt,P+2,st[J[G]]))}}return this.internal.__cell__.table_x=E,this.internal.__cell__.table_y=k,this};var T=function(E,k){var D=this.internal.__cell__.padding,j=this.internal.__cell__.table_font_size,B=this.internal.scaleFactor;return Object.keys(E).map(function(P){var ee=E[P];return this.splitTextToSize(ee.hasOwnProperty("text")?ee.text:ee,k[P]-D-D)},this).map(function(P){return this.getLineHeightFactor()*P.length*j/B+D+D},this).reduce(function(P,ee){return Math.max(P,ee)},0)};a.setTableHeaderRow=function(E){c.call(this),this.internal.__cell__.tableHeaderRow=E},a.printHeaderRow=function(E,k){if(c.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var D;if(o=!0,typeof this.internal.__cell__.headerFunction=="function"){var j=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new r(j[0],j[1],j[2],j[3],void 0,-1)}this.setFont(void 0,"bold");for(var B=[],P=0;P<this.internal.__cell__.tableHeaderRow.length;P+=1){D=this.internal.__cell__.tableHeaderRow[P].clone(),k&&(D.y=this.internal.__cell__.margins.top||0,B.push(D)),D.lineNumber=E;var ee=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),_.call(this,D),this.setTextColor(ee)}B.length>0&&this.setTableHeaderRow(B),this.setFont(void 0,"normal"),o=!1}}(Bi.API);VD={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},GD=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],LT=UD(GD),HD=[100,200,300,400,500,600,700,800,900],JH=UD(HD);QH={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},SD={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};kT=["times"];(function(a){var i,o,c,u,r,_,T,E,k,D=function(re){return re=re||{},this.isStrokeTransparent=re.isStrokeTransparent||!1,this.strokeOpacity=re.strokeOpacity||1,this.strokeStyle=re.strokeStyle||"#000000",this.fillStyle=re.fillStyle||"#000000",this.isFillTransparent=re.isFillTransparent||!1,this.fillOpacity=re.fillOpacity||1,this.font=re.font||"10px sans-serif",this.textBaseline=re.textBaseline||"alphabetic",this.textAlign=re.textAlign||"left",this.lineWidth=re.lineWidth||1,this.lineJoin=re.lineJoin||"miter",this.lineCap=re.lineCap||"butt",this.path=re.path||[],this.transform=re.transform!==void 0?re.transform.clone():new E,this.globalCompositeOperation=re.globalCompositeOperation||"normal",this.globalAlpha=re.globalAlpha||1,this.clip_path=re.clip_path||[],this.currentPoint=re.currentPoint||new _,this.miterLimit=re.miterLimit||10,this.lastPoint=re.lastPoint||new _,this.lineDashOffset=re.lineDashOffset||0,this.lineDash=re.lineDash||[],this.margin=re.margin||[0,0,0,0],this.prevPageLastElemOffset=re.prevPageLastElemOffset||0,this.ignoreClearRect=typeof re.ignoreClearRect!="boolean"||re.ignoreClearRect,this};a.events.push(["initialized",function(){this.context2d=new j(this),i=this.internal.f2,o=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,u=this.internal.getHorizontalCoordinate,r=this.internal.getVerticalCoordinate,_=this.internal.Point,T=this.internal.Rectangle,E=this.internal.Matrix,k=new D}]);var j=function(re){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var xe=re;Object.defineProperty(this,"pdf",{get:function(){return xe}});var pe=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return pe},set:function($t){pe=!!$t}});var Ie=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Ie},set:function($t){Ie=!!$t}});var Ve=0;Object.defineProperty(this,"posX",{get:function(){return Ve},set:function($t){isNaN($t)||(Ve=$t)}});var gt=0;Object.defineProperty(this,"posY",{get:function(){return gt},set:function($t){isNaN($t)||(gt=$t)}}),Object.defineProperty(this,"margin",{get:function(){return k.margin},set:function($t){var lt;typeof $t=="number"?lt=[$t,$t,$t,$t]:((lt=new Array(4))[0]=$t[0],lt[1]=$t.length>=2?$t[1]:lt[0],lt[2]=$t.length>=3?$t[2]:lt[0],lt[3]=$t.length>=4?$t[3]:lt[1]),k.margin=lt}});var mt=!1;Object.defineProperty(this,"autoPaging",{get:function(){return mt},set:function($t){mt=$t}});var wt=0;Object.defineProperty(this,"lastBreak",{get:function(){return wt},set:function($t){wt=$t}});var Pt=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Pt},set:function($t){Pt=$t}}),Object.defineProperty(this,"ctx",{get:function(){return k},set:function($t){$t instanceof D&&(k=$t)}}),Object.defineProperty(this,"path",{get:function(){return k.path},set:function($t){k.path=$t}});var fr=[];Object.defineProperty(this,"ctxStack",{get:function(){return fr},set:function($t){fr=$t}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function($t){var lt;lt=B($t),this.ctx.fillStyle=lt.style,this.ctx.isFillTransparent=lt.a===0,this.ctx.fillOpacity=lt.a,this.pdf.setFillColor(lt.r,lt.g,lt.b,{a:lt.a}),this.pdf.setTextColor(lt.r,lt.g,lt.b,{a:lt.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function($t){var lt=B($t);this.ctx.strokeStyle=lt.style,this.ctx.isStrokeTransparent=lt.a===0,this.ctx.strokeOpacity=lt.a,lt.a===0?this.pdf.setDrawColor(255,255,255):(lt.a,this.pdf.setDrawColor(lt.r,lt.g,lt.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function($t){["butt","round","square"].indexOf($t)!==-1&&(this.ctx.lineCap=$t,this.pdf.setLineCap($t))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function($t){isNaN($t)||(this.ctx.lineWidth=$t,this.pdf.setLineWidth($t))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function($t){["bevel","round","miter"].indexOf($t)!==-1&&(this.ctx.lineJoin=$t,this.pdf.setLineJoin($t))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function($t){isNaN($t)||(this.ctx.miterLimit=$t,this.pdf.setMiterLimit($t))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function($t){this.ctx.textBaseline=$t}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function($t){["right","end","center","left","start"].indexOf($t)!==-1&&(this.ctx.textAlign=$t)}});var xr=null;function Rr($t,lt){if(xr===null){var Bt=function(nr){var br=[];return Object.keys(nr).forEach(function(kr){nr[kr].forEach(function(Nr){var Br=null;switch(Nr){case"bold":Br={family:kr,weight:"bold"};break;case"italic":Br={family:kr,style:"italic"};break;case"bolditalic":Br={family:kr,weight:"bold",style:"italic"};break;case"":case"normal":Br={family:kr}}Br!==null&&(Br.ref={name:kr,style:Nr},br.push(Br))})}),br}($t.getFontList());xr=function(nr){for(var br={},kr=0;kr<nr.length;++kr){var Nr=OT(nr[kr]),Br=Nr.family,ii=Nr.stretch,si=Nr.style,wi=Nr.weight;br[Br]=br[Br]||{},br[Br][ii]=br[Br][ii]||{},br[Br][ii][si]=br[Br][ii][si]||{},br[Br][ii][si][wi]=Nr}return br}(Bt.concat(lt))}return xr}var Fr=null;Object.defineProperty(this,"fontFaces",{get:function(){return Fr},set:function($t){xr=null,Fr=$t}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function($t){var lt;if(this.ctx.font=$t,(lt=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec($t))!==null){var Bt=lt[1],nr=(lt[2],lt[3]),br=lt[4],kr=(lt[5],lt[6]),Nr=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(br)[2];br=Math.floor(Nr==="px"?parseFloat(br)*this.pdf.internal.scaleFactor:Nr==="em"?parseFloat(br)*this.pdf.getFontSize():parseFloat(br)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(br);var Br=function(xi){var Ui,Lr,Ua=[],Dr=xi.trim();if(Dr==="")return kT;if(Dr in SD)return[SD[Dr]];for(;Dr!=="";){switch(Lr=null,Ui=(Dr=AD(Dr)).charAt(0)){case'"':case"'":Lr=tW(Dr.substring(1),Ui);break;default:Lr=rW(Dr)}if(Lr===null||(Ua.push(Lr[0]),(Dr=AD(Lr[1]))!==""&&Dr.charAt(0)!==","))return kT;Dr=Dr.replace(/^,/,"")}return Ua}(kr);if(this.fontFaces){var ii=eW(Rr(this.pdf,this.fontFaces),Br.map(function(xi){return{family:xi,stretch:"normal",weight:nr,style:Bt}}));this.pdf.setFont(ii.ref.name,ii.ref.style)}else{var si="";(nr==="bold"||parseInt(nr,10)>=700||Bt==="bold")&&(si="bold"),Bt==="italic"&&(si+="italic"),si.length===0&&(si="normal");for(var wi="",Ri={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ji=0;Ji<Br.length;Ji++){if(this.pdf.internal.getFont(Br[Ji],si,{noFallback:!0,disableWarning:!0})!==void 0){wi=Br[Ji];break}if(si==="bolditalic"&&this.pdf.internal.getFont(Br[Ji],"bold",{noFallback:!0,disableWarning:!0})!==void 0)wi=Br[Ji],si="bold";else if(this.pdf.internal.getFont(Br[Ji],"normal",{noFallback:!0,disableWarning:!0})!==void 0){wi=Br[Ji],si="normal";break}}if(wi===""){for(var an=0;an<Br.length;an++)if(Ri[Br[an]]){wi=Ri[Br[an]];break}}wi=wi===""?"Times":wi,this.pdf.setFont(wi,si)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function($t){this.ctx.globalCompositeOperation=$t}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function($t){this.ctx.globalAlpha=$t}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function($t){this.ctx.lineDashOffset=$t,Wt.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function($t){this.ctx.lineDash=$t,Wt.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function($t){this.ctx.ignoreClearRect=!!$t}})};j.prototype.setLineDash=function(re){this.lineDash=re},j.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},j.prototype.fill=function(){Me.call(this,"fill",!1)},j.prototype.stroke=function(){Me.call(this,"stroke",!1)},j.prototype.beginPath=function(){this.path=[{type:"begin"}]},j.prototype.moveTo=function(re,xe){if(isNaN(re)||isNaN(xe))throw ja.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var pe=this.ctx.transform.applyToPoint(new _(re,xe));this.path.push({type:"mt",x:pe.x,y:pe.y}),this.ctx.lastPoint=new _(re,xe)},j.prototype.closePath=function(){var re=new _(0,0),xe=0;for(xe=this.path.length-1;xe!==-1;xe--)if(this.path[xe].type==="begin"&&Pa(this.path[xe+1])==="object"&&typeof this.path[xe+1].x=="number"){re=new _(this.path[xe+1].x,this.path[xe+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new _(re.x,re.y)},j.prototype.lineTo=function(re,xe){if(isNaN(re)||isNaN(xe))throw ja.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var pe=this.ctx.transform.applyToPoint(new _(re,xe));this.path.push({type:"lt",x:pe.x,y:pe.y}),this.ctx.lastPoint=new _(pe.x,pe.y)},j.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),Me.call(this,null,!0)},j.prototype.quadraticCurveTo=function(re,xe,pe,Ie){if(isNaN(pe)||isNaN(Ie)||isNaN(re)||isNaN(xe))throw ja.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Ve=this.ctx.transform.applyToPoint(new _(pe,Ie)),gt=this.ctx.transform.applyToPoint(new _(re,xe));this.path.push({type:"qct",x1:gt.x,y1:gt.y,x:Ve.x,y:Ve.y}),this.ctx.lastPoint=new _(Ve.x,Ve.y)},j.prototype.bezierCurveTo=function(re,xe,pe,Ie,Ve,gt){if(isNaN(Ve)||isNaN(gt)||isNaN(re)||isNaN(xe)||isNaN(pe)||isNaN(Ie))throw ja.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var mt=this.ctx.transform.applyToPoint(new _(Ve,gt)),wt=this.ctx.transform.applyToPoint(new _(re,xe)),Pt=this.ctx.transform.applyToPoint(new _(pe,Ie));this.path.push({type:"bct",x1:wt.x,y1:wt.y,x2:Pt.x,y2:Pt.y,x:mt.x,y:mt.y}),this.ctx.lastPoint=new _(mt.x,mt.y)},j.prototype.arc=function(re,xe,pe,Ie,Ve,gt){if(isNaN(re)||isNaN(xe)||isNaN(pe)||isNaN(Ie)||isNaN(Ve))throw ja.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(gt=!!gt,!this.ctx.transform.isIdentity){var mt=this.ctx.transform.applyToPoint(new _(re,xe));re=mt.x,xe=mt.y;var wt=this.ctx.transform.applyToPoint(new _(0,pe)),Pt=this.ctx.transform.applyToPoint(new _(0,0));pe=Math.sqrt(Math.pow(wt.x-Pt.x,2)+Math.pow(wt.y-Pt.y,2))}Math.abs(Ve-Ie)>=2*Math.PI&&(Ie=0,Ve=2*Math.PI),this.path.push({type:"arc",x:re,y:xe,radius:pe,startAngle:Ie,endAngle:Ve,counterclockwise:gt})},j.prototype.arcTo=function(re,xe,pe,Ie,Ve){throw new Error("arcTo not implemented.")},j.prototype.rect=function(re,xe,pe,Ie){if(isNaN(re)||isNaN(xe)||isNaN(pe)||isNaN(Ie))throw ja.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(re,xe),this.lineTo(re+pe,xe),this.lineTo(re+pe,xe+Ie),this.lineTo(re,xe+Ie),this.lineTo(re,xe),this.lineTo(re+pe,xe),this.lineTo(re,xe)},j.prototype.fillRect=function(re,xe,pe,Ie){if(isNaN(re)||isNaN(xe)||isNaN(pe)||isNaN(Ie))throw ja.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!P.call(this)){var Ve={};this.lineCap!=="butt"&&(Ve.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Ve.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(re,xe,pe,Ie),this.fill(),Ve.hasOwnProperty("lineCap")&&(this.lineCap=Ve.lineCap),Ve.hasOwnProperty("lineJoin")&&(this.lineJoin=Ve.lineJoin)}},j.prototype.strokeRect=function(re,xe,pe,Ie){if(isNaN(re)||isNaN(xe)||isNaN(pe)||isNaN(Ie))throw ja.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");ee.call(this)||(this.beginPath(),this.rect(re,xe,pe,Ie),this.stroke())},j.prototype.clearRect=function(re,xe,pe,Ie){if(isNaN(re)||isNaN(xe)||isNaN(pe)||isNaN(Ie))throw ja.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(re,xe,pe,Ie))},j.prototype.save=function(re){re=typeof re!="boolean"||re;for(var xe=this.pdf.internal.getCurrentPageInfo().pageNumber,pe=0;pe<this.pdf.internal.getNumberOfPages();pe++)this.pdf.setPage(pe+1),this.pdf.internal.out("q");if(this.pdf.setPage(xe),re){this.ctx.fontSize=this.pdf.internal.getFontSize();var Ie=new D(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Ie}},j.prototype.restore=function(re){re=typeof re!="boolean"||re;for(var xe=this.pdf.internal.getCurrentPageInfo().pageNumber,pe=0;pe<this.pdf.internal.getNumberOfPages();pe++)this.pdf.setPage(pe+1),this.pdf.internal.out("Q");this.pdf.setPage(xe),re&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},j.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var B=function(re){var xe,pe,Ie,Ve;if(re.isCanvasGradient===!0&&(re=re.getColor()),!re)return{r:0,g:0,b:0,a:0,style:re};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(re))xe=0,pe=0,Ie=0,Ve=0;else{var gt=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(re);if(gt!==null)xe=parseInt(gt[1]),pe=parseInt(gt[2]),Ie=parseInt(gt[3]),Ve=1;else if((gt=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(re))!==null)xe=parseInt(gt[1]),pe=parseInt(gt[2]),Ie=parseInt(gt[3]),Ve=parseFloat(gt[4]);else{if(Ve=1,typeof re=="string"&&re.charAt(0)!=="#"){var mt=new LD(re);re=mt.ok?mt.toHex():"#000000"}re.length===4?(xe=re.substring(1,2),xe+=xe,pe=re.substring(2,3),pe+=pe,Ie=re.substring(3,4),Ie+=Ie):(xe=re.substring(1,3),pe=re.substring(3,5),Ie=re.substring(5,7)),xe=parseInt(xe,16),pe=parseInt(pe,16),Ie=parseInt(Ie,16)}}return{r:xe,g:pe,b:Ie,a:Ve,style:re}},P=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},ee=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};j.prototype.fillText=function(re,xe,pe,Ie){if(isNaN(xe)||isNaN(pe)||typeof re!="string")throw ja.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Ie=isNaN(Ie)?void 0:Ie,!P.call(this)){var Ve=pt(this.ctx.transform.rotation),gt=this.ctx.transform.scaleX;ve.call(this,{text:re,x:xe,y:pe,scale:gt,angle:Ve,align:this.textAlign,maxWidth:Ie})}},j.prototype.strokeText=function(re,xe,pe,Ie){if(isNaN(xe)||isNaN(pe)||typeof re!="string")throw ja.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!ee.call(this)){Ie=isNaN(Ie)?void 0:Ie;var Ve=pt(this.ctx.transform.rotation),gt=this.ctx.transform.scaleX;ve.call(this,{text:re,x:xe,y:pe,scale:gt,renderingMode:"stroke",angle:Ve,align:this.textAlign,maxWidth:Ie})}},j.prototype.measureText=function(re){if(typeof re!="string")throw ja.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var xe=this.pdf,pe=this.pdf.internal.scaleFactor,Ie=xe.internal.getFontSize(),Ve=xe.getStringUnitWidth(re)*Ie/xe.internal.scaleFactor,gt=function(mt){var wt=(mt=mt||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return wt}}),this};return new gt({width:Ve*=Math.round(96*pe/72*1e4)/1e4})},j.prototype.scale=function(re,xe){if(isNaN(re)||isNaN(xe))throw ja.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var pe=new E(re,0,0,xe,0,0);this.ctx.transform=this.ctx.transform.multiply(pe)},j.prototype.rotate=function(re){if(isNaN(re))throw ja.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var xe=new E(Math.cos(re),Math.sin(re),-Math.sin(re),Math.cos(re),0,0);this.ctx.transform=this.ctx.transform.multiply(xe)},j.prototype.translate=function(re,xe){if(isNaN(re)||isNaN(xe))throw ja.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var pe=new E(1,0,0,1,re,xe);this.ctx.transform=this.ctx.transform.multiply(pe)},j.prototype.transform=function(re,xe,pe,Ie,Ve,gt){if(isNaN(re)||isNaN(xe)||isNaN(pe)||isNaN(Ie)||isNaN(Ve)||isNaN(gt))throw ja.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var mt=new E(re,xe,pe,Ie,Ve,gt);this.ctx.transform=this.ctx.transform.multiply(mt)},j.prototype.setTransform=function(re,xe,pe,Ie,Ve,gt){re=isNaN(re)?1:re,xe=isNaN(xe)?0:xe,pe=isNaN(pe)?0:pe,Ie=isNaN(Ie)?1:Ie,Ve=isNaN(Ve)?0:Ve,gt=isNaN(gt)?0:gt,this.ctx.transform=new E(re,xe,pe,Ie,Ve,gt)};var G=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};j.prototype.drawImage=function(re,xe,pe,Ie,Ve,gt,mt,wt,Pt){var fr=this.pdf.getImageProperties(re),xr=1,Rr=1,Fr=1,$t=1;Ie!==void 0&&wt!==void 0&&(Fr=wt/Ie,$t=Pt/Ve,xr=fr.width/Ie*wt/Ie,Rr=fr.height/Ve*Pt/Ve),gt===void 0&&(gt=xe,mt=pe,xe=0,pe=0),Ie!==void 0&&wt===void 0&&(wt=Ie,Pt=Ve),Ie===void 0&&wt===void 0&&(wt=fr.width,Pt=fr.height);for(var lt,Bt=this.ctx.transform.decompose(),nr=pt(Bt.rotate.shx),br=new E,kr=(br=(br=(br=br.multiply(Bt.translate)).multiply(Bt.skew)).multiply(Bt.scale)).applyToRectangle(new T(gt-xe*Fr,mt-pe*$t,Ie*xr,Ve*Rr)),Nr=K.call(this,kr),Br=[],ii=0;ii<Nr.length;ii+=1)Br.indexOf(Nr[ii])===-1&&Br.push(Nr[ii]);if(he(Br),this.autoPaging)for(var si=Br[0],wi=Br[Br.length-1],Ri=si;Ri<wi+1;Ri++){this.pdf.setPage(Ri);var Ji=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],an=Ri===1?this.posY+this.margin[0]:this.margin[0],xi=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ui=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Lr=Ri===1?0:xi+(Ri-2)*Ui;if(this.ctx.clip_path.length!==0){var Ua=this.path;lt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ne(lt,this.posX+this.margin[3],-Lr+an+this.ctx.prevPageLastElemOffset),Re.call(this,"fill",!0),this.path=Ua}var Dr=JSON.parse(JSON.stringify(kr));Dr=ne([Dr],this.posX+this.margin[3],-Lr+an+this.ctx.prevPageLastElemOffset)[0];var Eo=(Ri>si||Ri<wi)&&G.call(this);Eo&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ji,Ui,null).clip().discardPath()),this.pdf.addImage(re,"JPEG",Dr.x,Dr.y,Dr.w,Dr.h,null,null,nr),Eo&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(re,"JPEG",kr.x,kr.y,kr.w,kr.h,null,null,nr)};var K=function(re,xe,pe){var Ie=[];xe=xe||this.pdf.internal.pageSize.width,pe=pe||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Ve=this.posY+this.ctx.prevPageLastElemOffset;switch(re.type){default:case"mt":case"lt":Ie.push(Math.floor((re.y+Ve)/pe)+1);break;case"arc":Ie.push(Math.floor((re.y+Ve-re.radius)/pe)+1),Ie.push(Math.floor((re.y+Ve+re.radius)/pe)+1);break;case"qct":var gt=Tt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,re.x1,re.y1,re.x,re.y);Ie.push(Math.floor((gt.y+Ve)/pe)+1),Ie.push(Math.floor((gt.y+gt.h+Ve)/pe)+1);break;case"bct":var mt=ht(this.ctx.lastPoint.x,this.ctx.lastPoint.y,re.x1,re.y1,re.x2,re.y2,re.x,re.y);Ie.push(Math.floor((mt.y+Ve)/pe)+1),Ie.push(Math.floor((mt.y+mt.h+Ve)/pe)+1);break;case"rect":Ie.push(Math.floor((re.y+Ve)/pe)+1),Ie.push(Math.floor((re.y+re.h+Ve)/pe)+1)}for(var wt=0;wt<Ie.length;wt+=1)for(;this.pdf.internal.getNumberOfPages()<Ie[wt];)J.call(this);return Ie},J=function(){var re=this.fillStyle,xe=this.strokeStyle,pe=this.font,Ie=this.lineCap,Ve=this.lineWidth,gt=this.lineJoin;this.pdf.addPage(),this.fillStyle=re,this.strokeStyle=xe,this.font=pe,this.lineCap=Ie,this.lineWidth=Ve,this.lineJoin=gt},ne=function(re,xe,pe){for(var Ie=0;Ie<re.length;Ie++)switch(re[Ie].type){case"bct":re[Ie].x2+=xe,re[Ie].y2+=pe;case"qct":re[Ie].x1+=xe,re[Ie].y1+=pe;case"mt":case"lt":case"arc":default:re[Ie].x+=xe,re[Ie].y+=pe}return re},he=function(re){return re.sort(function(xe,pe){return xe-pe})},Me=function(re,xe){for(var pe,Ie,Ve=this.fillStyle,gt=this.strokeStyle,mt=this.lineCap,wt=this.lineWidth,Pt=Math.abs(wt*this.ctx.transform.scaleX),fr=this.lineJoin,xr=JSON.parse(JSON.stringify(this.path)),Rr=JSON.parse(JSON.stringify(this.path)),Fr=[],$t=0;$t<Rr.length;$t++)if(Rr[$t].x!==void 0)for(var lt=K.call(this,Rr[$t]),Bt=0;Bt<lt.length;Bt+=1)Fr.indexOf(lt[Bt])===-1&&Fr.push(lt[Bt]);for(var nr=0;nr<Fr.length;nr++)for(;this.pdf.internal.getNumberOfPages()<Fr[nr];)J.call(this);if(he(Fr),this.autoPaging)for(var br=Fr[0],kr=Fr[Fr.length-1],Nr=br;Nr<kr+1;Nr++){this.pdf.setPage(Nr),this.fillStyle=Ve,this.strokeStyle=gt,this.lineCap=mt,this.lineWidth=Pt,this.lineJoin=fr;var Br=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ii=Nr===1?this.posY+this.margin[0]:this.margin[0],si=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],wi=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ri=Nr===1?0:si+(Nr-2)*wi;if(this.ctx.clip_path.length!==0){var Ji=this.path;pe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ne(pe,this.posX+this.margin[3],-Ri+ii+this.ctx.prevPageLastElemOffset),Re.call(this,re,!0),this.path=Ji}if(Ie=JSON.parse(JSON.stringify(xr)),this.path=ne(Ie,this.posX+this.margin[3],-Ri+ii+this.ctx.prevPageLastElemOffset),xe===!1||Nr===0){var an=(Nr>br||Nr<kr)&&G.call(this);an&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Br,wi,null).clip().discardPath()),Re.call(this,re,xe),an&&this.pdf.restoreGraphicsState()}this.lineWidth=wt}else this.lineWidth=Pt,Re.call(this,re,xe),this.lineWidth=wt;this.path=xr},Re=function(re,xe){if((re!=="stroke"||xe||!ee.call(this))&&(re==="stroke"||xe||!P.call(this))){for(var pe,Ie,Ve=[],gt=this.path,mt=0;mt<gt.length;mt++){var wt=gt[mt];switch(wt.type){case"begin":Ve.push({begin:!0});break;case"close":Ve.push({close:!0});break;case"mt":Ve.push({start:wt,deltas:[],abs:[]});break;case"lt":var Pt=Ve.length;if(gt[mt-1]&&!isNaN(gt[mt-1].x)&&(pe=[wt.x-gt[mt-1].x,wt.y-gt[mt-1].y],Pt>0)){for(;Pt>=0;Pt--)if(Ve[Pt-1].close!==!0&&Ve[Pt-1].begin!==!0){Ve[Pt-1].deltas.push(pe),Ve[Pt-1].abs.push(wt);break}}break;case"bct":pe=[wt.x1-gt[mt-1].x,wt.y1-gt[mt-1].y,wt.x2-gt[mt-1].x,wt.y2-gt[mt-1].y,wt.x-gt[mt-1].x,wt.y-gt[mt-1].y],Ve[Ve.length-1].deltas.push(pe);break;case"qct":var fr=gt[mt-1].x+2/3*(wt.x1-gt[mt-1].x),xr=gt[mt-1].y+2/3*(wt.y1-gt[mt-1].y),Rr=wt.x+2/3*(wt.x1-wt.x),Fr=wt.y+2/3*(wt.y1-wt.y),$t=wt.x,lt=wt.y;pe=[fr-gt[mt-1].x,xr-gt[mt-1].y,Rr-gt[mt-1].x,Fr-gt[mt-1].y,$t-gt[mt-1].x,lt-gt[mt-1].y],Ve[Ve.length-1].deltas.push(pe);break;case"arc":Ve.push({deltas:[],abs:[],arc:!0}),Array.isArray(Ve[Ve.length-1].abs)&&Ve[Ve.length-1].abs.push(wt)}}Ie=xe?null:re==="stroke"?"stroke":"fill";for(var Bt=!1,nr=0;nr<Ve.length;nr++)if(Ve[nr].arc)for(var br=Ve[nr].abs,kr=0;kr<br.length;kr++){var Nr=br[kr];Nr.type==="arc"?ge.call(this,Nr.x,Nr.y,Nr.radius,Nr.startAngle,Nr.endAngle,Nr.counterclockwise,void 0,xe,!Bt):Qe.call(this,Nr.x,Nr.y),Bt=!0}else if(Ve[nr].close===!0)this.pdf.internal.out("h"),Bt=!1;else if(Ve[nr].begin!==!0){var Br=Ve[nr].start.x,ii=Ve[nr].start.y;Ce.call(this,Ve[nr].deltas,Br,ii),Bt=!0}Ie&&Ue.call(this,Ie),xe&&Ae.call(this)}},et=function(re){var xe=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,pe=xe*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return re-pe;case"top":return re+xe-pe;case"hanging":return re+xe-2*pe;case"middle":return re+xe/2-pe;case"ideographic":return re;case"alphabetic":default:return re}},Te=function(re){return re+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};j.prototype.createLinearGradient=function(){var re=function(){};return re.colorStops=[],re.addColorStop=function(xe,pe){this.colorStops.push([xe,pe])},re.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},re.isCanvasGradient=!0,re},j.prototype.createPattern=function(){return this.createLinearGradient()},j.prototype.createRadialGradient=function(){return this.createLinearGradient()};var ge=function(re,xe,pe,Ie,Ve,gt,mt,wt,Pt){for(var fr=ut.call(this,pe,Ie,Ve,gt),xr=0;xr<fr.length;xr++){var Rr=fr[xr];xr===0&&(Pt?_e.call(this,Rr.x1+re,Rr.y1+xe):Qe.call(this,Rr.x1+re,Rr.y1+xe)),Ye.call(this,re,xe,Rr.x2,Rr.y2,Rr.x3,Rr.y3,Rr.x4,Rr.y4)}wt?Ae.call(this):Ue.call(this,mt)},Ue=function(re){switch(re){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Ae=function(){this.pdf.clip(),this.pdf.discardPath()},_e=function(re,xe){this.pdf.internal.out(o(re)+" "+c(xe)+" m")},ve=function(re){var xe;switch(re.align){case"right":case"end":xe="right";break;case"center":xe="center";break;case"left":case"start":default:xe="left"}var pe=this.pdf.getTextDimensions(re.text),Ie=et.call(this,re.y),Ve=Te.call(this,Ie)-pe.h,gt=this.ctx.transform.applyToPoint(new _(re.x,Ie)),mt=this.ctx.transform.decompose(),wt=new E;wt=(wt=(wt=wt.multiply(mt.translate)).multiply(mt.skew)).multiply(mt.scale);for(var Pt,fr,xr,Rr=this.ctx.transform.applyToRectangle(new T(re.x,Ie,pe.w,pe.h)),Fr=wt.applyToRectangle(new T(re.x,Ve,pe.w,pe.h)),$t=K.call(this,Fr),lt=[],Bt=0;Bt<$t.length;Bt+=1)lt.indexOf($t[Bt])===-1&&lt.push($t[Bt]);if(he(lt),this.autoPaging)for(var nr=lt[0],br=lt[lt.length-1],kr=nr;kr<br+1;kr++){this.pdf.setPage(kr);var Nr=kr===1?this.posY+this.margin[0]:this.margin[0],Br=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ii=this.pdf.internal.pageSize.height-this.margin[2],si=ii-this.margin[0],wi=this.pdf.internal.pageSize.width-this.margin[1],Ri=wi-this.margin[3],Ji=kr===1?0:Br+(kr-2)*si;if(this.ctx.clip_path.length!==0){var an=this.path;Pt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ne(Pt,this.posX+this.margin[3],-1*Ji+Nr),Re.call(this,"fill",!0),this.path=an}var xi=ne([JSON.parse(JSON.stringify(Fr))],this.posX+this.margin[3],-Ji+Nr+this.ctx.prevPageLastElemOffset)[0];re.scale>=.01&&(fr=this.pdf.internal.getFontSize(),this.pdf.setFontSize(fr*re.scale),xr=this.lineWidth,this.lineWidth=xr*re.scale);var Ui=this.autoPaging!=="text";if(Ui||xi.y+xi.h<=ii){if(Ui||xi.y>=Nr&&xi.x<=wi){var Lr=Ui?re.text:this.pdf.splitTextToSize(re.text,re.maxWidth||wi-xi.x)[0],Ua=ne([JSON.parse(JSON.stringify(Rr))],this.posX+this.margin[3],-Ji+Nr+this.ctx.prevPageLastElemOffset)[0],Dr=Ui&&(kr>nr||kr<br)&&G.call(this);Dr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ri,si,null).clip().discardPath()),this.pdf.text(Lr,Ua.x,Ua.y,{angle:re.angle,align:xe,renderingMode:re.renderingMode}),Dr&&this.pdf.restoreGraphicsState()}}else xi.y<ii&&(this.ctx.prevPageLastElemOffset+=ii-xi.y);re.scale>=.01&&(this.pdf.setFontSize(fr),this.lineWidth=xr)}else re.scale>=.01&&(fr=this.pdf.internal.getFontSize(),this.pdf.setFontSize(fr*re.scale),xr=this.lineWidth,this.lineWidth=xr*re.scale),this.pdf.text(re.text,gt.x+this.posX,gt.y+this.posY,{angle:re.angle,align:xe,renderingMode:re.renderingMode,maxWidth:re.maxWidth}),re.scale>=.01&&(this.pdf.setFontSize(fr),this.lineWidth=xr)},Qe=function(re,xe,pe,Ie){pe=pe||0,Ie=Ie||0,this.pdf.internal.out(o(re+pe)+" "+c(xe+Ie)+" l")},Ce=function(re,xe,pe){return this.pdf.lines(re,xe,pe,null,null)},Ye=function(re,xe,pe,Ie,Ve,gt,mt,wt){this.pdf.internal.out([i(u(pe+re)),i(r(Ie+xe)),i(u(Ve+re)),i(r(gt+xe)),i(u(mt+re)),i(r(wt+xe)),"c"].join(" "))},ut=function(re,xe,pe,Ie){for(var Ve=2*Math.PI,gt=Math.PI/2;xe>pe;)xe-=Ve;var mt=Math.abs(pe-xe);mt<Ve&&Ie&&(mt=Ve-mt);for(var wt=[],Pt=Ie?-1:1,fr=xe;mt>1e-5;){var xr=fr+Pt*Math.min(mt,gt);wt.push(st.call(this,re,fr,xr)),mt-=Math.abs(xr-fr),fr=xr}return wt},st=function(re,xe,pe){var Ie=(pe-xe)/2,Ve=re*Math.cos(Ie),gt=re*Math.sin(Ie),mt=Ve,wt=-gt,Pt=mt*mt+wt*wt,fr=Pt+mt*Ve+wt*gt,xr=4/3*(Math.sqrt(2*Pt*fr)-fr)/(mt*gt-wt*Ve),Rr=mt-xr*wt,Fr=wt+xr*mt,$t=Rr,lt=-Fr,Bt=Ie+xe,nr=Math.cos(Bt),br=Math.sin(Bt);return{x1:re*Math.cos(xe),y1:re*Math.sin(xe),x2:Rr*nr-Fr*br,y2:Rr*br+Fr*nr,x3:$t*nr-lt*br,y3:$t*br+lt*nr,x4:re*Math.cos(pe),y4:re*Math.sin(pe)}},pt=function(re){return 180*re/Math.PI},Tt=function(re,xe,pe,Ie,Ve,gt){var mt=re+.5*(pe-re),wt=xe+.5*(Ie-xe),Pt=Ve+.5*(pe-Ve),fr=gt+.5*(Ie-gt),xr=Math.min(re,Ve,mt,Pt),Rr=Math.max(re,Ve,mt,Pt),Fr=Math.min(xe,gt,wt,fr),$t=Math.max(xe,gt,wt,fr);return new T(xr,Fr,Rr-xr,$t-Fr)},ht=function(re,xe,pe,Ie,Ve,gt,mt,wt){var Pt,fr,xr,Rr,Fr,$t,lt,Bt,nr,br,kr,Nr,Br,ii,si=pe-re,wi=Ie-xe,Ri=Ve-pe,Ji=gt-Ie,an=mt-Ve,xi=wt-gt;for(fr=0;fr<41;fr++)nr=(lt=(xr=re+(Pt=fr/40)*si)+Pt*((Fr=pe+Pt*Ri)-xr))+Pt*(Fr+Pt*(Ve+Pt*an-Fr)-lt),br=(Bt=(Rr=xe+Pt*wi)+Pt*(($t=Ie+Pt*Ji)-Rr))+Pt*($t+Pt*(gt+Pt*xi-$t)-Bt),fr==0?(kr=nr,Nr=br,Br=nr,ii=br):(kr=Math.min(kr,nr),Nr=Math.min(Nr,br),Br=Math.max(Br,nr),ii=Math.max(ii,br));return new T(Math.round(kr),Math.round(Nr),Math.round(Br-kr),Math.round(ii-Nr))},Wt=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var re,xe,pe=(re=this.ctx.lineDash,xe=this.ctx.lineDashOffset,JSON.stringify({lineDash:re,lineDashOffset:xe}));this.prevLineDash!==pe&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=pe)}}})(Bi.API),function(a){var i=function(r){var _,T,E,k,D,j,B,P,ee,G;for(/[^\x00-\xFF]/.test(r),T=[],E=0,k=(r+=_="\0\0\0\0".slice(r.length%4||4)).length;k>E;E+=4)(D=(r.charCodeAt(E)<<24)+(r.charCodeAt(E+1)<<16)+(r.charCodeAt(E+2)<<8)+r.charCodeAt(E+3))!==0?(j=(D=((D=((D=((D=(D-(G=D%85))/85)-(ee=D%85))/85)-(P=D%85))/85)-(B=D%85))/85)%85,T.push(j+33,B+33,P+33,ee+33,G+33)):T.push(122);return function(K,J){for(var ne=J;ne>0;ne--)K.pop()}(T,_.length),String.fromCharCode.apply(String,T)+"~>"},o=function(r){var _,T,E,k,D,j=String,B="length",P=255,ee="charCodeAt",G="slice",K="replace";for(r[G](-2),r=r[G](0,-2)[K](/\s/g,"")[K]("z","!!!!!"),E=[],k=0,D=(r+=_="uuuuu"[G](r[B]%5||5))[B];D>k;k+=5)T=52200625*(r[ee](k)-33)+614125*(r[ee](k+1)-33)+7225*(r[ee](k+2)-33)+85*(r[ee](k+3)-33)+(r[ee](k+4)-33),E.push(P&T>>24,P&T>>16,P&T>>8,P&T);return function(J,ne){for(var he=ne;he>0;he--)J.pop()}(E,_[B]),j.fromCharCode.apply(j,E)},c=function(r){var _=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((r=r.replace(/\s/g,"")).indexOf(">")!==-1&&(r=r.substr(0,r.indexOf(">"))),r.length%2&&(r+="0"),_.test(r)===!1)return"";for(var T="",E=0;E<r.length;E+=2)T+=String.fromCharCode("0x"+(r[E]+r[E+1]));return T},u=function(r){for(var _=new Uint8Array(r.length),T=r.length;T--;)_[T]=r.charCodeAt(T);return r=(_=Lx(_)).reduce(function(E,k){return E+String.fromCharCode(k)},"")};a.processDataByFilters=function(r,_){var T=0,E=r||"",k=[];for(typeof(_=_||[])=="string"&&(_=[_]),T=0;T<_.length;T+=1)switch(_[T]){case"ASCII85Decode":case"/ASCII85Decode":E=o(E),k.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":E=i(E),k.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":E=c(E),k.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":E=E.split("").map(function(D){return("0"+D.charCodeAt().toString(16)).slice(-2)}).join("")+">",k.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":E=u(E),k.push("/FlateDecode");break;default:throw new Error('The filter: "'+_[T]+'" is not implemented')}return{data:E,reverseChain:k.reverse().join(" ")}}}(Bi.API),function(a){a.loadFile=function(i,o,c){return function(u,r,_){r=r!==!1,_=typeof _=="function"?_:function(){};var T=void 0;try{T=function(E,k,D){var j=new XMLHttpRequest,B=0,P=function(ee){var G=ee.length,K=[],J=String.fromCharCode;for(B=0;B<G;B+=1)K.push(J(255&ee.charCodeAt(B)));return K.join("")};if(j.open("GET",E,!k),j.overrideMimeType("text/plain; charset=x-user-defined"),k===!1&&(j.onload=function(){j.status===200?D(P(this.responseText)):D(void 0)}),j.send(null),k&&j.status===200)return P(j.responseText)}(u,r,_)}catch{}return T}(i,o,c)},a.loadImageFile=a.loadFile}(Bi.API),function(a){function i(){return(Wi.html2canvas?Promise.resolve(Wi.html2canvas):import("./chunk-CNFKX5IU.js")).catch(function(_){return Promise.reject(new Error("Could not load html2canvas: "+_))}).then(function(_){return _.default?_.default:_})}function o(){return(Wi.DOMPurify?Promise.resolve(Wi.DOMPurify):import("./chunk-YBZPKO7G.js")).catch(function(_){return Promise.reject(new Error("Could not load dompurify: "+_))}).then(function(_){return _.default?_.default:_})}var c=function(_){var T=Pa(_);return T==="undefined"?"undefined":T==="string"||_ instanceof String?"string":T==="number"||_ instanceof Number?"number":T==="function"||_ instanceof Function?"function":_&&_.constructor===Array?"array":_&&_.nodeType===1?"element":T==="object"?"object":"unknown"},u=function(_,T){var E=document.createElement(_);for(var k in T.className&&(E.className=T.className),T.innerHTML&&T.dompurify&&(E.innerHTML=T.dompurify.sanitize(T.innerHTML)),T.style)E.style[k]=T.style[k];return E},r=function _(T){var E=Object.assign(_.convert(Promise.resolve()),JSON.parse(JSON.stringify(_.template))),k=_.convert(Promise.resolve(),E);return k=(k=k.setProgress(1,_,1,[_])).set(T)};(r.prototype=Object.create(Promise.prototype)).constructor=r,r.convert=function(_,T){return _.__proto__=T||r.prototype,_},r.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},r.prototype.from=function(_,T){return this.then(function(){switch(T=T||function(E){switch(c(E)){case"string":return"string";case"element":return E.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(_)){case"string":return this.then(o).then(function(E){return this.set({src:u("div",{innerHTML:_,dompurify:E})})});case"element":return this.set({src:_});case"canvas":return this.set({canvas:_});case"img":return this.set({img:_});default:return this.error("Unknown source type.")}})},r.prototype.to=function(_){switch(_){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},r.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var _={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},T=function E(k,D){for(var j=k.nodeType===3?document.createTextNode(k.nodeValue):k.cloneNode(!1),B=k.firstChild;B;B=B.nextSibling)D!==!0&&B.nodeType===1&&B.nodeName==="SCRIPT"||j.appendChild(E(B,D));return k.nodeType===1&&(k.nodeName==="CANVAS"?(j.width=k.width,j.height=k.height,j.getContext("2d").drawImage(k,0,0)):k.nodeName!=="TEXTAREA"&&k.nodeName!=="SELECT"||(j.value=k.value),j.addEventListener("load",function(){j.scrollTop=k.scrollTop,j.scrollLeft=k.scrollLeft},!0)),j}(this.prop.src,this.opt.html2canvas.javascriptEnabled);T.tagName==="BODY"&&(_.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=u("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=u("div",{className:"html2pdf__container",style:_}),this.prop.container.appendChild(T),this.prop.container.firstChild.appendChild(u("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},r.prototype.toCanvas=function(){var _=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(_).then(i).then(function(T){var E=Object.assign({},this.opt.html2canvas);return delete E.onrendered,T(this.prop.container,E)}).then(function(T){(this.opt.html2canvas.onrendered||function(){})(T),this.prop.canvas=T,document.body.removeChild(this.prop.overlay)})},r.prototype.toContext2d=function(){var _=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(_).then(i).then(function(T){var E=this.opt.jsPDF,k=this.opt.fontFaces,D=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,j=Object.assign({async:!0,allowTaint:!0,scale:D,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete j.onrendered,E.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,E.context2d.posX=this.opt.x,E.context2d.posY=this.opt.y,E.context2d.margin=this.opt.margin,E.context2d.fontFaces=k,k)for(var B=0;B<k.length;++B){var P=k[B],ee=P.src.find(function(G){return G.format==="truetype"});ee&&E.addFont(ee.url,P.ref.name,P.ref.style)}return j.windowHeight=j.windowHeight||0,j.windowHeight=j.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):j.windowHeight,E.context2d.save(!0),T(this.prop.container,j)}).then(function(T){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(T),this.prop.canvas=T,document.body.removeChild(this.prop.overlay)})},r.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var _=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=_})},r.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},r.prototype.output=function(_,T,E){return(E=E||"pdf").toLowerCase()==="img"||E.toLowerCase()==="image"?this.outputImg(_,T):this.outputPdf(_,T)},r.prototype.outputPdf=function(_,T){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(_,T)})},r.prototype.outputImg=function(_){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(_){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+_+'" is not supported.'}})},r.prototype.save=function(_){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(_?{filename:_}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},r.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},r.prototype.set=function(_){if(c(_)!=="object")return this;var T=Object.keys(_||{}).map(function(E){if(E in r.template.prop)return function(){this.prop[E]=_[E]};switch(E){case"margin":return this.setMargin.bind(this,_.margin);case"jsPDF":return function(){return this.opt.jsPDF=_.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,_.pageSize);default:return function(){this.opt[E]=_[E]}}},this);return this.then(function(){return this.thenList(T)})},r.prototype.get=function(_,T){return this.then(function(){var E=_ in r.template.prop?this.prop[_]:this.opt[_];return T?T(E):E})},r.prototype.setMargin=function(_){return this.then(function(){switch(c(_)){case"number":_=[_,_,_,_];case"array":if(_.length===2&&(_=[_[0],_[1],_[0],_[1]]),_.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=_}).then(this.setPageSize)},r.prototype.setPageSize=function(_){function T(E,k){return Math.floor(E*k/72*96)}return this.then(function(){(_=_||Bi.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(_.inner={width:_.width-this.opt.margin[1]-this.opt.margin[3],height:_.height-this.opt.margin[0]-this.opt.margin[2]},_.inner.px={width:T(_.inner.width,_.k),height:T(_.inner.height,_.k)},_.inner.ratio=_.inner.height/_.inner.width),this.prop.pageSize=_})},r.prototype.setProgress=function(_,T,E,k){return _!=null&&(this.progress.val=_),T!=null&&(this.progress.state=T),E!=null&&(this.progress.n=E),k!=null&&(this.progress.stack=k),this.progress.ratio=this.progress.val/this.progress.state,this},r.prototype.updateProgress=function(_,T,E,k){return this.setProgress(_?this.progress.val+_:null,T||null,E?this.progress.n+E:null,k?this.progress.stack.concat(k):null)},r.prototype.then=function(_,T){var E=this;return this.thenCore(_,T,function(k,D){return E.updateProgress(null,null,1,[k]),Promise.prototype.then.call(this,function(j){return E.updateProgress(null,k),j}).then(k,D).then(function(j){return E.updateProgress(1),j})})},r.prototype.thenCore=function(_,T,E){E=E||Promise.prototype.then,_&&(_=_.bind(this)),T&&(T=T.bind(this));var k=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:r.convert(Object.assign({},this),Promise.prototype),D=E.call(k,_,T);return r.convert(D,this.__proto__)},r.prototype.thenExternal=function(_,T){return Promise.prototype.then.call(this,_,T)},r.prototype.thenList=function(_){var T=this;return _.forEach(function(E){T=T.thenCore(E)}),T},r.prototype.catch=function(_){_&&(_=_.bind(this));var T=Promise.prototype.catch.call(this,_);return r.convert(T,this)},r.prototype.catchExternal=function(_){return Promise.prototype.catch.call(this,_)},r.prototype.error=function(_){return this.then(function(){throw new Error(_)})},r.prototype.using=r.prototype.set,r.prototype.saveAs=r.prototype.save,r.prototype.export=r.prototype.output,r.prototype.run=r.prototype.then,Bi.getPageSize=function(_,T,E){if(Pa(_)==="object"){var k=_;_=k.orientation,T=k.unit||T,E=k.format||E}T=T||"mm",E=E||"a4",_=(""+(_||"P")).toLowerCase();var D,j=(""+E).toLowerCase(),B={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(T){case"pt":D=1;break;case"mm":D=72/25.4;break;case"cm":D=72/2.54;break;case"in":D=72;break;case"px":D=.75;break;case"pc":case"em":D=12;break;case"ex":D=6;break;default:throw"Invalid unit: "+T}var P,ee=0,G=0;if(B.hasOwnProperty(j))ee=B[j][1]/D,G=B[j][0]/D;else try{ee=E[1],G=E[0]}catch{throw new Error("Invalid format: "+E)}if(_==="p"||_==="portrait")_="p",G>ee&&(P=G,G=ee,ee=P);else{if(_!=="l"&&_!=="landscape")throw"Invalid orientation: "+_;_="l",ee>G&&(P=G,G=ee,ee=P)}return{width:G,height:ee,unit:T,k:D,orientation:_}},a.html=function(_,T){(T=T||{}).callback=T.callback||function(){},T.html2canvas=T.html2canvas||{},T.html2canvas.canvas=T.html2canvas.canvas||this.canvas,T.jsPDF=T.jsPDF||this,T.fontFaces=T.fontFaces?T.fontFaces.map(OT):null;var E=new r(T);return T.worker?E:E.from(_).doCallback()}}(Bi.API),Bi.API.addJS=function(a){return ID=a,this.internal.events.subscribe("postPutResources",function(){Bx=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Bx+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),CD=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+ID+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Bx!==void 0&&CD!==void 0&&this.internal.out("/Names <</JavaScript "+Bx+" 0 R>>")}),this},function(a){var i;a.events.push(["postPutResources",function(){var o=this,c=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var u=o.outline.render().split(/\r\n/),r=0;r<u.length;r++){var _=u[r],T=c.exec(_);if(T!=null){var E=T[1];o.internal.newObjectDeferredBegin(E,!1)}o.internal.write(_)}if(this.outline.createNamedDestinations){var k=this.internal.pages.length,D=[];for(r=0;r<k;r++){var j=o.internal.newObject();D.push(j);var B=o.internal.getPageInfo(r+1);o.internal.write("<< /D["+B.objId+" 0 R /XYZ null null null]>> endobj")}var P=o.internal.newObject();for(o.internal.write("<< /Names [ "),r=0;r<D.length;r++)o.internal.write("(page_"+(r+1)+")"+D[r]+" 0 R");o.internal.write(" ] >>","endobj"),i=o.internal.newObject(),o.internal.write("<< /Dests "+P+" 0 R"),o.internal.write(">>","endobj")}}]),a.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+i+" 0 R"))}]),a.events.push(["initialized",function(){var o=this;o.outline={createNamedDestinations:!1,root:{children:[]}},o.outline.add=function(c,u,r){var _={title:u,options:r,children:[]};return c==null&&(c=this.root),c.children.push(_),_},o.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=o,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},o.outline.genIds_r=function(c){c.id=o.internal.newObjectDeferred();for(var u=0;u<c.children.length;u++)this.genIds_r(c.children[u])},o.outline.renderRoot=function(c){this.objStart(c),this.line("/Type /Outlines"),c.children.length>0&&(this.line("/First "+this.makeRef(c.children[0])),this.line("/Last "+this.makeRef(c.children[c.children.length-1]))),this.line("/Count "+this.count_r({count:0},c)),this.objEnd()},o.outline.renderItems=function(c){for(var u=this.ctx.pdf.internal.getVerticalCoordinateString,r=0;r<c.children.length;r++){var _=c.children[r];this.objStart(_),this.line("/Title "+this.makeString(_.title)),this.line("/Parent "+this.makeRef(c)),r>0&&this.line("/Prev "+this.makeRef(c.children[r-1])),r<c.children.length-1&&this.line("/Next "+this.makeRef(c.children[r+1])),_.children.length>0&&(this.line("/First "+this.makeRef(_.children[0])),this.line("/Last "+this.makeRef(_.children[_.children.length-1])));var T=this.count=this.count_r({count:0},_);if(T>0&&this.line("/Count "+T),_.options&&_.options.pageNumber){var E=o.internal.getPageInfo(_.options.pageNumber);this.line("/Dest ["+E.objId+" 0 R /XYZ 0 "+u(0)+" 0]")}this.objEnd()}for(var k=0;k<c.children.length;k++)this.renderItems(c.children[k])},o.outline.line=function(c){this.ctx.val+=c+`\r
`},o.outline.makeRef=function(c){return c.id+" 0 R"},o.outline.makeString=function(c){return"("+o.internal.pdfEscape(c)+")"},o.outline.objStart=function(c){this.ctx.val+=`\r
`+c.id+` 0 obj\r
<<\r
`},o.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},o.outline.count_r=function(c,u){for(var r=0;r<u.children.length;r++)c.count++,this.count_r(c,u.children[r]);return c.count}}])}(Bi.API),function(a){var i=[192,193,194,195,196,197,198,199];a.processJPEG=function(o,c,u,r,_,T){var E,k=this.decode.DCT_DECODE,D=null;if(typeof o=="string"||this.__addimage__.isArrayBuffer(o)||this.__addimage__.isArrayBufferView(o)){switch(o=_||o,o=this.__addimage__.isArrayBuffer(o)?new Uint8Array(o):o,(E=function(j){for(var B,P=256*j.charCodeAt(4)+j.charCodeAt(5),ee=j.length,G={width:0,height:0,numcomponents:1},K=4;K<ee;K+=2){if(K+=P,i.indexOf(j.charCodeAt(K+1))!==-1){B=256*j.charCodeAt(K+5)+j.charCodeAt(K+6),G={width:256*j.charCodeAt(K+7)+j.charCodeAt(K+8),height:B,numcomponents:j.charCodeAt(K+9)};break}P=256*j.charCodeAt(K+2)+j.charCodeAt(K+3)}return G}(o=this.__addimage__.isArrayBufferView(o)?this.__addimage__.arrayBufferToBinaryString(o):o)).numcomponents){case 1:T=this.color_spaces.DEVICE_GRAY;break;case 4:T=this.color_spaces.DEVICE_CMYK;break;case 3:T=this.color_spaces.DEVICE_RGB}D={data:o,width:E.width,height:E.height,colorSpace:T,bitsPerComponent:8,filter:k,index:c,alias:u}}return D}}(Bi.API);iW=function(){var a,i,o;function c(r){var _,T,E,k,D,j,B,P,ee,G,K,J,ne,he;for(this.data=r,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},j=null;;){switch(_=this.readUInt32(),ee=(function(){var Me,Re;for(Re=[],Me=0;Me<4;++Me)Re.push(String.fromCharCode(this.data[this.pos++]));return Re}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(_);break;case"fcTL":j&&this.animation.frames.push(j),this.pos+=4,j={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},D=this.readUInt16(),k=this.readUInt16()||100,j.delay=1e3*D/k,j.disposeOp=this.data[this.pos++],j.blendOp=this.data[this.pos++],j.data=[];break;case"IDAT":case"fdAT":for(ee==="fdAT"&&(this.pos+=4,_-=4),r=j?.data||this.imgData,J=0;0<=_?J<_:J>_;0<=_?++J:--J)r.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(E=this.palette.length/3,this.transparency.indexed=this.read(_),this.transparency.indexed.length>E)throw new Error("More transparent colors than palette size");if((G=E-this.transparency.indexed.length)>0)for(ne=0;0<=G?ne<G:ne>G;0<=G?++ne:--ne)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(_)[0];break;case 2:this.transparency.rgb=this.read(_)}break;case"tEXt":B=(K=this.read(_)).indexOf(0),P=String.fromCharCode.apply(String,K.slice(0,B)),this.text[P]=String.fromCharCode.apply(String,K.slice(B+1));break;case"IEND":return j&&this.animation.frames.push(j),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(he=this.colorType)===4||he===6,T=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*T,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=_}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}c.prototype.read=function(r){var _,T;for(T=[],_=0;0<=r?_<r:_>r;0<=r?++_:--_)T.push(this.data[this.pos++]);return T},c.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},c.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},c.prototype.decodePixels=function(r){var _=this.pixelBitlength/8,T=new Uint8Array(this.width*this.height*_),E=0,k=this;if(r==null&&(r=this.imgData),r.length===0)return new Uint8Array(0);function D(j,B,P,ee){var G,K,J,ne,he,Me,Re,et,Te,ge,Ue,Ae,_e,ve,Qe,Ce,Ye,ut,st,pt,Tt,ht=Math.ceil((k.width-j)/P),Wt=Math.ceil((k.height-B)/ee),re=k.width==ht&&k.height==Wt;for(ve=_*ht,Ae=re?T:new Uint8Array(ve*Wt),Me=r.length,_e=0,K=0;_e<Wt&&E<Me;){switch(r[E++]){case 0:for(ne=Ye=0;Ye<ve;ne=Ye+=1)Ae[K++]=r[E++];break;case 1:for(ne=ut=0;ut<ve;ne=ut+=1)G=r[E++],he=ne<_?0:Ae[K-_],Ae[K++]=(G+he)%256;break;case 2:for(ne=st=0;st<ve;ne=st+=1)G=r[E++],J=(ne-ne%_)/_,Qe=_e&&Ae[(_e-1)*ve+J*_+ne%_],Ae[K++]=(Qe+G)%256;break;case 3:for(ne=pt=0;pt<ve;ne=pt+=1)G=r[E++],J=(ne-ne%_)/_,he=ne<_?0:Ae[K-_],Qe=_e&&Ae[(_e-1)*ve+J*_+ne%_],Ae[K++]=(G+Math.floor((he+Qe)/2))%256;break;case 4:for(ne=Tt=0;Tt<ve;ne=Tt+=1)G=r[E++],J=(ne-ne%_)/_,he=ne<_?0:Ae[K-_],_e===0?Qe=Ce=0:(Qe=Ae[(_e-1)*ve+J*_+ne%_],Ce=J&&Ae[(_e-1)*ve+(J-1)*_+ne%_]),Re=he+Qe-Ce,et=Math.abs(Re-he),ge=Math.abs(Re-Qe),Ue=Math.abs(Re-Ce),Te=et<=ge&&et<=Ue?he:ge<=Ue?Qe:Ce,Ae[K++]=(G+Te)%256;break;default:throw new Error("Invalid filter algorithm: "+r[E-1])}if(!re){var xe=((B+_e*ee)*k.width+j)*_,pe=_e*ve;for(ne=0;ne<ht;ne+=1){for(var Ie=0;Ie<_;Ie+=1)T[xe++]=Ae[pe++];xe+=(P-1)*_}}_e++}}return r=gD(r),k.interlaceMethod==1?(D(0,0,8,8),D(4,0,8,8),D(0,4,4,8),D(2,0,4,4),D(0,2,2,4),D(1,0,2,2),D(0,1,1,2)):D(0,0,1,1),T},c.prototype.decodePalette=function(){var r,_,T,E,k,D,j,B,P;for(T=this.palette,D=this.transparency.indexed||[],k=new Uint8Array((D.length||0)+T.length),E=0,r=0,_=j=0,B=T.length;j<B;_=j+=3)k[E++]=T[_],k[E++]=T[_+1],k[E++]=T[_+2],k[E++]=(P=D[r++])!=null?P:255;return k},c.prototype.copyToImageData=function(r,_){var T,E,k,D,j,B,P,ee,G,K,J;if(E=this.colors,G=null,T=this.hasAlphaChannel,this.palette.length&&(G=(J=this._decodedPalette)!=null?J:this._decodedPalette=this.decodePalette(),E=4,T=!0),ee=(k=r.data||r).length,j=G||_,D=B=0,E===1)for(;D<ee;)P=G?4*_[D/4]:B,K=j[P++],k[D++]=K,k[D++]=K,k[D++]=K,k[D++]=T?j[P++]:255,B=P;else for(;D<ee;)P=G?4*_[D/4]:B,k[D++]=j[P++],k[D++]=j[P++],k[D++]=j[P++],k[D++]=T?j[P++]:255,B=P},c.prototype.decode=function(){var r;return r=new Uint8Array(this.width*this.height*4),this.copyToImageData(r,this.decodePixels()),r};var u=function(){if(Object.prototype.toString.call(Wi)==="[object Window]"){try{i=Wi.document.createElement("canvas"),o=i.getContext("2d")}catch{return!1}return!0}return!1};return u(),a=function(r){var _;if(u()===!0)return o.width=r.width,o.height=r.height,o.clearRect(0,0,r.width,r.height),o.putImageData(r,0,0),(_=new Image).src=i.toDataURL(),_;throw new Error("This method requires a Browser with Canvas-capability.")},c.prototype.decodeFrames=function(r){var _,T,E,k,D,j,B,P;if(this.animation){for(P=[],T=D=0,j=(B=this.animation.frames).length;D<j;T=++D)_=B[T],E=r.createImageData(_.width,_.height),k=this.decodePixels(new Uint8Array(_.data)),this.copyToImageData(E,k),_.imageData=E,P.push(_.image=a(E));return P}},c.prototype.renderFrame=function(r,_){var T,E,k;return T=(E=this.animation.frames)[_],k=E[_-1],_===0&&r.clearRect(0,0,this.width,this.height),k?.disposeOp===1?r.clearRect(k.xOffset,k.yOffset,k.width,k.height):k?.disposeOp===2&&r.putImageData(k.imageData,k.xOffset,k.yOffset),T.blendOp===0&&r.clearRect(T.xOffset,T.yOffset,T.width,T.height),r.drawImage(T.image,T.xOffset,T.yOffset)},c.prototype.animate=function(r){var _,T,E,k,D,j,B=this;return T=0,j=this.animation,k=j.numFrames,E=j.frames,D=j.numPlays,(_=function(){var P,ee;if(P=T++%k,ee=E[P],B.renderFrame(r,P),k>1&&T/k<D)return B.animation._timeout=setTimeout(_,ee.delay)})()},c.prototype.stopAnimation=function(){var r;return clearTimeout((r=this.animation)!=null?r._timeout:void 0)},c.prototype.render=function(r){var _,T;return r._png&&r._png.stopAnimation(),r._png=this,r.width=this.width,r.height=this.height,_=r.getContext("2d"),this.animation?(this.decodeFrames(_),this.animate(_)):(T=_.createImageData(this.width,this.height),this.copyToImageData(T,this.decodePixels()),_.putImageData(T,0,0))},c}();(function(a){var i=function(){return typeof Lx=="function"},o=function(B,P,ee,G){var K=4,J=_;switch(G){case a.image_compression.FAST:K=1,J=r;break;case a.image_compression.MEDIUM:K=6,J=T;break;case a.image_compression.SLOW:K=9,J=E}B=c(B,P,ee,J);var ne=Lx(B,{level:K});return a.__addimage__.arrayBufferToBinaryString(ne)},c=function(B,P,ee,G){for(var K,J,ne,he=B.length/P,Me=new Uint8Array(B.length+he),Re=D(),et=0;et<he;et+=1){if(ne=et*P,K=B.subarray(ne,ne+P),G)Me.set(G(K,ee,J),ne+et);else{for(var Te,ge=Re.length,Ue=[];Te<ge;Te+=1)Ue[Te]=Re[Te](K,ee,J);var Ae=j(Ue.concat());Me.set(Ue[Ae],ne+et)}J=K}return Me},u=function(B){var P=Array.apply([],B);return P.unshift(0),P},r=function(B,P){var ee,G=[],K=B.length;G[0]=1;for(var J=0;J<K;J+=1)ee=B[J-P]||0,G[J+1]=B[J]-ee+256&255;return G},_=function(B,P,ee){var G,K=[],J=B.length;K[0]=2;for(var ne=0;ne<J;ne+=1)G=ee&&ee[ne]||0,K[ne+1]=B[ne]-G+256&255;return K},T=function(B,P,ee){var G,K,J=[],ne=B.length;J[0]=3;for(var he=0;he<ne;he+=1)G=B[he-P]||0,K=ee&&ee[he]||0,J[he+1]=B[he]+256-(G+K>>>1)&255;return J},E=function(B,P,ee){var G,K,J,ne,he=[],Me=B.length;he[0]=4;for(var Re=0;Re<Me;Re+=1)G=B[Re-P]||0,K=ee&&ee[Re]||0,J=ee&&ee[Re-P]||0,ne=k(G,K,J),he[Re+1]=B[Re]-ne+256&255;return he},k=function(B,P,ee){if(B===P&&P===ee)return B;var G=Math.abs(P-ee),K=Math.abs(B-ee),J=Math.abs(B+P-ee-ee);return G<=K&&G<=J?B:K<=J?P:ee},D=function(){return[u,r,_,T,E]},j=function(B){var P=B.map(function(ee){return ee.reduce(function(G,K){return G+Math.abs(K)},0)});return P.indexOf(Math.min.apply(null,P))};a.processPNG=function(B,P,ee,G){var K,J,ne,he,Me,Re,et,Te,ge,Ue,Ae,_e,ve,Qe,Ce,Ye=this.decode.FLATE_DECODE,ut="";if(this.__addimage__.isArrayBuffer(B)&&(B=new Uint8Array(B)),this.__addimage__.isArrayBufferView(B)){if(B=(ne=new iW(B)).imgData,J=ne.bits,K=ne.colorSpace,Me=ne.colors,[4,6].indexOf(ne.colorType)!==-1){if(ne.bits===8){ge=(Te=ne.pixelBitlength==32?new Uint32Array(ne.decodePixels().buffer):ne.pixelBitlength==16?new Uint16Array(ne.decodePixels().buffer):new Uint8Array(ne.decodePixels().buffer)).length,Ae=new Uint8Array(ge*ne.colors),Ue=new Uint8Array(ge);var st,pt=ne.pixelBitlength-ne.bits;for(Qe=0,Ce=0;Qe<ge;Qe++){for(ve=Te[Qe],st=0;st<pt;)Ae[Ce++]=ve>>>st&255,st+=ne.bits;Ue[Qe]=ve>>>st&255}}if(ne.bits===16){ge=(Te=new Uint32Array(ne.decodePixels().buffer)).length,Ae=new Uint8Array(ge*(32/ne.pixelBitlength)*ne.colors),Ue=new Uint8Array(ge*(32/ne.pixelBitlength)),_e=ne.colors>1,Qe=0,Ce=0;for(var Tt=0;Qe<ge;)ve=Te[Qe++],Ae[Ce++]=ve>>>0&255,_e&&(Ae[Ce++]=ve>>>16&255,ve=Te[Qe++],Ae[Ce++]=ve>>>0&255),Ue[Tt++]=ve>>>16&255;J=8}G!==a.image_compression.NONE&&i()?(B=o(Ae,ne.width*ne.colors,ne.colors,G),et=o(Ue,ne.width,1,G)):(B=Ae,et=Ue,Ye=void 0)}if(ne.colorType===3&&(K=this.color_spaces.INDEXED,Re=ne.palette,ne.transparency.indexed)){var ht=ne.transparency.indexed,Wt=0;for(Qe=0,ge=ht.length;Qe<ge;++Qe)Wt+=ht[Qe];if((Wt/=255)===ge-1&&ht.indexOf(0)!==-1)he=[ht.indexOf(0)];else if(Wt!==ge){for(Te=ne.decodePixels(),Ue=new Uint8Array(Te.length),Qe=0,ge=Te.length;Qe<ge;Qe++)Ue[Qe]=ht[Te[Qe]];et=o(Ue,ne.width,1)}}var re=function(xe){var pe;switch(xe){case a.image_compression.FAST:pe=11;break;case a.image_compression.MEDIUM:pe=13;break;case a.image_compression.SLOW:pe=14;break;default:pe=12}return pe}(G);return Ye===this.decode.FLATE_DECODE&&(ut="/Predictor "+re+" "),ut+="/Colors "+Me+" /BitsPerComponent "+J+" /Columns "+ne.width,(this.__addimage__.isArrayBuffer(B)||this.__addimage__.isArrayBufferView(B))&&(B=this.__addimage__.arrayBufferToBinaryString(B)),(et&&this.__addimage__.isArrayBuffer(et)||this.__addimage__.isArrayBufferView(et))&&(et=this.__addimage__.arrayBufferToBinaryString(et)),{alias:ee,data:B,index:P,filter:Ye,decodeParameters:ut,transparency:he,palette:Re,sMask:et,predictor:re,width:ne.width,height:ne.height,bitsPerComponent:J,colorSpace:K}}}})(Bi.API),function(a){a.processGIF89A=function(i,o,c,u){var r=new nW(i),_=r.width,T=r.height,E=[];r.decodeAndBlitFrameRGBA(0,E);var k={data:E,width:_,height:T},D=new MT(100).encode(k,100);return a.processJPEG.call(this,D,o,c,u)},a.processGIF87A=a.processGIF89A}(Bi.API),yh.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var a=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(a);for(var i=0;i<a;i++){var o=this.datav.getUint8(this.pos++,!0),c=this.datav.getUint8(this.pos++,!0),u=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0);this.palette[i]={red:u,green:c,blue:o,quad:r}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},yh.prototype.parseBGR=function(){this.pos=this.offset;try{var a="bit"+this.bitPP,i=this.width*this.height*4;this.data=new Uint8Array(i),this[a]()}catch(o){ja.log("bit decode error:"+o)}},yh.prototype.bit1=function(){var a,i=Math.ceil(this.width/8),o=i%4;for(a=this.height-1;a>=0;a--){for(var c=this.bottom_up?a:this.height-1-a,u=0;u<i;u++)for(var r=this.datav.getUint8(this.pos++,!0),_=c*this.width*4+8*u*4,T=0;T<8&&8*u+T<this.width;T++){var E=this.palette[r>>7-T&1];this.data[_+4*T]=E.blue,this.data[_+4*T+1]=E.green,this.data[_+4*T+2]=E.red,this.data[_+4*T+3]=255}o!==0&&(this.pos+=4-o)}},yh.prototype.bit4=function(){for(var a=Math.ceil(this.width/2),i=a%4,o=this.height-1;o>=0;o--){for(var c=this.bottom_up?o:this.height-1-o,u=0;u<a;u++){var r=this.datav.getUint8(this.pos++,!0),_=c*this.width*4+2*u*4,T=r>>4,E=15&r,k=this.palette[T];if(this.data[_]=k.blue,this.data[_+1]=k.green,this.data[_+2]=k.red,this.data[_+3]=255,2*u+1>=this.width)break;k=this.palette[E],this.data[_+4]=k.blue,this.data[_+4+1]=k.green,this.data[_+4+2]=k.red,this.data[_+4+3]=255}i!==0&&(this.pos+=4-i)}},yh.prototype.bit8=function(){for(var a=this.width%4,i=this.height-1;i>=0;i--){for(var o=this.bottom_up?i:this.height-1-i,c=0;c<this.width;c++){var u=this.datav.getUint8(this.pos++,!0),r=o*this.width*4+4*c;if(u<this.palette.length){var _=this.palette[u];this.data[r]=_.red,this.data[r+1]=_.green,this.data[r+2]=_.blue,this.data[r+3]=255}else this.data[r]=255,this.data[r+1]=255,this.data[r+2]=255,this.data[r+3]=255}a!==0&&(this.pos+=4-a)}},yh.prototype.bit15=function(){for(var a=this.width%3,i=parseInt("11111",2),o=this.height-1;o>=0;o--){for(var c=this.bottom_up?o:this.height-1-o,u=0;u<this.width;u++){var r=this.datav.getUint16(this.pos,!0);this.pos+=2;var _=(r&i)/i*255|0,T=(r>>5&i)/i*255|0,E=(r>>10&i)/i*255|0,k=r>>15?255:0,D=c*this.width*4+4*u;this.data[D]=E,this.data[D+1]=T,this.data[D+2]=_,this.data[D+3]=k}this.pos+=a}},yh.prototype.bit16=function(){for(var a=this.width%3,i=parseInt("11111",2),o=parseInt("111111",2),c=this.height-1;c>=0;c--){for(var u=this.bottom_up?c:this.height-1-c,r=0;r<this.width;r++){var _=this.datav.getUint16(this.pos,!0);this.pos+=2;var T=(_&i)/i*255|0,E=(_>>5&o)/o*255|0,k=(_>>11)/i*255|0,D=u*this.width*4+4*r;this.data[D]=k,this.data[D+1]=E,this.data[D+2]=T,this.data[D+3]=255}this.pos+=a}},yh.prototype.bit24=function(){for(var a=this.height-1;a>=0;a--){for(var i=this.bottom_up?a:this.height-1-a,o=0;o<this.width;o++){var c=this.datav.getUint8(this.pos++,!0),u=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),_=i*this.width*4+4*o;this.data[_]=r,this.data[_+1]=u,this.data[_+2]=c,this.data[_+3]=255}this.pos+=this.width%4}},yh.prototype.bit32=function(){for(var a=this.height-1;a>=0;a--)for(var i=this.bottom_up?a:this.height-1-a,o=0;o<this.width;o++){var c=this.datav.getUint8(this.pos++,!0),u=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),_=this.datav.getUint8(this.pos++,!0),T=i*this.width*4+4*o;this.data[T]=r,this.data[T+1]=u,this.data[T+2]=c,this.data[T+3]=_}},yh.prototype.getData=function(){return this.data},function(a){a.processBMP=function(i,o,c,u){var r=new yh(i,!1),_=r.width,T=r.height,E={data:r.getData(),width:_,height:T},k=new MT(100).encode(E,100);return a.processJPEG.call(this,k,o,c,u)}}(Bi.API),FD.prototype.getData=function(){return this.data},function(a){a.processWEBP=function(i,o,c,u){var r=new FD(i,!1),_=r.width,T=r.height,E={data:r.getData(),width:_,height:T},k=new MT(100).encode(E,100);return a.processJPEG.call(this,k,o,c,u)}}(Bi.API),Bi.API.processRGBA=function(a,i,o){for(var c=a.data,u=c.length,r=new Uint8Array(u/4*3),_=new Uint8Array(u/4),T=0,E=0,k=0;k<u;k+=4){var D=c[k],j=c[k+1],B=c[k+2],P=c[k+3];r[T++]=D,r[T++]=j,r[T++]=B,_[E++]=P}var ee=this.__addimage__.arrayBufferToBinaryString(r);return{alpha:this.__addimage__.arrayBufferToBinaryString(_),data:ee,index:i,alias:o,colorSpace:"DeviceRGB",bitsPerComponent:8,width:a.width,height:a.height}},Bi.API.setLanguage=function(a){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[a]!==void 0&&(this.internal.languageSettings.languageCode=a,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},mg=Bi.API,zx=mg.getCharWidthsArray=function(a,i){var o,c,u=(i=i||{}).font||this.internal.getFont(),r=i.fontSize||this.internal.getFontSize(),_=i.charSpace||this.internal.getCharSpace(),T=i.widths?i.widths:u.metadata.Unicode.widths,E=T.fof?T.fof:1,k=i.kerning?i.kerning:u.metadata.Unicode.kerning,D=k.fof?k.fof:1,j=i.doKerning!==!1,B=0,P=a.length,ee=0,G=T[0]||E,K=[];for(o=0;o<P;o++)c=a.charCodeAt(o),typeof u.metadata.widthOfString=="function"?K.push((u.metadata.widthOfGlyph(u.metadata.characterToGlyph(c))+_*(1e3/r)||0)/1e3):(B=j&&Pa(k[c])==="object"&&!isNaN(parseInt(k[c][ee],10))?k[c][ee]/D:0,K.push((T[c]||G)/E+B)),ee=c;return K},kD=mg.getStringUnitWidth=function(a,i){var o=(i=i||{}).fontSize||this.internal.getFontSize(),c=i.font||this.internal.getFont(),u=i.charSpace||this.internal.getCharSpace();return mg.processArabic&&(a=mg.processArabic(a)),typeof c.metadata.widthOfString=="function"?c.metadata.widthOfString(a,o,u)/o:zx.apply(this,arguments).reduce(function(r,_){return r+_},0)},MD=function(a,i,o,c){for(var u=[],r=0,_=a.length,T=0;r!==_&&T+i[r]<o;)T+=i[r],r++;u.push(a.slice(0,r));var E=r;for(T=0;r!==_;)T+i[r]>c&&(u.push(a.slice(E,r)),T=0,E=r),T+=i[r],r++;return E!==r&&u.push(a.slice(E,r)),u},DD=function(a,i,o){o||(o={});var c,u,r,_,T,E,k,D=[],j=[D],B=o.textIndent||0,P=0,ee=0,G=a.split(" "),K=zx.apply(this,[" ",o])[0];if(E=o.lineIndent===-1?G[0].length+2:o.lineIndent||0){var J=Array(E).join(" "),ne=[];G.map(function(Me){(Me=Me.split(/\s*\n/)).length>1?ne=ne.concat(Me.map(function(Re,et){return(et&&Re.length?`
`:"")+Re})):ne.push(Me[0])}),G=ne,E=kD.apply(this,[J,o])}for(r=0,_=G.length;r<_;r++){var he=0;if(c=G[r],E&&c[0]==`
`&&(c=c.substr(1),he=1),B+P+(ee=(u=zx.apply(this,[c,o])).reduce(function(Me,Re){return Me+Re},0))>i||he){if(ee>i){for(T=MD.apply(this,[c,u,i-(B+P),i]),D.push(T.shift()),D=[T.pop()];T.length;)j.push([T.shift()]);ee=u.slice(c.length-(D[0]?D[0].length:0)).reduce(function(Me,Re){return Me+Re},0)}else D=[c];j.push(D),B=ee+E,P=K}else D.push(c),B+=P+ee,P=K}return k=E?function(Me,Re){return(Re?J:"")+Me.join(" ")}:function(Me){return Me.join(" ")},j.map(k)},mg.splitTextToSize=function(a,i,o){var c,u=(o=o||{}).fontSize||this.internal.getFontSize(),r=(function(D){if(D.widths&&D.kerning)return{widths:D.widths,kerning:D.kerning};var j=this.internal.getFont(D.fontName,D.fontStyle);return j.metadata.Unicode?{widths:j.metadata.Unicode.widths||{0:1},kerning:j.metadata.Unicode.kerning||{}}:{font:j.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,o);c=Array.isArray(a)?a:String(a).split(/\r?\n/);var _=1*this.internal.scaleFactor*i/u;r.textIndent=o.textIndent?1*o.textIndent*this.internal.scaleFactor/u:0,r.lineIndent=o.lineIndent;var T,E,k=[];for(T=0,E=c.length;T<E;T++)k=k.concat(DD.apply(this,[c[T],_,r]));return k},function(a){a.__fontmetrics__=a.__fontmetrics__||{};for(var i="klmnopqrstuvwxyz",o={},c={},u=0;u<i.length;u++)o[i[u]]="0123456789abcdef"[u],c["0123456789abcdef"[u]]=i[u];var r=function(j){return"0x"+parseInt(j,10).toString(16)},_=a.__fontmetrics__.compress=function(j){var B,P,ee,G,K=["{"];for(var J in j){if(B=j[J],isNaN(parseInt(J,10))?P="'"+J+"'":(J=parseInt(J,10),P=(P=r(J).slice(2)).slice(0,-1)+c[P.slice(-1)]),typeof B=="number")B<0?(ee=r(B).slice(3),G="-"):(ee=r(B).slice(2),G=""),ee=G+ee.slice(0,-1)+c[ee.slice(-1)];else{if(Pa(B)!=="object")throw new Error("Don't know what to do with value type "+Pa(B)+".");ee=_(B)}K.push(P+ee)}return K.push("}"),K.join("")},T=a.__fontmetrics__.uncompress=function(j){if(typeof j!="string")throw new Error("Invalid argument passed to uncompress.");for(var B,P,ee,G,K={},J=1,ne=K,he=[],Me="",Re="",et=j.length-1,Te=1;Te<et;Te+=1)(G=j[Te])=="'"?B?(ee=B.join(""),B=void 0):B=[]:B?B.push(G):G=="{"?(he.push([ne,ee]),ne={},ee=void 0):G=="}"?((P=he.pop())[0][P[1]]=ne,ee=void 0,ne=P[0]):G=="-"?J=-1:ee===void 0?o.hasOwnProperty(G)?(Me+=o[G],ee=parseInt(Me,16)*J,J=1,Me=""):Me+=G:o.hasOwnProperty(G)?(Re+=o[G],ne[ee]=parseInt(Re,16)*J,J=1,ee=void 0,Re=""):Re+=G;return K},E={codePages:["WinAnsiEncoding"],WinAnsiEncoding:T("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},k={Unicode:{Courier:E,"Courier-Bold":E,"Courier-BoldOblique":E,"Courier-Oblique":E,Helvetica:E,"Helvetica-Bold":E,"Helvetica-BoldOblique":E,"Helvetica-Oblique":E,"Times-Roman":E,"Times-Bold":E,"Times-BoldItalic":E,"Times-Italic":E}},D={Unicode:{"Courier-Oblique":T("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":T("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":T("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:T("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":T("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":T("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:T("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:T("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":T("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:T("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":T("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":T("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":T("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":T("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};a.events.push(["addFont",function(j){var B=j.font,P=D.Unicode[B.postScriptName];P&&(B.metadata.Unicode={},B.metadata.Unicode.widths=P.widths,B.metadata.Unicode.kerning=P.kerning);var ee=k.Unicode[B.postScriptName];ee&&(B.metadata.Unicode.encoding=ee,B.encoding=ee.codePages[0])}])}(Bi.API),function(a){var i=function(o){for(var c=o.length,u=new Uint8Array(c),r=0;r<c;r++)u[r]=o.charCodeAt(r);return u};a.API.events.push(["addFont",function(o){var c=void 0,u=o.font,r=o.instance;if(!u.isStandardFont){if(r===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+u.postScriptName+"').");if(typeof(c=r.existsFileInVFS(u.postScriptName)===!1?r.loadFile(u.postScriptName):r.getFileFromVFS(u.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+u.postScriptName+"').");(function(_,T){T=/^\x00\x01\x00\x00/.test(T)?i(T):i(w1(T)),_.metadata=a.API.TTFFont.open(T),_.metadata.Unicode=_.metadata.Unicode||{encoding:{},kerning:{},widths:[]},_.metadata.glyIdsUsed=[0]})(u,c)}}])}(Bi),function(a){function i(){return(Wi.canvg?Promise.resolve(Wi.canvg):import("./chunk-7YNMYPTA.js")).catch(function(o){return Promise.reject(new Error("Could not load canvg: "+o))}).then(function(o){return o.default?o.default:o})}Bi.API.addSvgAsImage=function(o,c,u,r,_,T,E,k){if(isNaN(c)||isNaN(u))throw ja.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(_))throw ja.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var D=document.createElement("canvas");D.width=r,D.height=_;var j=D.getContext("2d");j.fillStyle="#fff",j.fillRect(0,0,D.width,D.height);var B={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},P=this;return i().then(function(ee){return ee.fromString(j,o,B)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(ee){return ee.render(B)}).then(function(){P.addImage(D.toDataURL("image/jpeg",1),c,u,r,_,E,k)})}}(),Bi.API.putTotalPages=function(a){var i,o=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(i=new RegExp(a,"g"),o=this.internal.getNumberOfPages()):(i=new RegExp(this.pdfEscape16(a,this.internal.getFont()),"g"),o=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var c=1;c<=this.internal.getNumberOfPages();c++)for(var u=0;u<this.internal.pages[c].length;u++)this.internal.pages[c][u]=this.internal.pages[c][u].replace(i,o);return this},Bi.API.viewerPreferences=function(a,i){var o;a=a||{},i=i||!1;var c,u,r,_={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},T=Object.keys(_),E=[],k=0,D=0,j=0;function B(ee,G){var K,J=!1;for(K=0;K<ee.length;K+=1)ee[K]===G&&(J=!0);return J}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(_)),this.internal.viewerpreferences.isSubscribed=!1),o=this.internal.viewerpreferences.configuration,a==="reset"||i===!0){var P=T.length;for(j=0;j<P;j+=1)o[T[j]].value=o[T[j]].defaultValue,o[T[j]].explicitSet=!1}if(Pa(a)==="object"){for(u in a)if(r=a[u],B(T,u)&&r!==void 0){if(o[u].type==="boolean"&&typeof r=="boolean")o[u].value=r;else if(o[u].type==="name"&&B(o[u].valueSet,r))o[u].value=r;else if(o[u].type==="integer"&&Number.isInteger(r))o[u].value=r;else if(o[u].type==="array"){for(k=0;k<r.length;k+=1)if(c=!0,r[k].length===1&&typeof r[k][0]=="number")E.push(String(r[k]-1));else if(r[k].length>1){for(D=0;D<r[k].length;D+=1)typeof r[k][D]!="number"&&(c=!1);c===!0&&E.push([r[k][0]-1,r[k][1]-1].join(" "))}o[u].value="["+E.join(" ")+"]"}else o[u].value=o[u].defaultValue;o[u].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var ee,G=[];for(ee in o)o[ee].explicitSet===!0&&(o[ee].type==="name"?G.push("/"+ee+" /"+o[ee].value):G.push("/"+ee+" "+o[ee].value));G.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+G.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=o,this},function(a){var i=function(){var c='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',u=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),r=unescape(encodeURIComponent(c)),_=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),T=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),E=unescape(encodeURIComponent("</x:xmpmeta>")),k=r.length+_.length+T.length+u.length+E.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+k+" >>"),this.internal.write("stream"),this.internal.write(u+r+_+T+E),this.internal.write("endstream"),this.internal.write("endobj")},o=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};a.addMetadata=function(c,u){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:c,namespaceuri:u||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",o),this.internal.events.subscribe("postPutResources",i)),this}}(Bi.API),function(a){var i=a.API,o=i.pdfEscape16=function(r,_){for(var T,E=_.metadata.Unicode.widths,k=["","0","00","000","0000"],D=[""],j=0,B=r.length;j<B;++j){if(T=_.metadata.characterToGlyph(r.charCodeAt(j)),_.metadata.glyIdsUsed.push(T),_.metadata.toUnicode[T]=r.charCodeAt(j),E.indexOf(T)==-1&&(E.push(T),E.push([parseInt(_.metadata.widthOfGlyph(T),10)])),T=="0")return D.join("");T=T.toString(16),D.push(k[4-T.length],T)}return D.join("")},c=function(r){var _,T,E,k,D,j,B;for(D=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,E=[],j=0,B=(T=Object.keys(r).sort(function(P,ee){return P-ee})).length;j<B;j++)_=T[j],E.length>=100&&(D+=`
`+E.length+` beginbfchar
`+E.join(`
`)+`
endbfchar`,E=[]),r[_]!==void 0&&r[_]!==null&&typeof r[_].toString=="function"&&(k=("0000"+r[_].toString(16)).slice(-4),_=("0000"+(+_).toString(16)).slice(-4),E.push("<"+_+"><"+k+">"));return E.length&&(D+=`
`+E.length+` beginbfchar
`+E.join(`
`)+`
endbfchar
`),D+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};i.events.push(["putFont",function(r){(function(_){var T=_.font,E=_.out,k=_.newObject,D=_.putStream;if(T.metadata instanceof a.API.TTFFont&&T.encoding==="Identity-H"){for(var j=T.metadata.Unicode.widths,B=T.metadata.subset.encode(T.metadata.glyIdsUsed,1),P="",ee=0;ee<B.length;ee++)P+=String.fromCharCode(B[ee]);var G=k();D({data:P,addLength1:!0,objectId:G}),E("endobj");var K=k();D({data:c(T.metadata.toUnicode),addLength1:!0,objectId:K}),E("endobj");var J=k();E("<<"),E("/Type /FontDescriptor"),E("/FontName /"+_g(T.fontName)),E("/FontFile2 "+G+" 0 R"),E("/FontBBox "+a.API.PDFObject.convert(T.metadata.bbox)),E("/Flags "+T.metadata.flags),E("/StemV "+T.metadata.stemV),E("/ItalicAngle "+T.metadata.italicAngle),E("/Ascent "+T.metadata.ascender),E("/Descent "+T.metadata.decender),E("/CapHeight "+T.metadata.capHeight),E(">>"),E("endobj");var ne=k();E("<<"),E("/Type /Font"),E("/BaseFont /"+_g(T.fontName)),E("/FontDescriptor "+J+" 0 R"),E("/W "+a.API.PDFObject.convert(j)),E("/CIDToGIDMap /Identity"),E("/DW 1000"),E("/Subtype /CIDFontType2"),E("/CIDSystemInfo"),E("<<"),E("/Supplement 0"),E("/Registry (Adobe)"),E("/Ordering ("+T.encoding+")"),E(">>"),E(">>"),E("endobj"),T.objectNumber=k(),E("<<"),E("/Type /Font"),E("/Subtype /Type0"),E("/ToUnicode "+K+" 0 R"),E("/BaseFont /"+_g(T.fontName)),E("/Encoding /"+T.encoding),E("/DescendantFonts ["+ne+" 0 R]"),E(">>"),E("endobj"),T.isAlreadyPutted=!0}})(r)}]),i.events.push(["putFont",function(r){(function(_){var T=_.font,E=_.out,k=_.newObject,D=_.putStream;if(T.metadata instanceof a.API.TTFFont&&T.encoding==="WinAnsiEncoding"){for(var j=T.metadata.rawData,B="",P=0;P<j.length;P++)B+=String.fromCharCode(j[P]);var ee=k();D({data:B,addLength1:!0,objectId:ee}),E("endobj");var G=k();D({data:c(T.metadata.toUnicode),addLength1:!0,objectId:G}),E("endobj");var K=k();E("<<"),E("/Descent "+T.metadata.decender),E("/CapHeight "+T.metadata.capHeight),E("/StemV "+T.metadata.stemV),E("/Type /FontDescriptor"),E("/FontFile2 "+ee+" 0 R"),E("/Flags 96"),E("/FontBBox "+a.API.PDFObject.convert(T.metadata.bbox)),E("/FontName /"+_g(T.fontName)),E("/ItalicAngle "+T.metadata.italicAngle),E("/Ascent "+T.metadata.ascender),E(">>"),E("endobj"),T.objectNumber=k();for(var J=0;J<T.metadata.hmtx.widths.length;J++)T.metadata.hmtx.widths[J]=parseInt(T.metadata.hmtx.widths[J]*(1e3/T.metadata.head.unitsPerEm));E("<</Subtype/TrueType/Type/Font/ToUnicode "+G+" 0 R/BaseFont/"+_g(T.fontName)+"/FontDescriptor "+K+" 0 R/Encoding/"+T.encoding+" /FirstChar 29 /LastChar 255 /Widths "+a.API.PDFObject.convert(T.metadata.hmtx.widths)+">>"),E("endobj"),T.isAlreadyPutted=!0}})(r)}]);var u=function(r){var _,T=r.text||"",E=r.x,k=r.y,D=r.options||{},j=r.mutex||{},B=j.pdfEscape,P=j.activeFontKey,ee=j.fonts,G=P,K="",J=0,ne="",he=ee[G].encoding;if(ee[G].encoding!=="Identity-H")return{text:T,x:E,y:k,options:D,mutex:j};for(ne=T,G=P,Array.isArray(T)&&(ne=T[0]),J=0;J<ne.length;J+=1)ee[G].metadata.hasOwnProperty("cmap")&&(_=ee[G].metadata.cmap.unicode.codeMap[ne[J].charCodeAt(0)]),_||ne[J].charCodeAt(0)<256&&ee[G].metadata.hasOwnProperty("Unicode")?K+=ne[J]:K+="";var Me="";return parseInt(G.slice(1))<14||he==="WinAnsiEncoding"?Me=B(K,G).split("").map(function(Re){return Re.charCodeAt(0).toString(16)}).join(""):he==="Identity-H"&&(Me=o(K,ee[G])),j.isHex=!0,{text:Me,x:E,y:k,options:D,mutex:j}};i.events.push(["postProcessText",function(r){var _=r.text||"",T=[],E={text:_,x:r.x,y:r.y,options:r.options,mutex:r.mutex};if(Array.isArray(_)){var k=0;for(k=0;k<_.length;k+=1)Array.isArray(_[k])&&_[k].length===3?T.push([u(Object.assign({},E,{text:_[k][0]})).text,_[k][1],_[k][2]]):T.push(u(Object.assign({},E,{text:_[k]})).text);r.text=T}else r.text=u(Object.assign({},E,{text:_})).text}])}(Bi),function(a){var i=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};a.existsFileInVFS=function(o){return i.call(this),this.internal.vFS[o]!==void 0},a.addFileToVFS=function(o,c){return i.call(this),this.internal.vFS[o]=c,this},a.getFileFromVFS=function(o){return i.call(this),this.internal.vFS[o]!==void 0?this.internal.vFS[o]:null}}(Bi.API),function(a){a.__bidiEngine__=a.prototype.__bidiEngine__=function(c){var u,r,_,T,E,k,D,j=i,B=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],P=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],ee={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},G={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},K=["(",")","(","<",">","<","[","]","[","{","}","{","\xAB","\xBB","\xAB","\u2039","\u203A","\u2039","\u2045","\u2046","\u2045","\u207D","\u207E","\u207D","\u208D","\u208E","\u208D","\u2264","\u2265","\u2264","\u2329","\u232A","\u2329","\uFE59","\uFE5A","\uFE59","\uFE5B","\uFE5C","\uFE5B","\uFE5D","\uFE5E","\uFE5D","\uFE64","\uFE65","\uFE64"],J=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),ne=!1,he=0;this.__bidiEngine__={};var Me=function(_e){var ve=_e.charCodeAt(),Qe=ve>>8,Ce=G[Qe];return Ce!==void 0?j[256*Ce+(255&ve)]:Qe===252||Qe===253?"AL":J.test(Qe)?"L":Qe===8?"R":"N"},Re=function(_e){for(var ve,Qe=0;Qe<_e.length;Qe++){if((ve=Me(_e.charAt(Qe)))==="L")return!1;if(ve==="R")return!0}return!1},et=function(_e,ve,Qe,Ce){var Ye,ut,st,pt,Tt=ve[Ce];switch(Tt){case"L":case"R":ne=!1;break;case"N":case"AN":break;case"EN":ne&&(Tt="AN");break;case"AL":ne=!0,Tt="R";break;case"WS":Tt="N";break;case"CS":Ce<1||Ce+1>=ve.length||(Ye=Qe[Ce-1])!=="EN"&&Ye!=="AN"||(ut=ve[Ce+1])!=="EN"&&ut!=="AN"?Tt="N":ne&&(ut="AN"),Tt=ut===Ye?ut:"N";break;case"ES":Tt=(Ye=Ce>0?Qe[Ce-1]:"B")==="EN"&&Ce+1<ve.length&&ve[Ce+1]==="EN"?"EN":"N";break;case"ET":if(Ce>0&&Qe[Ce-1]==="EN"){Tt="EN";break}if(ne){Tt="N";break}for(st=Ce+1,pt=ve.length;st<pt&&ve[st]==="ET";)st++;Tt=st<pt&&ve[st]==="EN"?"EN":"N";break;case"NSM":if(_&&!T){for(pt=ve.length,st=Ce+1;st<pt&&ve[st]==="NSM";)st++;if(st<pt){var ht=_e[Ce],Wt=ht>=1425&&ht<=2303||ht===64286;if(Ye=ve[st],Wt&&(Ye==="R"||Ye==="AL")){Tt="R";break}}}Tt=Ce<1||(Ye=ve[Ce-1])==="B"?"N":Qe[Ce-1];break;case"B":ne=!1,u=!0,Tt=he;break;case"S":r=!0,Tt="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":ne=!1;break;case"BN":Tt="N"}return Tt},Te=function(_e,ve,Qe){var Ce=_e.split("");return Qe&&ge(Ce,Qe,{hiLevel:he}),Ce.reverse(),ve&&ve.reverse(),Ce.join("")},ge=function(_e,ve,Qe){var Ce,Ye,ut,st,pt,Tt=-1,ht=_e.length,Wt=0,re=[],xe=he?P:B,pe=[];for(ne=!1,u=!1,r=!1,Ye=0;Ye<ht;Ye++)pe[Ye]=Me(_e[Ye]);for(ut=0;ut<ht;ut++){if(pt=Wt,re[ut]=et(_e,pe,re,ut),Ce=240&(Wt=xe[pt][ee[re[ut]]]),Wt&=15,ve[ut]=st=xe[Wt][5],Ce>0)if(Ce===16){for(Ye=Tt;Ye<ut;Ye++)ve[Ye]=1;Tt=-1}else Tt=-1;if(xe[Wt][6])Tt===-1&&(Tt=ut);else if(Tt>-1){for(Ye=Tt;Ye<ut;Ye++)ve[Ye]=st;Tt=-1}pe[ut]==="B"&&(ve[ut]=0),Qe.hiLevel|=st}r&&function(Ie,Ve,gt){for(var mt=0;mt<gt;mt++)if(Ie[mt]==="S"){Ve[mt]=he;for(var wt=mt-1;wt>=0&&Ie[wt]==="WS";wt--)Ve[wt]=he}}(pe,ve,ht)},Ue=function(_e,ve,Qe,Ce,Ye){if(!(Ye.hiLevel<_e)){if(_e===1&&he===1&&!u)return ve.reverse(),void(Qe&&Qe.reverse());for(var ut,st,pt,Tt,ht=ve.length,Wt=0;Wt<ht;){if(Ce[Wt]>=_e){for(pt=Wt+1;pt<ht&&Ce[pt]>=_e;)pt++;for(Tt=Wt,st=pt-1;Tt<st;Tt++,st--)ut=ve[Tt],ve[Tt]=ve[st],ve[st]=ut,Qe&&(ut=Qe[Tt],Qe[Tt]=Qe[st],Qe[st]=ut);Wt=pt}Wt++}}},Ae=function(_e,ve,Qe){var Ce=_e.split(""),Ye={hiLevel:he};return Qe||(Qe=[]),ge(Ce,Qe,Ye),function(ut,st,pt){if(pt.hiLevel!==0&&D)for(var Tt,ht=0;ht<ut.length;ht++)st[ht]===1&&(Tt=K.indexOf(ut[ht]))>=0&&(ut[ht]=K[Tt+1])}(Ce,Qe,Ye),Ue(2,Ce,ve,Qe,Ye),Ue(1,Ce,ve,Qe,Ye),Ce.join("")};return this.__bidiEngine__.doBidiReorder=function(_e,ve,Qe){if(function(Ye,ut){if(ut)for(var st=0;st<Ye.length;st++)ut[st]=st;T===void 0&&(T=Re(Ye)),k===void 0&&(k=Re(Ye))}(_e,ve),_||!E||k)if(_&&E&&T^k)he=T?1:0,_e=Te(_e,ve,Qe);else if(!_&&E&&k)he=T?1:0,_e=Ae(_e,ve,Qe),_e=Te(_e,ve);else if(!_||T||E||k){if(_&&!E&&T^k)_e=Te(_e,ve),T?(he=0,_e=Ae(_e,ve,Qe)):(he=1,_e=Ae(_e,ve,Qe),_e=Te(_e,ve));else if(_&&T&&!E&&k)he=1,_e=Ae(_e,ve,Qe),_e=Te(_e,ve);else if(!_&&!E&&T^k){var Ce=D;T?(he=1,_e=Ae(_e,ve,Qe),he=0,D=!1,_e=Ae(_e,ve,Qe),D=Ce):(he=0,_e=Ae(_e,ve,Qe),_e=Te(_e,ve),he=1,D=!1,_e=Ae(_e,ve,Qe),D=Ce,_e=Te(_e,ve))}}else he=0,_e=Ae(_e,ve,Qe);else he=T?1:0,_e=Ae(_e,ve,Qe);return _e},this.__bidiEngine__.setOptions=function(_e){_e&&(_=_e.isInputVisual,E=_e.isOutputVisual,T=_e.isInputRtl,k=_e.isOutputRtl,D=_e.isSymmetricSwapping)},this.__bidiEngine__.setOptions(c),this.__bidiEngine__};var i=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],o=new a.__bidiEngine__({isInputVisual:!0});a.API.events.push(["postProcessText",function(c){var u=c.text,r=(c.x,c.y,c.options||{}),_=(c.mutex,r.lang,[]);if(r.isInputVisual=typeof r.isInputVisual!="boolean"||r.isInputVisual,o.setOptions(r),Object.prototype.toString.call(u)==="[object Array]"){var T=0;for(_=[],T=0;T<u.length;T+=1)Object.prototype.toString.call(u[T])==="[object Array]"?_.push([o.doBidiReorder(u[T][0]),u[T][1],u[T][2]]):_.push([o.doBidiReorder(u[T])]);c.text=_}else c.text=o.doBidiReorder(u);o.setOptions({isInputVisual:!0})}])}(Bi),Bi.API.TTFFont=function(){function a(i){var o;if(this.rawData=i,o=this.contents=new Ap(i),this.contents.pos=4,o.readString(4)==="ttcf")throw new Error("TTCF not supported.");o.pos=0,this.parse(),this.subset=new yW(this),this.registerTTF()}return a.open=function(i){return new a(i)},a.prototype.parse=function(){return this.directory=new aW(this.contents),this.head=new sW(this),this.name=new dW(this),this.cmap=new WD(this),this.toUnicode={},this.hhea=new lW(this),this.maxp=new fW(this),this.hmtx=new pW(this),this.post=new uW(this),this.os2=new cW(this),this.loca=new vW(this),this.glyf=new mW(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},a.prototype.registerTTF=function(){var i,o,c,u,r;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var _,T,E,k;for(k=[],_=0,T=(E=this.bbox).length;_<T;_++)i=E[_],k.push(Math.round(i*this.scaleFactor));return k}).call(this),this.stemV=0,this.post.exists?(c=255&(u=this.post.italic_angle),32768&(o=u>>16)&&(o=-(1+(65535^o))),this.italicAngle=+(o+"."+c)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(r=this.familyClass)===1||r===2||r===3||r===4||r===5||r===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},a.prototype.characterToGlyph=function(i){var o;return((o=this.cmap.unicode)!=null?o.codeMap[i]:void 0)||0},a.prototype.widthOfGlyph=function(i){var o;return o=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(i).advance*o},a.prototype.widthOfString=function(i,o,c){var u,r,_,T;for(_=0,r=0,T=(i=""+i).length;0<=T?r<T:r>T;r=0<=T?++r:--r)u=i.charCodeAt(r),_+=this.widthOfGlyph(this.characterToGlyph(u))+c*(1e3/o)||0;return _*(o/1e3)},a.prototype.lineHeight=function(i,o){var c;return o==null&&(o=!1),c=o?this.lineGap:0,(this.ascender+c-this.decender)/1e3*i},a}();Ap=function(){function a(i){this.data=i??[],this.pos=0,this.length=this.data.length}return a.prototype.readByte=function(){return this.data[this.pos++]},a.prototype.writeByte=function(i){return this.data[this.pos++]=i},a.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},a.prototype.writeUInt32=function(i){return this.writeByte(i>>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i)},a.prototype.readInt32=function(){var i;return(i=this.readUInt32())>=2147483648?i-4294967296:i},a.prototype.writeInt32=function(i){return i<0&&(i+=4294967296),this.writeUInt32(i)},a.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},a.prototype.writeUInt16=function(i){return this.writeByte(i>>8&255),this.writeByte(255&i)},a.prototype.readInt16=function(){var i;return(i=this.readUInt16())>=32768?i-65536:i},a.prototype.writeInt16=function(i){return i<0&&(i+=65536),this.writeUInt16(i)},a.prototype.readString=function(i){var o,c;for(c=[],o=0;0<=i?o<i:o>i;o=0<=i?++o:--o)c[o]=String.fromCharCode(this.readByte());return c.join("")},a.prototype.writeString=function(i){var o,c,u;for(u=[],o=0,c=i.length;0<=c?o<c:o>c;o=0<=c?++o:--o)u.push(this.writeByte(i.charCodeAt(o)));return u},a.prototype.readShort=function(){return this.readInt16()},a.prototype.writeShort=function(i){return this.writeInt16(i)},a.prototype.readLongLong=function(){var i,o,c,u,r,_,T,E;return i=this.readByte(),o=this.readByte(),c=this.readByte(),u=this.readByte(),r=this.readByte(),_=this.readByte(),T=this.readByte(),E=this.readByte(),128&i?-1*(72057594037927940*(255^i)+281474976710656*(255^o)+1099511627776*(255^c)+4294967296*(255^u)+16777216*(255^r)+65536*(255^_)+256*(255^T)+(255^E)+1):72057594037927940*i+281474976710656*o+1099511627776*c+4294967296*u+16777216*r+65536*_+256*T+E},a.prototype.writeLongLong=function(i){var o,c;return o=Math.floor(i/4294967296),c=4294967295&i,this.writeByte(o>>24&255),this.writeByte(o>>16&255),this.writeByte(o>>8&255),this.writeByte(255&o),this.writeByte(c>>24&255),this.writeByte(c>>16&255),this.writeByte(c>>8&255),this.writeByte(255&c)},a.prototype.readInt=function(){return this.readInt32()},a.prototype.writeInt=function(i){return this.writeInt32(i)},a.prototype.read=function(i){var o,c;for(o=[],c=0;0<=i?c<i:c>i;c=0<=i?++c:--c)o.push(this.readByte());return o},a.prototype.write=function(i){var o,c,u,r;for(r=[],c=0,u=i.length;c<u;c++)o=i[c],r.push(this.writeByte(o));return r},a}(),aW=function(){var a;function i(o){var c,u,r;for(this.scalarType=o.readInt(),this.tableCount=o.readShort(),this.searchRange=o.readShort(),this.entrySelector=o.readShort(),this.rangeShift=o.readShort(),this.tables={},u=0,r=this.tableCount;0<=r?u<r:u>r;u=0<=r?++u:--u)c={tag:o.readString(4),checksum:o.readInt(),offset:o.readInt(),length:o.readInt()},this.tables[c.tag]=c}return i.prototype.encode=function(o){var c,u,r,_,T,E,k,D,j,B,P,ee,G;for(G in P=Object.keys(o).length,E=Math.log(2),j=16*Math.floor(Math.log(P)/E),_=Math.floor(j/E),D=16*P-j,(u=new Ap).writeInt(this.scalarType),u.writeShort(P),u.writeShort(j),u.writeShort(_),u.writeShort(D),r=16*P,k=u.pos+r,T=null,ee=[],o)for(B=o[G],u.writeString(G),u.writeInt(a(B)),u.writeInt(k),u.writeInt(B.length),ee=ee.concat(B),G==="head"&&(T=k),k+=B.length;k%4;)ee.push(0),k++;return u.write(ee),c=2981146554-a(u.data),u.pos=T+8,u.writeUInt32(c),u.data},a=function(o){var c,u,r,_;for(o=qD.call(o);o.length%4;)o.push(0);for(r=new Ap(o),u=0,c=0,_=o.length;c<_;c=c+=4)u+=r.readUInt32();return 4294967295&u},i}(),oW={}.hasOwnProperty,pd=function(a,i){for(var o in i)oW.call(i,o)&&(a[o]=i[o]);function c(){this.constructor=a}return c.prototype=i.prototype,a.prototype=new c,a.__super__=i.prototype,a};bh=function(){function a(i){var o;this.file=i,o=this.file.directory.tables[this.tag],this.exists=!!o,o&&(this.offset=o.offset,this.length=o.length,this.parse(this.file.contents))}return a.prototype.parse=function(){},a.prototype.encode=function(){},a.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},a}();sW=function(a){function i(){return i.__super__.constructor.apply(this,arguments)}return pd(i,bh),i.prototype.tag="head",i.prototype.parse=function(o){return o.pos=this.offset,this.version=o.readInt(),this.revision=o.readInt(),this.checkSumAdjustment=o.readInt(),this.magicNumber=o.readInt(),this.flags=o.readShort(),this.unitsPerEm=o.readShort(),this.created=o.readLongLong(),this.modified=o.readLongLong(),this.xMin=o.readShort(),this.yMin=o.readShort(),this.xMax=o.readShort(),this.yMax=o.readShort(),this.macStyle=o.readShort(),this.lowestRecPPEM=o.readShort(),this.fontDirectionHint=o.readShort(),this.indexToLocFormat=o.readShort(),this.glyphDataFormat=o.readShort()},i.prototype.encode=function(o){var c;return(c=new Ap).writeInt(this.version),c.writeInt(this.revision),c.writeInt(this.checkSumAdjustment),c.writeInt(this.magicNumber),c.writeShort(this.flags),c.writeShort(this.unitsPerEm),c.writeLongLong(this.created),c.writeLongLong(this.modified),c.writeShort(this.xMin),c.writeShort(this.yMin),c.writeShort(this.xMax),c.writeShort(this.yMax),c.writeShort(this.macStyle),c.writeShort(this.lowestRecPPEM),c.writeShort(this.fontDirectionHint),c.writeShort(o),c.writeShort(this.glyphDataFormat),c.data},i}(),PD=function(){function a(i,o){var c,u,r,_,T,E,k,D,j,B,P,ee,G,K,J,ne,he;switch(this.platformID=i.readUInt16(),this.encodingID=i.readShort(),this.offset=o+i.readInt(),j=i.pos,i.pos=this.offset,this.format=i.readUInt16(),this.length=i.readUInt16(),this.language=i.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(E=0;E<256;++E)this.codeMap[E]=i.readByte();break;case 4:for(P=i.readUInt16(),B=P/2,i.pos+=6,r=function(){var Me,Re;for(Re=[],E=Me=0;0<=B?Me<B:Me>B;E=0<=B?++Me:--Me)Re.push(i.readUInt16());return Re}(),i.pos+=2,G=function(){var Me,Re;for(Re=[],E=Me=0;0<=B?Me<B:Me>B;E=0<=B?++Me:--Me)Re.push(i.readUInt16());return Re}(),k=function(){var Me,Re;for(Re=[],E=Me=0;0<=B?Me<B:Me>B;E=0<=B?++Me:--Me)Re.push(i.readUInt16());return Re}(),D=function(){var Me,Re;for(Re=[],E=Me=0;0<=B?Me<B:Me>B;E=0<=B?++Me:--Me)Re.push(i.readUInt16());return Re}(),u=(this.length-i.pos+this.offset)/2,T=function(){var Me,Re;for(Re=[],E=Me=0;0<=u?Me<u:Me>u;E=0<=u?++Me:--Me)Re.push(i.readUInt16());return Re}(),E=J=0,he=r.length;J<he;E=++J)for(K=r[E],c=ne=ee=G[E];ee<=K?ne<=K:ne>=K;c=ee<=K?++ne:--ne)D[E]===0?_=c+k[E]:(_=T[D[E]/2+(c-ee)-(B-E)]||0)!==0&&(_+=k[E]),this.codeMap[c]=65535&_}i.pos=j}return a.encode=function(i,o){var c,u,r,_,T,E,k,D,j,B,P,ee,G,K,J,ne,he,Me,Re,et,Te,ge,Ue,Ae,_e,ve,Qe,Ce,Ye,ut,st,pt,Tt,ht,Wt,re,xe,pe,Ie,Ve,gt,mt,wt,Pt,fr,xr;switch(Ce=new Ap,_=Object.keys(i).sort(function(Rr,Fr){return Rr-Fr}),o){case"macroman":for(G=0,K=function(){var Rr=[];for(ee=0;ee<256;++ee)Rr.push(0);return Rr}(),ne={0:0},r={},Ye=0,Tt=_.length;Ye<Tt;Ye++)ne[wt=i[u=_[Ye]]]==null&&(ne[wt]=++G),r[u]={old:i[u],new:ne[i[u]]},K[u]=ne[i[u]];return Ce.writeUInt16(1),Ce.writeUInt16(0),Ce.writeUInt32(12),Ce.writeUInt16(0),Ce.writeUInt16(262),Ce.writeUInt16(0),Ce.write(K),{charMap:r,subtable:Ce.data,maxGlyphID:G+1};case"unicode":for(ve=[],j=[],he=0,ne={},c={},J=k=null,ut=0,ht=_.length;ut<ht;ut++)ne[Re=i[u=_[ut]]]==null&&(ne[Re]=++he),c[u]={old:Re,new:ne[Re]},T=ne[Re]-u,J!=null&&T===k||(J&&j.push(J),ve.push(u),k=T),J=u;for(J&&j.push(J),j.push(65535),ve.push(65535),Ae=2*(Ue=ve.length),ge=2*Math.pow(Math.log(Ue)/Math.LN2,2),B=Math.log(ge/2)/Math.LN2,Te=2*Ue-ge,E=[],et=[],P=[],ee=st=0,Wt=ve.length;st<Wt;ee=++st){if(_e=ve[ee],D=j[ee],_e===65535){E.push(0),et.push(0);break}if(_e-(Qe=c[_e].new)>=32768)for(E.push(0),et.push(2*(P.length+Ue-ee)),u=pt=_e;_e<=D?pt<=D:pt>=D;u=_e<=D?++pt:--pt)P.push(c[u].new);else E.push(Qe-_e),et.push(0)}for(Ce.writeUInt16(3),Ce.writeUInt16(1),Ce.writeUInt32(12),Ce.writeUInt16(4),Ce.writeUInt16(16+8*Ue+2*P.length),Ce.writeUInt16(0),Ce.writeUInt16(Ae),Ce.writeUInt16(ge),Ce.writeUInt16(B),Ce.writeUInt16(Te),gt=0,re=j.length;gt<re;gt++)u=j[gt],Ce.writeUInt16(u);for(Ce.writeUInt16(0),mt=0,xe=ve.length;mt<xe;mt++)u=ve[mt],Ce.writeUInt16(u);for(Pt=0,pe=E.length;Pt<pe;Pt++)T=E[Pt],Ce.writeUInt16(T);for(fr=0,Ie=et.length;fr<Ie;fr++)Me=et[fr],Ce.writeUInt16(Me);for(xr=0,Ve=P.length;xr<Ve;xr++)G=P[xr],Ce.writeUInt16(G);return{charMap:c,subtable:Ce.data,maxGlyphID:he+1}}},a}(),WD=function(a){function i(){return i.__super__.constructor.apply(this,arguments)}return pd(i,bh),i.prototype.tag="cmap",i.prototype.parse=function(o){var c,u,r;for(o.pos=this.offset,this.version=o.readUInt16(),r=o.readUInt16(),this.tables=[],this.unicode=null,u=0;0<=r?u<r:u>r;u=0<=r?++u:--u)c=new PD(o,this.offset),this.tables.push(c),c.isUnicode&&this.unicode==null&&(this.unicode=c);return!0},i.encode=function(o,c){var u,r;return c==null&&(c="macroman"),u=PD.encode(o,c),(r=new Ap).writeUInt16(0),r.writeUInt16(1),u.table=r.data.concat(u.subtable),u},i}(),lW=function(a){function i(){return i.__super__.constructor.apply(this,arguments)}return pd(i,bh),i.prototype.tag="hhea",i.prototype.parse=function(o){return o.pos=this.offset,this.version=o.readInt(),this.ascender=o.readShort(),this.decender=o.readShort(),this.lineGap=o.readShort(),this.advanceWidthMax=o.readShort(),this.minLeftSideBearing=o.readShort(),this.minRightSideBearing=o.readShort(),this.xMaxExtent=o.readShort(),this.caretSlopeRise=o.readShort(),this.caretSlopeRun=o.readShort(),this.caretOffset=o.readShort(),o.pos+=8,this.metricDataFormat=o.readShort(),this.numberOfMetrics=o.readUInt16()},i}(),cW=function(a){function i(){return i.__super__.constructor.apply(this,arguments)}return pd(i,bh),i.prototype.tag="OS/2",i.prototype.parse=function(o){if(o.pos=this.offset,this.version=o.readUInt16(),this.averageCharWidth=o.readShort(),this.weightClass=o.readUInt16(),this.widthClass=o.readUInt16(),this.type=o.readShort(),this.ySubscriptXSize=o.readShort(),this.ySubscriptYSize=o.readShort(),this.ySubscriptXOffset=o.readShort(),this.ySubscriptYOffset=o.readShort(),this.ySuperscriptXSize=o.readShort(),this.ySuperscriptYSize=o.readShort(),this.ySuperscriptXOffset=o.readShort(),this.ySuperscriptYOffset=o.readShort(),this.yStrikeoutSize=o.readShort(),this.yStrikeoutPosition=o.readShort(),this.familyClass=o.readShort(),this.panose=function(){var c,u;for(u=[],c=0;c<10;++c)u.push(o.readByte());return u}(),this.charRange=function(){var c,u;for(u=[],c=0;c<4;++c)u.push(o.readInt());return u}(),this.vendorID=o.readString(4),this.selection=o.readShort(),this.firstCharIndex=o.readShort(),this.lastCharIndex=o.readShort(),this.version>0&&(this.ascent=o.readShort(),this.descent=o.readShort(),this.lineGap=o.readShort(),this.winAscent=o.readShort(),this.winDescent=o.readShort(),this.codePageRange=function(){var c,u;for(u=[],c=0;c<2;c=++c)u.push(o.readInt());return u}(),this.version>1))return this.xHeight=o.readShort(),this.capHeight=o.readShort(),this.defaultChar=o.readShort(),this.breakChar=o.readShort(),this.maxContext=o.readShort()},i}(),uW=function(a){function i(){return i.__super__.constructor.apply(this,arguments)}return pd(i,bh),i.prototype.tag="post",i.prototype.parse=function(o){var c,u,r;switch(o.pos=this.offset,this.format=o.readInt(),this.italicAngle=o.readInt(),this.underlinePosition=o.readShort(),this.underlineThickness=o.readShort(),this.isFixedPitch=o.readInt(),this.minMemType42=o.readInt(),this.maxMemType42=o.readInt(),this.minMemType1=o.readInt(),this.maxMemType1=o.readInt(),this.format){case 65536:break;case 131072:var _;for(u=o.readUInt16(),this.glyphNameIndex=[],_=0;0<=u?_<u:_>u;_=0<=u?++_:--_)this.glyphNameIndex.push(o.readUInt16());for(this.names=[],r=[];o.pos<this.offset+this.length;)c=o.readByte(),r.push(this.names.push(o.readString(c)));return r;case 151552:return u=o.readUInt16(),this.offsets=o.read(u);case 196608:break;case 262144:return this.map=(function(){var T,E,k;for(k=[],_=T=0,E=this.file.maxp.numGlyphs;0<=E?T<E:T>E;_=0<=E?++T:--T)k.push(o.readUInt32());return k}).call(this)}},i}(),hW=function(a,i){this.raw=a,this.length=a.length,this.platformID=i.platformID,this.encodingID=i.encodingID,this.languageID=i.languageID},dW=function(a){function i(){return i.__super__.constructor.apply(this,arguments)}return pd(i,bh),i.prototype.tag="name",i.prototype.parse=function(o){var c,u,r,_,T,E,k,D,j,B,P;for(o.pos=this.offset,o.readShort(),c=o.readShort(),E=o.readShort(),u=[],_=0;0<=c?_<c:_>c;_=0<=c?++_:--_)u.push({platformID:o.readShort(),encodingID:o.readShort(),languageID:o.readShort(),nameID:o.readShort(),length:o.readShort(),offset:this.offset+E+o.readShort()});for(k={},_=j=0,B=u.length;j<B;_=++j)r=u[_],o.pos=r.offset,D=o.readString(r.length),T=new hW(D,r),k[P=r.nameID]==null&&(k[P]=[]),k[r.nameID].push(T);this.strings=k,this.copyright=k[0],this.fontFamily=k[1],this.fontSubfamily=k[2],this.uniqueSubfamily=k[3],this.fontName=k[4],this.version=k[5];try{this.postscriptName=k[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=k[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=k[7],this.manufacturer=k[8],this.designer=k[9],this.description=k[10],this.vendorUrl=k[11],this.designerUrl=k[12],this.license=k[13],this.licenseUrl=k[14],this.preferredFamily=k[15],this.preferredSubfamily=k[17],this.compatibleFull=k[18],this.sampleText=k[19]},i}(),fW=function(a){function i(){return i.__super__.constructor.apply(this,arguments)}return pd(i,bh),i.prototype.tag="maxp",i.prototype.parse=function(o){return o.pos=this.offset,this.version=o.readInt(),this.numGlyphs=o.readUInt16(),this.maxPoints=o.readUInt16(),this.maxContours=o.readUInt16(),this.maxCompositePoints=o.readUInt16(),this.maxComponentContours=o.readUInt16(),this.maxZones=o.readUInt16(),this.maxTwilightPoints=o.readUInt16(),this.maxStorage=o.readUInt16(),this.maxFunctionDefs=o.readUInt16(),this.maxInstructionDefs=o.readUInt16(),this.maxStackElements=o.readUInt16(),this.maxSizeOfInstructions=o.readUInt16(),this.maxComponentElements=o.readUInt16(),this.maxComponentDepth=o.readUInt16()},i}(),pW=function(a){function i(){return i.__super__.constructor.apply(this,arguments)}return pd(i,bh),i.prototype.tag="hmtx",i.prototype.parse=function(o){var c,u,r,_,T,E,k;for(o.pos=this.offset,this.metrics=[],c=0,E=this.file.hhea.numberOfMetrics;0<=E?c<E:c>E;c=0<=E?++c:--c)this.metrics.push({advance:o.readUInt16(),lsb:o.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var D,j;for(j=[],c=D=0;0<=r?D<r:D>r;c=0<=r?++D:--D)j.push(o.readInt16());return j}(),this.widths=(function(){var D,j,B,P;for(P=[],D=0,j=(B=this.metrics).length;D<j;D++)_=B[D],P.push(_.advance);return P}).call(this),u=this.widths[this.widths.length-1],k=[],c=T=0;0<=r?T<r:T>r;c=0<=r?++T:--T)k.push(this.widths.push(u));return k},i.prototype.forGlyph=function(o){return o in this.metrics?this.metrics[o]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[o-this.metrics.length]}},i}(),qD=[].slice,mW=function(a){function i(){return i.__super__.constructor.apply(this,arguments)}return pd(i,bh),i.prototype.tag="glyf",i.prototype.parse=function(){return this.cache={}},i.prototype.glyphFor=function(o){var c,u,r,_,T,E,k,D,j,B;return o in this.cache?this.cache[o]:(_=this.file.loca,c=this.file.contents,u=_.indexOf(o),(r=_.lengthOf(o))===0?this.cache[o]=null:(c.pos=this.offset+u,T=(E=new Ap(c.read(r))).readShort(),D=E.readShort(),B=E.readShort(),k=E.readShort(),j=E.readShort(),this.cache[o]=T===-1?new _W(E,D,B,k,j):new gW(E,T,D,B,k,j),this.cache[o]))},i.prototype.encode=function(o,c,u){var r,_,T,E,k;for(T=[],_=[],E=0,k=c.length;E<k;E++)r=o[c[E]],_.push(T.length),r&&(T=T.concat(r.encode(u)));return _.push(T.length),{table:T,offsets:_}},i}(),gW=function(){function a(i,o,c,u,r,_){this.raw=i,this.numberOfContours=o,this.xMin=c,this.yMin=u,this.xMax=r,this.yMax=_,this.compound=!1}return a.prototype.encode=function(){return this.raw.data},a}(),_W=function(){function a(i,o,c,u,r){var _,T;for(this.raw=i,this.xMin=o,this.yMin=c,this.xMax=u,this.yMax=r,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],_=this.raw;T=_.readShort(),this.glyphOffsets.push(_.pos),this.glyphIDs.push(_.readUInt16()),32&T;)_.pos+=1&T?4:2,128&T?_.pos+=8:64&T?_.pos+=4:8&T&&(_.pos+=2)}return a.prototype.encode=function(){var i,o,c;for(o=new Ap(qD.call(this.raw.data)),i=0,c=this.glyphIDs.length;i<c;++i)o.pos=this.glyphOffsets[i];return o.data},a}(),vW=function(a){function i(){return i.__super__.constructor.apply(this,arguments)}return pd(i,bh),i.prototype.tag="loca",i.prototype.parse=function(o){var c,u;return o.pos=this.offset,c=this.file.head.indexToLocFormat,this.offsets=c===0?(function(){var r,_;for(_=[],u=0,r=this.length;u<r;u+=2)_.push(2*o.readUInt16());return _}).call(this):(function(){var r,_;for(_=[],u=0,r=this.length;u<r;u+=4)_.push(o.readUInt32());return _}).call(this)},i.prototype.indexOf=function(o){return this.offsets[o]},i.prototype.lengthOf=function(o){return this.offsets[o+1]-this.offsets[o]},i.prototype.encode=function(o,c){for(var u=new Uint32Array(this.offsets.length),r=0,_=0,T=0;T<u.length;++T)if(u[T]=r,_<c.length&&c[_]==T){++_,u[T]=r;var E=this.offsets[T],k=this.offsets[T+1]-E;k>0&&(r+=k)}for(var D=new Array(4*u.length),j=0;j<u.length;++j)D[4*j+3]=255&u[j],D[4*j+2]=(65280&u[j])>>8,D[4*j+1]=(16711680&u[j])>>16,D[4*j]=(4278190080&u[j])>>24;return D},i}(),yW=function(){function a(i){this.font=i,this.subset={},this.unicodes={},this.next=33}return a.prototype.generateCmap=function(){var i,o,c,u,r;for(o in u=this.font.cmap.tables[0].codeMap,i={},r=this.subset)c=r[o],i[o]=u[c];return i},a.prototype.glyphsFor=function(i){var o,c,u,r,_,T,E;for(u={},_=0,T=i.length;_<T;_++)u[r=i[_]]=this.font.glyf.glyphFor(r);for(r in o=[],u)(c=u[r])!=null&&c.compound&&o.push.apply(o,c.glyphIDs);if(o.length>0)for(r in E=this.glyphsFor(o))c=E[r],u[r]=c;return u},a.prototype.encode=function(i,o){var c,u,r,_,T,E,k,D,j,B,P,ee,G,K,J;for(u in c=WD.encode(this.generateCmap(),"unicode"),_=this.glyphsFor(i),P={0:0},J=c.charMap)P[(E=J[u]).old]=E.new;for(ee in B=c.maxGlyphID,_)ee in P||(P[ee]=B++);return D=function(ne){var he,Me;for(he in Me={},ne)Me[ne[he]]=he;return Me}(P),j=Object.keys(D).sort(function(ne,he){return ne-he}),G=function(){var ne,he,Me;for(Me=[],ne=0,he=j.length;ne<he;ne++)T=j[ne],Me.push(D[T]);return Me}(),r=this.font.glyf.encode(_,G,P),k=this.font.loca.encode(r.offsets,G),K={cmap:this.font.cmap.raw(),glyf:r.table,loca:k,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(o)},this.font.os2.exists&&(K["OS/2"]=this.font.os2.raw()),this.font.directory.encode(K)},a}();Bi.API.PDFObject=function(){var a;function i(){}return a=function(o,c){return(Array(c+1).join("0")+o).slice(-c)},i.convert=function(o){var c,u,r,_;if(Array.isArray(o))return"["+function(){var T,E,k;for(k=[],T=0,E=o.length;T<E;T++)c=o[T],k.push(i.convert(c));return k}().join(" ")+"]";if(typeof o=="string")return"/"+o;if(o?.isString)return"("+o+")";if(o instanceof Date)return"(D:"+a(o.getUTCFullYear(),4)+a(o.getUTCMonth(),2)+a(o.getUTCDate(),2)+a(o.getUTCHours(),2)+a(o.getUTCMinutes(),2)+a(o.getUTCSeconds(),2)+"Z)";if({}.toString.call(o)==="[object Object]"){for(u in r=["<<"],o)_=o[u],r.push("/"+u+" "+i.convert(_));return r.push(">>"),r.join(`
`)}return""+o},i}();BT=Bi});var $D=yC((Om,jT)=>{"use strict";(function(i,o){if(typeof Om=="object"&&typeof jT=="object")jT.exports=o(function(){try{return Vx(),bC(zT)}catch{}}());else if(typeof define=="function"&&define.amd)define(["jspdf"],o);else{var c=o(typeof Om=="object"?function(){try{return Vx(),bC(zT)}catch{}}():i.jspdf);for(var u in c)(typeof Om=="object"?Om:i)[u]=c[u]}})(typeof globalThis<"u"?globalThis:typeof Om<"u"?Om:typeof window<"u"?window:typeof self<"u"?self:global,function(a){return function(){"use strict";var i={172:function(r,_){var T=this&&this.__extends||function(){var D=function(j,B){return D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,ee){P.__proto__=ee}||function(P,ee){for(var G in ee)Object.prototype.hasOwnProperty.call(ee,G)&&(P[G]=ee[G])},D(j,B)};return function(j,B){if(typeof B!="function"&&B!==null)throw new TypeError("Class extends value "+String(B)+" is not a constructor or null");D(j,B);function P(){this.constructor=j}j.prototype=B===null?Object.create(B):(P.prototype=B.prototype,new P)}}();Object.defineProperty(_,"__esModule",{value:!0}),_.CellHookData=_.HookData=void 0;var E=function(){function D(j,B,P){this.table=B,this.pageNumber=B.pageNumber,this.pageCount=this.pageNumber,this.settings=B.settings,this.cursor=P,this.doc=j.getDocument()}return D}();_.HookData=E;var k=function(D){T(j,D);function j(B,P,ee,G,K,J){var ne=D.call(this,B,P,J)||this;return ne.cell=ee,ne.row=G,ne.column=K,ne.section=G.section,ne}return j}(E);_.CellHookData=k},340:function(r,_,T){Object.defineProperty(_,"__esModule",{value:!0});var E=T(4),k=T(136),D=T(744),j=T(776),B=T(664),P=T(972);function ee(G){G.API.autoTable=function(){for(var K=[],J=0;J<arguments.length;J++)K[J]=arguments[J];var ne;K.length===1?ne=K[0]:(console.error("Use of deprecated autoTable initiation"),ne=K[2]||{},ne.columns=K[0],ne.body=K[1]);var he=(0,j.parseInput)(this,ne),Me=(0,P.createTable)(this,he);return(0,B.drawTable)(this,Me),this},G.API.lastAutoTable=!1,G.API.previousAutoTable=!1,G.API.autoTable.previous=!1,G.API.autoTableText=function(K,J,ne,he){(0,k.default)(K,J,ne,he,this)},G.API.autoTableSetDefaults=function(K){return D.DocHandler.setDefaults(K,this),this},G.autoTableSetDefaults=function(K,J){D.DocHandler.setDefaults(K,J)},G.API.autoTableHtmlToJson=function(K,J){var ne;if(J===void 0&&(J=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var he=new D.DocHandler(this),Me=(0,E.parseHtml)(he,K,window,J,!1),Re=Me.head,et=Me.body,Te=((ne=Re[0])===null||ne===void 0?void 0:ne.map(function(ge){return ge.content}))||[];return{columns:Te,rows:et,data:et}},G.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var K=this.lastAutoTable;return K&&K.finalY?K.finalY:0},G.API.autoTableAddPageContent=function(K){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),G.API.autoTable.globalDefaults||(G.API.autoTable.globalDefaults={}),G.API.autoTable.globalDefaults.addPageContent=K,this},G.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}_.default=ee},136:function(r,_){Object.defineProperty(_,"__esModule",{value:!0});function T(E,k,D,j,B){j=j||{};var P=1.15,ee=B.internal.scaleFactor,G=B.internal.getFontSize()/ee,K=B.getLineHeightFactor?B.getLineHeightFactor():P,J=G*K,ne=/\r\n|\r|\n/g,he="",Me=1;if((j.valign==="middle"||j.valign==="bottom"||j.halign==="center"||j.halign==="right")&&(he=typeof E=="string"?E.split(ne):E,Me=he.length||1),D+=G*(2-P),j.valign==="middle"?D-=Me/2*J:j.valign==="bottom"&&(D-=Me*J),j.halign==="center"||j.halign==="right"){var Re=G;if(j.halign==="center"&&(Re*=.5),he&&Me>=1){for(var et=0;et<he.length;et++)B.text(he[et],k-B.getStringUnitWidth(he[et])*Re,D),D+=J;return B}k-=B.getStringUnitWidth(E)*Re}return j.halign==="justify"?B.text(E,k,D,{maxWidth:j.maxWidth||100,align:"justify"}):B.text(E,k,D),B}_.default=T},420:function(r,_){Object.defineProperty(_,"__esModule",{value:!0}),_.getPageAvailableWidth=_.parseSpacing=_.getFillStyle=_.addTableBorder=_.getStringWidth=void 0;function T(B,P,ee){ee.applyStyles(P,!0);var G=Array.isArray(B)?B:[B],K=G.map(function(J){return ee.getTextWidth(J)}).reduce(function(J,ne){return Math.max(J,ne)},0);return K}_.getStringWidth=T;function E(B,P,ee,G){var K=P.settings.tableLineWidth,J=P.settings.tableLineColor;B.applyStyles({lineWidth:K,lineColor:J});var ne=k(K,!1);ne&&B.rect(ee.x,ee.y,P.getWidth(B.pageSize().width),G.y-ee.y,ne)}_.addTableBorder=E;function k(B,P){var ee=B>0,G=P||P===0;return ee&&G?"DF":ee?"S":G?"F":null}_.getFillStyle=k;function D(B,P){var ee,G,K,J;if(B=B||P,Array.isArray(B)){if(B.length>=4)return{top:B[0],right:B[1],bottom:B[2],left:B[3]};if(B.length===3)return{top:B[0],right:B[1],bottom:B[2],left:B[1]};if(B.length===2)return{top:B[0],right:B[1],bottom:B[0],left:B[1]};B.length===1?B=B[0]:B=P}return typeof B=="object"?(typeof B.vertical=="number"&&(B.top=B.vertical,B.bottom=B.vertical),typeof B.horizontal=="number"&&(B.right=B.horizontal,B.left=B.horizontal),{left:(ee=B.left)!==null&&ee!==void 0?ee:P,top:(G=B.top)!==null&&G!==void 0?G:P,right:(K=B.right)!==null&&K!==void 0?K:P,bottom:(J=B.bottom)!==null&&J!==void 0?J:P}):(typeof B!="number"&&(B=P),{top:B,right:B,bottom:B,left:B})}_.parseSpacing=D;function j(B,P){var ee=D(P.settings.margin,0);return B.pageSize().width-(ee.left+ee.right)}_.getPageAvailableWidth=j},796:function(r,_){var T=this&&this.__extends||function(){var j=function(B,P){return j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ee,G){ee.__proto__=G}||function(ee,G){for(var K in G)Object.prototype.hasOwnProperty.call(G,K)&&(ee[K]=G[K])},j(B,P)};return function(B,P){if(typeof P!="function"&&P!==null)throw new TypeError("Class extends value "+String(P)+" is not a constructor or null");j(B,P);function ee(){this.constructor=B}B.prototype=P===null?Object.create(P):(ee.prototype=P.prototype,new ee)}}();Object.defineProperty(_,"__esModule",{value:!0}),_.getTheme=_.defaultStyles=_.HtmlRowInput=void 0;var E=function(j){T(B,j);function B(P){var ee=j.call(this)||this;return ee._element=P,ee}return B}(Array);_.HtmlRowInput=E;function k(j){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/j,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}_.defaultStyles=k;function D(j){var B={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return B[j]}_.getTheme=D},903:function(r,_,T){Object.defineProperty(_,"__esModule",{value:!0}),_.parseCss=void 0;var E=T(420);function k(ee,G,K,J,ne){var he={},Me=1.3333333333333333,Re=j(G,function(st){return ne.getComputedStyle(st).backgroundColor});Re!=null&&(he.fillColor=Re);var et=j(G,function(st){return ne.getComputedStyle(st).color});et!=null&&(he.textColor=et);var Te=P(J,K);Te&&(he.cellPadding=Te);var ge="borderTopColor",Ue=Me*K,Ae=J.borderTopWidth;if(J.borderBottomWidth===Ae&&J.borderRightWidth===Ae&&J.borderLeftWidth===Ae){var _e=(parseFloat(Ae)||0)/Ue;_e&&(he.lineWidth=_e)}else he.lineWidth={top:(parseFloat(J.borderTopWidth)||0)/Ue,right:(parseFloat(J.borderRightWidth)||0)/Ue,bottom:(parseFloat(J.borderBottomWidth)||0)/Ue,left:(parseFloat(J.borderLeftWidth)||0)/Ue},he.lineWidth.top||(he.lineWidth.right?ge="borderRightColor":he.lineWidth.bottom?ge="borderBottomColor":he.lineWidth.left&&(ge="borderLeftColor"));console.log(he.lineWidth);var ve=j(G,function(st){return ne.getComputedStyle(st)[ge]});ve!=null&&(he.lineColor=ve);var Qe=["left","right","center","justify"];Qe.indexOf(J.textAlign)!==-1&&(he.halign=J.textAlign),Qe=["middle","bottom","top"],Qe.indexOf(J.verticalAlign)!==-1&&(he.valign=J.verticalAlign);var Ce=parseInt(J.fontSize||"");isNaN(Ce)||(he.fontSize=Ce/Me);var Ye=D(J);Ye&&(he.fontStyle=Ye);var ut=(J.fontFamily||"").toLowerCase();return ee.indexOf(ut)!==-1&&(he.font=ut),he}_.parseCss=k;function D(ee){var G="";return(ee.fontWeight==="bold"||ee.fontWeight==="bolder"||parseInt(ee.fontWeight)>=700)&&(G="bold"),(ee.fontStyle==="italic"||ee.fontStyle==="oblique")&&(G+="italic"),G}function j(ee,G){var K=B(ee,G);if(!K)return null;var J=K.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!J||!Array.isArray(J))return null;var ne=[parseInt(J[1]),parseInt(J[2]),parseInt(J[3])],he=parseInt(J[4]);return he===0||isNaN(ne[0])||isNaN(ne[1])||isNaN(ne[2])?null:ne}function B(ee,G){var K=G(ee);return K==="rgba(0, 0, 0, 0)"||K==="transparent"||K==="initial"||K==="inherit"?ee.parentElement==null?null:B(ee.parentElement,G):K}function P(ee,G){var K=[ee.paddingTop,ee.paddingRight,ee.paddingBottom,ee.paddingLeft],J=96/(72/G),ne=(parseInt(ee.lineHeight)-parseInt(ee.fontSize))/G/2,he=K.map(function(Re){return parseInt(Re||"0")/J}),Me=(0,E.parseSpacing)(he,0);return ne>Me.top&&(Me.top=ne),ne>Me.bottom&&(Me.bottom=ne),Me}},744:function(r,_){Object.defineProperty(_,"__esModule",{value:!0}),_.DocHandler=void 0;var T={},E=function(){function k(D){this.jsPDFDocument=D,this.userStyles={textColor:D.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:D.internal.getFontSize(),fontStyle:D.internal.getFont().fontStyle,font:D.internal.getFont().fontName,lineWidth:D.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:D.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return k.setDefaults=function(D,j){j===void 0&&(j=null),j?j.__autoTableDocumentDefaults=D:T=D},k.unifyColor=function(D){return Array.isArray(D)?D:typeof D=="number"?[D,D,D]:typeof D=="string"?[D]:null},k.prototype.applyStyles=function(D,j){var B,P,ee;j===void 0&&(j=!1),D.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(D.fontStyle);var G=this.jsPDFDocument.internal.getFont(),K=G.fontStyle,J=G.fontName;if(D.font&&(J=D.font),D.fontStyle){K=D.fontStyle;var ne=this.getFontList()[J];ne&&ne.indexOf(K)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(ne[0]),K=ne[0])}if(this.jsPDFDocument.setFont(J,K),D.fontSize&&this.jsPDFDocument.setFontSize(D.fontSize),!j){var he=k.unifyColor(D.fillColor);he&&(B=this.jsPDFDocument).setFillColor.apply(B,he),he=k.unifyColor(D.textColor),he&&(P=this.jsPDFDocument).setTextColor.apply(P,he),he=k.unifyColor(D.lineColor),he&&(ee=this.jsPDFDocument).setDrawColor.apply(ee,he),typeof D.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(D.lineWidth)}},k.prototype.splitTextToSize=function(D,j,B){return this.jsPDFDocument.splitTextToSize(D,j,B)},k.prototype.rect=function(D,j,B,P,ee){return this.jsPDFDocument.rect(D,j,B,P,ee)},k.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},k.prototype.getTextWidth=function(D){return this.jsPDFDocument.getTextWidth(D)},k.prototype.getDocument=function(){return this.jsPDFDocument},k.prototype.setPage=function(D){this.jsPDFDocument.setPage(D)},k.prototype.addPage=function(){return this.jsPDFDocument.addPage()},k.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},k.prototype.getGlobalOptions=function(){return T||{}},k.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},k.prototype.pageSize=function(){var D=this.jsPDFDocument.internal.pageSize;return D.width==null&&(D={width:D.getWidth(),height:D.getHeight()}),D},k.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},k.prototype.getLineHeightFactor=function(){var D=this.jsPDFDocument;return D.getLineHeightFactor?D.getLineHeightFactor():1.15},k.prototype.getLineHeight=function(D){return D/this.scaleFactor()*this.getLineHeightFactor()},k.prototype.pageNumber=function(){var D=this.jsPDFDocument.internal.getCurrentPageInfo();return D?D.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},k}();_.DocHandler=E},4:function(r,_,T){Object.defineProperty(_,"__esModule",{value:!0}),_.parseHtml=void 0;var E=T(903),k=T(796);function D(P,ee,G,K,J){var ne,he;K===void 0&&(K=!1),J===void 0&&(J=!1);var Me;typeof ee=="string"?Me=G.document.querySelector(ee):Me=ee;var Re=Object.keys(P.getFontList()),et=P.scaleFactor(),Te=[],ge=[],Ue=[];if(!Me)return console.error("Html table could not be found with input: ",ee),{head:Te,body:ge,foot:Ue};for(var Ae=0;Ae<Me.rows.length;Ae++){var _e=Me.rows[Ae],ve=(he=(ne=_e?.parentElement)===null||ne===void 0?void 0:ne.tagName)===null||he===void 0?void 0:he.toLowerCase(),Qe=j(Re,et,G,_e,K,J);Qe&&(ve==="thead"?Te.push(Qe):ve==="tfoot"?Ue.push(Qe):ge.push(Qe))}return{head:Te,body:ge,foot:Ue}}_.parseHtml=D;function j(P,ee,G,K,J,ne){for(var he=new k.HtmlRowInput(K),Me=0;Me<K.cells.length;Me++){var Re=K.cells[Me],et=G.getComputedStyle(Re);if(J||et.display!=="none"){var Te=void 0;ne&&(Te=(0,E.parseCss)(P,Re,ee,et,G)),he.push({rowSpan:Re.rowSpan,colSpan:Re.colSpan,styles:Te,_element:Re,content:B(Re)})}}var ge=G.getComputedStyle(K);if(he.length>0&&(J||ge.display!=="none"))return he}function B(P){var ee=P.cloneNode(!0);return ee.innerHTML=ee.innerHTML.replace(/\n/g,"").replace(/ +/g," "),ee.innerHTML=ee.innerHTML.split(/<br.*?>/).map(function(G){return G.trim()}).join(`
`),ee.innerText||ee.textContent||""}},776:function(r,_,T){Object.defineProperty(_,"__esModule",{value:!0}),_.parseInput=void 0;var E=T(4),k=T(356),D=T(420),j=T(744),B=T(792);function P(Me,Re){var et=new j.DocHandler(Me),Te=et.getDocumentOptions(),ge=et.getGlobalOptions();(0,B.default)(et,ge,Te,Re);var Ue=(0,k.assign)({},ge,Te,Re),Ae;typeof window<"u"&&(Ae=window);var _e=ee(ge,Te,Re),ve=G(ge,Te,Re),Qe=K(et,Ue),Ce=ne(et,Ue,Ae);return{id:Re.tableId,content:Ce,hooks:ve,styles:_e,settings:Qe}}_.parseInput=P;function ee(Me,Re,et){for(var Te={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},ge=function(ve){if(ve==="columnStyles"){var Qe=Me[ve],Ce=Re[ve],Ye=et[ve];Te.columnStyles=(0,k.assign)({},Qe,Ce,Ye)}else{var ut=[Me,Re,et],st=ut.map(function(pt){return pt[ve]||{}});Te[ve]=(0,k.assign)({},st[0],st[1],st[2])}},Ue=0,Ae=Object.keys(Te);Ue<Ae.length;Ue++){var _e=Ae[Ue];ge(_e)}return Te}function G(Me,Re,et){for(var Te=[Me,Re,et],ge={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},Ue=0,Ae=Te;Ue<Ae.length;Ue++){var _e=Ae[Ue];_e.didParseCell&&ge.didParseCell.push(_e.didParseCell),_e.willDrawCell&&ge.willDrawCell.push(_e.willDrawCell),_e.didDrawCell&&ge.didDrawCell.push(_e.didDrawCell),_e.willDrawPage&&ge.willDrawPage.push(_e.willDrawPage),_e.didDrawPage&&ge.didDrawPage.push(_e.didDrawPage)}return ge}function K(Me,Re){var et,Te,ge,Ue,Ae,_e,ve,Qe,Ce,Ye,ut,st,pt=(0,D.parseSpacing)(Re.margin,40/Me.scaleFactor()),Tt=(et=J(Me,Re.startY))!==null&&et!==void 0?et:pt.top,ht;Re.showFoot===!0?ht="everyPage":Re.showFoot===!1?ht="never":ht=(Te=Re.showFoot)!==null&&Te!==void 0?Te:"everyPage";var Wt;Re.showHead===!0?Wt="everyPage":Re.showHead===!1?Wt="never":Wt=(ge=Re.showHead)!==null&&ge!==void 0?ge:"everyPage";var re=(Ue=Re.useCss)!==null&&Ue!==void 0?Ue:!1,xe=Re.theme||(re?"plain":"striped"),pe=!!Re.horizontalPageBreak,Ie=(Ae=Re.horizontalPageBreakRepeat)!==null&&Ae!==void 0?Ae:null;return{includeHiddenHtml:(_e=Re.includeHiddenHtml)!==null&&_e!==void 0?_e:!1,useCss:re,theme:xe,startY:Tt,margin:pt,pageBreak:(ve=Re.pageBreak)!==null&&ve!==void 0?ve:"auto",rowPageBreak:(Qe=Re.rowPageBreak)!==null&&Qe!==void 0?Qe:"auto",tableWidth:(Ce=Re.tableWidth)!==null&&Ce!==void 0?Ce:"auto",showHead:Wt,showFoot:ht,tableLineWidth:(Ye=Re.tableLineWidth)!==null&&Ye!==void 0?Ye:0,tableLineColor:(ut=Re.tableLineColor)!==null&&ut!==void 0?ut:200,horizontalPageBreak:pe,horizontalPageBreakRepeat:Ie,horizontalPageBreakBehaviour:(st=Re.horizontalPageBreakBehaviour)!==null&&st!==void 0?st:"afterAllRows"}}function J(Me,Re){var et=Me.getLastAutoTable(),Te=Me.scaleFactor(),ge=Me.pageNumber(),Ue=!1;if(et&&et.startPageNumber){var Ae=et.startPageNumber+et.pageNumber-1;Ue=Ae===ge}return typeof Re=="number"?Re:(Re==null||Re===!1)&&Ue&&et?.finalY!=null?et.finalY+20/Te:null}function ne(Me,Re,et){var Te=Re.head||[],ge=Re.body||[],Ue=Re.foot||[];if(Re.html){var Ae=Re.includeHiddenHtml;if(et){var _e=(0,E.parseHtml)(Me,Re.html,et,Ae,Re.useCss)||{};Te=_e.head||Te,ge=_e.body||Te,Ue=_e.foot||Te}else console.error("Cannot parse html in non browser environment")}var ve=Re.columns||he(Te,ge,Ue);return{columns:ve,head:Te,body:ge,foot:Ue}}function he(Me,Re,et){var Te=Me[0]||Re[0]||et[0]||[],ge=[];return Object.keys(Te).filter(function(Ue){return Ue!=="_element"}).forEach(function(Ue){var Ae=1,_e;Array.isArray(Te)?_e=Te[parseInt(Ue)]:_e=Te[Ue],typeof _e=="object"&&!Array.isArray(_e)&&(Ae=_e?.colSpan||1);for(var ve=0;ve<Ae;ve++){var Qe=void 0;Array.isArray(Te)?Qe=ge.length:Qe=Ue+(ve>0?"_".concat(ve):"");var Ce={dataKey:Qe};ge.push(Ce)}}),ge}},792:function(r,_){Object.defineProperty(_,"__esModule",{value:!0});function T(k,D,j,B){for(var P=function(J){J&&typeof J!="object"&&console.error("The options parameter should be of type object, is: "+typeof J),typeof J.extendWidth<"u"&&(J.tableWidth=J.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof J.margins<"u"&&(typeof J.margin>"u"&&(J.margin=J.margins),console.error("Use of deprecated option: margins, use margin instead.")),J.startY&&typeof J.startY!="number"&&(console.error("Invalid value for startY option",J.startY),delete J.startY),!J.didDrawPage&&(J.afterPageContent||J.beforePageContent||J.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),J.didDrawPage=function(Ue){k.applyStyles(k.userStyles),J.beforePageContent&&J.beforePageContent(Ue),k.applyStyles(k.userStyles),J.afterPageContent&&J.afterPageContent(Ue),k.applyStyles(k.userStyles),J.afterPageAdd&&Ue.pageNumber>1&&Ue.afterPageAdd(Ue),k.applyStyles(k.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(Ue){J[Ue]&&console.error('The "'.concat(Ue,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(Ue){var Ae=Ue[0],_e=Ue[1];J[_e]&&(console.error("Use of deprecated option ".concat(_e,". Use ").concat(Ae," instead")),J[Ae]=J[_e])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(Ue){var Ae=typeof Ue=="string"?Ue:Ue[0],_e=typeof Ue=="string"?Ue:Ue[1];typeof J[Ae]<"u"&&(typeof J.styles[_e]>"u"&&(J.styles[_e]=J[Ae]),console.error("Use of deprecated option: "+Ae+", use the style "+_e+" instead."))});for(var ne=0,he=["styles","bodyStyles","headStyles","footStyles"];ne<he.length;ne++){var Me=he[ne];E(J[Me]||{})}for(var Re=J.columnStyles||{},et=0,Te=Object.keys(Re);et<Te.length;et++){var ge=Te[et];E(Re[ge]||{})}},ee=0,G=[D,j,B];ee<G.length;ee++){var K=G[ee];P(K)}}_.default=T;function E(k){k.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),k.minCellHeight||(k.minCellHeight=k.rowHeight)):k.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),k.cellWidth||(k.cellWidth=k.columnWidth))}},260:function(r,_,T){Object.defineProperty(_,"__esModule",{value:!0}),_.Column=_.Cell=_.Row=_.Table=void 0;var E=T(796),k=T(172),D=T(420),j=function(){function G(K,J){this.pageNumber=1,this.pageCount=1,this.id=K.id,this.settings=K.settings,this.styles=K.styles,this.hooks=K.hooks,this.columns=J.columns,this.head=J.head,this.body=J.body,this.foot=J.foot}return G.prototype.getHeadHeight=function(K){return this.head.reduce(function(J,ne){return J+ne.getMaxCellHeight(K)},0)},G.prototype.getFootHeight=function(K){return this.foot.reduce(function(J,ne){return J+ne.getMaxCellHeight(K)},0)},G.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},G.prototype.callCellHooks=function(K,J,ne,he,Me,Re){for(var et=0,Te=J;et<Te.length;et++){var ge=Te[et],Ue=new k.CellHookData(K,this,ne,he,Me,Re),Ae=ge(Ue)===!1;if(ne.text=Array.isArray(ne.text)?ne.text:[ne.text],Ae)return!1}return!0},G.prototype.callEndPageHooks=function(K,J){K.applyStyles(K.userStyles);for(var ne=0,he=this.hooks.didDrawPage;ne<he.length;ne++){var Me=he[ne];Me(new k.HookData(K,this,J))}},G.prototype.callWillDrawPageHooks=function(K,J){for(var ne=0,he=this.hooks.willDrawPage;ne<he.length;ne++){var Me=he[ne];Me(new k.HookData(K,this,J))}},G.prototype.getWidth=function(K){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var J=this.columns.reduce(function(he,Me){return he+Me.wrappedWidth},0);return J}else{var ne=this.settings.margin;return K-ne.left-ne.right}},G}();_.Table=j;var B=function(){function G(K,J,ne,he,Me){Me===void 0&&(Me=!1),this.height=0,this.raw=K,K instanceof E.HtmlRowInput&&(this.raw=K._element,this.element=K._element),this.index=J,this.section=ne,this.cells=he,this.spansMultiplePages=Me}return G.prototype.getMaxCellHeight=function(K){var J=this;return K.reduce(function(ne,he){var Me;return Math.max(ne,((Me=J.cells[he.index])===null||Me===void 0?void 0:Me.height)||0)},0)},G.prototype.hasRowSpan=function(K){var J=this;return K.filter(function(ne){var he=J.cells[ne.index];return he?he.rowSpan>1:!1}).length>0},G.prototype.canEntireRowFit=function(K,J){return this.getMaxCellHeight(J)<=K},G.prototype.getMinimumRowHeight=function(K,J){var ne=this;return K.reduce(function(he,Me){var Re=ne.cells[Me.index];if(!Re)return 0;var et=J.getLineHeight(Re.styles.fontSize),Te=Re.padding("vertical"),ge=Te+et;return ge>he?ge:he},0)},G}();_.Row=B;var P=function(){function G(K,J,ne){var he,Me;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=J,this.section=ne,this.raw=K;var Re=K;K!=null&&typeof K=="object"&&!Array.isArray(K)?(this.rowSpan=K.rowSpan||1,this.colSpan=K.colSpan||1,Re=(Me=(he=K.content)!==null&&he!==void 0?he:K.title)!==null&&Me!==void 0?Me:K,K._element&&(this.raw=K._element)):(this.rowSpan=1,this.colSpan=1);var et=Re!=null?""+Re:"",Te=/\r\n|\r|\n/g;this.text=et.split(Te)}return G.prototype.getTextPos=function(){var K;if(this.styles.valign==="top")K=this.y+this.padding("top");else if(this.styles.valign==="bottom")K=this.y+this.height-this.padding("bottom");else{var J=this.height-this.padding("vertical");K=this.y+J/2+this.padding("top")}var ne;if(this.styles.halign==="right")ne=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var he=this.width-this.padding("horizontal");ne=this.x+he/2+this.padding("left")}else ne=this.x+this.padding("left");return{x:ne,y:K}},G.prototype.getContentHeight=function(K,J){J===void 0&&(J=1.15);var ne=Array.isArray(this.text)?this.text.length:1,he=this.styles.fontSize/K*J,Me=ne*he+this.padding("vertical");return Math.max(Me,this.styles.minCellHeight)},G.prototype.padding=function(K){var J=(0,D.parseSpacing)(this.styles.cellPadding,0);return K==="vertical"?J.top+J.bottom:K==="horizontal"?J.left+J.right:J[K]},G}();_.Cell=P;var ee=function(){function G(K,J,ne){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=K,this.raw=J,this.index=ne}return G.prototype.getMaxCustomCellWidth=function(K){for(var J=0,ne=0,he=K.allRows();ne<he.length;ne++){var Me=he[ne],Re=Me.cells[this.index];Re&&typeof Re.styles.cellWidth=="number"&&(J=Math.max(J,Re.styles.cellWidth))}return J},G}();_.Column=ee},356:function(r,_){Object.defineProperty(_,"__esModule",{value:!0}),_.assign=void 0;function T(E,k,D,j,B){if(E==null)throw new TypeError("Cannot convert undefined or null to object");for(var P=Object(E),ee=1;ee<arguments.length;ee++){var G=arguments[ee];if(G!=null)for(var K in G)Object.prototype.hasOwnProperty.call(G,K)&&(P[K]=G[K])}return P}_.assign=T},972:function(r,_,T){Object.defineProperty(_,"__esModule",{value:!0}),_.createTable=void 0;var E=T(744),k=T(260),D=T(324),j=T(796),B=T(356);function P(Me,Re){var et=new E.DocHandler(Me),Te=ee(Re,et.scaleFactor()),ge=new k.Table(Re,Te);return(0,D.calculateWidths)(et,ge),et.applyStyles(et.userStyles),ge}_.createTable=P;function ee(Me,Re){var et=Me.content,Te=ne(et.columns);if(et.head.length===0){var ge=K(Te,"head");ge&&et.head.push(ge)}if(et.foot.length===0){var ge=K(Te,"foot");ge&&et.foot.push(ge)}var Ue=Me.settings.theme,Ae=Me.styles;return{columns:Te,head:G("head",et.head,Te,Ae,Ue,Re),body:G("body",et.body,Te,Ae,Ue,Re),foot:G("foot",et.foot,Te,Ae,Ue,Re)}}function G(Me,Re,et,Te,ge,Ue){var Ae={},_e=Re.map(function(ve,Qe){for(var Ce=0,Ye={},ut=0,st=0,pt=0,Tt=et;pt<Tt.length;pt++){var ht=Tt[pt];if(Ae[ht.index]==null||Ae[ht.index].left===0)if(st===0){var Wt=void 0;Array.isArray(ve)?Wt=ve[ht.index-ut-Ce]:Wt=ve[ht.dataKey];var re={};typeof Wt=="object"&&!Array.isArray(Wt)&&(re=Wt?.styles||{});var xe=he(Me,ht,Qe,ge,Te,Ue,re),pe=new k.Cell(Wt,xe,Me);Ye[ht.dataKey]=pe,Ye[ht.index]=pe,st=pe.colSpan-1,Ae[ht.index]={left:pe.rowSpan-1,times:st}}else st--,ut++;else Ae[ht.index].left--,st=Ae[ht.index].times,Ce++}return new k.Row(ve,Qe,Me,Ye)});return _e}function K(Me,Re){var et={};return Me.forEach(function(Te){if(Te.raw!=null){var ge=J(Re,Te.raw);ge!=null&&(et[Te.dataKey]=ge)}}),Object.keys(et).length>0?et:null}function J(Me,Re){if(Me==="head"){if(typeof Re=="object")return Re.header||Re.title||null;if(typeof Re=="string"||typeof Re=="number")return Re}else if(Me==="foot"&&typeof Re=="object")return Re.footer;return null}function ne(Me){return Me.map(function(Re,et){var Te,ge,Ue;return typeof Re=="object"?Ue=(ge=(Te=Re.dataKey)!==null&&Te!==void 0?Te:Re.key)!==null&&ge!==void 0?ge:et:Ue=et,new k.Column(Ue,Re,et)})}function he(Me,Re,et,Te,ge,Ue,Ae){var _e=(0,j.getTheme)(Te),ve;Me==="head"?ve=ge.headStyles:Me==="body"?ve=ge.bodyStyles:Me==="foot"&&(ve=ge.footStyles);var Qe=(0,B.assign)({},_e.table,_e[Me],ge.styles,ve),Ce=ge.columnStyles[Re.dataKey]||ge.columnStyles[Re.index]||{},Ye=Me==="body"?Ce:{},ut=Me==="body"&&et%2===0?(0,B.assign)({},_e.alternateRow,ge.alternateRowStyles):{},st=(0,j.defaultStyles)(Ue),pt=(0,B.assign)({},st,Qe,ut,Ye);return(0,B.assign)(pt,Ae)}},664:function(r,_,T){Object.defineProperty(_,"__esModule",{value:!0}),_.addPage=_.drawTable=void 0;var E=T(420),k=T(260),D=T(744),j=T(356),B=T(136),P=T(224);function ee(Ce,Ye){var ut=Ye.settings,st=ut.startY,pt=ut.margin,Tt={x:pt.left,y:st},ht=Ye.getHeadHeight(Ye.columns)+Ye.getFootHeight(Ye.columns),Wt=st+pt.bottom+ht;if(ut.pageBreak==="avoid"){var re=Ye.body,xe=re.reduce(function(Ve,gt){return Ve+gt.height},0);Wt+=xe}var pe=new D.DocHandler(Ce);(ut.pageBreak==="always"||ut.startY!=null&&Wt>pe.pageSize().height)&&(Qe(pe),Tt.y=pt.top),Ye.callWillDrawPageHooks(pe,Tt);var Ie=(0,j.assign)({},Tt);Ye.startPageNumber=pe.pageNumber(),ut.horizontalPageBreak?G(pe,Ye,Ie,Tt):(pe.applyStyles(pe.userStyles),(ut.showHead==="firstPage"||ut.showHead==="everyPage")&&Ye.head.forEach(function(Ve){return ge(pe,Ye,Ve,Tt,Ye.columns)}),pe.applyStyles(pe.userStyles),Ye.body.forEach(function(Ve,gt){var mt=gt===Ye.body.length-1;Te(pe,Ye,Ve,mt,Ie,Tt,Ye.columns)}),pe.applyStyles(pe.userStyles),(ut.showFoot==="lastPage"||ut.showFoot==="everyPage")&&Ye.foot.forEach(function(Ve){return ge(pe,Ye,Ve,Tt,Ye.columns)})),(0,E.addTableBorder)(pe,Ye,Ie,Tt),Ye.callEndPageHooks(pe,Tt),Ye.finalY=Tt.y,Ce.lastAutoTable=Ye,Ce.previousAutoTable=Ye,Ce.autoTable&&(Ce.autoTable.previous=Ye),pe.applyStyles(pe.userStyles)}_.drawTable=ee;function G(Ce,Ye,ut,st){var pt=(0,P.calculateAllColumnsCanFitInPage)(Ce,Ye),Tt=Ye.settings;if(Tt.horizontalPageBreakBehaviour==="afterAllRows")pt.forEach(function(xe,pe){Ce.applyStyles(Ce.userStyles),pe>0?ve(Ce,Ye,ut,st,xe.columns,!0):K(Ce,Ye,st,xe.columns),J(Ce,Ye,ut,st,xe.columns),he(Ce,Ye,st,xe.columns)});else for(var ht=-1,Wt=pt[0],re=function(){var xe=ht;if(Wt){Ce.applyStyles(Ce.userStyles);var pe=Wt.columns;ht>=0?ve(Ce,Ye,ut,st,pe,!0):K(Ce,Ye,st,pe),xe=ne(Ce,Ye,ht+1,st,pe),he(Ce,Ye,st,pe)}var Ie=xe-ht;pt.slice(1).forEach(function(Ve){Ce.applyStyles(Ce.userStyles),ve(Ce,Ye,ut,st,Ve.columns,!0),ne(Ce,Ye,ht+1,st,Ve.columns,Ie),he(Ce,Ye,st,Ve.columns)}),ht=xe};ht<Ye.body.length-1;)re()}function K(Ce,Ye,ut,st){var pt=Ye.settings;Ce.applyStyles(Ce.userStyles),(pt.showHead==="firstPage"||pt.showHead==="everyPage")&&Ye.head.forEach(function(Tt){return ge(Ce,Ye,Tt,ut,st)})}function J(Ce,Ye,ut,st,pt){Ce.applyStyles(Ce.userStyles),Ye.body.forEach(function(Tt,ht){var Wt=ht===Ye.body.length-1;Te(Ce,Ye,Tt,Wt,ut,st,pt)})}function ne(Ce,Ye,ut,st,pt,Tt){Ce.applyStyles(Ce.userStyles),Tt=Tt??Ye.body.length;var ht=Math.min(ut+Tt,Ye.body.length),Wt=-1;return Ye.body.slice(ut,ht).forEach(function(re,xe){var pe=ut+xe===Ye.body.length-1,Ie=_e(Ce,Ye,pe,st);re.canEntireRowFit(Ie,pt)&&(ge(Ce,Ye,re,st,pt),Wt=ut+xe)}),Wt}function he(Ce,Ye,ut,st){var pt=Ye.settings;Ce.applyStyles(Ce.userStyles),(pt.showFoot==="lastPage"||pt.showFoot==="everyPage")&&Ye.foot.forEach(function(Tt){return ge(Ce,Ye,Tt,ut,st)})}function Me(Ce,Ye,ut){var st=ut.getLineHeight(Ce.styles.fontSize),pt=Ce.padding("vertical"),Tt=Math.floor((Ye-pt)/st);return Math.max(0,Tt)}function Re(Ce,Ye,ut,st){var pt={};Ce.spansMultiplePages=!0,Ce.height=0;for(var Tt=0,ht=0,Wt=ut.columns;ht<Wt.length;ht++){var re=Wt[ht],xe=Ce.cells[re.index];if(xe){Array.isArray(xe.text)||(xe.text=[xe.text]);var pe=new k.Cell(xe.raw,xe.styles,xe.section);pe=(0,j.assign)(pe,xe),pe.text=[];var Ie=Me(xe,Ye,st);xe.text.length>Ie&&(pe.text=xe.text.splice(Ie,xe.text.length));var Ve=st.scaleFactor(),gt=st.getLineHeightFactor();xe.contentHeight=xe.getContentHeight(Ve,gt),xe.contentHeight>=Ye&&(xe.contentHeight=Ye,pe.styles.minCellHeight-=Ye),xe.contentHeight>Ce.height&&(Ce.height=xe.contentHeight),pe.contentHeight=pe.getContentHeight(Ve,gt),pe.contentHeight>Tt&&(Tt=pe.contentHeight),pt[re.index]=pe}}var mt=new k.Row(Ce.raw,-1,Ce.section,pt,!0);mt.height=Tt;for(var wt=0,Pt=ut.columns;wt<Pt.length;wt++){var re=Pt[wt],pe=mt.cells[re.index];pe&&(pe.height=mt.height);var xe=Ce.cells[re.index];xe&&(xe.height=Ce.height)}return mt}function et(Ce,Ye,ut,st){var pt=Ce.pageSize().height,Tt=st.settings.margin,ht=Tt.top+Tt.bottom,Wt=pt-ht;Ye.section==="body"&&(Wt-=st.getHeadHeight(st.columns)+st.getFootHeight(st.columns));var re=Ye.getMinimumRowHeight(st.columns,Ce),xe=re<ut;if(re>Wt)return console.error("Will not be able to print row ".concat(Ye.index," correctly since it's minimum height is larger than page height")),!0;if(!xe)return!1;var pe=Ye.hasRowSpan(st.columns),Ie=Ye.getMaxCellHeight(st.columns)>Wt;return Ie?(pe&&console.error("The content of row ".concat(Ye.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(pe||st.settings.rowPageBreak==="avoid")}function Te(Ce,Ye,ut,st,pt,Tt,ht){var Wt=_e(Ce,Ye,st,Tt);if(ut.canEntireRowFit(Wt,ht))ge(Ce,Ye,ut,Tt,ht);else if(et(Ce,ut,Wt,Ye)){var re=Re(ut,Wt,Ye,Ce);ge(Ce,Ye,ut,Tt,ht),ve(Ce,Ye,pt,Tt,ht),Te(Ce,Ye,re,st,pt,Tt,ht)}else ve(Ce,Ye,pt,Tt,ht),Te(Ce,Ye,ut,st,pt,Tt,ht)}function ge(Ce,Ye,ut,st,pt){st.x=Ye.settings.margin.left;for(var Tt=0,ht=pt;Tt<ht.length;Tt++){var Wt=ht[Tt],re=ut.cells[Wt.index];if(!re){st.x+=Wt.width;continue}Ce.applyStyles(re.styles),re.x=st.x,re.y=st.y;var xe=Ye.callCellHooks(Ce,Ye.hooks.willDrawCell,re,ut,Wt,st);if(xe===!1){st.x+=Wt.width;continue}Ue(Ce,re,st);var pe=re.getTextPos();(0,B.default)(re.text,pe.x,pe.y,{halign:re.styles.halign,valign:re.styles.valign,maxWidth:Math.ceil(re.width-re.padding("left")-re.padding("right"))},Ce.getDocument()),Ye.callCellHooks(Ce,Ye.hooks.didDrawCell,re,ut,Wt,st),st.x+=Wt.width}st.y+=ut.height}function Ue(Ce,Ye,ut){var st=Ye.styles;if(Ce.getDocument().setFillColor(Ce.getDocument().getFillColor()),typeof st.lineWidth=="number"){var pt=(0,E.getFillStyle)(st.lineWidth,st.fillColor);pt&&Ce.rect(Ye.x,ut.y,Ye.width,Ye.height,pt)}else typeof st.lineWidth=="object"&&(st.fillColor&&Ce.rect(Ye.x,ut.y,Ye.width,Ye.height,"F"),Ae(Ce,Ye,ut,st.lineWidth))}function Ae(Ce,Ye,ut,st){var pt,Tt,ht,Wt;st.top&&(pt=ut.x,Tt=ut.y,ht=ut.x+Ye.width,Wt=ut.y,st.right&&(ht+=.5*st.right),st.left&&(pt-=.5*st.left),re(st.top,pt,Tt,ht,Wt)),st.bottom&&(pt=ut.x,Tt=ut.y+Ye.height,ht=ut.x+Ye.width,Wt=ut.y+Ye.height,st.right&&(ht+=.5*st.right),st.left&&(pt-=.5*st.left),re(st.bottom,pt,Tt,ht,Wt)),st.left&&(pt=ut.x,Tt=ut.y,ht=ut.x,Wt=ut.y+Ye.height,st.top&&(Tt-=.5*st.top),st.bottom&&(Wt+=.5*st.bottom),re(st.left,pt,Tt,ht,Wt)),st.right&&(pt=ut.x+Ye.width,Tt=ut.y,ht=ut.x+Ye.width,Wt=ut.y+Ye.height,st.top&&(Tt-=.5*st.top),st.bottom&&(Wt+=.5*st.bottom),re(st.right,pt,Tt,ht,Wt));function re(xe,pe,Ie,Ve,gt){Ce.getDocument().setLineWidth(xe),Ce.getDocument().line(pe,Ie,Ve,gt,"S")}}function _e(Ce,Ye,ut,st){var pt=Ye.settings.margin.bottom,Tt=Ye.settings.showFoot;return(Tt==="everyPage"||Tt==="lastPage"&&ut)&&(pt+=Ye.getFootHeight(Ye.columns)),Ce.pageSize().height-st.y-pt}function ve(Ce,Ye,ut,st,pt,Tt){pt===void 0&&(pt=[]),Tt===void 0&&(Tt=!1),Ce.applyStyles(Ce.userStyles),Ye.settings.showFoot==="everyPage"&&!Tt&&Ye.foot.forEach(function(Wt){return ge(Ce,Ye,Wt,st,pt)}),Ye.callEndPageHooks(Ce,st);var ht=Ye.settings.margin;(0,E.addTableBorder)(Ce,Ye,ut,st),Qe(Ce),Ye.pageNumber++,Ye.pageCount++,st.x=ht.left,st.y=ht.top,ut.y=ht.top,Ye.callWillDrawPageHooks(Ce,st),Ye.settings.showHead==="everyPage"&&(Ye.head.forEach(function(Wt){return ge(Ce,Ye,Wt,st,pt)}),Ce.applyStyles(Ce.userStyles))}_.addPage=ve;function Qe(Ce){var Ye=Ce.pageNumber();Ce.setPage(Ye+1);var ut=Ce.pageNumber();return ut===Ye?(Ce.addPage(),!0):!1}},224:function(r,_,T){Object.defineProperty(_,"__esModule",{value:!0}),_.calculateAllColumnsCanFitInPage=void 0;var E=T(420);function k(j,B,P){var ee;P===void 0&&(P={});var G=(0,E.getPageAvailableWidth)(j,B),K=new Map,J=[],ne=[],he=[];B.settings.horizontalPageBreakRepeat,Array.isArray(B.settings.horizontalPageBreakRepeat)?he=B.settings.horizontalPageBreakRepeat:(typeof B.settings.horizontalPageBreakRepeat=="string"||typeof B.settings.horizontalPageBreakRepeat=="number")&&(he=[B.settings.horizontalPageBreakRepeat]),he.forEach(function(Te){var ge=B.columns.find(function(Ue){return Ue.dataKey===Te||Ue.index===Te});ge&&!K.has(ge.index)&&(K.set(ge.index,!0),J.push(ge.index),ne.push(B.columns[ge.index]),G-=ge.wrappedWidth)});for(var Me=!0,Re=(ee=P?.start)!==null&&ee!==void 0?ee:0;Re<B.columns.length;){if(K.has(Re)){Re++;continue}var et=B.columns[Re].wrappedWidth;if(Me||G>=et)Me=!1,J.push(Re),ne.push(B.columns[Re]),G-=et;else break;Re++}return{colIndexes:J,columns:ne,lastIndex:Re-1}}function D(j,B){for(var P=[],ee=0;ee<B.columns.length;ee++){var G=k(j,B,{start:ee});G.columns.length&&(P.push(G),ee=G.lastIndex)}return P}_.calculateAllColumnsCanFitInPage=D},324:function(r,_,T){Object.defineProperty(_,"__esModule",{value:!0}),_.ellipsize=_.resizeColumns=_.calculateWidths=void 0;var E=T(420);function k(J,ne){D(J,ne);var he=[],Me=0;ne.columns.forEach(function(et){var Te=et.getMaxCustomCellWidth(ne);Te?et.width=Te:(et.width=et.wrappedWidth,he.push(et)),Me+=et.width});var Re=ne.getWidth(J.pageSize().width)-Me;Re&&(Re=j(he,Re,function(et){return Math.max(et.minReadableWidth,et.minWidth)})),Re&&(Re=j(he,Re,function(et){return et.minWidth})),Re=Math.abs(Re),!ne.settings.horizontalPageBreak&&Re>.1/J.scaleFactor()&&(Re=Re<1?Re:Math.round(Re),console.warn("Of the table content, ".concat(Re," units width could not fit page"))),P(ne),ee(ne,J),B(ne)}_.calculateWidths=k;function D(J,ne){var he=J.scaleFactor(),Me=ne.settings.horizontalPageBreak,Re=(0,E.getPageAvailableWidth)(J,ne);ne.allRows().forEach(function(et){for(var Te=0,ge=ne.columns;Te<ge.length;Te++){var Ue=ge[Te],Ae=et.cells[Ue.index];if(Ae){var _e=ne.hooks.didParseCell;ne.callCellHooks(J,_e,Ae,et,Ue,null);var ve=Ae.padding("horizontal");Ae.contentWidth=(0,E.getStringWidth)(Ae.text,Ae.styles,J)+ve;var Qe=(0,E.getStringWidth)(Ae.text.join(" ").split(/\s+/),Ae.styles,J);if(Ae.minReadableWidth=Qe+Ae.padding("horizontal"),typeof Ae.styles.cellWidth=="number")Ae.minWidth=Ae.styles.cellWidth,Ae.wrappedWidth=Ae.styles.cellWidth;else if(Ae.styles.cellWidth==="wrap"||Me===!0)Ae.contentWidth>Re?(Ae.minWidth=Re,Ae.wrappedWidth=Re):(Ae.minWidth=Ae.contentWidth,Ae.wrappedWidth=Ae.contentWidth);else{var Ce=10/he;Ae.minWidth=Ae.styles.minCellWidth||Ce,Ae.wrappedWidth=Ae.contentWidth,Ae.minWidth>Ae.wrappedWidth&&(Ae.wrappedWidth=Ae.minWidth)}}}}),ne.allRows().forEach(function(et){for(var Te=0,ge=ne.columns;Te<ge.length;Te++){var Ue=ge[Te],Ae=et.cells[Ue.index];if(Ae&&Ae.colSpan===1)Ue.wrappedWidth=Math.max(Ue.wrappedWidth,Ae.wrappedWidth),Ue.minWidth=Math.max(Ue.minWidth,Ae.minWidth),Ue.minReadableWidth=Math.max(Ue.minReadableWidth,Ae.minReadableWidth);else{var _e=ne.styles.columnStyles[Ue.dataKey]||ne.styles.columnStyles[Ue.index]||{},ve=_e.cellWidth||_e.minCellWidth;ve&&typeof ve=="number"&&(Ue.minWidth=ve,Ue.wrappedWidth=ve)}Ae&&(Ae.colSpan>1&&!Ue.minWidth&&(Ue.minWidth=Ae.minWidth),Ae.colSpan>1&&!Ue.wrappedWidth&&(Ue.wrappedWidth=Ae.minWidth))}})}function j(J,ne,he){for(var Me=ne,Re=J.reduce(function(Ce,Ye){return Ce+Ye.wrappedWidth},0),et=0;et<J.length;et++){var Te=J[et],ge=Te.wrappedWidth/Re,Ue=Me*ge,Ae=Te.width+Ue,_e=he(Te),ve=Ae<_e?_e:Ae;ne-=ve-Te.width,Te.width=ve}if(ne=Math.round(ne*1e10)/1e10,ne){var Qe=J.filter(function(Ce){return ne<0?Ce.width>he(Ce):!0});Qe.length&&(ne=j(Qe,ne,he))}return ne}_.resizeColumns=j;function B(J){for(var ne={},he=1,Me=J.allRows(),Re=0;Re<Me.length;Re++)for(var et=Me[Re],Te=0,ge=J.columns;Te<ge.length;Te++){var Ue=ge[Te],Ae=ne[Ue.index];if(he>1)he--,delete et.cells[Ue.index];else if(Ae)Ae.cell.height+=et.height,he=Ae.cell.colSpan,delete et.cells[Ue.index],Ae.left--,Ae.left<=1&&delete ne[Ue.index];else{var _e=et.cells[Ue.index];if(!_e)continue;if(_e.height=et.height,_e.rowSpan>1){var ve=Me.length-Re,Qe=_e.rowSpan>ve?ve:_e.rowSpan;ne[Ue.index]={cell:_e,left:Qe,row:et}}}}}function P(J){for(var ne=J.allRows(),he=0;he<ne.length;he++)for(var Me=ne[he],Re=null,et=0,Te=0,ge=0;ge<J.columns.length;ge++){var Ue=J.columns[ge];if(Te-=1,Te>1&&J.columns[ge+1])et+=Ue.width,delete Me.cells[Ue.index];else if(Re){var Ae=Re;delete Me.cells[Ue.index],Re=null,Ae.width=Ue.width+et}else{var Ae=Me.cells[Ue.index];if(!Ae)continue;if(Te=Ae.colSpan,et=0,Ae.colSpan>1){Re=Ae,et+=Ue.width;continue}Ae.width=Ue.width+et}}}function ee(J,ne){for(var he={count:0,height:0},Me=0,Re=J.allRows();Me<Re.length;Me++){for(var et=Re[Me],Te=0,ge=J.columns;Te<ge.length;Te++){var Ue=ge[Te],Ae=et.cells[Ue.index];if(Ae){ne.applyStyles(Ae.styles,!0);var _e=Ae.width-Ae.padding("horizontal");if(Ae.styles.overflow==="linebreak")Ae.text=ne.splitTextToSize(Ae.text,_e+1/ne.scaleFactor(),{fontSize:Ae.styles.fontSize});else if(Ae.styles.overflow==="ellipsize")Ae.text=G(Ae.text,_e,Ae.styles,ne,"...");else if(Ae.styles.overflow==="hidden")Ae.text=G(Ae.text,_e,Ae.styles,ne,"");else if(typeof Ae.styles.overflow=="function"){var ve=Ae.styles.overflow(Ae.text,_e);typeof ve=="string"?Ae.text=[ve]:Ae.text=ve}Ae.contentHeight=Ae.getContentHeight(ne.scaleFactor(),ne.getLineHeightFactor());var Qe=Ae.contentHeight/Ae.rowSpan;Ae.rowSpan>1&&he.count*he.height<Qe*Ae.rowSpan?he={height:Qe,count:Ae.rowSpan}:he&&he.count>0&&he.height>Qe&&(Qe=he.height),Qe>et.height&&(et.height=Qe)}}he.count--}}function G(J,ne,he,Me,Re){return J.map(function(et){return K(et,ne,he,Me,Re)})}_.ellipsize=G;function K(J,ne,he,Me,Re){var et=1e4*Me.scaleFactor();if(ne=Math.ceil(ne*et)/et,ne>=(0,E.getStringWidth)(J,he,Me))return J;for(;ne<(0,E.getStringWidth)(J+Re,he,Me)&&!(J.length<=1);)J=J.substring(0,J.length-1);return J.trim()+Re}},964:function(r){if(typeof a>"u"){var _=new Error("Cannot find module 'undefined'");throw _.code="MODULE_NOT_FOUND",_}r.exports=a}},o={};function c(r){var _=o[r];if(_!==void 0)return _.exports;var T=o[r]={exports:{}};return i[r].call(T.exports,T,T.exports,c),T.exports}var u={};return function(){var r=u;Object.defineProperty(r,"__esModule",{value:!0}),r.Cell=r.Column=r.Row=r.Table=r.CellHookData=r.__drawTable=r.__createTable=r.applyPlugin=void 0;var _=c(340),T=c(776),E=c(664),k=c(972),D=c(260);Object.defineProperty(r,"Table",{enumerable:!0,get:function(){return D.Table}});var j=c(172);Object.defineProperty(r,"CellHookData",{enumerable:!0,get:function(){return j.CellHookData}});var B=c(260);Object.defineProperty(r,"Cell",{enumerable:!0,get:function(){return B.Cell}}),Object.defineProperty(r,"Column",{enumerable:!0,get:function(){return B.Column}}),Object.defineProperty(r,"Row",{enumerable:!0,get:function(){return B.Row}});function P(ne){(0,_.default)(ne)}r.applyPlugin=P;function ee(ne,he){var Me=(0,T.parseInput)(ne,he),Re=(0,k.createTable)(ne,Me);(0,E.drawTable)(ne,Re)}function G(ne,he){var Me=(0,T.parseInput)(ne,he);return(0,k.createTable)(ne,Me)}r.__createTable=G;function K(ne,he){(0,E.drawTable)(ne,he)}r.__drawTable=K;try{var J=c(964);J.jsPDF&&(J=J.jsPDF),P(J)}catch{}r.default=ee}(),u}()})});var Kv=class a{constructor(i){this.normalizedNames=new Map,this.lazyUpdate=null,i?typeof i=="string"?this.lazyInit=()=>{this.headers=new Map,i.split(`
`).forEach(o=>{let c=o.indexOf(":");if(c>0){let u=o.slice(0,c),r=u.toLowerCase(),_=o.slice(c+1).trim();this.maybeSetNormalizedName(u,r),this.headers.has(r)?this.headers.get(r).push(_):this.headers.set(r,[_])}})}:typeof Headers<"u"&&i instanceof Headers?(this.headers=new Map,i.forEach((o,c)=>{this.setHeaderEntries(c,o)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(i).forEach(([o,c])=>{this.setHeaderEntries(o,c)})}:this.headers=new Map}has(i){return this.init(),this.headers.has(i.toLowerCase())}get(i){this.init();let o=this.headers.get(i.toLowerCase());return o&&o.length>0?o[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(i){return this.init(),this.headers.get(i.toLowerCase())||null}append(i,o){return this.clone({name:i,value:o,op:"a"})}set(i,o){return this.clone({name:i,value:o,op:"s"})}delete(i,o){return this.clone({name:i,value:o,op:"d"})}maybeSetNormalizedName(i,o){this.normalizedNames.has(o)||this.normalizedNames.set(o,i)}init(){this.lazyInit&&(this.lazyInit instanceof a?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(i=>this.applyUpdate(i)),this.lazyUpdate=null))}copyFrom(i){i.init(),Array.from(i.headers.keys()).forEach(o=>{this.headers.set(o,i.headers.get(o)),this.normalizedNames.set(o,i.normalizedNames.get(o))})}clone(i){let o=new a;return o.lazyInit=this.lazyInit&&this.lazyInit instanceof a?this.lazyInit:this,o.lazyUpdate=(this.lazyUpdate||[]).concat([i]),o}applyUpdate(i){let o=i.name.toLowerCase();switch(i.op){case"a":case"s":let c=i.value;if(typeof c=="string"&&(c=[c]),c.length===0)return;this.maybeSetNormalizedName(i.name,o);let u=(i.op==="a"?this.headers.get(o):void 0)||[];u.push(...c),this.headers.set(o,u);break;case"d":let r=i.value;if(!r)this.headers.delete(o),this.normalizedNames.delete(o);else{let _=this.headers.get(o);if(!_)return;_=_.filter(T=>r.indexOf(T)===-1),_.length===0?(this.headers.delete(o),this.normalizedNames.delete(o)):this.headers.set(o,_)}break}}setHeaderEntries(i,o){let c=(Array.isArray(o)?o:[o]).map(r=>r.toString()),u=i.toLowerCase();this.headers.set(u,c),this.maybeSetNormalizedName(i,u)}forEach(i){this.init(),Array.from(this.normalizedNames.keys()).forEach(o=>i(this.normalizedNames.get(o),this.headers.get(o)))}};var c3=function(a){return a[a.Sent=0]="Sent",a[a.UploadProgress=1]="UploadProgress",a[a.ResponseHeader=2]="ResponseHeader",a[a.DownloadProgress=3]="DownloadProgress",a[a.Response=4]="Response",a[a.User=5]="User",a}(c3||{}),W2=class{constructor(i,o=200,c="OK"){this.headers=i.headers||new Kv,this.status=i.status!==void 0?i.status:o,this.statusText=i.statusText||c,this.url=i.url||null,this.ok=this.status>=200&&this.status<300}};var Jv=class a extends W2{constructor(i={}){super(i),this.type=c3.Response,this.body=i.body!==void 0?i.body:null}clone(i={}){return new a({body:i.body!==void 0?i.body:this.body,headers:i.headers||this.headers,status:i.status!==void 0?i.status:this.status,statusText:i.statusText||this.statusText,url:i.url||this.url||void 0})}};var HL=new Hi("");var WL=new Hi(""),r3="b",i3="h",n3="s",a3="st",o3="u",s3="rt",Yv=new Hi(""),qL=["GET","HEAD"];function $L(a,i){let P=Jr(Yv),{isCacheActive:o}=P,c=Fv(P,["isCacheActive"]),{transferCache:u,method:r}=a;if(!o||u===!1||r==="POST"&&!c.includePostRequests&&!u||r!=="POST"&&!qL.includes(r)||!c.includeRequestsWithAuthHeaders&&XL(a)||c.filter?.(a)===!1)return i(a);let _=Jr(z2),T=Jr(WL,{optional:!0}),E=v_(Jr(Xd));if(T&&!E)throw new Xa(2803,!1);let k=E&&T?JL(a.url,T):a.url,D=YL(a,k),j=_.get(D,null),B=c.includeHeaders;if(typeof u=="object"&&u.includeHeaders&&(B=u.includeHeaders),j){let{[r3]:ee,[s3]:G,[i3]:K,[n3]:J,[a3]:ne,[o3]:he}=j,Me=ee;switch(G){case"arraybuffer":Me=new TextEncoder().encode(ee).buffer;break;case"blob":Me=new Blob([ee]);break}let Re=new Kv(K);return ji(new Jv({body:Me,headers:Re,status:J,statusText:ne,url:he}))}return i(a).pipe(cs(ee=>{ee instanceof Jv&&E&&_.set(D,{[r3]:ee.body,[i3]:ZL(ee.headers,B),[n3]:ee.status,[a3]:ee.statusText,[o3]:k,[s3]:a.responseType})}))}function XL(a){return a.headers.has("authorization")||a.headers.has("proxy-authorization")}function ZL(a,i){if(!i)return{};let o={};for(let c of i){let u=a.getAll(c);u!==null&&(o[c]=u)}return o}function l3(a){return[...a.keys()].sort().map(i=>`${i}=${a.getAll(i)}`).join("&")}function YL(a,i){let{params:o,method:c,responseType:u}=a,r=l3(o),_=a.serializeBody();_ instanceof URLSearchParams?_=l3(_):typeof _!="string"&&(_="");let T=[c,u,i,_,r].join("|"),E=KL(T);return E}function KL(a){let i=0;for(let o of a)i=Math.imul(31,i)+o.charCodeAt(0)<<0;return i+=2147483648,i.toString()}function u3(a){return[{provide:Yv,useFactory:()=>(Gv("NgHttpTransferCache"),jr({isCacheActive:!0},a))},{provide:HL,useValue:$L,multi:!0,deps:[z2,Yv]},{provide:Xv,multi:!0,useFactory:()=>{let i=Jr(__),o=Jr(Yv);return()=>{VC(i).then(()=>{o.isCacheActive=!1})}}}]}function JL(a,i){let o=new URL(a,"resolve://").origin,c=i[o];return c?a.replace(o,c):a}var X2=class extends $C{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Z2=class a extends X2{static makeCurrent(){qC(new a)}onAndCancel(i,o,c){return i.addEventListener(o,c),()=>{i.removeEventListener(o,c)}}dispatchEvent(i,o){i.dispatchEvent(o)}remove(i){i.parentNode&&i.parentNode.removeChild(i)}createElement(i,o){return o=o||this.getDefaultDocument(),o.createElement(i)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(i){return i.nodeType===Node.ELEMENT_NODE}isShadowRoot(i){return i instanceof DocumentFragment}getGlobalEventTarget(i,o){return o==="window"?window:o==="document"?i:o==="body"?i.body:null}getBaseHref(i){let o=tO();return o==null?null:rO(o)}resetBaseElement(){y_=null}getUserAgent(){return window.navigator.userAgent}getCookie(i){return V2(document.cookie,i)}},y_=null;function tO(){return y_=y_||document.querySelector("base"),y_?y_.getAttribute("href"):null}function rO(a){return new URL(a,document.baseURI).pathname}var iO=(()=>{let i=class i{build(){return new XMLHttpRequest}};i.\u0275fac=function(u){return new(u||i)},i.\u0275prov=Li({token:i,factory:i.\u0275fac});let a=i;return a})(),Qv=new Hi(""),f3=(()=>{let i=class i{constructor(c,u){this._zone=u,this._eventNameToPlugin=new Map,c.forEach(r=>{r.manager=this}),this._plugins=c.slice().reverse()}addEventListener(c,u,r){return this._findPluginFor(u).addEventListener(c,u,r)}getZone(){return this._zone}_findPluginFor(c){let u=this._eventNameToPlugin.get(c);if(u)return u;if(u=this._plugins.find(_=>_.supports(c)),!u)throw new Xa(5101,!1);return this._eventNameToPlugin.set(c,u),u}};i.\u0275fac=function(u){return new(u||i)(bi(Qv),bi(Tn))},i.\u0275prov=Li({token:i,factory:i.\u0275fac});let a=i;return a})(),x_=class{constructor(i){this._doc=i}},q2="ng-app-id",p3=(()=>{let i=class i{constructor(c,u,r,_={}){this.doc=c,this.appId=u,this.nonce=r,this.platformId=_,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=v_(_),this.resetHostNodes()}addStyles(c){for(let u of c)this.changeUsageCount(u,1)===1&&this.onStyleAdded(u)}removeStyles(c){for(let u of c)this.changeUsageCount(u,-1)<=0&&this.onStyleRemoved(u)}ngOnDestroy(){let c=this.styleNodesInDOM;c&&(c.forEach(u=>u.remove()),c.clear());for(let u of this.getAllStyles())this.onStyleRemoved(u);this.resetHostNodes()}addHost(c){this.hostNodes.add(c);for(let u of this.getAllStyles())this.addStyleToHost(c,u)}removeHost(c){this.hostNodes.delete(c)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(c){for(let u of this.hostNodes)this.addStyleToHost(u,c)}onStyleRemoved(c){let u=this.styleRef;u.get(c)?.elements?.forEach(r=>r.remove()),u.delete(c)}collectServerRenderedStyles(){let c=this.doc.head?.querySelectorAll(`style[${q2}="${this.appId}"]`);if(c?.length){let u=new Map;return c.forEach(r=>{r.textContent!=null&&u.set(r.textContent,r)}),u}return null}changeUsageCount(c,u){let r=this.styleRef;if(r.has(c)){let _=r.get(c);return _.usage+=u,_.usage}return r.set(c,{usage:u,elements:[]}),u}getStyleElement(c,u){let r=this.styleNodesInDOM,_=r?.get(u);if(_?.parentNode===c)return r.delete(u),_.removeAttribute(q2),_;{let T=this.doc.createElement("style");return this.nonce&&T.setAttribute("nonce",this.nonce),T.textContent=u,this.platformIsServer&&T.setAttribute(q2,this.appId),c.appendChild(T),T}}addStyleToHost(c,u){let r=this.getStyleElement(c,u),_=this.styleRef,T=_.get(u)?.elements;T?T.push(r):_.set(u,{elements:[r],usage:1})}resetHostNodes(){let c=this.hostNodes;c.clear(),c.add(this.doc.head)}};i.\u0275fac=function(u){return new(u||i)(bi(aa),bi(jv),bi(f_,8),bi(Xd))},i.\u0275prov=Li({token:i,factory:i.\u0275fac});let a=i;return a})(),$2={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Q2=/%COMP%/g,m3="%COMP%",nO=`_nghost-${m3}`,aO=`_ngcontent-${m3}`,oO=!0,sO=new Hi("",{providedIn:"root",factory:()=>oO});function lO(a){return aO.replace(Q2,a)}function cO(a){return nO.replace(Q2,a)}function g3(a,i){return i.map(o=>o.replace(Q2,a))}var ey=(()=>{let i=class i{constructor(c,u,r,_,T,E,k,D=null){this.eventManager=c,this.sharedStylesHost=u,this.appId=r,this.removeStylesOnCompDestroy=_,this.doc=T,this.platformId=E,this.ngZone=k,this.nonce=D,this.rendererByCompId=new Map,this.platformIsServer=v_(E),this.defaultRenderer=new b_(c,T,k,this.platformIsServer)}createRenderer(c,u){if(!c||!u)return this.defaultRenderer;this.platformIsServer&&u.encapsulation===d_.ShadowDom&&(u=ba(jr({},u),{encapsulation:d_.Emulated}));let r=this.getOrCreateRenderer(c,u);return r instanceof ty?r.applyToHost(c):r instanceof w_&&r.applyStyles(),r}getOrCreateRenderer(c,u){let r=this.rendererByCompId,_=r.get(u.id);if(!_){let T=this.doc,E=this.ngZone,k=this.eventManager,D=this.sharedStylesHost,j=this.removeStylesOnCompDestroy,B=this.platformIsServer;switch(u.encapsulation){case d_.Emulated:_=new ty(k,D,u,this.appId,j,T,E,B);break;case d_.ShadowDom:return new Y2(k,D,c,u,T,E,this.nonce,B);default:_=new w_(k,D,u,j,T,E,B);break}r.set(u.id,_)}return _}ngOnDestroy(){this.rendererByCompId.clear()}};i.\u0275fac=function(u){return new(u||i)(bi(f3),bi(p3),bi(jv),bi(sO),bi(aa),bi(Xd),bi(Tn),bi(f_))},i.\u0275prov=Li({token:i,factory:i.\u0275fac});let a=i;return a})(),b_=class{constructor(i,o,c,u){this.eventManager=i,this.doc=o,this.ngZone=c,this.platformIsServer=u,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(i,o){return o?this.doc.createElementNS($2[o]||o,i):this.doc.createElement(i)}createComment(i){return this.doc.createComment(i)}createText(i){return this.doc.createTextNode(i)}appendChild(i,o){(h3(i)?i.content:i).appendChild(o)}insertBefore(i,o,c){i&&(h3(i)?i.content:i).insertBefore(o,c)}removeChild(i,o){i&&i.removeChild(o)}selectRootElement(i,o){let c=typeof i=="string"?this.doc.querySelector(i):i;if(!c)throw new Xa(-5104,!1);return o||(c.textContent=""),c}parentNode(i){return i.parentNode}nextSibling(i){return i.nextSibling}setAttribute(i,o,c,u){if(u){o=u+":"+o;let r=$2[u];r?i.setAttributeNS(r,o,c):i.setAttribute(o,c)}else i.setAttribute(o,c)}removeAttribute(i,o,c){if(c){let u=$2[c];u?i.removeAttributeNS(u,o):i.removeAttribute(`${c}:${o}`)}else i.removeAttribute(o)}addClass(i,o){i.classList.add(o)}removeClass(i,o){i.classList.remove(o)}setStyle(i,o,c,u){u&(p_.DashCase|p_.Important)?i.style.setProperty(o,c,u&p_.Important?"important":""):i.style[o]=c}removeStyle(i,o,c){c&p_.DashCase?i.style.removeProperty(o):i.style[o]=""}setProperty(i,o,c){i!=null&&(i[o]=c)}setValue(i,o){i.nodeValue=o}listen(i,o,c){if(typeof i=="string"&&(i=A0().getGlobalEventTarget(this.doc,i),!i))throw new Error(`Unsupported event target ${i} for event ${o}`);return this.eventManager.addEventListener(i,o,this.decoratePreventDefault(c))}decoratePreventDefault(i){return o=>{if(o==="__ngUnwrap__")return i;(this.platformIsServer?this.ngZone.runGuarded(()=>i(o)):i(o))===!1&&o.preventDefault()}}};function h3(a){return a.tagName==="TEMPLATE"&&a.content!==void 0}var Y2=class extends b_{constructor(i,o,c,u,r,_,T,E){super(i,r,_,E),this.sharedStylesHost=o,this.hostEl=c,this.shadowRoot=c.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let k=g3(u.id,u.styles);for(let D of k){let j=document.createElement("style");T&&j.setAttribute("nonce",T),j.textContent=D,this.shadowRoot.appendChild(j)}}nodeOrShadowRoot(i){return i===this.hostEl?this.shadowRoot:i}appendChild(i,o){return super.appendChild(this.nodeOrShadowRoot(i),o)}insertBefore(i,o,c){return super.insertBefore(this.nodeOrShadowRoot(i),o,c)}removeChild(i,o){return super.removeChild(this.nodeOrShadowRoot(i),o)}parentNode(i){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(i)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},w_=class extends b_{constructor(i,o,c,u,r,_,T,E){super(i,r,_,T),this.sharedStylesHost=o,this.removeStylesOnCompDestroy=u,this.styles=E?g3(E,c.styles):c.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},ty=class extends w_{constructor(i,o,c,u,r,_,T,E){let k=u+"-"+c.id;super(i,o,c,r,_,T,E,k),this.contentAttr=lO(k),this.hostAttr=cO(k)}applyToHost(i){this.applyStyles(),this.setAttribute(i,this.hostAttr,"")}createElement(i,o){let c=super.createElement(i,o);return super.setAttribute(c,this.contentAttr,""),c}},uO=(()=>{let i=class i extends x_{constructor(c){super(c)}supports(c){return!0}addEventListener(c,u,r){return c.addEventListener(u,r,!1),()=>this.removeEventListener(c,u,r)}removeEventListener(c,u,r){return c.removeEventListener(u,r)}};i.\u0275fac=function(u){return new(u||i)(bi(aa))},i.\u0275prov=Li({token:i,factory:i.\u0275fac});let a=i;return a})(),hO=(()=>{let i=class i extends x_{constructor(c){super(c),this.delegate=Jr(HC,{optional:!0})}supports(c){return this.delegate?this.delegate.supports(c):!1}addEventListener(c,u,r){return this.delegate.addEventListener(c,u,r)}removeEventListener(c,u,r){return this.delegate.removeEventListener(c,u,r)}};i.\u0275fac=function(u){return new(u||i)(bi(aa))},i.\u0275prov=Li({token:i,factory:i.\u0275fac});let a=i;return a})(),d3=["alt","control","meta","shift"],dO={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},fO={alt:a=>a.altKey,control:a=>a.ctrlKey,meta:a=>a.metaKey,shift:a=>a.shiftKey},pO=(()=>{let i=class i extends x_{constructor(c){super(c)}supports(c){return i.parseEventName(c)!=null}addEventListener(c,u,r){let _=i.parseEventName(u),T=i.eventCallback(_.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>A0().onAndCancel(c,_.domEventName,T))}static parseEventName(c){let u=c.toLowerCase().split("."),r=u.shift();if(u.length===0||!(r==="keydown"||r==="keyup"))return null;let _=i._normalizeKey(u.pop()),T="",E=u.indexOf("code");if(E>-1&&(u.splice(E,1),T="code."),d3.forEach(D=>{let j=u.indexOf(D);j>-1&&(u.splice(j,1),T+=D+".")}),T+=_,u.length!=0||_.length===0)return null;let k={};return k.domEventName=r,k.fullKey=T,k}static matchEventFullKeyCode(c,u){let r=dO[c.key]||c.key,_="";return u.indexOf("code.")>-1&&(r=c.code,_="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),d3.forEach(T=>{if(T!==r){let E=fO[T];E(c)&&(_+=T+".")}}),_+=r,_===u)}static eventCallback(c,u,r){return _=>{i.matchEventFullKeyCode(_,c)&&r.runGuarded(()=>u(_))}}static _normalizeKey(c){return c==="esc"?"escape":c}};i.\u0275fac=function(u){return new(u||i)(bi(aa))},i.\u0275prov=Li({token:i,factory:i.\u0275fac});let a=i;return a})();function _3(a,i){return GC(jr({rootComponent:a},mO(i)))}function mO(a){return{appProviders:[...xO,...a?.providers??[]],platformProviders:yO}}function gO(){Z2.makeCurrent()}function _O(){return new zv}function vO(){return RC(document),document}var yO=[{provide:Xd,useValue:ZC},{provide:FC,useValue:gO,multi:!0},{provide:aa,useFactory:vO,deps:[]}];var xO=[{provide:DC,useValue:"root"},{provide:zv,useFactory:_O,deps:[]},{provide:Qv,useClass:uO,multi:!0,deps:[aa,Tn,Xd]},{provide:Qv,useClass:pO,multi:!0,deps:[aa]},{provide:Qv,useClass:hO,multi:!0},ey,p3,f3,{provide:Uv,useExisting:ey},{provide:KC,useClass:iO,deps:[]},[]];var v3=(()=>{let i=class i{constructor(c){this._doc=c}getTitle(){return this._doc.title}setTitle(c){this._doc.title=c||""}};i.\u0275fac=function(u){return new(u||i)(bi(aa))},i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();var K2=function(a){return a[a.NoHttpTransferCache=0]="NoHttpTransferCache",a[a.HttpTransferCacheOptions=1]="HttpTransferCacheOptions",a[a.I18nSupport=2]="I18nSupport",a[a.EventReplay=3]="EventReplay",a}(K2||{});function y3(...a){let i=[],o=new Set,c=o.has(K2.HttpTransferCacheOptions);for(let{\u0275providers:u,\u0275kind:r}of a)o.add(r),u.length&&i.push(u);return om([[],WC(),o.has(K2.NoHttpTransferCache)||c?[]:u3({}),i])}var gn="primary",z_=Symbol("RouteTitle"),nw=class{constructor(i){this.params=i||{}}has(i){return Object.prototype.hasOwnProperty.call(this.params,i)}get(i){if(this.has(i)){let o=this.params[i];return Array.isArray(o)?o[0]:o}return null}getAll(i){if(this.has(i)){let o=this.params[i];return Array.isArray(o)?o:[o]}return[]}get keys(){return Object.keys(this.params)}};function R0(a){return new nw(a)}function wO(a,i,o){let c=o.path.split("/");if(c.length>a.length||o.pathMatch==="full"&&(i.hasChildren()||c.length<a.length))return null;let u={};for(let r=0;r<c.length;r++){let _=c[r],T=a[r];if(_[0]===":")u[_.substring(1)]=T;else if(_!==T.path)return null}return{consumed:a.slice(0,c.length),posParams:u}}function TO(a,i){if(a.length!==i.length)return!1;for(let o=0;o<a.length;++o)if(!nd(a[o],i[o]))return!1;return!0}function nd(a,i){let o=a?aw(a):void 0,c=i?aw(i):void 0;if(!o||!c||o.length!=c.length)return!1;let u;for(let r=0;r<o.length;r++)if(u=o[r],!C3(a[u],i[u]))return!1;return!0}function aw(a){return[...Object.keys(a),...Object.getOwnPropertySymbols(a)]}function C3(a,i){if(Array.isArray(a)&&Array.isArray(i)){if(a.length!==i.length)return!1;let o=[...a].sort(),c=[...i].sort();return o.every((u,r)=>c[r]===u)}else return a===i}function I3(a){return a.length>0?a[a.length-1]:null}function sp(a){return b0(a)?a:$v(a)?sc(Promise.resolve(a)):ji(a)}var SO={exact:M3,subset:D3},k3={exact:EO,subset:AO,ignored:()=>!0};function x3(a,i,o){return SO[o.paths](a.root,i.root,o.matrixParams)&&k3[o.queryParams](a.queryParams,i.queryParams)&&!(o.fragment==="exact"&&a.fragment!==i.fragment)}function EO(a,i){return nd(a,i)}function M3(a,i,o){if(!cm(a.segments,i.segments)||!ny(a.segments,i.segments,o)||a.numberOfChildren!==i.numberOfChildren)return!1;for(let c in i.children)if(!a.children[c]||!M3(a.children[c],i.children[c],o))return!1;return!0}function AO(a,i){return Object.keys(i).length<=Object.keys(a).length&&Object.keys(i).every(o=>C3(a[o],i[o]))}function D3(a,i,o){return R3(a,i,i.segments,o)}function R3(a,i,o,c){if(a.segments.length>o.length){let u=a.segments.slice(0,o.length);return!(!cm(u,o)||i.hasChildren()||!ny(u,o,c))}else if(a.segments.length===o.length){if(!cm(a.segments,o)||!ny(a.segments,o,c))return!1;for(let u in i.children)if(!a.children[u]||!D3(a.children[u],i.children[u],c))return!1;return!0}else{let u=o.slice(0,a.segments.length),r=o.slice(a.segments.length);return!cm(a.segments,u)||!ny(a.segments,u,c)||!a.children[gn]?!1:R3(a.children[gn],i,r,c)}}function ny(a,i,o){return i.every((c,u)=>k3[o](a[u].parameters,c.parameters))}var nf=class{constructor(i=new ga([],{}),o={},c=null){this.root=i,this.queryParams=o,this.fragment=c}get queryParamMap(){return this._queryParamMap??=R0(this.queryParams),this._queryParamMap}toString(){return kO.serialize(this)}},ga=class{constructor(i,o){this.segments=i,this.children=o,this.parent=null,Object.values(o).forEach(c=>c.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ay(this)}},lm=class{constructor(i,o){this.path=i,this.parameters=o}get parameterMap(){return this._parameterMap??=R0(this.parameters),this._parameterMap}toString(){return P3(this)}};function CO(a,i){return cm(a,i)&&a.every((o,c)=>nd(o.parameters,i[c].parameters))}function cm(a,i){return a.length!==i.length?!1:a.every((o,c)=>o.path===i[c].path)}function IO(a,i){let o=[];return Object.entries(a.children).forEach(([c,u])=>{c===gn&&(o=o.concat(i(u,c)))}),Object.entries(a.children).forEach(([c,u])=>{c!==gn&&(o=o.concat(i(u,c)))}),o}var Dw=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275prov=Li({token:i,factory:()=>new k_,providedIn:"root"});let a=i;return a})(),k_=class{parse(i){let o=new sw(i);return new nf(o.parseRootSegment(),o.parseQueryParams(),o.parseFragment())}serialize(i){let o=`/${T_(i.root,!0)}`,c=RO(i.queryParams),u=typeof i.fragment=="string"?`#${MO(i.fragment)}`:"";return`${o}${c}${u}`}},kO=new k_;function ay(a){return a.segments.map(i=>P3(i)).join("/")}function T_(a,i){if(!a.hasChildren())return ay(a);if(i){let o=a.children[gn]?T_(a.children[gn],!1):"",c=[];return Object.entries(a.children).forEach(([u,r])=>{u!==gn&&c.push(`${u}:${T_(r,!1)}`)}),c.length>0?`${o}(${c.join("//")})`:o}else{let o=IO(a,(c,u)=>u===gn?[T_(a.children[gn],!1)]:[`${u}:${T_(c,!1)}`]);return Object.keys(a.children).length===1&&a.children[gn]!=null?`${ay(a)}/${o[0]}`:`${ay(a)}/(${o.join("//")})`}}function F3(a){return encodeURIComponent(a).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ry(a){return F3(a).replace(/%3B/gi,";")}function MO(a){return encodeURI(a)}function ow(a){return F3(a).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function oy(a){return decodeURIComponent(a)}function b3(a){return oy(a.replace(/\+/g,"%20"))}function P3(a){return`${ow(a.path)}${DO(a.parameters)}`}function DO(a){return Object.entries(a).map(([i,o])=>`;${ow(i)}=${ow(o)}`).join("")}function RO(a){let i=Object.entries(a).map(([o,c])=>Array.isArray(c)?c.map(u=>`${ry(o)}=${ry(u)}`).join("&"):`${ry(o)}=${ry(c)}`).filter(o=>o);return i.length?`?${i.join("&")}`:""}var FO=/^[^\/()?;#]+/;function ew(a){let i=a.match(FO);return i?i[0]:""}var PO=/^[^\/()?;=#]+/;function LO(a){let i=a.match(PO);return i?i[0]:""}var OO=/^[^=?&#]+/;function NO(a){let i=a.match(OO);return i?i[0]:""}var BO=/^[^&#]+/;function zO(a){let i=a.match(BO);return i?i[0]:""}var sw=class{constructor(i){this.url=i,this.remaining=i}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new ga([],{}):new ga([],this.parseChildren())}parseQueryParams(){let i={};if(this.consumeOptional("?"))do this.parseQueryParam(i);while(this.consumeOptional("&"));return i}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let i=[];for(this.peekStartsWith("(")||i.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),i.push(this.parseSegment());let o={};this.peekStartsWith("/(")&&(this.capture("/"),o=this.parseParens(!0));let c={};return this.peekStartsWith("(")&&(c=this.parseParens(!1)),(i.length>0||Object.keys(o).length>0)&&(c[gn]=new ga(i,o)),c}parseSegment(){let i=ew(this.remaining);if(i===""&&this.peekStartsWith(";"))throw new Xa(4009,!1);return this.capture(i),new lm(oy(i),this.parseMatrixParams())}parseMatrixParams(){let i={};for(;this.consumeOptional(";");)this.parseParam(i);return i}parseParam(i){let o=LO(this.remaining);if(!o)return;this.capture(o);let c="";if(this.consumeOptional("=")){let u=ew(this.remaining);u&&(c=u,this.capture(c))}i[oy(o)]=oy(c)}parseQueryParam(i){let o=NO(this.remaining);if(!o)return;this.capture(o);let c="";if(this.consumeOptional("=")){let _=zO(this.remaining);_&&(c=_,this.capture(c))}let u=b3(o),r=b3(c);if(i.hasOwnProperty(u)){let _=i[u];Array.isArray(_)||(_=[_],i[u]=_),_.push(r)}else i[u]=r}parseParens(i){let o={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let c=ew(this.remaining),u=this.remaining[c.length];if(u!=="/"&&u!==")"&&u!==";")throw new Xa(4010,!1);let r;c.indexOf(":")>-1?(r=c.slice(0,c.indexOf(":")),this.capture(r),this.capture(":")):i&&(r=gn);let _=this.parseChildren();o[r]=Object.keys(_).length===1?_[gn]:new ga([],_),this.consumeOptional("//")}return o}peekStartsWith(i){return this.remaining.startsWith(i)}consumeOptional(i){return this.peekStartsWith(i)?(this.remaining=this.remaining.substring(i.length),!0):!1}capture(i){if(!this.consumeOptional(i))throw new Xa(4011,!1)}};function L3(a){return a.segments.length>0?new ga([],{[gn]:a}):a}function O3(a){let i={};for(let[c,u]of Object.entries(a.children)){let r=O3(u);if(c===gn&&r.segments.length===0&&r.hasChildren())for(let[_,T]of Object.entries(r.children))i[_]=T;else(r.segments.length>0||r.hasChildren())&&(i[c]=r)}let o=new ga(a.segments,i);return jO(o)}function jO(a){if(a.numberOfChildren===1&&a.children[gn]){let i=a.children[gn];return new ga(a.segments.concat(i.segments),i.children)}return a}function M_(a){return a instanceof nf}function UO(a,i,o=null,c=null){let u=N3(a);return B3(u,i,o,c)}function N3(a){let i;function o(r){let _={};for(let E of r.children){let k=o(E);_[E.outlet]=k}let T=new ga(r.url,_);return r===a&&(i=T),T}let c=o(a.root),u=L3(c);return i??u}function B3(a,i,o,c){let u=a;for(;u.parent;)u=u.parent;if(i.length===0)return tw(u,u,u,o,c);let r=VO(i);if(r.toRoot())return tw(u,u,new ga([],{}),o,c);let _=GO(r,u,a),T=_.processChildren?A_(_.segmentGroup,_.index,r.commands):j3(_.segmentGroup,_.index,r.commands);return tw(u,_.segmentGroup,T,o,c)}function sy(a){return typeof a=="object"&&a!=null&&!a.outlets&&!a.segmentPath}function D_(a){return typeof a=="object"&&a!=null&&a.outlets}function tw(a,i,o,c,u){let r={};c&&Object.entries(c).forEach(([E,k])=>{r[E]=Array.isArray(k)?k.map(D=>`${D}`):`${k}`});let _;a===i?_=o:_=z3(a,i,o);let T=L3(O3(_));return new nf(T,r,u)}function z3(a,i,o){let c={};return Object.entries(a.children).forEach(([u,r])=>{r===i?c[u]=o:c[u]=z3(r,i,o)}),new ga(a.segments,c)}var ly=class{constructor(i,o,c){if(this.isAbsolute=i,this.numberOfDoubleDots=o,this.commands=c,i&&c.length>0&&sy(c[0]))throw new Xa(4003,!1);let u=c.find(D_);if(u&&u!==I3(c))throw new Xa(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function VO(a){if(typeof a[0]=="string"&&a.length===1&&a[0]==="/")return new ly(!0,0,a);let i=0,o=!1,c=a.reduce((u,r,_)=>{if(typeof r=="object"&&r!=null){if(r.outlets){let T={};return Object.entries(r.outlets).forEach(([E,k])=>{T[E]=typeof k=="string"?k.split("/"):k}),[...u,{outlets:T}]}if(r.segmentPath)return[...u,r.segmentPath]}return typeof r!="string"?[...u,r]:_===0?(r.split("/").forEach((T,E)=>{E==0&&T==="."||(E==0&&T===""?o=!0:T===".."?i++:T!=""&&u.push(T))}),u):[...u,r]},[]);return new ly(o,i,c)}var k0=class{constructor(i,o,c){this.segmentGroup=i,this.processChildren=o,this.index=c}};function GO(a,i,o){if(a.isAbsolute)return new k0(i,!0,0);if(!o)return new k0(i,!1,NaN);if(o.parent===null)return new k0(o,!0,0);let c=sy(a.commands[0])?0:1,u=o.segments.length-1+c;return HO(o,u,a.numberOfDoubleDots)}function HO(a,i,o){let c=a,u=i,r=o;for(;r>u;){if(r-=u,c=c.parent,!c)throw new Xa(4005,!1);u=c.segments.length}return new k0(c,!1,u-r)}function WO(a){return D_(a[0])?a[0].outlets:{[gn]:a}}function j3(a,i,o){if(a??=new ga([],{}),a.segments.length===0&&a.hasChildren())return A_(a,i,o);let c=qO(a,i,o),u=o.slice(c.commandIndex);if(c.match&&c.pathIndex<a.segments.length){let r=new ga(a.segments.slice(0,c.pathIndex),{});return r.children[gn]=new ga(a.segments.slice(c.pathIndex),a.children),A_(r,0,u)}else return c.match&&u.length===0?new ga(a.segments,{}):c.match&&!a.hasChildren()?lw(a,i,o):c.match?A_(a,0,u):lw(a,i,o)}function A_(a,i,o){if(o.length===0)return new ga(a.segments,{});{let c=WO(o),u={};if(Object.keys(c).some(r=>r!==gn)&&a.children[gn]&&a.numberOfChildren===1&&a.children[gn].segments.length===0){let r=A_(a.children[gn],i,o);return new ga(a.segments,r.children)}return Object.entries(c).forEach(([r,_])=>{typeof _=="string"&&(_=[_]),_!==null&&(u[r]=j3(a.children[r],i,_))}),Object.entries(a.children).forEach(([r,_])=>{c[r]===void 0&&(u[r]=_)}),new ga(a.segments,u)}}function qO(a,i,o){let c=0,u=i,r={match:!1,pathIndex:0,commandIndex:0};for(;u<a.segments.length;){if(c>=o.length)return r;let _=a.segments[u],T=o[c];if(D_(T))break;let E=`${T}`,k=c<o.length-1?o[c+1]:null;if(u>0&&E===void 0)break;if(E&&k&&typeof k=="object"&&k.outlets===void 0){if(!T3(E,k,_))return r;c+=2}else{if(!T3(E,{},_))return r;c++}u++}return{match:!0,pathIndex:u,commandIndex:c}}function lw(a,i,o){let c=a.segments.slice(0,i),u=0;for(;u<o.length;){let r=o[u];if(D_(r)){let E=$O(r.outlets);return new ga(c,E)}if(u===0&&sy(o[0])){let E=a.segments[i];c.push(new lm(E.path,w3(o[0]))),u++;continue}let _=D_(r)?r.outlets[gn]:`${r}`,T=u<o.length-1?o[u+1]:null;_&&T&&sy(T)?(c.push(new lm(_,w3(T))),u+=2):(c.push(new lm(_,{})),u++)}return new ga(c,{})}function $O(a){let i={};return Object.entries(a).forEach(([o,c])=>{typeof c=="string"&&(c=[c]),c!==null&&(i[o]=lw(new ga([],{}),0,c))}),i}function w3(a){let i={};return Object.entries(a).forEach(([o,c])=>i[o]=`${c}`),i}function T3(a,i,o){return a==o.path&&nd(i,o.parameters)}var C_="imperative",Zs=function(a){return a[a.NavigationStart=0]="NavigationStart",a[a.NavigationEnd=1]="NavigationEnd",a[a.NavigationCancel=2]="NavigationCancel",a[a.NavigationError=3]="NavigationError",a[a.RoutesRecognized=4]="RoutesRecognized",a[a.ResolveStart=5]="ResolveStart",a[a.ResolveEnd=6]="ResolveEnd",a[a.GuardsCheckStart=7]="GuardsCheckStart",a[a.GuardsCheckEnd=8]="GuardsCheckEnd",a[a.RouteConfigLoadStart=9]="RouteConfigLoadStart",a[a.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",a[a.ChildActivationStart=11]="ChildActivationStart",a[a.ChildActivationEnd=12]="ChildActivationEnd",a[a.ActivationStart=13]="ActivationStart",a[a.ActivationEnd=14]="ActivationEnd",a[a.Scroll=15]="Scroll",a[a.NavigationSkipped=16]="NavigationSkipped",a}(Zs||{}),wu=class{constructor(i,o){this.id=i,this.url=o}},R_=class extends wu{constructor(i,o,c="imperative",u=null){super(i,o),this.type=Zs.NavigationStart,this.navigationTrigger=c,this.restoredState=u}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},um=class extends wu{constructor(i,o,c){super(i,o),this.urlAfterRedirects=c,this.type=Zs.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Hc=function(a){return a[a.Redirect=0]="Redirect",a[a.SupersededByNewNavigation=1]="SupersededByNewNavigation",a[a.NoDataFromResolver=2]="NoDataFromResolver",a[a.GuardRejected=3]="GuardRejected",a}(Hc||{}),cw=function(a){return a[a.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",a[a.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",a}(cw||{}),rf=class extends wu{constructor(i,o,c,u){super(i,o),this.reason=c,this.code=u,this.type=Zs.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},hm=class extends wu{constructor(i,o,c,u){super(i,o),this.reason=c,this.code=u,this.type=Zs.NavigationSkipped}},F_=class extends wu{constructor(i,o,c,u){super(i,o),this.error=c,this.target=u,this.type=Zs.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},cy=class extends wu{constructor(i,o,c,u){super(i,o),this.urlAfterRedirects=c,this.state=u,this.type=Zs.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},uw=class extends wu{constructor(i,o,c,u){super(i,o),this.urlAfterRedirects=c,this.state=u,this.type=Zs.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},hw=class extends wu{constructor(i,o,c,u,r){super(i,o),this.urlAfterRedirects=c,this.state=u,this.shouldActivate=r,this.type=Zs.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},dw=class extends wu{constructor(i,o,c,u){super(i,o),this.urlAfterRedirects=c,this.state=u,this.type=Zs.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},fw=class extends wu{constructor(i,o,c,u){super(i,o),this.urlAfterRedirects=c,this.state=u,this.type=Zs.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},pw=class{constructor(i){this.route=i,this.type=Zs.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},mw=class{constructor(i){this.route=i,this.type=Zs.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},gw=class{constructor(i){this.snapshot=i,this.type=Zs.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},_w=class{constructor(i){this.snapshot=i,this.type=Zs.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},vw=class{constructor(i){this.snapshot=i,this.type=Zs.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},yw=class{constructor(i){this.snapshot=i,this.type=Zs.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var P_=class{},F0=class{constructor(i,o){this.url=i,this.navigationBehaviorOptions=o}};function XO(a,i){return a.providers&&!a._injector&&(a._injector=BC(a.providers,i,`Route: ${a.path}`)),a._injector??i}function hh(a){return a.outlet||gn}function ZO(a,i){let o=a.filter(c=>hh(c)===i);return o.push(...a.filter(c=>hh(c)!==i)),o}function j_(a){if(!a)return null;if(a.routeConfig?._injector)return a.routeConfig._injector;for(let i=a.parent;i;i=i.parent){let o=i.routeConfig;if(o?._loadedInjector)return o._loadedInjector;if(o?._injector)return o._injector}return null}var xw=class{get injector(){return j_(this.route?.snapshot)??this.rootInjector}set injector(i){}constructor(i){this.rootInjector=i,this.outlet=null,this.route=null,this.children=new gy(this.rootInjector),this.attachRef=null}},gy=(()=>{let i=class i{constructor(c){this.rootInjector=c,this.contexts=new Map}onChildOutletCreated(c,u){let r=this.getOrCreateContext(c);r.outlet=u,this.contexts.set(c,r)}onChildOutletDestroyed(c){let u=this.getContext(c);u&&(u.outlet=null,u.attachRef=null)}onOutletDeactivated(){let c=this.contexts;return this.contexts=new Map,c}onOutletReAttached(c){this.contexts=c}getOrCreateContext(c){let u=this.getContext(c);return u||(u=new xw(this.rootInjector),this.contexts.set(c,u)),u}getContext(c){return this.contexts.get(c)||null}};i.\u0275fac=function(u){return new(u||i)(bi(Ov))},i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})(),uy=class{constructor(i){this._root=i}get root(){return this._root.value}parent(i){let o=this.pathFromRoot(i);return o.length>1?o[o.length-2]:null}children(i){let o=bw(i,this._root);return o?o.children.map(c=>c.value):[]}firstChild(i){let o=bw(i,this._root);return o&&o.children.length>0?o.children[0].value:null}siblings(i){let o=ww(i,this._root);return o.length<2?[]:o[o.length-2].children.map(u=>u.value).filter(u=>u!==i)}pathFromRoot(i){return ww(i,this._root).map(o=>o.value)}};function bw(a,i){if(a===i.value)return i;for(let o of i.children){let c=bw(a,o);if(c)return c}return null}function ww(a,i){if(a===i.value)return[i];for(let o of i.children){let c=ww(a,o);if(c.length)return c.unshift(i),c}return[]}var Gc=class{constructor(i,o){this.value=i,this.children=o}toString(){return`TreeNode(${this.value})`}};function I0(a){let i={};return a&&a.children.forEach(o=>i[o.value.outlet]=o),i}var hy=class extends uy{constructor(i,o){super(i),this.snapshot=o,Rw(this,i)}toString(){return this.snapshot.toString()}};function U3(a){let i=YO(a),o=new ml([new lm("",{})]),c=new ml({}),u=new ml({}),r=new ml({}),_=new ml(""),T=new P0(o,c,r,_,u,gn,a,i.root);return T.snapshot=i.root,new hy(new Gc(T,[]),i)}function YO(a){let i={},o={},c={},u="",r=new M0([],i,c,u,o,gn,a,null,{});return new fy("",new Gc(r,[]))}var P0=class{constructor(i,o,c,u,r,_,T,E){this.urlSubject=i,this.paramsSubject=o,this.queryParamsSubject=c,this.fragmentSubject=u,this.dataSubject=r,this.outlet=_,this.component=T,this._futureSnapshot=E,this.title=this.dataSubject?.pipe(Xn(k=>k[z_]))??ji(void 0),this.url=i,this.params=o,this.queryParams=c,this.fragment=u,this.data=r}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Xn(i=>R0(i))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Xn(i=>R0(i))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function dy(a,i,o="emptyOnly"){let c,{routeConfig:u}=a;return i!==null&&(o==="always"||u?.path===""||!i.component&&!i.routeConfig?.loadComponent)?c={params:jr(jr({},i.params),a.params),data:jr(jr({},i.data),a.data),resolve:jr(jr(jr(jr({},a.data),i.data),u?.data),a._resolvedData)}:c={params:jr({},a.params),data:jr({},a.data),resolve:jr(jr({},a.data),a._resolvedData??{})},u&&G3(u)&&(c.resolve[z_]=u.title),c}var M0=class{get title(){return this.data?.[z_]}constructor(i,o,c,u,r,_,T,E,k){this.url=i,this.params=o,this.queryParams=c,this.fragment=u,this.data=r,this.outlet=_,this.component=T,this.routeConfig=E,this._resolve=k}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=R0(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=R0(this.queryParams),this._queryParamMap}toString(){let i=this.url.map(c=>c.toString()).join("/"),o=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${i}', path:'${o}')`}},fy=class extends uy{constructor(i,o){super(o),this.url=i,Rw(this,o)}toString(){return V3(this._root)}};function Rw(a,i){i.value._routerState=a,i.children.forEach(o=>Rw(a,o))}function V3(a){let i=a.children.length>0?` { ${a.children.map(V3).join(", ")} } `:"";return`${a.value}${i}`}function rw(a){if(a.snapshot){let i=a.snapshot,o=a._futureSnapshot;a.snapshot=o,nd(i.queryParams,o.queryParams)||a.queryParamsSubject.next(o.queryParams),i.fragment!==o.fragment&&a.fragmentSubject.next(o.fragment),nd(i.params,o.params)||a.paramsSubject.next(o.params),TO(i.url,o.url)||a.urlSubject.next(o.url),nd(i.data,o.data)||a.dataSubject.next(o.data)}else a.snapshot=a._futureSnapshot,a.dataSubject.next(a._futureSnapshot.data)}function Tw(a,i){let o=nd(a.params,i.params)&&CO(a.url,i.url),c=!a.parent!=!i.parent;return o&&!c&&(!a.parent||Tw(a.parent,i.parent))}function G3(a){return typeof a.title=="string"||a.title===null}var Fw=(()=>{let i=class i{constructor(){this.activated=null,this._activatedRoute=null,this.name=gn,this.activateEvents=new $s,this.deactivateEvents=new $s,this.attachEvents=new $s,this.detachEvents=new $s,this.parentContexts=Jr(gy),this.location=Jr(Yd),this.changeDetector=Jr(id),this.inputBinder=Jr(Pw,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(c){if(c.name){let{firstChange:u,previousValue:r}=c.name;if(u)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(c){return this.parentContexts.getContext(c)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let c=this.parentContexts.getContext(this.name);c?.route&&(c.attachRef?this.attach(c.attachRef,c.route):this.activateWith(c.route,c.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Xa(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Xa(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Xa(4012,!1);this.location.detach();let c=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(c.instance),c}attach(c,u){this.activated=c,this._activatedRoute=u,this.location.insert(c.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(c.instance)}deactivate(){if(this.activated){let c=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(c)}}activateWith(c,u){if(this.isActivated)throw new Xa(4013,!1);this._activatedRoute=c;let r=this.location,T=c.snapshot.component,E=this.parentContexts.getOrCreateContext(this.name).children,k=new Sw(c,E,r.injector);this.activated=r.createComponent(T,{index:r.length,injector:k,environmentInjector:u}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};i.\u0275fac=function(u){return new(u||i)},i.\u0275dir=pi({type:i,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[lc]});let a=i;return a})(),Sw=class a{__ngOutletInjector(i){return new a(this.route,this.childContexts,i)}constructor(i,o,c){this.route=i,this.childContexts=o,this.parent=c}get(i,o){return i===P0?this.route:i===gy?this.childContexts:this.parent.get(i,o)}},Pw=new Hi("");function KO(a,i,o){let c=L_(a,i._root,o?o._root:void 0);return new hy(c,i)}function L_(a,i,o){if(o&&a.shouldReuseRoute(i.value,o.value.snapshot)){let c=o.value;c._futureSnapshot=i.value;let u=JO(a,i,o);return new Gc(c,u)}else{if(a.shouldAttach(i.value)){let r=a.retrieve(i.value);if(r!==null){let _=r.route;return _.value._futureSnapshot=i.value,_.children=i.children.map(T=>L_(a,T)),_}}let c=QO(i.value),u=i.children.map(r=>L_(a,r));return new Gc(c,u)}}function JO(a,i,o){return i.children.map(c=>{for(let u of o.children)if(a.shouldReuseRoute(c.value,u.value.snapshot))return L_(a,c,u);return L_(a,c)})}function QO(a){return new P0(new ml(a.url),new ml(a.params),new ml(a.queryParams),new ml(a.fragment),new ml(a.data),a.outlet,a.component,a)}var O_=class{constructor(i,o){this.redirectTo=i,this.navigationBehaviorOptions=o}},H3="ngNavigationCancelingError";function py(a,i){let{redirectTo:o,navigationBehaviorOptions:c}=M_(i)?{redirectTo:i,navigationBehaviorOptions:void 0}:i,u=W3(!1,Hc.Redirect);return u.url=o,u.navigationBehaviorOptions=c,u}function W3(a,i){let o=new Error(`NavigationCancelingError: ${a||""}`);return o[H3]=!0,o.cancellationCode=i,o}function e6(a){return q3(a)&&M_(a.url)}function q3(a){return!!a&&a[H3]}var t6=(a,i,o,c)=>Xn(u=>(new Ew(i,u.targetRouterState,u.currentRouterState,o,c).activate(a),u)),Ew=class{constructor(i,o,c,u,r){this.routeReuseStrategy=i,this.futureState=o,this.currState=c,this.forwardEvent=u,this.inputBindingEnabled=r}activate(i){let o=this.futureState._root,c=this.currState?this.currState._root:null;this.deactivateChildRoutes(o,c,i),rw(this.futureState.root),this.activateChildRoutes(o,c,i)}deactivateChildRoutes(i,o,c){let u=I0(o);i.children.forEach(r=>{let _=r.value.outlet;this.deactivateRoutes(r,u[_],c),delete u[_]}),Object.values(u).forEach(r=>{this.deactivateRouteAndItsChildren(r,c)})}deactivateRoutes(i,o,c){let u=i.value,r=o?o.value:null;if(u===r)if(u.component){let _=c.getContext(u.outlet);_&&this.deactivateChildRoutes(i,o,_.children)}else this.deactivateChildRoutes(i,o,c);else r&&this.deactivateRouteAndItsChildren(o,c)}deactivateRouteAndItsChildren(i,o){i.value.component&&this.routeReuseStrategy.shouldDetach(i.value.snapshot)?this.detachAndStoreRouteSubtree(i,o):this.deactivateRouteAndOutlet(i,o)}detachAndStoreRouteSubtree(i,o){let c=o.getContext(i.value.outlet),u=c&&i.value.component?c.children:o,r=I0(i);for(let _ of Object.values(r))this.deactivateRouteAndItsChildren(_,u);if(c&&c.outlet){let _=c.outlet.detach(),T=c.children.onOutletDeactivated();this.routeReuseStrategy.store(i.value.snapshot,{componentRef:_,route:i,contexts:T})}}deactivateRouteAndOutlet(i,o){let c=o.getContext(i.value.outlet),u=c&&i.value.component?c.children:o,r=I0(i);for(let _ of Object.values(r))this.deactivateRouteAndItsChildren(_,u);c&&(c.outlet&&(c.outlet.deactivate(),c.children.onOutletDeactivated()),c.attachRef=null,c.route=null)}activateChildRoutes(i,o,c){let u=I0(o);i.children.forEach(r=>{this.activateRoutes(r,u[r.value.outlet],c),this.forwardEvent(new yw(r.value.snapshot))}),i.children.length&&this.forwardEvent(new _w(i.value.snapshot))}activateRoutes(i,o,c){let u=i.value,r=o?o.value:null;if(rw(u),u===r)if(u.component){let _=c.getOrCreateContext(u.outlet);this.activateChildRoutes(i,o,_.children)}else this.activateChildRoutes(i,o,c);else if(u.component){let _=c.getOrCreateContext(u.outlet);if(this.routeReuseStrategy.shouldAttach(u.snapshot)){let T=this.routeReuseStrategy.retrieve(u.snapshot);this.routeReuseStrategy.store(u.snapshot,null),_.children.onOutletReAttached(T.contexts),_.attachRef=T.componentRef,_.route=T.route.value,_.outlet&&_.outlet.attach(T.componentRef,T.route.value),rw(T.route.value),this.activateChildRoutes(i,null,_.children)}else _.attachRef=null,_.route=u,_.outlet&&_.outlet.activateWith(u,_.injector),this.activateChildRoutes(i,null,_.children)}else this.activateChildRoutes(i,null,c)}},my=class{constructor(i){this.path=i,this.route=this.path[this.path.length-1]}},D0=class{constructor(i,o){this.component=i,this.route=o}};function r6(a,i,o){let c=a._root,u=i?i._root:null;return S_(c,u,o,[c.value])}function i6(a){let i=a.routeConfig?a.routeConfig.canActivateChild:null;return!i||i.length===0?null:{node:a,guards:i}}function O0(a,i){let o=Symbol(),c=i.get(a,o);return c===o?typeof a=="function"&&!MC(a)?a:i.get(a):c}function S_(a,i,o,c,u={canDeactivateChecks:[],canActivateChecks:[]}){let r=I0(i);return a.children.forEach(_=>{n6(_,r[_.value.outlet],o,c.concat([_.value]),u),delete r[_.value.outlet]}),Object.entries(r).forEach(([_,T])=>I_(T,o.getContext(_),u)),u}function n6(a,i,o,c,u={canDeactivateChecks:[],canActivateChecks:[]}){let r=a.value,_=i?i.value:null,T=o?o.getContext(a.value.outlet):null;if(_&&r.routeConfig===_.routeConfig){let E=a6(_,r,r.routeConfig.runGuardsAndResolvers);E?u.canActivateChecks.push(new my(c)):(r.data=_.data,r._resolvedData=_._resolvedData),r.component?S_(a,i,T?T.children:null,c,u):S_(a,i,o,c,u),E&&T&&T.outlet&&T.outlet.isActivated&&u.canDeactivateChecks.push(new D0(T.outlet.component,_))}else _&&I_(i,T,u),u.canActivateChecks.push(new my(c)),r.component?S_(a,null,T?T.children:null,c,u):S_(a,null,o,c,u);return u}function a6(a,i,o){if(typeof o=="function")return o(a,i);switch(o){case"pathParamsChange":return!cm(a.url,i.url);case"pathParamsOrQueryParamsChange":return!cm(a.url,i.url)||!nd(a.queryParams,i.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Tw(a,i)||!nd(a.queryParams,i.queryParams);case"paramsChange":default:return!Tw(a,i)}}function I_(a,i,o){let c=I0(a),u=a.value;Object.entries(c).forEach(([r,_])=>{u.component?i?I_(_,i.children.getContext(r),o):I_(_,null,o):I_(_,i,o)}),u.component?i&&i.outlet&&i.outlet.isActivated?o.canDeactivateChecks.push(new D0(i.outlet.component,u)):o.canDeactivateChecks.push(new D0(null,u)):o.canDeactivateChecks.push(new D0(null,u))}function U_(a){return typeof a=="function"}function o6(a){return typeof a=="boolean"}function s6(a){return a&&U_(a.canLoad)}function l6(a){return a&&U_(a.canActivate)}function c6(a){return a&&U_(a.canActivateChild)}function u6(a){return a&&U_(a.canDeactivate)}function h6(a){return a&&U_(a.canMatch)}function $3(a){return a instanceof TC||a?.name==="EmptyError"}var iy=Symbol("INITIAL_VALUE");function L0(){return bu(a=>c_(a.map(i=>i.pipe(ip(1),h_(iy)))).pipe(Xn(i=>{for(let o of i)if(o!==!0){if(o===iy)return iy;if(o===!1||d6(o))return o}return!0}),ch(i=>i!==iy),ip(1)))}function d6(a){return M_(a)||a instanceof O_}function f6(a,i){return xu(o=>{let{targetSnapshot:c,currentSnapshot:u,guards:{canActivateChecks:r,canDeactivateChecks:_}}=o;return _.length===0&&r.length===0?ji(ba(jr({},o),{guardsResult:!0})):p6(_,c,u,a).pipe(xu(T=>T&&o6(T)?m6(c,r,a,i):ji(T)),Xn(T=>ba(jr({},o),{guardsResult:T})))})}function p6(a,i,o,c){return sc(a).pipe(xu(u=>x6(u.component,u.route,o,i,c)),np(u=>u!==!0,!0))}function m6(a,i,o,c){return sc(i).pipe(T0(u=>Pv(_6(u.route.parent,c),g6(u.route,c),y6(a,u.path,o),v6(a,u.route,o))),np(u=>u!==!0,!0))}function g6(a,i){return a!==null&&i&&i(new vw(a)),ji(!0)}function _6(a,i){return a!==null&&i&&i(new gw(a)),ji(!0)}function v6(a,i,o){let c=i.routeConfig?i.routeConfig.canActivate:null;if(!c||c.length===0)return ji(!0);let u=c.map(r=>D2(()=>{let _=j_(i)??o,T=O0(r,_),E=l6(T)?T.canActivate(i,a):ed(_,()=>T(i,a));return sp(E).pipe(np())}));return ji(u).pipe(L0())}function y6(a,i,o){let c=i[i.length-1],r=i.slice(0,i.length-1).reverse().map(_=>i6(_)).filter(_=>_!==null).map(_=>D2(()=>{let T=_.guards.map(E=>{let k=j_(_.node)??o,D=O0(E,k),j=c6(D)?D.canActivateChild(c,a):ed(k,()=>D(c,a));return sp(j).pipe(np())});return ji(T).pipe(L0())}));return ji(r).pipe(L0())}function x6(a,i,o,c,u){let r=i&&i.routeConfig?i.routeConfig.canDeactivate:null;if(!r||r.length===0)return ji(!0);let _=r.map(T=>{let E=j_(i)??u,k=O0(T,E),D=u6(k)?k.canDeactivate(a,i,o,c):ed(E,()=>k(a,i,o,c));return sp(D).pipe(np())});return ji(_).pipe(L0())}function b6(a,i,o,c){let u=i.canLoad;if(u===void 0||u.length===0)return ji(!0);let r=u.map(_=>{let T=O0(_,a),E=s6(T)?T.canLoad(i,o):ed(a,()=>T(i,o));return sp(E)});return ji(r).pipe(L0(),X3(c))}function X3(a){return wC(cs(i=>{if(typeof i!="boolean")throw py(a,i)}),Xn(i=>i===!0))}function w6(a,i,o,c){let u=i.canMatch;if(!u||u.length===0)return ji(!0);let r=u.map(_=>{let T=O0(_,a),E=h6(T)?T.canMatch(i,o):ed(a,()=>T(i,o));return sp(E)});return ji(r).pipe(L0(),X3(c))}var N_=class{constructor(i){this.segmentGroup=i||null}},B_=class extends Error{constructor(i){super(),this.urlTree=i}};function C0(a){return l_(new N_(a))}function T6(a){return l_(new Xa(4e3,!1))}function S6(a){return l_(W3(!1,Hc.GuardRejected))}var Aw=class{constructor(i,o){this.urlSerializer=i,this.urlTree=o}lineralizeSegments(i,o){let c=[],u=o.root;for(;;){if(c=c.concat(u.segments),u.numberOfChildren===0)return ji(c);if(u.numberOfChildren>1||!u.children[gn])return T6(`${i.redirectTo}`);u=u.children[gn]}}applyRedirectCommands(i,o,c,u,r){if(typeof o!="string"){let T=o,{queryParams:E,fragment:k,routeConfig:D,url:j,outlet:B,params:P,data:ee,title:G}=u,K=ed(r,()=>T({params:P,data:ee,queryParams:E,fragment:k,routeConfig:D,url:j,outlet:B,title:G}));if(K instanceof nf)throw new B_(K);o=K}let _=this.applyRedirectCreateUrlTree(o,this.urlSerializer.parse(o),i,c);if(o[0]==="/")throw new B_(_);return _}applyRedirectCreateUrlTree(i,o,c,u){let r=this.createSegmentGroup(i,o.root,c,u);return new nf(r,this.createQueryParams(o.queryParams,this.urlTree.queryParams),o.fragment)}createQueryParams(i,o){let c={};return Object.entries(i).forEach(([u,r])=>{if(typeof r=="string"&&r[0]===":"){let T=r.substring(1);c[u]=o[T]}else c[u]=r}),c}createSegmentGroup(i,o,c,u){let r=this.createSegments(i,o.segments,c,u),_={};return Object.entries(o.children).forEach(([T,E])=>{_[T]=this.createSegmentGroup(i,E,c,u)}),new ga(r,_)}createSegments(i,o,c,u){return o.map(r=>r.path[0]===":"?this.findPosParam(i,r,u):this.findOrReturn(r,c))}findPosParam(i,o,c){let u=c[o.path.substring(1)];if(!u)throw new Xa(4001,!1);return u}findOrReturn(i,o){let c=0;for(let u of o){if(u.path===i.path)return o.splice(c),u;c++}return i}},Cw={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function E6(a,i,o,c,u){let r=Lw(a,i,o);return r.matched?(c=XO(i,c),w6(c,i,o,u).pipe(Xn(_=>_===!0?r:jr({},Cw)))):ji(r)}function Lw(a,i,o){if(i.path==="**")return A6(o);if(i.path==="")return i.pathMatch==="full"&&(a.hasChildren()||o.length>0)?jr({},Cw):{matched:!0,consumedSegments:[],remainingSegments:o,parameters:{},positionalParamSegments:{}};let u=(i.matcher||wO)(o,a,i);if(!u)return jr({},Cw);let r={};Object.entries(u.posParams??{}).forEach(([T,E])=>{r[T]=E.path});let _=u.consumed.length>0?jr(jr({},r),u.consumed[u.consumed.length-1].parameters):r;return{matched:!0,consumedSegments:u.consumed,remainingSegments:o.slice(u.consumed.length),parameters:_,positionalParamSegments:u.posParams??{}}}function A6(a){return{matched:!0,parameters:a.length>0?I3(a).parameters:{},consumedSegments:a,remainingSegments:[],positionalParamSegments:{}}}function S3(a,i,o,c){return o.length>0&&k6(a,o,c)?{segmentGroup:new ga(i,I6(c,new ga(o,a.children))),slicedSegments:[]}:o.length===0&&M6(a,o,c)?{segmentGroup:new ga(a.segments,C6(a,o,c,a.children)),slicedSegments:o}:{segmentGroup:new ga(a.segments,a.children),slicedSegments:o}}function C6(a,i,o,c){let u={};for(let r of o)if(_y(a,i,r)&&!c[hh(r)]){let _=new ga([],{});u[hh(r)]=_}return jr(jr({},c),u)}function I6(a,i){let o={};o[gn]=i;for(let c of a)if(c.path===""&&hh(c)!==gn){let u=new ga([],{});o[hh(c)]=u}return o}function k6(a,i,o){return o.some(c=>_y(a,i,c)&&hh(c)!==gn)}function M6(a,i,o){return o.some(c=>_y(a,i,c))}function _y(a,i,o){return(a.hasChildren()||i.length>0)&&o.pathMatch==="full"?!1:o.path===""}function D6(a,i,o,c){return hh(a)!==c&&(c===gn||!_y(i,o,a))?!1:Lw(i,a,o).matched}function R6(a,i,o){return i.length===0&&!a.children[o]}var Iw=class{};function F6(a,i,o,c,u,r,_="emptyOnly"){return new kw(a,i,o,c,u,_,r).recognize()}var P6=31,kw=class{constructor(i,o,c,u,r,_,T){this.injector=i,this.configLoader=o,this.rootComponentType=c,this.config=u,this.urlTree=r,this.paramsInheritanceStrategy=_,this.urlSerializer=T,this.applyRedirects=new Aw(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(i){return new Xa(4002,`'${i.segmentGroup}'`)}recognize(){let i=S3(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(i).pipe(Xn(({children:o,rootSnapshot:c})=>{let u=new Gc(c,o),r=new fy("",u),_=UO(c,[],this.urlTree.queryParams,this.urlTree.fragment);return _.queryParams=this.urlTree.queryParams,r.url=this.urlSerializer.serialize(_),{state:r,tree:_}}))}match(i){let o=new M0([],Object.freeze({}),Object.freeze(jr({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),gn,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,i,gn,o).pipe(Xn(c=>({children:c,rootSnapshot:o})),w0(c=>{if(c instanceof B_)return this.urlTree=c.urlTree,this.match(c.urlTree.root);throw c instanceof N_?this.noMatchError(c):c}))}processSegmentGroup(i,o,c,u,r){return c.segments.length===0&&c.hasChildren()?this.processChildren(i,o,c,r):this.processSegment(i,o,c,c.segments,u,!0,r).pipe(Xn(_=>_ instanceof Gc?[_]:[]))}processChildren(i,o,c,u){let r=[];for(let _ of Object.keys(c.children))_==="primary"?r.unshift(_):r.push(_);return sc(r).pipe(T0(_=>{let T=c.children[_],E=ZO(o,_);return this.processSegmentGroup(i,E,T,_,u)}),kC((_,T)=>(_.push(...T),_)),F2(null),IC(),xu(_=>{if(_===null)return C0(c);let T=Z3(_);return L6(T),ji(T)}))}processSegment(i,o,c,u,r,_,T){return sc(o).pipe(T0(E=>this.processSegmentAgainstRoute(E._injector??i,o,E,c,u,r,_,T).pipe(w0(k=>{if(k instanceof N_)return ji(null);throw k}))),np(E=>!!E),w0(E=>{if($3(E))return R6(c,u,r)?ji(new Iw):C0(c);throw E}))}processSegmentAgainstRoute(i,o,c,u,r,_,T,E){return D6(c,u,r,_)?c.redirectTo===void 0?this.matchSegmentAgainstRoute(i,u,c,r,_,E):this.allowRedirects&&T?this.expandSegmentAgainstRouteUsingRedirect(i,u,o,c,r,_,E):C0(u):C0(u)}expandSegmentAgainstRouteUsingRedirect(i,o,c,u,r,_,T){let{matched:E,parameters:k,consumedSegments:D,positionalParamSegments:j,remainingSegments:B}=Lw(o,u,r);if(!E)return C0(o);typeof u.redirectTo=="string"&&u.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>P6&&(this.allowRedirects=!1));let P=new M0(r,k,Object.freeze(jr({},this.urlTree.queryParams)),this.urlTree.fragment,E3(u),hh(u),u.component??u._loadedComponent??null,u,A3(u)),ee=dy(P,T,this.paramsInheritanceStrategy);P.params=Object.freeze(ee.params),P.data=Object.freeze(ee.data);let G=this.applyRedirects.applyRedirectCommands(D,u.redirectTo,j,P,i);return this.applyRedirects.lineralizeSegments(u,G).pipe(xu(K=>this.processSegment(i,c,o,K.concat(B),_,!1,T)))}matchSegmentAgainstRoute(i,o,c,u,r,_){let T=E6(o,c,u,i,this.urlSerializer);return c.path==="**"&&(o.children={}),T.pipe(bu(E=>E.matched?(i=c._injector??i,this.getChildConfig(i,c,u).pipe(bu(({routes:k})=>{let D=c._loadedInjector??i,{parameters:j,consumedSegments:B,remainingSegments:P}=E,ee=new M0(B,j,Object.freeze(jr({},this.urlTree.queryParams)),this.urlTree.fragment,E3(c),hh(c),c.component??c._loadedComponent??null,c,A3(c)),G=dy(ee,_,this.paramsInheritanceStrategy);ee.params=Object.freeze(G.params),ee.data=Object.freeze(G.data);let{segmentGroup:K,slicedSegments:J}=S3(o,B,P,k);if(J.length===0&&K.hasChildren())return this.processChildren(D,k,K,ee).pipe(Xn(he=>new Gc(ee,he)));if(k.length===0&&J.length===0)return ji(new Gc(ee,[]));let ne=hh(c)===r;return this.processSegment(D,k,K,J,ne?gn:r,!0,ee).pipe(Xn(he=>new Gc(ee,he instanceof Gc?[he]:[])))}))):C0(o)))}getChildConfig(i,o,c){return o.children?ji({routes:o.children,injector:i}):o.loadChildren?o._loadedRoutes!==void 0?ji({routes:o._loadedRoutes,injector:o._loadedInjector}):b6(i,o,c,this.urlSerializer).pipe(xu(u=>u?this.configLoader.loadChildren(i,o).pipe(cs(r=>{o._loadedRoutes=r.routes,o._loadedInjector=r.injector})):S6(o))):ji({routes:[],injector:i})}};function L6(a){a.sort((i,o)=>i.value.outlet===gn?-1:o.value.outlet===gn?1:i.value.outlet.localeCompare(o.value.outlet))}function O6(a){let i=a.value.routeConfig;return i&&i.path===""}function Z3(a){let i=[],o=new Set;for(let c of a){if(!O6(c)){i.push(c);continue}let u=i.find(r=>c.value.routeConfig===r.value.routeConfig);u!==void 0?(u.children.push(...c.children),o.add(u)):i.push(c)}for(let c of o){let u=Z3(c.children);i.push(new Gc(c.value,u))}return i.filter(c=>!o.has(c))}function E3(a){return a.data||{}}function A3(a){return a.resolve||{}}function N6(a,i,o,c,u,r){return xu(_=>F6(a,i,o,c,_.extractedUrl,u,r).pipe(Xn(({state:T,tree:E})=>ba(jr({},_),{targetSnapshot:T,urlAfterRedirects:E}))))}function B6(a,i){return xu(o=>{let{targetSnapshot:c,guards:{canActivateChecks:u}}=o;if(!u.length)return ji(o);let r=new Set(u.map(E=>E.route)),_=new Set;for(let E of r)if(!_.has(E))for(let k of Y3(E))_.add(k);let T=0;return sc(_).pipe(T0(E=>r.has(E)?z6(E,c,a,i):(E.data=dy(E,E.parent,a).resolve,ji(void 0))),cs(()=>T++),L2(1),xu(E=>T===_.size?ji(o):Qh))})}function Y3(a){let i=a.children.map(o=>Y3(o)).flat();return[a,...i]}function z6(a,i,o,c){let u=a.routeConfig,r=a._resolve;return u?.title!==void 0&&!G3(u)&&(r[z_]=u.title),j6(r,a,i,c).pipe(Xn(_=>(a._resolvedData=_,a.data=dy(a,a.parent,o).resolve,null)))}function j6(a,i,o,c){let u=aw(a);if(u.length===0)return ji({});let r={};return sc(u).pipe(xu(_=>U6(a[_],i,o,c).pipe(np(),cs(T=>{if(T instanceof O_)throw py(new k_,T);r[_]=T}))),L2(1),CC(r),w0(_=>$3(_)?Qh:l_(_)))}function U6(a,i,o,c){let u=j_(i)??c,r=O0(a,u),_=r.resolve?r.resolve(i,o):ed(u,()=>r(i,o));return sp(_)}function iw(a){return bu(i=>{let o=a(i);return o?sc(o).pipe(Xn(()=>i)):ji(i)})}var K3=(()=>{let i=class i{buildTitle(c){let u,r=c.root;for(;r!==void 0;)u=this.getResolvedTitleForRoute(r)??u,r=r.children.find(_=>_.outlet===gn);return u}getResolvedTitleForRoute(c){return c.data[z_]}};i.\u0275fac=function(u){return new(u||i)},i.\u0275prov=Li({token:i,factory:()=>Jr(V6),providedIn:"root"});let a=i;return a})(),V6=(()=>{let i=class i extends K3{constructor(c){super(),this.title=c}updateTitle(c){let u=this.buildTitle(c);u!==void 0&&this.title.setTitle(u)}};i.\u0275fac=function(u){return new(u||i)(bi(v3))},i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})(),Ow=new Hi("",{providedIn:"root",factory:()=>({})}),G6=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275cmp=pa({type:i,selectors:[["ng-component"]],standalone:!0,features:[ma],decls:1,vars:0,template:function(u,r){u&1&&nn(0,"router-outlet")},dependencies:[Fw],encapsulation:2});let a=i;return a})();function Nw(a){let i=a.children&&a.children.map(Nw),o=i?ba(jr({},a),{children:i}):jr({},a);return!o.component&&!o.loadComponent&&(i||o.loadChildren)&&o.outlet&&o.outlet!==gn&&(o.component=G6),o}var Bw=new Hi(""),H6=(()=>{let i=class i{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Jr(U2)}loadComponent(c){if(this.componentLoaders.get(c))return this.componentLoaders.get(c);if(c._loadedComponent)return ji(c._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(c);let u=sp(c.loadComponent()).pipe(Xn(J3),cs(_=>{this.onLoadEndListener&&this.onLoadEndListener(c),c._loadedComponent=_}),u_(()=>{this.componentLoaders.delete(c)})),r=new s_(u,()=>new Ra).pipe(M2());return this.componentLoaders.set(c,r),r}loadChildren(c,u){if(this.childrenLoaders.get(u))return this.childrenLoaders.get(u);if(u._loadedRoutes)return ji({routes:u._loadedRoutes,injector:u._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(u);let _=W6(u,this.compiler,c,this.onLoadEndListener).pipe(u_(()=>{this.childrenLoaders.delete(u)})),T=new s_(_,()=>new Ra).pipe(M2());return this.childrenLoaders.set(u,T),T}};i.\u0275fac=function(u){return new(u||i)},i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();function W6(a,i,o,c){return sp(a.loadChildren()).pipe(Xn(J3),xu(u=>u instanceof NC||Array.isArray(u)?ji(u):sc(i.compileModuleAsync(u))),Xn(u=>{c&&c(a);let r,_,T=!1;return Array.isArray(u)?(_=u,T=!0):(r=u.create(o).injector,_=r.get(Bw,[],{optional:!0,self:!0}).flat()),{routes:_.map(Nw),injector:r}}))}function q6(a){return a&&typeof a=="object"&&"default"in a}function J3(a){return q6(a)?a.default:a}var zw=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275prov=Li({token:i,factory:()=>Jr($6),providedIn:"root"});let a=i;return a})(),$6=(()=>{let i=class i{shouldProcessUrl(c){return!0}extract(c){return c}merge(c,u){return c}};i.\u0275fac=function(u){return new(u||i)},i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})(),X6=new Hi("");var Z6=new Hi(""),Y6=(()=>{let i=class i{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Ra,this.transitionAbortSubject=new Ra,this.configLoader=Jr(H6),this.environmentInjector=Jr(Ov),this.urlSerializer=Jr(Dw),this.rootContexts=Jr(gy),this.location=Jr(Zv),this.inputBindingEnabled=Jr(Pw,{optional:!0})!==null,this.titleStrategy=Jr(K3),this.options=Jr(Ow,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=Jr(zw),this.createViewTransition=Jr(X6,{optional:!0}),this.navigationErrorHandler=Jr(Z6,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>ji(void 0),this.rootComponentType=null;let c=r=>this.events.next(new pw(r)),u=r=>this.events.next(new mw(r));this.configLoader.onLoadEndListener=u,this.configLoader.onLoadStartListener=c}complete(){this.transitions?.complete()}handleNavigationRequest(c){let u=++this.navigationId;this.transitions?.next(ba(jr(jr({},this.transitions.value),c),{id:u}))}setupNavigations(c,u,r){return this.transitions=new ml({id:0,currentUrlTree:u,currentRawUrl:u,extractedUrl:this.urlHandlingStrategy.extract(u),urlAfterRedirects:this.urlHandlingStrategy.extract(u),rawUrl:u,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:C_,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(ch(_=>_.id!==0),Xn(_=>ba(jr({},_),{extractedUrl:this.urlHandlingStrategy.extract(_.rawUrl)})),bu(_=>{let T=!1,E=!1;return ji(_).pipe(bu(k=>{if(this.navigationId>_.id)return this.cancelNavigationTransition(_,"",Hc.SupersededByNewNavigation),Qh;this.currentTransition=_,this.currentNavigation={id:k.id,initialUrl:k.rawUrl,extractedUrl:k.extractedUrl,targetBrowserUrl:typeof k.extras.browserUrl=="string"?this.urlSerializer.parse(k.extras.browserUrl):k.extras.browserUrl,trigger:k.source,extras:k.extras,previousNavigation:this.lastSuccessfulNavigation?ba(jr({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let D=!c.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),j=k.extras.onSameUrlNavigation??c.onSameUrlNavigation;if(!D&&j!=="reload"){let B="";return this.events.next(new hm(k.id,this.urlSerializer.serialize(k.rawUrl),B,cw.IgnoredSameUrlNavigation)),k.resolve(!1),Qh}if(this.urlHandlingStrategy.shouldProcessUrl(k.rawUrl))return ji(k).pipe(bu(B=>{let P=this.transitions?.getValue();return this.events.next(new R_(B.id,this.urlSerializer.serialize(B.extractedUrl),B.source,B.restoredState)),P!==this.transitions?.getValue()?Qh:Promise.resolve(B)}),N6(this.environmentInjector,this.configLoader,this.rootComponentType,c.config,this.urlSerializer,this.paramsInheritanceStrategy),cs(B=>{_.targetSnapshot=B.targetSnapshot,_.urlAfterRedirects=B.urlAfterRedirects,this.currentNavigation=ba(jr({},this.currentNavigation),{finalUrl:B.urlAfterRedirects});let P=new cy(B.id,this.urlSerializer.serialize(B.extractedUrl),this.urlSerializer.serialize(B.urlAfterRedirects),B.targetSnapshot);this.events.next(P)}));if(D&&this.urlHandlingStrategy.shouldProcessUrl(k.currentRawUrl)){let{id:B,extractedUrl:P,source:ee,restoredState:G,extras:K}=k,J=new R_(B,this.urlSerializer.serialize(P),ee,G);this.events.next(J);let ne=U3(this.rootComponentType).snapshot;return this.currentTransition=_=ba(jr({},k),{targetSnapshot:ne,urlAfterRedirects:P,extras:ba(jr({},K),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=P,ji(_)}else{let B="";return this.events.next(new hm(k.id,this.urlSerializer.serialize(k.extractedUrl),B,cw.IgnoredByUrlHandlingStrategy)),k.resolve(!1),Qh}}),cs(k=>{let D=new uw(k.id,this.urlSerializer.serialize(k.extractedUrl),this.urlSerializer.serialize(k.urlAfterRedirects),k.targetSnapshot);this.events.next(D)}),Xn(k=>(this.currentTransition=_=ba(jr({},k),{guards:r6(k.targetSnapshot,k.currentSnapshot,this.rootContexts)}),_)),f6(this.environmentInjector,k=>this.events.next(k)),cs(k=>{if(_.guardsResult=k.guardsResult,k.guardsResult&&typeof k.guardsResult!="boolean")throw py(this.urlSerializer,k.guardsResult);let D=new hw(k.id,this.urlSerializer.serialize(k.extractedUrl),this.urlSerializer.serialize(k.urlAfterRedirects),k.targetSnapshot,!!k.guardsResult);this.events.next(D)}),ch(k=>k.guardsResult?!0:(this.cancelNavigationTransition(k,"",Hc.GuardRejected),!1)),iw(k=>{if(k.guards.canActivateChecks.length)return ji(k).pipe(cs(D=>{let j=new dw(D.id,this.urlSerializer.serialize(D.extractedUrl),this.urlSerializer.serialize(D.urlAfterRedirects),D.targetSnapshot);this.events.next(j)}),bu(D=>{let j=!1;return ji(D).pipe(B6(this.paramsInheritanceStrategy,this.environmentInjector),cs({next:()=>j=!0,complete:()=>{j||this.cancelNavigationTransition(D,"",Hc.NoDataFromResolver)}}))}),cs(D=>{let j=new fw(D.id,this.urlSerializer.serialize(D.extractedUrl),this.urlSerializer.serialize(D.urlAfterRedirects),D.targetSnapshot);this.events.next(j)}))}),iw(k=>{let D=j=>{let B=[];j.routeConfig?.loadComponent&&!j.routeConfig._loadedComponent&&B.push(this.configLoader.loadComponent(j.routeConfig).pipe(cs(P=>{j.component=P}),Xn(()=>{})));for(let P of j.children)B.push(...D(P));return B};return c_(D(k.targetSnapshot.root)).pipe(F2(null),ip(1))}),iw(()=>this.afterPreactivation()),bu(()=>{let{currentSnapshot:k,targetSnapshot:D}=_,j=this.createViewTransition?.(this.environmentInjector,k.root,D.root);return j?sc(j).pipe(Xn(()=>_)):ji(_)}),Xn(k=>{let D=KO(c.routeReuseStrategy,k.targetSnapshot,k.currentRouterState);return this.currentTransition=_=ba(jr({},k),{targetRouterState:D}),this.currentNavigation.targetRouterState=D,_}),cs(()=>{this.events.next(new P_)}),t6(this.rootContexts,c.routeReuseStrategy,k=>this.events.next(k),this.inputBindingEnabled),ip(1),cs({next:k=>{T=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new um(k.id,this.urlSerializer.serialize(k.extractedUrl),this.urlSerializer.serialize(k.urlAfterRedirects))),this.titleStrategy?.updateTitle(k.targetRouterState.snapshot),k.resolve(!0)},complete:()=>{T=!0}}),gl(this.transitionAbortSubject.pipe(cs(k=>{throw k}))),u_(()=>{!T&&!E&&this.cancelNavigationTransition(_,"",Hc.SupersededByNewNavigation),this.currentTransition?.id===_.id&&(this.currentNavigation=null,this.currentTransition=null)}),w0(k=>{if(E=!0,q3(k))this.events.next(new rf(_.id,this.urlSerializer.serialize(_.extractedUrl),k.message,k.cancellationCode)),e6(k)?this.events.next(new F0(k.url,k.navigationBehaviorOptions)):_.resolve(!1);else{let D=new F_(_.id,this.urlSerializer.serialize(_.extractedUrl),k,_.targetSnapshot??void 0);try{let j=ed(this.environmentInjector,()=>this.navigationErrorHandler?.(D));if(j instanceof O_){let{message:B,cancellationCode:P}=py(this.urlSerializer,j);this.events.next(new rf(_.id,this.urlSerializer.serialize(_.extractedUrl),B,P)),this.events.next(new F0(j.redirectTo,j.navigationBehaviorOptions))}else{this.events.next(D);let B=c.errorHandler(k);_.resolve(!!B)}}catch(j){this.options.resolveNavigationPromiseOnError?_.resolve(!1):_.reject(j)}}return Qh}))}))}cancelNavigationTransition(c,u,r){let _=new rf(c.id,this.urlSerializer.serialize(c.extractedUrl),u,r);this.events.next(_),c.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let c=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),u=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return c.toString()!==u?.toString()&&!this.currentNavigation?.extras.skipLocationChange}};i.\u0275fac=function(u){return new(u||i)},i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();function K6(a){return a!==C_}var J6=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275prov=Li({token:i,factory:()=>Jr(Q6),providedIn:"root"});let a=i;return a})(),Mw=class{shouldDetach(i){return!1}store(i,o){}shouldAttach(i){return!1}retrieve(i){return null}shouldReuseRoute(i,o){return i.routeConfig===o.routeConfig}},Q6=(()=>{let i=class i extends Mw{};i.\u0275fac=(()=>{let c;return function(r){return(c||(c=us(i)))(r||i)}})(),i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})(),Q3=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275prov=Li({token:i,factory:()=>Jr(eN),providedIn:"root"});let a=i;return a})(),eN=(()=>{let i=class i extends Q3{constructor(){super(...arguments),this.location=Jr(Zv),this.urlSerializer=Jr(Dw),this.options=Jr(Ow,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=Jr(zw),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new nf,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=U3(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(c){return this.location.subscribe(u=>{u.type==="popstate"&&c(u.url,u.state)})}handleRouterEvent(c,u){if(c instanceof R_)this.stateMemento=this.createStateMemento();else if(c instanceof hm)this.rawUrlTree=u.initialUrl;else if(c instanceof cy){if(this.urlUpdateStrategy==="eager"&&!u.extras.skipLocationChange){let r=this.urlHandlingStrategy.merge(u.finalUrl,u.initialUrl);this.setBrowserUrl(u.targetBrowserUrl??r,u)}}else c instanceof P_?(this.currentUrlTree=u.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(u.finalUrl,u.initialUrl),this.routerState=u.targetRouterState,this.urlUpdateStrategy==="deferred"&&!u.extras.skipLocationChange&&this.setBrowserUrl(u.targetBrowserUrl??this.rawUrlTree,u)):c instanceof rf&&(c.code===Hc.GuardRejected||c.code===Hc.NoDataFromResolver)?this.restoreHistory(u):c instanceof F_?this.restoreHistory(u,!0):c instanceof um&&(this.lastSuccessfulId=c.id,this.currentPageId=this.browserPageId)}setBrowserUrl(c,u){let r=c instanceof nf?this.urlSerializer.serialize(c):c;if(this.location.isCurrentPathEqualTo(r)||u.extras.replaceUrl){let _=this.browserPageId,T=jr(jr({},u.extras.state),this.generateNgRouterState(u.id,_));this.location.replaceState(r,"",T)}else{let _=jr(jr({},u.extras.state),this.generateNgRouterState(u.id,this.browserPageId+1));this.location.go(r,"",_)}}restoreHistory(c,u=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,_=this.currentPageId-r;_!==0?this.location.historyGo(_):this.currentUrlTree===c.finalUrl&&_===0&&(this.resetState(c),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(u&&this.resetState(c),this.resetUrlToCurrentUrlTree())}resetState(c){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,c.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(c,u){return this.canceledNavigationResolution==="computed"?{navigationId:c,\u0275routerPageId:u}:{navigationId:c}}};i.\u0275fac=(()=>{let c;return function(r){return(c||(c=us(i)))(r||i)}})(),i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})(),E_=function(a){return a[a.COMPLETE=0]="COMPLETE",a[a.FAILED=1]="FAILED",a[a.REDIRECTING=2]="REDIRECTING",a}(E_||{});function tN(a,i){a.events.pipe(ch(o=>o instanceof um||o instanceof rf||o instanceof F_||o instanceof hm),Xn(o=>o instanceof um||o instanceof hm?E_.COMPLETE:(o instanceof rf?o.code===Hc.Redirect||o.code===Hc.SupersededByNewNavigation:!1)?E_.REDIRECTING:E_.FAILED),ch(o=>o!==E_.REDIRECTING),ip(1)).subscribe(()=>{i()})}function rN(a){throw a}var iN={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},nN={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},eI=(()=>{let i=class i{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=Jr(qv),this.stateManager=Jr(Q3),this.options=Jr(Ow,{optional:!0})||{},this.pendingTasks=Jr(B2),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=Jr(Y6),this.urlSerializer=Jr(Dw),this.location=Jr(Zv),this.urlHandlingStrategy=Jr(zw),this._events=new Ra,this.errorHandler=this.options.errorHandler||rN,this.navigated=!1,this.routeReuseStrategy=Jr(J6),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=Jr(Bw,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!Jr(Pw,{optional:!0}),this.eventsSubscription=new y0,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:c=>{this.console.warn(c)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let c=this.navigationTransitions.events.subscribe(u=>{try{let r=this.navigationTransitions.currentTransition,_=this.navigationTransitions.currentNavigation;if(r!==null&&_!==null){if(this.stateManager.handleRouterEvent(u,_),u instanceof rf&&u.code!==Hc.Redirect&&u.code!==Hc.SupersededByNewNavigation)this.navigated=!0;else if(u instanceof um)this.navigated=!0;else if(u instanceof F0){let T=u.navigationBehaviorOptions,E=this.urlHandlingStrategy.merge(u.url,r.currentRawUrl),k=jr({browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||K6(r.source)},T);this.scheduleNavigation(E,C_,null,k,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}oN(u)&&this._events.next(u)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(c)}resetRootComponentType(c){this.routerState.root.component=c,this.navigationTransitions.rootComponentType=c}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),C_,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((c,u)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(c,"popstate",u)},0)})}navigateToSyncWithBrowser(c,u,r){let _={replaceUrl:!0},T=r?.navigationId?r:null;if(r){let k=jr({},r);delete k.navigationId,delete k.\u0275routerPageId,Object.keys(k).length!==0&&(_.state=k)}let E=this.parseUrl(c);this.scheduleNavigation(E,u,T,_)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(c){this.config=c.map(Nw),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(c,u={}){let{relativeTo:r,queryParams:_,fragment:T,queryParamsHandling:E,preserveFragment:k}=u,D=k?this.currentUrlTree.fragment:T,j=null;switch(E){case"merge":j=jr(jr({},this.currentUrlTree.queryParams),_);break;case"preserve":j=this.currentUrlTree.queryParams;break;default:j=_||null}j!==null&&(j=this.removeEmptyProps(j));let B;try{let P=r?r.snapshot:this.routerState.snapshot.root;B=N3(P)}catch{(typeof c[0]!="string"||c[0][0]!=="/")&&(c=[]),B=this.currentUrlTree.root}return B3(B,c,j,D??null)}navigateByUrl(c,u={skipLocationChange:!1}){let r=M_(c)?c:this.parseUrl(c),_=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(_,C_,null,u)}navigate(c,u={skipLocationChange:!1}){return aN(c),this.navigateByUrl(this.createUrlTree(c,u),u)}serializeUrl(c){return this.urlSerializer.serialize(c)}parseUrl(c){try{return this.urlSerializer.parse(c)}catch{return this.urlSerializer.parse("/")}}isActive(c,u){let r;if(u===!0?r=jr({},iN):u===!1?r=jr({},nN):r=u,M_(c))return x3(this.currentUrlTree,c,r);let _=this.parseUrl(c);return x3(this.currentUrlTree,_,r)}removeEmptyProps(c){return Object.entries(c).reduce((u,[r,_])=>(_!=null&&(u[r]=_),u),{})}scheduleNavigation(c,u,r,_,T){if(this.disposed)return Promise.resolve(!1);let E,k,D;T?(E=T.resolve,k=T.reject,D=T.promise):D=new Promise((B,P)=>{E=B,k=P});let j=this.pendingTasks.add();return tN(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(j))}),this.navigationTransitions.handleNavigationRequest({source:u,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:c,extras:_,resolve:E,reject:k,promise:D,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),D.catch(B=>Promise.reject(B))}};i.\u0275fac=function(u){return new(u||i)},i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();function aN(a){for(let i=0;i<a.length;i++)if(a[i]==null)throw new Xa(4008,!1)}function oN(a){return!(a instanceof P_)&&!(a instanceof F0)}var sN=new Hi("");function tI(a,...i){return om([{provide:Bw,multi:!0,useValue:a},[],{provide:P0,useFactory:lN,deps:[eI]},{provide:Xv,multi:!0,useFactory:cN},i.map(o=>o.\u0275providers)])}function lN(a){return a.routerState.root}function cN(){let a=Jr(op);return i=>{let o=a.get(__);if(i!==o.components[0])return;let c=a.get(eI),u=a.get(uN);a.get(hN)===1&&c.initialNavigation(),a.get(dN,null,N2.Optional)?.setUpPreloading(),a.get(sN,null,N2.Optional)?.init(),c.resetRootComponentType(o.componentTypes[0]),u.closed||(u.next(),u.complete(),u.unsubscribe())}}var uN=new Hi("",{factory:()=>new Ra}),hN=new Hi("",{providedIn:"root",factory:()=>1});var dN=new Hi("");var Uw;try{Uw=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Uw=!1}var no=(()=>{let i=class i{constructor(c){this._platformId=c,this.isBrowser=this._platformId?YC(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||Uw)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}};i.\u0275fac=function(u){return new(u||i)(bi(Xd))},i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();var N0,rI=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function Vw(){if(N0)return N0;if(typeof document!="object"||!document)return N0=new Set(rI),N0;let a=document.createElement("input");return N0=new Set(rI.filter(i=>(a.setAttribute("type",i),a.type===i))),N0}var V_;function fN(){if(V_==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>V_=!0}))}finally{V_=V_||!1}return V_}function lp(a){return fN()?a:!!a.capture}var jw;function pN(){if(jw==null){let a=typeof document<"u"?document.head:null;jw=!!(a&&(a.createShadowRoot||a.attachShadow))}return jw}function iI(a){if(pN()){let i=a.getRootNode?a.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&i instanceof ShadowRoot)return i}return null}function af(a){return a.composedPath?a.composedPath()[0]:a.target}function nI(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function dm(a){return a!=null&&`${a}`!="false"}function Gw(a){return Array.isArray(a)?a:[a]}function od(a){return a instanceof Ln?a.nativeElement:a}var mN=(()=>{let i=class i{create(c){return typeof MutationObserver>"u"?null:new MutationObserver(c)}};i.\u0275fac=function(u){return new(u||i)},i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();var aI=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275mod=Vn({type:i}),i.\u0275inj=Un({providers:[mN]});let a=i;return a})();var oI=new Set,fm,gN=(()=>{let i=class i{constructor(c,u){this._platform=c,this._nonce=u,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):vN}matchMedia(c){return(this._platform.WEBKIT||this._platform.BLINK)&&_N(c,this._nonce),this._matchMedia(c)}};i.\u0275fac=function(u){return new(u||i)(bi(no),bi(f_,8))},i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();function _N(a,i){if(!oI.has(a))try{fm||(fm=document.createElement("style"),i&&fm.setAttribute("nonce",i),fm.setAttribute("type","text/css"),document.head.appendChild(fm)),fm.sheet&&(fm.sheet.insertRule(`@media ${a} {body{ }}`,0),oI.add(a))}catch(o){console.error(o)}}function vN(a){return{matches:a==="all"||a==="",media:a,addListener:()=>{},removeListener:()=>{}}}var lI=(()=>{let i=class i{constructor(c,u){this._mediaMatcher=c,this._zone=u,this._queries=new Map,this._destroySubject=new Ra}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(c){return sI(Gw(c)).some(r=>this._registerQuery(r).mql.matches)}observe(c){let r=sI(Gw(c)).map(T=>this._registerQuery(T).observable),_=c_(r);return _=Pv(_.pipe(ip(1)),_.pipe(Lv(1),R2(0))),_.pipe(Xn(T=>{let E={matches:!1,breakpoints:{}};return T.forEach(({matches:k,query:D})=>{E.matches=E.matches||k,E.breakpoints[D]=k}),E}))}_registerQuery(c){if(this._queries.has(c))return this._queries.get(c);let u=this._mediaMatcher.matchMedia(c),_={observable:new x0(T=>{let E=k=>this._zone.run(()=>T.next(k));return u.addListener(E),()=>{u.removeListener(E)}}).pipe(h_(u),Xn(({matches:T})=>({query:c,matches:T})),gl(this._destroySubject)),mql:u};return this._queries.set(c,_),_}};i.\u0275fac=function(u){return new(u||i)(bi(gN),bi(Tn))},i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();function sI(a){return a.map(i=>i.split(",")).reduce((i,o)=>i.concat(o)).map(i=>i.trim())}function Ww(a){return a.buttons===0||a.detail===0}function qw(a){let i=a.touches&&a.touches[0]||a.changedTouches&&a.changedTouches[0];return!!i&&i.identifier===-1&&(i.radiusX==null||i.radiusX===1)&&(i.radiusY==null||i.radiusY===1)}var yN=new Hi("cdk-input-modality-detector-options"),xN={ignoreKeys:[18,17,224,91,16]},hI=650,B0=lp({passive:!0,capture:!0}),bN=(()=>{let i=class i{get mostRecentModality(){return this._modality.value}constructor(c,u,r,_){this._platform=c,this._mostRecentTarget=null,this._modality=new ml(null),this._lastTouchMs=0,this._onKeydown=T=>{this._options?.ignoreKeys?.some(E=>E===T.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=af(T))},this._onMousedown=T=>{Date.now()-this._lastTouchMs<hI||(this._modality.next(Ww(T)?"keyboard":"mouse"),this._mostRecentTarget=af(T))},this._onTouchstart=T=>{if(qw(T)){this._modality.next("keyboard");return}this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=af(T)},this._options=jr(jr({},xN),_),this.modalityDetected=this._modality.pipe(Lv(1)),this.modalityChanged=this.modalityDetected.pipe(P2()),c.isBrowser&&u.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,B0),r.addEventListener("mousedown",this._onMousedown,B0),r.addEventListener("touchstart",this._onTouchstart,B0)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,B0),document.removeEventListener("mousedown",this._onMousedown,B0),document.removeEventListener("touchstart",this._onTouchstart,B0))}};i.\u0275fac=function(u){return new(u||i)(bi(no),bi(Tn),bi(aa),bi(yN,8))},i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();var yy=function(a){return a[a.IMMEDIATE=0]="IMMEDIATE",a[a.EVENTUAL=1]="EVENTUAL",a}(yy||{}),wN=new Hi("cdk-focus-monitor-default-options"),vy=lp({passive:!0,capture:!0}),dI=(()=>{let i=class i{constructor(c,u,r,_,T){this._ngZone=c,this._platform=u,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Ra,this._rootNodeFocusAndBlurListener=E=>{let k=af(E);for(let D=k;D;D=D.parentElement)E.type==="focus"?this._onFocus(E,D):this._onBlur(E,D)},this._document=_,this._detectionMode=T?.detectionMode||yy.IMMEDIATE}monitor(c,u=!1){let r=od(c);if(!this._platform.isBrowser||r.nodeType!==1)return ji();let _=iI(r)||this._getDocument(),T=this._elementInfo.get(r);if(T)return u&&(T.checkChildren=!0),T.subject;let E={checkChildren:u,subject:new Ra,rootNode:_};return this._elementInfo.set(r,E),this._registerGlobalListeners(E),E.subject}stopMonitoring(c){let u=od(c),r=this._elementInfo.get(u);r&&(r.subject.complete(),this._setClasses(u),this._elementInfo.delete(u),this._removeGlobalListeners(r))}focusVia(c,u,r){let _=od(c),T=this._getDocument().activeElement;_===T?this._getClosestElementsInfo(_).forEach(([E,k])=>this._originChanged(E,u,k)):(this._setOrigin(u),typeof _.focus=="function"&&_.focus(r))}ngOnDestroy(){this._elementInfo.forEach((c,u)=>this.stopMonitoring(u))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(c){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(c)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:c&&this._isLastInteractionFromInputLabel(c)?"mouse":"program"}_shouldBeAttributedToTouch(c){return this._detectionMode===yy.EVENTUAL||!!c?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(c,u){c.classList.toggle("cdk-focused",!!u),c.classList.toggle("cdk-touch-focused",u==="touch"),c.classList.toggle("cdk-keyboard-focused",u==="keyboard"),c.classList.toggle("cdk-mouse-focused",u==="mouse"),c.classList.toggle("cdk-program-focused",u==="program")}_setOrigin(c,u=!1){this._ngZone.runOutsideAngular(()=>{if(this._origin=c,this._originFromTouchInteraction=c==="touch"&&u,this._detectionMode===yy.IMMEDIATE){clearTimeout(this._originTimeoutId);let r=this._originFromTouchInteraction?hI:1;this._originTimeoutId=setTimeout(()=>this._origin=null,r)}})}_onFocus(c,u){let r=this._elementInfo.get(u),_=af(c);!r||!r.checkChildren&&u!==_||this._originChanged(u,this._getFocusOrigin(_),r)}_onBlur(c,u){let r=this._elementInfo.get(u);!r||r.checkChildren&&c.relatedTarget instanceof Node&&u.contains(c.relatedTarget)||(this._setClasses(u),this._emitOrigin(r,null))}_emitOrigin(c,u){c.subject.observers.length&&this._ngZone.run(()=>c.subject.next(u))}_registerGlobalListeners(c){if(!this._platform.isBrowser)return;let u=c.rootNode,r=this._rootNodeFocusListenerCount.get(u)||0;r||this._ngZone.runOutsideAngular(()=>{u.addEventListener("focus",this._rootNodeFocusAndBlurListener,vy),u.addEventListener("blur",this._rootNodeFocusAndBlurListener,vy)}),this._rootNodeFocusListenerCount.set(u,r+1),++this._monitoredElementCount===1&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(gl(this._stopInputModalityDetector)).subscribe(_=>{this._setOrigin(_,!0)}))}_removeGlobalListeners(c){let u=c.rootNode;if(this._rootNodeFocusListenerCount.has(u)){let r=this._rootNodeFocusListenerCount.get(u);r>1?this._rootNodeFocusListenerCount.set(u,r-1):(u.removeEventListener("focus",this._rootNodeFocusAndBlurListener,vy),u.removeEventListener("blur",this._rootNodeFocusAndBlurListener,vy),this._rootNodeFocusListenerCount.delete(u))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(c,u,r){this._setClasses(c,u),this._emitOrigin(r,u),this._lastFocusOrigin=u}_getClosestElementsInfo(c){let u=[];return this._elementInfo.forEach((r,_)=>{(_===c||r.checkChildren&&_.contains(c))&&u.push([_,r])}),u}_isLastInteractionFromInputLabel(c){let{_mostRecentTarget:u,mostRecentModality:r}=this._inputModalityDetector;if(r!=="mouse"||!u||u===c||c.nodeName!=="INPUT"&&c.nodeName!=="TEXTAREA"||c.disabled)return!1;let _=c.labels;if(_){for(let T=0;T<_.length;T++)if(_[T].contains(u))return!0}return!1}};i.\u0275fac=function(u){return new(u||i)(bi(Tn),bi(no),bi(bN),bi(aa,8),bi(wN,8))},i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();var pm=function(a){return a[a.NONE=0]="NONE",a[a.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",a[a.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",a}(pm||{}),cI="cdk-high-contrast-black-on-white",uI="cdk-high-contrast-white-on-black",Hw="cdk-high-contrast-active",fI=(()=>{let i=class i{constructor(c,u){this._platform=c,this._document=u,this._breakpointSubscription=Jr(lI).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return pm.NONE;let c=this._document.createElement("div");c.style.backgroundColor="rgb(1,2,3)",c.style.position="absolute",this._document.body.appendChild(c);let u=this._document.defaultView||window,r=u&&u.getComputedStyle?u.getComputedStyle(c):null,_=(r&&r.backgroundColor||"").replace(/ /g,"");switch(c.remove(),_){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return pm.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return pm.BLACK_ON_WHITE}return pm.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let c=this._document.body.classList;c.remove(Hw,cI,uI),this._hasCheckedHighContrastMode=!0;let u=this.getHighContrastMode();u===pm.BLACK_ON_WHITE?c.add(Hw,cI):u===pm.WHITE_ON_BLACK&&c.add(Hw,uI)}}};i.\u0275fac=function(u){return new(u||i)(bi(no),bi(aa))},i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();var SN=new Hi("cdk-dir-doc",{providedIn:"root",factory:EN});function EN(){return Jr(aa)}var AN=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function CN(a){let i=a?.toLowerCase()||"";return i==="auto"&&typeof navigator<"u"&&navigator?.language?AN.test(navigator.language)?"rtl":"ltr":i==="rtl"?"rtl":"ltr"}var xy=(()=>{let i=class i{constructor(c){if(this.value="ltr",this.change=new $s,c){let u=c.body?c.body.dir:null,r=c.documentElement?c.documentElement.dir:null;this.value=CN(u||r||"ltr")}}ngOnDestroy(){this.change.complete()}};i.\u0275fac=function(u){return new(u||i)(bi(SN,8))},i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();var z0=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275mod=Vn({type:i}),i.\u0275inj=Un({});let a=i;return a})();function kN(){return!0}var MN=new Hi("mat-sanity-checks",{providedIn:"root",factory:kN}),Jo=(()=>{let i=class i{constructor(c,u,r){this._sanityChecks=u,this._document=r,this._hasDoneGlobalChecks=!1,c._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(c){return nI()?!1:typeof this._sanityChecks=="boolean"?this._sanityChecks:!!this._sanityChecks[c]}};i.\u0275fac=function(u){return new(u||i)(bi(fI),bi(MN,8),bi(aa))},i.\u0275mod=Vn({type:i}),i.\u0275inj=Un({imports:[z0,z0]});let a=i;return a})();var wy=class{constructor(i,o,c,u,r){this._defaultMatcher=i,this.ngControl=o,this._parentFormGroup=c,this._parentForm=u,this._stateChanges=r,this.errorState=!1}updateErrorState(){let i=this.errorState,o=this._parentFormGroup||this._parentForm,c=this.matcher||this._defaultMatcher,u=this.ngControl?this.ngControl.control:null,r=c?.isErrorState(u,o)??!1;r!==i&&(this.errorState=r,this._stateChanges.next())}};var TI=(()=>{let i=class i{isErrorState(c,u){return!!(c&&c.invalid&&(c.touched||u&&u.submitted))}};i.\u0275fac=function(u){return new(u||i)},i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();var Tu=function(a){return a[a.FADING_IN=0]="FADING_IN",a[a.VISIBLE=1]="VISIBLE",a[a.FADING_OUT=2]="FADING_OUT",a[a.HIDDEN=3]="HIDDEN",a}(Tu||{}),Zw=class{constructor(i,o,c,u=!1){this._renderer=i,this.element=o,this.config=c,this._animationForciblyDisabledThroughCss=u,this.state=Tu.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}},mI=lp({passive:!0,capture:!0}),Yw=class{constructor(){this._events=new Map,this._delegateEventHandler=i=>{let o=af(i);o&&this._events.get(i.type)?.forEach((c,u)=>{(u===o||u.contains(o))&&c.forEach(r=>r.handleEvent(i))})}}addHandler(i,o,c,u){let r=this._events.get(o);if(r){let _=r.get(c);_?_.add(u):r.set(c,new Set([u]))}else this._events.set(o,new Map([[c,new Set([u])]])),i.runOutsideAngular(()=>{document.addEventListener(o,this._delegateEventHandler,mI)})}removeHandler(i,o,c){let u=this._events.get(i);if(!u)return;let r=u.get(o);r&&(r.delete(c),r.size===0&&u.delete(o),u.size===0&&(this._events.delete(i),document.removeEventListener(i,this._delegateEventHandler,mI)))}},gI={enterDuration:225,exitDuration:150},DN=800,_I=lp({passive:!0,capture:!0}),vI=["mousedown","touchstart"],yI=["mouseup","mouseleave","touchend","touchcancel"],G_=class G_{constructor(i,o,c,u){this._target=i,this._ngZone=o,this._platform=u,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,u.isBrowser&&(this._containerElement=od(c))}fadeInRipple(i,o,c={}){let u=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),r=jr(jr({},gI),c.animation);c.centered&&(i=u.left+u.width/2,o=u.top+u.height/2);let _=c.radius||RN(i,o,u),T=i-u.left,E=o-u.top,k=r.enterDuration,D=document.createElement("div");D.classList.add("mat-ripple-element"),D.style.left=`${T-_}px`,D.style.top=`${E-_}px`,D.style.height=`${_*2}px`,D.style.width=`${_*2}px`,c.color!=null&&(D.style.backgroundColor=c.color),D.style.transitionDuration=`${k}ms`,this._containerElement.appendChild(D);let j=window.getComputedStyle(D),B=j.transitionProperty,P=j.transitionDuration,ee=B==="none"||P==="0s"||P==="0s, 0s"||u.width===0&&u.height===0,G=new Zw(this,D,c,ee);D.style.transform="scale3d(1, 1, 1)",G.state=Tu.FADING_IN,c.persistent||(this._mostRecentTransientRipple=G);let K=null;return!ee&&(k||r.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let J=()=>{K&&(K.fallbackTimer=null),clearTimeout(he),this._finishRippleTransition(G)},ne=()=>this._destroyRipple(G),he=setTimeout(ne,k+100);D.addEventListener("transitionend",J),D.addEventListener("transitioncancel",ne),K={onTransitionEnd:J,onTransitionCancel:ne,fallbackTimer:he}}),this._activeRipples.set(G,K),(ee||!k)&&this._finishRippleTransition(G),G}fadeOutRipple(i){if(i.state===Tu.FADING_OUT||i.state===Tu.HIDDEN)return;let o=i.element,c=jr(jr({},gI),i.config.animation);o.style.transitionDuration=`${c.exitDuration}ms`,o.style.opacity="0",i.state=Tu.FADING_OUT,(i._animationForciblyDisabledThroughCss||!c.exitDuration)&&this._finishRippleTransition(i)}fadeOutAll(){this._getActiveRipples().forEach(i=>i.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(i=>{i.config.persistent||i.fadeOut()})}setupTriggerEvents(i){let o=od(i);!this._platform.isBrowser||!o||o===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=o,vI.forEach(c=>{G_._eventManager.addHandler(this._ngZone,c,o,this)}))}handleEvent(i){i.type==="mousedown"?this._onMousedown(i):i.type==="touchstart"?this._onTouchStart(i):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{yI.forEach(o=>{this._triggerElement.addEventListener(o,this,_I)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(i){i.state===Tu.FADING_IN?this._startFadeOutTransition(i):i.state===Tu.FADING_OUT&&this._destroyRipple(i)}_startFadeOutTransition(i){let o=i===this._mostRecentTransientRipple,{persistent:c}=i.config;i.state=Tu.VISIBLE,!c&&(!o||!this._isPointerDown)&&i.fadeOut()}_destroyRipple(i){let o=this._activeRipples.get(i)??null;this._activeRipples.delete(i),this._activeRipples.size||(this._containerRect=null),i===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),i.state=Tu.HIDDEN,o!==null&&(i.element.removeEventListener("transitionend",o.onTransitionEnd),i.element.removeEventListener("transitioncancel",o.onTransitionCancel),o.fallbackTimer!==null&&clearTimeout(o.fallbackTimer)),i.element.remove()}_onMousedown(i){let o=Ww(i),c=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+DN;!this._target.rippleDisabled&&!o&&!c&&(this._isPointerDown=!0,this.fadeInRipple(i.clientX,i.clientY,this._target.rippleConfig))}_onTouchStart(i){if(!this._target.rippleDisabled&&!qw(i)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let o=i.changedTouches;if(o)for(let c=0;c<o.length;c++)this.fadeInRipple(o[c].clientX,o[c].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(i=>{let o=i.state===Tu.VISIBLE||i.config.terminateOnPointerUp&&i.state===Tu.FADING_IN;!i.config.persistent&&o&&i.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let i=this._triggerElement;i&&(vI.forEach(o=>G_._eventManager.removeHandler(o,i,this)),this._pointerUpEventsRegistered&&(yI.forEach(o=>i.removeEventListener(o,this,_I)),this._pointerUpEventsRegistered=!1))}};G_._eventManager=new Yw;var Kw=G_;function RN(a,i,o){let c=Math.max(Math.abs(a-o.left),Math.abs(a-o.right)),u=Math.max(Math.abs(i-o.top),Math.abs(i-o.bottom));return Math.sqrt(c*c+u*u)}var SI=new Hi("mat-ripple-global-options"),FN=(()=>{let i=class i{get disabled(){return this._disabled}set disabled(c){c&&this.fadeOutAllNonPersistent(),this._disabled=c,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(c){this._trigger=c,this._setupTriggerEventsIfEnabled()}constructor(c,u,r,_,T){this._elementRef=c,this._animationMode=T,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=_||{},this._rippleRenderer=new Kw(this,u,c,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:jr(jr(jr({},this._globalOptions.animation),this._animationMode==="NoopAnimations"?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(c,u=0,r){return typeof c=="number"?this._rippleRenderer.fadeInRipple(c,u,jr(jr({},this.rippleConfig),r)):this._rippleRenderer.fadeInRipple(0,0,jr(jr({},this.rippleConfig),c))}};i.\u0275fac=function(u){return new(u||i)(Er(Ln),Er(Tn),Er(no),Er(SI,8),Er(Zd,8))},i.\u0275dir=pi({type:i,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(u,r){u&2&&io("mat-ripple-unbounded",r.unbounded)},inputs:{color:[0,"matRippleColor","color"],unbounded:[0,"matRippleUnbounded","unbounded"],centered:[0,"matRippleCentered","centered"],radius:[0,"matRippleRadius","radius"],animation:[0,"matRippleAnimation","animation"],disabled:[0,"matRippleDisabled","disabled"],trigger:[0,"matRippleTrigger","trigger"]},exportAs:["matRipple"],standalone:!0});let a=i;return a})(),EI=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275mod=Vn({type:i}),i.\u0275inj=Un({imports:[Jo,Jo]});let a=i;return a})();var xI={capture:!0},bI=["focus","mousedown","mouseenter","touchstart"],$w="mat-ripple-loader-uninitialized",Xw="mat-ripple-loader-class-name",wI="mat-ripple-loader-centered",by="mat-ripple-loader-disabled",AI=(()=>{let i=class i{constructor(){this._document=Jr(aa,{optional:!0}),this._animationMode=Jr(Zd,{optional:!0}),this._globalRippleOptions=Jr(SI,{optional:!0}),this._platform=Jr(no),this._ngZone=Jr(Tn),this._hosts=new Map,this._onInteraction=c=>{let u=af(c);if(u instanceof HTMLElement){let r=u.closest(`[${$w}="${this._globalRippleOptions?.namespace??""}"]`);r&&this._createRipple(r)}},this._ngZone.runOutsideAngular(()=>{for(let c of bI)this._document?.addEventListener(c,this._onInteraction,xI)})}ngOnDestroy(){let c=this._hosts.keys();for(let u of c)this.destroyRipple(u);for(let u of bI)this._document?.removeEventListener(u,this._onInteraction,xI)}configureRipple(c,u){c.setAttribute($w,this._globalRippleOptions?.namespace??""),(u.className||!c.hasAttribute(Xw))&&c.setAttribute(Xw,u.className||""),u.centered&&c.setAttribute(wI,""),u.disabled&&c.setAttribute(by,"")}getRipple(c){return this._hosts.get(c)||this._createRipple(c)}setDisabled(c,u){let r=this._hosts.get(c);if(r){r.disabled=u;return}u?c.setAttribute(by,""):c.removeAttribute(by)}_createRipple(c){if(!this._document)return;let u=this._hosts.get(c);if(u)return u;c.querySelector(".mat-ripple")?.remove();let r=this._document.createElement("span");r.classList.add("mat-ripple",c.getAttribute(Xw)),c.append(r);let _=new FN(new Ln(r),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return _._isInitialized=!0,_.trigger=c,_.centered=c.hasAttribute(wI),_.disabled=c.hasAttribute(by),this.attachRipple(c,_),_}attachRipple(c,u){c.removeAttribute($w),this._hosts.set(c,u)}destroyRipple(c){let u=this._hosts.get(c);u&&(u.ngOnDestroy(),this._hosts.delete(c))}};i.\u0275fac=function(u){return new(u||i)},i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();var LN=["mat-button",""],ON=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],NN=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"];var BN=new Hi("MAT_BUTTON_CONFIG");var zN=[{attribute:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{attribute:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{attribute:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{attribute:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{attribute:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab-base","mat-mdc-fab"]},{attribute:"mat-mini-fab",mdcClasses:["mdc-fab","mat-mdc-fab-base","mdc-fab--mini","mat-mdc-mini-fab"]},{attribute:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],jN=(()=>{let i=class i{get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(c){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,c)}get disableRipple(){return this._disableRipple}set disableRipple(c){this._disableRipple=c,this._updateRippleDisabled()}get disabled(){return this._disabled}set disabled(c){this._disabled=c,this._updateRippleDisabled()}constructor(c,u,r,_){this._elementRef=c,this._platform=u,this._ngZone=r,this._animationMode=_,this._focusMonitor=Jr(dI),this._rippleLoader=Jr(AI),this._isFab=!1,this._disableRipple=!1,this._disabled=!1;let T=Jr(BN,{optional:!0}),E=c.nativeElement,k=E.classList;this.disabledInteractive=T?.disabledInteractive??!1,this.color=T?.color??null,this._rippleLoader?.configureRipple(E,{className:"mat-mdc-button-ripple"});for(let{attribute:D,mdcClasses:j}of zN)E.hasAttribute(D)&&k.add(...j)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(c="program",u){c?this._focusMonitor.focusVia(this._elementRef.nativeElement,c,u):this._elementRef.nativeElement.focus(u)}_getAriaDisabled(){return this.ariaDisabled!=null?this.ariaDisabled:this.disabled&&this.disabledInteractive?!0:null}_getDisabledAttribute(){return this.disabledInteractive||!this.disabled?null:!0}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}};i.\u0275fac=function(u){m_()},i.\u0275dir=pi({type:i,inputs:{color:"color",disableRipple:[2,"disableRipple","disableRipple",ds],disabled:[2,"disabled","disabled",ds],ariaDisabled:[2,"aria-disabled","ariaDisabled",ds],disabledInteractive:[2,"disabledInteractive","disabledInteractive",ds]},features:[_l]});let a=i;return a})();var cp=(()=>{let i=class i extends jN{constructor(c,u,r,_){super(c,u,r,_)}};i.\u0275fac=function(u){return new(u||i)(Er(Ln),Er(no),Er(Tn),Er(Zd,8))},i.\u0275cmp=pa({type:i,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:14,hostBindings:function(u,r){u&2&&(cc("disabled",r._getDisabledAttribute())("aria-disabled",r._getAriaDisabled()),g_(r.color?"mat-"+r.color:""),io("mat-mdc-button-disabled",r.disabled)("mat-mdc-button-disabled-interactive",r.disabledInteractive)("_mat-animation-noopable",r._animationMode==="NoopAnimations")("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[na,ma],attrs:LN,ngContentSelectors:NN,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(u,r){u&1&&(hc(ON),nn(0,"span",0),wa(1),ti(2,"span",1),wa(3,1),Ur(),wa(4,2),nn(5,"span",2)(6,"span",3)),u&2&&io("mdc-button__ripple",!r._isFab)("mdc-fab__ripple",r._isFab)},styles:['.mat-mdc-button-base{text-decoration:none}.mdc-button{-webkit-user-select:none;user-select:none;position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0);padding:0 8px}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__label{position:relative}.mat-mdc-button{padding:0 var(--mat-text-button-horizontal-padding, 8px);height:var(--mdc-text-button-container-height);font-family:var(--mdc-text-button-label-text-font);font-size:var(--mdc-text-button-label-text-size);letter-spacing:var(--mdc-text-button-label-text-tracking);text-transform:var(--mdc-text-button-label-text-transform);font-weight:var(--mdc-text-button-label-text-weight)}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-text-button-with-icon-horizontal-padding, 8px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-text-button-ripple-color)}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-state-layer-color)}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-disabled-state-layer-color)}.mat-mdc-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-hover-state-layer-opacity)}.mat-mdc-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-focus-state-layer-opacity)}.mat-mdc-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-pressed-state-layer-opacity)}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-text-button-touch-target-display)}.mat-mdc-button,.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape)}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color)}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-unelevated-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 var(--mat-filled-button-horizontal-padding, 16px);height:var(--mdc-filled-button-container-height);font-family:var(--mdc-filled-button-label-text-font);font-size:var(--mdc-filled-button-label-text-size);letter-spacing:var(--mdc-filled-button-label-text-tracking);text-transform:var(--mdc-filled-button-label-text-transform);font-weight:var(--mdc-filled-button-label-text-weight)}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-filled-button-ripple-color)}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-state-layer-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-disabled-state-layer-color)}.mat-mdc-unelevated-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-hover-state-layer-opacity)}.mat-mdc-unelevated-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-focus-state-layer-opacity)}.mat-mdc-unelevated-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-pressed-state-layer-opacity)}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-filled-button-touch-target-display)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color);background-color:var(--mdc-filled-button-container-color)}.mat-mdc-unelevated-button,.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape)}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-filled-button-disabled-label-text-color);background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 var(--mat-protected-button-horizontal-padding, 16px);box-shadow:var(--mdc-protected-button-container-elevation-shadow);height:var(--mdc-protected-button-container-height);font-family:var(--mdc-protected-button-label-text-font);font-size:var(--mdc-protected-button-label-text-size);letter-spacing:var(--mdc-protected-button-label-text-tracking);text-transform:var(--mdc-protected-button-label-text-transform);font-weight:var(--mdc-protected-button-label-text-weight)}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-protected-button-ripple-color)}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-state-layer-color)}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-disabled-state-layer-color)}.mat-mdc-raised-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-hover-state-layer-opacity)}.mat-mdc-raised-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-focus-state-layer-opacity)}.mat-mdc-raised-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-pressed-state-layer-opacity)}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-protected-button-touch-target-display)}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color);background-color:var(--mdc-protected-button-container-color)}.mat-mdc-raised-button,.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape)}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation-shadow)}.mat-mdc-raised-button:focus{box-shadow:var(--mdc-protected-button-focus-container-elevation-shadow)}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mdc-protected-button-pressed-container-elevation-shadow)}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-protected-button-disabled-label-text-color);background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation-shadow)}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 var(--mat-outlined-button-horizontal-padding, 15px);height:var(--mdc-outlined-button-container-height);font-family:var(--mdc-outlined-button-label-text-font);font-size:var(--mdc-outlined-button-label-text-size);letter-spacing:var(--mdc-outlined-button-label-text-tracking);text-transform:var(--mdc-outlined-button-label-text-transform);font-weight:var(--mdc-outlined-button-label-text-weight);border-radius:var(--mdc-outlined-button-container-shape);border-width:var(--mdc-outlined-button-outline-width)}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-outlined-button-ripple-color)}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-state-layer-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-disabled-state-layer-color)}.mat-mdc-outlined-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-hover-state-layer-opacity)}.mat-mdc-outlined-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-focus-state-layer-opacity)}.mat-mdc-outlined-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-pressed-state-layer-opacity)}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-outlined-button-touch-target-display)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color);border-color:var(--mdc-outlined-button-outline-color)}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-outlined-button-disabled-label-text-color);border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button .mdc-button__ripple{border-width:var(--mdc-outlined-button-outline-width);border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-button .mat-icon,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-unelevated-button .mat-icon,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-raised-button .mat-icon,.mat-mdc-outlined-button .mdc-button__label,.mat-mdc-outlined-button .mat-icon{z-index:1;position:relative}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px)*-1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0});let a=i;return a})();var up=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275mod=Vn({type:i}),i.\u0275inj=Un({imports:[Jo,EI,Jo]});let a=i;return a})();var Sy=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275mod=Vn({type:i}),i.\u0275inj=Un({imports:[Jo,Jo]});let a=i;return a})();var UN=["*",[["mat-toolbar-row"]]],VN=["*","mat-toolbar-row"],GN=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275dir=pi({type:i,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"],standalone:!0});let a=i;return a})(),CI=(()=>{let i=class i{constructor(c,u,r){this._elementRef=c,this._platform=u,this._document=r}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){this._toolbarRows.length}};i.\u0275fac=function(u){return new(u||i)(Er(Ln),Er(no),Er(aa))},i.\u0275cmp=pa({type:i,selectors:[["mat-toolbar"]],contentQueries:function(u,r,_){if(u&1&&Ds(_,GN,5),u&2){let T;Ta(T=Sa())&&(r._toolbarRows=T)}},hostAttrs:[1,"mat-toolbar"],hostVars:6,hostBindings:function(u,r){u&2&&(g_(r.color?"mat-"+r.color:""),io("mat-toolbar-multiple-rows",r._toolbarRows.length>0)("mat-toolbar-single-row",r._toolbarRows.length===0))},inputs:{color:"color"},exportAs:["matToolbar"],standalone:!0,features:[ma],ngContentSelectors:VN,decls:2,vars:0,template:function(u,r){u&1&&(hc(UN),wa(0),wa(1,1))},styles:[".mat-toolbar{background:var(--mat-toolbar-container-background-color);color:var(--mat-toolbar-container-text-color)}.mat-toolbar,.mat-toolbar h1,.mat-toolbar h2,.mat-toolbar h3,.mat-toolbar h4,.mat-toolbar h5,.mat-toolbar h6{font-family:var(--mat-toolbar-title-text-font);font-size:var(--mat-toolbar-title-text-size);line-height:var(--mat-toolbar-title-text-line-height);font-weight:var(--mat-toolbar-title-text-weight);letter-spacing:var(--mat-toolbar-title-text-tracking);margin:0}.cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar .mat-form-field-underline,.mat-toolbar .mat-form-field-ripple,.mat-toolbar .mat-focused .mat-form-field-ripple{background-color:currentColor}.mat-toolbar .mat-form-field-label,.mat-toolbar .mat-focused .mat-form-field-label,.mat-toolbar .mat-select-value,.mat-toolbar .mat-select-arrow,.mat-toolbar .mat-form-field.mat-focused .mat-select-arrow{color:inherit}.mat-toolbar .mat-input-element{caret-color:currentColor}.mat-toolbar .mat-mdc-button-base.mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color:var(--mat-toolbar-container-text-color);--mdc-outlined-button-label-text-color:var(--mat-toolbar-container-text-color)}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap;height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-row,.mat-toolbar-single-row{height:var(--mat-toolbar-mobile-height)}}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%;min-height:var(--mat-toolbar-standard-height)}@media(max-width: 599px){.mat-toolbar-multiple-rows{min-height:var(--mat-toolbar-mobile-height)}}"],encapsulation:2,changeDetection:0});let a=i;return a})();var Ey=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275mod=Vn({type:i}),i.\u0275inj=Un({imports:[Jo,Jo]});let a=i;return a})();var II=lp({passive:!0}),kI=(()=>{let i=class i{constructor(c,u){this._platform=c,this._ngZone=u,this._monitoredElements=new Map}monitor(c){if(!this._platform.isBrowser)return Qh;let u=od(c),r=this._monitoredElements.get(u);if(r)return r.subject;let _=new Ra,T="cdk-text-field-autofilled",E=k=>{k.animationName==="cdk-text-field-autofill-start"&&!u.classList.contains(T)?(u.classList.add(T),this._ngZone.run(()=>_.next({target:k.target,isAutofilled:!0}))):k.animationName==="cdk-text-field-autofill-end"&&u.classList.contains(T)&&(u.classList.remove(T),this._ngZone.run(()=>_.next({target:k.target,isAutofilled:!1})))};return this._ngZone.runOutsideAngular(()=>{u.addEventListener("animationstart",E,II),u.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(u,{subject:_,unlisten:()=>{u.removeEventListener("animationstart",E,II)}}),_}stopMonitoring(c){let u=od(c),r=this._monitoredElements.get(u);r&&(r.unlisten(),r.subject.complete(),u.classList.remove("cdk-text-field-autofill-monitored"),u.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(u))}ngOnDestroy(){this._monitoredElements.forEach((c,u)=>this.stopMonitoring(u))}};i.\u0275fac=function(u){return new(u||i)(bi(no),bi(Tn))},i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();var MI=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275mod=Vn({type:i}),i.\u0275inj=Un({});let a=i;return a})();var BI=(()=>{let i=class i{constructor(c,u){this._renderer=c,this._elementRef=u,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(c,u){this._renderer.setProperty(this._elementRef.nativeElement,c,u)}registerOnTouched(c){this.onTouched=c}registerOnChange(c){this.onChange=c}setDisabledState(c){this.setProperty("disabled",c)}};i.\u0275fac=function(u){return new(u||i)(Er(Vv),Er(Ln))},i.\u0275dir=pi({type:i});let a=i;return a})(),$N=(()=>{let i=class i extends BI{};i.\u0275fac=(()=>{let c;return function(r){return(c||(c=us(i)))(r||i)}})(),i.\u0275dir=pi({type:i,features:[na]});let a=i;return a})(),zI=new Hi("");var XN={provide:zI,useExisting:ap(()=>H0),multi:!0};function ZN(){let a=A0()?A0().getUserAgent():"";return/android (\d+)/.test(a.toLowerCase())}var YN=new Hi(""),H0=(()=>{let i=class i extends BI{constructor(c,u,r){super(c,u),this._compositionMode=r,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!ZN())}writeValue(c){let u=c??"";this.setProperty("value",u)}_handleInput(c){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(c)}_compositionStart(){this._composing=!0}_compositionEnd(c){this._composing=!1,this._compositionMode&&this.onChange(c)}};i.\u0275fac=function(u){return new(u||i)(Er(Vv),Er(Ln),Er(YN,8))},i.\u0275dir=pi({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(u,r){u&1&&hs("input",function(T){return r._handleInput(T.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(T){return r._compositionEnd(T.target.value)})},features:[Fa([XN]),na]});let a=i;return a})();function hp(a){return a==null||(typeof a=="string"||Array.isArray(a))&&a.length===0}function jI(a){return a!=null&&typeof a.length=="number"}var W0=new Hi(""),n5=new Hi(""),KN=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,So=class{static min(i){return JN(i)}static max(i){return QN(i)}static required(i){return e8(i)}static requiredTrue(i){return t8(i)}static email(i){return UI(i)}static minLength(i){return VI(i)}static maxLength(i){return GI(i)}static pattern(i){return r8(i)}static nullValidator(i){return Iy(i)}static compose(i){return ZI(i)}static composeAsync(i){return YI(i)}};function JN(a){return i=>{if(hp(i.value)||hp(a))return null;let o=parseFloat(i.value);return!isNaN(o)&&o<a?{min:{min:a,actual:i.value}}:null}}function QN(a){return i=>{if(hp(i.value)||hp(a))return null;let o=parseFloat(i.value);return!isNaN(o)&&o>a?{max:{max:a,actual:i.value}}:null}}function e8(a){return hp(a.value)?{required:!0}:null}function t8(a){return a.value===!0?null:{required:!0}}function UI(a){return hp(a.value)||KN.test(a.value)?null:{email:!0}}function VI(a){return i=>hp(i.value)||!jI(i.value)?null:i.value.length<a?{minlength:{requiredLength:a,actualLength:i.value.length}}:null}function GI(a){return i=>jI(i.value)&&i.value.length>a?{maxlength:{requiredLength:a,actualLength:i.value.length}}:null}function r8(a){if(!a)return Iy;let i,o;return typeof a=="string"?(o="",a.charAt(0)!=="^"&&(o+="^"),o+=a,a.charAt(a.length-1)!=="$"&&(o+="$"),i=new RegExp(o)):(o=a.toString(),i=a),c=>{if(hp(c.value))return null;let u=c.value;return i.test(u)?null:{pattern:{requiredPattern:o,actualValue:u}}}}function Iy(a){return null}function HI(a){return a!=null}function WI(a){return $v(a)?sc(a):a}function qI(a){let i={};return a.forEach(o=>{i=o!=null?jr(jr({},i),o):i}),Object.keys(i).length===0?null:i}function $I(a,i){return i.map(o=>o(a))}function i8(a){return!a.validate}function XI(a){return a.map(i=>i8(i)?i:o=>i.validate(o))}function ZI(a){if(!a)return null;let i=a.filter(HI);return i.length==0?null:function(o){return qI($I(o,i))}}function a5(a){return a!=null?ZI(XI(a)):null}function YI(a){if(!a)return null;let i=a.filter(HI);return i.length==0?null:function(o){let c=$I(o,i).map(WI);return SC(c).pipe(Xn(qI))}}function o5(a){return a!=null?YI(XI(a)):null}function DI(a,i){return a===null?[i]:Array.isArray(a)?[...a,i]:[a,i]}function KI(a){return a._rawValidators}function JI(a){return a._rawAsyncValidators}function Jw(a){return a?Array.isArray(a)?a:[a]:[]}function ky(a,i){return Array.isArray(a)?a.includes(i):a===i}function RI(a,i){let o=Jw(i);return Jw(a).forEach(u=>{ky(o,u)||o.push(u)}),o}function FI(a,i){return Jw(i).filter(o=>!ky(a,o))}var My=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(i){this._rawValidators=i||[],this._composedValidatorFn=a5(this._rawValidators)}_setAsyncValidators(i){this._rawAsyncValidators=i||[],this._composedAsyncValidatorFn=o5(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(i){this._onDestroyCallbacks.push(i)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(i=>i()),this._onDestroyCallbacks=[]}reset(i=void 0){this.control&&this.control.reset(i)}hasError(i,o){return this.control?this.control.hasError(i,o):!1}getError(i,o){return this.control?this.control.getError(i,o):null}},dp=class extends My{get formDirective(){return null}get path(){return null}},mm=class extends My{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Dy=class{constructor(i){this._cd=i}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},n8={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},KX=ba(jr({},n8),{"[class.ng-submitted]":"isSubmitted"}),Ly=(()=>{let i=class i extends Dy{constructor(c){super(c)}};i.\u0275fac=function(u){return new(u||i)(Er(mm,2))},i.\u0275dir=pi({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(u,r){u&2&&io("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[na]});let a=i;return a})(),Oy=(()=>{let i=class i extends Dy{constructor(c){super(c)}};i.\u0275fac=function(u){return new(u||i)(Er(dp,10))},i.\u0275dir=pi({type:i,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(u,r){u&2&&io("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[na]});let a=i;return a})();var H_="VALID",Ay="INVALID",j0="PENDING",W_="DISABLED",fp=class{},Ry=class extends fp{constructor(i,o){super(),this.value=i,this.source=o}},$_=class extends fp{constructor(i,o){super(),this.pristine=i,this.source=o}},X_=class extends fp{constructor(i,o){super(),this.touched=i,this.source=o}},U0=class extends fp{constructor(i,o){super(),this.status=i,this.source=o}},Qw=class extends fp{constructor(i){super(),this.source=i}},e5=class extends fp{constructor(i){super(),this.source=i}};function s5(a){return(Ny(a)?a.validators:a)||null}function a8(a){return Array.isArray(a)?a5(a):a||null}function l5(a,i){return(Ny(i)?i.asyncValidators:a)||null}function o8(a){return Array.isArray(a)?o5(a):a||null}function Ny(a){return a!=null&&!Array.isArray(a)&&typeof a=="object"}function QI(a,i,o){let c=a.controls;if(!(i?Object.keys(c):c).length)throw new Xa(1e3,"");if(!c[o])throw new Xa(1001,"")}function e4(a,i,o){a._forEachChild((c,u)=>{if(o[u]===void 0)throw new Xa(1002,"")})}var V0=class{constructor(i,o){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=ef(()=>this.statusReactive()),this.statusReactive=Kd(void 0),this._pristine=ef(()=>this.pristineReactive()),this.pristineReactive=Kd(!0),this._touched=ef(()=>this.touchedReactive()),this.touchedReactive=Kd(!1),this._events=new Ra,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(i),this._assignAsyncValidators(o)}get validator(){return this._composedValidatorFn}set validator(i){this._rawValidators=this._composedValidatorFn=i}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(i){this._rawAsyncValidators=this._composedAsyncValidatorFn=i}get parent(){return this._parent}get status(){return tf(this.statusReactive)}set status(i){tf(()=>this.statusReactive.set(i))}get valid(){return this.status===H_}get invalid(){return this.status===Ay}get pending(){return this.status==j0}get disabled(){return this.status===W_}get enabled(){return this.status!==W_}get pristine(){return tf(this.pristineReactive)}set pristine(i){tf(()=>this.pristineReactive.set(i))}get dirty(){return!this.pristine}get touched(){return tf(this.touchedReactive)}set touched(i){tf(()=>this.touchedReactive.set(i))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(i){this._assignValidators(i)}setAsyncValidators(i){this._assignAsyncValidators(i)}addValidators(i){this.setValidators(RI(i,this._rawValidators))}addAsyncValidators(i){this.setAsyncValidators(RI(i,this._rawAsyncValidators))}removeValidators(i){this.setValidators(FI(i,this._rawValidators))}removeAsyncValidators(i){this.setAsyncValidators(FI(i,this._rawAsyncValidators))}hasValidator(i){return ky(this._rawValidators,i)}hasAsyncValidator(i){return ky(this._rawAsyncValidators,i)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(i={}){let o=this.touched===!1;this.touched=!0;let c=i.sourceControl??this;this._parent&&!i.onlySelf&&this._parent.markAsTouched(ba(jr({},i),{sourceControl:c})),o&&i.emitEvent!==!1&&this._events.next(new X_(!0,c))}markAllAsTouched(i={}){this.markAsTouched({onlySelf:!0,emitEvent:i.emitEvent,sourceControl:this}),this._forEachChild(o=>o.markAllAsTouched(i))}markAsUntouched(i={}){let o=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let c=i.sourceControl??this;this._forEachChild(u=>{u.markAsUntouched({onlySelf:!0,emitEvent:i.emitEvent,sourceControl:c})}),this._parent&&!i.onlySelf&&this._parent._updateTouched(i,c),o&&i.emitEvent!==!1&&this._events.next(new X_(!1,c))}markAsDirty(i={}){let o=this.pristine===!0;this.pristine=!1;let c=i.sourceControl??this;this._parent&&!i.onlySelf&&this._parent.markAsDirty(ba(jr({},i),{sourceControl:c})),o&&i.emitEvent!==!1&&this._events.next(new $_(!1,c))}markAsPristine(i={}){let o=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let c=i.sourceControl??this;this._forEachChild(u=>{u.markAsPristine({onlySelf:!0,emitEvent:i.emitEvent})}),this._parent&&!i.onlySelf&&this._parent._updatePristine(i,c),o&&i.emitEvent!==!1&&this._events.next(new $_(!0,c))}markAsPending(i={}){this.status=j0;let o=i.sourceControl??this;i.emitEvent!==!1&&(this._events.next(new U0(this.status,o)),this.statusChanges.emit(this.status)),this._parent&&!i.onlySelf&&this._parent.markAsPending(ba(jr({},i),{sourceControl:o}))}disable(i={}){let o=this._parentMarkedDirty(i.onlySelf);this.status=W_,this.errors=null,this._forEachChild(u=>{u.disable(ba(jr({},i),{onlySelf:!0}))}),this._updateValue();let c=i.sourceControl??this;i.emitEvent!==!1&&(this._events.next(new Ry(this.value,c)),this._events.next(new U0(this.status,c)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ba(jr({},i),{skipPristineCheck:o}),this),this._onDisabledChange.forEach(u=>u(!0))}enable(i={}){let o=this._parentMarkedDirty(i.onlySelf);this.status=H_,this._forEachChild(c=>{c.enable(ba(jr({},i),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:i.emitEvent}),this._updateAncestors(ba(jr({},i),{skipPristineCheck:o}),this),this._onDisabledChange.forEach(c=>c(!1))}_updateAncestors(i,o){this._parent&&!i.onlySelf&&(this._parent.updateValueAndValidity(i),i.skipPristineCheck||this._parent._updatePristine({},o),this._parent._updateTouched({},o))}setParent(i){this._parent=i}getRawValue(){return this.value}updateValueAndValidity(i={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let c=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===H_||this.status===j0)&&this._runAsyncValidator(c,i.emitEvent)}let o=i.sourceControl??this;i.emitEvent!==!1&&(this._events.next(new Ry(this.value,o)),this._events.next(new U0(this.status,o)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!i.onlySelf&&this._parent.updateValueAndValidity(ba(jr({},i),{sourceControl:o}))}_updateTreeValidity(i={emitEvent:!0}){this._forEachChild(o=>o._updateTreeValidity(i)),this.updateValueAndValidity({onlySelf:!0,emitEvent:i.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?W_:H_}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(i,o){if(this.asyncValidator){this.status=j0,this._hasOwnPendingAsyncValidator={emitEvent:o!==!1};let c=WI(this.asyncValidator(this));this._asyncValidationSubscription=c.subscribe(u=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(u,{emitEvent:o,shouldHaveEmitted:i})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let i=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,i}return!1}setErrors(i,o={}){this.errors=i,this._updateControlsErrors(o.emitEvent!==!1,this,o.shouldHaveEmitted)}get(i){let o=i;return o==null||(Array.isArray(o)||(o=o.split(".")),o.length===0)?null:o.reduce((c,u)=>c&&c._find(u),this)}getError(i,o){let c=o?this.get(o):this;return c&&c.errors?c.errors[i]:null}hasError(i,o){return!!this.getError(i,o)}get root(){let i=this;for(;i._parent;)i=i._parent;return i}_updateControlsErrors(i,o,c){this.status=this._calculateStatus(),i&&this.statusChanges.emit(this.status),(i||c)&&this._events.next(new U0(this.status,o)),this._parent&&this._parent._updateControlsErrors(i,o,c)}_initObservables(){this.valueChanges=new $s,this.statusChanges=new $s}_calculateStatus(){return this._allControlsDisabled()?W_:this.errors?Ay:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(j0)?j0:this._anyControlsHaveStatus(Ay)?Ay:H_}_anyControlsHaveStatus(i){return this._anyControls(o=>o.status===i)}_anyControlsDirty(){return this._anyControls(i=>i.dirty)}_anyControlsTouched(){return this._anyControls(i=>i.touched)}_updatePristine(i,o){let c=!this._anyControlsDirty(),u=this.pristine!==c;this.pristine=c,this._parent&&!i.onlySelf&&this._parent._updatePristine(i,o),u&&this._events.next(new $_(this.pristine,o))}_updateTouched(i={},o){this.touched=this._anyControlsTouched(),this._events.next(new X_(this.touched,o)),this._parent&&!i.onlySelf&&this._parent._updateTouched(i,o)}_registerOnCollectionChange(i){this._onCollectionChange=i}_setUpdateStrategy(i){Ny(i)&&i.updateOn!=null&&(this._updateOn=i.updateOn)}_parentMarkedDirty(i){let o=this._parent&&this._parent.dirty;return!i&&!!o&&!this._parent._anyControlsDirty()}_find(i){return null}_assignValidators(i){this._rawValidators=Array.isArray(i)?i.slice():i,this._composedValidatorFn=a8(this._rawValidators)}_assignAsyncValidators(i){this._rawAsyncValidators=Array.isArray(i)?i.slice():i,this._composedAsyncValidatorFn=o8(this._rawAsyncValidators)}},G0=class extends V0{constructor(i,o,c){super(s5(o),l5(c,o)),this.controls=i,this._initObservables(),this._setUpdateStrategy(o),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(i,o){return this.controls[i]?this.controls[i]:(this.controls[i]=o,o.setParent(this),o._registerOnCollectionChange(this._onCollectionChange),o)}addControl(i,o,c={}){this.registerControl(i,o),this.updateValueAndValidity({emitEvent:c.emitEvent}),this._onCollectionChange()}removeControl(i,o={}){this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),delete this.controls[i],this.updateValueAndValidity({emitEvent:o.emitEvent}),this._onCollectionChange()}setControl(i,o,c={}){this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),delete this.controls[i],o&&this.registerControl(i,o),this.updateValueAndValidity({emitEvent:c.emitEvent}),this._onCollectionChange()}contains(i){return this.controls.hasOwnProperty(i)&&this.controls[i].enabled}setValue(i,o={}){e4(this,!0,i),Object.keys(i).forEach(c=>{QI(this,!0,c),this.controls[c].setValue(i[c],{onlySelf:!0,emitEvent:o.emitEvent})}),this.updateValueAndValidity(o)}patchValue(i,o={}){i!=null&&(Object.keys(i).forEach(c=>{let u=this.controls[c];u&&u.patchValue(i[c],{onlySelf:!0,emitEvent:o.emitEvent})}),this.updateValueAndValidity(o))}reset(i={},o={}){this._forEachChild((c,u)=>{c.reset(i?i[u]:null,{onlySelf:!0,emitEvent:o.emitEvent})}),this._updatePristine(o,this),this._updateTouched(o,this),this.updateValueAndValidity(o)}getRawValue(){return this._reduceChildren({},(i,o,c)=>(i[c]=o.getRawValue(),i))}_syncPendingControls(){let i=this._reduceChildren(!1,(o,c)=>c._syncPendingControls()?!0:o);return i&&this.updateValueAndValidity({onlySelf:!0}),i}_forEachChild(i){Object.keys(this.controls).forEach(o=>{let c=this.controls[o];c&&i(c,o)})}_setUpControls(){this._forEachChild(i=>{i.setParent(this),i._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(i){for(let[o,c]of Object.entries(this.controls))if(this.contains(o)&&i(c))return!0;return!1}_reduceValue(){let i={};return this._reduceChildren(i,(o,c,u)=>((c.enabled||this.disabled)&&(o[u]=c.value),o))}_reduceChildren(i,o){let c=i;return this._forEachChild((u,r)=>{c=o(c,u,r)}),c}_allControlsDisabled(){for(let i of Object.keys(this.controls))if(this.controls[i].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(i){return this.controls.hasOwnProperty(i)?this.controls[i]:null}};var t5=class extends G0{};var c5=new Hi("CallSetDisabledState",{providedIn:"root",factory:()=>u5}),u5="always";function s8(a,i){return[...i.path,a]}function r5(a,i,o=u5){h5(a,i),i.valueAccessor.writeValue(a.value),(a.disabled||o==="always")&&i.valueAccessor.setDisabledState?.(a.disabled),c8(a,i),h8(a,i),u8(a,i),l8(a,i)}function PI(a,i,o=!0){let c=()=>{};i.valueAccessor&&(i.valueAccessor.registerOnChange(c),i.valueAccessor.registerOnTouched(c)),Py(a,i),a&&(i._invokeOnDestroyCallbacks(),a._registerOnCollectionChange(()=>{}))}function Fy(a,i){a.forEach(o=>{o.registerOnValidatorChange&&o.registerOnValidatorChange(i)})}function l8(a,i){if(i.valueAccessor.setDisabledState){let o=c=>{i.valueAccessor.setDisabledState(c)};a.registerOnDisabledChange(o),i._registerOnDestroy(()=>{a._unregisterOnDisabledChange(o)})}}function h5(a,i){let o=KI(a);i.validator!==null?a.setValidators(DI(o,i.validator)):typeof o=="function"&&a.setValidators([o]);let c=JI(a);i.asyncValidator!==null?a.setAsyncValidators(DI(c,i.asyncValidator)):typeof c=="function"&&a.setAsyncValidators([c]);let u=()=>a.updateValueAndValidity();Fy(i._rawValidators,u),Fy(i._rawAsyncValidators,u)}function Py(a,i){let o=!1;if(a!==null){if(i.validator!==null){let u=KI(a);if(Array.isArray(u)&&u.length>0){let r=u.filter(_=>_!==i.validator);r.length!==u.length&&(o=!0,a.setValidators(r))}}if(i.asyncValidator!==null){let u=JI(a);if(Array.isArray(u)&&u.length>0){let r=u.filter(_=>_!==i.asyncValidator);r.length!==u.length&&(o=!0,a.setAsyncValidators(r))}}}let c=()=>{};return Fy(i._rawValidators,c),Fy(i._rawAsyncValidators,c),o}function c8(a,i){i.valueAccessor.registerOnChange(o=>{a._pendingValue=o,a._pendingChange=!0,a._pendingDirty=!0,a.updateOn==="change"&&t4(a,i)})}function u8(a,i){i.valueAccessor.registerOnTouched(()=>{a._pendingTouched=!0,a.updateOn==="blur"&&a._pendingChange&&t4(a,i),a.updateOn!=="submit"&&a.markAsTouched()})}function t4(a,i){a._pendingDirty&&a.markAsDirty(),a.setValue(a._pendingValue,{emitModelToViewChange:!1}),i.viewToModelUpdate(a._pendingValue),a._pendingChange=!1}function h8(a,i){let o=(c,u)=>{i.valueAccessor.writeValue(c),u&&i.viewToModelUpdate(c)};a.registerOnChange(o),i._registerOnDestroy(()=>{a._unregisterOnChange(o)})}function r4(a,i){a==null,h5(a,i)}function d8(a,i){return Py(a,i)}function f8(a,i){if(!a.hasOwnProperty("model"))return!1;let o=a.model;return o.isFirstChange()?!0:!Object.is(i,o.currentValue)}function p8(a){return Object.getPrototypeOf(a.constructor)===$N}function i4(a,i){a._syncPendingControls(),i.forEach(o=>{let c=o.control;c.updateOn==="submit"&&c._pendingChange&&(o.viewToModelUpdate(c._pendingValue),c._pendingChange=!1)})}function m8(a,i){if(!i)return null;Array.isArray(i);let o,c,u;return i.forEach(r=>{r.constructor===H0?o=r:p8(r)?c=r:u=r}),u||c||o||null}function g8(a,i){let o=a.indexOf(i);o>-1&&a.splice(o,1)}var _8={provide:dp,useExisting:ap(()=>d5)},q_=Promise.resolve(),d5=(()=>{let i=class i extends dp{get submitted(){return tf(this.submittedReactive)}constructor(c,u,r){super(),this.callSetDisabledState=r,this._submitted=ef(()=>this.submittedReactive()),this.submittedReactive=Kd(!1),this._directives=new Set,this.ngSubmit=new $s,this.form=new G0({},a5(c),o5(u))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(c){q_.then(()=>{let u=this._findContainer(c.path);c.control=u.registerControl(c.name,c.control),r5(c.control,c,this.callSetDisabledState),c.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(c)})}getControl(c){return this.form.get(c.path)}removeControl(c){q_.then(()=>{let u=this._findContainer(c.path);u&&u.removeControl(c.name),this._directives.delete(c)})}addFormGroup(c){q_.then(()=>{let u=this._findContainer(c.path),r=new G0({});r4(r,c),u.registerControl(c.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(c){q_.then(()=>{let u=this._findContainer(c.path);u&&u.removeControl(c.name)})}getFormGroup(c){return this.form.get(c.path)}updateModel(c,u){q_.then(()=>{this.form.get(c.path).setValue(u)})}setValue(c){this.control.setValue(c)}onSubmit(c){return this.submittedReactive.set(!0),i4(this.form,this._directives),this.ngSubmit.emit(c),c?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(c=void 0){this.form.reset(c),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(c){return c.pop(),c.length?this.form.get(c):this.form}};i.\u0275fac=function(u){return new(u||i)(Er(W0,10),Er(n5,10),Er(c5,8))},i.\u0275dir=pi({type:i,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(u,r){u&1&&hs("submit",function(T){return r.onSubmit(T)})("reset",function(){return r.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Fa([_8]),na]});let a=i;return a})();function LI(a,i){let o=a.indexOf(i);o>-1&&a.splice(o,1)}function OI(a){return typeof a=="object"&&a!==null&&Object.keys(a).length===2&&"value"in a&&"disabled"in a}var Cy=class extends V0{constructor(i=null,o,c){super(s5(o),l5(c,o)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(i),this._setUpdateStrategy(o),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Ny(o)&&(o.nonNullable||o.initialValueIsDefault)&&(OI(i)?this.defaultValue=i.value:this.defaultValue=i)}setValue(i,o={}){this.value=this._pendingValue=i,this._onChange.length&&o.emitModelToViewChange!==!1&&this._onChange.forEach(c=>c(this.value,o.emitViewToModelChange!==!1)),this.updateValueAndValidity(o)}patchValue(i,o={}){this.setValue(i,o)}reset(i=this.defaultValue,o={}){this._applyFormState(i),this.markAsPristine(o),this.markAsUntouched(o),this.setValue(this.value,o),this._pendingChange=!1}_updateValue(){}_anyControls(i){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(i){this._onChange.push(i)}_unregisterOnChange(i){LI(this._onChange,i)}registerOnDisabledChange(i){this._onDisabledChange.push(i)}_unregisterOnDisabledChange(i){LI(this._onDisabledChange,i)}_forEachChild(i){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(i){OI(i)?(this.value=this._pendingValue=i.value,i.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=i}};var v8=a=>a instanceof Cy;var By=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275dir=pi({type:i,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let a=i;return a})();var n4=new Hi("");var y8={provide:dp,useExisting:ap(()=>gm)},gm=(()=>{let i=class i extends dp{get submitted(){return tf(this._submittedReactive)}set submitted(c){this._submittedReactive.set(c)}constructor(c,u,r){super(),this.callSetDisabledState=r,this._submitted=ef(()=>this._submittedReactive()),this._submittedReactive=Kd(!1),this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new $s,this._setValidators(c),this._setAsyncValidators(u)}ngOnChanges(c){this._checkFormPresent(),c.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Py(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(c){let u=this.form.get(c.path);return r5(u,c,this.callSetDisabledState),u.updateValueAndValidity({emitEvent:!1}),this.directives.push(c),u}getControl(c){return this.form.get(c.path)}removeControl(c){PI(c.control||null,c,!1),g8(this.directives,c)}addFormGroup(c){this._setUpFormContainer(c)}removeFormGroup(c){this._cleanUpFormContainer(c)}getFormGroup(c){return this.form.get(c.path)}addFormArray(c){this._setUpFormContainer(c)}removeFormArray(c){this._cleanUpFormContainer(c)}getFormArray(c){return this.form.get(c.path)}updateModel(c,u){this.form.get(c.path).setValue(u)}onSubmit(c){return this._submittedReactive.set(!0),i4(this.form,this.directives),this.ngSubmit.emit(c),this.form._events.next(new Qw(this.control)),c?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(c=void 0){this.form.reset(c),this._submittedReactive.set(!1),this.form._events.next(new e5(this.form))}_updateDomValue(){this.directives.forEach(c=>{let u=c.control,r=this.form.get(c.path);u!==r&&(PI(u||null,c),v8(r)&&(r5(r,c,this.callSetDisabledState),c.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(c){let u=this.form.get(c.path);r4(u,c),u.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(c){if(this.form){let u=this.form.get(c.path);u&&d8(u,c)&&u.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){h5(this.form,this),this._oldForm&&Py(this._oldForm,this)}_checkFormPresent(){this.form}};i.\u0275fac=function(u){return new(u||i)(Er(W0,10),Er(n5,10),Er(c5,8))},i.\u0275dir=pi({type:i,selectors:[["","formGroup",""]],hostBindings:function(u,r){u&1&&hs("submit",function(T){return r.onSubmit(T)})("reset",function(){return r.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Fa([y8]),na,lc]});let a=i;return a})();var x8={provide:mm,useExisting:ap(()=>Z_)},Z_=(()=>{let i=class i extends mm{set isDisabled(c){}constructor(c,u,r,_,T){super(),this._ngModelWarningConfig=T,this._added=!1,this.name=null,this.update=new $s,this._ngModelWarningSent=!1,this._parent=c,this._setValidators(u),this._setAsyncValidators(r),this.valueAccessor=m8(this,_)}ngOnChanges(c){this._added||this._setUpControl(),f8(c,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(c){this.viewModel=c,this.update.emit(c)}get path(){return s8(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};i._ngModelWarningSentOnce=!1,i.\u0275fac=function(u){return new(u||i)(Er(dp,13),Er(W0,10),Er(n5,10),Er(zI,10),Er(n4,8))},i.\u0275dir=pi({type:i,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[Fa([x8]),na,lc]});let a=i;return a})();function a4(a){return typeof a=="number"?a:parseInt(a,10)}var f5=(()=>{let i=class i{constructor(){this._validator=Iy}ngOnChanges(c){if(this.inputName in c){let u=this.normalizeInput(c[this.inputName].currentValue);this._enabled=this.enabled(u),this._validator=this._enabled?this.createValidator(u):Iy,this._onChange&&this._onChange()}}validate(c){return this._validator(c)}registerOnValidatorChange(c){this._onChange=c}enabled(c){return c!=null}};i.\u0275fac=function(u){return new(u||i)},i.\u0275dir=pi({type:i,features:[lc]});let a=i;return a})();var b8={provide:W0,useExisting:ap(()=>p5),multi:!0},p5=(()=>{let i=class i extends f5{constructor(){super(...arguments),this.inputName="email",this.normalizeInput=ds,this.createValidator=c=>UI}enabled(c){return c}};i.\u0275fac=(()=>{let c;return function(r){return(c||(c=us(i)))(r||i)}})(),i.\u0275dir=pi({type:i,selectors:[["","email","","formControlName",""],["","email","","formControl",""],["","email","","ngModel",""]],inputs:{email:"email"},features:[Fa([b8]),na]});let a=i;return a})(),w8={provide:W0,useExisting:ap(()=>m5),multi:!0},m5=(()=>{let i=class i extends f5{constructor(){super(...arguments),this.inputName="minlength",this.normalizeInput=c=>a4(c),this.createValidator=c=>VI(c)}};i.\u0275fac=(()=>{let c;return function(r){return(c||(c=us(i)))(r||i)}})(),i.\u0275dir=pi({type:i,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(u,r){u&2&&cc("minlength",r._enabled?r.minlength:null)},inputs:{minlength:"minlength"},features:[Fa([w8]),na]});let a=i;return a})(),T8={provide:W0,useExisting:ap(()=>g5),multi:!0},g5=(()=>{let i=class i extends f5{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=c=>a4(c),this.createValidator=c=>GI(c)}};i.\u0275fac=(()=>{let c;return function(r){return(c||(c=us(i)))(r||i)}})(),i.\u0275dir=pi({type:i,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(u,r){u&2&&cc("maxlength",r._enabled?r.maxlength:null)},inputs:{maxlength:"maxlength"},features:[Fa([T8]),na]});let a=i;return a})();var S8=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275mod=Vn({type:i}),i.\u0275inj=Un({});let a=i;return a})(),i5=class extends V0{constructor(i,o,c){super(s5(o),l5(c,o)),this.controls=i,this._initObservables(),this._setUpdateStrategy(o),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(i){return this.controls[this._adjustIndex(i)]}push(i,o={}){this.controls.push(i),this._registerControl(i),this.updateValueAndValidity({emitEvent:o.emitEvent}),this._onCollectionChange()}insert(i,o,c={}){this.controls.splice(i,0,o),this._registerControl(o),this.updateValueAndValidity({emitEvent:c.emitEvent})}removeAt(i,o={}){let c=this._adjustIndex(i);c<0&&(c=0),this.controls[c]&&this.controls[c]._registerOnCollectionChange(()=>{}),this.controls.splice(c,1),this.updateValueAndValidity({emitEvent:o.emitEvent})}setControl(i,o,c={}){let u=this._adjustIndex(i);u<0&&(u=0),this.controls[u]&&this.controls[u]._registerOnCollectionChange(()=>{}),this.controls.splice(u,1),o&&(this.controls.splice(u,0,o),this._registerControl(o)),this.updateValueAndValidity({emitEvent:c.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(i,o={}){e4(this,!1,i),i.forEach((c,u)=>{QI(this,!1,u),this.at(u).setValue(c,{onlySelf:!0,emitEvent:o.emitEvent})}),this.updateValueAndValidity(o)}patchValue(i,o={}){i!=null&&(i.forEach((c,u)=>{this.at(u)&&this.at(u).patchValue(c,{onlySelf:!0,emitEvent:o.emitEvent})}),this.updateValueAndValidity(o))}reset(i=[],o={}){this._forEachChild((c,u)=>{c.reset(i[u],{onlySelf:!0,emitEvent:o.emitEvent})}),this._updatePristine(o,this),this._updateTouched(o,this),this.updateValueAndValidity(o)}getRawValue(){return this.controls.map(i=>i.getRawValue())}clear(i={}){this.controls.length<1||(this._forEachChild(o=>o._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:i.emitEvent}))}_adjustIndex(i){return i<0?i+this.length:i}_syncPendingControls(){let i=this.controls.reduce((o,c)=>c._syncPendingControls()?!0:o,!1);return i&&this.updateValueAndValidity({onlySelf:!0}),i}_forEachChild(i){this.controls.forEach((o,c)=>{i(o,c)})}_updateValue(){this.value=this.controls.filter(i=>i.enabled||this.disabled).map(i=>i.value)}_anyControls(i){return this.controls.some(o=>o.enabled&&i(o))}_setUpControls(){this._forEachChild(i=>this._registerControl(i))}_allControlsDisabled(){for(let i of this.controls)if(i.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(i){i.setParent(this),i._registerOnCollectionChange(this._onCollectionChange)}_find(i){return this.at(i)??null}};function NI(a){return!!a&&(a.asyncValidators!==void 0||a.validators!==void 0||a.updateOn!==void 0)}var zy=(()=>{let i=class i{constructor(){this.useNonNullable=!1}get nonNullable(){let c=new i;return c.useNonNullable=!0,c}group(c,u=null){let r=this._reduceControls(c),_={};return NI(u)?_=u:u!==null&&(_.validators=u.validator,_.asyncValidators=u.asyncValidator),new G0(r,_)}record(c,u=null){let r=this._reduceControls(c);return new t5(r,u)}control(c,u,r){let _={};return this.useNonNullable?(NI(u)?_=u:(_.validators=u,_.asyncValidators=r),new Cy(c,ba(jr({},_),{nonNullable:!0}))):new Cy(c,u,r)}array(c,u,r){let _=c.map(T=>this._createControl(T));return new i5(_,u,r)}_reduceControls(c){let u={};return Object.keys(c).forEach(r=>{u[r]=this._createControl(c[r])}),u}_createControl(c){if(c instanceof Cy)return c;if(c instanceof V0)return c;if(Array.isArray(c)){let u=c[0],r=c.length>1?c[1]:null,_=c.length>2?c[2]:null;return this.control(u,r,_)}else return this.control(c)}};i.\u0275fac=function(u){return new(u||i)},i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();var jy=(()=>{let i=class i{static withConfig(c){return{ngModule:i,providers:[{provide:n4,useValue:c.warnOnNgModelWithFormControl??"always"},{provide:c5,useValue:c.callSetDisabledState??u5}]}}};i.\u0275fac=function(u){return new(u||i)},i.\u0275mod=Vn({type:i}),i.\u0275inj=Un({imports:[S8]});let a=i;return a})();var v5=class{constructor(i){this._box=i,this._destroyed=new Ra,this._resizeSubject=new Ra,this._elementObservables=new Map,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(o=>this._resizeSubject.next(o)))}observe(i){return this._elementObservables.has(i)||this._elementObservables.set(i,new x0(o=>{let c=this._resizeSubject.subscribe(o);return this._resizeObserver?.observe(i,{box:this._box}),()=>{this._resizeObserver?.unobserve(i),c.unsubscribe(),this._elementObservables.delete(i)}}).pipe(ch(o=>o.some(c=>c.target===i)),O2({bufferSize:1,refCount:!0}),gl(this._destroyed))),this._elementObservables.get(i)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}},o4=(()=>{let i=class i{constructor(){this._observers=new Map,this._ngZone=Jr(Tn),typeof ResizeObserver<"u"}ngOnDestroy(){for(let[,c]of this._observers)c.destroy();this._observers.clear(),typeof ResizeObserver<"u"}observe(c,u){let r=u?.box||"content-box";return this._observers.has(r)||this._observers.set(r,new v5(r)),this._observers.get(r).observe(c)}};i.\u0275fac=function(u){return new(u||i)},i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();var E8=["notch"],A8=["matFormFieldNotchedOutline",""],C8=["*"],I8=["textField"],k8=["iconPrefixContainer"],M8=["textPrefixContainer"],D8=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],R8=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];function F8(a,i){a&1&&nn(0,"span",19)}function P8(a,i){if(a&1&&(ti(0,"label",18),wa(1,1),En(2,F8,1,0,"span",19),Ur()),a&2){let o=Bo(2);Xs("floating",o._shouldLabelFloat())("monitorResize",o._hasOutline())("id",o._labelId),cc("for",o._control.disableAutomaticLabeling?null:o._control.id),Ii(2),Zn(!o.hideRequiredMarker&&o._control.required?2:-1)}}function L8(a,i){if(a&1&&En(0,P8,3,5,"label",18),a&2){let o=Bo();Zn(o._hasFloatingLabel()?0:-1)}}function O8(a,i){a&1&&nn(0,"div",5)}function N8(a,i){}function B8(a,i){if(a&1&&En(0,N8,0,0,"ng-template",11),a&2){Bo(2);let o=j2(1);Xs("ngTemplateOutlet",o)}}function z8(a,i){if(a&1&&(ti(0,"div",7),En(1,B8,1,1,null,11),Ur()),a&2){let o=Bo();Xs("matFormFieldNotchedOutlineOpen",o._shouldLabelFloat()),Ii(),Zn(o._forceDisplayInfixLabel()?-1:1)}}function j8(a,i){a&1&&(ti(0,"div",8,2),wa(2,2),Ur())}function U8(a,i){a&1&&(ti(0,"div",9,3),wa(2,3),Ur())}function V8(a,i){}function G8(a,i){if(a&1&&En(0,V8,0,0,"ng-template",11),a&2){Bo();let o=j2(1);Xs("ngTemplateOutlet",o)}}function H8(a,i){a&1&&(ti(0,"div",12),wa(1,4),Ur())}function W8(a,i){a&1&&(ti(0,"div",13),wa(1,5),Ur())}function q8(a,i){a&1&&nn(0,"div",14)}function $8(a,i){if(a&1&&(ti(0,"div",16),wa(1,6),Ur()),a&2){let o=Bo();Xs("@transitionMessages",o._subscriptAnimationState)}}function X8(a,i){if(a&1&&(ti(0,"mat-hint",20),Yi(1),Ur()),a&2){let o=Bo(2);Xs("id",o._hintLabelId),Ii(),uh(o.hintLabel)}}function Z8(a,i){if(a&1&&(ti(0,"div",17),En(1,X8,2,2,"mat-hint",20),wa(2,7),nn(3,"div",21),wa(4,8),Ur()),a&2){let o=Bo();Xs("@transitionMessages",o._subscriptAnimationState),Ii(),Zn(o.hintLabel?1:-1)}}var q0=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275dir=pi({type:i,selectors:[["mat-label"]],standalone:!0});let a=i;return a})(),Y8=0,m4=new Hi("MatError"),g4=(()=>{let i=class i{constructor(c,u){this.id=`mat-mdc-error-${Y8++}`,c||u.nativeElement.setAttribute("aria-live","polite")}};i.\u0275fac=function(u){return new(u||i)(S0("aria-live"),Er(Ln))},i.\u0275dir=pi({type:i,selectors:[["mat-error"],["","matError",""]],hostAttrs:["aria-atomic","true",1,"mat-mdc-form-field-error","mat-mdc-form-field-bottom-align"],hostVars:1,hostBindings:function(u,r){u&2&&E0("id",r.id)},inputs:{id:"id"},standalone:!0,features:[Fa([{provide:m4,useExisting:i}])]});let a=i;return a})(),K8=0,s4=(()=>{let i=class i{constructor(){this.align="start",this.id=`mat-mdc-hint-${K8++}`}};i.\u0275fac=function(u){return new(u||i)},i.\u0275dir=pi({type:i,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(u,r){u&2&&(E0("id",r.id),cc("align",null),io("mat-mdc-form-field-hint-end",r.align==="end"))},inputs:{align:"align",id:"id"},standalone:!0});let a=i;return a})(),J8=new Hi("MatPrefix");var Q8=new Hi("MatSuffix");var _4=new Hi("FloatingLabelParent"),l4=(()=>{let i=class i{get floating(){return this._floating}set floating(c){this._floating=c,this.monitorResize&&this._handleResize()}get monitorResize(){return this._monitorResize}set monitorResize(c){this._monitorResize=c,this._monitorResize?this._subscribeToResize():this._resizeSubscription.unsubscribe()}constructor(c){this._elementRef=c,this._floating=!1,this._monitorResize=!1,this._resizeObserver=Jr(o4),this._ngZone=Jr(Tn),this._parent=Jr(_4),this._resizeSubscription=new y0}ngOnDestroy(){this._resizeSubscription.unsubscribe()}getWidth(){return eB(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}_handleResize(){setTimeout(()=>this._parent._handleLabelResized())}_subscribeToResize(){this._resizeSubscription.unsubscribe(),this._ngZone.runOutsideAngular(()=>{this._resizeSubscription=this._resizeObserver.observe(this._elementRef.nativeElement,{box:"border-box"}).subscribe(()=>this._handleResize())})}};i.\u0275fac=function(u){return new(u||i)(Er(Ln))},i.\u0275dir=pi({type:i,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(u,r){u&2&&io("mdc-floating-label--float-above",r.floating)},inputs:{floating:"floating",monitorResize:"monitorResize"},standalone:!0});let a=i;return a})();function eB(a){let i=a;if(i.offsetParent!==null)return i.scrollWidth;let o=i.cloneNode(!0);o.style.setProperty("position","absolute"),o.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(o);let c=o.scrollWidth;return o.remove(),c}var c4="mdc-line-ripple--active",Uy="mdc-line-ripple--deactivating",u4=(()=>{let i=class i{constructor(c,u){this._elementRef=c,this._handleTransitionEnd=r=>{let _=this._elementRef.nativeElement.classList,T=_.contains(Uy);r.propertyName==="opacity"&&T&&_.remove(c4,Uy)},u.runOutsideAngular(()=>{c.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){let c=this._elementRef.nativeElement.classList;c.remove(Uy),c.add(c4)}deactivate(){this._elementRef.nativeElement.classList.add(Uy)}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}};i.\u0275fac=function(u){return new(u||i)(Er(Ln),Er(Tn))},i.\u0275dir=pi({type:i,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"],standalone:!0});let a=i;return a})(),h4=(()=>{let i=class i{constructor(c,u){this._elementRef=c,this._ngZone=u,this.open=!1}ngAfterViewInit(){let c=this._elementRef.nativeElement.querySelector(".mdc-floating-label");c?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),typeof requestAnimationFrame=="function"&&(c.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>c.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_setNotchWidth(c){!this.open||!c?this._notch.nativeElement.style.width="":this._notch.nativeElement.style.width=`calc(${c}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`}};i.\u0275fac=function(u){return new(u||i)(Er(Ln),Er(Tn))},i.\u0275cmp=pa({type:i,selectors:[["div","matFormFieldNotchedOutline",""]],viewQuery:function(u,r){if(u&1&&Vc(E8,5),u&2){let _;Ta(_=Sa())&&(r._notch=_.first)}},hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(u,r){u&2&&io("mdc-notched-outline--notched",r.open)},inputs:{open:[0,"matFormFieldNotchedOutlineOpen","open"]},standalone:!0,features:[ma],attrs:A8,ngContentSelectors:C8,decls:5,vars:0,consts:[["notch",""],[1,"mdc-notched-outline__leading"],[1,"mdc-notched-outline__notch"],[1,"mdc-notched-outline__trailing"]],template:function(u,r){u&1&&(hc(),nn(0,"div",1),ti(1,"div",2,0),wa(3),Ur(),nn(4,"div",3))},encapsulation:2,changeDetection:0});let a=i;return a})(),tB={transitionMessages:JC("transitionMessages",[e3("enter",H2({opacity:1,transform:"translateY(0%)"})),t3("void => enter",[H2({opacity:0,transform:"translateY(-5px)"}),QC("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},y5=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275dir=pi({type:i});let a=i;return a})();var x5=new Hi("MatFormField"),rB=new Hi("MAT_FORM_FIELD_DEFAULT_OPTIONS"),d4=0,f4="fill",iB="auto",p4="fixed",nB="translateY(-50%)",Vy=(()=>{let i=class i{get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(c){this._hideRequiredMarker=dm(c)}get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||iB}set floatLabel(c){c!==this._floatLabel&&(this._floatLabel=c,this._changeDetectorRef.markForCheck())}get appearance(){return this._appearance}set appearance(c){let u=this._appearance,r=c||this._defaults?.appearance||f4;this._appearance=r,this._appearance==="outline"&&this._appearance!==u&&(this._needsOutlineLabelOffsetUpdate=!0)}get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||p4}set subscriptSizing(c){this._subscriptSizing=c||this._defaults?.subscriptSizing||p4}get hintLabel(){return this._hintLabel}set hintLabel(c){this._hintLabel=c,this._processHints()}get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(c){this._explicitFormFieldControl=c}constructor(c,u,r,_,T,E,k,D){this._elementRef=c,this._changeDetectorRef=u,this._dir=_,this._platform=T,this._defaults=E,this._animationMode=k,this._labelChild=OC(q0),this._hideRequiredMarker=!1,this.color="primary",this._appearance=f4,this._subscriptSizing=null,this._hintLabel="",this._hasIconPrefix=!1,this._hasTextPrefix=!1,this._hasIconSuffix=!1,this._hasTextSuffix=!1,this._labelId=`mat-mdc-form-field-label-${d4++}`,this._hintLabelId=`mat-mdc-hint-${d4++}`,this._subscriptAnimationState="",this._destroyed=new Ra,this._isFocused=null,this._needsOutlineLabelOffsetUpdate=!1,this._injector=Jr(op),this.getLabelId=ef(()=>this._hasFloatingLabel()?this._labelId:null),this._hasFloatingLabel=ef(()=>!!this._labelChild()),E&&(E.appearance&&(this.appearance=E.appearance),this._hideRequiredMarker=!!E?.hideRequiredMarker,E.color&&(this.color=E.color))}ngAfterViewInit(){this._updateFocusState(),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(){let c=this._control;c.controlType&&this._elementRef.nativeElement.classList.add(`mat-mdc-form-field-type-${c.controlType}`),c.stateChanges.subscribe(()=>{this._updateFocusState(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),c.ngControl&&c.ngControl.valueChanges&&c.ngControl.valueChanges.pipe(gl(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck())}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(c=>!c._isText),this._hasTextPrefix=!!this._prefixChildren.find(c=>c._isText),this._hasIconSuffix=!!this._suffixChildren.find(c=>!c._isText),this._hasTextSuffix=!!this._suffixChildren.find(c=>c._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),EC(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){this._control}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||this._isFocused===null)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdate=!0),LC(()=>{this._needsOutlineLabelOffsetUpdate&&(this._needsOutlineLabelOffsetUpdate=!1,this._updateOutlineLabelOffset())},{injector:this._injector}),this._dir.change.pipe(gl(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdate=!0)}_shouldAlwaysFloat(){return this.floatLabel==="always"}_hasOutline(){return this.appearance==="outline"}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_shouldLabelFloat(){return this._control.shouldLabelFloat||this._shouldAlwaysFloat()}_shouldForward(c){let u=this._control?this._control.ngControl:null;return u&&u[c]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_handleLabelResized(){this._refreshOutlineNotchWidth()}_refreshOutlineNotchWidth(){!this._hasOutline()||!this._floatingLabel||!this._shouldLabelFloat()?this._notchedOutline?._setNotchWidth(0):this._notchedOutline?._setNotchWidth(this._floatingLabel.getWidth())}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){this._hintChildren}_syncDescribedByIds(){if(this._control){let c=[];if(this._control.userAriaDescribedBy&&typeof this._control.userAriaDescribedBy=="string"&&c.push(...this._control.userAriaDescribedBy.split(" ")),this._getDisplayedMessages()==="hint"){let u=this._hintChildren?this._hintChildren.find(_=>_.align==="start"):null,r=this._hintChildren?this._hintChildren.find(_=>_.align==="end"):null;u?c.push(u.id):this._hintLabel&&c.push(this._hintLabelId),r&&c.push(r.id)}else this._errorChildren&&c.push(...this._errorChildren.map(u=>u.id));this._control.setDescribedByIds(c)}}_updateOutlineLabelOffset(){if(!this._hasOutline()||!this._floatingLabel)return;let c=this._floatingLabel.element;if(!(this._iconPrefixContainer||this._textPrefixContainer)){c.style.transform="";return}if(!this._isAttachedToDom()){this._needsOutlineLabelOffsetUpdate=!0;return}let u=this._iconPrefixContainer?.nativeElement,r=this._textPrefixContainer?.nativeElement,_=u?.getBoundingClientRect().width??0,T=r?.getBoundingClientRect().width??0,E=this._dir.value==="rtl"?"-1":"1",k=`${_+T}px`,j=`calc(${E} * (${k} + var(--mat-mdc-form-field-label-offset-x, 0px)))`;c.style.transform=`var(
        --mat-mdc-form-field-label-transform,
        ${nB} translateX(${j})
    )`}_isAttachedToDom(){let c=this._elementRef.nativeElement;if(c.getRootNode){let u=c.getRootNode();return u&&u!==c}return document.documentElement.contains(c)}};i.\u0275fac=function(u){return new(u||i)(Er(Ln),Er(id),Er(Tn),Er(xy),Er(no),Er(rB,8),Er(Zd,8),Er(aa))},i.\u0275cmp=pa({type:i,selectors:[["mat-form-field"]],contentQueries:function(u,r,_){if(u&1&&(zC(_,r._labelChild,q0,5),Ds(_,y5,5),Ds(_,J8,5),Ds(_,Q8,5),Ds(_,m4,5),Ds(_,s4,5)),u&2){jC();let T;Ta(T=Sa())&&(r._formFieldControl=T.first),Ta(T=Sa())&&(r._prefixChildren=T),Ta(T=Sa())&&(r._suffixChildren=T),Ta(T=Sa())&&(r._errorChildren=T),Ta(T=Sa())&&(r._hintChildren=T)}},viewQuery:function(u,r){if(u&1&&(Vc(I8,5),Vc(k8,5),Vc(M8,5),Vc(l4,5),Vc(h4,5),Vc(u4,5)),u&2){let _;Ta(_=Sa())&&(r._textField=_.first),Ta(_=Sa())&&(r._iconPrefixContainer=_.first),Ta(_=Sa())&&(r._textPrefixContainer=_.first),Ta(_=Sa())&&(r._floatingLabel=_.first),Ta(_=Sa())&&(r._notchedOutline=_.first),Ta(_=Sa())&&(r._lineRipple=_.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(u,r){u&2&&io("mat-mdc-form-field-label-always-float",r._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",r._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",r._hasIconSuffix)("mat-form-field-invalid",r._control.errorState)("mat-form-field-disabled",r._control.disabled)("mat-form-field-autofilled",r._control.autofilled)("mat-form-field-no-animations",r._animationMode==="NoopAnimations")("mat-form-field-appearance-fill",r.appearance=="fill")("mat-form-field-appearance-outline",r.appearance=="outline")("mat-form-field-hide-placeholder",r._hasFloatingLabel()&&!r._shouldLabelFloat())("mat-focused",r._control.focused)("mat-primary",r.color!=="accent"&&r.color!=="warn")("mat-accent",r.color==="accent")("mat-warn",r.color==="warn")("ng-untouched",r._shouldForward("untouched"))("ng-touched",r._shouldForward("touched"))("ng-pristine",r._shouldForward("pristine"))("ng-dirty",r._shouldForward("dirty"))("ng-valid",r._shouldForward("valid"))("ng-invalid",r._shouldForward("invalid"))("ng-pending",r._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],standalone:!0,features:[Fa([{provide:x5,useExisting:i},{provide:_4,useExisting:i}]),ma],ngContentSelectors:R8,decls:18,vars:21,consts:[["labelTemplate",""],["textField",""],["iconPrefixContainer",""],["textPrefixContainer",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],[1,"mat-mdc-form-field-focus-overlay"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen"],[1,"mat-mdc-form-field-icon-prefix"],[1,"mat-mdc-form-field-text-prefix"],[1,"mat-mdc-form-field-infix"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align"],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[3,"id"],[1,"mat-mdc-form-field-hint-spacer"]],template:function(u,r){if(u&1){let _=Wv();hc(D8),En(0,L8,1,1,"ng-template",null,0,UC),ti(2,"div",4,1),hs("click",function(E){return Nv(_),Bv(r._control.onContainerClick(E))}),En(4,O8,1,0,"div",5),ti(5,"div",6),En(6,z8,2,2,"div",7)(7,j8,3,0,"div",8)(8,U8,3,0,"div",9),ti(9,"div",10),En(10,G8,1,1,null,11),wa(11),Ur(),En(12,H8,2,0,"div",12)(13,W8,2,0,"div",13),Ur(),En(14,q8,1,0,"div",14),Ur(),ti(15,"div",15),En(16,$8,2,1,"div",16)(17,Z8,5,2,"div",17),Ur()}if(u&2){let _;Ii(2),io("mdc-text-field--filled",!r._hasOutline())("mdc-text-field--outlined",r._hasOutline())("mdc-text-field--no-label",!r._hasFloatingLabel())("mdc-text-field--disabled",r._control.disabled)("mdc-text-field--invalid",r._control.errorState),Ii(2),Zn(!r._hasOutline()&&!r._control.disabled?4:-1),Ii(2),Zn(r._hasOutline()?6:-1),Ii(),Zn(r._hasIconPrefix?7:-1),Ii(),Zn(r._hasTextPrefix?8:-1),Ii(2),Zn(!r._hasOutline()||r._forceDisplayInfixLabel()?10:-1),Ii(2),Zn(r._hasTextSuffix?12:-1),Ii(),Zn(r._hasIconSuffix?13:-1),Ii(),Zn(r._hasOutline()?-1:14),Ii(),io("mat-mdc-form-field-subscript-dynamic-size",r.subscriptSizing==="dynamic"),Ii(),Zn((_=r._getDisplayedMessages())==="error"?16:_==="hint"?17:-1)}},dependencies:[l4,h4,XC,u4,s4],styles:['.mdc-text-field{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:0;border-bottom-left-radius:0;display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field__input{height:28px;width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}@media all{.mdc-text-field__input::placeholder{opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{opacity:0}}@media all{.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}}@media all{.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}}.mdc-text-field__affix{height:28px;opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}@supports(-webkit-hyphens: none){.mdc-text-field--outlined .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field--filled{height:56px}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}@supports(-webkit-hyphens: none){.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-shape-small, 4px))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small, 4px)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-shape-small, 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-shape-small, 4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mdc-text-field--textarea{flex-direction:column;align-items:center;width:auto;height:auto;padding:0}.mdc-text-field--textarea .mdc-floating-label{top:19px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;resize:none;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--filled::before{display:none}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-10.25px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--filled .mdc-text-field__input{margin-top:23px;margin-bottom:9px}.mdc-text-field--textarea.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label{top:18px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{align-self:flex-end;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field__resizer{align-self:stretch;display:inline-flex;flex-direction:column;flex-grow:1;max-height:100%;max-width:100%;min-height:56px;min-width:fit-content;min-width:-moz-available;min-width:-webkit-fill-available;overflow:hidden;resize:both}.mdc-text-field--filled .mdc-text-field__resizer{transform:translateY(-1px)}.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(-1px) translateY(-1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer,.mdc-text-field--outlined .mdc-text-field__resizer[dir=rtl]{transform:translateX(1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateX(1px) translateY(1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input[dir=rtl],.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter[dir=rtl]{transform:translateX(-1px) translateY(1px)}.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field--with-leading-icon,.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field--with-trailing-icon,.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 64px/0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 96px/0.75)}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}@media screen and (forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled .mdc-text-field__ripple{display:none}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.mdc-floating-label{position:absolute;left:0;-webkit-transform-origin:left top;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0px;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after,.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)[dir=rtl]::after{margin-left:0;margin-right:1px}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;pointer-events:none}.mdc-notched-outline__trailing{flex-grow:1}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{border-top:1px solid;border-bottom:1px solid}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{max-width:calc(100% - 12px*2)}.mdc-line-ripple::before{border-bottom-width:1px}.mdc-line-ripple::after{border-bottom-width:2px}.mdc-text-field--filled{border-top-left-radius:var(--mdc-filled-text-field-container-shape);border-top-right-radius:var(--mdc-filled-text-field-container-shape);border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-caret-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-error-caret-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-filled-text-field-input-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-filled-text-field-disabled-input-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-focus-label-text-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-hover-label-text-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-disabled-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-focus-label-text-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-filled-text-field-error-hover-label-text-color)}.mdc-text-field--filled .mdc-floating-label{font-family:var(--mdc-filled-text-field-label-text-font);font-size:var(--mdc-filled-text-field-label-text-size);font-weight:var(--mdc-filled-text-field-label-text-weight);letter-spacing:var(--mdc-filled-text-field-label-text-tracking)}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color)}}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:var(--mdc-filled-text-field-container-color)}.mdc-text-field--filled.mdc-text-field--disabled{background-color:var(--mdc-filled-text-field-disabled-container-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-hover-active-indicator-color)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-focus-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-disabled-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-hover-active-indicator-color)}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-error-focus-active-indicator-color)}.mdc-text-field--filled .mdc-line-ripple::before{border-bottom-width:var(--mdc-filled-text-field-active-indicator-height)}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-width:var(--mdc-filled-text-field-focus-active-indicator-height)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-caret-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-error-caret-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-outlined-text-field-input-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-outlined-text-field-disabled-input-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-focus-label-text-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-hover-label-text-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-disabled-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-focus-label-text-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label--float-above{color:var(--mdc-outlined-text-field-error-hover-label-text-color)}.mdc-text-field--outlined .mdc-floating-label{font-family:var(--mdc-outlined-text-field-label-text-font);font-size:var(--mdc-outlined-text-field-label-text-size);font-weight:var(--mdc-outlined-text-field-label-text-weight);letter-spacing:var(--mdc-outlined-text-field-label-text-tracking)}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}@media all{.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color)}}.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(.75*var(--mdc-outlined-text-field-label-text-size))}.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mdc-outlined-text-field-label-text-size)}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-outlined-text-field-container-shape))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:var(--mdc-outlined-text-field-container-shape);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px,var(--mdc-outlined-text-field-container-shape))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px,calc(var(--mdc-outlined-text-field-container-shape) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-hover-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-focus-outline-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--disabled .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-disabled-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-hover-outline-color)}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:var(--mdc-outlined-text-field-error-focus-outline-color)}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-outline-width)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-width:var(--mdc-outlined-text-field-focus-outline-width)}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;line-height:normal;pointer-events:all;will-change:auto}.mat-mdc-form-field:not(.mat-form-field-disabled) .mat-mdc-floating-label.mdc-floating-label{cursor:inherit}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto;will-change:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-form-field-disabled .mdc-text-field__input::placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-form-field-disabled .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color)}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-text-field-wrapper::before{content:none}.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:1px solid rgba(0,0,0,0)}[dir=rtl] .mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:none;border-right:1px solid rgba(0,0,0,0)}.mat-mdc-form-field-infix{min-height:var(--mat-form-field-container-height);padding-top:var(--mat-form-field-filled-with-label-container-padding-top);padding-bottom:var(--mat-form-field-filled-with-label-container-padding-bottom)}.mdc-text-field--outlined .mat-mdc-form-field-infix,.mdc-text-field--no-label .mat-mdc-form-field-infix{padding-top:var(--mat-form-field-container-vertical-padding);padding-bottom:var(--mat-form-field-container-vertical-padding)}.mat-mdc-text-field-wrapper .mat-mdc-form-field-flex .mat-mdc-floating-label{top:calc(var(--mat-form-field-container-height)/2)}.mdc-text-field--filled .mat-mdc-floating-label{display:var(--mat-form-field-filled-label-display, block)}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{--mat-mdc-form-field-label-transform: translateY(calc(calc(6.75px + var(--mat-form-field-container-height) / 2) * -1)) scale(var(--mat-mdc-form-field-floating-label-scale, 0.75));transform:var(--mat-mdc-form-field-label-transform)}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block;color:var(--mat-form-field-error-text-color)}.mat-mdc-form-field-subscript-wrapper,.mat-mdc-form-field-bottom-align::before{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-subscript-text-font);line-height:var(--mat-form-field-subscript-text-line-height);font-size:var(--mat-form-field-subscript-text-size);letter-spacing:var(--mat-form-field-subscript-text-tracking);font-weight:var(--mat-form-field-subscript-text-weight)}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none;background-color:var(--mat-form-field-state-layer-color)}.mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-hover-state-layer-opacity)}.mat-mdc-form-field.mat-focused .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-focus-state-layer-opacity)}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option{color:var(--mat-form-field-select-option-text-color)}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option:disabled{color:var(--mat-form-field-select-disabled-option-text-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none;color:var(--mat-form-field-enabled-select-arrow-color)}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select.mat-focused .mat-mdc-form-field-infix::after{color:var(--mat-form-field-focus-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select.mat-form-field-disabled .mat-mdc-form-field-infix::after{color:var(--mat-form-field-disabled-select-arrow-color)}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}.cdk-high-contrast-active .mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-container-text-font);line-height:var(--mat-form-field-container-text-line-height);font-size:var(--mat-form-field-container-text-size);letter-spacing:var(--mat-form-field-container-text-tracking);font-weight:var(--mat-form-field-container-text-weight)}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field .mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(var(--mat-form-field-outlined-label-text-populated-size)*var(--mat-mdc-form-field-floating-label-scale))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mat-form-field-outlined-label-text-populated-size)}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%;z-index:0}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto;position:relative;z-index:1}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:0 12px;box-sizing:content-box}.mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-leading-icon-color)}.mat-form-field-disabled .mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-disabled-leading-icon-color)}.mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-trailing-icon-color)}.mat-form-field-disabled .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-disabled-trailing-icon-color)}.mat-form-field-invalid .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-trailing-icon-color)}.mat-form-field-invalid:not(.mat-focused):not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-hover-trailing-icon-color)}.mat-form-field-invalid.mat-focused .mat-mdc-text-field-wrapper .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-focus-trailing-icon-color)}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__affix{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea{transition:none}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-filled 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-filled{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 10.25px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 24.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - 32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}[dir=rtl] .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}100%{transform:translateX(calc(0% - -32px)) translateY(calc(0% - 34.75px)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}100%{transform:translateX(calc(0% - 0%)) translateY(calc(0% - 106%)) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-notched-outline .mdc-floating-label{max-width:calc(100% + 1px)}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(133.3333333333% + 1px)}'],encapsulation:2,data:{animation:[tB.transitionMessages]},changeDetection:0});let a=i;return a})(),of=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275mod=Vn({type:i}),i.\u0275inj=Un({imports:[Jo,G2,aI,Jo]});let a=i;return a})();var aB=new Hi("MAT_INPUT_VALUE_ACCESSOR"),oB=["button","checkbox","file","hidden","image","radio","range","reset","submit"],sB=0,Gy=(()=>{let i=class i{get disabled(){return this._disabled}set disabled(c){this._disabled=dm(c),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(c){this._id=c||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(So.required)??!1}set required(c){this._required=dm(c)}get type(){return this._type}set type(c){this._type=c||"text",this._validateType(),!this._isTextarea&&Vw().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(c){this._errorStateTracker.matcher=c}get value(){return this._inputValueAccessor.value}set value(c){c!==this.value&&(this._inputValueAccessor.value=c,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(c){this._readonly=dm(c)}get errorState(){return this._errorStateTracker.errorState}set errorState(c){this._errorStateTracker.errorState=c}constructor(c,u,r,_,T,E,k,D,j,B){this._elementRef=c,this._platform=u,this.ngControl=r,this._autofillMonitor=D,this._formField=B,this._uid=`mat-input-${sB++}`,this.focused=!1,this.stateChanges=new Ra,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(G=>Vw().has(G)),this._iOSKeyupListener=G=>{let K=G.target;!K.value&&K.selectionStart===0&&K.selectionEnd===0&&(K.setSelectionRange(1,1),K.setSelectionRange(0,0))};let P=this._elementRef.nativeElement,ee=P.nodeName.toLowerCase();this._inputValueAccessor=k||P,this._previousNativeValue=this.value,this.id=this.id,u.IOS&&j.runOutsideAngular(()=>{c.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._errorStateTracker=new wy(E,r,T,_,this.stateChanges),this._isServer=!this._platform.isBrowser,this._isNativeSelect=ee==="select",this._isTextarea=ee==="textarea",this._isInFormField=!!B,this._isNativeSelect&&(this.controlType=P.multiple?"mat-native-select-multiple":"mat-native-select")}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(c=>{this.autofilled=c.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&(this.updateErrorState(),this.ngControl.disabled!==null&&this.ngControl.disabled!==this.disabled&&(this.disabled=this.ngControl.disabled,this.stateChanges.next())),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(c){this._elementRef.nativeElement.focus(c)}updateErrorState(){this._errorStateTracker.updateErrorState()}_focusChanged(c){c!==this.focused&&(this.focused=c,this.stateChanges.next())}_onInput(){}_dirtyCheckNativeValue(){let c=this._elementRef.nativeElement.value;this._previousNativeValue!==c&&(this._previousNativeValue=c,this.stateChanges.next())}_dirtyCheckPlaceholder(){let c=this._getPlaceholder();if(c!==this._previousPlaceholder){let u=this._elementRef.nativeElement;this._previousPlaceholder=c,c?u.setAttribute("placeholder",c):u.removeAttribute("placeholder")}}_getPlaceholder(){return this.placeholder||null}_validateType(){oB.indexOf(this._type)>-1}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let c=this._elementRef.nativeElement.validity;return c&&c.badInput}get empty(){return!this._isNeverEmpty()&&!this._elementRef.nativeElement.value&&!this._isBadInput()&&!this.autofilled}get shouldLabelFloat(){if(this._isNativeSelect){let c=this._elementRef.nativeElement,u=c.options[0];return this.focused||c.multiple||!this.empty||!!(c.selectedIndex>-1&&u&&u.label)}else return this.focused||!this.empty}setDescribedByIds(c){c.length?this._elementRef.nativeElement.setAttribute("aria-describedby",c.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){let c=this._elementRef.nativeElement;return this._isNativeSelect&&(c.multiple||c.size>1)}};i.\u0275fac=function(u){return new(u||i)(Er(Ln),Er(no),Er(mm,10),Er(d5,8),Er(gm,8),Er(TI),Er(aB,10),Er(kI),Er(Tn),Er(x5,8))},i.\u0275dir=pi({type:i,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-mdc-input-element"],hostVars:18,hostBindings:function(u,r){u&1&&hs("focus",function(){return r._focusChanged(!0)})("blur",function(){return r._focusChanged(!1)})("input",function(){return r._onInput()}),u&2&&(E0("id",r.id)("disabled",r.disabled)("required",r.required),cc("name",r.name||null)("readonly",r.readonly&&!r._isNativeSelect||null)("aria-invalid",r.empty&&r.required?null:r.errorState)("aria-required",r.required)("id",r.id),io("mat-input-server",r._isServer)("mat-mdc-form-field-textarea-control",r._isInFormField&&r._isTextarea)("mat-mdc-form-field-input-control",r._isInFormField)("mdc-text-field__input",r._isInFormField)("mat-mdc-native-select-inline",r._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:[0,"aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],standalone:!0,features:[Fa([{provide:y5,useExisting:i}]),lc]});let a=i;return a})(),$0=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275mod=Vn({type:i}),i.\u0275inj=Un({imports:[Jo,of,of,MI,Jo]});let a=i;return a})();function lB(a,i){if(a&1&&(ti(0,"mat-error"),Yi(1),Ur()),a&2){let o=Bo();Ii(),uh(o.onGenericChanges("estado"))}}function cB(a,i){if(a&1&&(ti(0,"mat-error"),Yi(1),Ur()),a&2){let o=Bo();Ii(),uh(o.onGenericChanges("name"))}}function uB(a,i){if(a&1&&(ti(0,"mat-error"),Yi(1),Ur()),a&2){let o=Bo();Ii(),uh(o.onGenericChanges("city"))}}function hB(a,i){if(a&1&&(ti(0,"mat-error"),Yi(1),Ur()),a&2){let o=Bo();Ii(),uh(o.onGenericChanges("tel"))}}function dB(a,i){if(a&1&&(ti(0,"mat-error"),Yi(1),Ur()),a&2){let o=Bo();Ii(),uh(o.onGenericChanges("colonia"))}}function fB(a,i){if(a&1&&(ti(0,"mat-error"),Yi(1),Ur()),a&2){let o=Bo();Ii(),uh(o.errorEmailMessage())}}function pB(a,i){if(a&1&&(ti(0,"mat-error"),Yi(1),Ur()),a&2){let o=Bo();Ii(),uh(o.onGenericChanges("calle"))}}function mB(a,i){if(a&1&&(ti(0,"mat-error"),Yi(1),Ur()),a&2){let o=Bo();Ii(),uh(o.errorCpMessage())}}var x4=(()=>{let i=class i{constructor(c){this.fb=c,this.form=this.fb.group({id:["",So.required],email:["",[So.required,So.email]],name:["",So.required],tel:["",So.required,So.maxLength(10),So.minLength(10)],createdAt:["",So.required],reference:["",So.required],city:["",So.required],estado:["",So.required],calle:["",So.required],colonia:["",So.required],cp:["",So.required,So.pattern(/^[0-9]{5}$/)]}),this.errorEmailMessage=Kd(""),this.errorCpMessage=Kd("")}ngOnInit(){this.onEmailChanges(),this.onCpChanges()}onEmailChanges(){this.form.get("email").valueChanges.subscribe(()=>this.emailErrorMessage)}onCpChanges(){this.form.get("cp").valueChanges.subscribe(()=>this.cpErrorMessage)}onGenericChanges(c){let u=this.form.get(c);return"Este campo es obligatorio"}get emailControl(){return this.form.get("email")}get cpControl(){return this.form.get("cp")}get emailErrorMessage(){return this.emailControl.hasError("required")?this.errorEmailMessage.set("El correo electr\xF3nico es obligatorio"):this.emailControl.hasError("email")&&this.errorEmailMessage.set("El formato del correo electr\xF3nico no es v\xE1lido."),!1}get cpErrorMessage(){return this.cpControl.hasError("required")?this.errorCpMessage.set("el campo es obligatorio"):this.cpControl.hasError("pattern")&&this.errorCpMessage.set("El formato es incorrecto"),!1}};i.patternForPostalCode="/^[0-9]{5}$/",i.\u0275fac=function(u){return new(u||i)(Er(zy))},i.\u0275cmp=pa({type:i,selectors:[["app-register-form"]],standalone:!0,features:[ma],decls:61,vars:9,consts:[[3,"formGroup"],["appearance","fill"],["matInput","","placeholder","","formControlName","id","readonly","true"],["matInput","","placeholder","","formControlName","estado","readonly","true"],["appearance","outline"],["matInput","","placeholder","","formControlName","name"],["matInput","","placeholder","","formControlName","city"],["matInput","","placeholder","","formControlName","tel","minlength","10","maxlength","10"],["matInput","","placeholder","","formControlName","colonia"],["matInput","","placeholder","","formControlName","email","email","true"],["matInput","","placeholder","","formControlName","calle"],["matInput","","placeholder","","formControlName","createdAt","readonly","createdAt"],["matInput","","placeholder","","formControlName","cp","maxlength","5","minlength","5"],["matInput","","placeholder","","formControlName","reference"],["mat-button",""]],template:function(u,r){u&1&&(ti(0,"form",0)(1,"mat-form-field",1)(2,"mat-label"),Yi(3,"ID Client"),Ur(),nn(4,"input",2),Ur(),ti(5,"mat-form-field",1)(6,"mat-label"),Yi(7,"Estado"),Ur(),nn(8,"input",3),En(9,lB,2,1,"mat-error"),Ur(),nn(10,"br"),ti(11,"mat-form-field",4)(12,"mat-label"),Yi(13,"Nombres / Apellidos "),Ur(),nn(14,"input",5),En(15,cB,2,1,"mat-error"),Ur(),ti(16,"mat-form-field",4)(17,"mat-label"),Yi(18,"Municipio"),Ur(),nn(19,"input",6),En(20,uB,2,1,"mat-error"),Ur(),nn(21,"br"),ti(22,"mat-form-field",4)(23,"mat-label"),Yi(24,"Telefono"),Ur(),nn(25,"input",7),En(26,hB,2,1,"mat-error"),Ur(),ti(27,"mat-form-field",4)(28,"mat-label"),Yi(29,"colonia"),Ur(),nn(30,"input",8),En(31,dB,2,1,"mat-error"),Ur(),nn(32,"br"),ti(33,"mat-form-field",4)(34,"mat-label"),Yi(35,"Correo"),Ur(),nn(36,"input",9),En(37,fB,2,1,"mat-error"),Ur(),ti(38,"mat-form-field",4)(39,"mat-label"),Yi(40,"calle"),Ur(),nn(41,"input",10),En(42,pB,2,1,"mat-error"),Ur(),nn(43,"br"),ti(44,"mat-form-field",1)(45,"mat-label"),Yi(46,"Fecha de Creacion"),Ur(),nn(47,"input",11),Ur(),ti(48,"mat-form-field",4)(49,"mat-label"),Yi(50,"Codigo Postal"),Ur(),nn(51,"input",12),En(52,mB,2,1,"mat-error"),Ur(),nn(53,"br"),ti(54,"mat-form-field",4)(55,"mat-label"),Yi(56,"Referencia"),Ur(),nn(57,"input",13),Ur(),ti(58,"span")(59,"button",14),Yi(60,"Aceptar"),Ur()()()),u&2&&(Xs("formGroup",r.form),Ii(9),Zn(r.form.get("estado").invalid?9:-1),Ii(6),Zn(r.form.get("name").invalid?15:-1),Ii(5),Zn(r.form.get("city").invalid?20:-1),Ii(6),Zn(r.form.get("tel").invalid?26:-1),Ii(5),Zn(r.form.get("colonia").invalid?31:-1),Ii(6),Zn(r.emailControl.invalid?37:-1),Ii(5),Zn(r.form.get("calle").invalid?42:-1),Ii(10),Zn(r.cpControl.invalid?52:-1))},dependencies:[Ey,up,cp,Sy,$0,Gy,Vy,q0,g4,of,jy,By,H0,Ly,Oy,m5,g5,p5,gm,Z_],styles:["mat-form-field[_ngcontent-%COMP%]{margin:1em}span[_ngcontent-%COMP%]{margin:5em}"],changeDetection:0});let a=i;return a})();var Hy=xC(w4());var T4={mapbox_key:"pk.eyJ1IjoiYWxvbnNvLXNtaXRoIiwiYSI6ImNseWthbzNwMDB5NXMycXB3MmF0djdybTYifQ.ISu2pAOqs_Rn-v6ekD5Fmg",production:!1};var gB=["map"],S4=(()=>{let i=class i{constructor(c){this.fb=c,this.cordenadas=this.fb.group({x:["",So.required],y:["",So.required]})}ngAfterViewInit(){if(!this.divMap?.nativeElement)throw"Map Div not found";Hy.default.accessToken=T4.mapbox_key,new Hy.default.Map({container:this.divMap.nativeElement,style:"mapbox://styles/mapbox/streets-v12",center:[10,12],zoom:9,interactive:!0,attributionControl:!1}).addControl(new Hy.default.NavigationControl)}setCordenadas(){let c=this.cordenadas.getRawValue();console.log(c)}};i.\u0275fac=function(u){return new(u||i)(Er(zy))},i.\u0275cmp=pa({type:i,selectors:[["app-mapp-box"]],viewQuery:function(u,r){if(u&1&&Vc(gB,5),u&2){let _;Ta(_=Sa())&&(r.divMap=_.first)}},inputs:{lngLat:"lngLat"},standalone:!0,features:[ma],decls:13,vars:1,consts:[["map",""],["id","mapContainer"],[3,"formGroup"],["appearance","outline"],["matInput","","formControlName","x","onlyNumbers",""],["matInput","","formControlName","y","onlyNumbers",""],["mat-button","",3,"click"]],template:function(u,r){if(u&1){let _=Wv();nn(0,"div",1,0),ti(2,"form",2)(3,"mat-form-field",3)(4,"mat-label"),Yi(5,"X :"),Ur(),nn(6,"input",4),Ur(),ti(7,"mat-form-field",3)(8,"mat-label"),Yi(9,"Y : "),Ur(),nn(10,"input",5),Ur(),ti(11,"button",6),hs("click",function(){return Nv(_),Bv(r.setCordenadas())}),Yi(12,"Buscar"),Ur()()}u&2&&(Ii(2),Xs("formGroup",r.cordenadas))},dependencies:[of,Vy,q0,jy,By,H0,Ly,Oy,gm,Z_,$0,Gy,up,cp],styles:["#mapContainer[_ngcontent-%COMP%]{border-radius:20px;overflow:hidden;width:40vw;height:36vw}mat-form-field[_ngcontent-%COMP%]{padding:2em 1em}"]});let a=i;return a})();function Wy(a){return a&&typeof a.connect=="function"&&!(a instanceof s_)}var X0=function(a){return a[a.REPLACED=0]="REPLACED",a[a.INSERTED=1]="INSERTED",a[a.MOVED=2]="MOVED",a[a.REMOVED=3]="REMOVED",a}(X0||{}),Y_=new Hi("_ViewRepeater"),Z0=class{applyChanges(i,o,c,u,r){i.forEachOperation((_,T,E)=>{let k,D;if(_.previousIndex==null){let j=c(_,T,E);k=o.createEmbeddedView(j.templateRef,j.context,j.index),D=X0.INSERTED}else E==null?(o.remove(T),D=X0.REMOVED):(k=o.get(T),o.move(k,E),D=X0.MOVED);r&&r({context:k?.context,operation:D,record:_})})}detach(){}};var _B=20,C4=(()=>{let i=class i{constructor(c,u,r){this._platform=c,this._change=new Ra,this._changeListener=_=>{this._change.next(_)},this._document=r,u.runOutsideAngular(()=>{if(c.isBrowser){let _=this._getWindow();_.addEventListener("resize",this._changeListener),_.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){let c=this._getWindow();c.removeEventListener("resize",this._changeListener),c.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let c={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),c}getViewportRect(){let c=this.getViewportScrollPosition(),{width:u,height:r}=this.getViewportSize();return{top:c.top,left:c.left,bottom:c.top+r,right:c.left+u,height:r,width:u}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let c=this._document,u=this._getWindow(),r=c.documentElement,_=r.getBoundingClientRect(),T=-_.top||c.body.scrollTop||u.scrollY||r.scrollTop||0,E=-_.left||c.body.scrollLeft||u.scrollX||r.scrollLeft||0;return{top:T,left:E}}change(c=_B){return c>0?this._change.pipe(AC(c)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let c=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:c.innerWidth,height:c.innerHeight}:{width:0,height:0}}};i.\u0275fac=function(u){return new(u||i)(bi(no),bi(Tn),bi(aa,8))},i.\u0275prov=Li({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();var E4=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275mod=Vn({type:i}),i.\u0275inj=Un({});let a=i;return a})(),I4=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275mod=Vn({type:i}),i.\u0275inj=Un({imports:[z0,E4,z0,E4]});let a=i;return a})();var xB=[[["caption"]],[["colgroup"],["col"]],"*"],bB=["caption","colgroup, col","*"];function wB(a,i){a&1&&wa(0,2)}function TB(a,i){a&1&&(ti(0,"thead",0),uc(1,1),Ur(),ti(2,"tbody",0),uc(3,2)(4,3),Ur(),ti(5,"tfoot",0),uc(6,4),Ur())}function SB(a,i){a&1&&uc(0,1)(1,2)(2,3)(3,4)}var dh=new Hi("CDK_TABLE");var Ky=(()=>{let i=class i{constructor(c){this.template=c}};i.\u0275fac=function(u){return new(u||i)(Er(td))},i.\u0275dir=pi({type:i,selectors:[["","cdkCellDef",""]],standalone:!0});let a=i;return a})(),Jy=(()=>{let i=class i{constructor(c){this.template=c}};i.\u0275fac=function(u){return new(u||i)(Er(td))},i.\u0275dir=pi({type:i,selectors:[["","cdkHeaderCellDef",""]],standalone:!0});let a=i;return a})(),D4=(()=>{let i=class i{constructor(c){this.template=c}};i.\u0275fac=function(u){return new(u||i)(Er(td))},i.\u0275dir=pi({type:i,selectors:[["","cdkFooterCellDef",""]],standalone:!0});let a=i;return a})(),Y0=(()=>{let i=class i{get name(){return this._name}set name(c){this._setNameInput(c)}get sticky(){return this._sticky}set sticky(c){c!==this._sticky&&(this._sticky=c,this._hasStickyChanged=!0)}get stickyEnd(){return this._stickyEnd}set stickyEnd(c){c!==this._stickyEnd&&(this._stickyEnd=c,this._hasStickyChanged=!0)}constructor(c){this._table=c,this._hasStickyChanged=!1,this._sticky=!1,this._stickyEnd=!1}hasStickyChanged(){let c=this._hasStickyChanged;return this.resetStickyChanged(),c}resetStickyChanged(){this._hasStickyChanged=!1}_updateColumnCssClassName(){this._columnCssClassName=[`cdk-column-${this.cssClassFriendlyName}`]}_setNameInput(c){c&&(this._name=c,this.cssClassFriendlyName=c.replace(/[^a-z0-9_-]/gi,"-"),this._updateColumnCssClassName())}};i.\u0275fac=function(u){return new(u||i)(Er(dh,8))},i.\u0275dir=pi({type:i,selectors:[["","cdkColumnDef",""]],contentQueries:function(u,r,_){if(u&1&&(Ds(_,Ky,5),Ds(_,Jy,5),Ds(_,D4,5)),u&2){let T;Ta(T=Sa())&&(r.cell=T.first),Ta(T=Sa())&&(r.headerCell=T.first),Ta(T=Sa())&&(r.footerCell=T.first)}},inputs:{name:[0,"cdkColumnDef","name"],sticky:[2,"sticky","sticky",ds],stickyEnd:[2,"stickyEnd","stickyEnd",ds]},standalone:!0,features:[Fa([{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:i}]),_l]});let a=i;return a})(),$y=class{constructor(i,o){o.nativeElement.classList.add(...i._columnCssClassName)}},R4=(()=>{let i=class i extends $y{constructor(c,u){super(c,u)}};i.\u0275fac=function(u){return new(u||i)(Er(Y0),Er(Ln))},i.\u0275dir=pi({type:i,selectors:[["cdk-header-cell"],["th","cdk-header-cell",""]],hostAttrs:["role","columnheader",1,"cdk-header-cell"],standalone:!0,features:[na]});let a=i;return a})();var F4=(()=>{let i=class i extends $y{constructor(c,u){super(c,u);let r=c._table?._getCellRole();r&&u.nativeElement.setAttribute("role",r)}};i.\u0275fac=function(u){return new(u||i)(Er(Y0),Er(Ln))},i.\u0275dir=pi({type:i,selectors:[["cdk-cell"],["td","cdk-cell",""]],hostAttrs:[1,"cdk-cell"],standalone:!0,features:[na]});let a=i;return a})(),Xy=class{constructor(){this.tasks=[],this.endTasks=[]}},Zy=new Hi("_COALESCED_STYLE_SCHEDULER"),S5=(()=>{let i=class i{constructor(c){this._currentSchedule=null,this._ngZone=Jr(Tn)}schedule(c){this._createScheduleIfNeeded(),this._currentSchedule.tasks.push(c)}scheduleEnd(c){this._createScheduleIfNeeded(),this._currentSchedule.endTasks.push(c)}_createScheduleIfNeeded(){this._currentSchedule||(this._currentSchedule=new Xy,this._ngZone.runOutsideAngular(()=>queueMicrotask(()=>{for(;this._currentSchedule.tasks.length||this._currentSchedule.endTasks.length;){let c=this._currentSchedule;this._currentSchedule=new Xy;for(let u of c.tasks)u();for(let u of c.endTasks)u()}this._currentSchedule=null})))}};i.\u0275fac=function(u){return new(u||i)(bi(Tn))},i.\u0275prov=Li({token:i,factory:i.\u0275fac});let a=i;return a})();var E5=(()=>{let i=class i{constructor(c,u){this.template=c,this._differs=u}ngOnChanges(c){if(!this._columnsDiffer){let u=c.columns&&c.columns.currentValue||[];this._columnsDiffer=this._differs.find(u).create(),this._columnsDiffer.diff(u)}}getColumnsDiff(){return this._columnsDiffer.diff(this.columns)}extractCellTemplate(c){return this instanceof K_?c.headerCell.template:this instanceof A5?c.footerCell.template:c.cell.template}};i.\u0275fac=function(u){return new(u||i)(Er(td),Er(sm))},i.\u0275dir=pi({type:i,features:[lc]});let a=i;return a})(),K_=(()=>{let i=class i extends E5{get sticky(){return this._sticky}set sticky(c){c!==this._sticky&&(this._sticky=c,this._hasStickyChanged=!0)}constructor(c,u,r){super(c,u),this._table=r,this._hasStickyChanged=!1,this._sticky=!1}ngOnChanges(c){super.ngOnChanges(c)}hasStickyChanged(){let c=this._hasStickyChanged;return this.resetStickyChanged(),c}resetStickyChanged(){this._hasStickyChanged=!1}};i.\u0275fac=function(u){return new(u||i)(Er(td),Er(sm),Er(dh,8))},i.\u0275dir=pi({type:i,selectors:[["","cdkHeaderRowDef",""]],inputs:{columns:[0,"cdkHeaderRowDef","columns"],sticky:[2,"cdkHeaderRowDefSticky","sticky",ds]},standalone:!0,features:[_l,na,lc]});let a=i;return a})(),A5=(()=>{let i=class i extends E5{get sticky(){return this._sticky}set sticky(c){c!==this._sticky&&(this._sticky=c,this._hasStickyChanged=!0)}constructor(c,u,r){super(c,u),this._table=r,this._hasStickyChanged=!1,this._sticky=!1}ngOnChanges(c){super.ngOnChanges(c)}hasStickyChanged(){let c=this._hasStickyChanged;return this.resetStickyChanged(),c}resetStickyChanged(){this._hasStickyChanged=!1}};i.\u0275fac=function(u){return new(u||i)(Er(td),Er(sm),Er(dh,8))},i.\u0275dir=pi({type:i,selectors:[["","cdkFooterRowDef",""]],inputs:{columns:[0,"cdkFooterRowDef","columns"],sticky:[2,"cdkFooterRowDefSticky","sticky",ds]},standalone:!0,features:[_l,na,lc]});let a=i;return a})(),Qy=(()=>{let i=class i extends E5{constructor(c,u,r){super(c,u),this._table=r}};i.\u0275fac=function(u){return new(u||i)(Er(td),Er(sm),Er(dh,8))},i.\u0275dir=pi({type:i,selectors:[["","cdkRowDef",""]],inputs:{columns:[0,"cdkRowDefColumns","columns"],when:[0,"cdkRowDefWhen","when"]},standalone:!0,features:[na]});let a=i;return a})(),_m=(()=>{let i=class i{constructor(c){this._viewContainer=c,i.mostRecentCellOutlet=this}ngOnDestroy(){i.mostRecentCellOutlet===this&&(i.mostRecentCellOutlet=null)}};i.mostRecentCellOutlet=null,i.\u0275fac=function(u){return new(u||i)(Er(Yd))},i.\u0275dir=pi({type:i,selectors:[["","cdkCellOutlet",""]],standalone:!0});let a=i;return a})(),C5=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275cmp=pa({type:i,selectors:[["cdk-header-row"],["tr","cdk-header-row",""]],hostAttrs:["role","row",1,"cdk-header-row"],standalone:!0,features:[ma],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(u,r){u&1&&uc(0,0)},dependencies:[_m],encapsulation:2});let a=i;return a})();var I5=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275cmp=pa({type:i,selectors:[["cdk-row"],["tr","cdk-row",""]],hostAttrs:["role","row",1,"cdk-row"],standalone:!0,features:[ma],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(u,r){u&1&&uc(0,0)},dependencies:[_m],encapsulation:2});let a=i;return a})(),P4=(()=>{let i=class i{constructor(c){this.templateRef=c,this._contentClassName="cdk-no-data-row"}};i.\u0275fac=function(u){return new(u||i)(Er(td))},i.\u0275dir=pi({type:i,selectors:[["ng-template","cdkNoDataRow",""]],standalone:!0});let a=i;return a})(),k4=["top","bottom","left","right"],T5=class{constructor(i,o,c,u,r=!0,_=!0,T){this._isNativeHtmlTable=i,this._stickCellCss=o,this.direction=c,this._coalescedStyleScheduler=u,this._isBrowser=r,this._needsPositionStickyOnElement=_,this._positionListener=T,this._cachedCellWidths=[],this._borderCellCss={top:`${o}-border-elem-top`,bottom:`${o}-border-elem-bottom`,left:`${o}-border-elem-left`,right:`${o}-border-elem-right`}}clearStickyPositioning(i,o){let c=[];for(let u of i)if(u.nodeType===u.ELEMENT_NODE){c.push(u);for(let r=0;r<u.children.length;r++)c.push(u.children[r])}this._coalescedStyleScheduler.schedule(()=>{for(let u of c)this._removeStickyStyle(u,o)})}updateStickyColumns(i,o,c,u=!0){if(!i.length||!this._isBrowser||!(o.some(r=>r)||c.some(r=>r))){this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:[]}),this._positionListener.stickyEndColumnsUpdated({sizes:[]}));return}this._coalescedStyleScheduler.schedule(()=>{let r=i[0],_=r.children.length,T=this._getCellWidths(r,u),E=this._getStickyStartColumnPositions(T,o),k=this._getStickyEndColumnPositions(T,c),D=o.lastIndexOf(!0),j=c.indexOf(!0),B=this.direction==="rtl",P=B?"right":"left",ee=B?"left":"right";for(let G of i)for(let K=0;K<_;K++){let J=G.children[K];o[K]&&this._addStickyStyle(J,P,E[K],K===D),c[K]&&this._addStickyStyle(J,ee,k[K],K===j)}this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:D===-1?[]:T.slice(0,D+1).map((G,K)=>o[K]?G:null)}),this._positionListener.stickyEndColumnsUpdated({sizes:j===-1?[]:T.slice(j).map((G,K)=>c[K+j]?G:null).reverse()}))})}stickRows(i,o,c){this._isBrowser&&this._coalescedStyleScheduler.schedule(()=>{let u=c==="bottom"?i.slice().reverse():i,r=c==="bottom"?o.slice().reverse():o,_=[],T=[],E=[];for(let D=0,j=0;D<u.length;D++){if(!r[D])continue;_[D]=j;let B=u[D];E[D]=this._isNativeHtmlTable?Array.from(B.children):[B];let P=B.getBoundingClientRect().height;j+=P,T[D]=P}let k=r.lastIndexOf(!0);for(let D=0;D<u.length;D++){if(!r[D])continue;let j=_[D],B=D===k;for(let P of E[D])this._addStickyStyle(P,c,j,B)}c==="top"?this._positionListener?.stickyHeaderRowsUpdated({sizes:T,offsets:_,elements:E}):this._positionListener?.stickyFooterRowsUpdated({sizes:T,offsets:_,elements:E})})}updateStickyFooterContainer(i,o){this._isNativeHtmlTable&&this._coalescedStyleScheduler.schedule(()=>{let c=i.querySelector("tfoot");c&&(o.some(u=>!u)?this._removeStickyStyle(c,["bottom"]):this._addStickyStyle(c,"bottom",0,!1))})}_removeStickyStyle(i,o){for(let u of o)i.style[u]="",i.classList.remove(this._borderCellCss[u]);k4.some(u=>o.indexOf(u)===-1&&i.style[u])?i.style.zIndex=this._getCalculatedZIndex(i):(i.style.zIndex="",this._needsPositionStickyOnElement&&(i.style.position=""),i.classList.remove(this._stickCellCss))}_addStickyStyle(i,o,c,u){i.classList.add(this._stickCellCss),u&&i.classList.add(this._borderCellCss[o]),i.style[o]=`${c}px`,i.style.zIndex=this._getCalculatedZIndex(i),this._needsPositionStickyOnElement&&(i.style.cssText+="position: -webkit-sticky; position: sticky; ")}_getCalculatedZIndex(i){let o={top:100,bottom:10,left:1,right:1},c=0;for(let u of k4)i.style[u]&&(c+=o[u]);return c?`${c}`:""}_getCellWidths(i,o=!0){if(!o&&this._cachedCellWidths.length)return this._cachedCellWidths;let c=[],u=i.children;for(let r=0;r<u.length;r++){let _=u[r];c.push(_.getBoundingClientRect().width)}return this._cachedCellWidths=c,c}_getStickyStartColumnPositions(i,o){let c=[],u=0;for(let r=0;r<i.length;r++)o[r]&&(c[r]=u,u+=i[r]);return c}_getStickyEndColumnPositions(i,o){let c=[],u=0;for(let r=i.length;r>0;r--)o[r]&&(c[r]=u,u+=i[r]);return c}};var Yy=new Hi("CDK_SPL");var k5=(()=>{let i=class i{constructor(c,u){this.viewContainer=c,this.elementRef=u;let r=Jr(dh);r._rowOutlet=this,r._outletAssigned()}};i.\u0275fac=function(u){return new(u||i)(Er(Yd),Er(Ln))},i.\u0275dir=pi({type:i,selectors:[["","rowOutlet",""]],standalone:!0});let a=i;return a})(),M5=(()=>{let i=class i{constructor(c,u){this.viewContainer=c,this.elementRef=u;let r=Jr(dh);r._headerRowOutlet=this,r._outletAssigned()}};i.\u0275fac=function(u){return new(u||i)(Er(Yd),Er(Ln))},i.\u0275dir=pi({type:i,selectors:[["","headerRowOutlet",""]],standalone:!0});let a=i;return a})(),D5=(()=>{let i=class i{constructor(c,u){this.viewContainer=c,this.elementRef=u;let r=Jr(dh);r._footerRowOutlet=this,r._outletAssigned()}};i.\u0275fac=function(u){return new(u||i)(Er(Yd),Er(Ln))},i.\u0275dir=pi({type:i,selectors:[["","footerRowOutlet",""]],standalone:!0});let a=i;return a})(),R5=(()=>{let i=class i{constructor(c,u){this.viewContainer=c,this.elementRef=u;let r=Jr(dh);r._noDataRowOutlet=this,r._outletAssigned()}};i.\u0275fac=function(u){return new(u||i)(Er(Yd),Er(Ln))},i.\u0275dir=pi({type:i,selectors:[["","noDataRowOutlet",""]],standalone:!0});let a=i;return a})();var F5=(()=>{let i=class i{_getCellRole(){if(this._cellRoleInternal===void 0){let c=this._elementRef.nativeElement.getAttribute("role"),u=c==="grid"||c==="treegrid"?"gridcell":"cell";this._cellRoleInternal=this._isNativeHtmlTable&&u==="cell"?null:u}return this._cellRoleInternal}get trackBy(){return this._trackByFn}set trackBy(c){this._trackByFn=c}get dataSource(){return this._dataSource}set dataSource(c){this._dataSource!==c&&this._switchDataSource(c)}get multiTemplateDataRows(){return this._multiTemplateDataRows}set multiTemplateDataRows(c){this._multiTemplateDataRows=c,this._rowOutlet&&this._rowOutlet.viewContainer.length&&(this._forceRenderDataRows(),this.updateStickyColumnStyles())}get fixedLayout(){return this._fixedLayout}set fixedLayout(c){this._fixedLayout=c,this._forceRecalculateCellWidths=!0,this._stickyColumnStylesNeedReset=!0}constructor(c,u,r,_,T,E,k,D,j,B,P,ee){this._differs=c,this._changeDetectorRef=u,this._elementRef=r,this._dir=T,this._platform=k,this._viewRepeater=D,this._coalescedStyleScheduler=j,this._viewportRuler=B,this._stickyPositioningListener=P,this._onDestroy=new Ra,this._columnDefsByName=new Map,this._customColumnDefs=new Set,this._customRowDefs=new Set,this._customHeaderRowDefs=new Set,this._customFooterRowDefs=new Set,this._headerRowDefChanged=!0,this._footerRowDefChanged=!0,this._stickyColumnStylesNeedReset=!0,this._forceRecalculateCellWidths=!0,this._cachedRenderRowsMap=new Map,this.stickyCssClass="cdk-table-sticky",this.needsPositionStickyOnElement=!0,this._isShowingNoDataRow=!1,this._hasAllOutlets=!1,this._hasInitialized=!1,this._cellRoleInternal=void 0,this._multiTemplateDataRows=!1,this._fixedLayout=!1,this.contentChanged=new $s,this.viewChange=new ml({start:0,end:Number.MAX_VALUE}),this._injector=Jr(op),_||r.nativeElement.setAttribute("role","table"),this._document=E,this._isServer=!k.isBrowser,this._isNativeHtmlTable=r.nativeElement.nodeName==="TABLE"}ngOnInit(){this._setupStickyStyler(),this._dataDiffer=this._differs.find([]).create((c,u)=>this.trackBy?this.trackBy(u.dataIndex,u.data):u),this._viewportRuler.change().pipe(gl(this._onDestroy)).subscribe(()=>{this._forceRecalculateCellWidths=!0})}ngAfterContentInit(){this._hasInitialized=!0}ngAfterContentChecked(){this._canRender()&&this._render()}ngOnDestroy(){[this._rowOutlet?.viewContainer,this._headerRowOutlet?.viewContainer,this._footerRowOutlet?.viewContainer,this._cachedRenderRowsMap,this._customColumnDefs,this._customRowDefs,this._customHeaderRowDefs,this._customFooterRowDefs,this._columnDefsByName].forEach(c=>{c?.clear()}),this._headerRowDefs=[],this._footerRowDefs=[],this._defaultRowDef=null,this._onDestroy.next(),this._onDestroy.complete(),Wy(this.dataSource)&&this.dataSource.disconnect(this)}renderRows(){this._renderRows=this._getAllRenderRows();let c=this._dataDiffer.diff(this._renderRows);if(!c){this._updateNoDataRow(),this.contentChanged.next();return}let u=this._rowOutlet.viewContainer;this._viewRepeater.applyChanges(c,u,(r,_,T)=>this._getEmbeddedViewArgs(r.item,T),r=>r.item.data,r=>{r.operation===X0.INSERTED&&r.context&&this._renderCellTemplateForItem(r.record.item.rowDef,r.context)}),this._updateRowIndexContext(),c.forEachIdentityChange(r=>{let _=u.get(r.currentIndex);_.context.$implicit=r.item.data}),this._updateNoDataRow(),Hv(()=>{this.updateStickyColumnStyles()},{injector:this._injector}),this.contentChanged.next()}addColumnDef(c){this._customColumnDefs.add(c)}removeColumnDef(c){this._customColumnDefs.delete(c)}addRowDef(c){this._customRowDefs.add(c)}removeRowDef(c){this._customRowDefs.delete(c)}addHeaderRowDef(c){this._customHeaderRowDefs.add(c),this._headerRowDefChanged=!0}removeHeaderRowDef(c){this._customHeaderRowDefs.delete(c),this._headerRowDefChanged=!0}addFooterRowDef(c){this._customFooterRowDefs.add(c),this._footerRowDefChanged=!0}removeFooterRowDef(c){this._customFooterRowDefs.delete(c),this._footerRowDefChanged=!0}setNoDataRow(c){this._customNoDataRow=c}updateStickyHeaderRowStyles(){let c=this._getRenderedRows(this._headerRowOutlet);if(this._isNativeHtmlTable){let r=M4(this._headerRowOutlet,"thead");r&&(r.style.display=c.length?"":"none")}let u=this._headerRowDefs.map(r=>r.sticky);this._stickyStyler.clearStickyPositioning(c,["top"]),this._stickyStyler.stickRows(c,u,"top"),this._headerRowDefs.forEach(r=>r.resetStickyChanged())}updateStickyFooterRowStyles(){let c=this._getRenderedRows(this._footerRowOutlet);if(this._isNativeHtmlTable){let r=M4(this._footerRowOutlet,"tfoot");r&&(r.style.display=c.length?"":"none")}let u=this._footerRowDefs.map(r=>r.sticky);this._stickyStyler.clearStickyPositioning(c,["bottom"]),this._stickyStyler.stickRows(c,u,"bottom"),this._stickyStyler.updateStickyFooterContainer(this._elementRef.nativeElement,u),this._footerRowDefs.forEach(r=>r.resetStickyChanged())}updateStickyColumnStyles(){let c=this._getRenderedRows(this._headerRowOutlet),u=this._getRenderedRows(this._rowOutlet),r=this._getRenderedRows(this._footerRowOutlet);(this._isNativeHtmlTable&&!this._fixedLayout||this._stickyColumnStylesNeedReset)&&(this._stickyStyler.clearStickyPositioning([...c,...u,...r],["left","right"]),this._stickyColumnStylesNeedReset=!1),c.forEach((_,T)=>{this._addStickyColumnStyles([_],this._headerRowDefs[T])}),this._rowDefs.forEach(_=>{let T=[];for(let E=0;E<u.length;E++)this._renderRows[E].rowDef===_&&T.push(u[E]);this._addStickyColumnStyles(T,_)}),r.forEach((_,T)=>{this._addStickyColumnStyles([_],this._footerRowDefs[T])}),Array.from(this._columnDefsByName.values()).forEach(_=>_.resetStickyChanged())}_outletAssigned(){!this._hasAllOutlets&&this._rowOutlet&&this._headerRowOutlet&&this._footerRowOutlet&&this._noDataRowOutlet&&(this._hasAllOutlets=!0,this._canRender()&&this._render())}_canRender(){return this._hasAllOutlets&&this._hasInitialized}_render(){this._cacheRowDefs(),this._cacheColumnDefs(),!this._headerRowDefs.length&&!this._footerRowDefs.length&&this._rowDefs.length;let u=this._renderUpdatedColumns()||this._headerRowDefChanged||this._footerRowDefChanged;this._stickyColumnStylesNeedReset=this._stickyColumnStylesNeedReset||u,this._forceRecalculateCellWidths=u,this._headerRowDefChanged&&(this._forceRenderHeaderRows(),this._headerRowDefChanged=!1),this._footerRowDefChanged&&(this._forceRenderFooterRows(),this._footerRowDefChanged=!1),this.dataSource&&this._rowDefs.length>0&&!this._renderChangeSubscription?this._observeRenderChanges():this._stickyColumnStylesNeedReset&&this.updateStickyColumnStyles(),this._checkStickyStates()}_getAllRenderRows(){let c=[],u=this._cachedRenderRowsMap;this._cachedRenderRowsMap=new Map;for(let r=0;r<this._data.length;r++){let _=this._data[r],T=this._getRenderRowsForData(_,r,u.get(_));this._cachedRenderRowsMap.has(_)||this._cachedRenderRowsMap.set(_,new WeakMap);for(let E=0;E<T.length;E++){let k=T[E],D=this._cachedRenderRowsMap.get(k.data);D.has(k.rowDef)?D.get(k.rowDef).push(k):D.set(k.rowDef,[k]),c.push(k)}}return c}_getRenderRowsForData(c,u,r){return this._getRowDefs(c,u).map(T=>{let E=r&&r.has(T)?r.get(T):[];if(E.length){let k=E.shift();return k.dataIndex=u,k}else return{data:c,rowDef:T,dataIndex:u}})}_cacheColumnDefs(){this._columnDefsByName.clear(),qy(this._getOwnDefs(this._contentColumnDefs),this._customColumnDefs).forEach(u=>{this._columnDefsByName.has(u.name),this._columnDefsByName.set(u.name,u)})}_cacheRowDefs(){this._headerRowDefs=qy(this._getOwnDefs(this._contentHeaderRowDefs),this._customHeaderRowDefs),this._footerRowDefs=qy(this._getOwnDefs(this._contentFooterRowDefs),this._customFooterRowDefs),this._rowDefs=qy(this._getOwnDefs(this._contentRowDefs),this._customRowDefs);let c=this._rowDefs.filter(u=>!u.when);!this.multiTemplateDataRows&&c.length>1,this._defaultRowDef=c[0]}_renderUpdatedColumns(){let c=(T,E)=>T||!!E.getColumnsDiff(),u=this._rowDefs.reduce(c,!1);u&&this._forceRenderDataRows();let r=this._headerRowDefs.reduce(c,!1);r&&this._forceRenderHeaderRows();let _=this._footerRowDefs.reduce(c,!1);return _&&this._forceRenderFooterRows(),u||r||_}_switchDataSource(c){this._data=[],Wy(this.dataSource)&&this.dataSource.disconnect(this),this._renderChangeSubscription&&(this._renderChangeSubscription.unsubscribe(),this._renderChangeSubscription=null),c||(this._dataDiffer&&this._dataDiffer.diff([]),this._rowOutlet&&this._rowOutlet.viewContainer.clear()),this._dataSource=c}_observeRenderChanges(){if(!this.dataSource)return;let c;Wy(this.dataSource)?c=this.dataSource.connect(this):b0(this.dataSource)?c=this.dataSource:Array.isArray(this.dataSource)&&(c=ji(this.dataSource)),this._renderChangeSubscription=c.pipe(gl(this._onDestroy)).subscribe(u=>{this._data=u||[],this.renderRows()})}_forceRenderHeaderRows(){this._headerRowOutlet.viewContainer.length>0&&this._headerRowOutlet.viewContainer.clear(),this._headerRowDefs.forEach((c,u)=>this._renderRow(this._headerRowOutlet,c,u)),this.updateStickyHeaderRowStyles()}_forceRenderFooterRows(){this._footerRowOutlet.viewContainer.length>0&&this._footerRowOutlet.viewContainer.clear(),this._footerRowDefs.forEach((c,u)=>this._renderRow(this._footerRowOutlet,c,u)),this.updateStickyFooterRowStyles()}_addStickyColumnStyles(c,u){let r=Array.from(u.columns||[]).map(E=>{let k=this._columnDefsByName.get(E);return k}),_=r.map(E=>E.sticky),T=r.map(E=>E.stickyEnd);this._stickyStyler.updateStickyColumns(c,_,T,!this._fixedLayout||this._forceRecalculateCellWidths)}_getRenderedRows(c){let u=[];for(let r=0;r<c.viewContainer.length;r++){let _=c.viewContainer.get(r);u.push(_.rootNodes[0])}return u}_getRowDefs(c,u){if(this._rowDefs.length==1)return[this._rowDefs[0]];let r=[];if(this.multiTemplateDataRows)r=this._rowDefs.filter(_=>!_.when||_.when(u,c));else{let _=this._rowDefs.find(T=>T.when&&T.when(u,c))||this._defaultRowDef;_&&r.push(_)}return r.length,r}_getEmbeddedViewArgs(c,u){let r=c.rowDef,_={$implicit:c.data};return{templateRef:r.template,context:_,index:u}}_renderRow(c,u,r,_={}){let T=c.viewContainer.createEmbeddedView(u.template,_,r);return this._renderCellTemplateForItem(u,_),T}_renderCellTemplateForItem(c,u){for(let r of this._getCellTemplates(c))_m.mostRecentCellOutlet&&_m.mostRecentCellOutlet._viewContainer.createEmbeddedView(r,u);this._changeDetectorRef.markForCheck()}_updateRowIndexContext(){let c=this._rowOutlet.viewContainer;for(let u=0,r=c.length;u<r;u++){let T=c.get(u).context;T.count=r,T.first=u===0,T.last=u===r-1,T.even=u%2===0,T.odd=!T.even,this.multiTemplateDataRows?(T.dataIndex=this._renderRows[u].dataIndex,T.renderIndex=u):T.index=this._renderRows[u].dataIndex}}_getCellTemplates(c){return!c||!c.columns?[]:Array.from(c.columns,u=>{let r=this._columnDefsByName.get(u);return c.extractCellTemplate(r)})}_forceRenderDataRows(){this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear(),this.renderRows()}_checkStickyStates(){let c=(u,r)=>u||r.hasStickyChanged();this._headerRowDefs.reduce(c,!1)&&this.updateStickyHeaderRowStyles(),this._footerRowDefs.reduce(c,!1)&&this.updateStickyFooterRowStyles(),Array.from(this._columnDefsByName.values()).reduce(c,!1)&&(this._stickyColumnStylesNeedReset=!0,this.updateStickyColumnStyles())}_setupStickyStyler(){let c=this._dir?this._dir.value:"ltr";this._stickyStyler=new T5(this._isNativeHtmlTable,this.stickyCssClass,c,this._coalescedStyleScheduler,this._platform.isBrowser,this.needsPositionStickyOnElement,this._stickyPositioningListener),(this._dir?this._dir.change:ji()).pipe(gl(this._onDestroy)).subscribe(u=>{this._stickyStyler.direction=u,this.updateStickyColumnStyles()})}_getOwnDefs(c){return c.filter(u=>!u._table||u._table===this)}_updateNoDataRow(){let c=this._customNoDataRow||this._noDataRow;if(!c)return;let u=this._rowOutlet.viewContainer.length===0;if(u===this._isShowingNoDataRow)return;let r=this._noDataRowOutlet.viewContainer;if(u){let _=r.createEmbeddedView(c.templateRef),T=_.rootNodes[0];_.rootNodes.length===1&&T?.nodeType===this._document.ELEMENT_NODE&&(T.setAttribute("role","row"),T.classList.add(c._contentClassName))}else r.clear();this._isShowingNoDataRow=u,this._changeDetectorRef.markForCheck()}};i.\u0275fac=function(u){return new(u||i)(Er(sm),Er(id),Er(Ln),S0("role"),Er(xy,8),Er(aa),Er(no),Er(Y_),Er(Zy),Er(C4),Er(Yy,12),Er(Tn,8))},i.\u0275cmp=pa({type:i,selectors:[["cdk-table"],["table","cdk-table",""]],contentQueries:function(u,r,_){if(u&1&&(Ds(_,P4,5),Ds(_,Y0,5),Ds(_,Qy,5),Ds(_,K_,5),Ds(_,A5,5)),u&2){let T;Ta(T=Sa())&&(r._noDataRow=T.first),Ta(T=Sa())&&(r._contentColumnDefs=T),Ta(T=Sa())&&(r._contentRowDefs=T),Ta(T=Sa())&&(r._contentHeaderRowDefs=T),Ta(T=Sa())&&(r._contentFooterRowDefs=T)}},hostAttrs:[1,"cdk-table"],hostVars:2,hostBindings:function(u,r){u&2&&io("cdk-table-fixed-layout",r.fixedLayout)},inputs:{trackBy:"trackBy",dataSource:"dataSource",multiTemplateDataRows:[2,"multiTemplateDataRows","multiTemplateDataRows",ds],fixedLayout:[2,"fixedLayout","fixedLayout",ds]},outputs:{contentChanged:"contentChanged"},exportAs:["cdkTable"],standalone:!0,features:[Fa([{provide:dh,useExisting:i},{provide:Y_,useClass:Z0},{provide:Zy,useClass:S5},{provide:Yy,useValue:null}]),_l,ma],ngContentSelectors:bB,decls:5,vars:2,consts:[["role","rowgroup"],["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(u,r){u&1&&(hc(xB),wa(0),wa(1,1),En(2,wB,1,0)(3,TB,7,0)(4,SB,4,0)),u&2&&(Ii(2),Zn(r._isServer?2:-1),Ii(),Zn(r._isNativeHtmlTable?3:4))},dependencies:[M5,k5,R5,D5],styles:[".cdk-table-fixed-layout{table-layout:fixed}"],encapsulation:2});let a=i;return a})();function qy(a,i){return a.concat(Array.from(i))}function M4(a,i){let o=i.toUpperCase(),c=a.viewContainer.element.nativeElement;for(;c;){let u=c.nodeType===1?c.nodeName:null;if(u===o)return c;if(u==="TABLE")break;c=c.parentNode}return null}var L4=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275mod=Vn({type:i}),i.\u0275inj=Un({imports:[I4]});let a=i;return a})();var EB=[[["caption"]],[["colgroup"],["col"]],"*"],AB=["caption","colgroup, col","*"];function CB(a,i){a&1&&wa(0,2)}function IB(a,i){a&1&&(ti(0,"thead",0),uc(1,1),Ur(),ti(2,"tbody",2),uc(3,3)(4,4),Ur(),ti(5,"tfoot",0),uc(6,5),Ur())}function kB(a,i){a&1&&uc(0,1)(1,3)(2,4)(3,5)}var O4=(()=>{let i=class i extends F5{constructor(){super(...arguments),this.stickyCssClass="mat-mdc-table-sticky",this.needsPositionStickyOnElement=!1}};i.\u0275fac=(()=>{let c;return function(r){return(c||(c=us(i)))(r||i)}})(),i.\u0275cmp=pa({type:i,selectors:[["mat-table"],["table","mat-table",""]],hostAttrs:[1,"mat-mdc-table","mdc-data-table__table"],hostVars:2,hostBindings:function(u,r){u&2&&io("mdc-table-fixed-layout",r.fixedLayout)},exportAs:["matTable"],standalone:!0,features:[Fa([{provide:F5,useExisting:i},{provide:dh,useExisting:i},{provide:Zy,useClass:S5},{provide:Y_,useClass:Z0},{provide:Yy,useValue:null}]),na,ma],ngContentSelectors:AB,decls:5,vars:2,consts:[["role","rowgroup"],["headerRowOutlet",""],["role","rowgroup",1,"mdc-data-table__content"],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(u,r){u&1&&(hc(EB),wa(0),wa(1,1),En(2,CB,1,0)(3,IB,7,0)(4,kB,4,0)),u&2&&(Ii(2),Zn(r._isServer?2:-1),Ii(),Zn(r._isNativeHtmlTable?3:4))},dependencies:[M5,k5,R5,D5],styles:[".mat-mdc-table-sticky{position:sticky !important}mat-table{display:block}mat-header-row{min-height:56px}mat-row,mat-footer-row{min-height:48px}mat-row,mat-header-row,mat-footer-row{display:flex;border-width:0;border-bottom-width:1px;border-style:solid;align-items:center;box-sizing:border-box}mat-cell:first-of-type,mat-header-cell:first-of-type,mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] mat-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:first-of-type:not(:only-of-type){padding-left:0;padding-right:24px}mat-cell:last-of-type,mat-header-cell:last-of-type,mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] mat-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:last-of-type:not(:only-of-type){padding-right:0;padding-left:24px}mat-cell,mat-header-cell,mat-footer-cell{flex:1;display:flex;align-items:center;overflow:hidden;word-wrap:break-word;min-height:inherit}.mat-mdc-table{min-width:100%;border:0;border-spacing:0;table-layout:auto;white-space:normal;background-color:var(--mat-table-background-color)}.mdc-data-table__cell{box-sizing:border-box;overflow:hidden;text-align:left;text-overflow:ellipsis}[dir=rtl] .mdc-data-table__cell{text-align:right}.mdc-data-table__cell,.mdc-data-table__header-cell{padding:0 16px}.mat-mdc-header-row{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mat-table-header-container-height, 56px);color:var(--mat-table-header-headline-color, rgba(0, 0, 0, 0.87));font-family:var(--mat-table-header-headline-font, Roboto, sans-serif);line-height:var(--mat-table-header-headline-line-height);font-size:var(--mat-table-header-headline-size, 14px);font-weight:var(--mat-table-header-headline-weight, 500)}.mat-mdc-row{height:var(--mat-table-row-item-container-height, 52px);color:var(--mat-table-row-item-label-text-color, rgba(0, 0, 0, 0.87))}.mat-mdc-row,.mdc-data-table__content{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-table-row-item-label-text-font, Roboto, sans-serif);line-height:var(--mat-table-row-item-label-text-line-height);font-size:var(--mat-table-row-item-label-text-size, 14px);font-weight:var(--mat-table-row-item-label-text-weight)}.mat-mdc-footer-row{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mat-table-footer-container-height, 52px);color:var(--mat-table-row-item-label-text-color, rgba(0, 0, 0, 0.87));font-family:var(--mat-table-footer-supporting-text-font, Roboto, sans-serif);line-height:var(--mat-table-footer-supporting-text-line-height);font-size:var(--mat-table-footer-supporting-text-size, 14px);font-weight:var(--mat-table-footer-supporting-text-weight);letter-spacing:var(--mat-table-footer-supporting-text-tracking)}.mat-mdc-header-cell{border-bottom-color:var(--mat-table-row-item-outline-color, rgba(0, 0, 0, 0.12));border-bottom-width:var(--mat-table-row-item-outline-width, 1px);border-bottom-style:solid;letter-spacing:var(--mat-table-header-headline-tracking);font-weight:inherit;line-height:inherit;box-sizing:border-box;text-overflow:ellipsis;overflow:hidden;outline:none;text-align:left}[dir=rtl] .mat-mdc-header-cell{text-align:right}.mat-mdc-cell{border-bottom-color:var(--mat-table-row-item-outline-color, rgba(0, 0, 0, 0.12));border-bottom-width:var(--mat-table-row-item-outline-width, 1px);border-bottom-style:solid;letter-spacing:var(--mat-table-row-item-label-text-tracking);line-height:inherit}.mdc-data-table__row:last-child .mat-mdc-cell{border-bottom:none}.mat-mdc-footer-cell{letter-spacing:var(--mat-table-row-item-label-text-tracking)}mat-row.mat-mdc-row,mat-header-row.mat-mdc-header-row,mat-footer-row.mat-mdc-footer-row{border-bottom:none}.mat-mdc-table tbody,.mat-mdc-table tfoot,.mat-mdc-table thead,.mat-mdc-cell,.mat-mdc-footer-cell,.mat-mdc-header-row,.mat-mdc-row,.mat-mdc-footer-row,.mat-mdc-table .mat-mdc-header-cell{background:inherit}.mat-mdc-table mat-header-row.mat-mdc-header-row,.mat-mdc-table mat-row.mat-mdc-row,.mat-mdc-table mat-footer-row.mat-mdc-footer-cell{height:unset}mat-header-cell.mat-mdc-header-cell,mat-cell.mat-mdc-cell,mat-footer-cell.mat-mdc-footer-cell{align-self:stretch}"],encapsulation:2});let a=i;return a})(),N4=(()=>{let i=class i extends Ky{};i.\u0275fac=(()=>{let c;return function(r){return(c||(c=us(i)))(r||i)}})(),i.\u0275dir=pi({type:i,selectors:[["","matCellDef",""]],standalone:!0,features:[Fa([{provide:Ky,useExisting:i}]),na]});let a=i;return a})(),B4=(()=>{let i=class i extends Jy{};i.\u0275fac=(()=>{let c;return function(r){return(c||(c=us(i)))(r||i)}})(),i.\u0275dir=pi({type:i,selectors:[["","matHeaderCellDef",""]],standalone:!0,features:[Fa([{provide:Jy,useExisting:i}]),na]});let a=i;return a})();var z4=(()=>{let i=class i extends Y0{get name(){return this._name}set name(c){this._setNameInput(c)}_updateColumnCssClassName(){super._updateColumnCssClassName(),this._columnCssClassName.push(`mat-column-${this.cssClassFriendlyName}`)}};i.\u0275fac=(()=>{let c;return function(r){return(c||(c=us(i)))(r||i)}})(),i.\u0275dir=pi({type:i,selectors:[["","matColumnDef",""]],inputs:{name:[0,"matColumnDef","name"]},standalone:!0,features:[Fa([{provide:Y0,useExisting:i},{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:i}]),na]});let a=i;return a})(),j4=(()=>{let i=class i extends R4{};i.\u0275fac=(()=>{let c;return function(r){return(c||(c=us(i)))(r||i)}})(),i.\u0275dir=pi({type:i,selectors:[["mat-header-cell"],["th","mat-header-cell",""]],hostAttrs:["role","columnheader",1,"mat-mdc-header-cell","mdc-data-table__header-cell"],standalone:!0,features:[na]});let a=i;return a})();var U4=(()=>{let i=class i extends F4{};i.\u0275fac=(()=>{let c;return function(r){return(c||(c=us(i)))(r||i)}})(),i.\u0275dir=pi({type:i,selectors:[["mat-cell"],["td","mat-cell",""]],hostAttrs:[1,"mat-mdc-cell","mdc-data-table__cell"],standalone:!0,features:[na]});let a=i;return a})();var V4=(()=>{let i=class i extends K_{};i.\u0275fac=(()=>{let c;return function(r){return(c||(c=us(i)))(r||i)}})(),i.\u0275dir=pi({type:i,selectors:[["","matHeaderRowDef",""]],inputs:{columns:[0,"matHeaderRowDef","columns"],sticky:[2,"matHeaderRowDefSticky","sticky",ds]},standalone:!0,features:[Fa([{provide:K_,useExisting:i}]),_l,na]});let a=i;return a})();var G4=(()=>{let i=class i extends Qy{};i.\u0275fac=(()=>{let c;return function(r){return(c||(c=us(i)))(r||i)}})(),i.\u0275dir=pi({type:i,selectors:[["","matRowDef",""]],inputs:{columns:[0,"matRowDefColumns","columns"],when:[0,"matRowDefWhen","when"]},standalone:!0,features:[Fa([{provide:Qy,useExisting:i}]),na]});let a=i;return a})(),H4=(()=>{let i=class i extends C5{};i.\u0275fac=(()=>{let c;return function(r){return(c||(c=us(i)))(r||i)}})(),i.\u0275cmp=pa({type:i,selectors:[["mat-header-row"],["tr","mat-header-row",""]],hostAttrs:["role","row",1,"mat-mdc-header-row","mdc-data-table__header-row"],exportAs:["matHeaderRow"],standalone:!0,features:[Fa([{provide:C5,useExisting:i}]),na,ma],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(u,r){u&1&&uc(0,0)},dependencies:[_m],encapsulation:2});let a=i;return a})();var W4=(()=>{let i=class i extends I5{};i.\u0275fac=(()=>{let c;return function(r){return(c||(c=us(i)))(r||i)}})(),i.\u0275cmp=pa({type:i,selectors:[["mat-row"],["tr","mat-row",""]],hostAttrs:["role","row",1,"mat-mdc-row","mdc-data-table__row"],exportAs:["matRow"],standalone:!0,features:[Fa([{provide:I5,useExisting:i}]),na,ma],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(u,r){u&1&&uc(0,0)},dependencies:[_m],encapsulation:2});let a=i;return a})();var q4=(()=>{let i=class i{};i.\u0275fac=function(u){return new(u||i)},i.\u0275mod=Vn({type:i}),i.\u0275inj=Un({imports:[Jo,L4,Jo]});let a=i;return a})();var o1={};o1.version="0.18.5";var ym=1200,sg=1252,DB=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],RB={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Fk=function(a){DB.indexOf(a)!=-1&&(sg=RB[0]=a)};function FB(){Fk(1252)}var s1=function(a){ym=a,Fk(a)};function PB(){s1(1200),FB()}function LB(a){for(var i=[],o=0;o<a.length>>1;++o)i[o]=String.fromCharCode(a.charCodeAt(2*o+1)+(a.charCodeAt(2*o)<<8));return i.join("")}var ex=function(i){return String.fromCharCode(i)},$4=function(i){return String.fromCharCode(i)},za;var cd=null,J_=!0,mp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function l1(a){for(var i="",o=0,c=0,u=0,r=0,_=0,T=0,E=0,k=0;k<a.length;)o=a.charCodeAt(k++),r=o>>2,c=a.charCodeAt(k++),_=(o&3)<<4|c>>4,u=a.charCodeAt(k++),T=(c&15)<<2|u>>6,E=u&63,isNaN(c)?T=E=64:isNaN(u)&&(E=64),i+=mp.charAt(r)+mp.charAt(_)+mp.charAt(T)+mp.charAt(E);return i}function hf(a){var i="",o=0,c=0,u=0,r=0,_=0,T=0,E=0;a=a.replace(/[^\w\+\/\=]/g,"");for(var k=0;k<a.length;)r=mp.indexOf(a.charAt(k++)),_=mp.indexOf(a.charAt(k++)),o=r<<2|_>>4,i+=String.fromCharCode(o),T=mp.indexOf(a.charAt(k++)),c=(_&15)<<4|T>>2,T!==64&&(i+=String.fromCharCode(c)),E=mp.indexOf(a.charAt(k++)),u=(T&3)<<6|E,E!==64&&(i+=String.fromCharCode(u));return i}var oa=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ff=function(){if(typeof Buffer<"u"){var a=!Buffer.from;if(!a)try{Buffer.from("foo","utf8")}catch{a=!0}return a?function(i,o){return o?new Buffer(i,o):new Buffer(i)}:Buffer.from.bind(Buffer)}return function(){}}();function bm(a){return oa?Buffer.alloc?Buffer.alloc(a):new Buffer(a):typeof Uint8Array<"u"?new Uint8Array(a):new Array(a)}function X4(a){return oa?Buffer.allocUnsafe?Buffer.allocUnsafe(a):new Buffer(a):typeof Uint8Array<"u"?new Uint8Array(a):new Array(a)}var mh=function(i){return oa?ff(i,"binary"):i.split("").map(function(o){return o.charCodeAt(0)&255})};function wx(a){if(typeof ArrayBuffer>"u")return mh(a);for(var i=new ArrayBuffer(a.length),o=new Uint8Array(i),c=0;c!=a.length;++c)o[c]=a.charCodeAt(c)&255;return i}function f1(a){if(Array.isArray(a))return a.map(function(c){return String.fromCharCode(c)}).join("");for(var i=[],o=0;o<a.length;++o)i[o]=String.fromCharCode(a[o]);return i.join("")}function OB(a){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(a)}var Js=oa?function(a){return Buffer.concat(a.map(function(i){return Buffer.isBuffer(i)?i:ff(i)}))}:function(a){if(typeof Uint8Array<"u"){var i=0,o=0;for(i=0;i<a.length;++i)o+=a[i].length;var c=new Uint8Array(o),u=0;for(i=0,o=0;i<a.length;o+=u,++i)if(u=a[i].length,a[i]instanceof Uint8Array)c.set(a[i],o);else{if(typeof a[i]=="string")throw"wtf";c.set(new Uint8Array(a[i]),o)}return c}return[].concat.apply([],a.map(function(r){return Array.isArray(r)?r:[].slice.call(r)}))};function NB(a){for(var i=[],o=0,c=a.length+250,u=bm(a.length+255),r=0;r<a.length;++r){var _=a.charCodeAt(r);if(_<128)u[o++]=_;else if(_<2048)u[o++]=192|_>>6&31,u[o++]=128|_&63;else if(_>=55296&&_<57344){_=(_&1023)+64;var T=a.charCodeAt(++r)&1023;u[o++]=240|_>>8&7,u[o++]=128|_>>2&63,u[o++]=128|T>>6&15|(_&3)<<4,u[o++]=128|T&63}else u[o++]=224|_>>12&15,u[o++]=128|_>>6&63,u[o++]=128|_&63;o>c&&(i.push(u.slice(0,o)),o=0,u=bm(65535),c=65530)}return i.push(u.slice(0,o)),Js(i)}var rg=/\u0000/g,tx=/[\u0001-\u0006]/g;function ig(a){for(var i="",o=a.length-1;o>=0;)i+=a.charAt(o--);return i}function gh(a,i){var o=""+a;return o.length>=i?o:Do("0",i-o.length)+o}function q5(a,i){var o=""+a;return o.length>=i?o:Do(" ",i-o.length)+o}function cx(a,i){var o=""+a;return o.length>=i?o:o+Do(" ",i-o.length)}function BB(a,i){var o=""+Math.round(a);return o.length>=i?o:Do("0",i-o.length)+o}function zB(a,i){var o=""+a;return o.length>=i?o:Do("0",i-o.length)+o}var Z4=Math.pow(2,32);function K0(a,i){if(a>Z4||a<-Z4)return BB(a,i);var o=Math.round(a);return zB(o,i)}function ux(a,i){return i=i||0,a.length>=7+i&&(a.charCodeAt(i)|32)===103&&(a.charCodeAt(i+1)|32)===101&&(a.charCodeAt(i+2)|32)===110&&(a.charCodeAt(i+3)|32)===101&&(a.charCodeAt(i+4)|32)===114&&(a.charCodeAt(i+5)|32)===97&&(a.charCodeAt(i+6)|32)===108}var Y4=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],P5=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function jB(a){return a||(a={}),a[0]="General",a[1]="0",a[2]="0.00",a[3]="#,##0",a[4]="#,##0.00",a[9]="0%",a[10]="0.00%",a[11]="0.00E+00",a[12]="# ?/?",a[13]="# ??/??",a[14]="m/d/yy",a[15]="d-mmm-yy",a[16]="d-mmm",a[17]="mmm-yy",a[18]="h:mm AM/PM",a[19]="h:mm:ss AM/PM",a[20]="h:mm",a[21]="h:mm:ss",a[22]="m/d/yy h:mm",a[37]="#,##0 ;(#,##0)",a[38]="#,##0 ;[Red](#,##0)",a[39]="#,##0.00;(#,##0.00)",a[40]="#,##0.00;[Red](#,##0.00)",a[45]="mm:ss",a[46]="[h]:mm:ss",a[47]="mmss.0",a[48]="##0.0E+0",a[49]="@",a[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',a}var Ro={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},K4={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},UB={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function hx(a,i,o){for(var c=a<0?-1:1,u=a*c,r=0,_=1,T=0,E=1,k=0,D=0,j=Math.floor(u);k<i&&(j=Math.floor(u),T=j*_+r,D=j*k+E,!(u-j<5e-8));)u=1/(u-j),r=_,_=T,E=k,k=D;if(D>i&&(k>i?(D=E,T=r):(D=k,T=_)),!o)return[0,c*T,D];var B=Math.floor(c*T/D);return[B,c*T-B*D,D]}function rx(a,i,o){if(a>2958465||a<0)return null;var c=a|0,u=Math.floor(86400*(a-c)),r=0,_=[],T={D:c,T:u,u:86400*(a-c)-u,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(T.u)<1e-6&&(T.u=0),i&&i.date1904&&(c+=1462),T.u>.9999&&(T.u=0,++u==86400&&(T.T=u=0,++c,++T.D)),c===60)_=o?[1317,10,29]:[1900,2,29],r=3;else if(c===0)_=o?[1317,8,29]:[1900,1,0],r=6;else{c>60&&--c;var E=new Date(1900,0,1);E.setDate(E.getDate()+c-1),_=[E.getFullYear(),E.getMonth()+1,E.getDate()],r=E.getDay(),c<60&&(r=(r+6)%7),o&&(r=XB(E,_))}return T.y=_[0],T.m=_[1],T.d=_[2],T.S=u%60,u=Math.floor(u/60),T.M=u%60,u=Math.floor(u/60),T.H=u,T.q=r,T}var Pk=new Date(1899,11,31,0,0,0),VB=Pk.getTime(),GB=new Date(1900,2,1,0,0,0);function Lk(a,i){var o=a.getTime();return i?o-=1461*24*60*60*1e3:a>=GB&&(o+=24*60*60*1e3),(o-(VB+(a.getTimezoneOffset()-Pk.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function $5(a){return a.indexOf(".")==-1?a:a.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function HB(a){return a.indexOf("E")==-1?a:a.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function WB(a){var i=a<0?12:11,o=$5(a.toFixed(12));return o.length<=i||(o=a.toPrecision(10),o.length<=i)?o:a.toExponential(5)}function qB(a){var i=$5(a.toFixed(11));return i.length>(a<0?12:11)||i==="0"||i==="-0"?a.toPrecision(6):i}function $B(a){var i=Math.floor(Math.log(Math.abs(a))*Math.LOG10E),o;return i>=-4&&i<=-1?o=a.toPrecision(10+i):Math.abs(i)<=9?o=WB(a):i===10?o=a.toFixed(10).substr(0,12):o=qB(a),$5(HB(o.toUpperCase()))}function V5(a,i){switch(typeof a){case"string":return a;case"boolean":return a?"TRUE":"FALSE";case"number":return(a|0)===a?a.toString(10):$B(a);case"undefined":return"";case"object":if(a==null)return"";if(a instanceof Date)return _p(14,Lk(a,i&&i.date1904),i)}throw new Error("unsupported value in General format: "+a)}function XB(a,i){i[0]-=581;var o=a.getDay();return a<60&&(o=(o+6)%7),o}function ZB(a,i,o,c){var u="",r=0,_=0,T=o.y,E,k=0;switch(a){case 98:T=o.y+543;case 121:switch(i.length){case 1:case 2:E=T%100,k=2;break;default:E=T%1e4,k=4;break}break;case 109:switch(i.length){case 1:case 2:E=o.m,k=i.length;break;case 3:return P5[o.m-1][1];case 5:return P5[o.m-1][0];default:return P5[o.m-1][2]}break;case 100:switch(i.length){case 1:case 2:E=o.d,k=i.length;break;case 3:return Y4[o.q][0];default:return Y4[o.q][1]}break;case 104:switch(i.length){case 1:case 2:E=1+(o.H+11)%12,k=i.length;break;default:throw"bad hour format: "+i}break;case 72:switch(i.length){case 1:case 2:E=o.H,k=i.length;break;default:throw"bad hour format: "+i}break;case 77:switch(i.length){case 1:case 2:E=o.M,k=i.length;break;default:throw"bad minute format: "+i}break;case 115:if(i!="s"&&i!="ss"&&i!=".0"&&i!=".00"&&i!=".000")throw"bad second format: "+i;return o.u===0&&(i=="s"||i=="ss")?gh(o.S,i.length):(c>=2?_=c===3?1e3:100:_=c===1?10:1,r=Math.round(_*(o.S+o.u)),r>=60*_&&(r=0),i==="s"?r===0?"0":""+r/_:(u=gh(r,2+c),i==="ss"?u.substr(0,2):"."+u.substr(2,i.length-1)));case 90:switch(i){case"[h]":case"[hh]":E=o.D*24+o.H;break;case"[m]":case"[mm]":E=(o.D*24+o.H)*60+o.M;break;case"[s]":case"[ss]":E=((o.D*24+o.H)*60+o.M)*60+Math.round(o.S+o.u);break;default:throw"bad abstime format: "+i}k=i.length===3?1:2;break;case 101:E=T,k=1;break}var D=k>0?gh(E,k):"";return D}function gp(a){var i=3;if(a.length<=i)return a;for(var o=a.length%i,c=a.substr(0,o);o!=a.length;o+=i)c+=(c.length>0?",":"")+a.substr(o,i);return c}var Ok=/%/g;function YB(a,i,o){var c=i.replace(Ok,""),u=i.length-c.length;return lf(a,c,o*Math.pow(10,2*u))+Do("%",u)}function KB(a,i,o){for(var c=i.length-1;i.charCodeAt(c-1)===44;)--c;return lf(a,i.substr(0,c),o/Math.pow(10,3*(i.length-c)))}function Nk(a,i){var o,c=a.indexOf("E")-a.indexOf(".")-1;if(a.match(/^#+0.0E\+0$/)){if(i==0)return"0.0E+0";if(i<0)return"-"+Nk(a,-i);var u=a.indexOf(".");u===-1&&(u=a.indexOf("E"));var r=Math.floor(Math.log(i)*Math.LOG10E)%u;if(r<0&&(r+=u),o=(i/Math.pow(10,r)).toPrecision(c+1+(u+r)%u),o.indexOf("e")===-1){var _=Math.floor(Math.log(i)*Math.LOG10E);for(o.indexOf(".")===-1?o=o.charAt(0)+"."+o.substr(1)+"E+"+(_-o.length+r):o+="E+"+(_-r);o.substr(0,2)==="0.";)o=o.charAt(0)+o.substr(2,u)+"."+o.substr(2+u),o=o.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");o=o.replace(/\+-/,"-")}o=o.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(T,E,k,D){return E+k+D.substr(0,(u+r)%u)+"."+D.substr(r)+"E"})}else o=i.toExponential(c);return a.match(/E\+00$/)&&o.match(/e[+-]\d$/)&&(o=o.substr(0,o.length-1)+"0"+o.charAt(o.length-1)),a.match(/E\-/)&&o.match(/e\+/)&&(o=o.replace(/e\+/,"e")),o.replace("e","E")}var Bk=/# (\?+)( ?)\/( ?)(\d+)/;function JB(a,i,o){var c=parseInt(a[4],10),u=Math.round(i*c),r=Math.floor(u/c),_=u-r*c,T=c;return o+(r===0?"":""+r)+" "+(_===0?Do(" ",a[1].length+1+a[4].length):q5(_,a[1].length)+a[2]+"/"+a[3]+gh(T,a[4].length))}function QB(a,i,o){return o+(i===0?"":""+i)+Do(" ",a[1].length+2+a[4].length)}var zk=/^#*0*\.([0#]+)/,jk=/\).*[0#]/,Uk=/\(###\) ###\\?-####/;function Bl(a){for(var i="",o,c=0;c!=a.length;++c)switch(o=a.charCodeAt(c)){case 35:break;case 63:i+=" ";break;case 48:i+="0";break;default:i+=String.fromCharCode(o)}return i}function J4(a,i){var o=Math.pow(10,i);return""+Math.round(a*o)/o}function Q4(a,i){var o=a-Math.floor(a),c=Math.pow(10,i);return i<(""+Math.round(o*c)).length?0:Math.round(o*c)}function ez(a,i){return i<(""+Math.round((a-Math.floor(a))*Math.pow(10,i))).length?1:0}function tz(a){return a<2147483647&&a>-2147483648?""+(a>=0?a|0:a-1|0):""+Math.floor(a)}function Su(a,i,o){if(a.charCodeAt(0)===40&&!i.match(jk)){var c=i.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return o>=0?Su("n",c,o):"("+Su("n",c,-o)+")"}if(i.charCodeAt(i.length-1)===44)return KB(a,i,o);if(i.indexOf("%")!==-1)return YB(a,i,o);if(i.indexOf("E")!==-1)return Nk(i,o);if(i.charCodeAt(0)===36)return"$"+Su(a,i.substr(i.charAt(1)==" "?2:1),o);var u,r,_,T,E=Math.abs(o),k=o<0?"-":"";if(i.match(/^00+$/))return k+K0(E,i.length);if(i.match(/^[#?]+$/))return u=K0(o,0),u==="0"&&(u=""),u.length>i.length?u:Bl(i.substr(0,i.length-u.length))+u;if(r=i.match(Bk))return JB(r,E,k);if(i.match(/^#+0+$/))return k+K0(E,i.length-i.indexOf("0"));if(r=i.match(zk))return u=J4(o,r[1].length).replace(/^([^\.]+)$/,"$1."+Bl(r[1])).replace(/\.$/,"."+Bl(r[1])).replace(/\.(\d*)$/,function(ee,G){return"."+G+Do("0",Bl(r[1]).length-G.length)}),i.indexOf("0.")!==-1?u:u.replace(/^0\./,".");if(i=i.replace(/^#+([0.])/,"$1"),r=i.match(/^(0*)\.(#*)$/))return k+J4(E,r[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,r[1].length?"0.":".");if(r=i.match(/^#{1,3},##0(\.?)$/))return k+gp(K0(E,0));if(r=i.match(/^#,##0\.([#0]*0)$/))return o<0?"-"+Su(a,i,-o):gp(""+(Math.floor(o)+ez(o,r[1].length)))+"."+gh(Q4(o,r[1].length),r[1].length);if(r=i.match(/^#,#*,#0/))return Su(a,i.replace(/^#,#*,/,""),o);if(r=i.match(/^([0#]+)(\\?-([0#]+))+$/))return u=ig(Su(a,i.replace(/[\\-]/g,""),o)),_=0,ig(ig(i.replace(/\\/g,"")).replace(/[0#]/g,function(ee){return _<u.length?u.charAt(_++):ee==="0"?"0":""}));if(i.match(Uk))return u=Su(a,"##########",o),"("+u.substr(0,3)+") "+u.substr(3,3)+"-"+u.substr(6);var D="";if(r=i.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return _=Math.min(r[4].length,7),T=hx(E,Math.pow(10,_)-1,!1),u=""+k,D=lf("n",r[1],T[1]),D.charAt(D.length-1)==" "&&(D=D.substr(0,D.length-1)+"0"),u+=D+r[2]+"/"+r[3],D=cx(T[2],_),D.length<r[4].length&&(D=Bl(r[4].substr(r[4].length-D.length))+D),u+=D,u;if(r=i.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return _=Math.min(Math.max(r[1].length,r[4].length),7),T=hx(E,Math.pow(10,_)-1,!0),k+(T[0]||(T[1]?"":"0"))+" "+(T[1]?q5(T[1],_)+r[2]+"/"+r[3]+cx(T[2],_):Do(" ",2*_+1+r[2].length+r[3].length));if(r=i.match(/^[#0?]+$/))return u=K0(o,0),i.length<=u.length?u:Bl(i.substr(0,i.length-u.length))+u;if(r=i.match(/^([#0?]+)\.([#0]+)$/)){u=""+o.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,"$1"),_=u.indexOf(".");var j=i.indexOf(".")-_,B=i.length-u.length-j;return Bl(i.substr(0,j)+u+i.substr(i.length-B))}if(r=i.match(/^00,000\.([#0]*0)$/))return _=Q4(o,r[1].length),o<0?"-"+Su(a,i,-o):gp(tz(o)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(ee){return"00,"+(ee.length<3?gh(0,3-ee.length):"")+ee})+"."+gh(_,r[1].length);switch(i){case"###,##0.00":return Su(a,"#,##0.00",o);case"###,###":case"##,###":case"#,###":var P=gp(K0(E,0));return P!=="0"?k+P:"";case"###,###.00":return Su(a,"###,##0.00",o).replace(/^0\./,".");case"#,###.00":return Su(a,"#,##0.00",o).replace(/^0\./,".");default:}throw new Error("unsupported format |"+i+"|")}function rz(a,i,o){for(var c=i.length-1;i.charCodeAt(c-1)===44;)--c;return lf(a,i.substr(0,c),o/Math.pow(10,3*(i.length-c)))}function iz(a,i,o){var c=i.replace(Ok,""),u=i.length-c.length;return lf(a,c,o*Math.pow(10,2*u))+Do("%",u)}function Vk(a,i){var o,c=a.indexOf("E")-a.indexOf(".")-1;if(a.match(/^#+0.0E\+0$/)){if(i==0)return"0.0E+0";if(i<0)return"-"+Vk(a,-i);var u=a.indexOf(".");u===-1&&(u=a.indexOf("E"));var r=Math.floor(Math.log(i)*Math.LOG10E)%u;if(r<0&&(r+=u),o=(i/Math.pow(10,r)).toPrecision(c+1+(u+r)%u),!o.match(/[Ee]/)){var _=Math.floor(Math.log(i)*Math.LOG10E);o.indexOf(".")===-1?o=o.charAt(0)+"."+o.substr(1)+"E+"+(_-o.length+r):o+="E+"+(_-r),o=o.replace(/\+-/,"-")}o=o.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(T,E,k,D){return E+k+D.substr(0,(u+r)%u)+"."+D.substr(r)+"E"})}else o=i.toExponential(c);return a.match(/E\+00$/)&&o.match(/e[+-]\d$/)&&(o=o.substr(0,o.length-1)+"0"+o.charAt(o.length-1)),a.match(/E\-/)&&o.match(/e\+/)&&(o=o.replace(/e\+/,"e")),o.replace("e","E")}function sd(a,i,o){if(a.charCodeAt(0)===40&&!i.match(jk)){var c=i.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return o>=0?sd("n",c,o):"("+sd("n",c,-o)+")"}if(i.charCodeAt(i.length-1)===44)return rz(a,i,o);if(i.indexOf("%")!==-1)return iz(a,i,o);if(i.indexOf("E")!==-1)return Vk(i,o);if(i.charCodeAt(0)===36)return"$"+sd(a,i.substr(i.charAt(1)==" "?2:1),o);var u,r,_,T,E=Math.abs(o),k=o<0?"-":"";if(i.match(/^00+$/))return k+gh(E,i.length);if(i.match(/^[#?]+$/))return u=""+o,o===0&&(u=""),u.length>i.length?u:Bl(i.substr(0,i.length-u.length))+u;if(r=i.match(Bk))return QB(r,E,k);if(i.match(/^#+0+$/))return k+gh(E,i.length-i.indexOf("0"));if(r=i.match(zk))return u=(""+o).replace(/^([^\.]+)$/,"$1."+Bl(r[1])).replace(/\.$/,"."+Bl(r[1])),u=u.replace(/\.(\d*)$/,function(ee,G){return"."+G+Do("0",Bl(r[1]).length-G.length)}),i.indexOf("0.")!==-1?u:u.replace(/^0\./,".");if(i=i.replace(/^#+([0.])/,"$1"),r=i.match(/^(0*)\.(#*)$/))return k+(""+E).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,r[1].length?"0.":".");if(r=i.match(/^#{1,3},##0(\.?)$/))return k+gp(""+E);if(r=i.match(/^#,##0\.([#0]*0)$/))return o<0?"-"+sd(a,i,-o):gp(""+o)+"."+Do("0",r[1].length);if(r=i.match(/^#,#*,#0/))return sd(a,i.replace(/^#,#*,/,""),o);if(r=i.match(/^([0#]+)(\\?-([0#]+))+$/))return u=ig(sd(a,i.replace(/[\\-]/g,""),o)),_=0,ig(ig(i.replace(/\\/g,"")).replace(/[0#]/g,function(ee){return _<u.length?u.charAt(_++):ee==="0"?"0":""}));if(i.match(Uk))return u=sd(a,"##########",o),"("+u.substr(0,3)+") "+u.substr(3,3)+"-"+u.substr(6);var D="";if(r=i.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return _=Math.min(r[4].length,7),T=hx(E,Math.pow(10,_)-1,!1),u=""+k,D=lf("n",r[1],T[1]),D.charAt(D.length-1)==" "&&(D=D.substr(0,D.length-1)+"0"),u+=D+r[2]+"/"+r[3],D=cx(T[2],_),D.length<r[4].length&&(D=Bl(r[4].substr(r[4].length-D.length))+D),u+=D,u;if(r=i.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return _=Math.min(Math.max(r[1].length,r[4].length),7),T=hx(E,Math.pow(10,_)-1,!0),k+(T[0]||(T[1]?"":"0"))+" "+(T[1]?q5(T[1],_)+r[2]+"/"+r[3]+cx(T[2],_):Do(" ",2*_+1+r[2].length+r[3].length));if(r=i.match(/^[#0?]+$/))return u=""+o,i.length<=u.length?u:Bl(i.substr(0,i.length-u.length))+u;if(r=i.match(/^([#0]+)\.([#0]+)$/)){u=""+o.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,"$1"),_=u.indexOf(".");var j=i.indexOf(".")-_,B=i.length-u.length-j;return Bl(i.substr(0,j)+u+i.substr(i.length-B))}if(r=i.match(/^00,000\.([#0]*0)$/))return o<0?"-"+sd(a,i,-o):gp(""+o).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(ee){return"00,"+(ee.length<3?gh(0,3-ee.length):"")+ee})+"."+gh(0,r[1].length);switch(i){case"###,###":case"##,###":case"#,###":var P=gp(""+E);return P!=="0"?k+P:"";default:if(i.match(/\.[0#?]*$/))return sd(a,i.slice(0,i.lastIndexOf(".")),o)+Bl(i.slice(i.lastIndexOf(".")))}throw new Error("unsupported format |"+i+"|")}function lf(a,i,o){return(o|0)===o?sd(a,i,o):Su(a,i,o)}function nz(a){for(var i=[],o=!1,c=0,u=0;c<a.length;++c)switch(a.charCodeAt(c)){case 34:o=!o;break;case 95:case 42:case 92:++c;break;case 59:i[i.length]=a.substr(u,c-u),u=c+1}if(i[i.length]=a.substr(u),o===!0)throw new Error("Format |"+a+"| unterminated string ");return i}var Gk=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Hk(a){for(var i=0,o="",c="";i<a.length;)switch(o=a.charAt(i)){case"G":ux(a,i)&&(i+=6),i++;break;case'"':for(;a.charCodeAt(++i)!==34&&i<a.length;);++i;break;case"\\":i+=2;break;case"_":i+=2;break;case"@":++i;break;case"B":case"b":if(a.charAt(i+1)==="1"||a.charAt(i+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(a.substr(i,3).toUpperCase()==="A/P"||a.substr(i,5).toUpperCase()==="AM/PM"||a.substr(i,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++i;break;case"[":for(c=o;a.charAt(i++)!=="]"&&i<a.length;)c+=a.charAt(i);if(c.match(Gk))return!0;break;case".":case"0":case"#":for(;i<a.length&&("0#?.,E+-%".indexOf(o=a.charAt(++i))>-1||o=="\\"&&a.charAt(i+1)=="-"&&"0#".indexOf(a.charAt(i+2))>-1););break;case"?":for(;a.charAt(++i)===o;);break;case"*":++i,(a.charAt(i)==" "||a.charAt(i)=="*")&&++i;break;case"(":case")":++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;i<a.length&&"0123456789".indexOf(a.charAt(++i))>-1;);break;case" ":++i;break;default:++i;break}return!1}function az(a,i,o,c){for(var u=[],r="",_=0,T="",E="t",k,D,j,B="H";_<a.length;)switch(T=a.charAt(_)){case"G":if(!ux(a,_))throw new Error("unrecognized character "+T+" in "+a);u[u.length]={t:"G",v:"General"},_+=7;break;case'"':for(r="";(j=a.charCodeAt(++_))!==34&&_<a.length;)r+=String.fromCharCode(j);u[u.length]={t:"t",v:r},++_;break;case"\\":var P=a.charAt(++_),ee=P==="("||P===")"?P:"t";u[u.length]={t:ee,v:P},++_;break;case"_":u[u.length]={t:"t",v:" "},_+=2;break;case"@":u[u.length]={t:"T",v:i},++_;break;case"B":case"b":if(a.charAt(_+1)==="1"||a.charAt(_+1)==="2"){if(k==null&&(k=rx(i,o,a.charAt(_+1)==="2"),k==null))return"";u[u.length]={t:"X",v:a.substr(_,2)},E=T,_+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":T=T.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(i<0||k==null&&(k=rx(i,o),k==null))return"";for(r=T;++_<a.length&&a.charAt(_).toLowerCase()===T;)r+=T;T==="m"&&E.toLowerCase()==="h"&&(T="M"),T==="h"&&(T=B),u[u.length]={t:T,v:r},E=T;break;case"A":case"a":case"\u4E0A":var G={t:T,v:T};if(k==null&&(k=rx(i,o)),a.substr(_,3).toUpperCase()==="A/P"?(k!=null&&(G.v=k.H>=12?"P":"A"),G.t="T",B="h",_+=3):a.substr(_,5).toUpperCase()==="AM/PM"?(k!=null&&(G.v=k.H>=12?"PM":"AM"),G.t="T",_+=5,B="h"):a.substr(_,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(k!=null&&(G.v=k.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),G.t="T",_+=5,B="h"):(G.t="t",++_),k==null&&G.t==="T")return"";u[u.length]=G,E=T;break;case"[":for(r=T;a.charAt(_++)!=="]"&&_<a.length;)r+=a.charAt(_);if(r.slice(-1)!=="]")throw'unterminated "[" block: |'+r+"|";if(r.match(Gk)){if(k==null&&(k=rx(i,o),k==null))return"";u[u.length]={t:"Z",v:r.toLowerCase()},E=r.charAt(1)}else r.indexOf("$")>-1&&(r=(r.match(/\$([^-\[\]]*)/)||[])[1]||"$",Hk(a)||(u[u.length]={t:"t",v:r}));break;case".":if(k!=null){for(r=T;++_<a.length&&(T=a.charAt(_))==="0";)r+=T;u[u.length]={t:"s",v:r};break}case"0":case"#":for(r=T;++_<a.length&&"0#?.,E+-%".indexOf(T=a.charAt(_))>-1;)r+=T;u[u.length]={t:"n",v:r};break;case"?":for(r=T;a.charAt(++_)===T;)r+=T;u[u.length]={t:T,v:r},E=T;break;case"*":++_,(a.charAt(_)==" "||a.charAt(_)=="*")&&++_;break;case"(":case")":u[u.length]={t:c===1?"t":T,v:T},++_;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(r=T;_<a.length&&"0123456789".indexOf(a.charAt(++_))>-1;)r+=a.charAt(_);u[u.length]={t:"D",v:r};break;case" ":u[u.length]={t:T,v:T},++_;break;case"$":u[u.length]={t:"t",v:"$"},++_;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(T)===-1)throw new Error("unrecognized character "+T+" in "+a);u[u.length]={t:"t",v:T},++_;break}var K=0,J=0,ne;for(_=u.length-1,E="t";_>=0;--_)switch(u[_].t){case"h":case"H":u[_].t=B,E="h",K<1&&(K=1);break;case"s":(ne=u[_].v.match(/\.0+$/))&&(J=Math.max(J,ne[0].length-1)),K<3&&(K=3);case"d":case"y":case"M":case"e":E=u[_].t;break;case"m":E==="s"&&(u[_].t="M",K<2&&(K=2));break;case"X":break;case"Z":K<1&&u[_].v.match(/[Hh]/)&&(K=1),K<2&&u[_].v.match(/[Mm]/)&&(K=2),K<3&&u[_].v.match(/[Ss]/)&&(K=3)}switch(K){case 0:break;case 1:k.u>=.5&&(k.u=0,++k.S),k.S>=60&&(k.S=0,++k.M),k.M>=60&&(k.M=0,++k.H);break;case 2:k.u>=.5&&(k.u=0,++k.S),k.S>=60&&(k.S=0,++k.M);break}var he="",Me;for(_=0;_<u.length;++_)switch(u[_].t){case"t":case"T":case" ":case"D":break;case"X":u[_].v="",u[_].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":u[_].v=ZB(u[_].t.charCodeAt(0),u[_].v,k,J),u[_].t="t";break;case"n":case"?":for(Me=_+1;u[Me]!=null&&((T=u[Me].t)==="?"||T==="D"||(T===" "||T==="t")&&u[Me+1]!=null&&(u[Me+1].t==="?"||u[Me+1].t==="t"&&u[Me+1].v==="/")||u[_].t==="("&&(T===" "||T==="n"||T===")")||T==="t"&&(u[Me].v==="/"||u[Me].v===" "&&u[Me+1]!=null&&u[Me+1].t=="?"));)u[_].v+=u[Me].v,u[Me]={v:"",t:";"},++Me;he+=u[_].v,_=Me-1;break;case"G":u[_].t="t",u[_].v=V5(i,o);break}var Re="",et,Te;if(he.length>0){he.charCodeAt(0)==40?(et=i<0&&he.charCodeAt(0)===45?-i:i,Te=lf("n",he,et)):(et=i<0&&c>1?-i:i,Te=lf("n",he,et),et<0&&u[0]&&u[0].t=="t"&&(Te=Te.substr(1),u[0].v="-"+u[0].v)),Me=Te.length-1;var ge=u.length;for(_=0;_<u.length;++_)if(u[_]!=null&&u[_].t!="t"&&u[_].v.indexOf(".")>-1){ge=_;break}var Ue=u.length;if(ge===u.length&&Te.indexOf("E")===-1){for(_=u.length-1;_>=0;--_)u[_]==null||"n?".indexOf(u[_].t)===-1||(Me>=u[_].v.length-1?(Me-=u[_].v.length,u[_].v=Te.substr(Me+1,u[_].v.length)):Me<0?u[_].v="":(u[_].v=Te.substr(0,Me+1),Me=-1),u[_].t="t",Ue=_);Me>=0&&Ue<u.length&&(u[Ue].v=Te.substr(0,Me+1)+u[Ue].v)}else if(ge!==u.length&&Te.indexOf("E")===-1){for(Me=Te.indexOf(".")-1,_=ge;_>=0;--_)if(!(u[_]==null||"n?".indexOf(u[_].t)===-1)){for(D=u[_].v.indexOf(".")>-1&&_===ge?u[_].v.indexOf(".")-1:u[_].v.length-1,Re=u[_].v.substr(D+1);D>=0;--D)Me>=0&&(u[_].v.charAt(D)==="0"||u[_].v.charAt(D)==="#")&&(Re=Te.charAt(Me--)+Re);u[_].v=Re,u[_].t="t",Ue=_}for(Me>=0&&Ue<u.length&&(u[Ue].v=Te.substr(0,Me+1)+u[Ue].v),Me=Te.indexOf(".")+1,_=ge;_<u.length;++_)if(!(u[_]==null||"n?(".indexOf(u[_].t)===-1&&_!==ge)){for(D=u[_].v.indexOf(".")>-1&&_===ge?u[_].v.indexOf(".")+1:0,Re=u[_].v.substr(0,D);D<u[_].v.length;++D)Me<Te.length&&(Re+=Te.charAt(Me++));u[_].v=Re,u[_].t="t",Ue=_}}}for(_=0;_<u.length;++_)u[_]!=null&&"n?".indexOf(u[_].t)>-1&&(et=c>1&&i<0&&_>0&&u[_-1].v==="-"?-i:i,u[_].v=lf(u[_].t,u[_].v,et),u[_].t="t");var Ae="";for(_=0;_!==u.length;++_)u[_]!=null&&(Ae+=u[_].v);return Ae}var ek=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function tk(a,i){if(i==null)return!1;var o=parseFloat(i[2]);switch(i[1]){case"=":if(a==o)return!0;break;case">":if(a>o)return!0;break;case"<":if(a<o)return!0;break;case"<>":if(a!=o)return!0;break;case">=":if(a>=o)return!0;break;case"<=":if(a<=o)return!0;break}return!1}function oz(a,i){var o=nz(a),c=o.length,u=o[c-1].indexOf("@");if(c<4&&u>-1&&--c,o.length>4)throw new Error("cannot find right format for |"+o.join("|")+"|");if(typeof i!="number")return[4,o.length===4||u>-1?o[o.length-1]:"@"];switch(o.length){case 1:o=u>-1?["General","General","General",o[0]]:[o[0],o[0],o[0],"@"];break;case 2:o=u>-1?[o[0],o[0],o[0],o[1]]:[o[0],o[1],o[0],"@"];break;case 3:o=u>-1?[o[0],o[1],o[0],o[2]]:[o[0],o[1],o[2],"@"];break;case 4:break}var r=i>0?o[0]:i<0?o[1]:o[2];if(o[0].indexOf("[")===-1&&o[1].indexOf("[")===-1)return[c,r];if(o[0].match(/\[[=<>]/)!=null||o[1].match(/\[[=<>]/)!=null){var _=o[0].match(ek),T=o[1].match(ek);return tk(i,_)?[c,o[0]]:tk(i,T)?[c,o[1]]:[c,o[_!=null&&T!=null?2:1]]}return[c,r]}function _p(a,i,o){o==null&&(o={});var c="";switch(typeof a){case"string":a=="m/d/yy"&&o.dateNF?c=o.dateNF:c=a;break;case"number":a==14&&o.dateNF?c=o.dateNF:c=(o.table!=null?o.table:Ro)[a],c==null&&(c=o.table&&o.table[K4[a]]||Ro[K4[a]]),c==null&&(c=UB[a]||"General");break}if(ux(c,0))return V5(i,o);i instanceof Date&&(i=Lk(i,o.date1904));var u=oz(c,i);if(ux(u[1]))return V5(i,o);if(i===!0)i="TRUE";else if(i===!1)i="FALSE";else if(i===""||i==null)return"";return az(u[1],i,o,u[0])}function Wk(a,i){if(typeof i!="number"){i=+i||-1;for(var o=0;o<392;++o){if(Ro[o]==null){i<0&&(i=o);continue}if(Ro[o]==a){i=o;break}}i<0&&(i=391)}return Ro[i]=a,i}function Tx(a){for(var i=0;i!=392;++i)a[i]!==void 0&&Wk(a[i],i)}function Sx(){Ro=jB()}var qk=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function sz(a){var i=typeof a=="number"?Ro[a]:a;return i=i.replace(qk,"(\\d+)"),new RegExp("^"+i+"$")}function lz(a,i,o){var c=-1,u=-1,r=-1,_=-1,T=-1,E=-1;(i.match(qk)||[]).forEach(function(j,B){var P=parseInt(o[B+1],10);switch(j.toLowerCase().charAt(0)){case"y":c=P;break;case"d":r=P;break;case"h":_=P;break;case"s":E=P;break;case"m":_>=0?T=P:u=P;break}}),E>=0&&T==-1&&u>=0&&(T=u,u=-1);var k=(""+(c>=0?c:new Date().getFullYear())).slice(-4)+"-"+("00"+(u>=1?u:1)).slice(-2)+"-"+("00"+(r>=1?r:1)).slice(-2);k.length==7&&(k="0"+k),k.length==8&&(k="20"+k);var D=("00"+(_>=0?_:0)).slice(-2)+":"+("00"+(T>=0?T:0)).slice(-2)+":"+("00"+(E>=0?E:0)).slice(-2);return _==-1&&T==-1&&E==-1?k:c==-1&&u==-1&&r==-1?D:k+"T"+D}var cz=function(){var a={};a.version="1.2.0";function i(){for(var Te=0,ge=new Array(256),Ue=0;Ue!=256;++Ue)Te=Ue,Te=Te&1?-306674912^Te>>>1:Te>>>1,Te=Te&1?-306674912^Te>>>1:Te>>>1,Te=Te&1?-306674912^Te>>>1:Te>>>1,Te=Te&1?-306674912^Te>>>1:Te>>>1,Te=Te&1?-306674912^Te>>>1:Te>>>1,Te=Te&1?-306674912^Te>>>1:Te>>>1,Te=Te&1?-306674912^Te>>>1:Te>>>1,Te=Te&1?-306674912^Te>>>1:Te>>>1,ge[Ue]=Te;return typeof Int32Array<"u"?new Int32Array(ge):ge}var o=i();function c(Te){var ge=0,Ue=0,Ae=0,_e=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Ae=0;Ae!=256;++Ae)_e[Ae]=Te[Ae];for(Ae=0;Ae!=256;++Ae)for(Ue=Te[Ae],ge=256+Ae;ge<4096;ge+=256)Ue=_e[ge]=Ue>>>8^Te[Ue&255];var ve=[];for(Ae=1;Ae!=16;++Ae)ve[Ae-1]=typeof Int32Array<"u"?_e.subarray(Ae*256,Ae*256+256):_e.slice(Ae*256,Ae*256+256);return ve}var u=c(o),r=u[0],_=u[1],T=u[2],E=u[3],k=u[4],D=u[5],j=u[6],B=u[7],P=u[8],ee=u[9],G=u[10],K=u[11],J=u[12],ne=u[13],he=u[14];function Me(Te,ge){for(var Ue=ge^-1,Ae=0,_e=Te.length;Ae<_e;)Ue=Ue>>>8^o[(Ue^Te.charCodeAt(Ae++))&255];return~Ue}function Re(Te,ge){for(var Ue=ge^-1,Ae=Te.length-15,_e=0;_e<Ae;)Ue=he[Te[_e++]^Ue&255]^ne[Te[_e++]^Ue>>8&255]^J[Te[_e++]^Ue>>16&255]^K[Te[_e++]^Ue>>>24]^G[Te[_e++]]^ee[Te[_e++]]^P[Te[_e++]]^B[Te[_e++]]^j[Te[_e++]]^D[Te[_e++]]^k[Te[_e++]]^E[Te[_e++]]^T[Te[_e++]]^_[Te[_e++]]^r[Te[_e++]]^o[Te[_e++]];for(Ae+=15;_e<Ae;)Ue=Ue>>>8^o[(Ue^Te[_e++])&255];return~Ue}function et(Te,ge){for(var Ue=ge^-1,Ae=0,_e=Te.length,ve=0,Qe=0;Ae<_e;)ve=Te.charCodeAt(Ae++),ve<128?Ue=Ue>>>8^o[(Ue^ve)&255]:ve<2048?(Ue=Ue>>>8^o[(Ue^(192|ve>>6&31))&255],Ue=Ue>>>8^o[(Ue^(128|ve&63))&255]):ve>=55296&&ve<57344?(ve=(ve&1023)+64,Qe=Te.charCodeAt(Ae++)&1023,Ue=Ue>>>8^o[(Ue^(240|ve>>8&7))&255],Ue=Ue>>>8^o[(Ue^(128|ve>>2&63))&255],Ue=Ue>>>8^o[(Ue^(128|Qe>>6&15|(ve&3)<<4))&255],Ue=Ue>>>8^o[(Ue^(128|Qe&63))&255]):(Ue=Ue>>>8^o[(Ue^(224|ve>>12&15))&255],Ue=Ue>>>8^o[(Ue^(128|ve>>6&63))&255],Ue=Ue>>>8^o[(Ue^(128|ve&63))&255]);return~Ue}return a.table=o,a.bstr=Me,a.buf=Re,a.str=et,a}(),La=function(){var i={};i.version="1.2.1";function o(te,U){for(var W=te.split("/"),Q=U.split("/"),se=0,le=0,De=Math.min(W.length,Q.length);se<De;++se){if(le=W[se].length-Q[se].length)return le;if(W[se]!=Q[se])return W[se]<Q[se]?-1:1}return W.length-Q.length}function c(te){if(te.charAt(te.length-1)=="/")return te.slice(0,-1).indexOf("/")===-1?te:c(te.slice(0,-1));var U=te.lastIndexOf("/");return U===-1?te:te.slice(0,U+1)}function u(te){if(te.charAt(te.length-1)=="/")return u(te.slice(0,-1));var U=te.lastIndexOf("/");return U===-1?te:te.slice(U+1)}function r(te,U){typeof U=="string"&&(U=new Date(U));var W=U.getHours();W=W<<6|U.getMinutes(),W=W<<5|U.getSeconds()>>>1,te.write_shift(2,W);var Q=U.getFullYear()-1980;Q=Q<<4|U.getMonth()+1,Q=Q<<5|U.getDate(),te.write_shift(2,Q)}function _(te){var U=te.read_shift(2)&65535,W=te.read_shift(2)&65535,Q=new Date,se=W&31;W>>>=5;var le=W&15;W>>>=4,Q.setMilliseconds(0),Q.setFullYear(W+1980),Q.setMonth(le-1),Q.setDate(se);var De=U&31;U>>>=5;var Ze=U&63;return U>>>=6,Q.setHours(U),Q.setMinutes(Ze),Q.setSeconds(De<<1),Q}function T(te){qc(te,0);for(var U={},W=0;te.l<=te.length-4;){var Q=te.read_shift(2),se=te.read_shift(2),le=te.l+se,De={};switch(Q){case 21589:W=te.read_shift(1),W&1&&(De.mtime=te.read_shift(4)),se>5&&(W&2&&(De.atime=te.read_shift(4)),W&4&&(De.ctime=te.read_shift(4))),De.mtime&&(De.mt=new Date(De.mtime*1e3));break}te.l=le,U[Q]=De}return U}var E;function k(){return E||(E={})}function D(te,U){if(te[0]==80&&te[1]==75)return Gn(te,U);if((te[0]|32)==109&&(te[1]|32)==105)return Oa(te,U);if(te.length<512)throw new Error("CFB file size "+te.length+" < 512");var W=3,Q=512,se=0,le=0,De=0,Ze=0,ke=0,We=[],nt=te.slice(0,512);qc(nt,0);var dt=j(nt);switch(W=dt[0],W){case 3:Q=512;break;case 4:Q=4096;break;case 0:if(dt[1]==0)return Gn(te,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+W)}Q!==512&&(nt=te.slice(0,Q),qc(nt,28));var Ft=te.slice(0,Q);B(nt,W);var tr=nt.read_shift(4,"i");if(W===3&&tr!==0)throw new Error("# Directory Sectors: Expected 0 saw "+tr);nt.l+=4,De=nt.read_shift(4,"i"),nt.l+=4,nt.chk("00100000","Mini Stream Cutoff Size: "),Ze=nt.read_shift(4,"i"),se=nt.read_shift(4,"i"),ke=nt.read_shift(4,"i"),le=nt.read_shift(4,"i");for(var Qt=-1,or=0;or<109&&(Qt=nt.read_shift(4,"i"),!(Qt<0));++or)We[or]=Qt;var Ar=P(te,Q);K(ke,le,Ar,Q,We);var qr=ne(Ar,De,We,Q);qr[De].name="!Directory",se>0&&Ze!==Qe&&(qr[Ze].name="!MiniFAT"),qr[We[0]].name="!FAT",qr.fat_addrs=We,qr.ssz=Q;var wr={},Ei=[],mi=[],Ti=[];he(De,qr,Ar,Ei,se,wr,mi,Ze),ee(mi,Ti,Ei),Ei.shift();var An={FileIndex:mi,FullPaths:Ti};return U&&U.raw&&(An.raw={header:Ft,sectors:Ar}),An}function j(te){if(te[te.l]==80&&te[te.l+1]==75)return[0,0];te.chk(Ce,"Header Signature: "),te.l+=16;var U=te.read_shift(2,"u");return[te.read_shift(2,"u"),U]}function B(te,U){var W=9;switch(te.l+=2,W=te.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+W);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+W);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+W)}te.chk("0600","Mini Sector Shift: "),te.chk("000000000000","Reserved: ")}function P(te,U){for(var W=Math.ceil(te.length/U)-1,Q=[],se=1;se<W;++se)Q[se-1]=te.slice(se*U,(se+1)*U);return Q[W-1]=te.slice(W*U),Q}function ee(te,U,W){for(var Q=0,se=0,le=0,De=0,Ze=0,ke=W.length,We=[],nt=[];Q<ke;++Q)We[Q]=nt[Q]=Q,U[Q]=W[Q];for(;Ze<nt.length;++Ze)Q=nt[Ze],se=te[Q].L,le=te[Q].R,De=te[Q].C,We[Q]===Q&&(se!==-1&&We[se]!==se&&(We[Q]=We[se]),le!==-1&&We[le]!==le&&(We[Q]=We[le])),De!==-1&&(We[De]=Q),se!==-1&&Q!=We[Q]&&(We[se]=We[Q],nt.lastIndexOf(se)<Ze&&nt.push(se)),le!==-1&&Q!=We[Q]&&(We[le]=We[Q],nt.lastIndexOf(le)<Ze&&nt.push(le));for(Q=1;Q<ke;++Q)We[Q]===Q&&(le!==-1&&We[le]!==le?We[Q]=We[le]:se!==-1&&We[se]!==se&&(We[Q]=We[se]));for(Q=1;Q<ke;++Q)if(te[Q].type!==0){if(Ze=Q,Ze!=We[Ze])do Ze=We[Ze],U[Q]=U[Ze]+"/"+U[Q];while(Ze!==0&&We[Ze]!==-1&&Ze!=We[Ze]);We[Q]=-1}for(U[0]+="/",Q=1;Q<ke;++Q)te[Q].type!==2&&(U[Q]+="/")}function G(te,U,W){for(var Q=te.start,se=te.size,le=[],De=Q;W&&se>0&&De>=0;)le.push(U.slice(De*ve,De*ve+ve)),se-=ve,De=vm(W,De*4);return le.length===0?cr(0):Js(le).slice(0,te.size)}function K(te,U,W,Q,se){var le=Qe;if(te===Qe){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(te!==-1){var De=W[te],Ze=(Q>>>2)-1;if(!De)return;for(var ke=0;ke<Ze&&(le=vm(De,ke*4))!==Qe;++ke)se.push(le);K(vm(De,Q-4),U-1,W,Q,se)}}function J(te,U,W,Q,se){var le=[],De=[];se||(se=[]);var Ze=Q-1,ke=0,We=0;for(ke=U;ke>=0;){se[ke]=!0,le[le.length]=ke,De.push(te[ke]);var nt=W[Math.floor(ke*4/Q)];if(We=ke*4&Ze,Q<4+We)throw new Error("FAT boundary crossed: "+ke+" 4 "+Q);if(!te[nt])break;ke=vm(te[nt],We)}return{nodes:le,data:ck([De])}}function ne(te,U,W,Q){var se=te.length,le=[],De=[],Ze=[],ke=[],We=Q-1,nt=0,dt=0,Ft=0,tr=0;for(nt=0;nt<se;++nt)if(Ze=[],Ft=nt+U,Ft>=se&&(Ft-=se),!De[Ft]){ke=[];var Qt=[];for(dt=Ft;dt>=0;){Qt[dt]=!0,De[dt]=!0,Ze[Ze.length]=dt,ke.push(te[dt]);var or=W[Math.floor(dt*4/Q)];if(tr=dt*4&We,Q<4+tr)throw new Error("FAT boundary crossed: "+dt+" 4 "+Q);if(!te[or]||(dt=vm(te[or],tr),Qt[dt]))break}le[Ft]={nodes:Ze,data:ck([ke])}}return le}function he(te,U,W,Q,se,le,De,Ze){for(var ke=0,We=Q.length?2:0,nt=U[te].data,dt=0,Ft=0,tr;dt<nt.length;dt+=128){var Qt=nt.slice(dt,dt+128);qc(Qt,64),Ft=Qt.read_shift(2),tr=Cx(Qt,0,Ft-We),Q.push(tr);var or={name:tr,type:Qt.read_shift(1),color:Qt.read_shift(1),L:Qt.read_shift(4,"i"),R:Qt.read_shift(4,"i"),C:Qt.read_shift(4,"i"),clsid:Qt.read_shift(16),state:Qt.read_shift(4,"i"),start:0,size:0},Ar=Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2);Ar!==0&&(or.ct=Me(Qt,Qt.l-8));var qr=Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2);qr!==0&&(or.mt=Me(Qt,Qt.l-8)),or.start=Qt.read_shift(4,"i"),or.size=Qt.read_shift(4,"i"),or.size<0&&or.start<0&&(or.size=or.type=0,or.start=Qe,or.name=""),or.type===5?(ke=or.start,se>0&&ke!==Qe&&(U[ke].name="!StreamData")):or.size>=4096?(or.storage="fat",U[or.start]===void 0&&(U[or.start]=J(W,or.start,U.fat_addrs,U.ssz)),U[or.start].name=or.name,or.content=U[or.start].data.slice(0,or.size)):(or.storage="minifat",or.size<0?or.size=0:ke!==Qe&&or.start!==Qe&&U[ke]&&(or.content=G(or,U[ke].data,(U[Ze]||{}).data))),or.content&&qc(or.content,0),le[tr]=or,De.push(or)}}function Me(te,U){return new Date((Rs(te,U+4)/1e7*Math.pow(2,32)+Rs(te,U)/1e7-11644473600)*1e3)}function Re(te,U){return k(),D(E.readFileSync(te),U)}function et(te,U){var W=U&&U.type;switch(W||oa&&Buffer.isBuffer(te)&&(W="buffer"),W||"base64"){case"file":return Re(te,U);case"base64":return D(mh(hf(te)),U);case"binary":return D(mh(te),U)}return D(te,U)}function Te(te,U){var W=U||{},Q=W.root||"Root Entry";if(te.FullPaths||(te.FullPaths=[]),te.FileIndex||(te.FileIndex=[]),te.FullPaths.length!==te.FileIndex.length)throw new Error("inconsistent CFB structure");te.FullPaths.length===0&&(te.FullPaths[0]=Q+"/",te.FileIndex[0]={name:Q,type:5}),W.CLSID&&(te.FileIndex[0].clsid=W.CLSID),ge(te)}function ge(te){var U="Sh33tJ5";if(!La.find(te,"/"+U)){var W=cr(4);W[0]=55,W[1]=W[3]=50,W[2]=54,te.FileIndex.push({name:U,type:2,content:W,size:4,L:69,R:69,C:69}),te.FullPaths.push(te.FullPaths[0]+U),Ue(te)}}function Ue(te,U){Te(te);for(var W=!1,Q=!1,se=te.FullPaths.length-1;se>=0;--se){var le=te.FileIndex[se];switch(le.type){case 0:Q?W=!0:(te.FileIndex.pop(),te.FullPaths.pop());break;case 1:case 2:case 5:Q=!0,isNaN(le.R*le.L*le.C)&&(W=!0),le.R>-1&&le.L>-1&&le.R==le.L&&(W=!0);break;default:W=!0;break}}if(!(!W&&!U)){var De=new Date(1987,1,19),Ze=0,ke=Object.create?Object.create(null):{},We=[];for(se=0;se<te.FullPaths.length;++se)ke[te.FullPaths[se]]=!0,te.FileIndex[se].type!==0&&We.push([te.FullPaths[se],te.FileIndex[se]]);for(se=0;se<We.length;++se){var nt=c(We[se][0]);Q=ke[nt],Q||(We.push([nt,{name:u(nt).replace("/",""),type:1,clsid:ut,ct:De,mt:De,content:null}]),ke[nt]=!0)}for(We.sort(function(tr,Qt){return o(tr[0],Qt[0])}),te.FullPaths=[],te.FileIndex=[],se=0;se<We.length;++se)te.FullPaths[se]=We[se][0],te.FileIndex[se]=We[se][1];for(se=0;se<We.length;++se){var dt=te.FileIndex[se],Ft=te.FullPaths[se];if(dt.name=u(Ft).replace("/",""),dt.L=dt.R=dt.C=-(dt.color=1),dt.size=dt.content?dt.content.length:0,dt.start=0,dt.clsid=dt.clsid||ut,se===0)dt.C=We.length>1?1:-1,dt.size=0,dt.type=5;else if(Ft.slice(-1)=="/"){for(Ze=se+1;Ze<We.length&&c(te.FullPaths[Ze])!=Ft;++Ze);for(dt.C=Ze>=We.length?-1:Ze,Ze=se+1;Ze<We.length&&c(te.FullPaths[Ze])!=c(Ft);++Ze);dt.R=Ze>=We.length?-1:Ze,dt.type=1}else c(te.FullPaths[se+1]||"")==c(Ft)&&(dt.R=se+1),dt.type=2}}}function Ae(te,U){var W=U||{};if(W.fileType=="mad")return Qr(te,W);switch(Ue(te),W.fileType){case"zip":return Co(te,W)}var Q=function(tr){for(var Qt=0,or=0,Ar=0;Ar<tr.FileIndex.length;++Ar){var qr=tr.FileIndex[Ar];if(qr.content){var wr=qr.content.length;wr>0&&(wr<4096?Qt+=wr+63>>6:or+=wr+511>>9)}}for(var Ei=tr.FullPaths.length+3>>2,mi=Qt+7>>3,Ti=Qt+127>>7,An=mi+or+Ei+Ti,ln=An+127>>7,Rn=ln<=109?0:Math.ceil((ln-109)/127);An+ln+Rn+127>>7>ln;)Rn=++ln<=109?0:Math.ceil((ln-109)/127);var Hn=[1,Rn,ln,Ti,Ei,or,Qt,0];return tr.FileIndex[0].size=Qt<<6,Hn[7]=(tr.FileIndex[0].start=Hn[0]+Hn[1]+Hn[2]+Hn[3]+Hn[4]+Hn[5])+(Hn[6]+7>>3),Hn}(te),se=cr(Q[7]<<9),le=0,De=0;{for(le=0;le<8;++le)se.write_shift(1,Ye[le]);for(le=0;le<8;++le)se.write_shift(2,0);for(se.write_shift(2,62),se.write_shift(2,3),se.write_shift(2,65534),se.write_shift(2,9),se.write_shift(2,6),le=0;le<3;++le)se.write_shift(2,0);for(se.write_shift(4,0),se.write_shift(4,Q[2]),se.write_shift(4,Q[0]+Q[1]+Q[2]+Q[3]-1),se.write_shift(4,0),se.write_shift(4,4096),se.write_shift(4,Q[3]?Q[0]+Q[1]+Q[2]-1:Qe),se.write_shift(4,Q[3]),se.write_shift(-4,Q[1]?Q[0]-1:Qe),se.write_shift(4,Q[1]),le=0;le<109;++le)se.write_shift(-4,le<Q[2]?Q[1]+le:-1)}if(Q[1])for(De=0;De<Q[1];++De){for(;le<236+De*127;++le)se.write_shift(-4,le<Q[2]?Q[1]+le:-1);se.write_shift(-4,De===Q[1]-1?Qe:De+1)}var Ze=function(tr){for(De+=tr;le<De-1;++le)se.write_shift(-4,le+1);tr&&(++le,se.write_shift(-4,Qe))};for(De=le=0,De+=Q[1];le<De;++le)se.write_shift(-4,st.DIFSECT);for(De+=Q[2];le<De;++le)se.write_shift(-4,st.FATSECT);Ze(Q[3]),Ze(Q[4]);for(var ke=0,We=0,nt=te.FileIndex[0];ke<te.FileIndex.length;++ke)nt=te.FileIndex[ke],nt.content&&(We=nt.content.length,!(We<4096)&&(nt.start=De,Ze(We+511>>9)));for(Ze(Q[6]+7>>3);se.l&511;)se.write_shift(-4,st.ENDOFCHAIN);for(De=le=0,ke=0;ke<te.FileIndex.length;++ke)nt=te.FileIndex[ke],nt.content&&(We=nt.content.length,!(!We||We>=4096)&&(nt.start=De,Ze(We+63>>6)));for(;se.l&511;)se.write_shift(-4,st.ENDOFCHAIN);for(le=0;le<Q[4]<<2;++le){var dt=te.FullPaths[le];if(!dt||dt.length===0){for(ke=0;ke<17;++ke)se.write_shift(4,0);for(ke=0;ke<3;++ke)se.write_shift(4,-1);for(ke=0;ke<12;++ke)se.write_shift(4,0);continue}nt=te.FileIndex[le],le===0&&(nt.start=nt.size?nt.start-1:Qe);var Ft=le===0&&W.root||nt.name;if(We=2*(Ft.length+1),se.write_shift(64,Ft,"utf16le"),se.write_shift(2,We),se.write_shift(1,nt.type),se.write_shift(1,nt.color),se.write_shift(-4,nt.L),se.write_shift(-4,nt.R),se.write_shift(-4,nt.C),nt.clsid)se.write_shift(16,nt.clsid,"hex");else for(ke=0;ke<4;++ke)se.write_shift(4,0);se.write_shift(4,nt.state||0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,0),se.write_shift(4,nt.start),se.write_shift(4,nt.size),se.write_shift(4,0)}for(le=1;le<te.FileIndex.length;++le)if(nt=te.FileIndex[le],nt.size>=4096)if(se.l=nt.start+1<<9,oa&&Buffer.isBuffer(nt.content))nt.content.copy(se,se.l,0,nt.size),se.l+=nt.size+511&-512;else{for(ke=0;ke<nt.size;++ke)se.write_shift(1,nt.content[ke]);for(;ke&511;++ke)se.write_shift(1,0)}for(le=1;le<te.FileIndex.length;++le)if(nt=te.FileIndex[le],nt.size>0&&nt.size<4096)if(oa&&Buffer.isBuffer(nt.content))nt.content.copy(se,se.l,0,nt.size),se.l+=nt.size+63&-64;else{for(ke=0;ke<nt.size;++ke)se.write_shift(1,nt.content[ke]);for(;ke&63;++ke)se.write_shift(1,0)}if(oa)se.l=se.length;else for(;se.l<se.length;)se.write_shift(1,0);return se}function _e(te,U){var W=te.FullPaths.map(function(ke){return ke.toUpperCase()}),Q=W.map(function(ke){var We=ke.split("/");return We[We.length-(ke.slice(-1)=="/"?2:1)]}),se=!1;U.charCodeAt(0)===47?(se=!0,U=W[0].slice(0,-1)+U):se=U.indexOf("/")!==-1;var le=U.toUpperCase(),De=se===!0?W.indexOf(le):Q.indexOf(le);if(De!==-1)return te.FileIndex[De];var Ze=!le.match(tx);for(le=le.replace(rg,""),Ze&&(le=le.replace(tx,"!")),De=0;De<W.length;++De)if((Ze?W[De].replace(tx,"!"):W[De]).replace(rg,"")==le||(Ze?Q[De].replace(tx,"!"):Q[De]).replace(rg,"")==le)return te.FileIndex[De];return null}var ve=64,Qe=-2,Ce="d0cf11e0a1b11ae1",Ye=[208,207,17,224,161,177,26,225],ut="00000000000000000000000000000000",st={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Qe,FREESECT:-1,HEADER_SIGNATURE:Ce,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ut,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function pt(te,U,W){k();var Q=Ae(te,W);E.writeFileSync(U,Q)}function Tt(te){for(var U=new Array(te.length),W=0;W<te.length;++W)U[W]=String.fromCharCode(te[W]);return U.join("")}function ht(te,U){var W=Ae(te,U);switch(U&&U.type||"buffer"){case"file":return k(),E.writeFileSync(U.filename,W),W;case"binary":return typeof W=="string"?W:Tt(W);case"base64":return l1(typeof W=="string"?W:Tt(W));case"buffer":if(oa)return Buffer.isBuffer(W)?W:ff(W);case"array":return typeof W=="string"?mh(W):W}return W}var Wt;function re(te){try{var U=te.InflateRaw,W=new U;if(W._processChunk(new Uint8Array([3,0]),W._finishFlushFlag),W.bytesRead)Wt=te;else throw new Error("zlib does not expose bytesRead")}catch(Q){console.error("cannot use native zlib: "+(Q.message||Q))}}function xe(te,U){if(!Wt)return Qi(te,U);var W=Wt.InflateRaw,Q=new W,se=Q._processChunk(te.slice(te.l),Q._finishFlushFlag);return te.l+=Q.bytesRead,se}function pe(te){return Wt?Wt.deflateRawSync(te):Ui(te)}var Ie=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ve=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],gt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function mt(te){var U=(te<<1|te<<11)&139536|(te<<5|te<<15)&558144;return(U>>16|U>>8|U)&255}for(var wt=typeof Uint8Array<"u",Pt=wt?new Uint8Array(256):[],fr=0;fr<256;++fr)Pt[fr]=mt(fr);function xr(te,U){var W=Pt[te&255];return U<=8?W>>>8-U:(W=W<<8|Pt[te>>8&255],U<=16?W>>>16-U:(W=W<<8|Pt[te>>16&255],W>>>24-U))}function Rr(te,U){var W=U&7,Q=U>>>3;return(te[Q]|(W<=6?0:te[Q+1]<<8))>>>W&3}function Fr(te,U){var W=U&7,Q=U>>>3;return(te[Q]|(W<=5?0:te[Q+1]<<8))>>>W&7}function $t(te,U){var W=U&7,Q=U>>>3;return(te[Q]|(W<=4?0:te[Q+1]<<8))>>>W&15}function lt(te,U){var W=U&7,Q=U>>>3;return(te[Q]|(W<=3?0:te[Q+1]<<8))>>>W&31}function Bt(te,U){var W=U&7,Q=U>>>3;return(te[Q]|(W<=1?0:te[Q+1]<<8))>>>W&127}function nr(te,U,W){var Q=U&7,se=U>>>3,le=(1<<W)-1,De=te[se]>>>Q;return W<8-Q||(De|=te[se+1]<<8-Q,W<16-Q)||(De|=te[se+2]<<16-Q,W<24-Q)||(De|=te[se+3]<<24-Q),De&le}function br(te,U,W){var Q=U&7,se=U>>>3;return Q<=5?te[se]|=(W&7)<<Q:(te[se]|=W<<Q&255,te[se+1]=(W&7)>>8-Q),U+3}function kr(te,U,W){var Q=U&7,se=U>>>3;return W=(W&1)<<Q,te[se]|=W,U+1}function Nr(te,U,W){var Q=U&7,se=U>>>3;return W<<=Q,te[se]|=W&255,W>>>=8,te[se+1]=W,U+8}function Br(te,U,W){var Q=U&7,se=U>>>3;return W<<=Q,te[se]|=W&255,W>>>=8,te[se+1]=W&255,te[se+2]=W>>>8,U+16}function ii(te,U){var W=te.length,Q=2*W>U?2*W:U+5,se=0;if(W>=U)return te;if(oa){var le=X4(Q);if(te.copy)te.copy(le);else for(;se<te.length;++se)le[se]=te[se];return le}else if(wt){var De=new Uint8Array(Q);if(De.set)De.set(te);else for(;se<W;++se)De[se]=te[se];return De}return te.length=Q,te}function si(te){for(var U=new Array(te),W=0;W<te;++W)U[W]=0;return U}function wi(te,U,W){var Q=1,se=0,le=0,De=0,Ze=0,ke=te.length,We=wt?new Uint16Array(32):si(32);for(le=0;le<32;++le)We[le]=0;for(le=ke;le<W;++le)te[le]=0;ke=te.length;var nt=wt?new Uint16Array(ke):si(ke);for(le=0;le<ke;++le)We[se=te[le]]++,Q<se&&(Q=se),nt[le]=0;for(We[0]=0,le=1;le<=Q;++le)We[le+16]=Ze=Ze+We[le-1]<<1;for(le=0;le<ke;++le)Ze=te[le],Ze!=0&&(nt[le]=We[Ze+16]++);var dt=0;for(le=0;le<ke;++le)if(dt=te[le],dt!=0)for(Ze=xr(nt[le],Q)>>Q-dt,De=(1<<Q+4-dt)-1;De>=0;--De)U[Ze|De<<dt]=dt&15|le<<4;return Q}var Ri=wt?new Uint16Array(512):si(512),Ji=wt?new Uint16Array(32):si(32);if(!wt){for(var an=0;an<512;++an)Ri[an]=0;for(an=0;an<32;++an)Ji[an]=0}(function(){for(var te=[],U=0;U<32;U++)te.push(5);wi(te,Ji,32);var W=[];for(U=0;U<=143;U++)W.push(8);for(;U<=255;U++)W.push(9);for(;U<=279;U++)W.push(7);for(;U<=287;U++)W.push(8);wi(W,Ri,288)})();var xi=function(){for(var U=wt?new Uint8Array(32768):[],W=0,Q=0;W<gt.length-1;++W)for(;Q<gt[W+1];++Q)U[Q]=W;for(;Q<32768;++Q)U[Q]=29;var se=wt?new Uint8Array(259):[];for(W=0,Q=0;W<Ve.length-1;++W)for(;Q<Ve[W+1];++Q)se[Q]=W;function le(Ze,ke){for(var We=0;We<Ze.length;){var nt=Math.min(65535,Ze.length-We),dt=We+nt==Ze.length;for(ke.write_shift(1,+dt),ke.write_shift(2,nt),ke.write_shift(2,~nt&65535);nt-- >0;)ke[ke.l++]=Ze[We++]}return ke.l}function De(Ze,ke){for(var We=0,nt=0,dt=wt?new Uint16Array(32768):[];nt<Ze.length;){var Ft=Math.min(65535,Ze.length-nt);if(Ft<10){for(We=br(ke,We,+(nt+Ft==Ze.length)),We&7&&(We+=8-(We&7)),ke.l=We/8|0,ke.write_shift(2,Ft),ke.write_shift(2,~Ft&65535);Ft-- >0;)ke[ke.l++]=Ze[nt++];We=ke.l*8;continue}We=br(ke,We,+(nt+Ft==Ze.length)+2);for(var tr=0;Ft-- >0;){var Qt=Ze[nt];tr=(tr<<5^Qt)&32767;var or=-1,Ar=0;if((or=dt[tr])&&(or|=nt&-32768,or>nt&&(or-=32768),or<nt))for(;Ze[or+Ar]==Ze[nt+Ar]&&Ar<250;)++Ar;if(Ar>2){Qt=se[Ar],Qt<=22?We=Nr(ke,We,Pt[Qt+1]>>1)-1:(Nr(ke,We,3),We+=5,Nr(ke,We,Pt[Qt-23]>>5),We+=3);var qr=Qt<8?0:Qt-4>>2;qr>0&&(Br(ke,We,Ar-Ve[Qt]),We+=qr),Qt=U[nt-or],We=Nr(ke,We,Pt[Qt]>>3),We-=3;var wr=Qt<4?0:Qt-2>>1;wr>0&&(Br(ke,We,nt-or-gt[Qt]),We+=wr);for(var Ei=0;Ei<Ar;++Ei)dt[tr]=nt&32767,tr=(tr<<5^Ze[nt])&32767,++nt;Ft-=Ar-1}else Qt<=143?Qt=Qt+48:We=kr(ke,We,1),We=Nr(ke,We,Pt[Qt]),dt[tr]=nt&32767,++nt}We=Nr(ke,We,0)-1}return ke.l=(We+7)/8|0,ke.l}return function(ke,We){return ke.length<8?le(ke,We):De(ke,We)}}();function Ui(te){var U=cr(50+Math.floor(te.length*1.1)),W=xi(te,U);return U.slice(0,W)}var Lr=wt?new Uint16Array(32768):si(32768),Ua=wt?new Uint16Array(32768):si(32768),Dr=wt?new Uint16Array(128):si(128),Eo=1,gi=1;function Dn(te,U){var W=lt(te,U)+257;U+=5;var Q=lt(te,U)+1;U+=5;var se=$t(te,U)+4;U+=4;for(var le=0,De=wt?new Uint8Array(19):si(19),Ze=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ke=1,We=wt?new Uint8Array(8):si(8),nt=wt?new Uint8Array(8):si(8),dt=De.length,Ft=0;Ft<se;++Ft)De[Ie[Ft]]=le=Fr(te,U),ke<le&&(ke=le),We[le]++,U+=3;var tr=0;for(We[0]=0,Ft=1;Ft<=ke;++Ft)nt[Ft]=tr=tr+We[Ft-1]<<1;for(Ft=0;Ft<dt;++Ft)(tr=De[Ft])!=0&&(Ze[Ft]=nt[tr]++);var Qt=0;for(Ft=0;Ft<dt;++Ft)if(Qt=De[Ft],Qt!=0){tr=Pt[Ze[Ft]]>>8-Qt;for(var or=(1<<7-Qt)-1;or>=0;--or)Dr[tr|or<<Qt]=Qt&7|Ft<<3}var Ar=[];for(ke=1;Ar.length<W+Q;)switch(tr=Dr[Bt(te,U)],U+=tr&7,tr>>>=3){case 16:for(le=3+Rr(te,U),U+=2,tr=Ar[Ar.length-1];le-- >0;)Ar.push(tr);break;case 17:for(le=3+Fr(te,U),U+=3;le-- >0;)Ar.push(0);break;case 18:for(le=11+Bt(te,U),U+=7;le-- >0;)Ar.push(0);break;default:Ar.push(tr),ke<tr&&(ke=tr);break}var qr=Ar.slice(0,W),wr=Ar.slice(W);for(Ft=W;Ft<286;++Ft)qr[Ft]=0;for(Ft=Q;Ft<30;++Ft)wr[Ft]=0;return Eo=wi(qr,Lr,286),gi=wi(wr,Ua,30),U}function Ao(te,U){if(te[0]==3&&!(te[1]&3))return[bm(U),2];for(var W=0,Q=0,se=X4(U||1<<18),le=0,De=se.length>>>0,Ze=0,ke=0;!(Q&1);){if(Q=Fr(te,W),W+=3,Q>>>1)Q>>1==1?(Ze=9,ke=5):(W=Dn(te,W),Ze=Eo,ke=gi);else{W&7&&(W+=8-(W&7));var We=te[W>>>3]|te[(W>>>3)+1]<<8;if(W+=32,We>0)for(!U&&De<le+We&&(se=ii(se,le+We),De=se.length);We-- >0;)se[le++]=te[W>>>3],W+=8;continue}for(;;){!U&&De<le+32767&&(se=ii(se,le+32767),De=se.length);var nt=nr(te,W,Ze),dt=Q>>>1==1?Ri[nt]:Lr[nt];if(W+=dt&15,dt>>>=4,!(dt>>>8&255))se[le++]=dt;else{if(dt==256)break;dt-=257;var Ft=dt<8?0:dt-4>>2;Ft>5&&(Ft=0);var tr=le+Ve[dt];Ft>0&&(tr+=nr(te,W,Ft),W+=Ft),nt=nr(te,W,ke),dt=Q>>>1==1?Ji[nt]:Ua[nt],W+=dt&15,dt>>>=4;var Qt=dt<4?0:dt-2>>1,or=gt[dt];for(Qt>0&&(or+=nr(te,W,Qt),W+=Qt),!U&&De<tr&&(se=ii(se,tr+100),De=se.length);le<tr;)se[le]=se[le-or],++le}}}return U?[se,W+7>>>3]:[se.slice(0,le),W+7>>>3]}function Qi(te,U){var W=te.slice(te.l||0),Q=Ao(W,U);return te.l+=Q[1],Q[0]}function _o(te,U){if(te)typeof console<"u"&&console.error(U);else throw new Error(U)}function Gn(te,U){var W=te;qc(W,0);var Q=[],se=[],le={FileIndex:Q,FullPaths:se};Te(le,{root:U.root});for(var De=W.length-4;(W[De]!=80||W[De+1]!=75||W[De+2]!=5||W[De+3]!=6)&&De>=0;)--De;W.l=De+4,W.l+=4;var Ze=W.read_shift(2);W.l+=6;var ke=W.read_shift(4);for(W.l=ke,De=0;De<Ze;++De){W.l+=20;var We=W.read_shift(4),nt=W.read_shift(4),dt=W.read_shift(2),Ft=W.read_shift(2),tr=W.read_shift(2);W.l+=8;var Qt=W.read_shift(4),or=T(W.slice(W.l+dt,W.l+dt+Ft));W.l+=dt+Ft+tr;var Ar=W.l;W.l=Qt+4,oo(W,We,nt,le,or),W.l=Ar}return le}function oo(te,U,W,Q,se){te.l+=2;var le=te.read_shift(2),De=te.read_shift(2),Ze=_(te);if(le&8257)throw new Error("Unsupported ZIP encryption");for(var ke=te.read_shift(4),We=te.read_shift(4),nt=te.read_shift(4),dt=te.read_shift(2),Ft=te.read_shift(2),tr="",Qt=0;Qt<dt;++Qt)tr+=String.fromCharCode(te[te.l++]);if(Ft){var or=T(te.slice(te.l,te.l+Ft));(or[21589]||{}).mt&&(Ze=or[21589].mt),((se||{})[21589]||{}).mt&&(Ze=se[21589].mt)}te.l+=Ft;var Ar=te.slice(te.l,te.l+We);switch(De){case 8:Ar=xe(te,nt);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+De)}var qr=!1;le&8&&(ke=te.read_shift(4),ke==134695760&&(ke=te.read_shift(4),qr=!0),We=te.read_shift(4),nt=te.read_shift(4)),We!=U&&_o(qr,"Bad compressed size: "+U+" != "+We),nt!=W&&_o(qr,"Bad uncompressed size: "+W+" != "+nt),so(Q,tr,Ar,{unsafe:!0,mt:Ze})}function Co(te,U){var W=U||{},Q=[],se=[],le=cr(1),De=W.compression?8:0,Ze=0,ke=!1;ke&&(Ze|=8);var We=0,nt=0,dt=0,Ft=0,tr=te.FullPaths[0],Qt=tr,or=te.FileIndex[0],Ar=[],qr=0;for(We=1;We<te.FullPaths.length;++We)if(Qt=te.FullPaths[We].slice(tr.length),or=te.FileIndex[We],!(!or.size||!or.content||Qt=="Sh33tJ5")){var wr=dt,Ei=cr(Qt.length);for(nt=0;nt<Qt.length;++nt)Ei.write_shift(1,Qt.charCodeAt(nt)&127);Ei=Ei.slice(0,Ei.l),Ar[Ft]=cz.buf(or.content,0);var mi=or.content;De==8&&(mi=pe(mi)),le=cr(30),le.write_shift(4,67324752),le.write_shift(2,20),le.write_shift(2,Ze),le.write_shift(2,De),or.mt?r(le,or.mt):le.write_shift(4,0),le.write_shift(-4,Ze&8?0:Ar[Ft]),le.write_shift(4,Ze&8?0:mi.length),le.write_shift(4,Ze&8?0:or.content.length),le.write_shift(2,Ei.length),le.write_shift(2,0),dt+=le.length,Q.push(le),dt+=Ei.length,Q.push(Ei),dt+=mi.length,Q.push(mi),Ze&8&&(le=cr(12),le.write_shift(-4,Ar[Ft]),le.write_shift(4,mi.length),le.write_shift(4,or.content.length),dt+=le.l,Q.push(le)),le=cr(46),le.write_shift(4,33639248),le.write_shift(2,0),le.write_shift(2,20),le.write_shift(2,Ze),le.write_shift(2,De),le.write_shift(4,0),le.write_shift(-4,Ar[Ft]),le.write_shift(4,mi.length),le.write_shift(4,or.content.length),le.write_shift(2,Ei.length),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(4,0),le.write_shift(4,wr),qr+=le.l,se.push(le),qr+=Ei.length,se.push(Ei),++Ft}return le=cr(22),le.write_shift(4,101010256),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(2,Ft),le.write_shift(2,Ft),le.write_shift(4,qr),le.write_shift(4,dt),le.write_shift(2,0),Js([Js(Q),Js(se),le])}var Cn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ki(te,U){if(te.ctype)return te.ctype;var W=te.name||"",Q=W.match(/\.([^\.]+)$/);return Q&&Cn[Q[1]]||U&&(Q=(W=U).match(/[\.\\]([^\.\\])+$/),Q&&Cn[Q[1]])?Cn[Q[1]]:"application/octet-stream"}function yn(te){for(var U=l1(te),W=[],Q=0;Q<U.length;Q+=76)W.push(U.slice(Q,Q+76));return W.join(`\r
`)+`\r
`}function ms(te){var U=te.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(We){var nt=We.charCodeAt(0).toString(16).toUpperCase();return"="+(nt.length==1?"0"+nt:nt)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var W=[],Q=U.split(`\r
`),se=0;se<Q.length;++se){var le=Q[se];if(le.length==0){W.push("");continue}for(var De=0;De<le.length;){var Ze=76,ke=le.slice(De,De+Ze);ke.charAt(Ze-1)=="="?Ze--:ke.charAt(Ze-2)=="="?Ze-=2:ke.charAt(Ze-3)=="="&&(Ze-=3),ke=le.slice(De,De+Ze),De+=Ze,De<le.length&&(ke+="="),W.push(ke)}}return W.join(`\r
`)}function On(te){for(var U=[],W=0;W<te.length;++W){for(var Q=te[W];W<=te.length&&Q.charAt(Q.length-1)=="=";)Q=Q.slice(0,Q.length-1)+te[++W];U.push(Q)}for(var se=0;se<U.length;++se)U[se]=U[se].replace(/[=][0-9A-Fa-f]{2}/g,function(le){return String.fromCharCode(parseInt(le.slice(1),16))});return mh(U.join(`\r
`))}function vo(te,U,W){for(var Q="",se="",le="",De,Ze=0;Ze<10;++Ze){var ke=U[Ze];if(!ke||ke.match(/^\s*$/))break;var We=ke.match(/^(.*?):\s*([^\s].*)$/);if(We)switch(We[1].toLowerCase()){case"content-location":Q=We[2].trim();break;case"content-type":le=We[2].trim();break;case"content-transfer-encoding":se=We[2].trim();break}}switch(++Ze,se.toLowerCase()){case"base64":De=mh(hf(U.slice(Ze).join("")));break;case"quoted-printable":De=On(U.slice(Ze));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+se)}var nt=so(te,Q.slice(W.length),De,{unsafe:!0});le&&(nt.ctype=le)}function Oa(te,U){if(Tt(te.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var W=U&&U.root||"",Q=(oa&&Buffer.isBuffer(te)?te.toString("binary"):Tt(te)).split(`\r
`),se=0,le="";for(se=0;se<Q.length;++se)if(le=Q[se],!!/^Content-Location:/i.test(le)&&(le=le.slice(le.indexOf("file")),W||(W=le.slice(0,le.lastIndexOf("/")+1)),le.slice(0,W.length)!=W))for(;W.length>0&&(W=W.slice(0,W.length-1),W=W.slice(0,W.lastIndexOf("/")+1),le.slice(0,W.length)!=W););var De=(Q[1]||"").match(/boundary="(.*?)"/);if(!De)throw new Error("MAD cannot find boundary");var Ze="--"+(De[1]||""),ke=[],We=[],nt={FileIndex:ke,FullPaths:We};Te(nt);var dt,Ft=0;for(se=0;se<Q.length;++se){var tr=Q[se];tr!==Ze&&tr!==Ze+"--"||(Ft++&&vo(nt,Q.slice(dt,se),W),dt=se)}return nt}function Qr(te,U){var W=U||{},Q=W.boundary||"SheetJS";Q="------="+Q;for(var se=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Q.slice(2)+'"',"","",""],le=te.FullPaths[0],De=le,Ze=te.FileIndex[0],ke=1;ke<te.FullPaths.length;++ke)if(De=te.FullPaths[ke].slice(le.length),Ze=te.FileIndex[ke],!(!Ze.size||!Ze.content||De=="Sh33tJ5")){De=De.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ar){return"_x"+Ar.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ar){return"_u"+Ar.charCodeAt(0).toString(16)+"_"});for(var We=Ze.content,nt=oa&&Buffer.isBuffer(We)?We.toString("binary"):Tt(We),dt=0,Ft=Math.min(1024,nt.length),tr=0,Qt=0;Qt<=Ft;++Qt)(tr=nt.charCodeAt(Qt))>=32&&tr<128&&++dt;var or=dt>=Ft*4/5;se.push(Q),se.push("Content-Location: "+(W.root||"file:///C:/SheetJS/")+De),se.push("Content-Transfer-Encoding: "+(or?"quoted-printable":"base64")),se.push("Content-Type: "+ki(Ze,De)),se.push(""),se.push(or?ms(nt):yn(nt))}return se.push(Q+`--\r
`),se.join(`\r
`)}function Vo(te){var U={};return Te(U,te),U}function so(te,U,W,Q){var se=Q&&Q.unsafe;se||Te(te);var le=!se&&La.find(te,U);if(!le){var De=te.FullPaths[0];U.slice(0,De.length)==De?De=U:(De.slice(-1)!="/"&&(De+="/"),De=(De+U).replace("//","/")),le={name:u(U),type:2},te.FileIndex.push(le),te.FullPaths.push(De),se||La.utils.cfb_gc(te)}return le.content=W,le.size=W?W.length:0,Q&&(Q.CLSID&&(le.clsid=Q.CLSID),Q.mt&&(le.mt=Q.mt),Q.ct&&(le.ct=Q.ct)),le}function Za(te,U){Te(te);var W=La.find(te,U);if(W){for(var Q=0;Q<te.FileIndex.length;++Q)if(te.FileIndex[Q]==W)return te.FileIndex.splice(Q,1),te.FullPaths.splice(Q,1),!0}return!1}function _a(te,U,W){Te(te);var Q=La.find(te,U);if(Q){for(var se=0;se<te.FileIndex.length;++se)if(te.FileIndex[se]==Q)return te.FileIndex[se].name=u(W),te.FullPaths[se]=W,!0}return!1}function Jn(te){Ue(te,!0)}return i.find=_e,i.read=et,i.parse=D,i.write=ht,i.writeFile=pt,i.utils={cfb_new:Vo,cfb_add:so,cfb_del:Za,cfb_mov:_a,cfb_gc:Jn,ReadShift:r1,CheckField:aM,prep_blob:qc,bconcat:Js,use_zlib:re,_deflateRaw:Ui,_inflateRaw:Qi,consts:st},i}(),ix;function uz(a){return typeof a=="string"?wx(a):Array.isArray(a)?OB(a):a}function p1(a,i,o){if(typeof ix<"u"&&ix.writeFileSync)return o?ix.writeFileSync(a,i,o):ix.writeFileSync(a,i);if(typeof Deno<"u"){if(o&&typeof i=="string")switch(o){case"utf8":i=new TextEncoder(o).encode(i);break;case"binary":i=wx(i);break;default:throw new Error("Unsupported encoding "+o)}return Deno.writeFileSync(a,i)}var c=o=="utf8"?sf(i):i;if(typeof IE_SaveFile<"u")return IE_SaveFile(c,a);if(typeof Blob<"u"){var u=new Blob([uz(c)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(u,a);if(typeof saveAs<"u")return saveAs(u,a);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var r=URL.createObjectURL(u);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(r)},6e4),chrome.downloads.download({url:r,filename:a,saveAs:!0});var _=document.createElement("a");if(_.download!=null)return _.download=a,_.href=r,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(r)},6e4),r}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var T=File(a);return T.open("w"),T.encoding="binary",Array.isArray(i)&&(i=f1(i)),T.write(i),T.close(),i}catch(E){if(!E.message||!E.message.match(/onstruct/))throw E}throw new Error("cannot save file "+a)}function tl(a){for(var i=Object.keys(a),o=[],c=0;c<i.length;++c)Object.prototype.hasOwnProperty.call(a,i[c])&&o.push(i[c]);return o}function rk(a,i){for(var o=[],c=tl(a),u=0;u!==c.length;++u)o[a[c[u]][i]]==null&&(o[a[c[u]][i]]=c[u]);return o}function X5(a){for(var i=[],o=tl(a),c=0;c!==o.length;++c)i[a[o[c]]]=o[c];return i}function Ex(a){for(var i=[],o=tl(a),c=0;c!==o.length;++c)i[a[o[c]]]=parseInt(o[c],10);return i}function hz(a){for(var i=[],o=tl(a),c=0;c!==o.length;++c)i[a[o[c]]]==null&&(i[a[o[c]]]=[]),i[a[o[c]]].push(o[c]);return i}var dx=new Date(1899,11,30,0,0,0);function fc(a,i){var o=a.getTime();i&&(o-=1462*24*60*60*1e3);var c=dx.getTime()+(a.getTimezoneOffset()-dx.getTimezoneOffset())*6e4;return(o-c)/(24*60*60*1e3)}var $k=new Date,dz=dx.getTime()+($k.getTimezoneOffset()-dx.getTimezoneOffset())*6e4,ik=$k.getTimezoneOffset();function Xk(a){var i=new Date;return i.setTime(a*24*60*60*1e3+dz),i.getTimezoneOffset()!==ik&&i.setTime(i.getTime()+(i.getTimezoneOffset()-ik)*6e4),i}var nk=new Date("2017-02-19T19:06:09.000Z"),Zk=isNaN(nk.getFullYear())?new Date("2/19/17"):nk,fz=Zk.getFullYear()==2017;function jl(a,i){var o=new Date(a);if(fz)return i>0?o.setTime(o.getTime()+o.getTimezoneOffset()*60*1e3):i<0&&o.setTime(o.getTime()-o.getTimezoneOffset()*60*1e3),o;if(a instanceof Date)return a;if(Zk.getFullYear()==1917&&!isNaN(o.getFullYear())){var c=o.getFullYear();return a.indexOf(""+c)>-1||o.setFullYear(o.getFullYear()+100),o}var u=a.match(/\d+/g)||["2017","2","19","0","0","0"],r=new Date(+u[0],+u[1]-1,+u[2],+u[3]||0,+u[4]||0,+u[5]||0);return a.indexOf("Z")>-1&&(r=new Date(r.getTime()-r.getTimezoneOffset()*60*1e3)),r}function Ax(a,i){if(oa&&Buffer.isBuffer(a)){if(i){if(a[0]==255&&a[1]==254)return sf(a.slice(2).toString("utf16le"));if(a[1]==254&&a[2]==255)return sf(LB(a.slice(2).toString("binary")))}return a.toString("binary")}if(typeof TextDecoder<"u")try{if(i){if(a[0]==255&&a[1]==254)return sf(new TextDecoder("utf-16le").decode(a.slice(2)));if(a[0]==254&&a[1]==255)return sf(new TextDecoder("utf-16be").decode(a.slice(2)))}var o={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(a)&&(a=new Uint8Array(a)),new TextDecoder("latin1").decode(a).replace(/[]/g,function(r){return o[r]||r})}catch{}for(var c=[],u=0;u!=a.length;++u)c.push(String.fromCharCode(a[u]));return c.join("")}function pc(a){if(typeof JSON<"u"&&!Array.isArray(a))return JSON.parse(JSON.stringify(a));if(typeof a!="object"||a==null)return a;if(a instanceof Date)return new Date(a.getTime());var i={};for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i[o]=pc(a[o]));return i}function Do(a,i){for(var o="";o.length<i;)o+=a;return o}function cf(a){var i=Number(a);if(!isNaN(i))return isFinite(i)?i:NaN;if(!/\d/.test(a))return i;var o=1,c=a.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return o*=100,""});return!isNaN(i=Number(c))||(c=c.replace(/[(](.*)[)]/,function(u,r){return o=-o,r}),!isNaN(i=Number(c)))?i/o:i}var pz=["january","february","march","april","may","june","july","august","september","october","november","december"];function c1(a){var i=new Date(a),o=new Date(NaN),c=i.getYear(),u=i.getMonth(),r=i.getDate();if(isNaN(r))return o;var _=a.toLowerCase();if(_.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(_=_.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),_.length>3&&pz.indexOf(_)==-1)return o}else if(_.match(/[a-z]/))return o;return c<0||c>8099?o:(u>0||r>1)&&c!=101?i:a.match(/[^-0-9:,\/\\]/)?o:i}function vn(a,i,o){if(a.FullPaths){if(typeof o=="string"){var c;return oa?c=ff(o):c=NB(o),La.utils.cfb_add(a,i,c)}La.utils.cfb_add(a,i,o)}else a.file(i,o)}function Z5(){return La.utils.cfb_new()}var ts=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`;var mz={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Y5=X5(mz);var K5=/[&<>'"]/g,gz=/[\u0000-\u0008\u000b-\u001f]/g;function Ca(a){var i=a+"";return i.replace(K5,function(o){return Y5[o]}).replace(gz,function(o){return"_x"+("000"+o.charCodeAt(0).toString(16)).slice(-4)+"_"})}function ak(a){return Ca(a).replace(/ /g,"_x0020_")}var Yk=/[\u0000-\u001f]/g;function _z(a){var i=a+"";return i.replace(K5,function(o){return Y5[o]}).replace(/\n/g,"<br/>").replace(Yk,function(o){return"&#x"+("000"+o.charCodeAt(0).toString(16)).slice(-4)+";"})}function vz(a){var i=a+"";return i.replace(K5,function(o){return Y5[o]}).replace(Yk,function(o){return"&#x"+o.charCodeAt(0).toString(16).toUpperCase()+";"})}function yz(a){return a.replace(/(\r\n|[\r\n])/g,"&#10;")}function xz(a){switch(a){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function L5(a){for(var i="",o=0,c=0,u=0,r=0,_=0,T=0;o<a.length;){if(c=a.charCodeAt(o++),c<128){i+=String.fromCharCode(c);continue}if(u=a.charCodeAt(o++),c>191&&c<224){_=(c&31)<<6,_|=u&63,i+=String.fromCharCode(_);continue}if(r=a.charCodeAt(o++),c<240){i+=String.fromCharCode((c&15)<<12|(u&63)<<6|r&63);continue}_=a.charCodeAt(o++),T=((c&7)<<18|(u&63)<<12|(r&63)<<6|_&63)-65536,i+=String.fromCharCode(55296+(T>>>10&1023)),i+=String.fromCharCode(56320+(T&1023))}return i}function ok(a){var i=bm(2*a.length),o,c,u=1,r=0,_=0,T;for(c=0;c<a.length;c+=u)u=1,(T=a.charCodeAt(c))<128?o=T:T<224?(o=(T&31)*64+(a.charCodeAt(c+1)&63),u=2):T<240?(o=(T&15)*4096+(a.charCodeAt(c+1)&63)*64+(a.charCodeAt(c+2)&63),u=3):(u=4,o=(T&7)*262144+(a.charCodeAt(c+1)&63)*4096+(a.charCodeAt(c+2)&63)*64+(a.charCodeAt(c+3)&63),o-=65536,_=55296+(o>>>10&1023),o=56320+(o&1023)),_!==0&&(i[r++]=_&255,i[r++]=_>>>8,_=0),i[r++]=o%256,i[r++]=o>>>8;return i.slice(0,r).toString("ucs2")}function sk(a){return ff(a,"binary").toString("utf8")}var nx="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",t1=oa&&(sk(nx)==L5(nx)&&sk||ok(nx)==L5(nx)&&ok)||L5,sf=oa?function(a){return ff(a,"utf8").toString("binary")}:function(a){for(var i=[],o=0,c=0,u=0;o<a.length;)switch(c=a.charCodeAt(o++),!0){case c<128:i.push(String.fromCharCode(c));break;case c<2048:i.push(String.fromCharCode(192+(c>>6))),i.push(String.fromCharCode(128+(c&63)));break;case(c>=55296&&c<57344):c-=55296,u=a.charCodeAt(o++)-56320+(c<<10),i.push(String.fromCharCode(240+(u>>18&7))),i.push(String.fromCharCode(144+(u>>12&63))),i.push(String.fromCharCode(128+(u>>6&63))),i.push(String.fromCharCode(128+(u&63)));break;default:i.push(String.fromCharCode(224+(c>>12))),i.push(String.fromCharCode(128+(c>>6&63))),i.push(String.fromCharCode(128+(c&63)))}return i.join("")};var bz=function(){var a=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(i){return[new RegExp("&"+i[0]+";","ig"),i[1]]});return function(o){for(var c=o.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),u=0;u<a.length;++u)c=c.replace(a[u][0],a[u][1]);return c}}();var Kk=/(^\s|\s$|\n)/;function Qs(a,i){return"<"+a+(i.match(Kk)?' xml:space="preserve"':"")+">"+i+"</"+a+">"}function u1(a){return tl(a).map(function(i){return" "+i+'="'+a[i]+'"'}).join("")}function Vr(a,i,o){return"<"+a+(o!=null?u1(o):"")+(i!=null?(i.match(Kk)?' xml:space="preserve"':"")+">"+i+"</"+a:"/")+">"}function G5(a,i){try{return a.toISOString().replace(/\.\d*/,"")}catch(o){if(i)throw o}return""}function wz(a,i){switch(typeof a){case"string":var o=Vr("vt:lpwstr",Ca(a));return i&&(o=o.replace(/&quot;/g,"_x0022_")),o;case"number":return Vr((a|0)==a?"vt:i4":"vt:r8",Ca(String(a)));case"boolean":return Vr("vt:bool",a?"true":"false")}if(a instanceof Date)return Vr("vt:filetime",G5(a));throw new Error("Unable to serialize "+a)}var Fs={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},cg=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],$c={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Tz(a,i){for(var o=1-2*(a[i+7]>>>7),c=((a[i+7]&127)<<4)+(a[i+6]>>>4&15),u=a[i+6]&15,r=5;r>=0;--r)u=u*256+a[i+r];return c==2047?u==0?o*(1/0):NaN:(c==0?c=-1022:(c-=1023,u+=Math.pow(2,52)),o*Math.pow(2,c-52)*u)}function Sz(a,i,o){var c=(i<0||1/i==-1/0?1:0)<<7,u=0,r=0,_=c?-i:i;isFinite(_)?_==0?u=r=0:(u=Math.floor(Math.log(_)/Math.LN2),r=_*Math.pow(2,52-u),u<=-1023&&(!isFinite(r)||r<Math.pow(2,52))?u=-1022:(r-=Math.pow(2,52),u+=1023)):(u=2047,r=isNaN(i)?26985:0);for(var T=0;T<=5;++T,r/=256)a[o+T]=r&255;a[o+6]=(u&15)<<4|r&15,a[o+7]=u>>4|c}var lk=function(a){for(var i=[],o=10240,c=0;c<a[0].length;++c)if(a[0][c])for(var u=0,r=a[0][c].length;u<r;u+=o)i.push.apply(i,a[0][c].slice(u,u+o));return i},ck=oa?function(a){return a[0].length>0&&Buffer.isBuffer(a[0][0])?Buffer.concat(a[0].map(function(i){return Buffer.isBuffer(i)?i:ff(i)})):lk(a)}:lk,uk=function(a,i,o){for(var c=[],u=i;u<o;u+=2)c.push(String.fromCharCode(e1(a,u)));return c.join("").replace(rg,"")},Cx=oa?function(a,i,o){return Buffer.isBuffer(a)?a.toString("utf16le",i,o).replace(rg,""):uk(a,i,o)}:uk,hk=function(a,i,o){for(var c=[],u=i;u<i+o;++u)c.push(("0"+a[u].toString(16)).slice(-2));return c.join("")},Jk=oa?function(a,i,o){return Buffer.isBuffer(a)?a.toString("hex",i,i+o):hk(a,i,o)}:hk,dk=function(a,i,o){for(var c=[],u=i;u<o;u++)c.push(String.fromCharCode(eg(a,u)));return c.join("")},ug=oa?function(i,o,c){return Buffer.isBuffer(i)?i.toString("utf8",o,c):dk(i,o,c)}:dk,Qk=function(a,i){var o=Rs(a,i);return o>0?ug(a,i+4,i+4+o-1):""},J5=Qk,eM=function(a,i){var o=Rs(a,i);return o>0?ug(a,i+4,i+4+o-1):""},Q5=eM,tM=function(a,i){var o=2*Rs(a,i);return o>0?ug(a,i+4,i+4+o-1):""},eT=tM,rM=function(i,o){var c=Rs(i,o);return c>0?Cx(i,o+4,o+4+c):""},tT=rM,iM=function(a,i){var o=Rs(a,i);return o>0?ug(a,i+4,i+4+o):""},rT=iM,nM=function(a,i){return Tz(a,i)},fx=nM,iT=function(i){return Array.isArray(i)||typeof Uint8Array<"u"&&i instanceof Uint8Array};oa&&(J5=function(i,o){if(!Buffer.isBuffer(i))return Qk(i,o);var c=i.readUInt32LE(o);return c>0?i.toString("utf8",o+4,o+4+c-1):""},Q5=function(i,o){if(!Buffer.isBuffer(i))return eM(i,o);var c=i.readUInt32LE(o);return c>0?i.toString("utf8",o+4,o+4+c-1):""},eT=function(i,o){if(!Buffer.isBuffer(i))return tM(i,o);var c=2*i.readUInt32LE(o);return i.toString("utf16le",o+4,o+4+c-1)},tT=function(i,o){if(!Buffer.isBuffer(i))return rM(i,o);var c=i.readUInt32LE(o);return i.toString("utf16le",o+4,o+4+c)},rT=function(i,o){if(!Buffer.isBuffer(i))return iM(i,o);var c=i.readUInt32LE(o);return i.toString("utf8",o+4,o+4+c)},fx=function(i,o){return Buffer.isBuffer(i)?i.readDoubleLE(o):nM(i,o)},iT=function(i){return Buffer.isBuffer(i)||Array.isArray(i)||typeof Uint8Array<"u"&&i instanceof Uint8Array});function Ez(){Cx=function(a,i,o){return za.utils.decode(1200,a.slice(i,o)).replace(rg,"")},ug=function(a,i,o){return za.utils.decode(65001,a.slice(i,o))},J5=function(a,i){var o=Rs(a,i);return o>0?za.utils.decode(sg,a.slice(i+4,i+4+o-1)):""},Q5=function(a,i){var o=Rs(a,i);return o>0?za.utils.decode(ym,a.slice(i+4,i+4+o-1)):""},eT=function(a,i){var o=2*Rs(a,i);return o>0?za.utils.decode(1200,a.slice(i+4,i+4+o-1)):""},tT=function(a,i){var o=Rs(a,i);return o>0?za.utils.decode(1200,a.slice(i+4,i+4+o)):""},rT=function(a,i){var o=Rs(a,i);return o>0?za.utils.decode(65001,a.slice(i+4,i+4+o)):""}}typeof za<"u"&&Ez();var eg=function(a,i){return a[i]},e1=function(a,i){return a[i+1]*256+a[i]},Az=function(a,i){var o=a[i+1]*256+a[i];return o<32768?o:(65535-o+1)*-1},Rs=function(a,i){return a[i+3]*(1<<24)+(a[i+2]<<16)+(a[i+1]<<8)+a[i]},vm=function(a,i){return a[i+3]<<24|a[i+2]<<16|a[i+1]<<8|a[i]},Cz=function(a,i){return a[i]<<24|a[i+1]<<16|a[i+2]<<8|a[i+3]};function r1(a,i){var o="",c,u,r=[],_,T,E,k;switch(i){case"dbcs":if(k=this.l,oa&&Buffer.isBuffer(this))o=this.slice(this.l,this.l+2*a).toString("utf16le");else for(E=0;E<a;++E)o+=String.fromCharCode(e1(this,k)),k+=2;a*=2;break;case"utf8":o=ug(this,this.l,this.l+a);break;case"utf16le":a*=2,o=Cx(this,this.l,this.l+a);break;case"wstr":if(typeof za<"u")o=za.utils.decode(ym,this.slice(this.l,this.l+2*a));else return r1.call(this,a,"dbcs");a=2*a;break;case"lpstr-ansi":o=J5(this,this.l),a=4+Rs(this,this.l);break;case"lpstr-cp":o=Q5(this,this.l),a=4+Rs(this,this.l);break;case"lpwstr":o=eT(this,this.l),a=4+2*Rs(this,this.l);break;case"lpp4":a=4+Rs(this,this.l),o=tT(this,this.l),a&2&&(a+=2);break;case"8lpp4":a=4+Rs(this,this.l),o=rT(this,this.l),a&3&&(a+=4-(a&3));break;case"cstr":for(a=0,o="";(_=eg(this,this.l+a++))!==0;)r.push(ex(_));o=r.join("");break;case"_wstr":for(a=0,o="";(_=e1(this,this.l+a))!==0;)r.push(ex(_)),a+=2;a+=2,o=r.join("");break;case"dbcs-cont":for(o="",k=this.l,E=0;E<a;++E){if(this.lens&&this.lens.indexOf(k)!==-1)return _=eg(this,k),this.l=k+1,T=r1.call(this,a-E,_?"dbcs-cont":"sbcs-cont"),r.join("")+T;r.push(ex(e1(this,k))),k+=2}o=r.join(""),a*=2;break;case"cpstr":if(typeof za<"u"){o=za.utils.decode(ym,this.slice(this.l,this.l+a));break}case"sbcs-cont":for(o="",k=this.l,E=0;E!=a;++E){if(this.lens&&this.lens.indexOf(k)!==-1)return _=eg(this,k),this.l=k+1,T=r1.call(this,a-E,_?"dbcs-cont":"sbcs-cont"),r.join("")+T;r.push(ex(eg(this,k))),k+=1}o=r.join("");break;default:switch(a){case 1:return c=eg(this,this.l),this.l++,c;case 2:return c=(i==="i"?Az:e1)(this,this.l),this.l+=2,c;case 4:case-4:return i==="i"||!(this[this.l+3]&128)?(c=(a>0?vm:Cz)(this,this.l),this.l+=4,c):(u=Rs(this,this.l),this.l+=4,u);case 8:case-8:if(i==="f")return a==8?u=fx(this,this.l):u=fx([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,u;a=8;case 16:o=Jk(this,this.l,a);break}}return this.l+=a,o}var Iz=function(a,i,o){a[o]=i&255,a[o+1]=i>>>8&255,a[o+2]=i>>>16&255,a[o+3]=i>>>24&255},kz=function(a,i,o){a[o]=i&255,a[o+1]=i>>8&255,a[o+2]=i>>16&255,a[o+3]=i>>24&255},Mz=function(a,i,o){a[o]=i&255,a[o+1]=i>>>8&255};function Dz(a,i,o){var c=0,u=0;if(o==="dbcs"){for(u=0;u!=i.length;++u)Mz(this,i.charCodeAt(u),this.l+2*u);c=2*i.length}else if(o==="sbcs"){if(typeof za<"u"&&sg==874)for(u=0;u!=i.length;++u){var r=za.utils.encode(sg,i.charAt(u));this[this.l+u]=r[0]}else for(i=i.replace(/[^\x00-\x7F]/g,"_"),u=0;u!=i.length;++u)this[this.l+u]=i.charCodeAt(u)&255;c=i.length}else if(o==="hex"){for(;u<a;++u)this[this.l++]=parseInt(i.slice(2*u,2*u+2),16)||0;return this}else if(o==="utf16le"){var _=Math.min(this.l+a,this.length);for(u=0;u<Math.min(i.length,a);++u){var T=i.charCodeAt(u);this[this.l++]=T&255,this[this.l++]=T>>8}for(;this.l<_;)this[this.l++]=0;return this}else switch(a){case 1:c=1,this[this.l]=i&255;break;case 2:c=2,this[this.l]=i&255,i>>>=8,this[this.l+1]=i&255;break;case 3:c=3,this[this.l]=i&255,i>>>=8,this[this.l+1]=i&255,i>>>=8,this[this.l+2]=i&255;break;case 4:c=4,Iz(this,i,this.l);break;case 8:if(c=8,o==="f"){Sz(this,i,this.l);break}case 16:break;case-4:c=4,kz(this,i,this.l);break}return this.l+=c,this}function aM(a,i){var o=Jk(this,this.l,a.length>>1);if(o!==a)throw new Error(i+"Expected "+a+" saw "+o);this.l+=a.length>>1}function qc(a,i){a.l=i,a.read_shift=r1,a.chk=aM,a.write_shift=Dz}function ud(a,i){a.l+=i}function cr(a){var i=bm(a);return qc(i,0),i}function dc(){var a=[],i=oa?256:2048,o=function(k){var D=cr(k);return qc(D,0),D},c=o(i),u=function(){c&&(c.length>c.l&&(c=c.slice(0,c.l),c.l=c.length),c.length>0&&a.push(c),c=null)},r=function(k){return c&&k<c.length-c.l?c:(u(),c=o(Math.max(k+1,i)))},_=function(){return u(),Js(a)},T=function(k){u(),c=k,c.l==null&&(c.l=c.length),r(i)};return{next:r,push:T,end:_,_bufs:a}}function Ir(a,i,o,c){var u=+i,r;if(!isNaN(u)){c||(c=SG[u].p||(o||[]).length||0),r=1+(u>=128?1:0)+1,c>=128&&++r,c>=16384&&++r,c>=2097152&&++r;var _=a.next(r);u<=127?_.write_shift(1,u):(_.write_shift(1,(u&127)+128),_.write_shift(1,u>>7));for(var T=0;T!=4;++T)if(c>=128)_.write_shift(1,(c&127)+128),c>>=7;else{_.write_shift(1,c);break}c>0&&iT(o)&&a.push(o)}}function i1(a,i,o){var c=pc(a);if(i.s?(c.cRel&&(c.c+=i.s.c),c.rRel&&(c.r+=i.s.r)):(c.cRel&&(c.c+=i.c),c.rRel&&(c.r+=i.r)),!o||o.biff<12){for(;c.c>=256;)c.c-=256;for(;c.r>=65536;)c.r-=65536}return c}function fk(a,i,o){var c=pc(a);return c.s=i1(c.s,i.s,o),c.e=i1(c.e,i.s,o),c}function n1(a,i){if(a.cRel&&a.c<0)for(a=pc(a);a.c<0;)a.c+=i>8?16384:256;if(a.rRel&&a.r<0)for(a=pc(a);a.r<0;)a.r+=i>8?1048576:i>5?65536:16384;var o=Ia(a);return!a.cRel&&a.cRel!=null&&(o=Pz(o)),!a.rRel&&a.rRel!=null&&(o=Rz(o)),o}function O5(a,i){return a.s.r==0&&!a.s.rRel&&a.e.r==(i.biff>=12?1048575:i.biff>=8?65536:16384)&&!a.e.rRel?(a.s.cRel?"":"$")+vl(a.s.c)+":"+(a.e.cRel?"":"$")+vl(a.e.c):a.s.c==0&&!a.s.cRel&&a.e.c==(i.biff>=12?16383:255)&&!a.e.cRel?(a.s.rRel?"":"$")+el(a.s.r)+":"+(a.e.rRel?"":"$")+el(a.e.r):n1(a.s,i.biff)+":"+n1(a.e,i.biff)}function nT(a){return parseInt(Fz(a),10)-1}function el(a){return""+(a+1)}function Rz(a){return a.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Fz(a){return a.replace(/\$(\d+)$/,"$1")}function aT(a){for(var i=Lz(a),o=0,c=0;c!==i.length;++c)o=26*o+i.charCodeAt(c)-64;return o-1}function vl(a){if(a<0)throw new Error("invalid column "+a);var i="";for(++a;a;a=Math.floor((a-1)/26))i=String.fromCharCode((a-1)%26+65)+i;return i}function Pz(a){return a.replace(/^([A-Z])/,"$$$1")}function Lz(a){return a.replace(/^\$([A-Z])/,"$1")}function Oz(a){return a.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ps(a){for(var i=0,o=0,c=0;c<a.length;++c){var u=a.charCodeAt(c);u>=48&&u<=57?i=10*i+(u-48):u>=65&&u<=90&&(o=26*o+(u-64))}return{c:o-1,r:i-1}}function Ia(a){for(var i=a.c+1,o="";i;i=(i-1)/26|0)o=String.fromCharCode((i-1)%26+65)+o;return o+(a.r+1)}function Xc(a){var i=a.indexOf(":");return i==-1?{s:Ps(a),e:Ps(a)}:{s:Ps(a.slice(0,i)),e:Ps(a.slice(i+1))}}function es(a,i){return typeof i>"u"||typeof i=="number"?es(a.s,a.e):(typeof a!="string"&&(a=Ia(a)),typeof i!="string"&&(i=Ia(i)),a==i?a:a+":"+i)}function ao(a){var i={s:{c:0,r:0},e:{c:0,r:0}},o=0,c=0,u=0,r=a.length;for(o=0;c<r&&!((u=a.charCodeAt(c)-64)<1||u>26);++c)o=26*o+u;for(i.s.c=--o,o=0;c<r&&!((u=a.charCodeAt(c)-48)<0||u>9);++c)o=10*o+u;if(i.s.r=--o,c===r||u!=10)return i.e.c=i.s.c,i.e.r=i.s.r,i;for(++c,o=0;c!=r&&!((u=a.charCodeAt(c)-64)<1||u>26);++c)o=26*o+u;for(i.e.c=--o,o=0;c!=r&&!((u=a.charCodeAt(c)-48)<0||u>9);++c)o=10*o+u;return i.e.r=--o,i}function pk(a,i){var o=a.t=="d"&&i instanceof Date;if(a.z!=null)try{return a.w=_p(a.z,o?fc(i):i)}catch{}try{return a.w=_p((a.XF||{}).numFmtId||(o?14:0),o?fc(i):i)}catch{return""+i}}function df(a,i,o){return a==null||a.t==null||a.t=="z"?"":a.w!==void 0?a.w:(a.t=="d"&&!a.z&&o&&o.dateNF&&(a.z=o.dateNF),a.t=="e"?m1[a.v]||a.v:i==null?pk(a,a.v):pk(a,i))}function Sm(a,i){var o=i&&i.sheet?i.sheet:"Sheet1",c={};return c[o]=a,{SheetNames:[o],Sheets:c}}function oM(a,i,o){var c=o||{},u=a?Array.isArray(a):c.dense;cd!=null&&u==null&&(u=cd);var r=a||(u?[]:{}),_=0,T=0;if(r&&c.origin!=null){if(typeof c.origin=="number")_=c.origin;else{var E=typeof c.origin=="string"?Ps(c.origin):c.origin;_=E.r,T=E.c}r["!ref"]||(r["!ref"]="A1:A1")}var k={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(r["!ref"]){var D=ao(r["!ref"]);k.s.c=D.s.c,k.s.r=D.s.r,k.e.c=Math.max(k.e.c,D.e.c),k.e.r=Math.max(k.e.r,D.e.r),_==-1&&(k.e.r=_=D.e.r+1)}for(var j=0;j!=i.length;++j)if(i[j]){if(!Array.isArray(i[j]))throw new Error("aoa_to_sheet expects an array of arrays");for(var B=0;B!=i[j].length;++B)if(!(typeof i[j][B]>"u")){var P={v:i[j][B]},ee=_+j,G=T+B;if(k.s.r>ee&&(k.s.r=ee),k.s.c>G&&(k.s.c=G),k.e.r<ee&&(k.e.r=ee),k.e.c<G&&(k.e.c=G),i[j][B]&&typeof i[j][B]=="object"&&!Array.isArray(i[j][B])&&!(i[j][B]instanceof Date))P=i[j][B];else if(Array.isArray(P.v)&&(P.f=i[j][B][1],P.v=P.v[0]),P.v===null)if(P.f)P.t="n";else if(c.nullError)P.t="e",P.v=0;else if(c.sheetStubs)P.t="z";else continue;else typeof P.v=="number"?P.t="n":typeof P.v=="boolean"?P.t="b":P.v instanceof Date?(P.z=c.dateNF||Ro[14],c.cellDates?(P.t="d",P.w=_p(P.z,fc(P.v))):(P.t="n",P.v=fc(P.v),P.w=_p(P.z,P.v))):P.t="s";if(u)r[ee]||(r[ee]=[]),r[ee][G]&&r[ee][G].z&&(P.z=r[ee][G].z),r[ee][G]=P;else{var K=Ia({c:G,r:ee});r[K]&&r[K].z&&(P.z=r[K].z),r[K]=P}}}return k.s.c<1e7&&(r["!ref"]=es(k)),r}function hg(a,i){return oM(null,a,i)}function Nz(a){return a.read_shift(4,"i")}function _h(a,i){return i||(i=cr(4)),i.write_shift(4,a),i}function yl(a){var i=a.read_shift(4);return i===0?"":a.read_shift(i,"dbcs")}function Ls(a,i){var o=!1;return i==null&&(o=!0,i=cr(4+2*a.length)),i.write_shift(4,a.length),a.length>0&&i.write_shift(0,a,"dbcs"),o?i.slice(0,i.l):i}function Bz(a){return{ich:a.read_shift(2),ifnt:a.read_shift(2)}}function zz(a,i){return i||(i=cr(4)),i.write_shift(2,a.ich||0),i.write_shift(2,a.ifnt||0),i}function oT(a,i){var o=a.l,c=a.read_shift(1),u=yl(a),r=[],_={t:u,h:u};if(c&1){for(var T=a.read_shift(4),E=0;E!=T;++E)r.push(Bz(a));_.r=r}else _.r=[{ich:0,ifnt:0}];return a.l=o+i,_}function jz(a,i){var o=!1;return i==null&&(o=!0,i=cr(15+4*a.t.length)),i.write_shift(1,0),Ls(a.t,i),o?i.slice(0,i.l):i}var Uz=oT;function Vz(a,i){var o=!1;return i==null&&(o=!0,i=cr(23+4*a.t.length)),i.write_shift(1,1),Ls(a.t,i),i.write_shift(4,1),zz({ich:0,ifnt:0},i),o?i.slice(0,i.l):i}function Au(a){var i=a.read_shift(4),o=a.read_shift(2);return o+=a.read_shift(1)<<16,a.l++,{c:i,iStyleRef:o}}function Em(a,i){return i==null&&(i=cr(8)),i.write_shift(-4,a.c),i.write_shift(3,a.iStyleRef||a.s),i.write_shift(1,0),i}function Am(a){var i=a.read_shift(2);return i+=a.read_shift(1)<<16,a.l++,{c:-1,iStyleRef:i}}function Cm(a,i){return i==null&&(i=cr(4)),i.write_shift(3,a.iStyleRef||a.s),i.write_shift(1,0),i}var Gz=yl,sM=Ls;function sT(a){var i=a.read_shift(4);return i===0||i===4294967295?"":a.read_shift(i,"dbcs")}function px(a,i){var o=!1;return i==null&&(o=!0,i=cr(127)),i.write_shift(4,a.length>0?a.length:4294967295),a.length>0&&i.write_shift(0,a,"dbcs"),o?i.slice(0,i.l):i}var Hz=yl,H5=sT,lT=px;function lM(a){var i=a.slice(a.l,a.l+4),o=i[0]&1,c=i[0]&2;a.l+=4;var u=c===0?fx([0,0,0,0,i[0]&252,i[1],i[2],i[3]],0):vm(i,0)>>2;return o?u/100:u}function cM(a,i){i==null&&(i=cr(4));var o=0,c=0,u=a*100;if(a==(a|0)&&a>=-(1<<29)&&a<1<<29?c=1:u==(u|0)&&u>=-(1<<29)&&u<1<<29&&(c=1,o=1),c)i.write_shift(-4,((o?u:a)<<2)+(o+2));else throw new Error("unsupported RkNumber "+a)}function uM(a){var i={s:{},e:{}};return i.s.r=a.read_shift(4),i.e.r=a.read_shift(4),i.s.c=a.read_shift(4),i.e.c=a.read_shift(4),i}function Wz(a,i){return i||(i=cr(16)),i.write_shift(4,a.s.r),i.write_shift(4,a.e.r),i.write_shift(4,a.s.c),i.write_shift(4,a.e.c),i}var Im=uM,dg=Wz;function fg(a){if(a.length-a.l<8)throw"XLS Xnum Buffer underflow";return a.read_shift(8,"f")}function wm(a,i){return(i||cr(8)).write_shift(8,a,"f")}function qz(a){var i={},o=a.read_shift(1),c=o>>>1,u=a.read_shift(1),r=a.read_shift(2,"i"),_=a.read_shift(1),T=a.read_shift(1),E=a.read_shift(1);switch(a.l++,c){case 0:i.auto=1;break;case 1:i.index=u;var k=t7[u];k&&(i.rgb=Ek(k));break;case 2:i.rgb=Ek([_,T,E]);break;case 3:i.theme=u;break}return r!=0&&(i.tint=r>0?r/32767:r/32768),i}function mx(a,i){if(i||(i=cr(8)),!a||a.auto)return i.write_shift(4,0),i.write_shift(4,0),i;a.index!=null?(i.write_shift(1,2),i.write_shift(1,a.index)):a.theme!=null?(i.write_shift(1,6),i.write_shift(1,a.theme)):(i.write_shift(1,5),i.write_shift(1,0));var o=a.tint||0;if(o>0?o*=32767:o<0&&(o*=32768),i.write_shift(2,o),!a.rgb||a.theme!=null)i.write_shift(2,0),i.write_shift(1,0),i.write_shift(1,0);else{var c=a.rgb||"FFFFFF";typeof c=="number"&&(c=("000000"+c.toString(16)).slice(-6)),i.write_shift(1,parseInt(c.slice(0,2),16)),i.write_shift(1,parseInt(c.slice(2,4),16)),i.write_shift(1,parseInt(c.slice(4,6),16)),i.write_shift(1,255)}return i}function $z(a){var i=a.read_shift(1);a.l++;var o={fBold:i&1,fItalic:i&2,fUnderline:i&4,fStrikeout:i&8,fOutline:i&16,fShadow:i&32,fCondense:i&64,fExtend:i&128};return o}function Xz(a,i){i||(i=cr(2));var o=(a.italic?2:0)|(a.strike?8:0)|(a.outline?16:0)|(a.shadow?32:0)|(a.condense?64:0)|(a.extend?128:0);return i.write_shift(1,o),i.write_shift(1,0),i}var hM=2,Wc=3,ax=11;var gx=19;var ox=64,Zz=65,Yz=71;var Kz=4108,Jz=4126,Ks=80;var mk={1:{n:"CodePage",t:hM},2:{n:"Category",t:Ks},3:{n:"PresentationFormat",t:Ks},4:{n:"ByteCount",t:Wc},5:{n:"LineCount",t:Wc},6:{n:"ParagraphCount",t:Wc},7:{n:"SlideCount",t:Wc},8:{n:"NoteCount",t:Wc},9:{n:"HiddenCount",t:Wc},10:{n:"MultimediaClipCount",t:Wc},11:{n:"ScaleCrop",t:ax},12:{n:"HeadingPairs",t:Kz},13:{n:"TitlesOfParts",t:Jz},14:{n:"Manager",t:Ks},15:{n:"Company",t:Ks},16:{n:"LinksUpToDate",t:ax},17:{n:"CharacterCount",t:Wc},19:{n:"SharedDoc",t:ax},22:{n:"HyperlinksChanged",t:ax},23:{n:"AppVersion",t:Wc,p:"version"},24:{n:"DigSig",t:Zz},26:{n:"ContentType",t:Ks},27:{n:"ContentStatus",t:Ks},28:{n:"Language",t:Ks},29:{n:"Version",t:Ks},255:{},2147483648:{n:"Locale",t:gx},2147483651:{n:"Behavior",t:gx},1919054434:{}},gk={1:{n:"CodePage",t:hM},2:{n:"Title",t:Ks},3:{n:"Subject",t:Ks},4:{n:"Author",t:Ks},5:{n:"Keywords",t:Ks},6:{n:"Comments",t:Ks},7:{n:"Template",t:Ks},8:{n:"LastAuthor",t:Ks},9:{n:"RevNumber",t:Ks},10:{n:"EditTime",t:ox},11:{n:"LastPrinted",t:ox},12:{n:"CreatedDate",t:ox},13:{n:"ModifiedDate",t:ox},14:{n:"PageCount",t:Wc},15:{n:"WordCount",t:Wc},16:{n:"CharCount",t:Wc},17:{n:"Thumbnail",t:Yz},18:{n:"Application",t:Ks},19:{n:"DocSecurity",t:Wc},255:{},2147483648:{n:"Locale",t:gx},2147483651:{n:"Behavior",t:gx},1919054434:{}};function Qz(a){return a.map(function(i){return[i>>16&255,i>>8&255,i&255]})}var e7=Qz([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),t7=pc(e7),m1={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"};var r7={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},sx={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function dM(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function fM(a,i){var o=hz(r7),c=[],u;c[c.length]=ts,c[c.length]=Vr("Types",null,{xmlns:Fs.CT,"xmlns:xsd":Fs.xsd,"xmlns:xsi":Fs.xsi}),c=c.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(E){return Vr("Default",null,{Extension:E[0],ContentType:E[1]})}));var r=function(E){a[E]&&a[E].length>0&&(u=a[E][0],c[c.length]=Vr("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:sx[E][i.bookType]||sx[E].xlsx}))},_=function(E){(a[E]||[]).forEach(function(k){c[c.length]=Vr("Override",null,{PartName:(k[0]=="/"?"":"/")+k,ContentType:sx[E][i.bookType]||sx[E].xlsx})})},T=function(E){(a[E]||[]).forEach(function(k){c[c.length]=Vr("Override",null,{PartName:(k[0]=="/"?"":"/")+k,ContentType:o[E][0]})})};return r("workbooks"),_("sheets"),_("charts"),T("themes"),["strs","styles"].forEach(r),["coreprops","extprops","custprops"].forEach(T),T("vba"),T("comments"),T("threadedcomments"),T("drawings"),_("metadata"),T("people"),c.length>2&&(c[c.length]="</Types>",c[1]=c[1].replace("/>",">")),c.join("")}var Kn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function pM(a){var i=a.lastIndexOf("/");return a.slice(0,i+1)+"_rels/"+a.slice(i+1)+".rels"}function ng(a){var i=[ts,Vr("Relationships",null,{xmlns:Fs.RELS})];return tl(a["!id"]).forEach(function(o){i[i.length]=Vr("Relationship",null,a["!id"][o])}),i.length>2&&(i[i.length]="</Relationships>",i[1]=i[1].replace("/>",">")),i.join("")}function Aa(a,i,o,c,u,r){if(u||(u={}),a["!id"]||(a["!id"]={}),a["!idx"]||(a["!idx"]=1),i<0)for(i=a["!idx"];a["!id"]["rId"+i];++i);if(a["!idx"]=i+1,u.Id="rId"+i,u.Type=c,u.Target=o,r?u.TargetMode=r:[Kn.HLINK,Kn.XPATH,Kn.XMISS].indexOf(u.Type)>-1&&(u.TargetMode="External"),a["!id"][u.Id])throw new Error("Cannot rewrite rId "+i);return a["!id"][u.Id]=u,a[("/"+u.Target).replace("//","/")]=u,i}function i7(a){var i=[ts];i.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),i.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var o=0;o<a.length;++o)i.push('  <manifest:file-entry manifest:full-path="'+a[o][0]+'" manifest:media-type="'+a[o][1]+`"/>
`);return i.push("</manifest:manifest>"),i.join("")}function _k(a,i,o){return['  <rdf:Description rdf:about="'+a+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(o||"odf")+"#"+i+`"/>
`,`  </rdf:Description>
`].join("")}function n7(a,i){return['  <rdf:Description rdf:about="'+a+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+i+`"/>
`,`  </rdf:Description>
`].join("")}function a7(a){var i=[ts];i.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var o=0;o!=a.length;++o)i.push(_k(a[o][0],a[o][1])),i.push(n7("",a[o][0]));return i.push(_k("","Document","pkg")),i.push("</rdf:RDF>"),i.join("")}function mM(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+o1.version+"</meta:generator></office:meta></office:document-meta>"}var xm=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function N5(a,i,o,c,u){u[a]!=null||i==null||i===""||(u[a]=i,i=Ca(i),c[c.length]=o?Vr(a,i,o):Qs(a,i))}function gM(a,i){var o=i||{},c=[ts,Vr("cp:coreProperties",null,{"xmlns:cp":Fs.CORE_PROPS,"xmlns:dc":Fs.dc,"xmlns:dcterms":Fs.dcterms,"xmlns:dcmitype":Fs.dcmitype,"xmlns:xsi":Fs.xsi})],u={};if(!a&&!o.Props)return c.join("");a&&(a.CreatedDate!=null&&N5("dcterms:created",typeof a.CreatedDate=="string"?a.CreatedDate:G5(a.CreatedDate,o.WTF),{"xsi:type":"dcterms:W3CDTF"},c,u),a.ModifiedDate!=null&&N5("dcterms:modified",typeof a.ModifiedDate=="string"?a.ModifiedDate:G5(a.ModifiedDate,o.WTF),{"xsi:type":"dcterms:W3CDTF"},c,u));for(var r=0;r!=xm.length;++r){var _=xm[r],T=o.Props&&o.Props[_[1]]!=null?o.Props[_[1]]:a?a[_[1]]:null;T===!0?T="1":T===!1?T="0":typeof T=="number"&&(T=String(T)),T!=null&&N5(_[0],T,null,c,u)}return c.length>2&&(c[c.length]="</cp:coreProperties>",c[1]=c[1].replace("/>",">")),c.join("")}var ag=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],_M=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function vM(a){var i=[],o=Vr;return a||(a={}),a.Application="SheetJS",i[i.length]=ts,i[i.length]=Vr("Properties",null,{xmlns:Fs.EXT_PROPS,"xmlns:vt":Fs.vt}),ag.forEach(function(c){if(a[c[1]]!==void 0){var u;switch(c[2]){case"string":u=Ca(String(a[c[1]]));break;case"bool":u=a[c[1]]?"true":"false";break}u!==void 0&&(i[i.length]=o(c[0],u))}}),i[i.length]=o("HeadingPairs",o("vt:vector",o("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+o("vt:variant",o("vt:i4",String(a.Worksheets))),{size:2,baseType:"variant"})),i[i.length]=o("TitlesOfParts",o("vt:vector",a.SheetNames.map(function(c){return"<vt:lpstr>"+Ca(c)+"</vt:lpstr>"}).join(""),{size:a.Worksheets,baseType:"lpstr"})),i.length>2&&(i[i.length]="</Properties>",i[1]=i[1].replace("/>",">")),i.join("")}function yM(a){var i=[ts,Vr("Properties",null,{xmlns:Fs.CUST_PROPS,"xmlns:vt":Fs.vt})];if(!a)return i.join("");var o=1;return tl(a).forEach(function(u){++o,i[i.length]=Vr("property",wz(a[u],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:o,name:Ca(u)})}),i.length>2&&(i[i.length]="</Properties>",i[1]=i[1].replace("/>",">")),i.join("")}var vk={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function o7(a,i){var o=[];return tl(vk).map(function(c){for(var u=0;u<xm.length;++u)if(xm[u][1]==c)return xm[u];for(u=0;u<ag.length;++u)if(ag[u][1]==c)return ag[u];throw c}).forEach(function(c){if(a[c[1]]!=null){var u=i&&i.Props&&i.Props[c[1]]!=null?i.Props[c[1]]:a[c[1]];switch(c[2]){case"date":u=new Date(u).toISOString().replace(/\.\d*Z/,"Z");break}typeof u=="number"?u=String(u):u===!0||u===!1?u=u?"1":"0":u instanceof Date&&(u=new Date(u).toISOString().replace(/\.\d*Z/,"")),o.push(Qs(vk[c[1]]||c[1],u))}}),Vr("DocumentProperties",o.join(""),{xmlns:$c.o})}function s7(a,i){var o=["Worksheets","SheetNames"],c="CustomDocumentProperties",u=[];return a&&tl(a).forEach(function(r){if(Object.prototype.hasOwnProperty.call(a,r)){for(var _=0;_<xm.length;++_)if(r==xm[_][1])return;for(_=0;_<ag.length;++_)if(r==ag[_][1])return;for(_=0;_<o.length;++_)if(r==o[_])return;var T=a[r],E="string";typeof T=="number"?(E="float",T=String(T)):T===!0||T===!1?(E="boolean",T=T?"1":"0"):T=String(T),u.push(Vr(ak(r),T,{"dt:dt":E}))}}),i&&tl(i).forEach(function(r){if(Object.prototype.hasOwnProperty.call(i,r)&&!(a&&Object.prototype.hasOwnProperty.call(a,r))){var _=i[r],T="string";typeof _=="number"?(T="float",_=String(_)):_===!0||_===!1?(T="boolean",_=_?"1":"0"):_ instanceof Date?(T="dateTime.tz",_=_.toISOString()):_=String(_),u.push(Vr(ak(r),_,{"dt:dt":T}))}}),"<"+c+' xmlns="'+$c.o+'">'+u.join("")+"</"+c+">"}function l7(a){var i=typeof a=="string"?new Date(Date.parse(a)):a,o=i.getTime()/1e3+11644473600,c=o%Math.pow(2,32),u=(o-c)/Math.pow(2,32);c*=1e7,u*=1e7;var r=c/Math.pow(2,32)|0;r>0&&(c=c%Math.pow(2,32),u+=r);var _=cr(8);return _.write_shift(4,c),_.write_shift(4,u),_}function yk(a,i){var o=cr(4),c=cr(4);switch(o.write_shift(4,a==80?31:a),a){case 3:c.write_shift(-4,i);break;case 5:c=cr(8),c.write_shift(8,i,"f");break;case 11:c.write_shift(4,i?1:0);break;case 64:c=l7(i);break;case 31:case 80:for(c=cr(4+2*(i.length+1)+(i.length%2?0:2)),c.write_shift(4,i.length+1),c.write_shift(0,i,"dbcs");c.l!=c.length;)c.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+a+" "+i)}return Js([o,c])}var xM=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function c7(a){switch(typeof a){case"boolean":return 11;case"number":return(a|0)==a?3:5;case"string":return 31;case"object":if(a instanceof Date)return 64;break}return-1}function xk(a,i,o){var c=cr(8),u=[],r=[],_=8,T=0,E=cr(8),k=cr(8);if(E.write_shift(4,2),E.write_shift(4,1200),k.write_shift(4,1),r.push(E),u.push(k),_+=8+E.length,!i){k=cr(8),k.write_shift(4,0),u.unshift(k);var D=[cr(4)];for(D[0].write_shift(4,a.length),T=0;T<a.length;++T){var j=a[T][0];for(E=cr(8+2*(j.length+1)+(j.length%2?0:2)),E.write_shift(4,T+2),E.write_shift(4,j.length+1),E.write_shift(0,j,"dbcs");E.l!=E.length;)E.write_shift(1,0);D.push(E)}E=Js(D),r.unshift(E),_+=8+E.length}for(T=0;T<a.length;++T)if(!(i&&!i[a[T][0]])&&!(xM.indexOf(a[T][0])>-1||_M.indexOf(a[T][0])>-1)&&a[T][1]!=null){var B=a[T][1],P=0;if(i){P=+i[a[T][0]];var ee=o[P];if(ee.p=="version"&&typeof B=="string"){var G=B.split(".");B=(+G[0]<<16)+(+G[1]||0)}E=yk(ee.t,B)}else{var K=c7(B);K==-1&&(K=31,B=String(B)),E=yk(K,B)}r.push(E),k=cr(8),k.write_shift(4,i?P:2+T),u.push(k),_+=8+E.length}var J=8*(r.length+1);for(T=0;T<r.length;++T)u[T].write_shift(4,J),J+=r[T].length;return c.write_shift(4,_),c.write_shift(4,r.length),Js([c].concat(u).concat(r))}function bk(a,i,o,c,u,r){var _=cr(u?68:48),T=[_];_.write_shift(2,65534),_.write_shift(2,0),_.write_shift(4,842412599),_.write_shift(16,La.utils.consts.HEADER_CLSID,"hex"),_.write_shift(4,u?2:1),_.write_shift(16,i,"hex"),_.write_shift(4,u?68:48);var E=xk(a,o,c);if(T.push(E),u){var k=xk(u,null,null);_.write_shift(16,r,"hex"),_.write_shift(4,68+E.length),T.push(k)}return Js(T)}function u7(a,i){i||(i=cr(a));for(var o=0;o<a;++o)i.write_shift(1,0);return i}function h7(a,i){return a.read_shift(i)===1}function zl(a,i){return i||(i=cr(2)),i.write_shift(2,+!!a),i}function bM(a){return a.read_shift(2,"u")}function Eu(a,i){return i||(i=cr(2)),i.write_shift(2,a),i}function wM(a,i,o){return o||(o=cr(2)),o.write_shift(1,i=="e"?+a:+!!a),o.write_shift(1,i=="e"?1:0),o}function TM(a,i,o){var c=a.read_shift(o&&o.biff>=12?2:1),u="sbcs-cont",r=ym;if(o&&o.biff>=8&&(ym=1200),!o||o.biff==8){var _=a.read_shift(1);_&&(u="dbcs-cont")}else o.biff==12&&(u="wstr");o.biff>=2&&o.biff<=5&&(u="cpstr");var T=c?a.read_shift(c,u):"";return ym=r,T}function d7(a){var i=a.t||"",o=1,c=cr(3+(o>1?2:0));c.write_shift(2,i.length),c.write_shift(1,(o>1?8:0)|1),o>1&&c.write_shift(2,o);var u=cr(2*i.length);u.write_shift(2*i.length,i,"utf16le");var r=[c,u];return Js(r)}function f7(a,i,o){var c;if(o){if(o.biff>=2&&o.biff<=5)return a.read_shift(i,"cpstr");if(o.biff>=12)return a.read_shift(i,"dbcs-cont")}var u=a.read_shift(1);return u===0?c=a.read_shift(i,"sbcs-cont"):c=a.read_shift(i,"dbcs-cont"),c}function p7(a,i,o){var c=a.read_shift(o&&o.biff==2?1:2);return c===0?(a.l++,""):f7(a,c,o)}function m7(a,i,o){if(o.biff>5)return p7(a,i,o);var c=a.read_shift(1);return c===0?(a.l++,""):a.read_shift(c,o.biff<=4||!a.lens?"cpstr":"sbcs-cont")}function SM(a,i,o){return o||(o=cr(3+2*a.length)),o.write_shift(2,a.length),o.write_shift(1,1),o.write_shift(31,a,"utf16le"),o}function wk(a,i){i||(i=cr(6+a.length*2)),i.write_shift(4,1+a.length);for(var o=0;o<a.length;++o)i.write_shift(2,a.charCodeAt(o));return i.write_shift(2,0),i}function g7(a){var i=cr(512),o=0,c=a.Target;c.slice(0,7)=="file://"&&(c=c.slice(7));var u=c.indexOf("#"),r=u>-1?31:23;switch(c.charAt(0)){case"#":r=28;break;case".":r&=-3;break}i.write_shift(4,2),i.write_shift(4,r);var _=[8,6815827,6619237,4849780,83];for(o=0;o<_.length;++o)i.write_shift(4,_[o]);if(r==28)c=c.slice(1),wk(c,i);else if(r&2){for(_="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),o=0;o<_.length;++o)i.write_shift(1,parseInt(_[o],16));var T=u>-1?c.slice(0,u):c;for(i.write_shift(4,2*(T.length+1)),o=0;o<T.length;++o)i.write_shift(2,T.charCodeAt(o));i.write_shift(2,0),r&8&&wk(u>-1?c.slice(u+1):"",i)}else{for(_="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),o=0;o<_.length;++o)i.write_shift(1,parseInt(_[o],16));for(var E=0;c.slice(E*3,E*3+3)=="../"||c.slice(E*3,E*3+3)=="..\\";)++E;for(i.write_shift(2,E),i.write_shift(4,c.length-3*E+1),o=0;o<c.length-3*E;++o)i.write_shift(1,c.charCodeAt(o+3*E)&255);for(i.write_shift(1,0),i.write_shift(2,65535),i.write_shift(2,57005),o=0;o<6;++o)i.write_shift(4,0)}return i.slice(0,i.l)}function Tm(a,i,o,c){return c||(c=cr(6)),c.write_shift(2,a),c.write_shift(2,i),c.write_shift(2,o||0),c}function _7(a,i,o){var c=o.biff>8?4:2,u=a.read_shift(c),r=a.read_shift(c,"i"),_=a.read_shift(c,"i");return[u,r,_]}function v7(a){var i=a.read_shift(2),o=a.read_shift(2),c=a.read_shift(2),u=a.read_shift(2);return{s:{c,r:i},e:{c:u,r:o}}}function EM(a,i){return i||(i=cr(8)),i.write_shift(2,a.s.r),i.write_shift(2,a.e.r),i.write_shift(2,a.s.c),i.write_shift(2,a.e.c),i}function cT(a,i,o){var c=1536,u=16;switch(o.bookType){case"biff8":break;case"biff5":c=1280,u=8;break;case"biff4":c=4,u=6;break;case"biff3":c=3,u=6;break;case"biff2":c=2,u=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var r=cr(u);return r.write_shift(2,c),r.write_shift(2,i),u>4&&r.write_shift(2,29282),u>6&&r.write_shift(2,1997),u>8&&(r.write_shift(2,49161),r.write_shift(2,1),r.write_shift(2,1798),r.write_shift(2,0)),r}function y7(a,i){var o=!i||i.biff==8,c=cr(o?112:54);for(c.write_shift(i.biff==8?2:1,7),o&&c.write_shift(1,0),c.write_shift(4,859007059),c.write_shift(4,5458548|(o?0:536870912));c.l<c.length;)c.write_shift(1,o?0:32);return c}function x7(a,i){var o=!i||i.biff>=8?2:1,c=cr(8+o*a.name.length);c.write_shift(4,a.pos),c.write_shift(1,a.hs||0),c.write_shift(1,a.dt),c.write_shift(1,a.name.length),i.biff>=8&&c.write_shift(1,1),c.write_shift(o*a.name.length,a.name,i.biff<8?"sbcs":"utf16le");var u=c.slice(0,c.l);return u.l=c.l,u}function b7(a,i){var o=cr(8);o.write_shift(4,a.Count),o.write_shift(4,a.Unique);for(var c=[],u=0;u<a.length;++u)c[u]=d7(a[u],i);var r=Js([o].concat(c));return r.parts=[o.length].concat(c.map(function(_){return _.length})),r}function w7(){var a=cr(18);return a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,29280),a.write_shift(2,17600),a.write_shift(2,56),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,1),a.write_shift(2,500),a}function T7(a){var i=cr(18),o=1718;return a&&a.RTL&&(o|=64),i.write_shift(2,o),i.write_shift(4,0),i.write_shift(4,64),i.write_shift(4,0),i.write_shift(4,0),i}function S7(a,i){var o=a.name||"Arial",c=i&&i.biff==5,u=c?15+o.length:16+2*o.length,r=cr(u);return r.write_shift(2,(a.sz||12)*20),r.write_shift(4,0),r.write_shift(2,400),r.write_shift(4,0),r.write_shift(2,0),r.write_shift(1,o.length),c||r.write_shift(1,1),r.write_shift((c?1:2)*o.length,o,c?"sbcs":"utf16le"),r}function E7(a,i,o,c){var u=cr(10);return Tm(a,i,c,u),u.write_shift(4,o),u}function A7(a,i,o,c,u){var r=!u||u.biff==8,_=cr(8+ +r+(1+r)*o.length);return Tm(a,i,c,_),_.write_shift(2,o.length),r&&_.write_shift(1,1),_.write_shift((1+r)*o.length,o,r?"utf16le":"sbcs"),_}function C7(a,i,o,c){var u=o&&o.biff==5;c||(c=cr(u?3+i.length:5+2*i.length)),c.write_shift(2,a),c.write_shift(u?1:2,i.length),u||c.write_shift(1,1),c.write_shift((u?1:2)*i.length,i,u?"sbcs":"utf16le");var r=c.length>c.l?c.slice(0,c.l):c;return r.l==null&&(r.l=r.length),r}function I7(a,i){var o=i.biff==8||!i.biff?4:2,c=cr(2*o+6);return c.write_shift(o,a.s.r),c.write_shift(o,a.e.r+1),c.write_shift(2,a.s.c),c.write_shift(2,a.e.c+1),c.write_shift(2,0),c}function Tk(a,i,o,c){var u=o&&o.biff==5;c||(c=cr(u?16:20)),c.write_shift(2,0),a.style?(c.write_shift(2,a.numFmtId||0),c.write_shift(2,65524)):(c.write_shift(2,a.numFmtId||0),c.write_shift(2,i<<4));var r=0;return a.numFmtId>0&&u&&(r|=1024),c.write_shift(4,r),c.write_shift(4,0),u||c.write_shift(4,0),c.write_shift(2,0),c}function k7(a){var i=cr(8);return i.write_shift(4,0),i.write_shift(2,a[0]?a[0]+1:0),i.write_shift(2,a[1]?a[1]+1:0),i}function M7(a,i,o,c,u,r){var _=cr(8);return Tm(a,i,c,_),wM(o,r,_),_}function D7(a,i,o,c){var u=cr(14);return Tm(a,i,c,u),wm(o,u),u}function R7(a,i,o){if(o.biff<8)return F7(a,i,o);for(var c=[],u=a.l+i,r=a.read_shift(o.biff>8?4:2);r--!==0;)c.push(_7(a,o.biff>8?12:6,o));if(a.l!=u)throw new Error("Bad ExternSheet: "+a.l+" != "+u);return c}function F7(a,i,o){a[a.l+1]==3&&a[a.l]++;var c=TM(a,i,o);return c.charCodeAt(0)==3?c.slice(1):c}function P7(a){var i=cr(2+a.length*8);i.write_shift(2,a.length);for(var o=0;o<a.length;++o)EM(a[o],i);return i}function L7(a){var i=cr(24),o=Ps(a[0]);i.write_shift(2,o.r),i.write_shift(2,o.r),i.write_shift(2,o.c),i.write_shift(2,o.c);for(var c="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),u=0;u<16;++u)i.write_shift(1,parseInt(c[u],16));return Js([i,g7(a[1])])}function O7(a){var i=a[1].Tooltip,o=cr(10+2*(i.length+1));o.write_shift(2,2048);var c=Ps(a[0]);o.write_shift(2,c.r),o.write_shift(2,c.r),o.write_shift(2,c.c),o.write_shift(2,c.c);for(var u=0;u<i.length;++u)o.write_shift(2,i.charCodeAt(u));return o.write_shift(2,0),o}function N7(a){return a||(a=cr(4)),a.write_shift(2,1),a.write_shift(2,1),a}function B7(a,i,o){if(!o.cellStyles)return ud(a,i);var c=o&&o.biff>=12?4:2,u=a.read_shift(c),r=a.read_shift(c),_=a.read_shift(c),T=a.read_shift(c),E=a.read_shift(2);c==2&&(a.l+=2);var k={s:u,e:r,w:_,ixfe:T,flags:E};return(o.biff>=5||!o.biff)&&(k.level=E>>8&7),k}function z7(a,i){var o=cr(12);o.write_shift(2,i),o.write_shift(2,i),o.write_shift(2,a.width*256),o.write_shift(2,0);var c=0;return a.hidden&&(c|=1),o.write_shift(1,c),c=a.level||0,o.write_shift(1,c),o.write_shift(2,0),o}function j7(a){for(var i=cr(2*a),o=0;o<a;++o)i.write_shift(2,o+1);return i}function U7(a,i,o){var c=cr(15);return _1(c,a,i),c.write_shift(8,o,"f"),c}function V7(a,i,o){var c=cr(9);return _1(c,a,i),c.write_shift(2,o),c}var G7=function(){var a={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},i=X5({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function o(T,E){var k=[],D=bm(1);switch(E.type){case"base64":D=mh(hf(T));break;case"binary":D=mh(T);break;case"buffer":case"array":D=T;break}qc(D,0);var j=D.read_shift(1),B=!!(j&136),P=!1,ee=!1;switch(j){case 2:break;case 3:break;case 48:P=!0,B=!0;break;case 49:P=!0,B=!0;break;case 131:break;case 139:break;case 140:ee=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+j.toString(16))}var G=0,K=521;j==2&&(G=D.read_shift(2)),D.l+=3,j!=2&&(G=D.read_shift(4)),G>1048576&&(G=1e6),j!=2&&(K=D.read_shift(2));var J=D.read_shift(2),ne=E.codepage||1252;j!=2&&(D.l+=16,D.read_shift(1),D[D.l]!==0&&(ne=a[D[D.l]]),D.l+=1,D.l+=2),ee&&(D.l+=36);for(var he=[],Me={},Re=Math.min(D.length,j==2?521:K-10-(P?264:0)),et=ee?32:11;D.l<Re&&D[D.l]!=13;)switch(Me={},Me.name=za.utils.decode(ne,D.slice(D.l,D.l+et)).replace(/[\u0000\r\n].*$/g,""),D.l+=et,Me.type=String.fromCharCode(D.read_shift(1)),j!=2&&!ee&&(Me.offset=D.read_shift(4)),Me.len=D.read_shift(1),j==2&&(Me.offset=D.read_shift(2)),Me.dec=D.read_shift(1),Me.name.length&&he.push(Me),j!=2&&(D.l+=ee?13:14),Me.type){case"B":(!P||Me.len!=8)&&E.WTF&&console.log("Skipping "+Me.name+":"+Me.type);break;case"G":case"P":E.WTF&&console.log("Skipping "+Me.name+":"+Me.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+Me.type)}if(D[D.l]!==13&&(D.l=K-1),D.read_shift(1)!==13)throw new Error("DBF Terminator not found "+D.l+" "+D[D.l]);D.l=K;var Te=0,ge=0;for(k[0]=[],ge=0;ge!=he.length;++ge)k[0][ge]=he[ge].name;for(;G-- >0;){if(D[D.l]===42){D.l+=J;continue}for(++D.l,k[++Te]=[],ge=0,ge=0;ge!=he.length;++ge){var Ue=D.slice(D.l,D.l+he[ge].len);D.l+=he[ge].len,qc(Ue,0);var Ae=za.utils.decode(ne,Ue);switch(he[ge].type){case"C":Ae.trim().length&&(k[Te][ge]=Ae.replace(/\s+$/,""));break;case"D":Ae.length===8?k[Te][ge]=new Date(+Ae.slice(0,4),+Ae.slice(4,6)-1,+Ae.slice(6,8)):k[Te][ge]=Ae;break;case"F":k[Te][ge]=parseFloat(Ae.trim());break;case"+":case"I":k[Te][ge]=ee?Ue.read_shift(-4,"i")^2147483648:Ue.read_shift(4,"i");break;case"L":switch(Ae.trim().toUpperCase()){case"Y":case"T":k[Te][ge]=!0;break;case"N":case"F":k[Te][ge]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Ae+"|")}break;case"M":if(!B)throw new Error("DBF Unexpected MEMO for type "+j.toString(16));k[Te][ge]="##MEMO##"+(ee?parseInt(Ae.trim(),10):Ue.read_shift(4));break;case"N":Ae=Ae.replace(/\u0000/g,"").trim(),Ae&&Ae!="."&&(k[Te][ge]=+Ae||0);break;case"@":k[Te][ge]=new Date(Ue.read_shift(-8,"f")-621356832e5);break;case"T":k[Te][ge]=new Date((Ue.read_shift(4)-2440588)*864e5+Ue.read_shift(4));break;case"Y":k[Te][ge]=Ue.read_shift(4,"i")/1e4+Ue.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":k[Te][ge]=-Ue.read_shift(-8,"f");break;case"B":if(P&&he[ge].len==8){k[Te][ge]=Ue.read_shift(8,"f");break}case"G":case"P":Ue.l+=he[ge].len;break;case"0":if(he[ge].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+he[ge].type)}}}if(j!=2&&D.l<D.length&&D[D.l++]!=26)throw new Error("DBF EOF Marker missing "+(D.l-1)+" of "+D.length+" "+D[D.l-1].toString(16));return E&&E.sheetRows&&(k=k.slice(0,E.sheetRows)),E.DBF=he,k}function c(T,E){var k=E||{};k.dateNF||(k.dateNF="yyyymmdd");var D=hg(o(T,k),k);return D["!cols"]=k.DBF.map(function(j){return{wch:j.len,DBF:j}}),delete k.DBF,D}function u(T,E){try{return Sm(c(T,E),E)}catch(k){if(E&&E.WTF)throw k}return{SheetNames:[],Sheets:{}}}var r={B:8,C:250,L:1,D:8,"?":0,"":0};function _(T,E){var k=E||{};if(+k.codepage>=0&&s1(+k.codepage),k.type=="string")throw new Error("Cannot write DBF to JS string");var D=dc(),j=bx(T,{header:1,raw:!0,cellDates:!0}),B=j[0],P=j.slice(1),ee=T["!cols"]||[],G=0,K=0,J=0,ne=1;for(G=0;G<B.length;++G){if(((ee[G]||{}).DBF||{}).name){B[G]=ee[G].DBF.name,++J;continue}if(B[G]!=null){if(++J,typeof B[G]=="number"&&(B[G]=B[G].toString(10)),typeof B[G]!="string")throw new Error("DBF Invalid column name "+B[G]+" |"+typeof B[G]+"|");if(B.indexOf(B[G])!==G){for(K=0;K<1024;++K)if(B.indexOf(B[G]+"_"+K)==-1){B[G]+="_"+K;break}}}}var he=ao(T["!ref"]),Me=[],Re=[],et=[];for(G=0;G<=he.e.c-he.s.c;++G){var Te="",ge="",Ue=0,Ae=[];for(K=0;K<P.length;++K)P[K][G]!=null&&Ae.push(P[K][G]);if(Ae.length==0||B[G]==null){Me[G]="?";continue}for(K=0;K<Ae.length;++K){switch(typeof Ae[K]){case"number":ge="B";break;case"string":ge="C";break;case"boolean":ge="L";break;case"object":ge=Ae[K]instanceof Date?"D":"C";break;default:ge="C"}Ue=Math.max(Ue,String(Ae[K]).length),Te=Te&&Te!=ge?"C":ge}Ue>250&&(Ue=250),ge=((ee[G]||{}).DBF||{}).type,ge=="C"&&ee[G].DBF.len>Ue&&(Ue=ee[G].DBF.len),Te=="B"&&ge=="N"&&(Te="N",et[G]=ee[G].DBF.dec,Ue=ee[G].DBF.len),Re[G]=Te=="C"||ge=="N"?Ue:r[Te]||0,ne+=Re[G],Me[G]=Te}var _e=D.next(32);for(_e.write_shift(4,318902576),_e.write_shift(4,P.length),_e.write_shift(2,296+32*J),_e.write_shift(2,ne),G=0;G<4;++G)_e.write_shift(4,0);for(_e.write_shift(4,0|(+i[sg]||3)<<8),G=0,K=0;G<B.length;++G)if(B[G]!=null){var ve=D.next(32),Qe=(B[G].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ve.write_shift(1,Qe,"sbcs"),ve.write_shift(1,Me[G]=="?"?"C":Me[G],"sbcs"),ve.write_shift(4,K),ve.write_shift(1,Re[G]||r[Me[G]]||0),ve.write_shift(1,et[G]||0),ve.write_shift(1,2),ve.write_shift(4,0),ve.write_shift(1,0),ve.write_shift(4,0),ve.write_shift(4,0),K+=Re[G]||r[Me[G]]||0}var Ce=D.next(264);for(Ce.write_shift(4,13),G=0;G<65;++G)Ce.write_shift(4,0);for(G=0;G<P.length;++G){var Ye=D.next(ne);for(Ye.write_shift(1,0),K=0;K<B.length;++K)if(B[K]!=null)switch(Me[K]){case"L":Ye.write_shift(1,P[G][K]==null?63:P[G][K]?84:70);break;case"B":Ye.write_shift(8,P[G][K]||0,"f");break;case"N":var ut="0";for(typeof P[G][K]=="number"&&(ut=P[G][K].toFixed(et[K]||0)),J=0;J<Re[K]-ut.length;++J)Ye.write_shift(1,32);Ye.write_shift(1,ut,"sbcs");break;case"D":P[G][K]?(Ye.write_shift(4,("0000"+P[G][K].getFullYear()).slice(-4),"sbcs"),Ye.write_shift(2,("00"+(P[G][K].getMonth()+1)).slice(-2),"sbcs"),Ye.write_shift(2,("00"+P[G][K].getDate()).slice(-2),"sbcs")):Ye.write_shift(8,"00000000","sbcs");break;case"C":var st=String(P[G][K]!=null?P[G][K]:"").slice(0,Re[K]);for(Ye.write_shift(1,st,"sbcs"),J=0;J<Re[K]-st.length;++J)Ye.write_shift(1,32);break}}return D.next(1).write_shift(1,26),D.end()}return{to_workbook:u,to_sheet:c,from_sheet:_}}(),H7=function(){var a={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},i=new RegExp("\x1BN("+tl(a).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),o=function(B,P){var ee=a[P];return typeof ee=="number"?$4(ee):ee},c=function(B,P,ee){var G=P.charCodeAt(0)-32<<4|ee.charCodeAt(0)-48;return G==59?B:$4(G)};a["|"]=254;function u(B,P){switch(P.type){case"base64":return r(hf(B),P);case"binary":return r(B,P);case"buffer":return r(oa&&Buffer.isBuffer(B)?B.toString("binary"):f1(B),P);case"array":return r(Ax(B),P)}throw new Error("Unrecognized type "+P.type)}function r(B,P){var ee=B.split(/[\n\r]+/),G=-1,K=-1,J=0,ne=0,he=[],Me=[],Re=null,et={},Te=[],ge=[],Ue=[],Ae=0,_e;for(+P.codepage>=0&&s1(+P.codepage);J!==ee.length;++J){Ae=0;var ve=ee[J].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,c).replace(i,o),Qe=ve.replace(/;;/g,"\0").split(";").map(function(Ie){return Ie.replace(/\u0000/g,";")}),Ce=Qe[0],Ye;if(ve.length>0)switch(Ce){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Qe[1].charAt(0)=="P"&&Me.push(ve.slice(3).replace(/;;/g,";"));break;case"C":var ut=!1,st=!1,pt=!1,Tt=!1,ht=-1,Wt=-1;for(ne=1;ne<Qe.length;++ne)switch(Qe[ne].charAt(0)){case"A":break;case"X":K=parseInt(Qe[ne].slice(1))-1,st=!0;break;case"Y":for(G=parseInt(Qe[ne].slice(1))-1,st||(K=0),_e=he.length;_e<=G;++_e)he[_e]=[];break;case"K":Ye=Qe[ne].slice(1),Ye.charAt(0)==='"'?Ye=Ye.slice(1,Ye.length-1):Ye==="TRUE"?Ye=!0:Ye==="FALSE"?Ye=!1:isNaN(cf(Ye))?isNaN(c1(Ye).getDate())||(Ye=jl(Ye)):(Ye=cf(Ye),Re!==null&&Hk(Re)&&(Ye=Xk(Ye))),typeof za<"u"&&typeof Ye=="string"&&(P||{}).type!="string"&&(P||{}).codepage&&(Ye=za.utils.decode(P.codepage,Ye)),ut=!0;break;case"E":Tt=!0;var re=Vj(Qe[ne].slice(1),{r:G,c:K});he[G][K]=[he[G][K],re];break;case"S":pt=!0,he[G][K]=[he[G][K],"S5S"];break;case"G":break;case"R":ht=parseInt(Qe[ne].slice(1))-1;break;case"C":Wt=parseInt(Qe[ne].slice(1))-1;break;default:if(P&&P.WTF)throw new Error("SYLK bad record "+ve)}if(ut&&(he[G][K]&&he[G][K].length==2?he[G][K][0]=Ye:he[G][K]=Ye,Re=null),pt){if(Tt)throw new Error("SYLK shared formula cannot have own formula");var xe=ht>-1&&he[ht][Wt];if(!xe||!xe[1])throw new Error("SYLK shared formula cannot find base");he[G][K][1]=Gj(xe[1],{r:G-ht,c:K-Wt})}break;case"F":var pe=0;for(ne=1;ne<Qe.length;++ne)switch(Qe[ne].charAt(0)){case"X":K=parseInt(Qe[ne].slice(1))-1,++pe;break;case"Y":for(G=parseInt(Qe[ne].slice(1))-1,_e=he.length;_e<=G;++_e)he[_e]=[];break;case"M":Ae=parseInt(Qe[ne].slice(1))/20;break;case"F":break;case"G":break;case"P":Re=Me[parseInt(Qe[ne].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(Ue=Qe[ne].slice(1).split(" "),_e=parseInt(Ue[0],10);_e<=parseInt(Ue[1],10);++_e)Ae=parseInt(Ue[2],10),ge[_e-1]=Ae===0?{hidden:!0}:{wch:Ae},uT(ge[_e-1]);break;case"C":K=parseInt(Qe[ne].slice(1))-1,ge[K]||(ge[K]={});break;case"R":G=parseInt(Qe[ne].slice(1))-1,Te[G]||(Te[G]={}),Ae>0?(Te[G].hpt=Ae,Te[G].hpx=MM(Ae)):Ae===0&&(Te[G].hidden=!0);break;default:if(P&&P.WTF)throw new Error("SYLK bad record "+ve)}pe<1&&(Re=null);break;default:if(P&&P.WTF)throw new Error("SYLK bad record "+ve)}}return Te.length>0&&(et["!rows"]=Te),ge.length>0&&(et["!cols"]=ge),P&&P.sheetRows&&(he=he.slice(0,P.sheetRows)),[he,et]}function _(B,P){var ee=u(B,P),G=ee[0],K=ee[1],J=hg(G,P);return tl(K).forEach(function(ne){J[ne]=K[ne]}),J}function T(B,P){return Sm(_(B,P),P)}function E(B,P,ee,G){var K="C;Y"+(ee+1)+";X"+(G+1)+";K";switch(B.t){case"n":K+=B.v||0,B.f&&!B.F&&(K+=";E"+dT(B.f,{r:ee,c:G}));break;case"b":K+=B.v?"TRUE":"FALSE";break;case"e":K+=B.w||B.v;break;case"d":K+='"'+(B.w||B.v)+'"';break;case"s":K+='"'+B.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return K}function k(B,P){P.forEach(function(ee,G){var K="F;W"+(G+1)+" "+(G+1)+" ";ee.hidden?K+="0":(typeof ee.width=="number"&&!ee.wpx&&(ee.wpx=_x(ee.width)),typeof ee.wpx=="number"&&!ee.wch&&(ee.wch=vx(ee.wpx)),typeof ee.wch=="number"&&(K+=Math.round(ee.wch))),K.charAt(K.length-1)!=" "&&B.push(K)})}function D(B,P){P.forEach(function(ee,G){var K="F;";ee.hidden?K+="M0;":ee.hpt?K+="M"+20*ee.hpt+";":ee.hpx&&(K+="M"+20*yx(ee.hpx)+";"),K.length>2&&B.push(K+"R"+(G+1))})}function j(B,P){var ee=["ID;PWXL;N;E"],G=[],K=ao(B["!ref"]),J,ne=Array.isArray(B),he=`\r
`;ee.push("P;PGeneral"),ee.push("F;P0;DG0G8;M255"),B["!cols"]&&k(ee,B["!cols"]),B["!rows"]&&D(ee,B["!rows"]),ee.push("B;Y"+(K.e.r-K.s.r+1)+";X"+(K.e.c-K.s.c+1)+";D"+[K.s.c,K.s.r,K.e.c,K.e.r].join(" "));for(var Me=K.s.r;Me<=K.e.r;++Me)for(var Re=K.s.c;Re<=K.e.c;++Re){var et=Ia({r:Me,c:Re});J=ne?(B[Me]||[])[Re]:B[et],!(!J||J.v==null&&(!J.f||J.F))&&G.push(E(J,B,Me,Re,P))}return ee.join(he)+he+G.join(he)+he+"E"+he}return{to_workbook:T,to_sheet:_,from_sheet:j}}(),W7=function(){function a(r,_){switch(_.type){case"base64":return i(hf(r),_);case"binary":return i(r,_);case"buffer":return i(oa&&Buffer.isBuffer(r)?r.toString("binary"):f1(r),_);case"array":return i(Ax(r),_)}throw new Error("Unrecognized type "+_.type)}function i(r,_){for(var T=r.split(`
`),E=-1,k=-1,D=0,j=[];D!==T.length;++D){if(T[D].trim()==="BOT"){j[++E]=[],k=0;continue}if(!(E<0)){var B=T[D].trim().split(","),P=B[0],ee=B[1];++D;for(var G=T[D]||"";(G.match(/["]/g)||[]).length&1&&D<T.length-1;)G+=`
`+T[++D];switch(G=G.trim(),+P){case-1:if(G==="BOT"){j[++E]=[],k=0;continue}else if(G!=="EOD")throw new Error("Unrecognized DIF special command "+G);break;case 0:G==="TRUE"?j[E][k]=!0:G==="FALSE"?j[E][k]=!1:isNaN(cf(ee))?isNaN(c1(ee).getDate())?j[E][k]=ee:j[E][k]=jl(ee):j[E][k]=cf(ee),++k;break;case 1:G=G.slice(1,G.length-1),G=G.replace(/""/g,'"'),J_&&G&&G.match(/^=".*"$/)&&(G=G.slice(2,-1)),j[E][k++]=G!==""?G:null;break}if(G==="EOD")break}}return _&&_.sheetRows&&(j=j.slice(0,_.sheetRows)),j}function o(r,_){return hg(a(r,_),_)}function c(r,_){return Sm(o(r,_),_)}var u=function(){var r=function(E,k,D,j,B){E.push(k),E.push(D+","+j),E.push('"'+B.replace(/"/g,'""')+'"')},_=function(E,k,D,j){E.push(k+","+D),E.push(k==1?'"'+j.replace(/"/g,'""')+'"':j)};return function(E){var k=[],D=ao(E["!ref"]),j,B=Array.isArray(E);r(k,"TABLE",0,1,"sheetjs"),r(k,"VECTORS",0,D.e.r-D.s.r+1,""),r(k,"TUPLES",0,D.e.c-D.s.c+1,""),r(k,"DATA",0,0,"");for(var P=D.s.r;P<=D.e.r;++P){_(k,-1,0,"BOT");for(var ee=D.s.c;ee<=D.e.c;++ee){var G=Ia({r:P,c:ee});if(j=B?(E[P]||[])[ee]:E[G],!j){_(k,1,0,"");continue}switch(j.t){case"n":var K=J_?j.w:j.v;!K&&j.v!=null&&(K=j.v),K==null?J_&&j.f&&!j.F?_(k,1,0,"="+j.f):_(k,1,0,""):_(k,0,K,"V");break;case"b":_(k,0,j.v?1:0,j.v?"TRUE":"FALSE");break;case"s":_(k,1,0,!J_||isNaN(j.v)?j.v:'="'+j.v+'"');break;case"d":j.w||(j.w=_p(j.z||Ro[14],fc(jl(j.v)))),J_?_(k,0,j.w,"V"):_(k,1,0,j.w);break;default:_(k,1,0,"")}}}_(k,-1,0,"EOD");var J=`\r
`,ne=k.join(J);return ne}}();return{to_workbook:c,to_sheet:o,from_sheet:u}}(),AM=function(){function a(j){return j.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function i(j){return j.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function o(j,B){for(var P=j.split(`
`),ee=-1,G=-1,K=0,J=[];K!==P.length;++K){var ne=P[K].trim().split(":");if(ne[0]==="cell"){var he=Ps(ne[1]);if(J.length<=he.r)for(ee=J.length;ee<=he.r;++ee)J[ee]||(J[ee]=[]);switch(ee=he.r,G=he.c,ne[2]){case"t":J[ee][G]=a(ne[3]);break;case"v":J[ee][G]=+ne[3];break;case"vtf":var Me=ne[ne.length-1];case"vtc":switch(ne[3]){case"nl":J[ee][G]=!!+ne[4];break;default:J[ee][G]=+ne[4];break}ne[2]=="vtf"&&(J[ee][G]=[J[ee][G],Me])}}}return B&&B.sheetRows&&(J=J.slice(0,B.sheetRows)),J}function c(j,B){return hg(o(j,B),B)}function u(j,B){return Sm(c(j,B),B)}var r=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),_=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,T=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),E="--SocialCalcSpreadsheetControlSave--";function k(j){if(!j||!j["!ref"])return"";for(var B=[],P=[],ee,G="",K=Xc(j["!ref"]),J=Array.isArray(j),ne=K.s.r;ne<=K.e.r;++ne)for(var he=K.s.c;he<=K.e.c;++he)if(G=Ia({r:ne,c:he}),ee=J?(j[ne]||[])[he]:j[G],!(!ee||ee.v==null||ee.t==="z")){switch(P=["cell",G,"t"],ee.t){case"s":case"str":P.push(i(ee.v));break;case"n":ee.f?(P[2]="vtf",P[3]="n",P[4]=ee.v,P[5]=i(ee.f)):(P[2]="v",P[3]=ee.v);break;case"b":P[2]="vt"+(ee.f?"f":"c"),P[3]="nl",P[4]=ee.v?"1":"0",P[5]=i(ee.f||(ee.v?"TRUE":"FALSE"));break;case"d":var Me=fc(jl(ee.v));P[2]="vtc",P[3]="nd",P[4]=""+Me,P[5]=ee.w||_p(ee.z||Ro[14],Me);break;case"e":continue}B.push(P.join(":"))}return B.push("sheet:c:"+(K.e.c-K.s.c+1)+":r:"+(K.e.r-K.s.r+1)+":tvf:1"),B.push("valueformat:1:text-wiki"),B.join(`
`)}function D(j){return[r,_,T,_,k(j),E].join(`
`)}return{to_workbook:u,to_sheet:c,from_sheet:D}}(),q7=function(){function a(D,j,B,P,ee){ee.raw?j[B][P]=D:D===""||(D==="TRUE"?j[B][P]=!0:D==="FALSE"?j[B][P]=!1:isNaN(cf(D))?isNaN(c1(D).getDate())?j[B][P]=D:j[B][P]=jl(D):j[B][P]=cf(D))}function i(D,j){var B=j||{},P=[];if(!D||D.length===0)return P;for(var ee=D.split(/[\r\n]/),G=ee.length-1;G>=0&&ee[G].length===0;)--G;for(var K=10,J=0,ne=0;ne<=G;++ne)J=ee[ne].indexOf(" "),J==-1?J=ee[ne].length:J++,K=Math.max(K,J);for(ne=0;ne<=G;++ne){P[ne]=[];var he=0;for(a(ee[ne].slice(0,K).trim(),P,ne,he,B),he=1;he<=(ee[ne].length-K)/10+1;++he)a(ee[ne].slice(K+(he-1)*10,K+he*10).trim(),P,ne,he,B)}return B.sheetRows&&(P=P.slice(0,B.sheetRows)),P}var o={44:",",9:"	",59:";",124:"|"},c={44:3,9:2,59:1,124:0};function u(D){for(var j={},B=!1,P=0,ee=0;P<D.length;++P)(ee=D.charCodeAt(P))==34?B=!B:!B&&ee in o&&(j[ee]=(j[ee]||0)+1);ee=[];for(P in j)Object.prototype.hasOwnProperty.call(j,P)&&ee.push([j[P],P]);if(!ee.length){j=c;for(P in j)Object.prototype.hasOwnProperty.call(j,P)&&ee.push([j[P],P])}return ee.sort(function(G,K){return G[0]-K[0]||c[G[1]]-c[K[1]]}),o[ee.pop()[1]]||44}function r(D,j){var B=j||{},P="";cd!=null&&B.dense==null&&(B.dense=cd);var ee=B.dense?[]:{},G={s:{c:0,r:0},e:{c:0,r:0}};D.slice(0,4)=="sep="?D.charCodeAt(5)==13&&D.charCodeAt(6)==10?(P=D.charAt(4),D=D.slice(7)):D.charCodeAt(5)==13||D.charCodeAt(5)==10?(P=D.charAt(4),D=D.slice(6)):P=u(D.slice(0,1024)):B&&B.FS?P=B.FS:P=u(D.slice(0,1024));var K=0,J=0,ne=0,he=0,Me=0,Re=P.charCodeAt(0),et=!1,Te=0,ge=D.charCodeAt(0);D=D.replace(/\r\n/mg,`
`);var Ue=B.dateNF!=null?sz(B.dateNF):null;function Ae(){var _e=D.slice(he,Me),ve={};if(_e.charAt(0)=='"'&&_e.charAt(_e.length-1)=='"'&&(_e=_e.slice(1,-1).replace(/""/g,'"')),_e.length===0)ve.t="z";else if(B.raw)ve.t="s",ve.v=_e;else if(_e.trim().length===0)ve.t="s",ve.v=_e;else if(_e.charCodeAt(0)==61)_e.charCodeAt(1)==34&&_e.charCodeAt(_e.length-1)==34?(ve.t="s",ve.v=_e.slice(2,-1).replace(/""/g,'"')):Hj(_e)?(ve.t="n",ve.f=_e.slice(1)):(ve.t="s",ve.v=_e);else if(_e=="TRUE")ve.t="b",ve.v=!0;else if(_e=="FALSE")ve.t="b",ve.v=!1;else if(!isNaN(ne=cf(_e)))ve.t="n",B.cellText!==!1&&(ve.w=_e),ve.v=ne;else if(!isNaN(c1(_e).getDate())||Ue&&_e.match(Ue)){ve.z=B.dateNF||Ro[14];var Qe=0;Ue&&_e.match(Ue)&&(_e=lz(_e,B.dateNF,_e.match(Ue)||[]),Qe=1),B.cellDates?(ve.t="d",ve.v=jl(_e,Qe)):(ve.t="n",ve.v=fc(jl(_e,Qe))),B.cellText!==!1&&(ve.w=_p(ve.z,ve.v instanceof Date?fc(ve.v):ve.v)),B.cellNF||delete ve.z}else ve.t="s",ve.v=_e;if(ve.t=="z"||(B.dense?(ee[K]||(ee[K]=[]),ee[K][J]=ve):ee[Ia({c:J,r:K})]=ve),he=Me+1,ge=D.charCodeAt(he),G.e.c<J&&(G.e.c=J),G.e.r<K&&(G.e.r=K),Te==Re)++J;else if(J=0,++K,B.sheetRows&&B.sheetRows<=K)return!0}e:for(;Me<D.length;++Me)switch(Te=D.charCodeAt(Me)){case 34:ge===34&&(et=!et);break;case Re:case 10:case 13:if(!et&&Ae())break e;break;default:break}return Me-he>0&&Ae(),ee["!ref"]=es(G),ee}function _(D,j){return!(j&&j.PRN)||j.FS||D.slice(0,4)=="sep="||D.indexOf("	")>=0||D.indexOf(",")>=0||D.indexOf(";")>=0?r(D,j):hg(i(D,j),j)}function T(D,j){var B="",P=j.type=="string"?[0,0,0,0]:nH(D,j);switch(j.type){case"base64":B=hf(D);break;case"binary":B=D;break;case"buffer":j.codepage==65001?B=D.toString("utf8"):j.codepage&&typeof za<"u"?B=za.utils.decode(j.codepage,D):B=oa&&Buffer.isBuffer(D)?D.toString("binary"):f1(D);break;case"array":B=Ax(D);break;case"string":B=D;break;default:throw new Error("Unrecognized type "+j.type)}return P[0]==239&&P[1]==187&&P[2]==191?B=t1(B.slice(3)):j.type!="string"&&j.type!="buffer"&&j.codepage==65001?B=t1(B):j.type=="binary"&&typeof za<"u"&&j.codepage&&(B=za.utils.decode(j.codepage,za.utils.encode(28591,B))),B.slice(0,19)=="socialcalc:version:"?AM.to_sheet(j.type=="string"?B:t1(B),j):_(B,j)}function E(D,j){return Sm(T(D,j),j)}function k(D){for(var j=[],B=ao(D["!ref"]),P,ee=Array.isArray(D),G=B.s.r;G<=B.e.r;++G){for(var K=[],J=B.s.c;J<=B.e.c;++J){var ne=Ia({r:G,c:J});if(P=ee?(D[G]||[])[J]:D[ne],!P||P.v==null){K.push("          ");continue}for(var he=(P.w||(df(P),P.w)||"").slice(0,10);he.length<10;)he+=" ";K.push(he+(J===0?" ":""))}j.push(K.join(""))}return j.join(`
`)}return{to_workbook:E,to_sheet:T,from_sheet:k}}();var Sk=function(){function a(re,xe,pe){if(re){qc(re,re.l||0);for(var Ie=pe.Enum||ht;re.l<re.length;){var Ve=re.read_shift(2),gt=Ie[Ve]||Ie[65535],mt=re.read_shift(2),wt=re.l+mt,Pt=gt.f&&gt.f(re,mt,pe);if(re.l=wt,xe(Pt,gt,Ve))return}}}function i(re,xe){switch(xe.type){case"base64":return o(mh(hf(re)),xe);case"binary":return o(mh(re),xe);case"buffer":case"array":return o(re,xe)}throw"Unsupported type "+xe.type}function o(re,xe){if(!re)return re;var pe=xe||{};cd!=null&&pe.dense==null&&(pe.dense=cd);var Ie=pe.dense?[]:{},Ve="Sheet1",gt="",mt=0,wt={},Pt=[],fr=[],xr={s:{r:0,c:0},e:{r:0,c:0}},Rr=pe.sheetRows||0;if(re[2]==0&&(re[3]==8||re[3]==9)&&re.length>=16&&re[14]==5&&re[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(re[2]==2)pe.Enum=ht,a(re,function(Bt,nr,br){switch(br){case 0:pe.vers=Bt,Bt>=4096&&(pe.qpro=!0);break;case 6:xr=Bt;break;case 204:Bt&&(gt=Bt);break;case 222:gt=Bt;break;case 15:case 51:pe.qpro||(Bt[1].v=Bt[1].v.slice(1));case 13:case 14:case 16:br==14&&(Bt[2]&112)==112&&(Bt[2]&15)>1&&(Bt[2]&15)<15&&(Bt[1].z=pe.dateNF||Ro[14],pe.cellDates&&(Bt[1].t="d",Bt[1].v=Xk(Bt[1].v))),pe.qpro&&Bt[3]>mt&&(Ie["!ref"]=es(xr),wt[Ve]=Ie,Pt.push(Ve),Ie=pe.dense?[]:{},xr={s:{r:0,c:0},e:{r:0,c:0}},mt=Bt[3],Ve=gt||"Sheet"+(mt+1),gt="");var kr=pe.dense?(Ie[Bt[0].r]||[])[Bt[0].c]:Ie[Ia(Bt[0])];if(kr){kr.t=Bt[1].t,kr.v=Bt[1].v,Bt[1].z!=null&&(kr.z=Bt[1].z),Bt[1].f!=null&&(kr.f=Bt[1].f);break}pe.dense?(Ie[Bt[0].r]||(Ie[Bt[0].r]=[]),Ie[Bt[0].r][Bt[0].c]=Bt[1]):Ie[Ia(Bt[0])]=Bt[1];break;default:}},pe);else if(re[2]==26||re[2]==14)pe.Enum=Wt,re[2]==14&&(pe.qpro=!0,re.l=0),a(re,function(Bt,nr,br){switch(br){case 204:Ve=Bt;break;case 22:Bt[1].v=Bt[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Bt[3]>mt&&(Ie["!ref"]=es(xr),wt[Ve]=Ie,Pt.push(Ve),Ie=pe.dense?[]:{},xr={s:{r:0,c:0},e:{r:0,c:0}},mt=Bt[3],Ve="Sheet"+(mt+1)),Rr>0&&Bt[0].r>=Rr)break;pe.dense?(Ie[Bt[0].r]||(Ie[Bt[0].r]=[]),Ie[Bt[0].r][Bt[0].c]=Bt[1]):Ie[Ia(Bt[0])]=Bt[1],xr.e.c<Bt[0].c&&(xr.e.c=Bt[0].c),xr.e.r<Bt[0].r&&(xr.e.r=Bt[0].r);break;case 27:Bt[14e3]&&(fr[Bt[14e3][0]]=Bt[14e3][1]);break;case 1537:fr[Bt[0]]=Bt[1],Bt[0]==mt&&(Ve=Bt[1]);break;default:break}},pe);else throw new Error("Unrecognized LOTUS BOF "+re[2]);if(Ie["!ref"]=es(xr),wt[gt||Ve]=Ie,Pt.push(gt||Ve),!fr.length)return{SheetNames:Pt,Sheets:wt};for(var Fr={},$t=[],lt=0;lt<fr.length;++lt)wt[Pt[lt]]?($t.push(fr[lt]||Pt[lt]),Fr[fr[lt]]=wt[fr[lt]]||wt[Pt[lt]]):($t.push(fr[lt]),Fr[fr[lt]]={"!ref":"A1"});return{SheetNames:$t,Sheets:Fr}}function c(re,xe){var pe=xe||{};if(+pe.codepage>=0&&s1(+pe.codepage),pe.type=="string")throw new Error("Cannot write WK1 to JS string");var Ie=dc(),Ve=ao(re["!ref"]),gt=Array.isArray(re),mt=[];Gr(Ie,0,r(1030)),Gr(Ie,6,E(Ve));for(var wt=Math.min(Ve.e.r,8191),Pt=Ve.s.r;Pt<=wt;++Pt)for(var fr=el(Pt),xr=Ve.s.c;xr<=Ve.e.c;++xr){Pt===Ve.s.r&&(mt[xr]=vl(xr));var Rr=mt[xr]+fr,Fr=gt?(re[Pt]||[])[xr]:re[Rr];if(!(!Fr||Fr.t=="z"))if(Fr.t=="n")(Fr.v|0)==Fr.v&&Fr.v>=-32768&&Fr.v<=32767?Gr(Ie,13,P(Pt,xr,Fr.v)):Gr(Ie,14,G(Pt,xr,Fr.v));else{var $t=df(Fr);Gr(Ie,15,j(Pt,xr,$t.slice(0,239)))}}return Gr(Ie,1),Ie.end()}function u(re,xe){var pe=xe||{};if(+pe.codepage>=0&&s1(+pe.codepage),pe.type=="string")throw new Error("Cannot write WK3 to JS string");var Ie=dc();Gr(Ie,0,_(re));for(var Ve=0,gt=0;Ve<re.SheetNames.length;++Ve)(re.Sheets[re.SheetNames[Ve]]||{})["!ref"]&&Gr(Ie,27,Tt(re.SheetNames[Ve],gt++));var mt=0;for(Ve=0;Ve<re.SheetNames.length;++Ve){var wt=re.Sheets[re.SheetNames[Ve]];if(!(!wt||!wt["!ref"])){for(var Pt=ao(wt["!ref"]),fr=Array.isArray(wt),xr=[],Rr=Math.min(Pt.e.r,8191),Fr=Pt.s.r;Fr<=Rr;++Fr)for(var $t=el(Fr),lt=Pt.s.c;lt<=Pt.e.c;++lt){Fr===Pt.s.r&&(xr[lt]=vl(lt));var Bt=xr[lt]+$t,nr=fr?(wt[Fr]||[])[lt]:wt[Bt];if(!(!nr||nr.t=="z"))if(nr.t=="n")Gr(Ie,23,Ae(Fr,lt,mt,nr.v));else{var br=df(nr);Gr(Ie,22,Te(Fr,lt,mt,br.slice(0,239)))}}++mt}}return Gr(Ie,1),Ie.end()}function r(re){var xe=cr(2);return xe.write_shift(2,re),xe}function _(re){var xe=cr(26);xe.write_shift(2,4096),xe.write_shift(2,4),xe.write_shift(4,0);for(var pe=0,Ie=0,Ve=0,gt=0;gt<re.SheetNames.length;++gt){var mt=re.SheetNames[gt],wt=re.Sheets[mt];if(!(!wt||!wt["!ref"])){++Ve;var Pt=Xc(wt["!ref"]);pe<Pt.e.r&&(pe=Pt.e.r),Ie<Pt.e.c&&(Ie=Pt.e.c)}}return pe>8191&&(pe=8191),xe.write_shift(2,pe),xe.write_shift(1,Ve),xe.write_shift(1,Ie),xe.write_shift(2,0),xe.write_shift(2,0),xe.write_shift(1,1),xe.write_shift(1,2),xe.write_shift(4,0),xe.write_shift(4,0),xe}function T(re,xe,pe){var Ie={s:{c:0,r:0},e:{c:0,r:0}};return xe==8&&pe.qpro?(Ie.s.c=re.read_shift(1),re.l++,Ie.s.r=re.read_shift(2),Ie.e.c=re.read_shift(1),re.l++,Ie.e.r=re.read_shift(2),Ie):(Ie.s.c=re.read_shift(2),Ie.s.r=re.read_shift(2),xe==12&&pe.qpro&&(re.l+=2),Ie.e.c=re.read_shift(2),Ie.e.r=re.read_shift(2),xe==12&&pe.qpro&&(re.l+=2),Ie.s.c==65535&&(Ie.s.c=Ie.e.c=Ie.s.r=Ie.e.r=0),Ie)}function E(re){var xe=cr(8);return xe.write_shift(2,re.s.c),xe.write_shift(2,re.s.r),xe.write_shift(2,re.e.c),xe.write_shift(2,re.e.r),xe}function k(re,xe,pe){var Ie=[{c:0,r:0},{t:"n",v:0},0,0];return pe.qpro&&pe.vers!=20768?(Ie[0].c=re.read_shift(1),Ie[3]=re.read_shift(1),Ie[0].r=re.read_shift(2),re.l+=2):(Ie[2]=re.read_shift(1),Ie[0].c=re.read_shift(2),Ie[0].r=re.read_shift(2)),Ie}function D(re,xe,pe){var Ie=re.l+xe,Ve=k(re,xe,pe);if(Ve[1].t="s",pe.vers==20768){re.l++;var gt=re.read_shift(1);return Ve[1].v=re.read_shift(gt,"utf8"),Ve}return pe.qpro&&re.l++,Ve[1].v=re.read_shift(Ie-re.l,"cstr"),Ve}function j(re,xe,pe){var Ie=cr(7+pe.length);Ie.write_shift(1,255),Ie.write_shift(2,xe),Ie.write_shift(2,re),Ie.write_shift(1,39);for(var Ve=0;Ve<Ie.length;++Ve){var gt=pe.charCodeAt(Ve);Ie.write_shift(1,gt>=128?95:gt)}return Ie.write_shift(1,0),Ie}function B(re,xe,pe){var Ie=k(re,xe,pe);return Ie[1].v=re.read_shift(2,"i"),Ie}function P(re,xe,pe){var Ie=cr(7);return Ie.write_shift(1,255),Ie.write_shift(2,xe),Ie.write_shift(2,re),Ie.write_shift(2,pe,"i"),Ie}function ee(re,xe,pe){var Ie=k(re,xe,pe);return Ie[1].v=re.read_shift(8,"f"),Ie}function G(re,xe,pe){var Ie=cr(13);return Ie.write_shift(1,255),Ie.write_shift(2,xe),Ie.write_shift(2,re),Ie.write_shift(8,pe,"f"),Ie}function K(re,xe,pe){var Ie=re.l+xe,Ve=k(re,xe,pe);if(Ve[1].v=re.read_shift(8,"f"),pe.qpro)re.l=Ie;else{var gt=re.read_shift(2);Me(re.slice(re.l,re.l+gt),Ve),re.l+=gt}return Ve}function J(re,xe,pe){var Ie=xe&32768;return xe&=-32769,xe=(Ie?re:0)+(xe>=8192?xe-16384:xe),(Ie?"":"$")+(pe?vl(xe):el(xe))}var ne={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},he=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function Me(re,xe){qc(re,0);for(var pe=[],Ie=0,Ve="",gt="",mt="",wt="";re.l<re.length;){var Pt=re[re.l++];switch(Pt){case 0:pe.push(re.read_shift(8,"f"));break;case 1:gt=J(xe[0].c,re.read_shift(2),!0),Ve=J(xe[0].r,re.read_shift(2),!1),pe.push(gt+Ve);break;case 2:{var fr=J(xe[0].c,re.read_shift(2),!0),xr=J(xe[0].r,re.read_shift(2),!1);gt=J(xe[0].c,re.read_shift(2),!0),Ve=J(xe[0].r,re.read_shift(2),!1),pe.push(fr+xr+":"+gt+Ve)}break;case 3:if(re.l<re.length){console.error("WK1 premature formula end");return}break;case 4:pe.push("("+pe.pop()+")");break;case 5:pe.push(re.read_shift(2));break;case 6:{for(var Rr="";Pt=re[re.l++];)Rr+=String.fromCharCode(Pt);pe.push('"'+Rr.replace(/"/g,'""')+'"')}break;case 8:pe.push("-"+pe.pop());break;case 23:pe.push("+"+pe.pop());break;case 22:pe.push("NOT("+pe.pop()+")");break;case 20:case 21:wt=pe.pop(),mt=pe.pop(),pe.push(["AND","OR"][Pt-20]+"("+mt+","+wt+")");break;default:if(Pt<32&&he[Pt])wt=pe.pop(),mt=pe.pop(),pe.push(mt+he[Pt]+wt);else if(ne[Pt]){if(Ie=ne[Pt][1],Ie==69&&(Ie=re[re.l++]),Ie>pe.length){console.error("WK1 bad formula parse 0x"+Pt.toString(16)+":|"+pe.join("|")+"|");return}var Fr=pe.slice(-Ie);pe.length-=Ie,pe.push(ne[Pt][0]+"("+Fr.join(",")+")")}else return Pt<=7?console.error("WK1 invalid opcode "+Pt.toString(16)):Pt<=24?console.error("WK1 unsupported op "+Pt.toString(16)):Pt<=30?console.error("WK1 invalid opcode "+Pt.toString(16)):Pt<=115?console.error("WK1 unsupported function opcode "+Pt.toString(16)):console.error("WK1 unrecognized opcode "+Pt.toString(16))}}pe.length==1?xe[1].f=""+pe[0]:console.error("WK1 bad formula parse |"+pe.join("|")+"|")}function Re(re){var xe=[{c:0,r:0},{t:"n",v:0},0];return xe[0].r=re.read_shift(2),xe[3]=re[re.l++],xe[0].c=re[re.l++],xe}function et(re,xe){var pe=Re(re,xe);return pe[1].t="s",pe[1].v=re.read_shift(xe-4,"cstr"),pe}function Te(re,xe,pe,Ie){var Ve=cr(6+Ie.length);Ve.write_shift(2,re),Ve.write_shift(1,pe),Ve.write_shift(1,xe),Ve.write_shift(1,39);for(var gt=0;gt<Ie.length;++gt){var mt=Ie.charCodeAt(gt);Ve.write_shift(1,mt>=128?95:mt)}return Ve.write_shift(1,0),Ve}function ge(re,xe){var pe=Re(re,xe);pe[1].v=re.read_shift(2);var Ie=pe[1].v>>1;if(pe[1].v&1)switch(Ie&7){case 0:Ie=(Ie>>3)*5e3;break;case 1:Ie=(Ie>>3)*500;break;case 2:Ie=(Ie>>3)/20;break;case 3:Ie=(Ie>>3)/200;break;case 4:Ie=(Ie>>3)/2e3;break;case 5:Ie=(Ie>>3)/2e4;break;case 6:Ie=(Ie>>3)/16;break;case 7:Ie=(Ie>>3)/64;break}return pe[1].v=Ie,pe}function Ue(re,xe){var pe=Re(re,xe),Ie=re.read_shift(4),Ve=re.read_shift(4),gt=re.read_shift(2);if(gt==65535)return Ie===0&&Ve===3221225472?(pe[1].t="e",pe[1].v=15):Ie===0&&Ve===3489660928?(pe[1].t="e",pe[1].v=42):pe[1].v=0,pe;var mt=gt&32768;return gt=(gt&32767)-16446,pe[1].v=(1-mt*2)*(Ve*Math.pow(2,gt+32)+Ie*Math.pow(2,gt)),pe}function Ae(re,xe,pe,Ie){var Ve=cr(14);if(Ve.write_shift(2,re),Ve.write_shift(1,pe),Ve.write_shift(1,xe),Ie==0)return Ve.write_shift(4,0),Ve.write_shift(4,0),Ve.write_shift(2,65535),Ve;var gt=0,mt=0,wt=0,Pt=0;return Ie<0&&(gt=1,Ie=-Ie),mt=Math.log2(Ie)|0,Ie/=Math.pow(2,mt-31),Pt=Ie>>>0,Pt&2147483648||(Ie/=2,++mt,Pt=Ie>>>0),Ie-=Pt,Pt|=2147483648,Pt>>>=0,Ie*=Math.pow(2,32),wt=Ie>>>0,Ve.write_shift(4,wt),Ve.write_shift(4,Pt),mt+=16383+(gt?32768:0),Ve.write_shift(2,mt),Ve}function _e(re,xe){var pe=Ue(re,14);return re.l+=xe-14,pe}function ve(re,xe){var pe=Re(re,xe),Ie=re.read_shift(4);return pe[1].v=Ie>>6,pe}function Qe(re,xe){var pe=Re(re,xe),Ie=re.read_shift(8,"f");return pe[1].v=Ie,pe}function Ce(re,xe){var pe=Qe(re,14);return re.l+=xe-10,pe}function Ye(re,xe){return re[re.l+xe-1]==0?re.read_shift(xe,"cstr"):""}function ut(re,xe){var pe=re[re.l++];pe>xe-1&&(pe=xe-1);for(var Ie="";Ie.length<pe;)Ie+=String.fromCharCode(re[re.l++]);return Ie}function st(re,xe,pe){if(!(!pe.qpro||xe<21)){var Ie=re.read_shift(1);re.l+=17,re.l+=1,re.l+=2;var Ve=re.read_shift(xe-21,"cstr");return[Ie,Ve]}}function pt(re,xe){for(var pe={},Ie=re.l+xe;re.l<Ie;){var Ve=re.read_shift(2);if(Ve==14e3){for(pe[Ve]=[0,""],pe[Ve][0]=re.read_shift(2);re[re.l];)pe[Ve][1]+=String.fromCharCode(re[re.l]),re.l++;re.l++}}return pe}function Tt(re,xe){var pe=cr(5+re.length);pe.write_shift(2,14e3),pe.write_shift(2,xe);for(var Ie=0;Ie<re.length;++Ie){var Ve=re.charCodeAt(Ie);pe[pe.l++]=Ve>127?95:Ve}return pe[pe.l++]=0,pe}var ht={0:{n:"BOF",f:bM},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:T},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:B},14:{n:"NUMBER",f:ee},15:{n:"LABEL",f:D},16:{n:"FORMULA",f:K},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:D},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ye},222:{n:"SHEETNAMELP",f:ut},65535:{n:""}},Wt={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:et},23:{n:"NUMBER17",f:Ue},24:{n:"NUMBER18",f:ge},25:{n:"FORMULA19",f:_e},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:pt},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ve},38:{n:"??"},39:{n:"NUMBER27",f:Qe},40:{n:"FORMULA28",f:Ce},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ye},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:st},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:c,book_to_wk3:u,to_workbook:i}}();var $7=/^\s|\s$|[\t\n\r]/;function CM(a,i){if(!i.bookSST)return"";var o=[ts];o[o.length]=Vr("sst",null,{xmlns:cg[0],count:a.Count,uniqueCount:a.Unique});for(var c=0;c!=a.length;++c)if(a[c]!=null){var u=a[c],r="<si>";u.r?r+=u.r:(r+="<t",u.t||(u.t=""),u.t.match($7)&&(r+=' xml:space="preserve"'),r+=">"+Ca(u.t)+"</t>"),r+="</si>",o[o.length]=r}return o.length>2&&(o[o.length]="</sst>",o[1]=o[1].replace("/>",">")),o.join("")}function X7(a){return[a.read_shift(4),a.read_shift(4)]}function Z7(a,i){return i||(i=cr(8)),i.write_shift(4,a.Count),i.write_shift(4,a.Unique),i}var Y7=jz;function K7(a){var i=dc();Ir(i,159,Z7(a));for(var o=0;o<a.length;++o)Ir(i,19,Y7(a[o]));return Ir(i,160),i.end()}function J7(a){if(typeof za<"u")return za.utils.encode(sg,a);for(var i=[],o=a.split(""),c=0;c<o.length;++c)i[c]=o[c].charCodeAt(0);return i}function IM(a){var i=0,o,c=J7(a),u=c.length+1,r,_,T,E,k;for(o=bm(u),o[0]=c.length,r=1;r!=u;++r)o[r]=c[r-1];for(r=u-1;r>=0;--r)_=o[r],T=i&16384?1:0,E=i<<1&32767,k=T|E,i=k^_;return i^52811}var Q7=function(){function a(u,r){switch(r.type){case"base64":return i(hf(u),r);case"binary":return i(u,r);case"buffer":return i(oa&&Buffer.isBuffer(u)?u.toString("binary"):f1(u),r);case"array":return i(Ax(u),r)}throw new Error("Unrecognized type "+r.type)}function i(u,r){var _=r||{},T=_.dense?[]:{},E=u.match(/\\trowd.*?\\row\b/g);if(!E.length)throw new Error("RTF missing table");var k={s:{c:0,r:0},e:{c:0,r:E.length-1}};return E.forEach(function(D,j){Array.isArray(T)&&(T[j]=[]);for(var B=/\\\w+\b/g,P=0,ee,G=-1;ee=B.exec(D);){switch(ee[0]){case"\\cell":var K=D.slice(P,B.lastIndex-ee[0].length);if(K[0]==" "&&(K=K.slice(1)),++G,K.length){var J={v:K,t:"s"};Array.isArray(T)?T[j][G]=J:T[Ia({r:j,c:G})]=J}break}P=B.lastIndex}G>k.e.c&&(k.e.c=G)}),T["!ref"]=es(k),T}function o(u,r){return Sm(a(u,r),r)}function c(u){for(var r=["{\\rtf1\\ansi"],_=ao(u["!ref"]),T,E=Array.isArray(u),k=_.s.r;k<=_.e.r;++k){r.push("\\trowd\\trautofit1");for(var D=_.s.c;D<=_.e.c;++D)r.push("\\cellx"+(D+1));for(r.push("\\pard\\intbl"),D=_.s.c;D<=_.e.c;++D){var j=Ia({r:k,c:D});T=E?(u[k]||[])[D]:u[j],!(!T||T.v==null&&(!T.f||T.F))&&(r.push(" "+(T.w||(df(T),T.w))),r.push("\\cell"))}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}return{to_workbook:o,to_sheet:a,from_sheet:c}}();function Ek(a){for(var i=0,o=1;i!=3;++i)o=o*256+(a[i]>255?255:a[i]<0?0:a[i]);return o.toString(16).toUpperCase().slice(1)}var ej=6;var uf=ej;function _x(a){return Math.floor((a+Math.round(128/uf)/256)*uf)}function vx(a){return Math.floor((a-5)/uf*100+.5)/100}function W5(a){return Math.round((a*uf+5)/uf*256)/256}function uT(a){a.width?(a.wpx=_x(a.width),a.wch=vx(a.wpx),a.MDW=uf):a.wpx?(a.wch=vx(a.wpx),a.width=W5(a.wch),a.MDW=uf):typeof a.wch=="number"&&(a.width=W5(a.wch),a.wpx=_x(a.width),a.MDW=uf),a.customWidth&&delete a.customWidth}var tj=96,kM=tj;function yx(a){return a*96/kM}function MM(a){return a*kM/96}function rj(a){var i=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(o){for(var c=o[0];c<=o[1];++c)a[c]!=null&&(i[i.length]=Vr("numFmt",null,{numFmtId:c,formatCode:Ca(a[c])}))}),i.length===1?"":(i[i.length]="</numFmts>",i[0]=Vr("numFmts",null,{count:i.length-2}).replace("/>",">"),i.join(""))}function ij(a){var i=[];return i[i.length]=Vr("cellXfs",null),a.forEach(function(o){i[i.length]=Vr("xf",null,o)}),i[i.length]="</cellXfs>",i.length===2?"":(i[0]=Vr("cellXfs",null,{count:i.length-2}).replace("/>",">"),i.join(""))}function DM(a,i){var o=[ts,Vr("styleSheet",null,{xmlns:cg[0],"xmlns:vt":Fs.vt})],c;return a.SSF&&(c=rj(a.SSF))!=null&&(o[o.length]=c),o[o.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',o[o.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',o[o.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',o[o.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(c=ij(i.cellXfs))&&(o[o.length]=c),o[o.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',o[o.length]='<dxfs count="0"/>',o[o.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',o.length>2&&(o[o.length]="</styleSheet>",o[1]=o[1].replace("/>",">")),o.join("")}function nj(a,i){var o=a.read_shift(2),c=yl(a,i-2);return[o,c]}function aj(a,i,o){o||(o=cr(6+4*i.length)),o.write_shift(2,a),Ls(i,o);var c=o.length>o.l?o.slice(0,o.l):o;return o.l==null&&(o.l=o.length),c}function oj(a,i,o){var c={};c.sz=a.read_shift(2)/20;var u=$z(a,2,o);u.fItalic&&(c.italic=1),u.fCondense&&(c.condense=1),u.fExtend&&(c.extend=1),u.fShadow&&(c.shadow=1),u.fOutline&&(c.outline=1),u.fStrikeout&&(c.strike=1);var r=a.read_shift(2);switch(r===700&&(c.bold=1),a.read_shift(2)){case 1:c.vertAlign="superscript";break;case 2:c.vertAlign="subscript";break}var _=a.read_shift(1);_!=0&&(c.underline=_);var T=a.read_shift(1);T>0&&(c.family=T);var E=a.read_shift(1);switch(E>0&&(c.charset=E),a.l++,c.color=qz(a,8),a.read_shift(1)){case 1:c.scheme="major";break;case 2:c.scheme="minor";break}return c.name=yl(a,i-21),c}function sj(a,i){i||(i=cr(25+4*32)),i.write_shift(2,a.sz*20),Xz(a,i),i.write_shift(2,a.bold?700:400);var o=0;a.vertAlign=="superscript"?o=1:a.vertAlign=="subscript"&&(o=2),i.write_shift(2,o),i.write_shift(1,a.underline||0),i.write_shift(1,a.family||0),i.write_shift(1,a.charset||0),i.write_shift(1,0),mx(a.color,i);var c=0;return a.scheme=="major"&&(c=1),a.scheme=="minor"&&(c=2),i.write_shift(1,c),Ls(a.name,i),i.length>i.l?i.slice(0,i.l):i}var lj=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],B5,cj=ud;function Ak(a,i){i||(i=cr(4*3+8*7+16*1)),B5||(B5=X5(lj));var o=B5[a.patternType];o==null&&(o=40),i.write_shift(4,o);var c=0;if(o!=40)for(mx({auto:1},i),mx({auto:1},i);c<12;++c)i.write_shift(4,0);else{for(;c<4;++c)i.write_shift(4,0);for(;c<12;++c)i.write_shift(4,0)}return i.length>i.l?i.slice(0,i.l):i}function uj(a,i){var o=a.l+i,c=a.read_shift(2),u=a.read_shift(2);return a.l=o,{ixfe:c,numFmtId:u}}function RM(a,i,o){o||(o=cr(16)),o.write_shift(2,i||0),o.write_shift(2,a.numFmtId||0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(1,0),o.write_shift(1,0);var c=0;return o.write_shift(1,c),o.write_shift(1,0),o.write_shift(1,0),o.write_shift(1,0),o}function Q_(a,i){return i||(i=cr(10)),i.write_shift(1,0),i.write_shift(1,0),i.write_shift(4,0),i.write_shift(4,0),i}var hj=ud;function dj(a,i){return i||(i=cr(51)),i.write_shift(1,0),Q_(null,i),Q_(null,i),Q_(null,i),Q_(null,i),Q_(null,i),i.length>i.l?i.slice(0,i.l):i}function fj(a,i){return i||(i=cr(12+4*10)),i.write_shift(4,a.xfId),i.write_shift(2,1),i.write_shift(1,+a.builtinId),i.write_shift(1,0),px(a.name||"",i),i.length>i.l?i.slice(0,i.l):i}function pj(a,i,o){var c=cr(2052);return c.write_shift(4,a),px(i,c),px(o,c),c.length>c.l?c.slice(0,c.l):c}function mj(a,i){if(i){var o=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(c){for(var u=c[0];u<=c[1];++u)i[u]!=null&&++o}),o!=0&&(Ir(a,615,_h(o)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(c){for(var u=c[0];u<=c[1];++u)i[u]!=null&&Ir(a,44,aj(u,i[u]))}),Ir(a,616))}}function gj(a){var i=1;i!=0&&(Ir(a,611,_h(i)),Ir(a,43,sj({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Ir(a,612))}function _j(a){var i=2;i!=0&&(Ir(a,603,_h(i)),Ir(a,45,Ak({patternType:"none"})),Ir(a,45,Ak({patternType:"gray125"})),Ir(a,604))}function vj(a){var i=1;i!=0&&(Ir(a,613,_h(i)),Ir(a,46,dj({})),Ir(a,614))}function yj(a){var i=1;Ir(a,626,_h(i)),Ir(a,47,RM({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Ir(a,627)}function xj(a,i){Ir(a,617,_h(i.length)),i.forEach(function(o){Ir(a,47,RM(o,0))}),Ir(a,618)}function bj(a){var i=1;Ir(a,619,_h(i)),Ir(a,48,fj({xfId:0,builtinId:0,name:"Normal"})),Ir(a,620)}function wj(a){var i=0;Ir(a,505,_h(i)),Ir(a,506)}function Tj(a){var i=0;Ir(a,508,pj(i,"TableStyleMedium9","PivotStyleMedium4")),Ir(a,509)}function Sj(a,i){var o=dc();return Ir(o,278),mj(o,a.SSF),gj(o,a),_j(o,a),vj(o,a),yj(o,a),xj(o,i.cellXfs),bj(o,a),wj(o,a),Tj(o,a),Ir(o,279),o.end()}function FM(a,i){if(i&&i.themeXLSX)return i.themeXLSX;if(a&&typeof a.raw=="string")return a.raw;var o=[ts];return o[o.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',o[o.length]="<a:themeElements>",o[o.length]='<a:clrScheme name="Office">',o[o.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',o[o.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',o[o.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',o[o.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',o[o.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',o[o.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',o[o.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',o[o.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',o[o.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',o[o.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',o[o.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',o[o.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',o[o.length]="</a:clrScheme>",o[o.length]='<a:fontScheme name="Office">',o[o.length]="<a:majorFont>",o[o.length]='<a:latin typeface="Cambria"/>',o[o.length]='<a:ea typeface=""/>',o[o.length]='<a:cs typeface=""/>',o[o.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',o[o.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',o[o.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',o[o.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',o[o.length]='<a:font script="Arab" typeface="Times New Roman"/>',o[o.length]='<a:font script="Hebr" typeface="Times New Roman"/>',o[o.length]='<a:font script="Thai" typeface="Tahoma"/>',o[o.length]='<a:font script="Ethi" typeface="Nyala"/>',o[o.length]='<a:font script="Beng" typeface="Vrinda"/>',o[o.length]='<a:font script="Gujr" typeface="Shruti"/>',o[o.length]='<a:font script="Khmr" typeface="MoolBoran"/>',o[o.length]='<a:font script="Knda" typeface="Tunga"/>',o[o.length]='<a:font script="Guru" typeface="Raavi"/>',o[o.length]='<a:font script="Cans" typeface="Euphemia"/>',o[o.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',o[o.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',o[o.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',o[o.length]='<a:font script="Thaa" typeface="MV Boli"/>',o[o.length]='<a:font script="Deva" typeface="Mangal"/>',o[o.length]='<a:font script="Telu" typeface="Gautami"/>',o[o.length]='<a:font script="Taml" typeface="Latha"/>',o[o.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',o[o.length]='<a:font script="Orya" typeface="Kalinga"/>',o[o.length]='<a:font script="Mlym" typeface="Kartika"/>',o[o.length]='<a:font script="Laoo" typeface="DokChampa"/>',o[o.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',o[o.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',o[o.length]='<a:font script="Viet" typeface="Times New Roman"/>',o[o.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',o[o.length]='<a:font script="Geor" typeface="Sylfaen"/>',o[o.length]="</a:majorFont>",o[o.length]="<a:minorFont>",o[o.length]='<a:latin typeface="Calibri"/>',o[o.length]='<a:ea typeface=""/>',o[o.length]='<a:cs typeface=""/>',o[o.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',o[o.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',o[o.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',o[o.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',o[o.length]='<a:font script="Arab" typeface="Arial"/>',o[o.length]='<a:font script="Hebr" typeface="Arial"/>',o[o.length]='<a:font script="Thai" typeface="Tahoma"/>',o[o.length]='<a:font script="Ethi" typeface="Nyala"/>',o[o.length]='<a:font script="Beng" typeface="Vrinda"/>',o[o.length]='<a:font script="Gujr" typeface="Shruti"/>',o[o.length]='<a:font script="Khmr" typeface="DaunPenh"/>',o[o.length]='<a:font script="Knda" typeface="Tunga"/>',o[o.length]='<a:font script="Guru" typeface="Raavi"/>',o[o.length]='<a:font script="Cans" typeface="Euphemia"/>',o[o.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',o[o.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',o[o.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',o[o.length]='<a:font script="Thaa" typeface="MV Boli"/>',o[o.length]='<a:font script="Deva" typeface="Mangal"/>',o[o.length]='<a:font script="Telu" typeface="Gautami"/>',o[o.length]='<a:font script="Taml" typeface="Latha"/>',o[o.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',o[o.length]='<a:font script="Orya" typeface="Kalinga"/>',o[o.length]='<a:font script="Mlym" typeface="Kartika"/>',o[o.length]='<a:font script="Laoo" typeface="DokChampa"/>',o[o.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',o[o.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',o[o.length]='<a:font script="Viet" typeface="Arial"/>',o[o.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',o[o.length]='<a:font script="Geor" typeface="Sylfaen"/>',o[o.length]="</a:minorFont>",o[o.length]="</a:fontScheme>",o[o.length]='<a:fmtScheme name="Office">',o[o.length]="<a:fillStyleLst>",o[o.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',o[o.length]='<a:gradFill rotWithShape="1">',o[o.length]="<a:gsLst>",o[o.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',o[o.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',o[o.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',o[o.length]="</a:gsLst>",o[o.length]='<a:lin ang="16200000" scaled="1"/>',o[o.length]="</a:gradFill>",o[o.length]='<a:gradFill rotWithShape="1">',o[o.length]="<a:gsLst>",o[o.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',o[o.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',o[o.length]="</a:gsLst>",o[o.length]='<a:lin ang="16200000" scaled="0"/>',o[o.length]="</a:gradFill>",o[o.length]="</a:fillStyleLst>",o[o.length]="<a:lnStyleLst>",o[o.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',o[o.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',o[o.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',o[o.length]="</a:lnStyleLst>",o[o.length]="<a:effectStyleLst>",o[o.length]="<a:effectStyle>",o[o.length]="<a:effectLst>",o[o.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',o[o.length]="</a:effectLst>",o[o.length]="</a:effectStyle>",o[o.length]="<a:effectStyle>",o[o.length]="<a:effectLst>",o[o.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',o[o.length]="</a:effectLst>",o[o.length]="</a:effectStyle>",o[o.length]="<a:effectStyle>",o[o.length]="<a:effectLst>",o[o.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',o[o.length]="</a:effectLst>",o[o.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',o[o.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',o[o.length]="</a:effectStyle>",o[o.length]="</a:effectStyleLst>",o[o.length]="<a:bgFillStyleLst>",o[o.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',o[o.length]='<a:gradFill rotWithShape="1">',o[o.length]="<a:gsLst>",o[o.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',o[o.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',o[o.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',o[o.length]="</a:gsLst>",o[o.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',o[o.length]="</a:gradFill>",o[o.length]='<a:gradFill rotWithShape="1">',o[o.length]="<a:gsLst>",o[o.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',o[o.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',o[o.length]="</a:gsLst>",o[o.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',o[o.length]="</a:gradFill>",o[o.length]="</a:bgFillStyleLst>",o[o.length]="</a:fmtScheme>",o[o.length]="</a:themeElements>",o[o.length]="<a:objectDefaults>",o[o.length]="<a:spDef>",o[o.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',o[o.length]="</a:spDef>",o[o.length]="<a:lnDef>",o[o.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',o[o.length]="</a:lnDef>",o[o.length]="</a:objectDefaults>",o[o.length]="<a:extraClrSchemeLst/>",o[o.length]="</a:theme>",o.join("")}function Ej(a,i){return{flags:a.read_shift(4),version:a.read_shift(4),name:yl(a,i-8)}}function Aj(a){var i=cr(12+2*a.name.length);return i.write_shift(4,a.flags),i.write_shift(4,a.version),Ls(a.name,i),i.slice(0,i.l)}function Cj(a){for(var i=[],o=a.read_shift(4);o-- >0;)i.push([a.read_shift(4),a.read_shift(4)]);return i}function Ij(a){var i=cr(4+8*a.length);i.write_shift(4,a.length);for(var o=0;o<a.length;++o)i.write_shift(4,a[o][0]),i.write_shift(4,a[o][1]);return i}function kj(a,i){var o=cr(8+2*i.length);return o.write_shift(4,a),Ls(i,o),o.slice(0,o.l)}function Mj(a){return a.l+=4,a.read_shift(4)!=0}function Dj(a,i){var o=cr(8);return o.write_shift(4,a),o.write_shift(4,i?1:0),o}function Rj(){var a=dc();return Ir(a,332),Ir(a,334,_h(1)),Ir(a,335,Aj({name:"XLDAPR",version:12e4,flags:3496657072})),Ir(a,336),Ir(a,339,kj(1,"XLDAPR")),Ir(a,52),Ir(a,35,_h(514)),Ir(a,4096,_h(0)),Ir(a,4097,Eu(1)),Ir(a,36),Ir(a,53),Ir(a,340),Ir(a,337,Dj(1,!0)),Ir(a,51,Ij([[1,0]])),Ir(a,338),Ir(a,333),a.end()}function PM(){var a=[ts];return a.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),a.join("")}function Fj(a){var i={};i.i=a.read_shift(4);var o={};o.r=a.read_shift(4),o.c=a.read_shift(4),i.r=Ia(o);var c=a.read_shift(1);return c&2&&(i.l="1"),c&8&&(i.a="1"),i}var tg=1024;function LM(a,i){for(var o=[21600,21600],c=["m0,0l0",o[1],o[0],o[1],o[0],"0xe"].join(","),u=[Vr("xml",null,{"xmlns:v":$c.v,"xmlns:o":$c.o,"xmlns:x":$c.x,"xmlns:mv":$c.mv}).replace(/\/>/,">"),Vr("o:shapelayout",Vr("o:idmap",null,{"v:ext":"edit",data:a}),{"v:ext":"edit"}),Vr("v:shapetype",[Vr("v:stroke",null,{joinstyle:"miter"}),Vr("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:o.join(","),path:c})];tg<a*1e3;)tg+=1e3;return i.forEach(function(r){var _=Ps(r[0]),T={color2:"#BEFF82",type:"gradient"};T.type=="gradient"&&(T.angle="-180");var E=T.type=="gradient"?Vr("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,k=Vr("v:fill",E,T),D={on:"t",obscured:"t"};++tg,u=u.concat(["<v:shape"+u1({id:"_x0000_s"+tg,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(r[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",k,Vr("v:shadow",null,D),Vr("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Qs("x:Anchor",[_.c+1,0,_.r+1,0,_.c+3,20,_.r+5,20].join(",")),Qs("x:AutoFill","False"),Qs("x:Row",String(_.r)),Qs("x:Column",String(_.c)),r[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),u.push("</xml>"),u.join("")}function OM(a){var i=[ts,Vr("comments",null,{xmlns:cg[0]})],o=[];return i.push("<authors>"),a.forEach(function(c){c[1].forEach(function(u){var r=Ca(u.a);o.indexOf(r)==-1&&(o.push(r),i.push("<author>"+r+"</author>")),u.T&&u.ID&&o.indexOf("tc="+u.ID)==-1&&(o.push("tc="+u.ID),i.push("<author>tc="+u.ID+"</author>"))})}),o.length==0&&(o.push("SheetJ5"),i.push("<author>SheetJ5</author>")),i.push("</authors>"),i.push("<commentList>"),a.forEach(function(c){var u=0,r=[];if(c[1][0]&&c[1][0].T&&c[1][0].ID?u=o.indexOf("tc="+c[1][0].ID):c[1].forEach(function(E){E.a&&(u=o.indexOf(Ca(E.a))),r.push(E.t||"")}),i.push('<comment ref="'+c[0]+'" authorId="'+u+'"><text>'),r.length<=1)i.push(Qs("t",Ca(r[0]||"")));else{for(var _=`Comment:
    `+r[0]+`
`,T=1;T<r.length;++T)_+=`Reply:
    `+r[T]+`
`;i.push(Qs("t",Ca(_)))}i.push("</text></comment>")}),i.push("</commentList>"),i.length>2&&(i[i.length]="</comments>",i[1]=i[1].replace("/>",">")),i.join("")}function Pj(a,i,o){var c=[ts,Vr("ThreadedComments",null,{xmlns:Fs.TCMNT}).replace(/[\/]>/,">")];return a.forEach(function(u){var r="";(u[1]||[]).forEach(function(_,T){if(!_.T){delete _.ID;return}_.a&&i.indexOf(_.a)==-1&&i.push(_.a);var E={ref:u[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+o.tcid++).slice(-12)+"}"};T==0?r=E.id:E.parentId=r,_.ID=E.id,_.a&&(E.personId="{54EE7950-7262-4200-6969-"+("000000000000"+i.indexOf(_.a)).slice(-12)+"}"),c.push(Vr("threadedComment",Qs("text",_.t||""),E))})}),c.push("</ThreadedComments>"),c.join("")}function Lj(a){var i=[ts,Vr("personList",null,{xmlns:Fs.TCMNT,"xmlns:x":cg[0]}).replace(/[\/]>/,">")];return a.forEach(function(o,c){i.push(Vr("person",null,{displayName:o,id:"{54EE7950-7262-4200-6969-"+("000000000000"+c).slice(-12)+"}",userId:o,providerId:"None"}))}),i.push("</personList>"),i.join("")}function Oj(a){var i={};i.iauthor=a.read_shift(4);var o=Im(a,16);return i.rfx=o.s,i.ref=Ia(o.s),a.l+=16,i}function Nj(a,i){return i==null&&(i=cr(36)),i.write_shift(4,a[1].iauthor),dg(a[0],i),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i}var Bj=yl;function zj(a){return Ls(a.slice(0,54))}function jj(a){var i=dc(),o=[];return Ir(i,628),Ir(i,630),a.forEach(function(c){c[1].forEach(function(u){o.indexOf(u.a)>-1||(o.push(u.a.slice(0,54)),Ir(i,632,zj(u.a)))})}),Ir(i,631),Ir(i,633),a.forEach(function(c){c[1].forEach(function(u){u.iauthor=o.indexOf(u.a);var r={s:Ps(c[0]),e:Ps(c[0])};Ir(i,635,Nj([r,u])),u.t&&u.t.length>0&&Ir(i,637,Vz(u)),Ir(i,636),delete u.iauthor})}),Ir(i,634),Ir(i,629),i.end()}function Uj(a,i){i.FullPaths.forEach(function(o,c){if(c!=0){var u=o.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");u.slice(-1)!=="/"&&La.utils.cfb_add(a,u,i.FileIndex[c].content)}})}var NM=["xlsb","xlsm","xlam","biff8","xla"];var Vj=function(){var a=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,i={r:0,c:0};function o(c,u,r,_){var T=!1,E=!1;r.length==0?E=!0:r.charAt(0)=="["&&(E=!0,r=r.slice(1,-1)),_.length==0?T=!0:_.charAt(0)=="["&&(T=!0,_=_.slice(1,-1));var k=r.length>0?parseInt(r,10)|0:0,D=_.length>0?parseInt(_,10)|0:0;return T?D+=i.c:--D,E?k+=i.r:--k,u+(T?"":"$")+vl(D)+(E?"":"$")+el(k)}return function(u,r){return i=r,u.replace(a,o)}}(),hT=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,dT=function(){return function(i,o){return i.replace(hT,function(c,u,r,_,T,E){var k=aT(_)-(r?0:o.c),D=nT(E)-(T?0:o.r),j=D==0?"":T?D+1:"["+D+"]",B=k==0?"":r?k+1:"["+k+"]";return u+"R"+j+"C"+B})}}();function Gj(a,i){return a.replace(hT,function(o,c,u,r,_,T){return c+(u=="$"?u+r:vl(aT(r)+i.c))+(_=="$"?_+T:el(nT(T)+i.r))})}function Hj(a){return a.length!=1}function Qo(a){a.l+=1}function vp(a,i){var o=a.read_shift(i==1?1:2);return[o&16383,o>>14&1,o>>15&1]}function BM(a,i,o){var c=2;if(o){if(o.biff>=2&&o.biff<=5)return zM(a,i,o);o.biff==12&&(c=4)}var u=a.read_shift(c),r=a.read_shift(c),_=vp(a,2),T=vp(a,2);return{s:{r:u,c:_[0],cRel:_[1],rRel:_[2]},e:{r,c:T[0],cRel:T[1],rRel:T[2]}}}function zM(a){var i=vp(a,2),o=vp(a,2),c=a.read_shift(1),u=a.read_shift(1);return{s:{r:i[0],c,cRel:i[1],rRel:i[2]},e:{r:o[0],c:u,cRel:o[1],rRel:o[2]}}}function Wj(a,i,o){if(o.biff<8)return zM(a,i,o);var c=a.read_shift(o.biff==12?4:2),u=a.read_shift(o.biff==12?4:2),r=vp(a,2),_=vp(a,2);return{s:{r:c,c:r[0],cRel:r[1],rRel:r[2]},e:{r:u,c:_[0],cRel:_[1],rRel:_[2]}}}function jM(a,i,o){if(o&&o.biff>=2&&o.biff<=5)return qj(a,i,o);var c=a.read_shift(o&&o.biff==12?4:2),u=vp(a,2);return{r:c,c:u[0],cRel:u[1],rRel:u[2]}}function qj(a){var i=vp(a,2),o=a.read_shift(1);return{r:i[0],c:o,cRel:i[1],rRel:i[2]}}function $j(a){var i=a.read_shift(2),o=a.read_shift(2);return{r:i,c:o&255,fQuoted:!!(o&16384),cRel:o>>15,rRel:o>>15}}function Xj(a,i,o){var c=o&&o.biff?o.biff:8;if(c>=2&&c<=5)return Zj(a,i,o);var u=a.read_shift(c>=12?4:2),r=a.read_shift(2),_=(r&16384)>>14,T=(r&32768)>>15;if(r&=16383,T==1)for(;u>524287;)u-=1048576;if(_==1)for(;r>8191;)r=r-16384;return{r:u,c:r,cRel:_,rRel:T}}function Zj(a){var i=a.read_shift(2),o=a.read_shift(1),c=(i&32768)>>15,u=(i&16384)>>14;return i&=16383,c==1&&i>=8192&&(i=i-16384),u==1&&o>=128&&(o=o-256),{r:i,c:o,cRel:u,rRel:c}}function Yj(a,i,o){var c=(a[a.l++]&96)>>5,u=BM(a,o.biff>=2&&o.biff<=5?6:8,o);return[c,u]}function Kj(a,i,o){var c=(a[a.l++]&96)>>5,u=a.read_shift(2,"i"),r=8;if(o)switch(o.biff){case 5:a.l+=12,r=6;break;case 12:r=12;break}var _=BM(a,r,o);return[c,u,_]}function Jj(a,i,o){var c=(a[a.l++]&96)>>5;return a.l+=o&&o.biff>8?12:o.biff<8?6:8,[c]}function Qj(a,i,o){var c=(a[a.l++]&96)>>5,u=a.read_shift(2),r=8;if(o)switch(o.biff){case 5:a.l+=12,r=6;break;case 12:r=12;break}return a.l+=r,[c,u]}function eU(a,i,o){var c=(a[a.l++]&96)>>5,u=Wj(a,i-1,o);return[c,u]}function tU(a,i,o){var c=(a[a.l++]&96)>>5;return a.l+=o.biff==2?6:o.biff==12?14:7,[c]}function Ck(a){var i=a[a.l+1]&1,o=1;return a.l+=4,[i,o]}function rU(a,i,o){a.l+=2;for(var c=a.read_shift(o&&o.biff==2?1:2),u=[],r=0;r<=c;++r)u.push(a.read_shift(o&&o.biff==2?1:2));return u}function iU(a,i,o){var c=a[a.l+1]&255?1:0;return a.l+=2,[c,a.read_shift(o&&o.biff==2?1:2)]}function nU(a,i,o){var c=a[a.l+1]&255?1:0;return a.l+=2,[c,a.read_shift(o&&o.biff==2?1:2)]}function aU(a){var i=a[a.l+1]&255?1:0;return a.l+=2,[i,a.read_shift(2)]}function oU(a,i,o){var c=a[a.l+1]&255?1:0;return a.l+=o&&o.biff==2?3:4,[c]}function UM(a){var i=a.read_shift(1),o=a.read_shift(1);return[i,o]}function sU(a){return a.read_shift(2),UM(a,2)}function lU(a){return a.read_shift(2),UM(a,2)}function cU(a,i,o){var c=(a[a.l]&96)>>5;a.l+=1;var u=jM(a,0,o);return[c,u]}function uU(a,i,o){var c=(a[a.l]&96)>>5;a.l+=1;var u=Xj(a,0,o);return[c,u]}function hU(a,i,o){var c=(a[a.l]&96)>>5;a.l+=1;var u=a.read_shift(2);o&&o.biff==5&&(a.l+=12);var r=jM(a,0,o);return[c,u,r]}function dU(a,i,o){var c=(a[a.l]&96)>>5;a.l+=1;var u=a.read_shift(o&&o.biff<=3?1:2);return[dV[u],HM[u],c]}function fU(a,i,o){var c=a[a.l++],u=a.read_shift(1),r=o&&o.biff<=3?[c==88?-1:0,a.read_shift(1)]:pU(a);return[u,(r[0]===0?HM:hV)[r[1]]]}function pU(a){return[a[a.l+1]>>7,a.read_shift(2)&32767]}function mU(a,i,o){a.l+=o&&o.biff==2?3:4}function gU(a,i,o){if(a.l++,o&&o.biff==12)return[a.read_shift(4,"i"),0];var c=a.read_shift(2),u=a.read_shift(o&&o.biff==2?1:2);return[c,u]}function _U(a){return a.l++,m1[a.read_shift(1)]}function vU(a){return a.l++,a.read_shift(2)}function yU(a){return a.l++,a.read_shift(1)!==0}function xU(a){return a.l++,fg(a,8)}function bU(a,i,o){return a.l++,TM(a,i-1,o)}function wU(a,i){var o=[a.read_shift(1)];if(i==12)switch(o[0]){case 2:o[0]=4;break;case 4:o[0]=16;break;case 0:o[0]=1;break;case 1:o[0]=2;break}switch(o[0]){case 4:o[1]=h7(a,1)?"TRUE":"FALSE",i!=12&&(a.l+=7);break;case 37:case 16:o[1]=m1[a[a.l]],a.l+=i==12?4:8;break;case 0:a.l+=8;break;case 1:o[1]=fg(a,8);break;case 2:o[1]=m7(a,0,{biff:i>0&&i<8?2:i});break;default:throw new Error("Bad SerAr: "+o[0])}return o}function TU(a,i,o){for(var c=a.read_shift(o.biff==12?4:2),u=[],r=0;r!=c;++r)u.push((o.biff==12?Im:v7)(a,8));return u}function SU(a,i,o){var c=0,u=0;o.biff==12?(c=a.read_shift(4),u=a.read_shift(4)):(u=1+a.read_shift(1),c=1+a.read_shift(2)),o.biff>=2&&o.biff<8&&(--c,--u==0&&(u=256));for(var r=0,_=[];r!=c&&(_[r]=[]);++r)for(var T=0;T!=u;++T)_[r][T]=wU(a,o.biff);return _}function EU(a,i,o){var c=a.read_shift(1)>>>5&3,u=!o||o.biff>=8?4:2,r=a.read_shift(u);switch(o.biff){case 2:a.l+=5;break;case 3:case 4:a.l+=8;break;case 5:a.l+=12;break}return[c,0,r]}function AU(a,i,o){if(o.biff==5)return CU(a,i,o);var c=a.read_shift(1)>>>5&3,u=a.read_shift(2),r=a.read_shift(4);return[c,u,r]}function CU(a){var i=a.read_shift(1)>>>5&3,o=a.read_shift(2,"i");a.l+=8;var c=a.read_shift(2);return a.l+=12,[i,o,c]}function IU(a,i,o){var c=a.read_shift(1)>>>5&3;a.l+=o&&o.biff==2?3:4;var u=a.read_shift(o&&o.biff==2?1:2);return[c,u]}function kU(a,i,o){var c=a.read_shift(1)>>>5&3,u=a.read_shift(o&&o.biff==2?1:2);return[c,u]}function MU(a,i,o){var c=a.read_shift(1)>>>5&3;return a.l+=4,o.biff<8&&a.l--,o.biff==12&&(a.l+=2),[c]}function DU(a,i,o){var c=(a[a.l++]&96)>>5,u=a.read_shift(2),r=4;if(o)switch(o.biff){case 5:r=15;break;case 12:r=6;break}return a.l+=r,[c,u]}var RU=ud,FU=ud,PU=ud;function g1(a,i,o){return a.l+=2,[$j(a,4,o)]}function fT(a){return a.l+=6,[]}var LU=g1,OU=fT,NU=fT,BU=g1;function VM(a){return a.l+=2,[bM(a),a.read_shift(2)&1]}var zU=g1,jU=VM,UU=fT,VU=g1,GU=g1,HU=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function WU(a){a.l+=2;var i=a.read_shift(2),o=a.read_shift(2),c=a.read_shift(4),u=a.read_shift(2),r=a.read_shift(2),_=HU[o>>2&31];return{ixti:i,coltype:o&3,rt:_,idx:c,c:u,C:r}}function qU(a){return a.l+=2,[a.read_shift(4)]}function $U(a,i,o){return a.l+=5,a.l+=2,a.l+=o.biff==2?1:4,["PTGSHEET"]}function XU(a,i,o){return a.l+=o.biff==2?4:5,["PTGENDSHEET"]}function ZU(a){var i=a.read_shift(1)>>>5&3,o=a.read_shift(2);return[i,o]}function YU(a){var i=a.read_shift(1)>>>5&3,o=a.read_shift(2);return[i,o]}function KU(a){return a.l+=4,[0,0]}var Ik={1:{n:"PtgExp",f:gU},2:{n:"PtgTbl",f:PU},3:{n:"PtgAdd",f:Qo},4:{n:"PtgSub",f:Qo},5:{n:"PtgMul",f:Qo},6:{n:"PtgDiv",f:Qo},7:{n:"PtgPower",f:Qo},8:{n:"PtgConcat",f:Qo},9:{n:"PtgLt",f:Qo},10:{n:"PtgLe",f:Qo},11:{n:"PtgEq",f:Qo},12:{n:"PtgGe",f:Qo},13:{n:"PtgGt",f:Qo},14:{n:"PtgNe",f:Qo},15:{n:"PtgIsect",f:Qo},16:{n:"PtgUnion",f:Qo},17:{n:"PtgRange",f:Qo},18:{n:"PtgUplus",f:Qo},19:{n:"PtgUminus",f:Qo},20:{n:"PtgPercent",f:Qo},21:{n:"PtgParen",f:Qo},22:{n:"PtgMissArg",f:Qo},23:{n:"PtgStr",f:bU},26:{n:"PtgSheet",f:$U},27:{n:"PtgEndSheet",f:XU},28:{n:"PtgErr",f:_U},29:{n:"PtgBool",f:yU},30:{n:"PtgInt",f:vU},31:{n:"PtgNum",f:xU},32:{n:"PtgArray",f:tU},33:{n:"PtgFunc",f:dU},34:{n:"PtgFuncVar",f:fU},35:{n:"PtgName",f:EU},36:{n:"PtgRef",f:cU},37:{n:"PtgArea",f:Yj},38:{n:"PtgMemArea",f:IU},39:{n:"PtgMemErr",f:RU},40:{n:"PtgMemNoMem",f:FU},41:{n:"PtgMemFunc",f:kU},42:{n:"PtgRefErr",f:MU},43:{n:"PtgAreaErr",f:Jj},44:{n:"PtgRefN",f:uU},45:{n:"PtgAreaN",f:eU},46:{n:"PtgMemAreaN",f:ZU},47:{n:"PtgMemNoMemN",f:YU},57:{n:"PtgNameX",f:AU},58:{n:"PtgRef3d",f:hU},59:{n:"PtgArea3d",f:Kj},60:{n:"PtgRefErr3d",f:DU},61:{n:"PtgAreaErr3d",f:Qj},255:{}},JU={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},QU={1:{n:"PtgElfLel",f:VM},2:{n:"PtgElfRw",f:VU},3:{n:"PtgElfCol",f:LU},6:{n:"PtgElfRwV",f:GU},7:{n:"PtgElfColV",f:BU},10:{n:"PtgElfRadical",f:zU},11:{n:"PtgElfRadicalS",f:UU},13:{n:"PtgElfColS",f:OU},15:{n:"PtgElfColSV",f:NU},16:{n:"PtgElfRadicalLel",f:jU},25:{n:"PtgList",f:WU},29:{n:"PtgSxName",f:qU},255:{}},eV={0:{n:"PtgAttrNoop",f:KU},1:{n:"PtgAttrSemi",f:oU},2:{n:"PtgAttrIf",f:nU},4:{n:"PtgAttrChoose",f:rU},8:{n:"PtgAttrGoto",f:iU},16:{n:"PtgAttrSum",f:mU},32:{n:"PtgAttrBaxcel",f:Ck},33:{n:"PtgAttrBaxcel",f:Ck},64:{n:"PtgAttrSpace",f:sU},65:{n:"PtgAttrSpaceSemi",f:lU},128:{n:"PtgAttrIfError",f:aU},255:{}};function tV(a,i,o,c){if(c.biff<8)return ud(a,i);for(var u=a.l+i,r=[],_=0;_!==o.length;++_)switch(o[_][0]){case"PtgArray":o[_][1]=SU(a,0,c),r.push(o[_][1]);break;case"PtgMemArea":o[_][2]=TU(a,o[_][1],c),r.push(o[_][2]);break;case"PtgExp":c&&c.biff==12&&(o[_][1][1]=a.read_shift(4),r.push(o[_][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+o[_][0];default:break}return i=u-a.l,i!==0&&r.push(ud(a,i)),r}function rV(a,i,o){for(var c=a.l+i,u,r,_=[];c!=a.l;)i=c-a.l,r=a[a.l],u=Ik[r]||Ik[JU[r]],(r===24||r===25)&&(u=(r===24?QU:eV)[a[a.l+1]]),!u||!u.f?ud(a,i):_.push([u.n,u.f(a,i,o)]);return _}function iV(a){for(var i=[],o=0;o<a.length;++o){for(var c=a[o],u=[],r=0;r<c.length;++r){var _=c[r];if(_)switch(_[0]){case 2:u.push('"'+_[1].replace(/"/g,'""')+'"');break;default:u.push(_[1])}else u.push("")}i.push(u.join(","))}return i.join(";")}var nV={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function aV(a,i){if(!a&&!(i&&i.biff<=5&&i.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(a)?"'"+a+"'":a}function GM(a,i,o){if(!a)return"SH33TJSERR0";if(o.biff>8&&(!a.XTI||!a.XTI[i]))return a.SheetNames[i];if(!a.XTI)return"SH33TJSERR6";var c=a.XTI[i];if(o.biff<8)return i>1e4&&(i-=65536),i<0&&(i=-i),i==0?"":a.XTI[i-1];if(!c)return"SH33TJSERR1";var u="";if(o.biff>8)switch(a[c[0]][0]){case 357:return u=c[1]==-1?"#REF":a.SheetNames[c[1]],c[1]==c[2]?u:u+":"+a.SheetNames[c[2]];case 358:return o.SID!=null?a.SheetNames[o.SID]:"SH33TJSSAME"+a[c[0]][0];case 355:default:return"SH33TJSSRC"+a[c[0]][0]}switch(a[c[0]][0][0]){case 1025:return u=c[1]==-1?"#REF":a.SheetNames[c[1]]||"SH33TJSERR3",c[1]==c[2]?u:u+":"+a.SheetNames[c[2]];case 14849:return a[c[0]].slice(1).map(function(r){return r.Name}).join(";;");default:return a[c[0]][0][3]?(u=c[1]==-1?"#REF":a[c[0]][0][3][c[1]]||"SH33TJSERR4",c[1]==c[2]?u:u+":"+a[c[0]][0][3][c[2]]):"SH33TJSERR2"}}function kk(a,i,o){var c=GM(a,i,o);return c=="#REF"?c:aV(c,o)}function lg(a,i,o,c,u){var r=u&&u.biff||8,_={s:{c:0,r:0},e:{c:0,r:0}},T=[],E,k,D,j=0,B=0,P,ee="";if(!a[0]||!a[0][0])return"";for(var G=-1,K="",J=0,ne=a[0].length;J<ne;++J){var he=a[0][J];switch(he[0]){case"PtgUminus":T.push("-"+T.pop());break;case"PtgUplus":T.push("+"+T.pop());break;case"PtgPercent":T.push(T.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(E=T.pop(),k=T.pop(),G>=0){switch(a[0][G][1][0]){case 0:K=Do(" ",a[0][G][1][1]);break;case 1:K=Do("\r",a[0][G][1][1]);break;default:if(K="",u.WTF)throw new Error("Unexpected PtgAttrSpaceType "+a[0][G][1][0])}k=k+K,G=-1}T.push(k+nV[he[0]]+E);break;case"PtgIsect":E=T.pop(),k=T.pop(),T.push(k+" "+E);break;case"PtgUnion":E=T.pop(),k=T.pop(),T.push(k+","+E);break;case"PtgRange":E=T.pop(),k=T.pop(),T.push(k+":"+E);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":D=i1(he[1][1],_,u),T.push(n1(D,r));break;case"PtgRefN":D=o?i1(he[1][1],o,u):he[1][1],T.push(n1(D,r));break;case"PtgRef3d":j=he[1][1],D=i1(he[1][2],_,u),ee=kk(c,j,u);var Me=ee;T.push(ee+"!"+n1(D,r));break;case"PtgFunc":case"PtgFuncVar":var Re=he[1][0],et=he[1][1];Re||(Re=0),Re&=127;var Te=Re==0?[]:T.slice(-Re);T.length-=Re,et==="User"&&(et=Te.shift()),T.push(et+"("+Te.join(",")+")");break;case"PtgBool":T.push(he[1]?"TRUE":"FALSE");break;case"PtgInt":T.push(he[1]);break;case"PtgNum":T.push(String(he[1]));break;case"PtgStr":T.push('"'+he[1].replace(/"/g,'""')+'"');break;case"PtgErr":T.push(he[1]);break;case"PtgAreaN":P=fk(he[1][1],o?{s:o}:_,u),T.push(O5(P,u));break;case"PtgArea":P=fk(he[1][1],_,u),T.push(O5(P,u));break;case"PtgArea3d":j=he[1][1],P=he[1][2],ee=kk(c,j,u),T.push(ee+"!"+O5(P,u));break;case"PtgAttrSum":T.push("SUM("+T.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":B=he[1][2];var ge=(c.names||[])[B-1]||(c[0]||[])[B],Ue=ge?ge.Name:"SH33TJSNAME"+String(B);Ue&&Ue.slice(0,6)=="_xlfn."&&!u.xlfn&&(Ue=Ue.slice(6)),T.push(Ue);break;case"PtgNameX":var Ae=he[1][1];B=he[1][2];var _e;if(u.biff<=5)Ae<0&&(Ae=-Ae),c[Ae]&&(_e=c[Ae][B]);else{var ve="";if(((c[Ae]||[])[0]||[])[0]==14849||(((c[Ae]||[])[0]||[])[0]==1025?c[Ae][B]&&c[Ae][B].itab>0&&(ve=c.SheetNames[c[Ae][B].itab-1]+"!"):ve=c.SheetNames[B-1]+"!"),c[Ae]&&c[Ae][B])ve+=c[Ae][B].Name;else if(c[0]&&c[0][B])ve+=c[0][B].Name;else{var Qe=(GM(c,Ae,u)||"").split(";;");Qe[B-1]?ve=Qe[B-1]:ve+="SH33TJSERRX"}T.push(ve);break}_e||(_e={Name:"SH33TJSERRY"}),T.push(_e.Name);break;case"PtgParen":var Ce="(",Ye=")";if(G>=0){switch(K="",a[0][G][1][0]){case 2:Ce=Do(" ",a[0][G][1][1])+Ce;break;case 3:Ce=Do("\r",a[0][G][1][1])+Ce;break;case 4:Ye=Do(" ",a[0][G][1][1])+Ye;break;case 5:Ye=Do("\r",a[0][G][1][1])+Ye;break;default:if(u.WTF)throw new Error("Unexpected PtgAttrSpaceType "+a[0][G][1][0])}G=-1}T.push(Ce+T.pop()+Ye);break;case"PtgRefErr":T.push("#REF!");break;case"PtgRefErr3d":T.push("#REF!");break;case"PtgExp":D={c:he[1][1],r:he[1][0]};var ut={c:o.c,r:o.r};if(c.sharedf[Ia(D)]){var st=c.sharedf[Ia(D)];T.push(lg(st,_,ut,c,u))}else{var pt=!1;for(E=0;E!=c.arrayf.length;++E)if(k=c.arrayf[E],!(D.c<k[0].s.c||D.c>k[0].e.c)&&!(D.r<k[0].s.r||D.r>k[0].e.r)){T.push(lg(k[1],_,ut,c,u)),pt=!0;break}pt||T.push(he[1])}break;case"PtgArray":T.push("{"+iV(he[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":G=J;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":T.push("");break;case"PtgAreaErr":T.push("#REF!");break;case"PtgAreaErr3d":T.push("#REF!");break;case"PtgList":T.push("Table"+he[1].idx+"[#"+he[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(he));default:throw new Error("Unrecognized Formula Token: "+String(he))}var Tt=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(u.biff!=3&&G>=0&&Tt.indexOf(a[0][J][0])==-1){he=a[0][G];var ht=!0;switch(he[1][0]){case 4:ht=!1;case 0:K=Do(" ",he[1][1]);break;case 5:ht=!1;case 1:K=Do("\r",he[1][1]);break;default:if(K="",u.WTF)throw new Error("Unexpected PtgAttrSpaceType "+he[1][0])}T.push((ht?K:"")+T.pop()+(ht?"":K)),G=-1}}if(T.length>1&&u.WTF)throw new Error("bad formula stack");return T[0]}function oV(a){if(a==null){var i=cr(8);return i.write_shift(1,3),i.write_shift(1,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,65535),i}else if(typeof a=="number")return wm(a);return wm(0)}function sV(a,i,o,c,u){var r=Tm(i,o,u),_=oV(a.v),T=cr(6),E=33;T.write_shift(2,E),T.write_shift(4,0);for(var k=cr(a.bf.length),D=0;D<a.bf.length;++D)k[D]=a.bf[D];var j=Js([r,_,T,k]);return j}function Ix(a,i,o){var c=a.read_shift(4),u=rV(a,c,o),r=a.read_shift(4),_=r>0?tV(a,r,u,o):null;return[u,_]}var lV=Ix,kx=Ix,cV=Ix,uV=Ix,hV={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},HM={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},dV={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function fV(a){var i="of:="+a.replace(hT,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return i.replace(/;/g,"|").replace(/,/g,";")}function pV(a){return a.replace(/\./,"!")}var a1=typeof Map<"u";function pT(a,i,o){var c=0,u=a.length;if(o){if(a1?o.has(i):Object.prototype.hasOwnProperty.call(o,i)){for(var r=a1?o.get(i):o[i];c<r.length;++c)if(a[r[c]].t===i)return a.Count++,r[c]}}else for(;c<u;++c)if(a[c].t===i)return a.Count++,c;return a[u]={t:i},a.Count++,a.Unique++,o&&(a1?(o.has(i)||o.set(i,[]),o.get(i).push(u)):(Object.prototype.hasOwnProperty.call(o,i)||(o[i]=[]),o[i].push(u))),u}function Mx(a,i){var o={min:a+1,max:a+1},c=-1;return i.MDW&&(uf=i.MDW),i.width!=null?o.customWidth=1:i.wpx!=null?c=vx(i.wpx):i.wch!=null&&(c=i.wch),c>-1?(o.width=W5(c),o.customWidth=1):i.width!=null&&(o.width=i.width),i.hidden&&(o.hidden=!0),i.level!=null&&(o.outlineLevel=o.level=i.level),o}function WM(a,i){if(a){var o=[.7,.7,.75,.75,.3,.3];i=="xlml"&&(o=[1,1,1,1,.5,.5]),a.left==null&&(a.left=o[0]),a.right==null&&(a.right=o[1]),a.top==null&&(a.top=o[2]),a.bottom==null&&(a.bottom=o[3]),a.header==null&&(a.header=o[4]),a.footer==null&&(a.footer=o[5])}}function xp(a,i,o){var c=o.revssf[i.z!=null?i.z:"General"],u=60,r=a.length;if(c==null&&o.ssf){for(;u<392;++u)if(o.ssf[u]==null){Wk(i.z,u),o.ssf[u]=i.z,o.revssf[i.z]=c=u;break}}for(u=0;u!=r;++u)if(a[u].numFmtId===c)return u;return a[r]={numFmtId:c,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},r}function mV(a,i,o){if(a&&a["!ref"]){var c=ao(a["!ref"]);if(c.e.c<c.s.c||c.e.r<c.s.r)throw new Error("Bad range ("+o+"): "+a["!ref"])}}function gV(a){if(a.length===0)return"";for(var i='<mergeCells count="'+a.length+'">',o=0;o!=a.length;++o)i+='<mergeCell ref="'+es(a[o])+'"/>';return i+"</mergeCells>"}function _V(a,i,o,c,u){var r=!1,_={},T=null;if(c.bookType!=="xlsx"&&i.vbaraw){var E=i.SheetNames[o];try{i.Workbook&&(E=i.Workbook.Sheets[o].CodeName||E)}catch{}r=!0,_.codeName=sf(Ca(E))}if(a&&a["!outline"]){var k={summaryBelow:1,summaryRight:1};a["!outline"].above&&(k.summaryBelow=0),a["!outline"].left&&(k.summaryRight=0),T=(T||"")+Vr("outlinePr",null,k)}!r&&!T||(u[u.length]=Vr("sheetPr",T,_))}var vV=["objects","scenarios","selectLockedCells","selectUnlockedCells"],yV=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function xV(a){var i={sheet:1};return vV.forEach(function(o){a[o]!=null&&a[o]&&(i[o]="1")}),yV.forEach(function(o){a[o]!=null&&!a[o]&&(i[o]="0")}),a.password&&(i.password=IM(a.password).toString(16).toUpperCase()),Vr("sheetProtection",null,i)}function bV(a){return WM(a),Vr("pageMargins",null,a)}function wV(a,i){for(var o=["<cols>"],c,u=0;u!=i.length;++u)(c=i[u])&&(o[o.length]=Vr("col",null,Mx(u,c)));return o[o.length]="</cols>",o.join("")}function TV(a,i,o,c){var u=typeof a.ref=="string"?a.ref:es(a.ref);o.Workbook||(o.Workbook={Sheets:[]}),o.Workbook.Names||(o.Workbook.Names=[]);var r=o.Workbook.Names,_=Xc(u);_.s.r==_.e.r&&(_.e.r=Xc(i["!ref"]).e.r,u=es(_));for(var T=0;T<r.length;++T){var E=r[T];if(E.Name=="_xlnm._FilterDatabase"&&E.Sheet==c){E.Ref="'"+o.SheetNames[c]+"'!"+u;break}}return T==r.length&&r.push({Name:"_xlnm._FilterDatabase",Sheet:c,Ref:"'"+o.SheetNames[c]+"'!"+u}),Vr("autoFilter",null,{ref:u})}function SV(a,i,o,c){var u={workbookViewId:"0"};return(((c||{}).Workbook||{}).Views||[])[0]&&(u.rightToLeft=c.Workbook.Views[0].RTL?"1":"0"),Vr("sheetViews",Vr("sheetView",null,u),{})}function EV(a,i,o,c){if(a.c&&o["!comments"].push([i,a.c]),a.v===void 0&&typeof a.f!="string"||a.t==="z"&&!a.f)return"";var u="",r=a.t,_=a.v;if(a.t!=="z")switch(a.t){case"b":u=a.v?"1":"0";break;case"n":u=""+a.v;break;case"e":u=m1[a.v];break;case"d":c&&c.cellDates?u=jl(a.v,-1).toISOString():(a=pc(a),a.t="n",u=""+(a.v=fc(jl(a.v)))),typeof a.z>"u"&&(a.z=Ro[14]);break;default:u=a.v;break}var T=Qs("v",Ca(u)),E={r:i},k=xp(c.cellXfs,a,c);switch(k!==0&&(E.s=k),a.t){case"n":break;case"d":E.t="d";break;case"b":E.t="b";break;case"e":E.t="e";break;case"z":break;default:if(a.v==null){delete a.t;break}if(a.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(c&&c.bookSST){T=Qs("v",""+pT(c.Strings,a.v,c.revStrings)),E.t="s";break}E.t="str";break}if(a.t!=r&&(a.t=r,a.v=_),typeof a.f=="string"&&a.f){var D=a.F&&a.F.slice(0,i.length)==i?{t:"array",ref:a.F}:null;T=Vr("f",Ca(a.f),D)+(a.v!=null?T:"")}return a.l&&o["!links"].push([i,a.l]),a.D&&(E.cm=1),Vr("c",T,E)}function AV(a,i,o,c){var u=[],r=[],_=ao(a["!ref"]),T="",E,k="",D=[],j=0,B=0,P=a["!rows"],ee=Array.isArray(a),G={r:k},K,J=-1;for(B=_.s.c;B<=_.e.c;++B)D[B]=vl(B);for(j=_.s.r;j<=_.e.r;++j){for(r=[],k=el(j),B=_.s.c;B<=_.e.c;++B){E=D[B]+k;var ne=ee?(a[j]||[])[B]:a[E];ne!==void 0&&(T=EV(ne,E,a,i,o,c))!=null&&r.push(T)}(r.length>0||P&&P[j])&&(G={r:k},P&&P[j]&&(K=P[j],K.hidden&&(G.hidden=1),J=-1,K.hpx?J=yx(K.hpx):K.hpt&&(J=K.hpt),J>-1&&(G.ht=J,G.customHeight=1),K.level&&(G.outlineLevel=K.level)),u[u.length]=Vr("row",r.join(""),G))}if(P)for(;j<P.length;++j)P&&P[j]&&(G={r:j+1},K=P[j],K.hidden&&(G.hidden=1),J=-1,K.hpx?J=yx(K.hpx):K.hpt&&(J=K.hpt),J>-1&&(G.ht=J,G.customHeight=1),K.level&&(G.outlineLevel=K.level),u[u.length]=Vr("row","",G));return u.join("")}function qM(a,i,o,c){var u=[ts,Vr("worksheet",null,{xmlns:cg[0],"xmlns:r":Fs.r})],r=o.SheetNames[a],_=0,T="",E=o.Sheets[r];E==null&&(E={});var k=E["!ref"]||"A1",D=ao(k);if(D.e.c>16383||D.e.r>1048575){if(i.WTF)throw new Error("Range "+k+" exceeds format limit A1:XFD1048576");D.e.c=Math.min(D.e.c,16383),D.e.r=Math.min(D.e.c,1048575),k=es(D)}c||(c={}),E["!comments"]=[];var j=[];_V(E,o,a,i,u),u[u.length]=Vr("dimension",null,{ref:k}),u[u.length]=SV(E,i,a,o),i.sheetFormat&&(u[u.length]=Vr("sheetFormatPr",null,{defaultRowHeight:i.sheetFormat.defaultRowHeight||"16",baseColWidth:i.sheetFormat.baseColWidth||"10",outlineLevelRow:i.sheetFormat.outlineLevelRow||"7"})),E["!cols"]!=null&&E["!cols"].length>0&&(u[u.length]=wV(E,E["!cols"])),u[_=u.length]="<sheetData/>",E["!links"]=[],E["!ref"]!=null&&(T=AV(E,i,a,o,c),T.length>0&&(u[u.length]=T)),u.length>_+1&&(u[u.length]="</sheetData>",u[_]=u[_].replace("/>",">")),E["!protect"]&&(u[u.length]=xV(E["!protect"])),E["!autofilter"]!=null&&(u[u.length]=TV(E["!autofilter"],E,o,a)),E["!merges"]!=null&&E["!merges"].length>0&&(u[u.length]=gV(E["!merges"]));var B=-1,P,ee=-1;return E["!links"].length>0&&(u[u.length]="<hyperlinks>",E["!links"].forEach(function(G){G[1].Target&&(P={ref:G[0]},G[1].Target.charAt(0)!="#"&&(ee=Aa(c,-1,Ca(G[1].Target).replace(/#.*$/,""),Kn.HLINK),P["r:id"]="rId"+ee),(B=G[1].Target.indexOf("#"))>-1&&(P.location=Ca(G[1].Target.slice(B+1))),G[1].Tooltip&&(P.tooltip=Ca(G[1].Tooltip)),u[u.length]=Vr("hyperlink",null,P))}),u[u.length]="</hyperlinks>"),delete E["!links"],E["!margins"]!=null&&(u[u.length]=bV(E["!margins"])),(!i||i.ignoreEC||i.ignoreEC==null)&&(u[u.length]=Qs("ignoredErrors",Vr("ignoredError",null,{numberStoredAsText:1,sqref:k}))),j.length>0&&(ee=Aa(c,-1,"../drawings/drawing"+(a+1)+".xml",Kn.DRAW),u[u.length]=Vr("drawing",null,{"r:id":"rId"+ee}),E["!drawing"]=j),E["!comments"].length>0&&(ee=Aa(c,-1,"../drawings/vmlDrawing"+(a+1)+".vml",Kn.VML),u[u.length]=Vr("legacyDrawing",null,{"r:id":"rId"+ee}),E["!legacy"]=ee),u.length>1&&(u[u.length]="</worksheet>",u[1]=u[1].replace("/>",">")),u.join("")}function CV(a,i){var o={},c=a.l+i;o.r=a.read_shift(4),a.l+=4;var u=a.read_shift(2);a.l+=1;var r=a.read_shift(1);return a.l=c,r&7&&(o.level=r&7),r&16&&(o.hidden=!0),r&32&&(o.hpt=u/20),o}function IV(a,i,o){var c=cr(145),u=(o["!rows"]||[])[a]||{};c.write_shift(4,a),c.write_shift(4,0);var r=320;u.hpx?r=yx(u.hpx)*20:u.hpt&&(r=u.hpt*20),c.write_shift(2,r),c.write_shift(1,0);var _=0;u.level&&(_|=u.level),u.hidden&&(_|=16),(u.hpx||u.hpt)&&(_|=32),c.write_shift(1,_),c.write_shift(1,0);var T=0,E=c.l;c.l+=4;for(var k={r:a,c:0},D=0;D<16;++D)if(!(i.s.c>D+1<<10||i.e.c<D<<10)){for(var j=-1,B=-1,P=D<<10;P<D+1<<10;++P){k.c=P;var ee=Array.isArray(o)?(o[k.r]||[])[k.c]:o[Ia(k)];ee&&(j<0&&(j=P),B=P)}j<0||(++T,c.write_shift(4,j),c.write_shift(4,B))}var G=c.l;return c.l=E,c.write_shift(4,T),c.l=G,c.length>c.l?c.slice(0,c.l):c}function kV(a,i,o,c){var u=IV(c,o,i);(u.length>17||(i["!rows"]||[])[c])&&Ir(a,0,u)}var MV=Im,DV=dg;function RV(){}function FV(a,i){var o={},c=a[a.l];return++a.l,o.above=!(c&64),o.left=!(c&128),a.l+=18,o.name=Gz(a,i-19),o}function PV(a,i,o){o==null&&(o=cr(84+4*a.length));var c=192;i&&(i.above&&(c&=-65),i.left&&(c&=-129)),o.write_shift(1,c);for(var u=1;u<3;++u)o.write_shift(1,0);return mx({auto:1},o),o.write_shift(-4,-1),o.write_shift(-4,-1),sM(a,o),o.slice(0,o.l)}function LV(a){var i=Au(a);return[i]}function OV(a,i,o){return o==null&&(o=cr(8)),Em(i,o)}function NV(a){var i=Am(a);return[i]}function BV(a,i,o){return o==null&&(o=cr(4)),Cm(i,o)}function zV(a){var i=Au(a),o=a.read_shift(1);return[i,o,"b"]}function jV(a,i,o){return o==null&&(o=cr(9)),Em(i,o),o.write_shift(1,a.v?1:0),o}function UV(a){var i=Am(a),o=a.read_shift(1);return[i,o,"b"]}function VV(a,i,o){return o==null&&(o=cr(5)),Cm(i,o),o.write_shift(1,a.v?1:0),o}function GV(a){var i=Au(a),o=a.read_shift(1);return[i,o,"e"]}function HV(a,i,o){return o==null&&(o=cr(9)),Em(i,o),o.write_shift(1,a.v),o}function WV(a){var i=Am(a),o=a.read_shift(1);return[i,o,"e"]}function qV(a,i,o){return o==null&&(o=cr(8)),Cm(i,o),o.write_shift(1,a.v),o.write_shift(2,0),o.write_shift(1,0),o}function $V(a){var i=Au(a),o=a.read_shift(4);return[i,o,"s"]}function XV(a,i,o){return o==null&&(o=cr(12)),Em(i,o),o.write_shift(4,i.v),o}function ZV(a){var i=Am(a),o=a.read_shift(4);return[i,o,"s"]}function YV(a,i,o){return o==null&&(o=cr(8)),Cm(i,o),o.write_shift(4,i.v),o}function KV(a){var i=Au(a),o=fg(a);return[i,o,"n"]}function JV(a,i,o){return o==null&&(o=cr(16)),Em(i,o),wm(a.v,o),o}function QV(a){var i=Am(a),o=fg(a);return[i,o,"n"]}function e9(a,i,o){return o==null&&(o=cr(12)),Cm(i,o),wm(a.v,o),o}function t9(a){var i=Au(a),o=lM(a);return[i,o,"n"]}function r9(a,i,o){return o==null&&(o=cr(12)),Em(i,o),cM(a.v,o),o}function i9(a){var i=Am(a),o=lM(a);return[i,o,"n"]}function n9(a,i,o){return o==null&&(o=cr(8)),Cm(i,o),cM(a.v,o),o}function a9(a){var i=Au(a),o=oT(a);return[i,o,"is"]}function o9(a){var i=Au(a),o=yl(a);return[i,o,"str"]}function s9(a,i,o){return o==null&&(o=cr(12+4*a.v.length)),Em(i,o),Ls(a.v,o),o.length>o.l?o.slice(0,o.l):o}function l9(a){var i=Am(a),o=yl(a);return[i,o,"str"]}function c9(a,i,o){return o==null&&(o=cr(8+4*a.v.length)),Cm(i,o),Ls(a.v,o),o.length>o.l?o.slice(0,o.l):o}function u9(a,i,o){var c=a.l+i,u=Au(a);u.r=o["!row"];var r=a.read_shift(1),_=[u,r,"b"];if(o.cellFormula){a.l+=2;var T=kx(a,c-a.l,o);_[3]=lg(T,null,u,o.supbooks,o)}else a.l=c;return _}function h9(a,i,o){var c=a.l+i,u=Au(a);u.r=o["!row"];var r=a.read_shift(1),_=[u,r,"e"];if(o.cellFormula){a.l+=2;var T=kx(a,c-a.l,o);_[3]=lg(T,null,u,o.supbooks,o)}else a.l=c;return _}function d9(a,i,o){var c=a.l+i,u=Au(a);u.r=o["!row"];var r=fg(a),_=[u,r,"n"];if(o.cellFormula){a.l+=2;var T=kx(a,c-a.l,o);_[3]=lg(T,null,u,o.supbooks,o)}else a.l=c;return _}function f9(a,i,o){var c=a.l+i,u=Au(a);u.r=o["!row"];var r=yl(a),_=[u,r,"str"];if(o.cellFormula){a.l+=2;var T=kx(a,c-a.l,o);_[3]=lg(T,null,u,o.supbooks,o)}else a.l=c;return _}var p9=Im,m9=dg;function g9(a,i){return i==null&&(i=cr(4)),i.write_shift(4,a),i}function _9(a,i){var o=a.l+i,c=Im(a,16),u=sT(a),r=yl(a),_=yl(a),T=yl(a);a.l=o;var E={rfx:c,relId:u,loc:r,display:T};return _&&(E.Tooltip=_),E}function v9(a,i){var o=cr(50+4*(a[1].Target.length+(a[1].Tooltip||"").length));dg({s:Ps(a[0]),e:Ps(a[0])},o),lT("rId"+i,o);var c=a[1].Target.indexOf("#"),u=c==-1?"":a[1].Target.slice(c+1);return Ls(u||"",o),Ls(a[1].Tooltip||"",o),Ls("",o),o.slice(0,o.l)}function y9(){}function x9(a,i,o){var c=a.l+i,u=uM(a,16),r=a.read_shift(1),_=[u];if(_[2]=r,o.cellFormula){var T=lV(a,c-a.l,o);_[1]=T}else a.l=c;return _}function b9(a,i,o){var c=a.l+i,u=Im(a,16),r=[u];if(o.cellFormula){var _=uV(a,c-a.l,o);r[1]=_,a.l=c}else a.l=c;return r}function w9(a,i,o){o==null&&(o=cr(18));var c=Mx(a,i);o.write_shift(-4,a),o.write_shift(-4,a),o.write_shift(4,(c.width||10)*256),o.write_shift(4,0);var u=0;return i.hidden&&(u|=1),typeof c.width=="number"&&(u|=2),i.level&&(u|=i.level<<8),o.write_shift(2,u),o}var $M=["left","right","top","bottom","header","footer"];function T9(a){var i={};return $M.forEach(function(o){i[o]=fg(a,8)}),i}function S9(a,i){return i==null&&(i=cr(6*8)),WM(a),$M.forEach(function(o){wm(a[o],i)}),i}function E9(a){var i=a.read_shift(2);return a.l+=28,{RTL:i&32}}function A9(a,i,o){o==null&&(o=cr(30));var c=924;return(((i||{}).Views||[])[0]||{}).RTL&&(c|=32),o.write_shift(2,c),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(1,0),o.write_shift(1,0),o.write_shift(2,0),o.write_shift(2,100),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(4,0),o}function C9(a){var i=cr(24);return i.write_shift(4,4),i.write_shift(4,1),dg(a,i),i}function I9(a,i){return i==null&&(i=cr(16*4+2)),i.write_shift(2,a.password?IM(a.password):0),i.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(o){o[1]?i.write_shift(4,a[o[0]]!=null&&!a[o[0]]?1:0):i.write_shift(4,a[o[0]]!=null&&a[o[0]]?0:1)}),i}function k9(){}function M9(){}function D9(a,i,o,c,u,r,_){if(i.v===void 0)return!1;var T="";switch(i.t){case"b":T=i.v?"1":"0";break;case"d":i=pc(i),i.z=i.z||Ro[14],i.v=fc(jl(i.v)),i.t="n";break;case"n":case"e":T=""+i.v;break;default:T=i.v;break}var E={r:o,c};switch(E.s=xp(u.cellXfs,i,u),i.l&&r["!links"].push([Ia(E),i.l]),i.c&&r["!comments"].push([Ia(E),i.c]),i.t){case"s":case"str":return u.bookSST?(T=pT(u.Strings,i.v,u.revStrings),E.t="s",E.v=T,_?Ir(a,18,YV(i,E)):Ir(a,7,XV(i,E))):(E.t="str",_?Ir(a,17,c9(i,E)):Ir(a,6,s9(i,E))),!0;case"n":return i.v==(i.v|0)&&i.v>-1e3&&i.v<1e3?_?Ir(a,13,n9(i,E)):Ir(a,2,r9(i,E)):_?Ir(a,16,e9(i,E)):Ir(a,5,JV(i,E)),!0;case"b":return E.t="b",_?Ir(a,15,VV(i,E)):Ir(a,4,jV(i,E)),!0;case"e":return E.t="e",_?Ir(a,14,qV(i,E)):Ir(a,3,HV(i,E)),!0}return _?Ir(a,12,BV(i,E)):Ir(a,1,OV(i,E)),!0}function R9(a,i,o,c){var u=ao(i["!ref"]||"A1"),r,_="",T=[];Ir(a,145);var E=Array.isArray(i),k=u.e.r;i["!rows"]&&(k=Math.max(u.e.r,i["!rows"].length-1));for(var D=u.s.r;D<=k;++D){_=el(D),kV(a,i,u,D);var j=!1;if(D<=u.e.r)for(var B=u.s.c;B<=u.e.c;++B){D===u.s.r&&(T[B]=vl(B)),r=T[B]+_;var P=E?(i[D]||[])[B]:i[r];if(!P){j=!1;continue}j=D9(a,P,D,B,c,i,j)}}Ir(a,146)}function F9(a,i){!i||!i["!merges"]||(Ir(a,177,g9(i["!merges"].length)),i["!merges"].forEach(function(o){Ir(a,176,m9(o))}),Ir(a,178))}function P9(a,i){!i||!i["!cols"]||(Ir(a,390),i["!cols"].forEach(function(o,c){o&&Ir(a,60,w9(c,o))}),Ir(a,391))}function L9(a,i){!i||!i["!ref"]||(Ir(a,648),Ir(a,649,C9(ao(i["!ref"]))),Ir(a,650))}function O9(a,i,o){i["!links"].forEach(function(c){if(c[1].Target){var u=Aa(o,-1,c[1].Target.replace(/#.*$/,""),Kn.HLINK);Ir(a,494,v9(c,u))}}),delete i["!links"]}function N9(a,i,o,c){if(i["!comments"].length>0){var u=Aa(c,-1,"../drawings/vmlDrawing"+(o+1)+".vml",Kn.VML);Ir(a,551,lT("rId"+u)),i["!legacy"]=u}}function B9(a,i,o,c){if(i["!autofilter"]){var u=i["!autofilter"],r=typeof u.ref=="string"?u.ref:es(u.ref);o.Workbook||(o.Workbook={Sheets:[]}),o.Workbook.Names||(o.Workbook.Names=[]);var _=o.Workbook.Names,T=Xc(r);T.s.r==T.e.r&&(T.e.r=Xc(i["!ref"]).e.r,r=es(T));for(var E=0;E<_.length;++E){var k=_[E];if(k.Name=="_xlnm._FilterDatabase"&&k.Sheet==c){k.Ref="'"+o.SheetNames[c]+"'!"+r;break}}E==_.length&&_.push({Name:"_xlnm._FilterDatabase",Sheet:c,Ref:"'"+o.SheetNames[c]+"'!"+r}),Ir(a,161,dg(ao(r))),Ir(a,162)}}function z9(a,i,o){Ir(a,133),Ir(a,137,A9(i,o)),Ir(a,138),Ir(a,134)}function j9(a,i){i["!protect"]&&Ir(a,535,I9(i["!protect"]))}function U9(a,i,o,c){var u=dc(),r=o.SheetNames[a],_=o.Sheets[r]||{},T=r;try{o&&o.Workbook&&(T=o.Workbook.Sheets[a].CodeName||T)}catch{}var E=ao(_["!ref"]||"A1");if(E.e.c>16383||E.e.r>1048575){if(i.WTF)throw new Error("Range "+(_["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");E.e.c=Math.min(E.e.c,16383),E.e.r=Math.min(E.e.c,1048575)}return _["!links"]=[],_["!comments"]=[],Ir(u,129),(o.vbaraw||_["!outline"])&&Ir(u,147,PV(T,_["!outline"])),Ir(u,148,DV(E)),z9(u,_,o.Workbook),P9(u,_,a,i,o),R9(u,_,a,i,o),j9(u,_),B9(u,_,o,a),F9(u,_),O9(u,_,c),_["!margins"]&&Ir(u,476,S9(_["!margins"])),(!i||i.ignoreEC||i.ignoreEC==null)&&L9(u,_),N9(u,_,a,c),Ir(u,130),u.end()}function V9(a,i){a.l+=10;var o=yl(a,i-10);return{name:o}}var G9=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function H9(a){return!a.Workbook||!a.Workbook.WBProps?"false":xz(a.Workbook.WBProps.date1904)?"true":"false"}var W9="][*?/\\".split("");function XM(a,i){if(a.length>31){if(i)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var o=!0;return W9.forEach(function(c){if(a.indexOf(c)!=-1){if(!i)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");o=!1}}),o}function q9(a,i,o){a.forEach(function(c,u){XM(c);for(var r=0;r<u;++r)if(c==a[r])throw new Error("Duplicate Sheet Name: "+c);if(o){var _=i&&i[u]&&i[u].CodeName||c;if(_.charCodeAt(0)==95&&_.length>22)throw new Error("Bad Code Name: Worksheet"+_)}})}function $9(a){if(!a||!a.SheetNames||!a.Sheets)throw new Error("Invalid Workbook");if(!a.SheetNames.length)throw new Error("Workbook is empty");var i=a.Workbook&&a.Workbook.Sheets||[];q9(a.SheetNames,i,!!a.vbaraw);for(var o=0;o<a.SheetNames.length;++o)mV(a.Sheets[a.SheetNames[o]],a.SheetNames[o],o)}function ZM(a){var i=[ts];i[i.length]=Vr("workbook",null,{xmlns:cg[0],"xmlns:r":Fs.r});var o=a.Workbook&&(a.Workbook.Names||[]).length>0,c={codeName:"ThisWorkbook"};a.Workbook&&a.Workbook.WBProps&&(G9.forEach(function(T){a.Workbook.WBProps[T[0]]!=null&&a.Workbook.WBProps[T[0]]!=T[1]&&(c[T[0]]=a.Workbook.WBProps[T[0]])}),a.Workbook.WBProps.CodeName&&(c.codeName=a.Workbook.WBProps.CodeName,delete c.CodeName)),i[i.length]=Vr("workbookPr",null,c);var u=a.Workbook&&a.Workbook.Sheets||[],r=0;if(u&&u[0]&&u[0].Hidden){for(i[i.length]="<bookViews>",r=0;r!=a.SheetNames.length&&!(!u[r]||!u[r].Hidden);++r);r==a.SheetNames.length&&(r=0),i[i.length]='<workbookView firstSheet="'+r+'" activeTab="'+r+'"/>',i[i.length]="</bookViews>"}for(i[i.length]="<sheets>",r=0;r!=a.SheetNames.length;++r){var _={name:Ca(a.SheetNames[r].slice(0,31))};if(_.sheetId=""+(r+1),_["r:id"]="rId"+(r+1),u[r])switch(u[r].Hidden){case 1:_.state="hidden";break;case 2:_.state="veryHidden";break}i[i.length]=Vr("sheet",null,_)}return i[i.length]="</sheets>",o&&(i[i.length]="<definedNames>",a.Workbook&&a.Workbook.Names&&a.Workbook.Names.forEach(function(T){var E={name:T.Name};T.Comment&&(E.comment=T.Comment),T.Sheet!=null&&(E.localSheetId=""+T.Sheet),T.Hidden&&(E.hidden="1"),T.Ref&&(i[i.length]=Vr("definedName",Ca(T.Ref),E))}),i[i.length]="</definedNames>"),i.length>2&&(i[i.length]="</workbook>",i[1]=i[1].replace("/>",">")),i.join("")}function X9(a,i){var o={};return o.Hidden=a.read_shift(4),o.iTabID=a.read_shift(4),o.strRelID=H5(a,i-8),o.name=yl(a),o}function Z9(a,i){return i||(i=cr(127)),i.write_shift(4,a.Hidden),i.write_shift(4,a.iTabID),lT(a.strRelID,i),Ls(a.name.slice(0,31),i),i.length>i.l?i.slice(0,i.l):i}function Y9(a,i){var o={},c=a.read_shift(4);o.defaultThemeVersion=a.read_shift(4);var u=i>8?yl(a):"";return u.length>0&&(o.CodeName=u),o.autoCompressPictures=!!(c&65536),o.backupFile=!!(c&64),o.checkCompatibility=!!(c&4096),o.date1904=!!(c&1),o.filterPrivacy=!!(c&8),o.hidePivotFieldList=!!(c&1024),o.promptedSolutions=!!(c&16),o.publishItems=!!(c&2048),o.refreshAllConnections=!!(c&262144),o.saveExternalLinkValues=!!(c&128),o.showBorderUnselectedTables=!!(c&4),o.showInkAnnotation=!!(c&32),o.showObjects=["all","placeholders","none"][c>>13&3],o.showPivotChartFilter=!!(c&32768),o.updateLinks=["userSet","never","always"][c>>8&3],o}function K9(a,i){i||(i=cr(72));var o=0;return a&&a.filterPrivacy&&(o|=8),i.write_shift(4,o),i.write_shift(4,0),sM(a&&a.CodeName||"ThisWorkbook",i),i.slice(0,i.l)}function J9(a,i,o){var c=a.l+i;a.l+=4,a.l+=1;var u=a.read_shift(4),r=Hz(a),_=cV(a,0,o),T=sT(a);a.l=c;var E={Name:r,Ptg:_};return u<268435455&&(E.Sheet=u),T&&(E.Comment=T),E}function Q9(a,i){Ir(a,143);for(var o=0;o!=i.SheetNames.length;++o){var c=i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[o]&&i.Workbook.Sheets[o].Hidden||0,u={Hidden:c,iTabID:o+1,strRelID:"rId"+(o+1),name:i.SheetNames[o]};Ir(a,156,Z9(u))}Ir(a,144)}function eG(a,i){i||(i=cr(127));for(var o=0;o!=4;++o)i.write_shift(4,0);return Ls("SheetJS",i),Ls(o1.version,i),Ls(o1.version,i),Ls("7262",i),i.length>i.l?i.slice(0,i.l):i}function tG(a,i){i||(i=cr(29)),i.write_shift(-4,0),i.write_shift(-4,460),i.write_shift(4,28800),i.write_shift(4,17600),i.write_shift(4,500),i.write_shift(4,a),i.write_shift(4,a);var o=120;return i.write_shift(1,o),i.length>i.l?i.slice(0,i.l):i}function rG(a,i){if(!(!i.Workbook||!i.Workbook.Sheets)){for(var o=i.Workbook.Sheets,c=0,u=-1,r=-1;c<o.length;++c)!o[c]||!o[c].Hidden&&u==-1?u=c:o[c].Hidden==1&&r==-1&&(r=c);r>u||(Ir(a,135),Ir(a,158,tG(u)),Ir(a,136))}}function iG(a,i){var o=dc();return Ir(o,131),Ir(o,128,eG()),Ir(o,153,K9(a.Workbook&&a.Workbook.WBProps||null)),rG(o,a,i),Q9(o,a,i),Ir(o,132),o.end()}function nG(a,i,o){return(i.slice(-4)===".bin"?iG:ZM)(a,o)}function aG(a,i,o,c,u){return(i.slice(-4)===".bin"?U9:qM)(a,o,c,u)}function oG(a,i,o){return(i.slice(-4)===".bin"?Sj:DM)(a,o)}function sG(a,i,o){return(i.slice(-4)===".bin"?K7:CM)(a,o)}function lG(a,i,o){return(i.slice(-4)===".bin"?jj:OM)(a,o)}function cG(a){return(a.slice(-4)===".bin"?Rj:PM)()}function uG(a,i){var o=[];return a.Props&&o.push(o7(a.Props,i)),a.Custprops&&o.push(s7(a.Props,a.Custprops,i)),o.join("")}function hG(){return""}function dG(a,i){var o=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return i.cellXfs.forEach(function(c,u){var r=[];r.push(Vr("NumberFormat",null,{"ss:Format":Ca(Ro[c.numFmtId])}));var _={"ss:ID":"s"+(21+u)};o.push(Vr("Style",r.join(""),_))}),Vr("Styles",o.join(""))}function YM(a){return Vr("NamedRange",null,{"ss:Name":a.Name,"ss:RefersTo":"="+dT(a.Ref,{r:0,c:0})})}function fG(a){if(!((a||{}).Workbook||{}).Names)return"";for(var i=a.Workbook.Names,o=[],c=0;c<i.length;++c){var u=i[c];u.Sheet==null&&(u.Name.match(/^_xlfn\./)||o.push(YM(u)))}return Vr("Names",o.join(""))}function pG(a,i,o,c){if(!a||!((c||{}).Workbook||{}).Names)return"";for(var u=c.Workbook.Names,r=[],_=0;_<u.length;++_){var T=u[_];T.Sheet==o&&(T.Name.match(/^_xlfn\./)||r.push(YM(T)))}return r.join("")}function mG(a,i,o,c){if(!a)return"";var u=[];if(a["!margins"]&&(u.push("<PageSetup>"),a["!margins"].header&&u.push(Vr("Header",null,{"x:Margin":a["!margins"].header})),a["!margins"].footer&&u.push(Vr("Footer",null,{"x:Margin":a["!margins"].footer})),u.push(Vr("PageMargins",null,{"x:Bottom":a["!margins"].bottom||"0.75","x:Left":a["!margins"].left||"0.7","x:Right":a["!margins"].right||"0.7","x:Top":a["!margins"].top||"0.75"})),u.push("</PageSetup>")),c&&c.Workbook&&c.Workbook.Sheets&&c.Workbook.Sheets[o])if(c.Workbook.Sheets[o].Hidden)u.push(Vr("Visible",c.Workbook.Sheets[o].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var r=0;r<o&&!(c.Workbook.Sheets[r]&&!c.Workbook.Sheets[r].Hidden);++r);r==o&&u.push("<Selected/>")}return((((c||{}).Workbook||{}).Views||[])[0]||{}).RTL&&u.push("<DisplayRightToLeft/>"),a["!protect"]&&(u.push(Qs("ProtectContents","True")),a["!protect"].objects&&u.push(Qs("ProtectObjects","True")),a["!protect"].scenarios&&u.push(Qs("ProtectScenarios","True")),a["!protect"].selectLockedCells!=null&&!a["!protect"].selectLockedCells?u.push(Qs("EnableSelection","NoSelection")):a["!protect"].selectUnlockedCells!=null&&!a["!protect"].selectUnlockedCells&&u.push(Qs("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(_){a["!protect"][_[0]]&&u.push("<"+_[1]+"/>")})),u.length==0?"":Vr("WorksheetOptions",u.join(""),{xmlns:$c.x})}function gG(a){return a.map(function(i){var o=yz(i.t||""),c=Vr("ss:Data",o,{xmlns:"http://www.w3.org/TR/REC-html40"});return Vr("Comment",c,{"ss:Author":i.a})}).join("")}function _G(a,i,o,c,u,r,_){if(!a||a.v==null&&a.f==null)return"";var T={};if(a.f&&(T["ss:Formula"]="="+Ca(dT(a.f,_))),a.F&&a.F.slice(0,i.length)==i){var E=Ps(a.F.slice(i.length+1));T["ss:ArrayRange"]="RC:R"+(E.r==_.r?"":"["+(E.r-_.r)+"]")+"C"+(E.c==_.c?"":"["+(E.c-_.c)+"]")}if(a.l&&a.l.Target&&(T["ss:HRef"]=Ca(a.l.Target),a.l.Tooltip&&(T["x:HRefScreenTip"]=Ca(a.l.Tooltip))),o["!merges"])for(var k=o["!merges"],D=0;D!=k.length;++D)k[D].s.c!=_.c||k[D].s.r!=_.r||(k[D].e.c>k[D].s.c&&(T["ss:MergeAcross"]=k[D].e.c-k[D].s.c),k[D].e.r>k[D].s.r&&(T["ss:MergeDown"]=k[D].e.r-k[D].s.r));var j="",B="";switch(a.t){case"z":if(!c.sheetStubs)return"";break;case"n":j="Number",B=String(a.v);break;case"b":j="Boolean",B=a.v?"1":"0";break;case"e":j="Error",B=m1[a.v];break;case"d":j="DateTime",B=new Date(a.v).toISOString(),a.z==null&&(a.z=a.z||Ro[14]);break;case"s":j="String",B=vz(a.v||"");break}var P=xp(c.cellXfs,a,c);T["ss:StyleID"]="s"+(21+P),T["ss:Index"]=_.c+1;var ee=a.v!=null?B:"",G=a.t=="z"?"":'<Data ss:Type="'+j+'">'+ee+"</Data>";return(a.c||[]).length>0&&(G+=gG(a.c)),Vr("Cell",G,T)}function vG(a,i){var o='<Row ss:Index="'+(a+1)+'"';return i&&(i.hpt&&!i.hpx&&(i.hpx=MM(i.hpt)),i.hpx&&(o+=' ss:AutoFitHeight="0" ss:Height="'+i.hpx+'"'),i.hidden&&(o+=' ss:Hidden="1"')),o+">"}function yG(a,i,o,c){if(!a["!ref"])return"";var u=ao(a["!ref"]),r=a["!merges"]||[],_=0,T=[];a["!cols"]&&a["!cols"].forEach(function(K,J){uT(K);var ne=!!K.width,he=Mx(J,K),Me={"ss:Index":J+1};ne&&(Me["ss:Width"]=_x(he.width)),K.hidden&&(Me["ss:Hidden"]="1"),T.push(Vr("Column",null,Me))});for(var E=Array.isArray(a),k=u.s.r;k<=u.e.r;++k){for(var D=[vG(k,(a["!rows"]||[])[k])],j=u.s.c;j<=u.e.c;++j){var B=!1;for(_=0;_!=r.length;++_)if(!(r[_].s.c>j)&&!(r[_].s.r>k)&&!(r[_].e.c<j)&&!(r[_].e.r<k)){(r[_].s.c!=j||r[_].s.r!=k)&&(B=!0);break}if(!B){var P={r:k,c:j},ee=Ia(P),G=E?(a[k]||[])[j]:a[ee];D.push(_G(G,ee,a,i,o,c,P))}}D.push("</Row>"),D.length>2&&T.push(D.join(""))}return T.join("")}function xG(a,i,o){var c=[],u=o.SheetNames[a],r=o.Sheets[u],_=r?pG(r,i,a,o):"";return _.length>0&&c.push("<Names>"+_+"</Names>"),_=r?yG(r,i,a,o):"",_.length>0&&c.push("<Table>"+_+"</Table>"),c.push(mG(r,i,a,o)),c.join("")}function bG(a,i){i||(i={}),a.SSF||(a.SSF=pc(Ro)),a.SSF&&(Sx(),Tx(a.SSF),i.revssf=Ex(a.SSF),i.revssf[a.SSF[65535]]=0,i.ssf=a.SSF,i.cellXfs=[],xp(i.cellXfs,{},{revssf:{General:0}}));var o=[];o.push(uG(a,i)),o.push(hG(a,i)),o.push(""),o.push("");for(var c=0;c<a.SheetNames.length;++c)o.push(Vr("Worksheet",xG(c,i,a),{"ss:Name":Ca(a.SheetNames[c])}));return o[2]=dG(a,i),o[3]=fG(a,i),ts+Vr("Workbook",o.join(""),{xmlns:$c.ss,"xmlns:o":$c.o,"xmlns:x":$c.x,"xmlns:ss":$c.ss,"xmlns:dt":$c.dt,"xmlns:html":$c.html})}var z5={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function wG(a,i){var o=[],c=[],u=[],r=0,_,T=rk(mk,"n"),E=rk(gk,"n");if(a.Props)for(_=tl(a.Props),r=0;r<_.length;++r)(Object.prototype.hasOwnProperty.call(T,_[r])?o:Object.prototype.hasOwnProperty.call(E,_[r])?c:u).push([_[r],a.Props[_[r]]]);if(a.Custprops)for(_=tl(a.Custprops),r=0;r<_.length;++r)Object.prototype.hasOwnProperty.call(a.Props||{},_[r])||(Object.prototype.hasOwnProperty.call(T,_[r])?o:Object.prototype.hasOwnProperty.call(E,_[r])?c:u).push([_[r],a.Custprops[_[r]]]);var k=[];for(r=0;r<u.length;++r)xM.indexOf(u[r][0])>-1||_M.indexOf(u[r][0])>-1||u[r][1]!=null&&k.push(u[r]);c.length&&La.utils.cfb_add(i,"/SummaryInformation",bk(c,z5.SI,E,gk)),(o.length||k.length)&&La.utils.cfb_add(i,"/DocumentSummaryInformation",bk(o,z5.DSI,T,mk,k.length?k:null,z5.UDI))}function TG(a,i){var o=i||{},c=La.utils.cfb_new({root:"R"}),u="/Workbook";switch(o.bookType||"xls"){case"xls":o.bookType="biff8";case"xla":o.bookType||(o.bookType="xla");case"biff8":u="/Workbook",o.biff=8;break;case"biff5":u="/Book",o.biff=5;break;default:throw new Error("invalid type "+o.bookType+" for XLS CFB")}return La.utils.cfb_add(c,u,KM(a,o)),o.biff==8&&(a.Props||a.Custprops)&&wG(a,c),o.biff==8&&a.vbaraw&&Uj(c,La.read(a.vbaraw,{type:typeof a.vbaraw=="string"?"binary":"buffer"})),c}var SG={0:{f:CV},1:{f:LV},2:{f:t9},3:{f:GV},4:{f:zV},5:{f:KV},6:{f:o9},7:{f:$V},8:{f:f9},9:{f:d9},10:{f:u9},11:{f:h9},12:{f:NV},13:{f:i9},14:{f:WV},15:{f:UV},16:{f:QV},17:{f:l9},18:{f:ZV},19:{f:oT},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:J9},40:{},42:{},43:{f:oj},44:{f:nj},45:{f:cj},46:{f:hj},47:{f:uj},48:{},49:{f:Nz},50:{},51:{f:Cj},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:B7},62:{f:a9},63:{f:Fj},64:{f:k9},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ud,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:E9},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:FV},148:{f:MV,p:16},151:{f:y9},152:{},153:{f:Y9},154:{},155:{},156:{f:X9},157:{},158:{},159:{T:1,f:X7},160:{T:-1},161:{T:1,f:Im},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:p9},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Ej},336:{T:-1},337:{f:Mj,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:H5},357:{},358:{},359:{},360:{T:1},361:{},362:{f:R7},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:x9},427:{f:b9},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:T9},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:RV},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:_9},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:H5},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Bj},633:{T:1},634:{T:-1},635:{T:1,f:Oj},636:{T:-1},637:{f:Uz},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:V9},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:M9},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Gr(a,i,o,c){var u=i;if(!isNaN(u)){var r=c||(o||[]).length||0,_=a.next(4);_.write_shift(2,u),_.write_shift(2,r),r>0&&iT(o)&&a.push(o)}}function EG(a,i,o,c){var u=c||(o||[]).length||0;if(u<=8224)return Gr(a,i,o,u);var r=i;if(!isNaN(r)){for(var _=o.parts||[],T=0,E=0,k=0;k+(_[T]||8224)<=8224;)k+=_[T]||8224,T++;var D=a.next(4);for(D.write_shift(2,r),D.write_shift(2,k),a.push(o.slice(E,E+k)),E+=k;E<u;){for(D=a.next(4),D.write_shift(2,60),k=0;k+(_[T]||8224)<=8224;)k+=_[T]||8224,T++;D.write_shift(2,k),a.push(o.slice(E,E+k)),E+=k}}}function _1(a,i,o){return a||(a=cr(7)),a.write_shift(2,i),a.write_shift(2,o),a.write_shift(2,0),a.write_shift(1,0),a}function AG(a,i,o,c){var u=cr(9);return _1(u,a,i),wM(o,c||"b",u),u}function CG(a,i,o){var c=cr(8+2*o.length);return _1(c,a,i),c.write_shift(1,o.length),c.write_shift(o.length,o,"sbcs"),c.l<c.length?c.slice(0,c.l):c}function IG(a,i,o,c){if(i.v!=null)switch(i.t){case"d":case"n":var u=i.t=="d"?fc(jl(i.v)):i.v;u==(u|0)&&u>=0&&u<65536?Gr(a,2,V7(o,c,u)):Gr(a,3,U7(o,c,u));return;case"b":case"e":Gr(a,5,AG(o,c,i.v,i.t));return;case"s":case"str":Gr(a,4,CG(o,c,(i.v||"").slice(0,255)));return}Gr(a,1,_1(null,o,c))}function kG(a,i,o,c){var u=Array.isArray(i),r=ao(i["!ref"]||"A1"),_,T="",E=[];if(r.e.c>255||r.e.r>16383){if(c.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");r.e.c=Math.min(r.e.c,255),r.e.r=Math.min(r.e.c,16383),_=es(r)}for(var k=r.s.r;k<=r.e.r;++k){T=el(k);for(var D=r.s.c;D<=r.e.c;++D){k===r.s.r&&(E[D]=vl(D)),_=E[D]+T;var j=u?(i[k]||[])[D]:i[_];j&&IG(a,j,k,D,c)}}}function MG(a,i){var o=i||{};cd!=null&&o.dense==null&&(o.dense=cd);for(var c=dc(),u=0,r=0;r<a.SheetNames.length;++r)a.SheetNames[r]==o.sheet&&(u=r);if(u==0&&o.sheet&&a.SheetNames[0]!=o.sheet)throw new Error("Sheet not found: "+o.sheet);return Gr(c,o.biff==4?1033:o.biff==3?521:9,cT(a,16,o)),kG(c,a.Sheets[a.SheetNames[u]],u,o,a),Gr(c,10),c.end()}function DG(a,i,o){Gr(a,49,S7({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},o))}function RG(a,i,o){i&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(c){for(var u=c[0];u<=c[1];++u)i[u]!=null&&Gr(a,1054,C7(u,i[u],o))})}function FG(a,i){var o=cr(19);o.write_shift(4,2151),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(2,3),o.write_shift(1,1),o.write_shift(4,0),Gr(a,2151,o),o=cr(39),o.write_shift(4,2152),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(2,3),o.write_shift(1,0),o.write_shift(4,0),o.write_shift(2,1),o.write_shift(4,4),o.write_shift(2,0),EM(ao(i["!ref"]||"A1"),o),o.write_shift(4,4),Gr(a,2152,o)}function PG(a,i){for(var o=0;o<16;++o)Gr(a,224,Tk({numFmtId:0,style:!0},0,i));i.cellXfs.forEach(function(c){Gr(a,224,Tk(c,0,i))})}function LG(a,i){for(var o=0;o<i["!links"].length;++o){var c=i["!links"][o];Gr(a,440,L7(c)),c[1].Tooltip&&Gr(a,2048,O7(c))}delete i["!links"]}function OG(a,i){if(i){var o=0;i.forEach(function(c,u){++o<=256&&c&&Gr(a,125,z7(Mx(u,c),u))})}}function NG(a,i,o,c,u){var r=16+xp(u.cellXfs,i,u);if(i.v==null&&!i.bf){Gr(a,513,Tm(o,c,r));return}if(i.bf)Gr(a,6,sV(i,o,c,u,r));else switch(i.t){case"d":case"n":var _=i.t=="d"?fc(jl(i.v)):i.v;Gr(a,515,D7(o,c,_,r,u));break;case"b":case"e":Gr(a,517,M7(o,c,i.v,r,u,i.t));break;case"s":case"str":if(u.bookSST){var T=pT(u.Strings,i.v,u.revStrings);Gr(a,253,E7(o,c,T,r,u))}else Gr(a,516,A7(o,c,(i.v||"").slice(0,255),r,u));break;default:Gr(a,513,Tm(o,c,r))}}function BG(a,i,o){var c=dc(),u=o.SheetNames[a],r=o.Sheets[u]||{},_=(o||{}).Workbook||{},T=(_.Sheets||[])[a]||{},E=Array.isArray(r),k=i.biff==8,D,j="",B=[],P=ao(r["!ref"]||"A1"),ee=k?65536:16384;if(P.e.c>255||P.e.r>=ee){if(i.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");P.e.c=Math.min(P.e.c,255),P.e.r=Math.min(P.e.c,ee-1)}Gr(c,2057,cT(o,16,i)),Gr(c,13,Eu(1)),Gr(c,12,Eu(100)),Gr(c,15,zl(!0)),Gr(c,17,zl(!1)),Gr(c,16,wm(.001)),Gr(c,95,zl(!0)),Gr(c,42,zl(!1)),Gr(c,43,zl(!1)),Gr(c,130,Eu(1)),Gr(c,128,k7([0,0])),Gr(c,131,zl(!1)),Gr(c,132,zl(!1)),k&&OG(c,r["!cols"]),Gr(c,512,I7(P,i)),k&&(r["!links"]=[]);for(var G=P.s.r;G<=P.e.r;++G){j=el(G);for(var K=P.s.c;K<=P.e.c;++K){G===P.s.r&&(B[K]=vl(K)),D=B[K]+j;var J=E?(r[G]||[])[K]:r[D];J&&(NG(c,J,G,K,i),k&&J.l&&r["!links"].push([D,J.l]))}}var ne=T.CodeName||T.name||u;return k&&Gr(c,574,T7((_.Views||[])[0])),k&&(r["!merges"]||[]).length&&Gr(c,229,P7(r["!merges"])),k&&LG(c,r),Gr(c,442,SM(ne,i)),k&&FG(c,r),Gr(c,10),c.end()}function zG(a,i,o){var c=dc(),u=(a||{}).Workbook||{},r=u.Sheets||[],_=u.WBProps||{},T=o.biff==8,E=o.biff==5;if(Gr(c,2057,cT(a,5,o)),o.bookType=="xla"&&Gr(c,135),Gr(c,225,T?Eu(1200):null),Gr(c,193,u7(2)),E&&Gr(c,191),E&&Gr(c,192),Gr(c,226),Gr(c,92,y7("SheetJS",o)),Gr(c,66,Eu(T?1200:1252)),T&&Gr(c,353,Eu(0)),T&&Gr(c,448),Gr(c,317,j7(a.SheetNames.length)),T&&a.vbaraw&&Gr(c,211),T&&a.vbaraw){var k=_.CodeName||"ThisWorkbook";Gr(c,442,SM(k,o))}Gr(c,156,Eu(17)),Gr(c,25,zl(!1)),Gr(c,18,zl(!1)),Gr(c,19,Eu(0)),T&&Gr(c,431,zl(!1)),T&&Gr(c,444,Eu(0)),Gr(c,61,w7(o)),Gr(c,64,zl(!1)),Gr(c,141,Eu(0)),Gr(c,34,zl(H9(a)=="true")),Gr(c,14,zl(!0)),T&&Gr(c,439,zl(!1)),Gr(c,218,Eu(0)),DG(c,a,o),RG(c,a.SSF,o),PG(c,o),T&&Gr(c,352,zl(!1));var D=c.end(),j=dc();T&&Gr(j,140,N7()),T&&o.Strings&&EG(j,252,b7(o.Strings,o)),Gr(j,10);var B=j.end(),P=dc(),ee=0,G=0;for(G=0;G<a.SheetNames.length;++G)ee+=(T?12:11)+(T?2:1)*a.SheetNames[G].length;var K=D.length+ee+B.length;for(G=0;G<a.SheetNames.length;++G){var J=r[G]||{};Gr(P,133,x7({pos:K,hs:J.Hidden||0,dt:0,name:a.SheetNames[G]},o)),K+=i[G].length}var ne=P.end();if(ee!=ne.length)throw new Error("BS8 "+ee+" != "+ne.length);var he=[];return D.length&&he.push(D),ne.length&&he.push(ne),B.length&&he.push(B),Js(he)}function jG(a,i){var o=i||{},c=[];a&&!a.SSF&&(a.SSF=pc(Ro)),a&&a.SSF&&(Sx(),Tx(a.SSF),o.revssf=Ex(a.SSF),o.revssf[a.SSF[65535]]=0,o.ssf=a.SSF),o.Strings=[],o.Strings.Count=0,o.Strings.Unique=0,mT(o),o.cellXfs=[],xp(o.cellXfs,{},{revssf:{General:0}}),a.Props||(a.Props={});for(var u=0;u<a.SheetNames.length;++u)c[c.length]=BG(u,o,a);return c.unshift(zG(a,c,o)),Js(c)}function KM(a,i){for(var o=0;o<=a.SheetNames.length;++o){var c=a.Sheets[a.SheetNames[o]];if(!(!c||!c["!ref"])){var u=Xc(c["!ref"]);u.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+a.SheetNames[o]+"' extends beyond column IV (255).  Data may be lost.")}}var r=i||{};switch(r.biff||2){case 8:case 5:return jG(a,i);case 4:case 3:case 2:return MG(a,i)}throw new Error("invalid type "+r.bookType+" for BIFF")}function UG(a,i,o,c){for(var u=a["!merges"]||[],r=[],_=i.s.c;_<=i.e.c;++_){for(var T=0,E=0,k=0;k<u.length;++k)if(!(u[k].s.r>o||u[k].s.c>_)&&!(u[k].e.r<o||u[k].e.c<_)){if(u[k].s.r<o||u[k].s.c<_){T=-1;break}T=u[k].e.r-u[k].s.r+1,E=u[k].e.c-u[k].s.c+1;break}if(!(T<0)){var D=Ia({r:o,c:_}),j=c.dense?(a[o]||[])[_]:a[D],B=j&&j.v!=null&&(j.h||_z(j.w||(df(j),j.w)||""))||"",P={};T>1&&(P.rowspan=T),E>1&&(P.colspan=E),c.editable?B='<span contenteditable="true">'+B+"</span>":j&&(P["data-t"]=j&&j.t||"z",j.v!=null&&(P["data-v"]=j.v),j.z!=null&&(P["data-z"]=j.z),j.l&&(j.l.Target||"#").charAt(0)!="#"&&(B='<a href="'+j.l.Target+'">'+B+"</a>")),P.id=(c.id||"sjs")+"-"+D,r.push(Vr("td",B,P))}}var ee="<tr>";return ee+r.join("")+"</tr>"}var VG='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',GG="</body></html>";function HG(a,i,o){var c=[];return c.join("")+"<table"+(o&&o.id?' id="'+o.id+'"':"")+">"}function JM(a,i){var o=i||{},c=o.header!=null?o.header:VG,u=o.footer!=null?o.footer:GG,r=[c],_=Xc(a["!ref"]);o.dense=Array.isArray(a),r.push(HG(a,_,o));for(var T=_.s.r;T<=_.e.r;++T)r.push(UG(a,_,T,o));return r.push("</table>"+u),r.join("")}function QM(a,i,o){var c=o||{};cd!=null&&(c.dense=cd);var u=0,r=0;if(c.origin!=null)if(typeof c.origin=="number")u=c.origin;else{var _=typeof c.origin=="string"?Ps(c.origin):c.origin;u=_.r,r=_.c}var T=i.getElementsByTagName("tr"),E=Math.min(c.sheetRows||1e7,T.length),k={s:{r:0,c:0},e:{r:u,c:r}};if(a["!ref"]){var D=Xc(a["!ref"]);k.s.r=Math.min(k.s.r,D.s.r),k.s.c=Math.min(k.s.c,D.s.c),k.e.r=Math.max(k.e.r,D.e.r),k.e.c=Math.max(k.e.c,D.e.c),u==-1&&(k.e.r=u=D.e.r+1)}var j=[],B=0,P=a["!rows"]||(a["!rows"]=[]),ee=0,G=0,K=0,J=0,ne=0,he=0;for(a["!cols"]||(a["!cols"]=[]);ee<T.length&&G<E;++ee){var Me=T[ee];if(Mk(Me)){if(c.display)continue;P[G]={hidden:!0}}var Re=Me.children;for(K=J=0;K<Re.length;++K){var et=Re[K];if(!(c.display&&Mk(et))){var Te=et.hasAttribute("data-v")?et.getAttribute("data-v"):et.hasAttribute("v")?et.getAttribute("v"):bz(et.innerHTML),ge=et.getAttribute("data-z")||et.getAttribute("z");for(B=0;B<j.length;++B){var Ue=j[B];Ue.s.c==J+r&&Ue.s.r<G+u&&G+u<=Ue.e.r&&(J=Ue.e.c+1-r,B=-1)}he=+et.getAttribute("colspan")||1,((ne=+et.getAttribute("rowspan")||1)>1||he>1)&&j.push({s:{r:G+u,c:J+r},e:{r:G+u+(ne||1)-1,c:J+r+(he||1)-1}});var Ae={t:"s",v:Te},_e=et.getAttribute("data-t")||et.getAttribute("t")||"";Te!=null&&(Te.length==0?Ae.t=_e||"z":c.raw||Te.trim().length==0||_e=="s"||(Te==="TRUE"?Ae={t:"b",v:!0}:Te==="FALSE"?Ae={t:"b",v:!1}:isNaN(cf(Te))?isNaN(c1(Te).getDate())||(Ae={t:"d",v:jl(Te)},c.cellDates||(Ae={t:"n",v:fc(Ae.v)}),Ae.z=c.dateNF||Ro[14]):Ae={t:"n",v:cf(Te)})),Ae.z===void 0&&ge!=null&&(Ae.z=ge);var ve="",Qe=et.getElementsByTagName("A");if(Qe&&Qe.length)for(var Ce=0;Ce<Qe.length&&!(Qe[Ce].hasAttribute("href")&&(ve=Qe[Ce].getAttribute("href"),ve.charAt(0)!="#"));++Ce);ve&&ve.charAt(0)!="#"&&(Ae.l={Target:ve}),c.dense?(a[G+u]||(a[G+u]=[]),a[G+u][J+r]=Ae):a[Ia({c:J+r,r:G+u})]=Ae,k.e.c<J+r&&(k.e.c=J+r),J+=he}}++G}return j.length&&(a["!merges"]=(a["!merges"]||[]).concat(j)),k.e.r=Math.max(k.e.r,G-1+u),a["!ref"]=es(k),G>=E&&(a["!fullref"]=es((k.e.r=T.length-ee+G-1+u,k))),a}function eD(a,i){var o=i||{},c=o.dense?[]:{};return QM(c,a,i)}function WG(a,i){return Sm(eD(a,i),i)}function Mk(a){var i="",o=qG(a);return o&&(i=o(a).getPropertyValue("display")),i||(i=a.style&&a.style.display),i==="none"}function qG(a){return a.ownerDocument.defaultView&&typeof a.ownerDocument.defaultView.getComputedStyle=="function"?a.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var $G=function(){var a=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),i="<office:document-styles "+u1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+a+"</office:document-styles>";return function(){return ts+i}}(),Dk=function(){var a=function(r){return Ca(r).replace(/  +/g,function(_){return'<text:s text:c="'+_.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},i=`          <table:table-cell />
`,o=`          <table:covered-table-cell/>
`,c=function(r,_,T){var E=[];E.push('      <table:table table:name="'+Ca(_.SheetNames[T])+`" table:style-name="ta1">
`);var k=0,D=0,j=Xc(r["!ref"]||"A1"),B=r["!merges"]||[],P=0,ee=Array.isArray(r);if(r["!cols"])for(D=0;D<=j.e.c;++D)E.push("        <table:table-column"+(r["!cols"][D]?' table:style-name="co'+r["!cols"][D].ods+'"':"")+`></table:table-column>
`);var G="",K=r["!rows"]||[];for(k=0;k<j.s.r;++k)G=K[k]?' table:style-name="ro'+K[k].ods+'"':"",E.push("        <table:table-row"+G+`></table:table-row>
`);for(;k<=j.e.r;++k){for(G=K[k]?' table:style-name="ro'+K[k].ods+'"':"",E.push("        <table:table-row"+G+`>
`),D=0;D<j.s.c;++D)E.push(i);for(;D<=j.e.c;++D){var J=!1,ne={},he="";for(P=0;P!=B.length;++P)if(!(B[P].s.c>D)&&!(B[P].s.r>k)&&!(B[P].e.c<D)&&!(B[P].e.r<k)){(B[P].s.c!=D||B[P].s.r!=k)&&(J=!0),ne["table:number-columns-spanned"]=B[P].e.c-B[P].s.c+1,ne["table:number-rows-spanned"]=B[P].e.r-B[P].s.r+1;break}if(J){E.push(o);continue}var Me=Ia({r:k,c:D}),Re=ee?(r[k]||[])[D]:r[Me];if(Re&&Re.f&&(ne["table:formula"]=Ca(fV(Re.f)),Re.F&&Re.F.slice(0,Me.length)==Me)){var et=Xc(Re.F);ne["table:number-matrix-columns-spanned"]=et.e.c-et.s.c+1,ne["table:number-matrix-rows-spanned"]=et.e.r-et.s.r+1}if(!Re){E.push(i);continue}switch(Re.t){case"b":he=Re.v?"TRUE":"FALSE",ne["office:value-type"]="boolean",ne["office:boolean-value"]=Re.v?"true":"false";break;case"n":he=Re.w||String(Re.v||0),ne["office:value-type"]="float",ne["office:value"]=Re.v||0;break;case"s":case"str":he=Re.v==null?"":Re.v,ne["office:value-type"]="string";break;case"d":he=Re.w||jl(Re.v).toISOString(),ne["office:value-type"]="date",ne["office:date-value"]=jl(Re.v).toISOString(),ne["table:style-name"]="ce1";break;default:E.push(i);continue}var Te=a(he);if(Re.l&&Re.l.Target){var ge=Re.l.Target;ge=ge.charAt(0)=="#"?"#"+pV(ge.slice(1)):ge,ge.charAt(0)!="#"&&!ge.match(/^\w+:/)&&(ge="../"+ge),Te=Vr("text:a",Te,{"xlink:href":ge.replace(/&/g,"&amp;")})}E.push("          "+Vr("table:table-cell",Vr("text:p",Te,{}),ne)+`
`)}E.push(`        </table:table-row>
`)}return E.push(`      </table:table>
`),E.join("")},u=function(r,_){r.push(` <office:automatic-styles>
`),r.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),r.push(`   <number:month number:style="long"/>
`),r.push(`   <number:text>/</number:text>
`),r.push(`   <number:day number:style="long"/>
`),r.push(`   <number:text>/</number:text>
`),r.push(`   <number:year/>
`),r.push(`  </number:date-style>
`);var T=0;_.SheetNames.map(function(k){return _.Sheets[k]}).forEach(function(k){if(k&&k["!cols"]){for(var D=0;D<k["!cols"].length;++D)if(k["!cols"][D]){var j=k["!cols"][D];if(j.width==null&&j.wpx==null&&j.wch==null)continue;uT(j),j.ods=T;var B=k["!cols"][D].wpx+"px";r.push('  <style:style style:name="co'+T+`" style:family="table-column">
`),r.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+B+`"/>
`),r.push(`  </style:style>
`),++T}}});var E=0;_.SheetNames.map(function(k){return _.Sheets[k]}).forEach(function(k){if(k&&k["!rows"]){for(var D=0;D<k["!rows"].length;++D)if(k["!rows"][D]){k["!rows"][D].ods=E;var j=k["!rows"][D].hpx+"px";r.push('  <style:style style:name="ro'+E+`" style:family="table-row">
`),r.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+j+`"/>
`),r.push(`  </style:style>
`),++E}}}),r.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),r.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),r.push(`  </style:style>
`),r.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),r.push(` </office:automatic-styles>
`)};return function(_,T){var E=[ts],k=u1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),D=u1({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});T.bookType=="fods"?(E.push("<office:document"+k+D+`>
`),E.push(mM().replace(/office:document-meta/g,"office:meta"))):E.push("<office:document-content"+k+`>
`),u(E,_),E.push(`  <office:body>
`),E.push(`    <office:spreadsheet>
`);for(var j=0;j!=_.SheetNames.length;++j)E.push(c(_.Sheets[_.SheetNames[j]],_,j,T));return E.push(`    </office:spreadsheet>
`),E.push(`  </office:body>
`),T.bookType=="fods"?E.push("</office:document>"):E.push("</office:document-content>"),E.join("")}}();function tD(a,i){if(i.bookType=="fods")return Dk(a,i);var o=Z5(),c="",u=[],r=[];return c="mimetype",vn(o,c,"application/vnd.oasis.opendocument.spreadsheet"),c="content.xml",vn(o,c,Dk(a,i)),u.push([c,"text/xml"]),r.push([c,"ContentFile"]),c="styles.xml",vn(o,c,$G(a,i)),u.push([c,"text/xml"]),r.push([c,"StylesFile"]),c="meta.xml",vn(o,c,ts+mM()),u.push([c,"text/xml"]),r.push([c,"MetadataFile"]),c="manifest.rdf",vn(o,c,a7(r)),u.push([c,"application/rdf+xml"]),c="META-INF/manifest.xml",vn(o,c,i7(u)),o}function xx(a){return new DataView(a.buffer,a.byteOffset,a.byteLength)}function XG(a){return typeof TextEncoder<"u"?new TextEncoder().encode(a):mh(sf(a))}function ZG(a,i){e:for(var o=0;o<=a.length-i.length;++o){for(var c=0;c<i.length;++c)if(a[o+c]!=i[c])continue e;return!0}return!1}function yp(a){var i=a.reduce(function(u,r){return u+r.length},0),o=new Uint8Array(i),c=0;return a.forEach(function(u){o.set(u,c),c+=u.length}),o}function YG(a,i,o){var c=Math.floor(o==0?0:Math.LOG10E*Math.log(Math.abs(o)))+6176-20,u=o/Math.pow(10,c-6176);a[i+15]|=c>>7,a[i+14]|=(c&127)<<1;for(var r=0;u>=1;++r,u/=256)a[i+r]=u&255;a[i+15]|=o>=0?0:128}function h1(a,i){var o=i?i[0]:0,c=a[o]&127;e:if(a[o++]>=128&&(c|=(a[o]&127)<<7,a[o++]<128||(c|=(a[o]&127)<<14,a[o++]<128)||(c|=(a[o]&127)<<21,a[o++]<128)||(c+=(a[o]&127)*Math.pow(2,28),++o,a[o++]<128)||(c+=(a[o]&127)*Math.pow(2,35),++o,a[o++]<128)||(c+=(a[o]&127)*Math.pow(2,42),++o,a[o++]<128)))break e;return i&&(i[0]=o),c}function Ea(a){var i=new Uint8Array(7);i[0]=a&127;var o=1;e:if(a>127){if(i[o-1]|=128,i[o]=a>>7&127,++o,a<=16383||(i[o-1]|=128,i[o]=a>>14&127,++o,a<=2097151)||(i[o-1]|=128,i[o]=a>>21&127,++o,a<=268435455)||(i[o-1]|=128,i[o]=a/256>>>21&127,++o,a<=34359738367)||(i[o-1]|=128,i[o]=a/65536>>>21&127,++o,a<=4398046511103))break e;i[o-1]|=128,i[o]=a/16777216>>>21&127,++o}return i.slice(0,o)}function og(a){var i=0,o=a[i]&127;e:if(a[i++]>=128){if(o|=(a[i]&127)<<7,a[i++]<128||(o|=(a[i]&127)<<14,a[i++]<128)||(o|=(a[i]&127)<<21,a[i++]<128))break e;o|=(a[i]&127)<<28}return o}function fs(a){for(var i=[],o=[0];o[0]<a.length;){var c=o[0],u=h1(a,o),r=u&7;u=Math.floor(u/8);var _=0,T;if(u==0)break;switch(r){case 0:{for(var E=o[0];a[o[0]++]>=128;);T=a.slice(E,o[0])}break;case 5:_=4,T=a.slice(o[0],o[0]+_),o[0]+=_;break;case 1:_=8,T=a.slice(o[0],o[0]+_),o[0]+=_;break;case 2:_=h1(a,o),T=a.slice(o[0],o[0]+_),o[0]+=_;break;case 3:case 4:default:throw new Error("PB Type ".concat(r," for Field ").concat(u," at offset ").concat(c))}var k={data:T,type:r};i[u]==null?i[u]=[k]:i[u].push(k)}return i}function Ys(a){var i=[];return a.forEach(function(o,c){o.forEach(function(u){u.data&&(i.push(Ea(c*8+u.type)),u.type==2&&i.push(Ea(u.data.length)),i.push(u.data))})}),yp(i)}function fh(a){for(var i,o=[],c=[0];c[0]<a.length;){var u=h1(a,c),r=fs(a.slice(c[0],c[0]+u));c[0]+=u;var _={id:og(r[1][0].data),messages:[]};r[2].forEach(function(T){var E=fs(T.data),k=og(E[3][0].data);_.messages.push({meta:E,data:a.slice(c[0],c[0]+k)}),c[0]+=k}),(i=r[3])!=null&&i[0]&&(_.merge=og(r[3][0].data)>>>0>0),o.push(_)}return o}function J0(a){var i=[];return a.forEach(function(o){var c=[];c[1]=[{data:Ea(o.id),type:0}],c[2]=[],o.merge!=null&&(c[3]=[{data:Ea(+!!o.merge),type:0}]);var u=[];o.messages.forEach(function(_){u.push(_.data),_.meta[3]=[{type:0,data:Ea(_.data.length)}],c[2].push({data:Ys(_.meta),type:2})});var r=Ys(c);i.push(Ea(r.length)),i.push(r),u.forEach(function(_){return i.push(_)})}),yp(i)}function KG(a,i){if(a!=0)throw new Error("Unexpected Snappy chunk type ".concat(a));for(var o=[0],c=h1(i,o),u=[];o[0]<i.length;){var r=i[o[0]]&3;if(r==0){var _=i[o[0]++]>>2;if(_<60)++_;else{var T=_-59;_=i[o[0]],T>1&&(_|=i[o[0]+1]<<8),T>2&&(_|=i[o[0]+2]<<16),T>3&&(_|=i[o[0]+3]<<24),_>>>=0,_++,o[0]+=T}u.push(i.slice(o[0],o[0]+_)),o[0]+=_;continue}else{var E=0,k=0;if(r==1?(k=(i[o[0]]>>2&7)+4,E=(i[o[0]++]&224)<<3,E|=i[o[0]++]):(k=(i[o[0]++]>>2)+1,r==2?(E=i[o[0]]|i[o[0]+1]<<8,o[0]+=2):(E=(i[o[0]]|i[o[0]+1]<<8|i[o[0]+2]<<16|i[o[0]+3]<<24)>>>0,o[0]+=4)),u=[yp(u)],E==0)throw new Error("Invalid offset 0");if(E>u[0].length)throw new Error("Invalid offset beyond length");if(k>=E)for(u.push(u[0].slice(-E)),k-=E;k>=u[u.length-1].length;)u.push(u[u.length-1]),k-=u[u.length-1].length;u.push(u[0].slice(-E,-E+k))}}var D=yp(u);if(D.length!=c)throw new Error("Unexpected length: ".concat(D.length," != ").concat(c));return D}function ph(a){for(var i=[],o=0;o<a.length;){var c=a[o++],u=a[o]|a[o+1]<<8|a[o+2]<<16;o+=3,i.push(KG(c,a.slice(o,o+u))),o+=u}if(o!==a.length)throw new Error("data is not a valid framed stream!");return yp(i)}function Q0(a){for(var i=[],o=0;o<a.length;){var c=Math.min(a.length-o,268435455),u=new Uint8Array(4);i.push(u);var r=Ea(c),_=r.length;i.push(r),c<=60?(_++,i.push(new Uint8Array([c-1<<2]))):c<=256?(_+=2,i.push(new Uint8Array([240,c-1&255]))):c<=65536?(_+=3,i.push(new Uint8Array([244,c-1&255,c-1>>8&255]))):c<=16777216?(_+=4,i.push(new Uint8Array([248,c-1&255,c-1>>8&255,c-1>>16&255]))):c<=4294967296&&(_+=5,i.push(new Uint8Array([252,c-1&255,c-1>>8&255,c-1>>16&255,c-1>>>24&255]))),i.push(a.slice(o,o+c)),_+=c,u[0]=0,u[1]=_&255,u[2]=_>>8&255,u[3]=_>>16&255,o+=c}return yp(i)}function j5(a,i){var o=new Uint8Array(32),c=xx(o),u=12,r=0;switch(o[0]=5,a.t){case"n":o[1]=2,YG(o,u,a.v),r|=1,u+=16;break;case"b":o[1]=6,c.setFloat64(u,a.v?1:0,!0),r|=2,u+=8;break;case"s":if(i.indexOf(a.v)==-1)throw new Error("Value ".concat(a.v," missing from SST!"));o[1]=3,c.setUint32(u,i.indexOf(a.v),!0),r|=8,u+=4;break;default:throw"unsupported cell type "+a.t}return c.setUint32(8,r,!0),o.slice(0,u)}function U5(a,i){var o=new Uint8Array(32),c=xx(o),u=12,r=0;switch(o[0]=3,a.t){case"n":o[2]=2,c.setFloat64(u,a.v,!0),r|=32,u+=8;break;case"b":o[2]=6,c.setFloat64(u,a.v?1:0,!0),r|=32,u+=8;break;case"s":if(i.indexOf(a.v)==-1)throw new Error("Value ".concat(a.v," missing from SST!"));o[2]=3,c.setUint32(u,i.indexOf(a.v),!0),r|=16,u+=4;break;default:throw"unsupported cell type "+a.t}return c.setUint32(4,r,!0),o.slice(0,u)}function pp(a){var i=fs(a);return h1(i[1][0].data)}function JG(a,i,o){var c,u,r,_;if(!((c=a[6])!=null&&c[0])||!((u=a[7])!=null&&u[0]))throw"Mutation only works on post-BNC storages!";var T=((_=(r=a[8])==null?void 0:r[0])==null?void 0:_.data)&&og(a[8][0].data)>0||!1;if(T)throw"Math only works with normal offsets";for(var E=0,k=xx(a[7][0].data),D=0,j=[],B=xx(a[4][0].data),P=0,ee=[],G=0;G<i.length;++G){if(i[G]==null){k.setUint16(G*2,65535,!0),B.setUint16(G*2,65535);continue}k.setUint16(G*2,D,!0),B.setUint16(G*2,P,!0);var K,J;switch(typeof i[G]){case"string":K=j5({t:"s",v:i[G]},o),J=U5({t:"s",v:i[G]},o);break;case"number":K=j5({t:"n",v:i[G]},o),J=U5({t:"n",v:i[G]},o);break;case"boolean":K=j5({t:"b",v:i[G]},o),J=U5({t:"b",v:i[G]},o);break;default:throw new Error("Unsupported value "+i[G])}j.push(K),D+=K.length,ee.push(J),P+=J.length,++E}for(a[2][0].data=Ea(E);G<a[7][0].data.length/2;++G)k.setUint16(G*2,65535,!0),B.setUint16(G*2,65535,!0);return a[6][0].data=yp(j),a[3][0].data=yp(ee),E}function QG(a,i){if(!i||!i.numbers)throw new Error("Must pass a `numbers` option -- check the README");var o=a.Sheets[a.SheetNames[0]];a.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var c=Xc(o["!ref"]);c.s.r=c.s.c=0;var u=!1;c.e.c>9&&(u=!0,c.e.c=9),c.e.r>49&&(u=!0,c.e.r=49),u&&console.error("The Numbers writer is currently limited to ".concat(es(c)));var r=bx(o,{range:c,header:1}),_=["~Sh33tJ5~"];r.forEach(function(pe){return pe.forEach(function(Ie){typeof Ie=="string"&&_.push(Ie)})});var T={},E=[],k=La.read(i.numbers,{type:"base64"});k.FileIndex.map(function(pe,Ie){return[pe,k.FullPaths[Ie]]}).forEach(function(pe){var Ie=pe[0],Ve=pe[1];if(Ie.type==2&&Ie.name.match(/\.iwa/)){var gt=Ie.content,mt=ph(gt),wt=fh(mt);wt.forEach(function(Pt){E.push(Pt.id),T[Pt.id]={deps:[],location:Ve,type:og(Pt.messages[0].meta[1][0].data)}})}}),E.sort(function(pe,Ie){return pe-Ie});var D=E.filter(function(pe){return pe>1}).map(function(pe){return[pe,Ea(pe)]});k.FileIndex.map(function(pe,Ie){return[pe,k.FullPaths[Ie]]}).forEach(function(pe){var Ie=pe[0],Ve=pe[1];if(Ie.name.match(/\.iwa/)){var gt=fh(ph(Ie.content));gt.forEach(function(mt){mt.messages.forEach(function(wt){D.forEach(function(Pt){mt.messages.some(function(fr){return og(fr.meta[1][0].data)!=11006&&ZG(fr.data,Pt[1])})&&T[Pt[0]].deps.push(mt.id)})})})}});function j(){for(var pe=927262;pe<2e6;++pe)if(!T[pe])return pe;throw new Error("Too many messages")}for(var B=La.find(k,T[1].location),P=fh(ph(B.content)),ee,G=0;G<P.length;++G){var K=P[G];K.id==1&&(ee=K)}var J=pp(fs(ee.messages[0].data)[1][0].data);for(B=La.find(k,T[J].location),P=fh(ph(B.content)),G=0;G<P.length;++G)K=P[G],K.id==J&&(ee=K);for(J=pp(fs(ee.messages[0].data)[2][0].data),B=La.find(k,T[J].location),P=fh(ph(B.content)),G=0;G<P.length;++G)K=P[G],K.id==J&&(ee=K);for(J=pp(fs(ee.messages[0].data)[2][0].data),B=La.find(k,T[J].location),P=fh(ph(B.content)),G=0;G<P.length;++G)K=P[G],K.id==J&&(ee=K);var ne=fs(ee.messages[0].data);{ne[6][0].data=Ea(c.e.r+1),ne[7][0].data=Ea(c.e.c+1);var he=pp(ne[46][0].data),Me=La.find(k,T[he].location),Re=fh(ph(Me.content));{for(var et=0;et<Re.length&&Re[et].id!=he;++et);if(Re[et].id!=he)throw"Bad ColumnRowUIDMapArchive";var Te=fs(Re[et].messages[0].data);Te[1]=[],Te[2]=[],Te[3]=[];for(var ge=0;ge<=c.e.c;++ge){var Ue=[];Ue[1]=Ue[2]=[{type:0,data:Ea(ge+420690)}],Te[1].push({type:2,data:Ys(Ue)}),Te[2].push({type:0,data:Ea(ge)}),Te[3].push({type:0,data:Ea(ge)})}Te[4]=[],Te[5]=[],Te[6]=[];for(var Ae=0;Ae<=c.e.r;++Ae)Ue=[],Ue[1]=Ue[2]=[{type:0,data:Ea(Ae+726270)}],Te[4].push({type:2,data:Ys(Ue)}),Te[5].push({type:0,data:Ea(Ae)}),Te[6].push({type:0,data:Ea(Ae)});Re[et].messages[0].data=Ys(Te)}Me.content=Q0(J0(Re)),Me.size=Me.content.length,delete ne[46];var _e=fs(ne[4][0].data);{_e[7][0].data=Ea(c.e.r+1);var ve=fs(_e[1][0].data),Qe=pp(ve[2][0].data);Me=La.find(k,T[Qe].location),Re=fh(ph(Me.content));{if(Re[0].id!=Qe)throw"Bad HeaderStorageBucket";var Ce=fs(Re[0].messages[0].data);for(Ae=0;Ae<r.length;++Ae){var Ye=fs(Ce[2][0].data);Ye[1][0].data=Ea(Ae),Ye[4][0].data=Ea(r[Ae].length),Ce[2][Ae]={type:Ce[2][0].type,data:Ys(Ye)}}Re[0].messages[0].data=Ys(Ce)}Me.content=Q0(J0(Re)),Me.size=Me.content.length;var ut=pp(_e[2][0].data);Me=La.find(k,T[ut].location),Re=fh(ph(Me.content));{if(Re[0].id!=ut)throw"Bad HeaderStorageBucket";for(Ce=fs(Re[0].messages[0].data),ge=0;ge<=c.e.c;++ge)Ye=fs(Ce[2][0].data),Ye[1][0].data=Ea(ge),Ye[4][0].data=Ea(c.e.r+1),Ce[2][ge]={type:Ce[2][0].type,data:Ys(Ye)};Re[0].messages[0].data=Ys(Ce)}Me.content=Q0(J0(Re)),Me.size=Me.content.length;var st=pp(_e[4][0].data);(function(){for(var pe=La.find(k,T[st].location),Ie=fh(ph(pe.content)),Ve,gt=0;gt<Ie.length;++gt){var mt=Ie[gt];mt.id==st&&(Ve=mt)}var wt=fs(Ve.messages[0].data);{wt[3]=[];var Pt=[];_.forEach(function(Rr,Fr){Pt[1]=[{type:0,data:Ea(Fr)}],Pt[2]=[{type:0,data:Ea(1)}],Pt[3]=[{type:2,data:XG(Rr)}],wt[3].push({type:2,data:Ys(Pt)})})}Ve.messages[0].data=Ys(wt);var fr=J0(Ie),xr=Q0(fr);pe.content=xr,pe.size=pe.content.length})();var pt=fs(_e[3][0].data);{var Tt=pt[1][0];delete pt[2];var ht=fs(Tt.data);{var Wt=pp(ht[2][0].data);(function(){for(var pe=La.find(k,T[Wt].location),Ie=fh(ph(pe.content)),Ve,gt=0;gt<Ie.length;++gt){var mt=Ie[gt];mt.id==Wt&&(Ve=mt)}var wt=fs(Ve.messages[0].data);{delete wt[6],delete pt[7];var Pt=new Uint8Array(wt[5][0].data);wt[5]=[];for(var fr=0,xr=0;xr<=c.e.r;++xr){var Rr=fs(Pt);fr+=JG(Rr,r[xr],_),Rr[1][0].data=Ea(xr),wt[5].push({data:Ys(Rr),type:2})}wt[1]=[{type:0,data:Ea(c.e.c+1)}],wt[2]=[{type:0,data:Ea(c.e.r+1)}],wt[3]=[{type:0,data:Ea(fr)}],wt[4]=[{type:0,data:Ea(c.e.r+1)}]}Ve.messages[0].data=Ys(wt);var Fr=J0(Ie),$t=Q0(Fr);pe.content=$t,pe.size=pe.content.length})()}Tt.data=Ys(ht)}_e[3][0].data=Ys(pt)}ne[4][0].data=Ys(_e)}ee.messages[0].data=Ys(ne);var re=J0(P),xe=Q0(re);return B.content=xe,B.size=B.content.length,k}function eH(a){return function(o){for(var c=0;c!=a.length;++c){var u=a[c];o[u[0]]===void 0&&(o[u[0]]=u[1]),u[2]==="n"&&(o[u[0]]=Number(o[u[0]]))}}}function mT(a){eH([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(a)}function tH(a,i){return i.bookType=="ods"?tD(a,i):i.bookType=="numbers"?QG(a,i):i.bookType=="xlsb"?rH(a,i):iH(a,i)}function rH(a,i){tg=1024,a&&!a.SSF&&(a.SSF=pc(Ro)),a&&a.SSF&&(Sx(),Tx(a.SSF),i.revssf=Ex(a.SSF),i.revssf[a.SSF[65535]]=0,i.ssf=a.SSF),i.rels={},i.wbrels={},i.Strings=[],i.Strings.Count=0,i.Strings.Unique=0,a1?i.revStrings=new Map:(i.revStrings={},i.revStrings.foo=[],delete i.revStrings.foo);var o=i.bookType=="xlsb"?"bin":"xml",c=NM.indexOf(i.bookType)>-1,u=dM();mT(i=i||{});var r=Z5(),_="",T=0;if(i.cellXfs=[],xp(i.cellXfs,{},{revssf:{General:0}}),a.Props||(a.Props={}),_="docProps/core.xml",vn(r,_,gM(a.Props,i)),u.coreprops.push(_),Aa(i.rels,2,_,Kn.CORE_PROPS),_="docProps/app.xml",!(a.Props&&a.Props.SheetNames))if(!a.Workbook||!a.Workbook.Sheets)a.Props.SheetNames=a.SheetNames;else{for(var E=[],k=0;k<a.SheetNames.length;++k)(a.Workbook.Sheets[k]||{}).Hidden!=2&&E.push(a.SheetNames[k]);a.Props.SheetNames=E}for(a.Props.Worksheets=a.Props.SheetNames.length,vn(r,_,vM(a.Props,i)),u.extprops.push(_),Aa(i.rels,3,_,Kn.EXT_PROPS),a.Custprops!==a.Props&&tl(a.Custprops||{}).length>0&&(_="docProps/custom.xml",vn(r,_,yM(a.Custprops,i)),u.custprops.push(_),Aa(i.rels,4,_,Kn.CUST_PROPS)),T=1;T<=a.SheetNames.length;++T){var D={"!id":{}},j=a.Sheets[a.SheetNames[T-1]],B=(j||{})["!type"]||"sheet";switch(B){case"chart":default:_="xl/worksheets/sheet"+T+"."+o,vn(r,_,aG(T-1,_,i,a,D)),u.sheets.push(_),Aa(i.wbrels,-1,"worksheets/sheet"+T+"."+o,Kn.WS[0])}if(j){var P=j["!comments"],ee=!1,G="";P&&P.length>0&&(G="xl/comments"+T+"."+o,vn(r,G,lG(P,G,i)),u.comments.push(G),Aa(D,-1,"../comments"+T+"."+o,Kn.CMNT),ee=!0),j["!legacy"]&&ee&&vn(r,"xl/drawings/vmlDrawing"+T+".vml",LM(T,j["!comments"])),delete j["!comments"],delete j["!legacy"]}D["!id"].rId1&&vn(r,pM(_),ng(D))}return i.Strings!=null&&i.Strings.length>0&&(_="xl/sharedStrings."+o,vn(r,_,sG(i.Strings,_,i)),u.strs.push(_),Aa(i.wbrels,-1,"sharedStrings."+o,Kn.SST)),_="xl/workbook."+o,vn(r,_,nG(a,_,i)),u.workbooks.push(_),Aa(i.rels,1,_,Kn.WB),_="xl/theme/theme1.xml",vn(r,_,FM(a.Themes,i)),u.themes.push(_),Aa(i.wbrels,-1,"theme/theme1.xml",Kn.THEME),_="xl/styles."+o,vn(r,_,oG(a,_,i)),u.styles.push(_),Aa(i.wbrels,-1,"styles."+o,Kn.STY),a.vbaraw&&c&&(_="xl/vbaProject.bin",vn(r,_,a.vbaraw),u.vba.push(_),Aa(i.wbrels,-1,"vbaProject.bin",Kn.VBA)),_="xl/metadata."+o,vn(r,_,cG(_)),u.metadata.push(_),Aa(i.wbrels,-1,"metadata."+o,Kn.XLMETA),vn(r,"[Content_Types].xml",fM(u,i)),vn(r,"_rels/.rels",ng(i.rels)),vn(r,"xl/_rels/workbook."+o+".rels",ng(i.wbrels)),delete i.revssf,delete i.ssf,r}function iH(a,i){tg=1024,a&&!a.SSF&&(a.SSF=pc(Ro)),a&&a.SSF&&(Sx(),Tx(a.SSF),i.revssf=Ex(a.SSF),i.revssf[a.SSF[65535]]=0,i.ssf=a.SSF),i.rels={},i.wbrels={},i.Strings=[],i.Strings.Count=0,i.Strings.Unique=0,a1?i.revStrings=new Map:(i.revStrings={},i.revStrings.foo=[],delete i.revStrings.foo);var o="xml",c=NM.indexOf(i.bookType)>-1,u=dM();mT(i=i||{});var r=Z5(),_="",T=0;if(i.cellXfs=[],xp(i.cellXfs,{},{revssf:{General:0}}),a.Props||(a.Props={}),_="docProps/core.xml",vn(r,_,gM(a.Props,i)),u.coreprops.push(_),Aa(i.rels,2,_,Kn.CORE_PROPS),_="docProps/app.xml",!(a.Props&&a.Props.SheetNames))if(!a.Workbook||!a.Workbook.Sheets)a.Props.SheetNames=a.SheetNames;else{for(var E=[],k=0;k<a.SheetNames.length;++k)(a.Workbook.Sheets[k]||{}).Hidden!=2&&E.push(a.SheetNames[k]);a.Props.SheetNames=E}a.Props.Worksheets=a.Props.SheetNames.length,vn(r,_,vM(a.Props,i)),u.extprops.push(_),Aa(i.rels,3,_,Kn.EXT_PROPS),a.Custprops!==a.Props&&tl(a.Custprops||{}).length>0&&(_="docProps/custom.xml",vn(r,_,yM(a.Custprops,i)),u.custprops.push(_),Aa(i.rels,4,_,Kn.CUST_PROPS));var D=["SheetJ5"];for(i.tcid=0,T=1;T<=a.SheetNames.length;++T){var j={"!id":{}},B=a.Sheets[a.SheetNames[T-1]],P=(B||{})["!type"]||"sheet";switch(P){case"chart":default:_="xl/worksheets/sheet"+T+"."+o,vn(r,_,qM(T-1,i,a,j)),u.sheets.push(_),Aa(i.wbrels,-1,"worksheets/sheet"+T+"."+o,Kn.WS[0])}if(B){var ee=B["!comments"],G=!1,K="";if(ee&&ee.length>0){var J=!1;ee.forEach(function(ne){ne[1].forEach(function(he){he.T==!0&&(J=!0)})}),J&&(K="xl/threadedComments/threadedComment"+T+"."+o,vn(r,K,Pj(ee,D,i)),u.threadedcomments.push(K),Aa(j,-1,"../threadedComments/threadedComment"+T+"."+o,Kn.TCMNT)),K="xl/comments"+T+"."+o,vn(r,K,OM(ee,i)),u.comments.push(K),Aa(j,-1,"../comments"+T+"."+o,Kn.CMNT),G=!0}B["!legacy"]&&G&&vn(r,"xl/drawings/vmlDrawing"+T+".vml",LM(T,B["!comments"])),delete B["!comments"],delete B["!legacy"]}j["!id"].rId1&&vn(r,pM(_),ng(j))}return i.Strings!=null&&i.Strings.length>0&&(_="xl/sharedStrings."+o,vn(r,_,CM(i.Strings,i)),u.strs.push(_),Aa(i.wbrels,-1,"sharedStrings."+o,Kn.SST)),_="xl/workbook."+o,vn(r,_,ZM(a,i)),u.workbooks.push(_),Aa(i.rels,1,_,Kn.WB),_="xl/theme/theme1.xml",vn(r,_,FM(a.Themes,i)),u.themes.push(_),Aa(i.wbrels,-1,"theme/theme1.xml",Kn.THEME),_="xl/styles."+o,vn(r,_,DM(a,i)),u.styles.push(_),Aa(i.wbrels,-1,"styles."+o,Kn.STY),a.vbaraw&&c&&(_="xl/vbaProject.bin",vn(r,_,a.vbaraw),u.vba.push(_),Aa(i.wbrels,-1,"vbaProject.bin",Kn.VBA)),_="xl/metadata."+o,vn(r,_,PM()),u.metadata.push(_),Aa(i.wbrels,-1,"metadata."+o,Kn.XLMETA),D.length>1&&(_="xl/persons/person.xml",vn(r,_,Lj(D,i)),u.people.push(_),Aa(i.wbrels,-1,"persons/person.xml",Kn.PEOPLE)),vn(r,"[Content_Types].xml",fM(u,i)),vn(r,"_rels/.rels",ng(i.rels)),vn(r,"xl/_rels/workbook."+o+".rels",ng(i.wbrels)),delete i.revssf,delete i.ssf,r}function nH(a,i){var o="";switch((i||{}).type||"base64"){case"buffer":return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]];case"base64":o=hf(a.slice(0,12));break;case"binary":o=a;break;case"array":return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]];default:throw new Error("Unrecognized type "+(i&&i.type||"undefined"))}return[o.charCodeAt(0),o.charCodeAt(1),o.charCodeAt(2),o.charCodeAt(3),o.charCodeAt(4),o.charCodeAt(5),o.charCodeAt(6),o.charCodeAt(7)]}function rD(a,i){switch(i.type){case"base64":case"binary":break;case"buffer":case"array":i.type="";break;case"file":return p1(i.file,La.write(a,{type:oa?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+i.bookType+"' files");default:throw new Error("Unrecognized type "+i.type)}return La.write(a,i)}function aH(a,i){var o=pc(i||{}),c=tH(a,o);return oH(c,o)}function oH(a,i){var o={},c=oa?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(i.compression&&(o.compression="DEFLATE"),i.password)o.type=c;else switch(i.type){case"base64":o.type="base64";break;case"binary":o.type="string";break;case"string":throw new Error("'string' output type invalid for '"+i.bookType+"' files");case"buffer":case"file":o.type=c;break;default:throw new Error("Unrecognized type "+i.type)}var u=a.FullPaths?La.write(a,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[o.type]||o.type,compression:!!i.compression}):a.generate(o);if(typeof Deno<"u"&&typeof u=="string"){if(i.type=="binary"||i.type=="base64")return u;u=new Uint8Array(wx(u))}return i.password&&typeof encrypt_agile<"u"?rD(encrypt_agile(u,i.password),i):i.type==="file"?p1(i.file,u):i.type=="string"?t1(u):u}function sH(a,i){var o=i||{},c=TG(a,o);return rD(c,o)}function ld(a,i,o){o||(o="");var c=o+a;switch(i.type){case"base64":return l1(sf(c));case"binary":return sf(c);case"string":return a;case"file":return p1(i.file,c,"utf8");case"buffer":return oa?ff(c,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(c):ld(c,{type:"binary"}).split("").map(function(u){return u.charCodeAt(0)})}throw new Error("Unrecognized type "+i.type)}function lH(a,i){switch(i.type){case"base64":return l1(a);case"binary":return a;case"string":return a;case"file":return p1(i.file,a,"binary");case"buffer":return oa?ff(a,"binary"):a.split("").map(function(o){return o.charCodeAt(0)})}throw new Error("Unrecognized type "+i.type)}function lx(a,i){switch(i.type){case"string":case"base64":case"binary":for(var o="",c=0;c<a.length;++c)o+=String.fromCharCode(a[c]);return i.type=="base64"?l1(o):i.type=="string"?t1(o):o;case"file":return p1(i.file,a);case"buffer":return a;default:throw new Error("Unrecognized type "+i.type)}}function iD(a,i){PB(),$9(a);var o=pc(i||{});if(o.cellStyles&&(o.cellNF=!0,o.sheetStubs=!0),o.type=="array"){o.type="binary";var c=iD(a,o);return o.type="array",wx(c)}var u=0;if(o.sheet&&(typeof o.sheet=="number"?u=o.sheet:u=a.SheetNames.indexOf(o.sheet),!a.SheetNames[u]))throw new Error("Sheet not found: "+o.sheet+" : "+typeof o.sheet);switch(o.bookType||"xlsb"){case"xml":case"xlml":return ld(bG(a,o),o);case"slk":case"sylk":return ld(H7.from_sheet(a.Sheets[a.SheetNames[u]],o),o);case"htm":case"html":return ld(JM(a.Sheets[a.SheetNames[u]],o),o);case"txt":return lH(aD(a.Sheets[a.SheetNames[u]],o),o);case"csv":return ld(gT(a.Sheets[a.SheetNames[u]],o),o,"\uFEFF");case"dif":return ld(W7.from_sheet(a.Sheets[a.SheetNames[u]],o),o);case"dbf":return lx(G7.from_sheet(a.Sheets[a.SheetNames[u]],o),o);case"prn":return ld(q7.from_sheet(a.Sheets[a.SheetNames[u]],o),o);case"rtf":return ld(Q7.from_sheet(a.Sheets[a.SheetNames[u]],o),o);case"eth":return ld(AM.from_sheet(a.Sheets[a.SheetNames[u]],o),o);case"fods":return ld(tD(a,o),o);case"wk1":return lx(Sk.sheet_to_wk1(a.Sheets[a.SheetNames[u]],o),o);case"wk3":return lx(Sk.book_to_wk3(a,o),o);case"biff2":o.biff||(o.biff=2);case"biff3":o.biff||(o.biff=3);case"biff4":return o.biff||(o.biff=4),lx(KM(a,o),o);case"biff5":o.biff||(o.biff=5);case"biff8":case"xla":case"xls":return o.biff||(o.biff=8),sH(a,o);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return aH(a,o);default:throw new Error("Unrecognized bookType |"+o.bookType+"|")}}function cH(a){if(!a.bookType){var i={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},o=a.file.slice(a.file.lastIndexOf(".")).toLowerCase();o.match(/^\.[a-z]+$/)&&(a.bookType=o.slice(1)),a.bookType=i[a.bookType]||a.bookType}}function nD(a,i,o){var c=o||{};return c.type="file",c.file=i,cH(c),iD(a,c)}function uH(a,i,o,c,u,r,_,T){var E=el(o),k=T.defval,D=T.raw||!Object.prototype.hasOwnProperty.call(T,"raw"),j=!0,B=u===1?[]:{};if(u!==1)if(Object.defineProperty)try{Object.defineProperty(B,"__rowNum__",{value:o,enumerable:!1})}catch{B.__rowNum__=o}else B.__rowNum__=o;if(!_||a[o])for(var P=i.s.c;P<=i.e.c;++P){var ee=_?a[o][P]:a[c[P]+E];if(ee===void 0||ee.t===void 0){if(k===void 0)continue;r[P]!=null&&(B[r[P]]=k);continue}var G=ee.v;switch(ee.t){case"z":if(G==null)break;continue;case"e":G=G==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+ee.t)}if(r[P]!=null){if(G==null)if(ee.t=="e"&&G===null)B[r[P]]=null;else if(k!==void 0)B[r[P]]=k;else if(D&&G===null)B[r[P]]=null;else continue;else B[r[P]]=D&&(ee.t!=="n"||ee.t==="n"&&T.rawNumbers!==!1)?G:df(ee,G,T);G!=null&&(j=!1)}}return{row:B,isempty:j}}function bx(a,i){if(a==null||a["!ref"]==null)return[];var o={t:"n",v:0},c=0,u=1,r=[],_=0,T="",E={s:{r:0,c:0},e:{r:0,c:0}},k=i||{},D=k.range!=null?k.range:a["!ref"];switch(k.header===1?c=1:k.header==="A"?c=2:Array.isArray(k.header)?c=3:k.header==null&&(c=0),typeof D){case"string":E=ao(D);break;case"number":E=ao(a["!ref"]),E.s.r=D;break;default:E=D}c>0&&(u=0);var j=el(E.s.r),B=[],P=[],ee=0,G=0,K=Array.isArray(a),J=E.s.r,ne=0,he={};K&&!a[J]&&(a[J]=[]);var Me=k.skipHidden&&a["!cols"]||[],Re=k.skipHidden&&a["!rows"]||[];for(ne=E.s.c;ne<=E.e.c;++ne)if(!(Me[ne]||{}).hidden)switch(B[ne]=vl(ne),o=K?a[J][ne]:a[B[ne]+j],c){case 1:r[ne]=ne-E.s.c;break;case 2:r[ne]=B[ne];break;case 3:r[ne]=k.header[ne-E.s.c];break;default:if(o==null&&(o={w:"__EMPTY",t:"s"}),T=_=df(o,null,k),G=he[_]||0,!G)he[_]=1;else{do T=_+"_"+G++;while(he[T]);he[_]=G,he[T]=1}r[ne]=T}for(J=E.s.r+u;J<=E.e.r;++J)if(!(Re[J]||{}).hidden){var et=uH(a,E,J,B,c,r,K,k);(et.isempty===!1||(c===1?k.blankrows!==!1:k.blankrows))&&(P[ee++]=et.row)}return P.length=ee,P}var Rk=/"/g;function hH(a,i,o,c,u,r,_,T){for(var E=!0,k=[],D="",j=el(o),B=i.s.c;B<=i.e.c;++B)if(c[B]){var P=T.dense?(a[o]||[])[B]:a[c[B]+j];if(P==null)D="";else if(P.v!=null){E=!1,D=""+(T.rawNumbers&&P.t=="n"?P.v:df(P,null,T));for(var ee=0,G=0;ee!==D.length;++ee)if((G=D.charCodeAt(ee))===u||G===r||G===34||T.forceQuotes){D='"'+D.replace(Rk,'""')+'"';break}D=="ID"&&(D='"ID"')}else P.f!=null&&!P.F?(E=!1,D="="+P.f,D.indexOf(",")>=0&&(D='"'+D.replace(Rk,'""')+'"')):D="";k.push(D)}return T.blankrows===!1&&E?null:k.join(_)}function gT(a,i){var o=[],c=i??{};if(a==null||a["!ref"]==null)return"";var u=ao(a["!ref"]),r=c.FS!==void 0?c.FS:",",_=r.charCodeAt(0),T=c.RS!==void 0?c.RS:`
`,E=T.charCodeAt(0),k=new RegExp((r=="|"?"\\|":r)+"+$"),D="",j=[];c.dense=Array.isArray(a);for(var B=c.skipHidden&&a["!cols"]||[],P=c.skipHidden&&a["!rows"]||[],ee=u.s.c;ee<=u.e.c;++ee)(B[ee]||{}).hidden||(j[ee]=vl(ee));for(var G=0,K=u.s.r;K<=u.e.r;++K)(P[K]||{}).hidden||(D=hH(a,u,K,j,_,E,r,c),D!=null&&(c.strip&&(D=D.replace(k,"")),(D||c.blankrows!==!1)&&o.push((G++?T:"")+D)));return delete c.dense,o.join("")}function aD(a,i){i||(i={}),i.FS="	",i.RS=`
`;var o=gT(a,i);if(typeof za>"u"||i.type=="string")return o;var c=za.utils.encode(1200,o,"str");return"\xFF\xFE"+c}function dH(a){var i="",o,c="";if(a==null||a["!ref"]==null)return[];var u=ao(a["!ref"]),r="",_=[],T,E=[],k=Array.isArray(a);for(T=u.s.c;T<=u.e.c;++T)_[T]=vl(T);for(var D=u.s.r;D<=u.e.r;++D)for(r=el(D),T=u.s.c;T<=u.e.c;++T)if(i=_[T]+r,o=k?(a[D]||[])[T]:a[i],c="",o!==void 0){if(o.F!=null){if(i=o.F,!o.f)continue;c=o.f,i.indexOf(":")==-1&&(i=i+":"+i)}if(o.f!=null)c=o.f;else{if(o.t=="z")continue;if(o.t=="n"&&o.v!=null)c=""+o.v;else if(o.t=="b")c=o.v?"TRUE":"FALSE";else if(o.w!==void 0)c="'"+o.w;else{if(o.v===void 0)continue;o.t=="s"?c="'"+o.v:c=""+o.v}}E[E.length]=i+"="+c}return E}function oD(a,i,o){var c=o||{},u=+!c.skipHeader,r=a||{},_=0,T=0;if(r&&c.origin!=null)if(typeof c.origin=="number")_=c.origin;else{var E=typeof c.origin=="string"?Ps(c.origin):c.origin;_=E.r,T=E.c}var k,D={s:{c:0,r:0},e:{c:T,r:_+i.length-1+u}};if(r["!ref"]){var j=ao(r["!ref"]);D.e.c=Math.max(D.e.c,j.e.c),D.e.r=Math.max(D.e.r,j.e.r),_==-1&&(_=j.e.r+1,D.e.r=_+i.length-1+u)}else _==-1&&(_=0,D.e.r=i.length-1+u);var B=c.header||[],P=0;i.forEach(function(G,K){tl(G).forEach(function(J){(P=B.indexOf(J))==-1&&(B[P=B.length]=J);var ne=G[J],he="z",Me="",Re=Ia({c:T+P,r:_+K+u});k=d1(r,Re),ne&&typeof ne=="object"&&!(ne instanceof Date)?r[Re]=ne:(typeof ne=="number"?he="n":typeof ne=="boolean"?he="b":typeof ne=="string"?he="s":ne instanceof Date?(he="d",c.cellDates||(he="n",ne=fc(ne)),Me=c.dateNF||Ro[14]):ne===null&&c.nullError&&(he="e",ne=0),k?(k.t=he,k.v=ne,delete k.w,delete k.R,Me&&(k.z=Me)):r[Re]=k={t:he,v:ne},Me&&(k.z=Me))})}),D.e.c=Math.max(D.e.c,T+B.length-1);var ee=el(_);if(u)for(P=0;P<B.length;++P)r[vl(P+T)+ee]={t:"s",v:B[P]};return r["!ref"]=es(D),r}function fH(a,i){return oD(null,a,i)}function d1(a,i,o){if(typeof i=="string"){if(Array.isArray(a)){var c=Ps(i);return a[c.r]||(a[c.r]=[]),a[c.r][c.c]||(a[c.r][c.c]={t:"z"})}return a[i]||(a[i]={t:"z"})}return typeof i!="number"?d1(a,Ia(i)):d1(a,Ia({r:i,c:o||0}))}function pH(a,i){if(typeof i=="number"){if(i>=0&&a.SheetNames.length>i)return i;throw new Error("Cannot find sheet # "+i)}else if(typeof i=="string"){var o=a.SheetNames.indexOf(i);if(o>-1)return o;throw new Error("Cannot find sheet name |"+i+"|")}else throw new Error("Cannot find sheet |"+i+"|")}function mH(){return{SheetNames:[],Sheets:{}}}function gH(a,i,o,c){var u=1;if(!o)for(;u<=65535&&a.SheetNames.indexOf(o="Sheet"+u)!=-1;++u,o=void 0);if(!o||a.SheetNames.length>=65535)throw new Error("Too many worksheets");if(c&&a.SheetNames.indexOf(o)>=0){var r=o.match(/(^.*?)(\d+)$/);u=r&&+r[2]||0;var _=r&&r[1]||o;for(++u;u<=65535&&a.SheetNames.indexOf(o=_+u)!=-1;++u);}if(XM(o),a.SheetNames.indexOf(o)>=0)throw new Error("Worksheet with name |"+o+"| already exists!");return a.SheetNames.push(o),a.Sheets[o]=i,o}function _H(a,i,o){a.Workbook||(a.Workbook={}),a.Workbook.Sheets||(a.Workbook.Sheets=[]);var c=pH(a,i);switch(a.Workbook.Sheets[c]||(a.Workbook.Sheets[c]={}),o){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+o)}a.Workbook.Sheets[c].Hidden=o}function vH(a,i){return a.z=i,a}function sD(a,i,o){return i?(a.l={Target:i},o&&(a.l.Tooltip=o)):delete a.l,a}function yH(a,i,o){return sD(a,"#"+i,o)}function xH(a,i,o){a.c||(a.c=[]),a.c.push({t:i,a:o||"SheetJS"})}function bH(a,i,o,c){for(var u=typeof i!="string"?i:ao(i),r=typeof i=="string"?i:es(i),_=u.s.r;_<=u.e.r;++_)for(var T=u.s.c;T<=u.e.c;++T){var E=d1(a,_,T);E.t="n",E.F=r,delete E.v,_==u.s.r&&T==u.s.c&&(E.f=o,c&&(E.D=!0))}return a}var Dx={encode_col:vl,encode_row:el,encode_cell:Ia,encode_range:es,decode_col:aT,decode_row:nT,split_cell:Oz,decode_cell:Ps,decode_range:Xc,format_cell:df,sheet_add_aoa:oM,sheet_add_json:oD,sheet_add_dom:QM,aoa_to_sheet:hg,json_to_sheet:fH,table_to_sheet:eD,table_to_book:WG,sheet_to_csv:gT,sheet_to_txt:aD,sheet_to_json:bx,sheet_to_html:JM,sheet_to_formulae:dH,sheet_to_row_object_array:bx,sheet_get_cell:d1,book_new:mH,book_append_sheet:gH,book_set_sheet_visibility:_H,cell_set_number_format:vH,cell_set_hyperlink:sD,cell_set_internal_link:yH,cell_add_comment:xH,sheet_set_array_formula:bH,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var $K=o1.version;Vx();var XD=xC($D());function xW(a,i){a&1&&(ti(0,"th",12),Yi(1," id "),Ur())}function bW(a,i){if(a&1&&(ti(0,"td",13),Yi(1),Ur()),a&2){let o=i.$implicit;Ii(),rd(" ",o.id," ")}}function wW(a,i){a&1&&(ti(0,"th",12),Yi(1," Name "),Ur())}function TW(a,i){if(a&1&&(ti(0,"td",13),Yi(1),Ur()),a&2){let o=i.$implicit;Ii(),rd(" ",o.nombre," ")}}function SW(a,i){a&1&&(ti(0,"th",12),Yi(1," Weight "),Ur())}function EW(a,i){if(a&1&&(ti(0,"td",13),Yi(1),Ur()),a&2){let o=i.$implicit;Ii(),rd(" ",o.tel," ")}}function AW(a,i){a&1&&(ti(0,"th",12),Yi(1," correo "),Ur())}function CW(a,i){if(a&1&&(ti(0,"td",13),Yi(1),Ur()),a&2){let o=i.$implicit;Ii(),rd(" ",o.correo," ")}}function IW(a,i){a&1&&(ti(0,"th",12),Yi(1," city "),Ur())}function kW(a,i){if(a&1&&(ti(0,"td",13),Yi(1),Ur()),a&2){let o=i.$implicit;Ii(),rd(" ",o.city," ")}}function MW(a,i){a&1&&(ti(0,"th",12),Yi(1," cp "),Ur())}function DW(a,i){if(a&1&&(ti(0,"td",13),Yi(1),Ur()),a&2){let o=i.$implicit;Ii(),rd(" ",o.cp," ")}}function RW(a,i){a&1&&nn(0,"tr",14)}function FW(a,i){a&1&&nn(0,"tr",15)}var PW=[{id:1,nombre:"Juan P\xE9rez",tel:5551234567,correo:"juan@example.com",city:"Los Angeles",cp:90001},{id:2,nombre:"Mar\xEDa Rodr\xEDguez",tel:5559876543,correo:"maria@example.com",city:"New York",cp:10001}],ZD=(()=>{let i=class i{constructor(){this.displayedColumns=["id","nombre","tel","correo","city","cp"],this.dataSource=PW}exportToExcel(){let c=Dx.json_to_sheet(this.dataSource,{header:this.displayedColumns}),u=Dx.book_new();Dx.book_append_sheet(u,c,"Sheet1"),nD(u,"tabla.xlsx")}exportToPDF(){let c=new BT,u=this.displayedColumns,r=this.dataSource.map(_=>u.map(T=>_[T]));(0,XD.default)(c,{head:[u],body:r}),c.save("tabla.pdf")}};i.\u0275fac=function(u){return new(u||i)},i.\u0275cmp=pa({type:i,selectors:[["app-user-tables"]],standalone:!0,features:[ma],decls:25,vars:3,consts:[["mat-button","",3,"click"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","nombre"],["matColumnDef","tel"],["matColumnDef","correo"],["matColumnDef","city"],["matColumnDef","cp"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(u,r){u&1&&(ti(0,"button",0),hs("click",function(){return r.exportToExcel()}),Yi(1,"Exportar a Exel"),Ur(),ti(2,"button",0),hs("click",function(){return r.exportToPDF()}),Yi(3,"Exportar a PDF"),Ur(),ti(4,"table",1),Jd(5,2),En(6,xW,2,0,"th",3)(7,bW,2,1,"td",4),Qd(),Jd(8,5),En(9,wW,2,0,"th",3)(10,TW,2,1,"td",4),Qd(),Jd(11,6),En(12,SW,2,0,"th",3)(13,EW,2,1,"td",4),Qd(),Jd(14,7),En(15,AW,2,0,"th",3)(16,CW,2,1,"td",4),Qd(),Jd(17,8),En(18,IW,2,0,"th",3)(19,kW,2,1,"td",4),Qd(),Jd(20,9),En(21,MW,2,0,"th",3)(22,DW,2,1,"td",4),Qd(),En(23,RW,1,0,"tr",10)(24,FW,1,0,"tr",11),Ur()),u&2&&(Ii(4),Xs("dataSource",r.dataSource),Ii(19),Xs("matHeaderRowDef",r.displayedColumns),Ii(),Xs("matRowDefColumns",r.displayedColumns))},dependencies:[q4,O4,B4,V4,z4,N4,G4,j4,U4,H4,W4,up,cp],styles:[".container[_ngcontent-%COMP%]{overflow:scroll}.mat-header-row[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#f9f9f9}table[_ngcontent-%COMP%]{width:100%}"]});let a=i;return a})();function LW(a,i){a&1&&nn(0,"app-register-form")}function OW(a,i){a&1&&nn(0,"app-user-tables")}var YD=(()=>{let i=class i{constructor(){this.page=!0}showListas(){this.page=!0}showRegister(){this.page=!1}};i.\u0275fac=function(u){return new(u||i)},i.\u0275cmp=pa({type:i,selectors:[["app-main"]],standalone:!0,features:[ma],decls:11,vars:2,consts:[[1,"example-button-row"],["mat-button","",3,"click"],["src","/src/assets/logo-itsmarts.png","alt","logo-itsmarts"],[1,"container"]],template:function(u,r){u&1&&(ti(0,"mat-toolbar")(1,"div",0)(2,"button",1),hs("click",function(){return r.showListas()}),Yi(3,"Listas"),Ur(),ti(4,"button",1),hs("click",function(){return r.showRegister()}),Yi(5,"Registro"),Ur(),nn(6,"img",2),Ur()(),ti(7,"div",3),En(8,LW,1,0,"app-register-form")(9,OW,1,0,"app-user-tables"),nn(10,"app-mapp-box"),Ur()),u&2&&(Ii(8),Zn(r.page===!1?8:-1),Ii(),Zn(r.page===!0?9:-1))},dependencies:[Ey,CI,up,cp,Sy,$0,of,x4,S4,ZD],styles:[".example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.example-button-row[_ngcontent-%COMP%]{display:table-cell;max-width:600px}.container[_ngcontent-%COMP%]{position:absolute;padding:2vw 4vw;display:flex;min-width:100%}.container[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{float:left}.container[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:first-child{margin-right:48px;width:36vw;height:36vw;overflow:auto}.container[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:last-child{width:40vw}.c[_ngcontent-%COMP%]{border:1px solid black}"]});let a=i;return a})();var KD=[{path:"register",component:YD},{path:"**",redirectTo:"register"}];var NW="@",BW=(()=>{let i=class i{constructor(c,u,r,_,T){this.doc=c,this.delegate=u,this.zone=r,this.animationType=_,this.moduleImpl=T,this._rendererFactoryPromise=null,this.scheduler=Jr(PC,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-LFVW523Y.js").then(u=>u)).catch(u=>{throw new Xa(5300,!1)}).then(({\u0275createEngine:u,\u0275AnimationRendererFactory:r})=>{this._engine=u(this.animationType,this.doc);let _=new r(this.delegate,this._engine,this.zone);return this.delegate=_,_})}createRenderer(c,u){let r=this.delegate.createRenderer(c,u);if(r.\u0275type===0)return r;typeof r.throwOnSyntheticProps=="boolean"&&(r.throwOnSyntheticProps=!1);let _=new UT(r);return u?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(T=>{let E=T.createRenderer(c,u);_.use(E),this.scheduler?.notify(9)}).catch(T=>{_.use(r)}),_}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}};i.\u0275fac=function(u){m_()},i.\u0275prov=Li({token:i,factory:i.\u0275fac});let a=i;return a})(),UT=class{constructor(i){this.delegate=i,this.replay=[],this.\u0275type=1}use(i){if(this.delegate=i,this.replay!==null){for(let o of this.replay)o(i);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(i,o){return this.delegate.createElement(i,o)}createComment(i){return this.delegate.createComment(i)}createText(i){return this.delegate.createText(i)}get destroyNode(){return this.delegate.destroyNode}appendChild(i,o){this.delegate.appendChild(i,o)}insertBefore(i,o,c,u){this.delegate.insertBefore(i,o,c,u)}removeChild(i,o,c){this.delegate.removeChild(i,o,c)}selectRootElement(i,o){return this.delegate.selectRootElement(i,o)}parentNode(i){return this.delegate.parentNode(i)}nextSibling(i){return this.delegate.nextSibling(i)}setAttribute(i,o,c,u){this.delegate.setAttribute(i,o,c,u)}removeAttribute(i,o,c){this.delegate.removeAttribute(i,o,c)}addClass(i,o){this.delegate.addClass(i,o)}removeClass(i,o){this.delegate.removeClass(i,o)}setStyle(i,o,c,u){this.delegate.setStyle(i,o,c,u)}removeStyle(i,o,c){this.delegate.removeStyle(i,o,c)}setProperty(i,o,c){this.shouldReplay(o)&&this.replay.push(u=>u.setProperty(i,o,c)),this.delegate.setProperty(i,o,c)}setValue(i,o){this.delegate.setValue(i,o)}listen(i,o,c){return this.shouldReplay(o)&&this.replay.push(u=>u.listen(i,o,c)),this.delegate.listen(i,o,c)}shouldReplay(i){return this.replay!==null&&i.startsWith(NW)}};function JD(a="animations"){return Gv("NgAsyncAnimations"),om([{provide:Uv,useFactory:(i,o,c)=>new BW(i,o,c,a),deps:[aa,ey,Tn]},{provide:Zd,useValue:a==="noop"?"NoopAnimations":"BrowserAnimations"}])}var QD={providers:[tI(KD),y3(),JD()]};var eR=(()=>{let i=class i{constructor(){this.title="pruebaProgramcionYDisenoBasica"}};i.\u0275fac=function(u){return new(u||i)},i.\u0275cmp=pa({type:i,selectors:[["app-root"]],standalone:!0,features:[ma],decls:1,vars:0,template:function(u,r){u&1&&nn(0,"router-outlet")},dependencies:[Fw]});let a=i;return a})();_3(eR,QD).catch(a=>console.error(a));
